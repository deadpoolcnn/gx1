<!DOCTYPE html>
<html>
    <head>
        <title>Preview Display</title>
        <meta charset="UTF-8">
        <link rel="shortcut icon" href="custom/images/favicon.ico?v=2" />
        <style>
            html, body {
                padding: 0px;
                margin: 0px;
            }
        </style>

        <script src='libs/core/ht.js'></script>
        <script src='libs/plugin/ht-edgetype.js'></script>
        <script src='libs/plugin/ht-obj.js'></script>
        <script src='libs/core/ht-ui.js'></script>
        <script src='libs/plugin/ht-vector.js'></script>
        <script src="libs/plugin/ht-animation.js"></script>

        <script>
            function init() {
                dataModel = new ht.DataModel();
                graphView = new ht.graph.GraphView(dataModel);
                graphView.addToDOM();
                dataModel.enableAnimation()

                ht.Default.xhrLoad('displays/junminronghe/01daohangye.json', function(text) {
                    var json = ht.Default.parse(text);
                    if(json.title) document.title = json.title;
                    dataModel.deserialize(json);
                    graphView.fitContent(true);
                    
                    mainCloudAnimation(dataModel)
                    iconLinkAnimation(dataModel)
                });
            }
            // 中心云朵动画
            function mainCloudAnimation(dm) {
                const mainCloud = dm.getDataByTag('center_cloud_block')
                mainCloud.setAnimation({
                    hide: {
                        property: 'opacity',
                        accessType: 'style',
                        from: 1,
                        to: 0.5,
                        duration: 4000,
                        next: 'show'
                    },
                    show: {
                        property: 'opacity',
                        accessType: 'style',
                        from: 0.5,
                        to: 1,
                        duration: 4000,
                        next: 'hide'
                    },
                    start: ['hide']
                })
            }

            // 图标浮动动画
            function iconLinkAnimation(dm){
                const ceHuiDiLi = dm.getDataByTag('cehuidilixinxi')
                const jiaoTong = dm.getDataByTag('jiaotongzhanbei')
                const gongGongFuWu = dm.getDataByTag('gonggongfuwu')
                const beiDou = dm.getDataByTag('beidou')
                const feiTing = dm.getDataByTag('feiting')
                const xueJiang = dm.getDataByTag('xuejiangyun')
                const yingJiWuZi = dm.getDataByTag('yingjiwuzi')
                const wuRenJi = dm.getDataByTag('wurenjiguanli')
                const yingJiJiuYUan = dm.getDataByTag('yingjiliuyuan')
                const leftIconLinkArray1 = [
                    ceHuiDiLi,
                    beiDou
                ]
                const leftIconLinkArray2 = [
                    jiaoTong,
                    gongGongFuWu,
                ]
                const rightIconLinkArray1 = [
                    xueJiang,
                    wuRenJi,
                ]
                const rightIconLinkArray2 = [
                    feiTing,
                    yingJiWuZi,
                    yingJiJiuYUan
                ]
                leftIconLinkArray1.forEach((item, index) => {
                    item.setAnimation({
                        down: {
                            from: item.getPosition().y + 5,
                            to: item.getPosition().y - 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'up',
                            onUpdate: function(value) {
                                this.setPosition({x:item.getPosition().x, y: value })
                            }
                        },
                        up: {
                            from: item.getPosition().y - 5,
                            to: item.getPosition().y + 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'down',
                            onUpdate: function(value) {
                                this.setPosition({x: item.getPosition().x, y: value})
                            }
                        },
                        start: ['down']
                    })
                })
                leftIconLinkArray2.forEach((item, index) => {
                    item.setAnimation({
                        down: {
                            from: item.getPosition().y + 5,
                            to: item.getPosition().y - 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'up',
                            onUpdate: function(value) {
                                this.setPosition({x:item.getPosition().x, y: value })
                            }
                        },
                        up: {
                            from: item.getPosition().y - 5,
                            to: item.getPosition().y + 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'down',
                            onUpdate: function(value) {
                                this.setPosition({x: item.getPosition().x, y: value})
                            }
                        },
                        start: ['up']
                    })
                })
                rightIconLinkArray1.forEach((item, index) => {
                    item.setAnimation({
                        down: {
                            from: item.getPosition().y + 5,
                            to: item.getPosition().y - 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'up',
                            onUpdate: function(value) {
                                this.setPosition({x:item.getPosition().x, y: value })
                            }
                        },
                        up: {
                            from: item.getPosition().y - 5,
                            to: item.getPosition().y + 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'down',
                            onUpdate: function(value) {
                                this.setPosition({x: item.getPosition().x, y: value})
                            }
                        },
                        start: ['up']
                    })
                })
                rightIconLinkArray2.forEach((item, index) => {
                    item.setAnimation({
                        down: {
                            from: item.getPosition().y + 5,
                            to: item.getPosition().y - 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'up',
                            onUpdate: function(value) {
                                this.setPosition({x:item.getPosition().x, y: value })
                            }
                        },
                        up: {
                            from: item.getPosition().y - 5,
                            to: item.getPosition().y + 5,
                            duration: 2000,
                            //easing: 'Linear',
                            next: 'down',
                            onUpdate: function(value) {
                                this.setPosition({x: item.getPosition().x, y: value})
                            }
                        },
                        start: ['down']
                    })
                })
            }
        </script>
    </head>
    <body onload='setTimeout(init, 300)'>
    </body>
</html>
