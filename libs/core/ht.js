!function(x,R,r){"use strict";function M(Q,k){if("function"!=typeof k&&null!==k)throw new TypeError("Super expression must either be null or a function");Q.prototype=R.create(k&&k.prototype,{constructor:{value:Q,writable:!0,configurable:!0}}),k&&gs(Q,k)}function Z(x){var E=R.prototype.toString.call(x);return"Array]"===E.substring(E.length-6)}function l(k,q,p,J,G,N){q=q||[],p=p||[],J=J||[];try{q.push(k);var a=Function.apply(0,q);return p[p.length]="return "+a,Function.apply(0,p).apply(0,J)}catch(h){return N&&N(h),G}}function k(D){var d={};return{get:function(x){if(d[x]!==r)return d[x];var V;switch(x){case"WEBGL_depth_texture":V=D.getExtension("WEBGL_depth_texture")||D.getExtension("MOZ_WEBGL_depth_texture")||D.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":V=D.getExtension("EXT_texture_filter_anisotropic")||D.getExtension("MOZ_EXT_texture_filter_anisotropic")||D.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":V=D.getExtension("WEBGL_compressed_texture_s3tc")||D.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||D.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":V=D.getExtension("WEBGL_compressed_texture_pvrtc")||D.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":V=D.getExtension("WEBGL_compressed_texture_etc1");break;default:V=D.getExtension(x)}return d[x]=V,V}}}function u($,k,i){function p(){if(U!==r)return U;var Y=k.get("EXT_texture_filter_anisotropic");return U=null!==Y?$.getParameter(Y.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function G(_){if("highp"===_){if($.getShaderPrecisionFormat($.VERTEX_SHADER,$.HIGH_FLOAT).precision>0&&$.getShaderPrecisionFormat($.FRAGMENT_SHADER,$.HIGH_FLOAT).precision>0)return"highp";_="mediump"}return"mediump"===_&&$.getShaderPrecisionFormat($.VERTEX_SHADER,$.MEDIUM_FLOAT).precision>0&&$.getShaderPrecisionFormat($.FRAGMENT_SHADER,$.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var U;i=i||{};var h="undefined"!=typeof WebGL2RenderingContext&&$ instanceof WebGL2RenderingContext,M=i.precision!==r?i.precision:"highp",d=G(M);d!==M&&(console.warn("WebGL:",M,"not supported, using",d,"instead."),M=d);var X=i.logarithmicDepthBuffer===!0,I=$.getParameter($.MAX_TEXTURE_IMAGE_UNITS),y=$.getParameter($.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=$.getParameter($.MAX_TEXTURE_SIZE),s=$.getParameter($.MAX_CUBE_MAP_TEXTURE_SIZE),W=$.getParameter($.MAX_VERTEX_ATTRIBS),P=$.getParameter($.MAX_VERTEX_UNIFORM_VECTORS),V=$.getParameter($.MAX_VARYING_VECTORS),D=$.getParameter($.MAX_FRAGMENT_UNIFORM_VECTORS),L=y>0,N=h||!!k.get("OES_texture_float"),F=(h||!!k.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,e=L&&N,B=h?$.getParameter($.MAX_SAMPLES):0;return{getMaxAnisotropy:p,getMaxPrecision:G,precision:M,logarithmicDepthBuffer:X,maxTextures:I,maxVertexTextures:y,maxTextureSize:R,maxCubemapSize:s,maxAttributes:W,maxVertexUniforms:P,maxVaryings:V,maxFragmentUniforms:D,vertexTextures:L,floatFragmentTextures:N,elementTypeUint:F,floatVertexTextures:e,maxSamples:B}}function U(D,L){return D.z!==L.z?D.z-L.z:D.id-L.id}function W(u,_){return u.z!==_.z?_.z-u.z:u.id-_.id}var D="ht";if(!x[D]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),x.performance&&x.performance.now||function(){var F=Date.now();x.performance||(x.performance={}),x.performance.now=function(){return Date.now()-F}}();for(var f=Date.now(),y=16,V=["ms","moz","webkit","o"],P=0;P<V.length&&!x.requestAnimationFrame;++P)x.requestAnimationFrame=x[V[P]+"RequestAnimationFrame"],x.cancelAnimationFrame=x[V[P]+"CancelAnimationFrame"]||x[V[P]+"CancelRequestAnimationFrame"];x.requestAnimationFrame||(x.requestAnimationFrame=function(q){var h=Date.now(),o=y+f-h;return 0>o&&(o=0),f=h,x.setTimeout(function(){f=Date.now(),q(performance.now())},o)}),x.cancelAnimationFrame||(x.cancelAnimationFrame=function(r){return x.clearTimeout(r)}),R.assign===r&&(R.assign=function(d){if(d===r||null===d)throw new TypeError("Cannot convert undefined or null to object");for(var s=R(d),S=1;S<arguments.length;S++){var l=arguments[S];if(l!==r&&null!==l)for(var m in l)R.prototype.hasOwnProperty.call(l,m)&&(s[m]=l[m])}return s}),x.btoa===r&&(x.btoa=function(p){for(var e,E,s=String(p),g=0,B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";s.charAt(0|g)||(B="=",g%1);c+=B.charAt(63&e>>8-8*(g%1))){if(E=s.charCodeAt(g+=.75),E>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|E}return c})}();var A=x.document,w=null,s=x[D]={},d=x[D+"config"],Y=s.Default=d&&d.Default||{},V=s.Style=d&&d.Style||{},h=s.Attr=d&&d.Attr||{},n=function(){return!0},p=function(t){return t},F=function(J){return!J},e=s.Color=d&&d.Color||{},_=s.IsGetter=d&&d.IsGetter||{};!function(){var d=!1;try{var E=R.defineProperty({},"passive",{get:function(){return d=!0,r}});x.addEventListener("test",E,E),x.removeEventListener("test",E,E)}catch($){d=!1}Y.passiveSupported=d}();var j,I,S,H,Q=Y.passiveSupported,b=Y.eventListenerOptionsFalse=Q?{passive:!1,capture:!1}:!1,y=Y.eventListenerOptionsTrue=Q?{passive:!1,capture:!0}:!0,B=function(f,x,g,C){f.addEventListener(x,g,C?y:b)},q=function(B,k,A,N){B.removeEventListener(k,A,N?y:b)},L=Math,N=L.round,C=L.floor,v=L.ceil,G=L.sqrt,i=L.max,X=L.min,J=L.abs,f=L.cos,o=L.acos,O=L.sin,P=L.pow,m=L.asin,E=L.exp,g=L.PI,c=2*g,T=g/2,$=L.tan,K=L.atan2,t=L.random,z=L.log,a=!1,Dq=!1,Sq=x.parseInt||global.parseInt,kb="2021-6-15",ye=x.navigator?x.navigator.platform.indexOf("Win")>-1:!1,Yq=function(y){return y*y},fr=x.setTimeout,hd=x.clearTimeout,zh=x.location,Ug=x.navigator?x.navigator.userAgent.toLowerCase():"",Tb=function(U){return U.test(Ug)},ql=Tb(/msie/),qm=Tb(/msie/)||Tb(/trident/),Fn=Tb(/msie 10/),rb=Tb(/edge/),hp=Tb(/firefox/),Am=Tb(/mac/),re=Y.isTouchable===r?ye?!1:A?"ontouchend"in A:!1:Y.isTouchable,Bi="default",Sj="single",ao="multiple",_j="front",bf="back",vq="left",hn="right",rd="top",fi="bottom",Yg="center",yo="eye",Rk="middle",zj="east",Ad="west",ai="north",to="none",qf="px",$b="absolute",wr="border",Ac="triangle",ki="rect",og="circle",wo="cylinder",ii="shape",pe="items",xb="normal",Ge="remove",qb="clear",rl="width",fc="height",$e="ingroup",af="check",Qb="uncheck",yc="radio",Mn="radioOn",Pq="radioOff",Tp="points",Wl="values",se="series",Fh="body",Ij="label",pl="label2",uh="note",Rd="note2",li="icons",Hi="labelFont",Nj="labelColor",vb="labelSelectColor",dk="note.expanded",Mr="note2.expanded",ng="edge.expanded",cs="edge.points",Th="edge.type",Pj="rotation",$h="hidden",Ri="visible",oh="tuv",uf="no",Um="draw",nq="select",Dr="currentSubGraph",Iq="selectBackground",wq="autoMakeVisible",ri="autoHideScrollBar",rf="scrollBarColor",sd="scrollBarSize",vn="indent",Kp="rowHeight",te="columnLineColor",Qg="rowLineColor",pk="columnLineVisible",em="rowLineVisible",Zg="visibleFunc",gi="expandIcon",pi="collapseIcon",Cd="checkMode",Kk="sortFunc",ag="editable",os="batchEditable",Mk="tristate",wj="asc",ls="desc",ie="position",Zm="__",yh="elevation",ir="children",kh="translateX",Ze="translateY",Ck="dataModel",Lo="maxSize",Hc="enc",cn="state",Yd=Hc+"o"+"de",cr="shape3d",Ip="shape3d.resolution",jf="shape3d.visible",td="shape3d.from.visible",Pf="shape3d.to.visible",Te="shape3d.top.visible",qh="shape3d.bottom.visible",Cl="repeat.uv.length",bs="serializeValue",Sg="deserializeValue",ef="centerUniform",Tc="uniform",Xn="rgba(255,255,255,0)",zc="style",Rn="attr",zm="field",Bk="string",ke="boolean",ul="color",Dk="int",Qm="number",mm="ew-resize",Uj="ns-resize",kq="pointer",Ok="auto",Ur="mousedown",Vj="mousemove",lh="mouseup",cm="mouseout",ib="touchstart",fe="touchmove",_g="touchend",yq="keydown",Hh="keyup",we=["DOMMouseScroll","mousewheel"],Il=hp?we[0]:we[1],Eo=Zm+D+Zm+Yd,ek=[ib,fe,_g],Ue=[Ur,Vj,lh,cm,Il,"wheel","mouseenter","mouseleave","mouseover"],Kr=[yq,Hh,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Gq=re?ek.concat(Kr):Ue.concat(Kr),so=w,Al=w,Yl=w,Eb=lh.length,lg=function(){Yl&&(hd(Yl.timeout),Yl=w)},He=function(){Yl&&eq(Yl.e,Yl.info)};x.addEventListener&&(re||(B(x,cm,function(){lg()}),B(x,Il,function(){Wc()})),B(x,Hh,function(v){91===v.keyCode?qi={}:delete qi[v.keyCode]},!0),B(x,yq,function(U){qi[U.keyCode]=!0},!0),B(x,"blur",function(){qi={}}));var ml,_o,rq,Gj=0,wp=w,Ce=function(O,j){var a=fr(function(){delete wp[a],Ae(wp)&&(wp=w),O()},j);return a},Vo=w,Pl=w,mi={},lo={},Cs={},sg={},gd={},qi={},Lb={},hg={},In={},$q={},Kq=/.json$/,Hg=/\.(json|bin)$/,Rr=/^data:image\/svg\+xml/,Xr={},$f=[],Ik={},Ab=w,Sd=w,je=function(){},Bh=function(){throw"Oops!"},bp=[0,0,0],Jq={x:0,y:0,width:0,height:0},Cn=w,Jn=w,Sb=w,lk=function(k,F){lo[k]=F,F&&F.comps&&!F.uuid&&(F.uuid=s.Math.generateUUID()),df[k]&&(F.cacheRule=df[k],delete df[k])},Yr=function(k){Jn&&!k._72O&&(Sb||(Sb={}),Sb[k._72O=Nb()]=k),ml!=w?al()<.05&&H&&!_o&&(Kh=lg):Kh=Of},Ag=function(W,J,r,x){Jn||(Jn={});var K=Jn[W];if(K){if(K.url===J)return;K.image?(K.image.onload=je,K.image.onerror=je):K.request&&(K.request.onload=je,K.request.onerror=je)}if(Kq.test(J)){var D=new cd;if(Jn[W]={request:D,url:J},J=Y.beforeLoadURL(J,W),J.data){var Q=Y.parse(J.data);Mp(W,Q),Y.handleImageLoaded(W,Q)}else{D.onload=function(){if(200===this.status||0===this.status){var S=Y.parse(D.getResponseText());Mp(W,S),Y.handleImageLoaded(W,S)}else Mp(W,Y.handleUnfoundImage(W,J)||w)},D.onerror=function(){Mp(W,Y.handleUnfoundImage(W,J)||w)};var I={};I.url=encodeURI(J),I.sync=!1,D.send(I)}}else{var Q=new Image;Jn[W]={image:Q,url:J},/^data:image/.test(J)||(J=Y.beforeLoadURL(J,W),J=Y.appendTimeStamp(J),J=encodeURI(J),Q.crossOrigin=Y.crossOrigin),Y.convertImageSrc(J,function(N){qm&&(J.toLowerCase().indexOf(".svg")>0||Rr.test(J))?(A.body.appendChild(Q),Q.style.visibility="hidden",Q.onload=function(){fr(function(){if(r&&(Q.width=r),x&&(Q.height=x),!Q.width||!Q.height){var g=Q.width||Q.clientWidth,K=Q.height||Q.clientHeight;Q.width=g,Q.height=K}Y.handleImageLoaded(W,Q),Mp(W,Q),A.body.removeChild(Q),Q.style.visibility=""},180)},Q.onerror=function(){Mp(W,Y.handleUnfoundImage(W,J)||w),A.body.removeChild(Q),Q.style.visibility=""}):(Q.onload=function(){r&&(Q.width=r),x&&(Q.height=x),Y.handleImageLoaded(W,Q),Mp(W,Q)},Q.onerror=function(){Mp(W,Y.handleUnfoundImage(W,J)||w)}),Q.src=N})}},Mp=function(I,E){if(lk(I,E),delete Jn[I],Ae(Jn)&&(Jn=w,Sb)){for(var D in Sb){var g=Sb[D];g._2O&&g._2O[I]&&(g.deleteTexture(I),delete g._2O[I]),g.invalidateAll&&g.invalidateAll(r,"imageLoaded",I),g.redraw&&g.redraw(),g.iv(),delete g._72O}Sb=w}if(E&&Sb)for(var D in Sb){var g=Sb[D];g.invalidateAll&&g.invalidateAll(r,"imageLoading",I),g.redraw&&g.redraw(),g.iv()}},wk=function(){return z=L&&Date,function(){return x.performance&&x.performance.now?x.performance.now():Date.now()}}(),Pp=function(Q,I,H){return{width:Q,height:I,comps:wd(H)?H:[H]}},tc=function(z,b){return{type:og,rect:[z,b,1.6,1.6],borderWidth:1,borderColor:Xl,gradient:Rg,gradientColor:Io,background:Xl}},Aj=function(q,j){return Pp(16,16,{type:Ac,rect:[4,4,10,8],background:q,rotation:j?1.57:3.14})},Xb=function(E,x){return Pp(16,16,{type:Ac,rect:[4,4,8,7],background:E,rotation:x?3.14:0})},gr=function(E){var L=E._orientation;return"horizontal"===L||"h"===L},Yp=function(h,k){var P=w||4,G=w||1,S=w||1;0>P?P=0:P>.25&&(P=.25);var u,C,y,j,n,Q,Y,A=.5,Z=[],N=[],U=[],E=c/S,o=c/G,z=A-P;for(C=0;G>=C;C++)for(j=-g+C*o,Q=f(j),n=O(j),u=0;S>=u;u++)y=u*E,Y=z+P*Q,Z.push(f(y)*Y,n*P,-O(y)*Y),(I=[h,k])&&N.push(u/S,1-C/G);for(C=0;G>C;C++){var D=C*(S+1),v=(C+1)*(S+1);for(u=0;S>u;u++)U.push(D+u,v+u+1,v+u,D+u,D+u+1,v+u+1),qg.z=kf.z=[h,k]}},Nn=function(t){var F=2,m=0;for(var r in t)r.length===F&&Sq(r,32)===Jp&&(Ab=Sd=t[r]),m++;return m},ih=function(_,H,d,C){return d||(d=re?5:3,d/=C||1),{x:_-d,y:H-d,width:2*d,height:2*d}},ui=function(U,S,c,C){var B=this;S||(S=re?5:3,c=20,C=20);var $={x:U,y:S,width:c,height:C};if(c)for(var a=0;c>a;a++)if(3===c)C=20;else for(var T=0;C>T;T++)B=x?x:c;var y={x:g,y:2*g};if(Vb($,y)){var X=fc[0]+rd[0]+qb[1]+wj.length,w=$h[0]+Mk[0]+qb[1]+Fh.length;gf[yo]=[B[X],B[w]],B[X]=Pm[yo],B[w]=Pm[cr]}},dq=function(F){return(/ble$/.test(F)||/ed$/.test(F)||_[F]?"is":"get")+F.charAt(0).toUpperCase()+F.slice(1)},Pm=function(C){return"set"+C.charAt(0).toUpperCase()+C.slice(1)},ap=function(o){return typeof o===Bk||o instanceof String},wn=function(z){return typeof z===Qm},Of=function(q){return typeof q===ke},np=function(e){return e&&"object"==typeof e},Ln=function(W){return"function"==typeof W},wd=function(v){return v instanceof Array},aq=function(u){return u instanceof Pk},wb=function(H){return wd(H)?new Pk(H):H},Km=function(n){return n instanceof Wd},Dn=function(t){return t instanceof Ne},Qq=function(v){return v instanceof jp},Oi=function(w,H){if(!(w instanceof s.Group))return!1;if(!H)return w.isExpanded();var X=H.getDataUI(w);return X&&X._88I?!0:!1},cb=function(V){return V instanceof So},jl=function($){return $&&"IFRAME"===$.tagName},Fo=function(I){return I==w||Y.numberDigits==w?I:parseFloat(I.toFixed(Y.numberDigits))},Ho=function(t,h,X){var Q,D=h.length;if(X)for(var B=0;X>B;B++)if(3===D)t.push(h[0]),t.push(h[1]),t.push(h[2]);else for(Q=0;D>Q;Q++)t.push(h[Q]);else if(3===D)t.push(h[0]),t.push(h[1]),t.push(h[2]);else for(Q=0;D>Q;Q++)t.push(h[Q])},Re=function(d){return d?np(d)?d:{}:!1},xl=function($,g,M){var C,z=np($)?$:$.prototype;for(C in g)M&&C in z?z[C]===r&&console.warn("class",z,"has own undefined property",C,", keep exist!"):z[C]=g[C];return $},$l=function(P,K){if(!("wheelDelta"in K)){var A=K.deltaMode;K.wheelDelta=A===K.DOM_DELTA_PIXEL?-K.deltaY:A===K.DOM_DELTA_LINE?40*-K.deltaY:120*-K.deltaY}P.handle_mousewheel(K)},Bl=function(o){return String.fromCharCode(o)},Wg=function(Y){for(var H,S=0,M="";S<Y.length;S++)H=Y[Y.length-1-S],"%"===H?H="'":"a"===H?H='"':"]"===H&&(H="\\"),M+=Bl(H.charCodeAt(0)-1);return M},Lh=function(Q,e,x){Q.superClass.constructor.apply(e,x)},Ae=function(y){for(var t in y)return!1;return!0},Nf=function(v){return v?0===v.length:!0},uo=function(){var H="";return[Qb[0],Qg[0],Ij[0]].forEach(function(o){H+=Pm(o).slice(3)}),Tc=A&&A[H]||ef,function(k,V){return k===V?!0:k.x===V.x&&k.y===V.y&&k.width===V.width&&k.height===V.height}}(),Jc=function(R,X,o){return X>R?X:R>o?o:R},Mh=function(M){return 0>M?-1:M>0?1:0},al=function(){var f=1e4*O(Eb++);return f-C(f)},Tq=function(L,U,v){return yn(L.x,L.y,U.x,U.y,v.x,v.y,v.x+v.width,v.y,!0)||yn(L.x,L.y,U.x,U.y,v.x+v.width,v.y,v.x+v.width,v.y+v.height,!0)||yn(L.x,L.y,U.x,U.y,v.x+v.width,v.y+v.height,v.x,v.y+v.height,!0)||yn(L.x,L.y,U.x,U.y,v.x,v.y+v.height,v.x,v.y,!0)},yn=function(x,U,m,Z,P,f,K,_,M){var H=(K-P)*(U-f)-(_-f)*(x-P),L=(_-f)*(m-x)-(K-P)*(Z-U);if(0!==L){var g=H/L,u=x+g*(m-x),c=U+g*(Z-U);return M&&(u+Hp<X(x,m)||u-Hp>i(x,m)||u+Hp<X(P,K)||u-Hp>i(P,K)||c+Hp<X(U,Z)||c-Hp>i(U,Z)||c+Hp<X(f,_)||c-Hp>i(f,_))?w:[u,c]}return w},Qf=function(L,o,l){if(L&&l)if(o){if(o===zc)return L.getStyle(l);if(o===Rn)return L.getAttr(l);if(o===zm)return L[l]}else if(l=dq(l),L[l])return L[l]();return r},Qi=function(C,B,f,R){if(C&&f)if(B){if(B===zc)C.s(f,R);else if(B===Rn)C.a(f,R);else if(B===zm){var E=C[f];C[f]=R,C.fp("f:"+f,E,R)}}else f=Pm(f),C[f]&&C[f](R)},Qo=function(g,x){var c,N,H,u=!1;return(Qf(g,zc,"shadow")||x&&"shadow"===Qf(g,zc,"select.type"))&&(c=Qf(g,zc,"shadow.offset.x")||0,N=Qf(g,zc,"shadow.offset.y")||0,H=Qf(g,zc,"shadow.blur")||0,u=!0),!u&&Qf(g,zc,"shadow2")&&(c=Qf(g,zc,"shadow2.offset.x")||0,N=Qf(g,zc,"shadow2.offset.y")||0,H=Qf(g,zc,"shadow2.blur")||0,u=!0),u?1.5*H+Math.max(c,N):0},Gg=function(k,j,I,Q){return Q=0===I?0:Q||0,j&&"top"!==j?"bottom"===j?{x:k.x-Q,y:k.y-Q,width:k.width+2*Q,height:k.height*I+Q}:"right"===j?{x:k.x-Q,y:k.y-Q,width:k.width*I+Q,height:k.height+2*Q}:"left"===j?{x:k.x+k.width*(1-I),y:k.y-Q,width:k.width*I+Q,height:k.height+2*Q}:void 0:{x:k.x-Q,y:k.y+k.height*(1-I),width:k.width+2*Q,height:k.height*I+Q}},rc=function(s,H,Y,D,_){H&&pb(s,Y,D,1,_,H)},Jf=function(x,P,S,s){var X=1-x;return X*X*P+2*x*X*S+x*x*s},qg=function(c,J,Z,V,f){var M=1-c;return M*M*M*J+3*M*M*c*Z+3*M*c*c*V+c*c*c*f},th=function($){var J,I,L,t,N=0;return $.forEach(function(j){if(J=j.length,J>0)for(I=j[0],t=1;J>t;t++)L=j[t],N+=qd(I,L),I=L}),N},mp=function(l,D,I){var M="__"+l,L=function(n){("mousedown"===l||"mouseup"===l||"touchstart"===l||"touchend"===l)&&Ir(n),I.disabled||I["handle_"+l](n)};I[M]||(I[M]=L,B(D,l,L))},dc=function(V,Y,A){var r="__"+V,X=A[r];X&&(q(Y,V,X),delete A[r])},vj=function(O,S){var P="_"+S;O[dq(S)]=function(){return this[P]},O[Pm(S)]=function(w){var M=this[P];this[P]=w,this.fp(S,M,w)}},sp=function(z){return R.create(z)},Jl=function(T){if(!T.element){var E,j;(E=T.textField)?j=Hb(Ws.TextField,E):(E=T.textArea)?j=Hb(Ws.TextArea,E):(E=T.button)?j=Hb(Ws.Button,E):(E=T.comboBox)?j=Hb(Ws.ComboBox,E):(E=T.checkBox)?j=Hb(Ws.CheckBox,E):(E=T.radioButton)?j=Hb(Ws.RadioButton,E):(E=T.slider)?j=Hb(Ws.Slider,E):(E=T.colorPicker)?j=Hb(Ws.ColorPicker,E):(E=T.image)&&(j=Hb(Ws.Image,E)),j&&(T.element=j)}},xf=function(H,R){var i=Zn(H);return i._ht=R,i},Uk=x.top===x?x.top:x||x.document,Zn=function(s,J){var d=A.createElement("div"),e=d.style;return d.tabIndex=-1,d.onkeydown=mc,e.msTouchAction=to,_h(d,w,0),re&&e.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",w),s&&(e.overflow=$h),J&&Ld(J,d),d},de=function(p,V){var Q=A.createElement("canvas"),u=Q.style;return u.msTouchAction=to,V||(u.pointerEvents=to),_h(Q,w,0),p&&Ld(p,Q),Q},_h=function(P,Q,q){var I=P.style;I.border=Q?Q+" solid 1px":0,I.outline=0,I.padding=q?"0 "+q+qf:0,es(P)},es=function(r){var x=r.style;x.position=$b,x.margin=0,x.setProperty("box-sizing","border-box",w),x.setProperty("-moz-box-sizing","border-box",w)},Vp=function(j,x,d,y){y||(y=Co),x!=w&&(j.width=x*y,j.style.width=x+qf),d!=w&&(j.height=d*y,j.style.height=d+qf)},Ld=function(W,E,g){W.appendChild(E),g&&(E.style.position=$b)},eh=function(i,G){G.split||(G+="");for(var m,g=G.split("\n"),Y=0,D=g.length,_=0;D>_;_++){var B=Oq(i.font,g[_]);B.width>Y&&(Y=B.width),m||(m=B.height)}return i.ss=g,{width:Y,height:m*D}},tq=function(E,m,X,u,K,$){var J=m.length;if(1===J)Yi(E,m[0],X,u,K);else for(var Q=X.height/J,I={x:X.x,y:X.y,width:X.width,height:Q},S=0;S<m.length;S++)$?Uq(E,m[S],u,K,I.x,I.y,I.width,I.height,$):Yi(E,m[S],I,u,K),I.y+=Q},Yi=function(T,Z,v,$,g){T.font=$?$:iq,T.fillStyle=g?g:Cr,T.textAlign=Yg,T.textBaseline=Rk;var u,m;v?v.width===r?(u=v.x,m=v.y):(u=v.x+v.width/2,m=v.y+v.height/2):(u=0,m=0),T.fillText(Z,N(u),N(m))},Bg=function(r){r.getView&&(r=r.getView());var P=r.offsetWidth||r.scrollWidth;return!P&&r.style.width&&(P=Sq(r.style.width)),P},rg=function(f){f.getView&&(f=f.getView());var A=f.offsetHeight||f.scrollHeight;return!A&&f.style.height&&(A=Sq(f.style.height)),A},jg=function(o,I,v){var J=I[0].toUpperCase()+I.substring(1,I.length);o["webkit"+J]=v,o["moz"+J]=v,o["ms"+J]=v,o["o"+J]=v,o[I]=v},ik=function(){var C=function(Z){mc(Z),Z.stopPropagation()},q=function(g){mc(g)},i=[ib,yq,Ur];return function(s,j){var z=Zn(),$=z.style;return $.backgroundColor=Y.disabledBackground,s&&($.backgroundImage="url("+s+")",$.backgroundPosition="50% 50%",$.backgroundRepeat="no-repeat no-repeat"),j===!1?i.forEach(function(g){B(z,g,q)}):i.forEach(function(l){B(z,l,C)}),z}}(),_d=function(a){var A=a.getContext("2d");return A.save(),A.lineCap=zn,A.lineJoin=nf,A},Kh=function(k,h,O,C){Hn(k,h*Co,O*Co),C*=Co,1!==C&&k.scale(C,C)},Hn=function(K,e,F){K.translate(e,F)},An=function(n,q){q&&n.rotate(q)},lq=function(G,$,g){$===r&&($=1),g===r&&(g=1),(1!==$||1!==g)&&G.scale($,g)},or=!1,E=Uk[af[1]+kh[0]],hj=function(u){var d=A.activeElement;if(A.activeElement!==u){d&&d.forceOnblur&&d.forceOnblur();for(var t=[],Z=u.parentNode;Z;)t.push([Z,Z.scrollLeft,Z.scrollTop]),Z=Z.parentNode;if(!or){var o=[],b=[];try{for(var P=x.parent,M=x;P!==M;)o.push([P,P.scrollX,P.scrollY]),M=P,P=x.parent;var v=x.frameElement;if(v)for(var F=v.parentNode;F;)b.push([F,F.scrollLeft,F.scrollTop]),F=F.parentNode}catch(w){or=!0}}if(re)u.focus();else{var i=ji(),D=i.target;u.focus(),D.scrollLeft=i.left,D.scrollTop=i.top}t.forEach(function(F){F[0].scrollLeft=F[1],F[0].scrollTop=F[2]}),or||(o.forEach(function(B){B[0].scrollTo(B[1],B[2])}),b.forEach(function(K){K[0].scrollLeft=K[1],K[0].scrollTop=K[2]}))}},Ie=function(I){return I&&I.getView?I.getView():I},Ni=function(v,k,G,j,C){if(2===arguments.length&&(G=k.y,j=k.width,C=k.height,k=k.x),v.isSelfViewEvent)v.setX(k),v.setY(G),v.setWidth(j),v.setHeight(C);else{var O=Ie(v),n=O.style;if((A.fullscreenElement||A.mozFullScreenElement||A.webkitFullscreenElement||A.msFullscreenElement)!==O)k!==r&&(n.left=k+qf),G!==r&&(n.top=G+qf),j!==r&&(n.width=j+qf),C!==r&&(n.height=C+qf);else{var h=Y.getWindowInfo();n.left=(k=h.left)+qf,n.top=(G=h.top)+qf,n.width=(j=h.width)+qf,n.height=(C=h.height)+qf}v.endEditing&&!re&&v.endEditing(),v.redraw&&v.redraw(),v.invalidate&&v.invalidate(),v.onLayouted&&v.onLayouted(k,G,j,C),v.fireViewEvent&&v.fireViewEvent("layout")}},Ig=function(z){if(!z.touches)return z;var L=z.touches[0];return L?L:z.changedTouches[0]},hi=function(F){return Rl(F)?Ig(F).target:F.target},Rl=function(j){return j&&"object"==typeof j&&"touches"in j},Nk=function(e){Y.popup&&Y.popup.close(),Y.popup=e},Nr=w,Pc=function(N){Nr.handleWindowTouchMove(N)},Hr=function(O){Nr.handleWindowTouchEnd(O),q(x,fe,Pc),q(x,_g,Hr),Nr=w},lj=function(G){Nr.handleWindowMouseMove(G)},ym=function(m){Nr.handleWindowMouseUp(m),q(x,Vj,lj),q(x,lh,ym),Nr=w},If=function(S){return 1===Sf(S)},ff=function(L,g){return g?g.keyCode===L:qi[L]},Ak=function(g){return Xm(g)&&ff(65,g)},Zd=function(f){return ff(46,f)||ff(8,f)},ko=function(N){return function(P){return P?P.keyCode===N:qi[N]}},Jp=573,ol=[65,83,68,87,37,38,39,40,32,13,27],qo=ko(ol[0]),nk=ko(ol[1]),ud=ko(ol[2]),Gd=ko(ol[3]),Yf=ko(ol[4]),Cc=ko(ol[5]),Ve=ko(ol[6]),hs=ko(ol[7]),Fg=ko(ol[8]),sk=ko(ol[9]),bo=ko(ol[10]),Ti={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},mh=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,7,4027],Gr=w,ip=w,gm=function(U,z){Gr||(Gr=de()),Vp(Gr,U,z,1);var C=_d(Gr);return C.clearRect(0,0,U,z),C},Di=function(u,M,r){if(M&&u){if("override"===r)return M;if("override_rgb"===r){var K=er(M);return u=Dl(u),"rgba("+N(255*K[0])+","+N(255*K[1])+","+N(255*K[2])+","+u[3]/255+")"}if("override_a"===r){var K=er(M);return u=Dl(u),"rgba("+u[0]+","+u[1]+","+u[2]+","+K[3]+")"}if("multiply_destinationAtop"===r){var f=fq(er(u)),n=f[3],T=fq(er(M)),p=T[3],F=fq(f),s=F[3],$=f.map(function(I,$){return I*T[$]}),D=1-n,y=1-p,A=y*n+p;return f=f.map(function(Z,Q){return(p*D*T[Q]+p*n*$[Q]+y*n*Z)/A}),n=A,D=1-n,f=f.map(function(i,U){return(s*F[U]*D+n*i*s)/s}),n=s,"rgba("+N(255*f[0])+","+N(255*f[1])+","+N(255*f[2])+","+n+")"}var K=er(M);return u=Dl(u),"rgba("+N(u[0]*K[0])+","+N(u[1]*K[1])+","+N(u[2]*K[2])+","+u[3]/255*K[3]+")"}return u},Dl=function(){var V,Y={};for(var A in x){var W=ao.length;if(A.length==W&&A[0]===ao[2]&&A[1]===to[1]&&A[4]===ao[3]&&A[5]===ao[4]&&A.substr(W-2)===to[1]+to[2]){var O=x[A];for(var c in O)c.length===W&&c.substr(0,3)===hn[3]+Ge[3]+nq[0]&&c.substr(W-2)===ao[0]+uh[3]&&(we=O[c])}}return function(N){var p,c=Y[N];return c||(V||(V=de(),Vp(V,1,1,1)),p=V.getContext("2d"),p.clearRect(0,0,1,1),pb(p,0,0,1,1,N),c=p.getImageData(0,0,1,1).data,c=Y[N]=[c[0],c[1],c[2],c[3]]),c}}(),er=function(p){if(!ap(p))return p;var r=Dl(p);return r.CA||(r.CA=[r[0]/255,r[1]/255,r[2]/255,r[3]/255]),r.CA},Wi=function(n,N,I,i,o){var M=de();M.width=I,M.height=i;var E=M.getContext("2d");E.drawImage(n,0,0,I,i);try{for(var T=E.getImageData(0,0,I,i),q=T.data,S=0,R=q.length;R>S;S+=4){var B=q[S+0],p=q[S+1],g=q[S+2],l=q[S+3];"override_a"===o?q[S+3]=255*N[3]:"override_rgb"===o?(q[S+0]=255*N[0],q[S+1]=255*N[1],q[S+2]=255*N[2]):"override"===o?(q[S+0]=255*N[0],q[S+1]=255*N[1],q[S+2]=255*N[2],q[S+3]=255*N[3]):(q[S+0]=N[0]*B,q[S+1]=N[1]*p,q[S+2]=N[2]*g,q[S+3]=N[3]*l)}E.putImageData(T,0,0)}catch(y){return n}return M},gf=function(m,R,K){return R&&(R="miter"===K?8*R+20:R+1,m&&xg(m,R)),R},Vi=function(Q,N){if(N){var T=new $r(N),I=Q.width/2,H=Q.height/2,m=ln([T.tf(-I,-H),T.tf(I,-H),T.tf(I,H),T.tf(-I,H)]);return m.x+=Q.x+I,m.y+=Q.y+H,m}return Q},vc=function(g,A,O,o,F,n,p,J){o*=Math.PI/180;var y={x:Math.cos(o)*(g.x-p.x)/2+Math.sin(o)*(g.y-p.y)/2,y:-Math.sin(o)*(g.x-p.x)/2+Math.cos(o)*(g.y-p.y)/2},$=Math.pow(y.x,2)/Math.pow(A,2)+Math.pow(y.y,2)/Math.pow(O,2);$>1&&(A*=Math.sqrt($),O*=Math.sqrt($));var z=(F==n?-1:1)*Math.sqrt((Math.pow(A,2)*Math.pow(O,2)-Math.pow(A,2)*Math.pow(y.y,2)-Math.pow(O,2)*Math.pow(y.x,2))/(Math.pow(A,2)*Math.pow(y.y,2)+Math.pow(O,2)*Math.pow(y.x,2)));isNaN(z)&&(z=0);var a={x:z*A*y.y/O,y:z*-O*y.x/A},s={x:(g.x+p.x)/2+Math.cos(o)*a.x-Math.sin(o)*a.y,y:(g.y+p.y)/2+Math.sin(o)*a.x+Math.cos(o)*a.y},I=function(E){return Math.sqrt(Math.pow(E[0],2)+Math.pow(E[1],2))},e=function(i,j){return(i[0]*j[0]+i[1]*j[1])/(I(i)*I(j))},v=function(S,g){return(S[0]*g[1]<S[1]*g[0]?-1:1)*Math.acos(e(S,g))},C=v([1,0],[(y.x-a.x)/A,(y.y-a.y)/O]),l=[(y.x-a.x)/A,(y.y-a.y)/O],t=[(-y.x-a.x)/A,(-y.y-a.y)/O],_=v(l,t);e(l,t)<=-1&&(_=Math.PI),e(l,t)>=1&&(_=0);var e=A>O?A:O,D=A>O?1:A/O,u=A>O?O/A:1;if(null==J){var H={x:0,y:0,width:0,height:0};xg(H,e),H.x*=D,H.width*=D,H.y*=u,H.height*=u;var h=new $r(o);return H=ln([h.tf(H.x,H.y),h.tf(H.x+H.width,H.y),h.tf(H.x+H.width,H.y+H.height),h.tf(H.x,H.y+H.height)]),H.x+=s.x,H.y+=s.y,[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}]}J.translate(s.x,s.y),J.rotate(o),J.scale(D,u),J.arc(0,0,e,C,C+_,1-n),J.scale(1/D,1/u),J.rotate(-o),J.translate(-s.x,-s.y)},Wb=function(C,Z){C&&C.beginPath();for(var t,s,z,d=[],J=function(s){for(var D,F=/(\-{0,1}[\d\.]+)/gi,g=[];D=F.exec(s);)g.push(parseFloat(D[0]));return g},p=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,H={x:0,y:0};t=p.exec(Z);){var n=t[0],M=n.substr(0,1);if("M"===M||"m"===M){for(var q=J(n),c=0;c<q.length;c+=2){var g=q[c],D=q[c+1];"m"===M&&(g+=H.x,D+=H.y),C&&C.moveTo(g,D),d.push({x:g,y:D}),H.x=g,H.y=D}s=z=null}else if("H"===M||"h"===M){for(var q=J(n),c=0;c<q.length;c+=1){var g=q[c];"h"===M&&(g+=H.x),C&&C.lineTo(g,H.y),d.push({x:g,y:H.y}),H.x=g}s=z=null}else if("C"===M||"c"===M){for(var q=J(n),c=0;c<q.length;c+=6){var _=q[c],G=q[c+1],o=q[c+2],y=q[c+3],g=q[c+4],D=q[c+5];"c"===M&&(_+=H.x,G+=H.y,o+=H.x,y+=H.y,g+=H.x,D+=H.y),C&&C.bezierCurveTo(_,G,o,y,g,D),d.push({x:_,y:G}),d.push({x:o,y:y}),d.push({x:g,y:D}),H.x=g,H.y=D}s=[_,G,o,y,g,D],z=null}else if("S"===M||"s"===M){for(var q=J(n),c=0;c<q.length;c+=4){var _,G;s?(_=2*s[4]-s[2],G=2*s[5]-s[3]):(_=H.x,G=H.y);var o=q[c],y=q[c+1],g=q[c+2],D=q[c+3];"s"===M&&(o+=H.x,y+=H.y,g+=H.x,D+=H.y),C&&C.bezierCurveTo(_,G,o,y,g,D),d.push({x:_,y:G}),d.push({x:o,y:y}),d.push({x:g,y:D}),H.x=g,H.y=D}s=[_,G,o,y,g,D],z=null}else if("Q"===M||"q"===M){for(var q=J(n),c=0;c<q.length;c+=4){var _=q[c],G=q[c+1],g=q[c+2],D=q[c+3];"q"===M&&(_+=H.x,G+=H.y,g+=H.x,D+=H.y),C&&C.quadraticCurveTo(_,G,g,D),d.push({x:_,y:G}),d.push({x:g,y:D}),H.x=g,H.y=D}s=null,z=[_,G,g,D]}else if("T"===M||"t"===M){for(var q=J(n),c=0;c<q.length;c+=2){var _,G;z?(_=2*z[2]-z[0],G=2*z[3]-z[1]):(_=H.x,G=H.y);var g=q[c],D=q[c+1];"t"===M&&(g+=H.x,D+=H.y),C&&C.quadraticCurveTo(_,G,g,D),d.push({x:_,y:G}),d.push({x:g,y:D}),H.x=g,H.y=D}s=null,z=[_,G,g,D]}else if("V"===M||"v"===M){for(var q=J(n),c=0;c<q.length;c+=1){var D=q[c];"v"===M&&(D+=H.y),C&&C.lineTo(H.x,D),d.push({x:H.x,y:D}),H.y=D}s=z=null}else if("L"===M||"l"===M){for(var q=J(n),c=0;c<q.length;c+=2){var g=q[c],D=q[c+1];"l"===M&&(g+=H.x,D+=H.y),C&&C.lineTo(g,D),d.push({x:g,y:D}),H.x=g,H.y=D}s=z=null}else if("A"===M||"a"===M){for(var q=J(n),c=0;c<q.length;c+=7){var W=q[c],N=q[c+1],K=q[c+2],m=q[c+3],Y=q[c+4],g=q[c+5],D=q[c+6];"a"===M&&(g+=H.x,D+=H.y);var E=vc(H,W,N,K,m,Y,{x:g,y:D},C);E&&(d=d.concat(E)),H.x=g,H.y=D}s=z=null}var P=n.substr(n.length-1);("z"===P||"Z"===P)&&C&&C.closePath()}return d},io=function(O,f,X){var J,Q,e="L"===f[0],U=f.length;O.save(),e?(O.transform(f[5],f[6],f[7],f[8],f[9],f[10]),J=O.createLinearGradient(f[1],f[2],f[3],f[4]),Q=11):(O.transform(f[7],f[8],f[9],f[10],f[11],f[12]),J=O.createRadialGradient(f[1],f[2],f[3],f[4],f[5],f[6]),Q=13);for(var c=O.compGray;U>Q;){var S=f[Q+1];S=X(S),J.addColorStop(f[Q],c?Y.toGrayColor(S):S),Q+=2}return O.fillStyle=J,J},kf=function(b,n){var m=b.s("shape.gradient.pack");if(m){for(var M=m.length,F=new Array(M),w=0;M>w;w++)F[w]=m[w];var l,T,_,E,j,x,f,H,B,o,p,A,Y,X="L"===F[0];l=X?5:7,T=F[l],_=F[l+1],E=F[l+2],j=F[l+3],x=F[l+4],f=F[l+5],H=n[0],B=n[1],o=n[2],p=n[3],A=n[4],Y=n[5],F[l]=H*T+o*_,F[l+1]=B*T+p*_,F[l+2]=H*E+o*j,F[l+3]=B*E+p*j,F[l+4]=H*x+o*f+A,F[l+5]=B*x+p*f+Y,b.s("shape.gradient.pack",F)}},bb=function(v,G,u,e){var R=!1;if(v.beginPath?v.beginPath():R=!0,aq(G)&&(G=G._as),aq(u)&&(u=u._as),u&&u.length){for(var M,Q,h,$,_=0,k=0,I=u.length;I>k;k++)M=u[k],1===M?(Q=G[_++],v.moveTo(Q.x,R?-Q.y:Q.y)):2===M?(Q=G[_++],v.lineTo(Q.x,R?-Q.y:Q.y)):3===M?(Q=G[_++],h=G[_++],v.quadraticCurveTo(Q.x,R?-Q.y:Q.y,h.x,R?-h.y:h.y)):4===M?(Q=G[_++],h=G[_++],$=G[_++],v.bezierCurveTo(Q.x,R?-Q.y:Q.y,h.x,R?-h.y:h.y,$.x,R?-$.y:$.y)):5===M&&v.closePath();e&&5!==M&&v.closePath()}else{var l,A,x,O=G.length;if(O>0){for(l=G[0],v.moveTo(l.x,R?-l.y:l.y),A=1;O>A;A++)x=G[A],v.lineTo(x.x,R?-x.y:x.y);e&&v.closePath()}}},Fi=function(E,M,C,m){if(aq(E)&&(E=E._as),aq(M)&&(M=M._as),M&&M.length){C=C||yl;for(var g,i,V,x,L,P,R,d,u=[],H=w,z=0,B=0,K=M.length;K>B;B++)if(g=M[B],1===g)u.push(H=[]),H.push(E[z++]);else if(2===g)H.push(E[z++]);else if(3===g){for(i=H[H.length-1],V=E[z++],x=E[z++],P=1;C>P;P++)R=Jf(P/C,i.x,V.x,x.x),d=Jf(P/C,i.y,V.y,x.y),H.push({x:R,y:d,b:!0});H.push(x)}else if(4===g){for(i=H[H.length-1],V=E[z++],x=E[z++],L=E[z++],P=1;C>P;P++)R=qg(P/C,i.x,V.x,x.x,L.x),d=qg(P/C,i.y,V.y,x.y,L.y),H.push({x:R,y:d,b:!0});H.push(L)}else 5===g&&H.push(H[0]);return m&&5!==g&&H&&H.length>2&&H.push(H[0]),u}return m&&E.length>2&&(E=E.slice(),E.push(E[0])),E?[E]:[]},Sn=function(Z,B,g,z,s,R){var h,t,j,Y=Dl(B),o=z,_=Y[0],k=Y[1],a=Y[2];if(g){var m=Dl(g);h=m[0]-_,t=m[1]-k,j=m[2]-a}else h=255-_,t=255-k,j=255-a;for(R||(R=z>10?1:.5,R=1>s?X(R/s,2):R),Z.save(),Z.shadowOffsetX=0,Z.shadowOffsetY=0,Z.shadowBlur=0,Z.shadowColor=0;(z-=R)>0;){var W=1-z/o,N=_+h*W,C=k+t*W,x=a+j*W;N=X(v(N),255),C=X(v(C),255),x=X(v(x),255),Z.strokeStyle="rgb("+N+","+C+","+x+")",Z.lineWidth=z,Z.stroke()}Z.restore()},uc=function(){var g={};return function(Z,i){var p=Z+"-"+i,C=g[p];if(C)return C;var P,t,z,R=Dl(Z);return 0>i?(i=(100+i)/100,P=v(R[0]*i),t=v(R[1]*i),z=v(R[2]*i)):(i/=100,P=R[0],t=R[1],z=R[2],P+=(255-P)*i,t+=(255-t)*i,z+=(255-z)*i,P=X(v(P),255),t=X(v(t),255),z=X(v(z),255)),g[p]="rgb("+P+","+t+","+z+")"}}(),pb=function(A,q,G,Y,I,D){D&&(A.fillStyle=D),A.beginPath(),A.rect(q,G,Y,I),A.fill()},Po=function(j,U,B,Q,K,H,E){j.beginPath(),up[U](j,B.x,B.y,B.width,B.height,Q,K,H,E)},jq=function(P,t,u,O,i){var c=up[u];P.fillStyle=c?c(P,t,O?O:Io,i.x,i.y,i.width,i.height):t},Yk=function($,H,S,v,M,z){$.fillStyle=ch($,H,S,v,M,z)},ni=function(x,X,f,l,W,k){x.strokeStyle=ch(x,X,f,l,W,k)},ch=function(W,K,h,O,k,E){var t;try{if(!K.tagName&&K.comps){K._cacheImage_||(K._cacheImage_={});var S;S="override"===O?"colors_override":"override_rgb"===O?"colors_override_rgb":"override_a"===O?"colors_override_a":"colors",K._cacheImage_[S]||(K._cacheImage_[S]={__count__:0});var D=K._cacheImage_[S][h];D||(K._cacheImage_[S].__count__>Y.imageCacheThreshold&&(K._cacheImage_[S]={__count__:0}),D=s.Default.toCanvas(K,To(K),md(K),null,k,E,h,null,O),K._cacheImage_[S][h]=D,K._cacheImage_[S].__count__++),K=D}t=W.createPattern(K,"repeat")}catch(Q){t="black"}return t},Wq=function(e){var B,N,R=[],w=0,X=e.length;for(B=0;65>B;B++)R[B]=B;for(B=0;65>B;B++)w=(w+R[B]+e.charCodeAt(B%X))%65,N=R[B],R[B]=R[w],R[w]=N;for(B=0;65>B;B++)R[B]=Tk[R[B]];return R.join("")},dm=function(Q){for(var v=8+ar.randomInt(8),f=Tk[8*ar.randomInt(8)+(v-8)],$="",W=0;v>W;W++)$+=Tk[ar.randomInt(64)];var z=Wq($+D+Zm+Yd);return f+$+tm.encode(Q,z)},Cq=function(w){var J=w[0],C=Tk.indexOf(J);if(0>C)return"";C=8+(7&C);var j=w.slice(1,1+C),y=Wq(j+D+Zm+Yd);return tm.decode(w,y,1+C)},bj=function(T,d,p,e,R,i,C){T.save(),T.translate(d,p),T.scale(1,C/i),T.arc(0,0,i,e,R),T.restore()},Oj=function(w,r,L,h,S,l,t,u){var I,j,B,$,W,a,z,U,R,Q,Z;if(J(S)>2*g&&(S=2*g),W=v(J(S)/(g/4)),I=S/W,j=-I,B=-h,W>0){a=r+f(h)*l,z=L+O(-h)*t,u?w.lineTo(a,z):w.moveTo(a,z);
for(var E=0;W>E;E++)B+=j,$=B-j/2,U=r+f(B)*l,R=L+O(B)*t,Q=r+f($)*(l/f(j/2)),Z=L+O($)*(t/f(j/2)),w.quadraticCurveTo(Q,Z,U,R)}},ij=function(Y,v,C,w,n,I,d,l,Z){6===arguments.length&&(d=I,l=I,Z=I);var A=v+w,r=C+n,G=n>w?2*w:2*n;I=G>I?I:G,d=G>d?d:G,l=G>l?l:G,Z=G>Z?Z:G;var h=.29*Z,p=.58*Z;Y.moveTo(A,r-Z),Y.quadraticCurveTo(A,r-p,A-h,r-h),Y.quadraticCurveTo(A-p,r,A-Z,r),h=.29*l,p=.58*l,Y.lineTo(v+l,r),Y.quadraticCurveTo(v+p,r,v+h,r-h),Y.quadraticCurveTo(v,r-p,v,r-l),h=.29*I,p=.58*I,Y.lineTo(v,C+I),Y.quadraticCurveTo(v,C+p,v+h,C+h),Y.quadraticCurveTo(v+p,C,v+I,C),h=.29*d,p=.58*d,Y.lineTo(A-d,C),Y.quadraticCurveTo(A-p,C,A-h,C+h),Y.quadraticCurveTo(A,C+p,A,C+d),Y.lineTo(A,r-Z)},$d=function(U,T,E,p,w,L,y){T&&(E=N(E),p=N(p),y||(y=1),U.fillStyle=T,U.beginPath(),U.rect(E,p,y,L),U.rect(E,p,w,y),L-y>0&&U.rect(E,p+L-y,w,y),w-y>0&&U.rect(E+w-y,p,y,L),U.fill())},zf=function(R,j,y,L){var a=L.x,p=L.y,l=L.width,f=L.height;if(!(!j||!y||0>=l||0>=f)){var C,v=tn(j),s=hf(j),Z=y>0;1===y||-1===y?(R.fillStyle=Z?v:s,R.beginPath(),R.rect(a,p,1,f),R.rect(a,p,l,1),R.fill(),R.fillStyle=Z?s:v,R.beginPath(),R.rect(a,p+f-1,l,1),R.rect(a+l-1,p,1,f),R.fill()):(y=X(J(y),X(l/2,f/2)),C=R.createLinearGradient(a,p,a+y,p),C.addColorStop(0,Z?v:s),C.addColorStop(1,j),R.fillStyle=C,R.beginPath(),R.moveTo(a,p),R.lineTo(a+y,p+y),R.lineTo(a+y,p+f-y),R.lineTo(a,p+f),R.lineTo(a,p),R.fill(),C=R.createLinearGradient(a,p,a,p+y),C.addColorStop(0,Z?v:s),C.addColorStop(1,j),R.fillStyle=C,R.beginPath(),R.moveTo(a,p),R.lineTo(a+y,p+y),R.lineTo(a+l-y,p+y),R.lineTo(a+l,p),R.lineTo(a,p),R.fill(),C=R.createLinearGradient(a,p+f,a,p+f-y),C.addColorStop(0,Z?s:v),C.addColorStop(1,j),R.fillStyle=C,R.beginPath(),R.moveTo(a,p+f),R.lineTo(a+y,p+f-y),R.lineTo(a+l-y,p+f-y),R.lineTo(a+l,p+f),R.lineTo(a,p+f),R.fill(),C=R.createLinearGradient(a+l,p,a+l-y,p),C.addColorStop(0,Z?s:v),C.addColorStop(1,j),R.fillStyle=C,R.beginPath(),R.moveTo(a+l,p),R.lineTo(a+l-y,p+y),R.lineTo(a+l-y,p+f-y),R.lineTo(a+l,p+f),R.lineTo(a+l,p),R.fill())}},gb=function(C,Q,i,q,W,v,o){var J=C.createLinearGradient(q,W,v,o);return J.addColorStop(0,i),J.addColorStop(1,Q),J},Rm=function(m,J,y,g,x,G,p){var K=m.createLinearGradient(g,x,G,p);return K.addColorStop(0,J),K.addColorStop(.5,y),K.addColorStop(1,J),K},Sr=function(S,C,e,z,_,f,A){var K=S.createLinearGradient(z,_,f,A);return K.addColorStop(0,C),K.addColorStop(1/3,e),K.addColorStop(2/3,C),K.addColorStop(1,e),K},Eg=function(N,a,U,C,t,P,A,I,_){var v=N.createRadialGradient(C+P*I,t+A*_,X(P,A)/24,C+P/2,t+A/2,i(P,A)/2);return v.addColorStop(0,U),v.addColorStop(1,a),v},Cp=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],up={polygon:function(d,K,H,l,F,_){(_==w||3>_)&&(_=6);for(var m,j,b=X(l,F)/2,Q=K+l/2,r=H+F/2,A=0,h=2*g/_,P=0;_>P;P++)m=Q+f(A)*b,j=r+O(A)*b,0===P?d.moveTo(m,j):d.lineTo(m,j),A+=h;d.closePath()},arc:function(S,u,$,x,r,R,M,D,n){R==w&&(R=g),M==w&&(M=c),D==w&&(D=!0);var q=u+x/2,f=$+r/2;D&&S.moveTo(q,f),n?bj(S,q,f,R,M,x/2,r/2):S.arc(q,f,X(x,r)/2,R,M),D&&S.closePath()},rect:function(G,A,Z,E,$){G.rect(A,Z,E,$)},circle:function(z,q,O,h,a){z.arc(q+h/2,O+a/2,X(h,a)/2,0,c,!0)},oval:function(M,t,k,w,P){bj(M,t+w/2,k+P/2,0,c,w/2,P/2)},roundRect:function(k,T,A,S,p,z){z==w&&(z=X(X(S,p)/4,8)),ij(k,T,A,S,p,z)},star:function(t,J,V,W,T){var d=2*W,n=2*T,_=J+W/2,C=V+T/2;t.moveTo(_-d/4,C-n/12),t.lineTo(J+.306*W,V+.579*T),t.lineTo(_-d/6,C+n/4),t.lineTo(J+W/2,V+.733*T),t.lineTo(_+d/6,C+n/4),t.lineTo(J+.693*W,V+.579*T),t.lineTo(_+d/4,C-n/12),t.lineTo(J+.611*W,V+.332*T),t.lineTo(_+0,C-n/4),t.lineTo(J+.388*W,V+.332*T),t.closePath()},pentagram:function($,A,U,i,x){var c=.5*x,o=A+.5*i,u=U+c,M=.5257311121191336*i;M>c&&(M=c);var d=Cp,O=0;for($.moveTo(o+M*d[O++],u+M*d[O++]);20>O;)$.lineTo(o+M*d[O++],u+M*d[O++]);$.closePath()},triangle:function(F,n,T,x,Q){F.moveTo(n+x/2,T),F.lineTo(n+x,T+Q),F.lineTo(n,T+Q),F.closePath()},hexagon:function(u,s,U,i,_){u.moveTo(s,U+_/2),u.lineTo(s+i/4,U+_),u.lineTo(s+3*i/4,+U+_),u.lineTo(s+i,U+_/2),u.lineTo(s+3*i/4,U),u.lineTo(s+i/4,U),u.closePath()},pentagon:function(h,s,B,m,G){var C=2*m,O=2*G,F=s+m/2,D=B+G/2;h.moveTo(F-C/4,D-O/12),h.lineTo(F-C/6,D+O/4),h.lineTo(F+C/6,D+O/4),h.lineTo(F+C/4,D-O/12),h.lineTo(F+0,D-O/4),h.closePath()},diamond:function(U,l,r,M,$){U.moveTo(l+M/2,r),U.lineTo(l,r+$/2),U.lineTo(l+M/2,r+$),U.lineTo(l+M,r+$/2),U.closePath()},rightTriangle:function(n,d,j,S,e){n.moveTo(d,j),n.lineTo(d+S,j+e),n.lineTo(d,j+e),n.closePath()},parallelogram:function(W,t,n,d,m){var N=d/4;W.moveTo(t+N,n),W.lineTo(t+d,n),W.lineTo(t+d-N,n+m),W.lineTo(t,n+m),W.closePath()},trapezoid:function(t,Y,Q,h,i){var X=h/4;t.moveTo(Y+X,Q),t.lineTo(Y+h-X,Q),t.lineTo(Y+h,Q+i),t.lineTo(Y,Q+i),t.closePath()},"linear.southwest":function(G,k,X,x,r,Q,L){return gb(G,k,X,x,r+L,x+Q,r)},"linear.southeast":function(E,Y,F,n,l,q,x){return gb(E,Y,F,n+q,l+x,n,l)},"linear.northwest":function(r,V,o,c,f,g,L){return gb(r,V,o,c,f,c+g,f+L)},"linear.northeast":function(i,R,P,r,$,x,H){return gb(i,R,P,r+x,$,r,$+H)},"linear.north":function(d,L,z,o,h,Z,X){return gb(d,L,z,o,h,o,h+X)},"linear.south":function(D,Z,h,R,v,p,t){return gb(D,Z,h,R,v+t,R,v)},"linear.west":function(U,C,J,h,r,l){return gb(U,C,J,h,r,h+l,r)},"linear.east":function(E,R,h,k,t,F){return gb(E,R,h,k+F,t,k,t)},"radial.center":function(l,q,Q,_,Z,T,y){return Eg(l,q,Q,_,Z,T,y,.5,.5)},"radial.southwest":function(p,b,o,R,C,k,N){return Eg(p,b,o,R,C,k,N,.25,.75)},"radial.southeast":function(I,H,E,J,C,U,l){return Eg(I,H,E,J,C,U,l,.75,.75)},"radial.northwest":function(b,U,B,Q,K,k,J){return Eg(b,U,B,Q,K,k,J,.25,.25)},"radial.northeast":function(u,q,e,n,v,t,w){return Eg(u,q,e,n,v,t,w,.75,.25)},"radial.north":function(_,L,R,g,a,m,d){return Eg(_,L,R,g,a,m,d,.5,.25)},"radial.south":function(A,p,N,q,u,w,K){return Eg(A,p,N,q,u,w,K,.5,.75)},"radial.west":function(z,v,e,W,T,K,x){return Eg(z,v,e,W,T,K,x,.25,.5)},"radial.east":function(E,o,L,p,q,r,t){return Eg(E,o,L,p,q,r,t,.75,.5)},"spread.horizontal":function(C,K,O,n,p,N){return Rm(C,K,O,n,p,n+N,p)},"spread.vertical":function(N,Q,W,t,m,u,v){return Rm(N,Q,W,t,m,t,m+v)},"spread.diagonal":function(Y,I,P,v,u,O,w){return Rm(Y,I,P,v+O,u,v,u+w)},"spread.antidiagonal":function(c,r,z,R,x,O,y){return Rm(c,r,z,R,x,R+O,x+y)},"spread.north":function(p,W,h,_,K,F,M){return Sr(p,W,h,_,K-M/4,_,K+M+M/4)},"spread.south":function(Z,Y,E,j,q,b,r){return Sr(Z,E,Y,j,q-r/4,j,q+r+r/4)},"spread.west":function(g,h,I,$,p,j){return Sr(g,h,I,$-j/4,p,$+j+j/4,p)},"spread.east":function(d,F,t,Y,K,M){return Sr(d,t,F,Y-M/4,K,Y+M+M/4,K)}},Uo=function(i,n,j){return new $r(i).tf(n,j)},eo=function(Y){var p=Y.touches[0],i=Y.touches[1],x=p.clientX,F=p.clientY,_=i.clientX,b=i.clientY;return G((x-_)*(x-_)+(F-b)*(F-b))},Wf=function(d){var E=d.touches[0],B=d.touches[1],l=E.clientX,q=E.clientY,G=B.clientX,n=B.clientY;return{x:(l+G)/2,y:(q+n)/2}},Bp=(function(){for(var n=0,I=ls.split(""),q=0;q<I.length;q++)n=10*Sq(I[q])+n;return Yp(x[Jp.toString(8*q)+Ij.substr(q)+3],x[Jp.toString(8*q)+Ij.substr(q)+4]),n}(),function(h,N,j){for(var b=0;b<j.size();b++){var X=j.get(b);h.co(X)&&N.add(X)}for(b=0;b<j.size();b++)X=j.get(b),Bp(h,N,X._children)}),go=function(w,S,B){for(var p=0;p<B.size();p++){var E=B.get(B.size()-1-p);w.co(E)&&S.add(E)}for(p=0;p<B.size();p++)E=B.get(p),go(w,S,E._children)},Hk=function(d,W,c){for(var t=!1,Q=0;Q<c.size();Q++){var y=c.get(Q);d.co(y)?t&&W.add(y):t=1}for(Q=0;Q<c.size();Q++)y=c.get(Q),Hk(d,W,y._children)},gg=function(i,A,R){for(var W=!1,E=0;E<R.size();E++){var l=R.get(R.size()-1-E);i.co(l)?W&&A.add(l):W=!0}for(E=0;E<R.size();E++)l=R.get(E),gg(i,A,l._children)},$m=Y.moveDatas=function(E,F,_,h){var Q=h==w;if(0!==F||0!==_||!Q&&0!==h){var f=!0,W=[];if(E.forEach(function(J){f&&(J._69O||Qq(J)||cb(J))&&(f=!1)}),f)W=E;else{var A={},y={};E.forEach(function(N){A[N._id]=!0});var Y={},T=function(F){var w=F._id;return A[w]?(W.push(F),Y[w]=!0):Y[w]=!1},u=function(j){var i=j._id;if(y[i])return T(j);var n=Y[i];if(n!==r)return n;var R=j._parent;if(R&&(cb(R)||Qq(R))&&u(R))return Y[i]=!0;var L=j._host;return L&&(y[i]=i,n=u(L),y[i]=r,n)?Y[i]=!0:T(j)};E.forEach(function(N){u(N)})}W.forEach(function(g){if(Km(g))Q?g.translate(F,_):g.translate3d(F,_,h);else{var N=g.s(cs);if(!N||N.isEmpty())return;var U=new Pk;N.each(function(b){b=fq(b),Q?(b.x+=F,b.y+=_):(b.x+=F,b.y+=h,b.e==w?b.e=_:b.e+=_),U.add(b)}),g.s(cs,U)}})}},xm=function(){function W(h,I){return I===h.substring(0,I.length)?!0:!1}function L(R){return parseFloat(R)||0}function R(O,Q){if(Q==r&&(Q=new _p),W(O,"matrix3d")){var U=O.substring(9,O.length-1).split(",");U=U.map(L),Q.fromArray(U)}else if(W(O,"matrix")){var U=O.substring(7,O.length-1).split(",");U=U.map(L),Q.el[0]=U[0],Q.el[1]=U[1],Q.el[2]=0,Q.el[3]=0,Q.el[4]=U[2],Q.el[5]=U[3],Q.el[6]=0,Q.el[7]=0,Q.el[8]=0,Q.el[9]=0,Q.el[10]=1,Q.el[11]=0,Q.el[12]=U[4],Q.el[13]=U[5],Q.el[14]=0,Q.el[15]=1}return Q}function M(s,x){x==r&&(x=new Zb);var U=s.split(/\s+/);return U=U.map(L),x.set(U[0]||0,U[1]||0,U[2]||0),x}var Q,S,v,F,B,Y=function(f,u){Q||(Q=new _p,S=new Zb,v=new _p,F=new _p,B=new _p),u==r&&(u=new _p);var C=getComputedStyle(f);C.transform&&"none"!==C.transform&&(R(C.transform,Q),M(C.transformOrigin,S),F.setPosition(S),S.negate(),B.setPosition(S),(qm||"preserve-3d"!==C.transformStyle)&&(Q.el[8]=0,Q.el[9]=0,Q.el[10]=1,Q.el[11]=0),u.multiplyMatrices(B,u),u.multiplyMatrices(Q,u),u.multiplyMatrices(F,u)),!qm&&C.perspective&&"none"!==C.perspective&&(v.el[11]=-1/L(C.perspective),M(C.perspectiveOrigin,S),F.setPosition(S),S.negate(),B.setPosition(S),u.multiplyMatrices(B,u),u.multiplyMatrices(v,u),u.multiplyMatrices(F,u));for(var m=f.offsetParent,e=f.offsetLeft,A=f.offsetTop,H=f.parentElement;H&&H!==m;){var I=getComputedStyle(H);if("none"!==I.transform||"none"!==I.perspective)break;H=H.parentElement}return H==r&&f!==f.ownerDocument.documentElement&&"fixed"!==C.position&&(H=f.ownerDocument.documentElement),m!=r&&m!==H&&(e-=H.offsetLeft,A-=H.offsetTop),S.set(e,A,0),F.setPosition(S),u.multiplyMatrices(F,u),H&&Y(H,u),u};return function(i,q){var f=i.parentElement;if(f){var H=f.updateAppendMatrix;if(H){delete f.updateAppendMatrix;var n=new _p;Y(f,n);var V=new _p;V.getInverse(n),f._matrixAppend=V,f._maxrixPreAppend=n}return q?f._matrixAppend:f._maxrixPreAppend}}}(),qq=function(Z,c){for(;Z&&!Z.hasOwnProperty(c);)Z=R.getPrototypeOf(Z);return Z&&R.getOwnPropertyDescriptor(Z,c)},lp=R.getPrototypeOf?function(I,a,b){var q=qq(a,b);q&&R.defineProperty(I,b,q)}:function(X,r,v){X[v]=r[v]},Uc={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Cm=function(){var S={1:function(I,F){return{x:I.x-F.width/2,y:I.y-F.height/2}},2:function(w,n){return{x:w.x+n.width/2,y:w.y-n.height/2}},3:function(O,M){return{x:O.x+O.width/2,y:O.y-M.height/2}},4:function(Y,c){return{x:Y.x+Y.width-c.width/2,y:Y.y-c.height/2}},5:function(n,M){return{x:n.x+n.width+M.width/2,y:n.y-M.height/2}},6:function(R){return{x:R.x,y:R.y}},7:function(w){return{x:w.x+w.width/2,y:w.y}},8:function(Z){return{x:Z.x+Z.width,y:Z.y}},9:function(q,s){return{x:q.x-s.width/2,y:q.y+s.height/2}},10:function(X,a){return{x:X.x+a.width/2,y:X.y+a.height/2}},11:function(x,s){return{x:x.x+x.width/2,y:x.y+s.height/2}},12:function(L,i){return{x:L.x-i.width/2+L.width,y:L.y+i.height/2}},13:function(V,w){return{x:V.x+V.width+w.width/2,y:V.y+w.height/2}},14:function(M,x){return{x:M.x-x.width/2,y:M.y+M.height/2}},15:function(t){return{x:t.x,y:t.y+t.height/2}},16:function(F,e){return{x:F.x+e.width/2,y:F.y+F.height/2}},17:function(F){return{x:F.x+F.width/2,y:F.y+F.height/2}},18:function(d,n){return{x:d.x+d.width-n.width/2,y:d.y+d.height/2}},19:function(X){return{x:X.x+X.width,y:X.y+X.height/2}},20:function(D,U){return{x:D.x+D.width+U.width/2,y:D.y+D.height/2}},21:function(x,W){return{x:x.x-W.width/2,y:x.y+x.height-W.height/2}},22:function(T,U){return{x:T.x+U.width/2,y:T.y+T.height-U.height/2}},23:function(N,u){return{x:N.x+N.width/2,y:N.y+N.height-u.height/2}},24:function(B,N){return{x:B.x+B.width-N.width/2,y:B.y+B.height-N.height/2}},25:function(R,s){return{x:R.x+R.width+s.width/2,y:R.y+R.height-s.height/2}},26:function(s){return{x:s.x,y:s.y+s.height}},27:function(R){return{x:R.x+R.width/2,y:R.y+R.height}},28:function(q){return{x:q.x+q.width,y:q.y+q.height}},29:function(F,A){return{x:F.x-A.width/2,y:F.y+F.height+A.height/2}},30:function(m,s){return{x:m.x+s.width/2,y:m.y+m.height+s.height/2}},31:function(i,n){return{x:i.x+i.width/2,y:i.y+i.height+n.height/2}},32:function(L,c){return{x:L.x+L.width-c.width/2,y:L.y+L.height+c.height/2}},33:function(L,A){return{x:L.x+L.width+A.width/2,y:L.y+L.height+A.height/2}},34:function(s,y){return{x:s.x,y:s.y-y.height/2}},35:function(z,U){return{x:z.x+z.width,y:z.y-U.height/2}},36:function(Z,p){return{x:Z.x,y:Z.y+Z.height+p.height/2}},37:function(Y,j){return{x:Y.x+Y.width,y:Y.y+Y.height+j.height/2}},38:function(A,Z){return{x:A.x+A.width/4,y:A.y-Z.height/2}},39:function(s,i){return{x:s.x+3*s.width/4,y:s.y-i.height/2}},40:function(t){return{x:t.x+t.width/4,y:t.y}},41:function(v){return{x:v.x+3*v.width/4,y:v.y}},42:function(T,x){return{x:T.x+T.width/4,y:T.y+x.height/2}},43:function(s,Z){return{x:s.x+3*s.width/4,y:s.y+Z.height/2}},44:function(j,R){return{x:j.x+j.width/2,y:j.y+j.height/2-R.height/2}},45:function(A){return{x:A.x+A.width/4,y:A.y+A.height/2}},46:function(t,M){return{x:t.x+t.width/2-M.width/2,y:t.y+t.height/2}},47:function(j,W){return{x:j.x+j.width/2+W.width/2,y:j.y+j.height/2}},48:function(e){return{x:e.x+3*e.width/4,y:e.y+e.height/2}},49:function(Q,M){return{x:Q.x+Q.width/2,y:Q.y+Q.height/2+M.height/2}},50:function(q,P){return{x:q.x+q.width/4,y:q.y+q.height-P.height/2}},51:function(A,P){return{x:A.x+3*A.width/4,y:A.y+A.height-P.height/2}},52:function(I){return{x:I.x+I.width/4,y:I.y+I.height}},53:function(I){return{x:I.x+3*I.width/4,y:I.y+I.height}},54:function(a,U){return{x:a.x+a.width/4,y:a.y+a.height+U.height/2}},55:function(Y,A){return{x:Y.x+3*Y.width/4,y:Y.y+Y.height+A.height/2}}};return Nn(x)?function(t,M,T){return S[t](M,T?T:Jq)}:void 0}();xl(e,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Vr=e.reverse,Up=e.transparent,Od=e.rectSelectBackground,Xh=e.dash,pn=e.titleBackground,un=e.titleIconBackground,nn=e.headerBackground,ss=e.headerIconBackground,tj=e.headerSeparator,Fb=e.headerLine,jh=e.contentIconBackground,Bf=e.contentLine,Oc=(e.widgetIconHighlight,e.widgetIconBorder),Xl=(e.widgetIconGradient,e.imageBackground),Io=e.imageGradient,nj=e.highlight,_n=e.label,qk=e.labelSelect;if(kb&&!x.shutAlert1){var si=new Date,Wh=kb.split("-"),zo=new Date(si.getFullYear(),si.getMonth(),si.getDate()),kb=new Date(Sq(Wh[0],10),Sq(Wh[1],10)-1,Sq(Wh[2],10)),xd=zo.getTime(),Wp=kb.getTime(),sr=D+"_try",yk=x.alert;try{var mn=x.localStorage;if(mn&&yk)if(Wp>xd&&1728e6>Wp-xd){var mb=(Wp-xd)/864e5;mn&&mn[sr]!=mb&&(mn[sr]=mb,x.htWillExpire?yk(x.htWillExpire.replace("{{day}}",mb)):yk("HT for Web free trial license will expire in "+mb+" days, please apply for a new license!"))}else xd>=Wp&&(x.htExpired?yk(x.htExpired):yk("Your free trial of HT for Web has expired!")),mn&&delete mn[sr]}catch(sn){}}Math.sign===r&&(Math.sign=function(H){return 0>H?-1:H>0?1:+H});var Tk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",tm={encode:function(l,P){var r,v,J,f,Y,o,a,x="",Z=0;for(l=unescape(encodeURIComponent(l));Z<l.length;)r=l.charCodeAt(Z++),v=l.charCodeAt(Z++),J=l.charCodeAt(Z++),f=r>>2,Y=(3&r)<<4|v>>4,o=(15&v)<<2|J>>6,a=63&J,isNaN(v)?o=a=64:isNaN(J)&&(a=64),x=x+P.charAt(f)+P.charAt(Y)+P.charAt(o)+P.charAt(a);return x},decode:function(T,N,p){for(var k,H,x,W,F,R,g,C="",I=p||0;I<T.length;)W=N.indexOf(T.charAt(I++)),F=N.indexOf(T.charAt(I++)),R=N.indexOf(T.charAt(I++)),g=N.indexOf(T.charAt(I++)),k=W<<2|F>>4,H=(15&F)<<4|R>>2,x=(3&R)<<6|g,C+=String.fromCharCode(k),64!=R&&(C+=String.fromCharCode(H)),64!=g&&(C+=String.fromCharCode(x));return C=decodeURIComponent(escape(C))},_utf8_encode:function(m){m=m.replace(/\r\n/g,"\n");for(var U="",e=0;e<m.length;e++){var P=m.charCodeAt(e);128>P?U+=String.fromCharCode(P):P>127&&2048>P?(U+=String.fromCharCode(192|P>>6),U+=String.fromCharCode(128|63&P)):(U+=String.fromCharCode(224|P>>12),U+=String.fromCharCode(128|63&P>>6),U+=String.fromCharCode(128|63&P))}return U},_utf8_decode:function(A){for(var e="",r=0,b=0,x=0,u=0;r<A.length;)b=A.charCodeAt(r),128>b?(e+=String.fromCharCode(b),r++):b>191&&224>b?(x=A.charCodeAt(r+1),e+=String.fromCharCode((31&b)<<6|63&x),r+=2):(x=A.charCodeAt(r+1),u=A.charCodeAt(r+2),e+=String.fromCharCode((15&b)<<12|(63&x)<<6|63&u),r+=3);return e}},gh=[],xi=[],ar=s.Math={generateUUID:function(){for(var B=[],q=0;256>q;q++)B[q]=(16>q?"0":"")+q.toString(16).toUpperCase();return function(){var N=0|4294967295*Math.random(),_=0|4294967295*Math.random(),s=0|4294967295*Math.random(),x=0|4294967295*Math.random();return B[255&N]+B[255&N>>8]+B[255&N>>16]+B[255&N>>24]+"-"+B[255&_]+B[255&_>>8]+"-"+B[64|15&_>>16]+B[255&_>>24]+"-"+B[128|63&s]+B[255&s>>8]+"-"+B[255&s>>16]+B[255&s>>24]+B[255&x]+B[255&x>>8]+B[255&x>>16]+B[255&x>>24]}}(),clamp:function(z,B,H){return Math.max(B,Math.min(H,z))},generateIncreasingID:function(){var c=0;return function(){return++c}}(),encodeBase64:function(d,J){return tm.encode(d,J||Tk)},decodeBase64:function(M,C){return tm.decode(M,C||Tk)},randomArray:function(b,r){r=r||b.length;for(var G=r-1;G>0;G--){var h=Math.floor(Math.random()*(G+1)),m=b[G];b[G]=b[h],b[h]=m}return b},randomInt:function(D,i){return i===r&&(i=D,D=0),D+Math.floor(Math.random()*(i-D))},isPOT:function(y){return y>0&&0===(y-1&y)},nearestPOT:function(p){if(!p)return 1;var D=p;D--,D|=D>>1,D|=D>>2,D|=D>>4,D|=D>>8,D|=D>>16,D++;var G=D>>1;return p-G>D-p?D:G},requestMatrix4:function(){return gh.length>0?gh.pop():new ar.Matrix4},releaseMatrix4:function(G){gh.push(G)},requestVector3:function(){return xi.length>0?xi.pop():new ar.Vector3},releaseVector3:function(O){xi.push(O)}},Rp=s.Matrix=s.Math.Matrix2d=function(z,l,O,D,W){this.setFromTransform(z,l,O,D,W)},$r=Rp;Rp.prototype={},Rp.prototype.constructor=Rp,Rp.prototype.set=function(K,N,r,Y,I,n){return this.a=K,this.b=N,this.c=r,this.d=Y,this.tx=I,this.ty=n,this},Rp.prototype.setFromTransform=function(z,R,Z,S,F){var Y=this;if(z===r)return Y.a=1,Y.b=0,Y.c=0,Y.d=1,Y.tx=0,Y.ty=0,void 0;z=z||0;var B=O(z),W=f(z);return S=S||1,F=F||1,Y.a=W*S,Y.b=B*S,Y.c=-B*F,Y.d=W*F,Y.tx=R||0,Y.ty=Z||0,Y},Rp.prototype.apply=function(h,Z){Z=Z||new Vq;var t=h.x,A=h.y;return Z.x=this.a*t+this.c*A+this.tx,Z.y=this.b*t+this.d*A+this.ty,Z},Rp.prototype.applyInverse=function(b,w){w=w||new Vq;var x=1/(this.a*this.d+this.c*-this.b),H=b.x,f=b.y;return w.x=this.d*x*H+-this.c*x*f+(this.ty*this.c-this.tx*this.d)*x,w.y=this.a*x*f+-this.b*x*H+(-this.ty*this.a+this.tx*this.b)*x,w},Rp.prototype.translate=function(g,w){return this.tx+=g,this.ty+=w,this},Rp.prototype.scale=function(u,T){return this.a*=u,this.d*=T,this.c*=u,this.b*=T,this.tx*=u,this.ty*=T,this},Rp.prototype.rotate=function(Z){var n=Math.cos(Z),s=Math.sin(Z),d=this.a,G=this.c,m=this.tx;return this.a=d*n-this.b*s,this.b=d*s+this.b*n,this.c=G*n-this.d*s,this.d=G*s+this.d*n,this.tx=m*n-this.ty*s,this.ty=m*s+this.ty*n,this},Rp.prototype.appendTranslate=function(h,v){return this.tx+=this.a*h+this.c*v,this.ty+=this.b*h+this.d*v,this},Rp.prototype.appendScale=function(M,m){return this.a*=M,this.d*=m,this.c*=m,this.b*=M,this},Rp.prototype.appendRotate=function(S){if(!S)return this;var u=Math.cos(S),z=Math.sin(S),$=this.a,o=this.b;return this.a=$*u+this.c*z,this.b=o*u+this.d*z,this.c=-$*z+this.c*u,this.d=-o*z+this.d*u,this},Rp.prototype.append=function(K){var z=this.a,a=this.b,c=this.c,T=this.d;return this.a=K.a*z+K.b*c,this.b=K.a*a+K.b*T,this.c=K.c*z+K.d*c,this.d=K.c*a+K.d*T,this.tx=K.tx*z+K.ty*c+this.tx,this.ty=K.tx*a+K.ty*T+this.ty,this},Rp.prototype.setTransform=function(A,n,F,I,C,w,H,i,s){var p,M,b,X,P,x,q,U,u,o;return P=Math.sin(H),x=Math.cos(H),q=Math.cos(s),U=Math.sin(s),u=-Math.sin(i),o=Math.cos(i),p=x*C,M=P*C,b=-P*w,X=x*w,this.a=q*p+U*b,this.b=q*M+U*X,this.c=u*p+o*b,this.d=u*M+o*X,this.tx=A+(F*p+I*b),this.ty=n+(F*M+I*X),this},Rp.prototype.prepend=function(k){var K=this.tx;if(1!==k.a||0!==k.b||0!==k.c||1!==k.d){var d=this.a,R=this.c;this.a=d*k.a+this.b*k.c,this.b=d*k.b+this.b*k.d,this.c=R*k.a+this.d*k.c,this.d=R*k.b+this.d*k.d}return this.tx=K*k.a+this.ty*k.c+k.tx,this.ty=K*k.b+this.ty*k.d+k.ty,this},Rp.prototype.transform=Rp.prototype.prepend,Rp.prototype.invert=function(){var $=this.a,y=this.b,V=this.c,Z=this.d,f=this.tx,K=$*Z-y*V;return this.a=Z/K,this.b=-y/K,this.c=-V/K,this.d=$/K,this.tx=(V*this.ty-Z*f)/K,this.ty=-($*this.ty-y*f)/K,this},Rp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Rp.prototype.clone=function(){var z=new Rp;return z.a=this.a,z.b=this.b,z.c=this.c,z.d=this.d,z.tx=this.tx,z.ty=this.ty,z},Rp.prototype.copy=function(R){return R.a=this.a,R.b=this.b,R.c=this.c,R.d=this.d,R.tx=this.tx,R.ty=this.ty,R},Rp.prototype.tf=function(c,i){1===arguments.length&&(i=c.y,c=c.x);var S=this;return{x:S.a*c+S.c*i+S.tx,y:S.b*c+S.d*i+S.ty}},Rp.prototype.tfi=function(d,x){1===arguments.length&&(x=d.y,d=d.x);var A=this,$=1/(A.a*A.d+A.c*-A.b);return{x:A.d*$*d+-A.c*$*x+(A.ty*A.c-A.tx*A.d)*$,y:A.a*$*x+-A.b*$*d+(-A.ty*A.a+A.tx*A.b)*$}},Rp.IDENTITY=new Rp,Rp.TEMP_MATRIX=new Rp;var _i=s.Math.Quaternion=function(k,W,D,e){this.set(k,W,D,e)};R.assign(_i.prototype,{set:function(Q,Z,s,R){var V=this;return V._x=Q||0,V._y=Z||0,V._z=s||0,V._w=R!==r?R:1,V},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(X){var _=this;return _._x=X._x,_._y=X._y,_._z=X._z,_._w=X._w,_},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(F){return this._x*F._x+this._y*F._y+this._z*F._z+this._w*F._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var z=this.length();return 0===z?(this._x=0,this._y=0,this._z=0,this._w=1):(z=1/z,this._x=this._x*z,this._y=this._y*z,this._z=this._z*z,this._w=this._w*z),this},fromArray:function(X,j){j===r&&(j=0);var c=this;return c._x=X[j],c._y=X[j+1],c._z=X[j+2],c._w=X[j+3],this},slerp:function(l,x){if(0===x)return this;if(1===x)return this.copy(l);var W=this._x,Z=this._y,O=this._z,w=this._w,o=w*l._w+W*l._x+Z*l._y+O*l._z;if(0>o?(this._w=-l._w,this._x=-l._x,this._y=-l._y,this._z=-l._z,o=-o):this.copy(l),o>=1)return this._w=w,this._x=W,this._y=Z,this._z=O,this;var e=Math.sqrt(1-o*o);if(Math.abs(e)<.001)return this._w=.5*(w+this._w),this._x=.5*(W+this._x),this._y=.5*(Z+this._y),this._z=.5*(O+this._z),this;var N=Math.atan2(e,o),J=Math.sin((1-x)*N)/e,Q=Math.sin(x*N)/e;return this._w=w*J+this._w*Q,this._x=W*J+this._x*Q,this._y=Z*J+this._y*Q,this._z=O*J+this._z*Q,this},setFromAxisAngle:function($,R){var Z=R/2,u=Math.sin(Z);return this._x=$.x*u,this._y=$.y*u,this._z=$.z*u,this._w=Math.cos(Z),this},setFromEuler:function(n){var f=n._x,u=n._y,y=n._z,J=n._order,U=Math.cos,T=Math.sin,Q=U(f/2),M=U(u/2),O=U(y/2),W=T(f/2),b=T(u/2),q=T(y/2);return"XYZ"===J?(this._x=W*M*O+Q*b*q,this._y=Q*b*O-W*M*q,this._z=Q*M*q+W*b*O,this._w=Q*M*O-W*b*q):"YXZ"===J?(this._x=W*M*O+Q*b*q,this._y=Q*b*O-W*M*q,this._z=Q*M*q-W*b*O,this._w=Q*M*O+W*b*q):"ZXY"===J?(this._x=W*M*O-Q*b*q,this._y=Q*b*O+W*M*q,this._z=Q*M*q+W*b*O,this._w=Q*M*O-W*b*q):"ZYX"===J?(this._x=W*M*O-Q*b*q,this._y=Q*b*O+W*M*q,this._z=Q*M*q-W*b*O,this._w=Q*M*O+W*b*q):"YZX"===J?(this._x=W*M*O+Q*b*q,this._y=Q*b*O+W*M*q,this._z=Q*M*q-W*b*O,this._w=Q*M*O-W*b*q):"XZY"===J&&(this._x=W*M*O-Q*b*q,this._y=Q*b*O-W*M*q,this._z=Q*M*q+W*b*O,this._w=Q*M*O+W*b*q),this},setFromRotationMatrix:function(J){var e,R=J.el,z=R[0],Y=R[4],Z=R[8],N=R[1],P=R[5],_=R[9],W=R[2],x=R[6],i=R[10],B=z+P+i;return B>0?(e=.5/Math.sqrt(B+1),this._w=.25/e,this._x=(x-_)*e,this._y=(Z-W)*e,this._z=(N-Y)*e):z>P&&z>i?(e=2*Math.sqrt(1+z-P-i),this._w=(x-_)/e,this._x=.25*e,this._y=(Y+N)/e,this._z=(Z+W)/e):P>i?(e=2*Math.sqrt(1+P-z-i),this._w=(Z-W)/e,this._x=(Y+N)/e,this._y=.25*e,this._z=(_+x)/e):(e=2*Math.sqrt(1+i-z-P),this._w=(N-Y)/e,this._x=(Z+W)/e,this._y=(_+x)/e,this._z=.25*e),this},setFromToVectors:function(){var A,j;return function(F,q){return A===r&&(A=new Zb),j=F.dot(q)+1,1e-7>j?(j=0,Math.abs(F.x)>Math.abs(F.z)?A.set(-F.y,F.x,0):A.set(0,-F.z,F.y)):A.crossVectors(F,q),this._x=A.x,this._y=A.y,this._z=A.z,this._w=j,this.normalize()}}(),setFromUnitVectors:function(){var p,f,F=1e-6;return function(h,S){return p===r&&(p=new Zb),f=h.dot(S)+1,F>f?(f=0,Math.abs(h.x)>Math.abs(h.z)?p.set(-h.y,h.x,0):p.set(0,-h.z,h.y)):p.crossVectors(h,S),this._x=p.x,this._y=p.y,this._z=p.z,this._w=f,this.normalize()}}(),multiply:function(k){return this.multiplyQuaternions(this,k)},premultiply:function(U){return this.multiplyQuaternions(U,this)},multiplyQuaternions:function(F,M){var X=F._x,Y=F._y,N=F._z,A=F._w,l=M._x,n=M._y,S=M._z,z=M._w;return this._x=X*z+A*l+Y*S-N*n,this._y=Y*z+A*n+N*l-X*S,this._z=N*z+A*S+X*n-Y*l,this._w=A*z-X*l-Y*n-N*S,this}});var Sl=s.Math.Vector4=function(E,p,T,q){this.x=E||0,this.y=p||0,this.z=T||0,this.w=q!==r?q:1};R.assign(Sl.prototype,{isVector4:!0,set:function(F,$,Z,M){return this.x=F,this.y=$,this.z=Z,this.w=M,this},setScalar:function(C){return this.x=C,this.y=C,this.z=C,this.w=C,this},setX:function(H){return this.x=H,this},setY:function(S){return this.y=S,this},setZ:function(f){return this.z=f,this},setW:function(w){return this.w=w,this},setComponent:function(N,t){switch(N){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+N)}return this},getComponent:function(f){switch(f){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+f)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(L){return this.x=L.x,this.y=L.y,this.z=L.z,this.w=L.w!==r?L.w:1,this},add:function(I,H){return H!==r?this.addVectors(I,H):(this.x+=I.x,this.y+=I.y,this.z+=I.z,this.w+=I.w,this)},addScalar:function(z){return this.x+=z,this.y+=z,this.z+=z,this.w+=z,this},addVectors:function(L,i){return this.x=L.x+i.x,this.y=L.y+i.y,this.z=L.z+i.z,this.w=L.w+i.w,this},addScaledVector:function(d,O){return this.x+=d.x*O,this.y+=d.y*O,this.z+=d.z*O,this.w+=d.w*O,this},sub:function(h,N){return N!==r?this.subVectors(h,N):(this.x-=h.x,this.y-=h.y,this.z-=h.z,this.w-=h.w,this)},subScalar:function(l){return this.x-=l,this.y-=l,this.z-=l,this.w-=l,this},subVectors:function(U,W){return this.x=U.x-W.x,this.y=U.y-W.y,this.z=U.z-W.z,this.w=U.w-W.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(o){var C=this.x,z=this.y,r=this.z,v=this.w,P=o.el;return this.x=P[0]*C+P[4]*z+P[8]*r+P[12]*v,this.y=P[1]*C+P[5]*z+P[9]*r+P[13]*v,this.z=P[2]*C+P[6]*z+P[10]*r+P[14]*v,this.w=P[3]*C+P[7]*z+P[11]*r+P[15]*v,this},divideScalar:function(y){return this.multiplyScalar(1/y)},setAxisAngleFromQuaternion:function(b){this.w=2*Math.acos(b.w);var h=Math.sqrt(1-b.w*b.w);return 1e-4>h?(this.x=1,this.y=0,this.z=0):(this.x=b.x/h,this.y=b.y/h,this.z=b.z/h),this},setAxisAngleFromRotationMatrix:function($){var n,T,g,U,V=.01,S=.1,m=$.el,j=m[0],y=m[4],o=m[8],D=m[1],e=m[5],t=m[9],L=m[2],Y=m[6],s=m[10];if(Math.abs(y-D)<V&&Math.abs(o-L)<V&&Math.abs(t-Y)<V){if(Math.abs(y+D)<S&&Math.abs(o+L)<S&&Math.abs(t+Y)<S&&Math.abs(j+e+s-3)<S)return this.set(1,0,0,0),this;n=Math.PI;var k=(j+1)/2,N=(e+1)/2,d=(s+1)/2,q=(y+D)/4,v=(o+L)/4,l=(t+Y)/4;return k>N&&k>d?V>k?(T=0,g=.707106781,U=.707106781):(T=Math.sqrt(k),g=q/T,U=v/T):N>d?V>N?(T=.707106781,g=0,U=.707106781):(g=Math.sqrt(N),T=q/g,U=l/g):V>d?(T=.707106781,g=.707106781,U=0):(U=Math.sqrt(d),T=v/U,g=l/U),this.set(T,g,U,n),this}var w=Math.sqrt((Y-t)*(Y-t)+(o-L)*(o-L)+(D-y)*(D-y));return Math.abs(w)<.001&&(w=1),this.x=(Y-t)/w,this.y=(o-L)/w,this.z=(D-y)/w,this.w=Math.acos((j+e+s-1)/2),this},min:function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this.z=Math.min(this.z,k.z),this.w=Math.min(this.w,k.w),this},max:function(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this},clamp:function(j,q){return this.x=Math.max(j.x,Math.min(q.x,this.x)),this.y=Math.max(j.y,Math.min(q.y,this.y)),this.z=Math.max(j.z,Math.min(q.z,this.z)),this.w=Math.max(j.w,Math.min(q.w,this.w)),this},clampScalar:function(){var P,G;return function(x,C){return P===r&&(P=new Sl,G=new Sl),P.set(x,x,x,x),G.set(C,C,C,C),this.clamp(P,G)}}(),clampLength:function(Z,C){var A=this.length();return this.divideScalar(A||1).multiplyScalar(Math.max(Z,Math.min(C,A)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z+this.w*U.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(O){return this.normalize().multiplyScalar(O)},lerp:function(i,P){return this.x+=(i.x-this.x)*P,this.y+=(i.y-this.y)*P,this.z+=(i.z-this.z)*P,this.w+=(i.w-this.w)*P,this},lerpVectors:function(N,g,x){return this.subVectors(g,N).multiplyScalar(x).add(N)},equals:function(T){return T.x===this.x&&T.y===this.y&&T.z===this.z&&T.w===this.w},fromArray:function(k,z){return z===r&&(z=0),this.x=k[z],this.y=k[z+1],this.z=k[z+2],this.w=k[z+3],this},toArray:function(L,M){return L===r&&(L=[]),M===r&&(M=0),L[M]=this.x,L[M+1]=this.y,L[M+2]=this.z,L[M+3]=this.w,L},fromBufferAttribute:function(B,Z){return this.x=B.getX(Z),this.y=B.getY(Z),this.z=B.getZ(Z),this.w=B.getW(Z),this}});var Zb=s.Math.Vector3=function(E,c,R){E===r?(this.x=0,this.y=0,this.z=0):"object"==typeof E?this.copy(E):this.set(E,c==r?E:c,R==r?E:R)},Md=s.Math.Vector3;R.assign(Zb.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)
},set:function(Q,E,t){return this.x=Q,this.y=E,this.z=t,this},equals:function(f){return f&&this.x===f.x&&this.y===f.y&&this.z===f.z},setScalar:function(x){return this.x=x,this.y=x,this.z=x,this},setX:function(N){return this.x=N,this},setY:function(a){return this.y=a,this},setZ:function(B){return this.z=B,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(F){return F.x===r?(this.x=F[0],this.y=F[1],this.z=F[2]):(this.x=F.x,this.y=F.y,this.z=F.z||0),this},add:function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this},addScalar:function(s){return this.x+=s,this.y+=s,this.z+=s,this},addVectors:function(U,O){return this.x=U.x+O.x,this.y=U.y+O.y,this.z=U.z+O.z,this},addScaledVector:function($,h){return this.x+=$.x*h,this.y+=$.y*h,this.z+=$.z*h,this},sub:function(N){return this.x-=N.x,this.y-=N.y,this.z-=N.z,this},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(d,o){return this.x=d.x-o.x,this.y=d.y-o.y,this.z=d.z-o.z,this},divide:function(O){return this.x/=O.x,this.y/=O.y,this.z/=O.z,this},multiply:function(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},divideScalar:function(h){if(0!==h){var S=1/h;this.x*=S,this.y*=S,this.z*=S}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(J){return Math.sqrt(this.distanceToSquared(J))},distanceToSquared:function(E){var F=this.x-E.x,f=this.y-E.y,J=this.z-E.z;return F*F+f*f+J*J},distanceToSquared2:function(h){var a=this.x-h[0],E=this.y-h[1],w=this.z-h[2];return a*a+E*E+w*w},divideVectors:function(q,v){return this.x=q.x/v.x,this.y=q.y/v.y,this.z=q.z/v.z,this},multiplyVectors:function(w,z){return this.x=w.x*z.x,this.y=w.y*z.y,this.z=w.z*z.z,this},transformDirection:function(x){var G=this.x,u=this.y,W=this.z,U=x.el;return this.x=U[0]*G+U[4]*u+U[8]*W,this.y=U[1]*G+U[5]*u+U[9]*W,this.z=U[2]*G+U[6]*u+U[10]*W,this.normalize()},applyAxisAngle:function(){var k=new _i;return function(m,A){return this.applyQuaternion(k.setFromAxisAngle(m,A))}}(),applyEuler:function(){var b=new _i;return function(J){return this.applyQuaternion(b.setFromEuler(J))}}(),applyQuaternion:function(Z){var N=this.x,Q=this.y,t=this.z,T=Z._x,E=Z._y,f=Z._z,_=Z._w,M=_*N+E*t-f*Q,l=_*Q+f*N-T*t,k=_*t+T*Q-E*N,r=-T*N-E*Q-f*t;return this.x=M*_+r*-T+l*-f-k*-E,this.y=l*_+r*-E+k*-T-M*-f,this.z=k*_+r*-f+M*-E-l*-T,this},applyMatrix4:function(f){var L=this.x,z=this.y,v=this.z,D=f.el,Q=1/(D[3]*L+D[7]*z+D[11]*v+D[15]);return this.x=(D[0]*L+D[4]*z+D[8]*v+D[12])*Q,this.y=(D[1]*L+D[5]*z+D[9]*v+D[13])*Q,this.z=(D[2]*L+D[6]*z+D[10]*v+D[14])*Q,this},applyMatrix3:function(A){var V=this.x,G=this.y,r=this.z,v=A.el;return this.x=v[0]*V+v[3]*G+v[6]*r,this.y=v[1]*V+v[4]*G+v[7]*r,this.z=v[2]*V+v[5]*G+v[8]*r,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var o=new Zb;return function(E){return this.sub(o.copy(E).multiplyScalar(2*this.dot(E)))}}(),dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var A=this.length();return A?this.multiplyScalar(1/A):this},setLength:function(G){return this.normalize().multiplyScalar(G)},fromArray:function(b,d){return d===r&&(d=0),this.x=b[d],this.y=b[d+1],this.z=b[d+2],this},toArray:function(C,Y){return C===r&&(C=[0,0,0]),Y===r&&(Y=0),C[Y]=this.x,C[Y+1]=this.y,C[Y+2]=this.z,C},cross:function(K){return this.crossVectors(this,K)},angleTo:function(v){var T=this.dot(v)/Math.sqrt(this.lengthSq()*v.lengthSq());return T>1||-1>T?0:Math.acos(T)},lerp:function(T,h){return this.x+=(T.x-this.x)*h,this.y+=(T.y-this.y)*h,this.z+=(T.z-this.z)*h,this},lerpVectors:function(H,S,u){return this.subVectors(S,H).multiplyScalar(u).add(H)},crossVectors:function(w,D){var i=w.x,c=w.y,O=w.z,h=D.x,B=D.y,X=D.z;return this.x=c*X-O*B,this.y=O*h-i*X,this.z=i*B-c*h,this},min:function(B){return this.x=Math.min(this.x,B.x),this.y=Math.min(this.y,B.y),this.z=Math.min(this.z,B.z),this},max:function(V){return this.x=Math.max(this.x,V.x),this.y=Math.max(this.y,V.y),this.z=Math.max(this.z,V.z),this},setFromMatrixPosition:function(O){return this.setFromMatrixColumn(O,3)},setFromMatrixScale:function(D){var M=this.setFromMatrixColumn(D,0).length(),c=this.setFromMatrixColumn(D,1).length(),s=this.setFromMatrixColumn(D,2).length();return this.x=M,this.y=c,this.z=s,this},setFromMatrixColumn:function(B,s){return this.fromArray(B.el,4*s)}});var Vq=s.Math.Vector2=function(l,L,D){"object"==typeof l&&(l.x!=r?(L=l.y,l=l.x,D=l.e):(D=l[2],L=l[1],l=l[0])),this.set(l||0,L||0,D)};Vq.prototype={},Vq.prototype.constructor=Vq;var Lk=Vq;R.defineProperties(Vq.prototype,{width:{get:function(){return this.x},set:function(S){this.x=S}},height:{get:function(){return this.y},set:function(W){this.y=W}}}),Vq.prototype.clone=function(){return new Vq(this.x,this.y,this.e)},Vq.prototype.copy=function(h){return this.set(h.x,h.y,h.e),this},Vq.prototype.equals=function(r){return r.x===this.x&&r.y===this.y},Vq.prototype.set=function(U,E,j){return this.x=U||0,this.y=E||(0!==E?this.x:0),j!=r&&(this.e=j),this},Vq.prototype.setScalar=function(E){return this.x=E,this.y=E,this},Vq.prototype.setX=function(M){return this.x=M||0,this},Vq.prototype.setY=function(Q){return this.y=Q||0,this},Vq.prototype.add=function($){return this.x+=$.x,this.y+=$.y,this},Vq.prototype.addVectors=function(_,g){return this.x=_.x+g.x,this.y=_.y+g.y,this},Vq.prototype.addScalar=function(x){return this.x+=x,this.y+=x,this},Vq.prototype.addScaledVector=function(n,E){return this.x+=n.x*E,this.y+=n.y*E,this},Vq.prototype.sub=function(w){return this.x-=w.x,this.y-=w.y,this},Vq.prototype.subScalar=function(W){return this.x-=W,this.y-=W,this},Vq.prototype.subVectors=function(i,u){return this.x=i.x-u.x,this.y=i.y-u.y,this},Vq.prototype.multiply=function(C){return this.x*=C.x,this.y*=C.y,this},Vq.prototype.multiplyScalar=function(b){return this.x*=b,this.y*=b,this},Vq.prototype.divide=function(Z){return this.x/=Z.x,this.y/=Z.y,this},Vq.prototype.divideScalar=function(E){return this.multiplyScalar(1/E)},Vq.prototype.min=function(L){return this.x=Math.min(this.x,L.x),this.y=Math.min(this.y,L.y),this},Vq.prototype.max=function(S){return this.x=Math.max(this.x,S.x),this.y=Math.max(this.y,S.y),this},Vq.prototype.fromArray=function(Z,c){return c===r&&(c=0),this.x=Z[c],this.y=Z[c+1],this},Vq.prototype.clamp=function(h,g){return this.x=Math.max(h.x,Math.min(g.x,this.x)),this.y=Math.max(h.y,Math.min(g.y,this.y)),this},Vq.prototype.clampScalar=function(){var o,x;return function(Y,K){return o===r&&(o=new Vq,x=new Vq),o.set(Y,Y),x.set(K,K),this.clamp(o,x)}}(),Vq.prototype.clampLength=function(X,n){var $=this.length();return this.multiplyScalar(Math.max(X,Math.min(n,$))/$)},Vq.prototype.dot=function(j){return this.x*j.x+this.y*j.y},Vq.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Vq.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vq.prototype.normalize=function(){return this.divideScalar(this.length())},Vq.prototype.angle=function(){var Y=Math.atan2(this.y,this.x);return 0>Y&&(Y+=2*Math.PI),Y},Vq.prototype.distanceTo=function($){return Math.sqrt(this.distanceToSquared($))},Vq.prototype.distanceToSquared=function(s){var K=this.x-s.x,Q=this.y-s.y;return K*K+Q*Q},Vq.prototype.isNearEnough=function(N){return this.distanceToSquared(N)<1e-8},Vq.prototype.setLength=function(M){var W=this.length();return W?this.multiplyScalar(M/W):this},Vq.prototype.lerp=function(v,M){return this.x+=(v.x-this.x)*M,this.y+=(v.y-this.y)*M,this},Vq.prototype.lerpVectors=function(K,g,P){return this.subVectors(g,K).multiplyScalar(P).add(K)},Vq.prototype.rotateAround=function(Q,X){var j=Q?Q.x:0,v=Q?Q.y:0,B=Math.cos(X),M=Math.sin(X),m=this.x-j,a=this.y-v;return this.x=m*B-a*M+j,this.y=m*M+a*B+v,this};var Be=s.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};R.assign(Be.prototype,{isMatrix3:!0,set:function(m,F,T,h,q,w,b,L,y){var o=this.el;return o[0]=m,o[1]=h,o[2]=b,o[3]=F,o[4]=q,o[5]=L,o[6]=T,o[7]=w,o[8]=y,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(D){var M=this.el,Q=D.el;return M[0]=Q[0],M[1]=Q[1],M[2]=Q[2],M[3]=Q[3],M[4]=Q[4],M[5]=Q[5],M[6]=Q[6],M[7]=Q[7],M[8]=Q[8],this},setFromMatrix4:function(N){var u=N.el;return this.set(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10]),this},applyToBufferAttribute:function(){var J=new Zb;return function(c){for(var N=0,S=c.count;S>N;N++)J.x=c.getX(N),J.y=c.getY(N),J.z=c.getZ(N),J.applyMatrix3(this),c.setXYZ(N,J.x,J.y,J.z);return c}}(),multiply:function(X){return this.multiplyMatrices(this,X)},premultiply:function(G){return this.multiplyMatrices(G,this)},multiplyMatrices:function(h,U){var R=h.el,L=U.el,G=this.el,t=R[0],c=R[3],N=R[6],l=R[1],E=R[4],V=R[7],Z=R[2],o=R[5],D=R[8],r=L[0],x=L[3],i=L[6],P=L[1],f=L[4],w=L[7],M=L[2],$=L[5],J=L[8];return G[0]=t*r+c*P+N*M,G[3]=t*x+c*f+N*$,G[6]=t*i+c*w+N*J,G[1]=l*r+E*P+V*M,G[4]=l*x+E*f+V*$,G[7]=l*i+E*w+V*J,G[2]=Z*r+o*P+D*M,G[5]=Z*x+o*f+D*$,G[8]=Z*i+o*w+D*J,this},multiplyScalar:function(A){var I=this.el;return I[0]*=A,I[3]*=A,I[6]*=A,I[1]*=A,I[4]*=A,I[7]*=A,I[2]*=A,I[5]*=A,I[8]*=A,this},determinant:function(){var T=this.el,w=T[0],V=T[1],g=T[2],i=T[3],Y=T[4],q=T[5],D=T[6],h=T[7],H=T[8];return w*Y*H-w*q*h-V*i*H+V*q*D+g*i*h-g*Y*D},getInverse:function(H){var O=H.el,D=this.el,F=O[0],t=O[1],k=O[2],b=O[3],f=O[4],w=O[5],N=O[6],u=O[7],v=O[8],V=v*f-w*u,X=w*N-v*b,I=u*b-f*N,W=F*V+t*X+k*I;if(0===W)return this.identity();var c=1/W;return D[0]=V*c,D[1]=(k*u-v*t)*c,D[2]=(w*t-k*f)*c,D[3]=X*c,D[4]=(v*F-k*N)*c,D[5]=(k*b-w*F)*c,D[6]=I*c,D[7]=(t*N-u*F)*c,D[8]=(f*F-t*b)*c,this},transpose:function(){var o,Z=this.el;return o=Z[1],Z[1]=Z[3],Z[3]=o,o=Z[2],Z[2]=Z[6],Z[6]=o,o=Z[5],Z[5]=Z[7],Z[7]=o,this},getNormalMatrix:function(m){return this.setFromMatrix4(m).getInverse(this).transpose()},transposeIntoArray:function(j){var c=this.el;return j[0]=c[0],j[1]=c[3],j[2]=c[6],j[3]=c[1],j[4]=c[4],j[5]=c[7],j[6]=c[2],j[7]=c[5],j[8]=c[8],this},setUvTransform:function(x,h,w,I,j,$,X){var Z=Math.cos(j),z=Math.sin(j);this.set(w*Z,w*z,-w*(Z*$+z*X)+$+x,-I*z,I*Z,-I*(-z*$+Z*X)+X+h,0,0,1)},scale:function(d,y){var o=this.el;return o[0]*=d,o[3]*=d,o[6]*=d,o[1]*=y,o[4]*=y,o[7]*=y,this},rotate:function(c){var i=Math.cos(c),n=Math.sin(c),F=this.el,r=F[0],p=F[3],W=F[6],R=F[1],y=F[4],u=F[7];return F[0]=i*r+n*R,F[3]=i*p+n*y,F[6]=i*W+n*u,F[1]=-n*r+i*R,F[4]=-n*p+i*y,F[7]=-n*W+i*u,this},translate:function(w,x){var j=this.el;return j[0]+=w*j[2],j[3]+=w*j[5],j[6]+=w*j[8],j[1]+=x*j[2],j[4]+=x*j[5],j[7]+=x*j[8],this},equals:function(H){for(var B=this.el,X=H.el,U=0;9>U;U++)if(B[U]!==X[U])return!1;return!0},fromArray:function(U,A){A===r&&(A=0);for(var V=0;9>V;V++)this.el[V]=U[V+A];return this},toArray:function(Q,o){Q===r&&(Q=[]),o===r&&(o=0);var $=this.el;return Q[o]=$[0],Q[o+1]=$[1],Q[o+2]=$[2],Q[o+3]=$[3],Q[o+4]=$[4],Q[o+5]=$[5],Q[o+6]=$[6],Q[o+7]=$[7],Q[o+8]=$[8],Q}});var Jj=s.Math.Plane=function(S,v){this.normal=S!==r?S:new Zb(1,0,0),this.constant=v!==r?v:0};R.assign(Jj.prototype,{set:function(v,p){return this.normal.copy(v),this.constant=p,this},setComponents:function(c,q,R,r){return this.normal.set(c,q,R),this.constant=r,this},setFromNormalAndCoplanarPoint:function(m,z){return this.normal.copy(m),this.constant=-z.dot(this.normal),this},setFromCoplanarPoints:function(){var $=new Zb,k=new Zb;return function(v,e,Y){var r=$.subVectors(Y,e).cross(k.subVectors(v,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,v),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(S){return this.normal.copy(S.normal),this.constant=S.constant,this},normalize:function(){var $=1/this.normal.length();return this.normal.multiplyScalar($),this.constant*=$,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(_){return this.normal.dot(_)+this.constant},distanceToSphere:function(Q){return this.distanceToPoint(Q.center)-Q.radius},projectPoint:function(w,y){return y===r&&(y=new Zb),y.copy(this.normal).multiplyScalar(-this.distanceToPoint(w)).add(w)},intersectLine:function(){var Z=new Zb;return function(G,X){X===r&&(X=new Zb);var g=G.delta(Z),s=this.normal.dot(g);if(0===s)return 0===this.distanceToPoint(G.start)?X.copy(G.start):r;var m=-(G.start.dot(this.normal)+this.constant)/s;return 0>m||m>1?r:X.copy(g).multiplyScalar(m).add(G.start)}}(),intersectsLine:function(x){var R=this.distanceToPoint(x.start),E=this.distanceToPoint(x.end);return 0>R&&E>0||0>E&&R>0},intersectsBox:function(I){return I.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(K){return K===r&&(K=new Zb),K.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var P=new Zb,$=new Be;return function(r,V){var Y=V||$.getNormalMatrix(r),X=this.coplanarPoint(P).applyMatrix4(r),Q=this.normal.applyMatrix3(Y).normalize();return this.constant=-X.dot(Q),this}}(),translate:function(K){return this.constant-=K.dot(this.normal),this},equals:function(R){return R.normal.equals(this.normal)&&R.constant===this.constant}});var Vm=s.Math.Ray=function(D,_){this.origin=D!==r?D.clone():new Zb,this.direction=_!==r?_.clone():new Zb};R.assign(Vm.prototype,{set:function(D,X){return this.origin.copy(D),this.direction.copy(X),this},clone:function(){return(new this.constructor).copy(this)},copy:function(c){return this.origin.copy(c.origin),this.direction.copy(c.direction),this.maxHitLen=c.maxHitLen,this},at:function(L,k){var I=k||new Zb;return I.copy(this.direction).multiplyScalar(L).add(this.origin)},setMaxHitLength:function(R){this.maxHitLen=R},lookAt:function(v){return this.direction.copy(v).sub(this.origin).normalize(),this},applyMatrix4:function(z){var W=this.maxHitLen;if(W){var y=this.direction.clone().multiplyScalar(W).add(this.origin);y.applyMatrix4(z)}return this.origin.applyMatrix4(z),this.direction.transformDirection(z),W&&(this.maxHitLen=this.origin.distanceTo(y)),this},distanceToPlane:function(L){var l=L.normal.dot(this.direction);if(0===l)return 0===L.distanceToPoint(this.origin)?0:null;var s=-(this.origin.dot(L.normal)+L.constant)/l;return s>=0?s:null},intersectPlane:function(N,C){var n=this.distanceToPlane(N);return null===n?null:this.at(n,C)},intersectSphere:function(){var L=new Zb;return function(a,T){L.subVectors(a.center,this.origin);var D=L.dot(this.direction),q=L.dot(L)-D*D,V=a.radius*a.radius;if(q>V)return null;var H=Math.sqrt(V-q),l=D-H,n=D+H;return 0>l&&0>n?null:0>l?this.at(n,T):this.at(l,T)}}(),intersectEllipsoid:function(){var O=new Zb,r=new Zb;return function(o,v){O.subVectors(o.center,this.origin),O.divide(o.radius),r.divideVectors(this.direction,o.radius);var B=r.lengthSq(),k=O.dot(r),T=O.dot(O)*B-k*k;if(T>B)return null;var Q=Math.sqrt(B-T),x=(k-Q)/B,s=(k+Q)/B;return 0>x&&0>s?null:0>x?this.at(s,v):this.at(x,v)}}(),intersectBox:function(C,F){var H,I,Y,B,m,M,f=1/this.direction.x,P=1/this.direction.y,W=1/this.direction.z,q=this.origin;if(f>=0?(H=(C.min.x-q.x)*f,I=(C.max.x-q.x)*f):(H=(C.max.x-q.x)*f,I=(C.min.x-q.x)*f),P>=0?(Y=(C.min.y-q.y)*P,B=(C.max.y-q.y)*P):(Y=(C.max.y-q.y)*P,B=(C.min.y-q.y)*P),H>B||Y>I)return null;if((Y>H||H!==H)&&(H=Y),(I>B||I!==I)&&(I=B),W>=0?(m=(C.min.z-q.z)*W,M=(C.max.z-q.z)*W):(m=(C.max.z-q.z)*W,M=(C.min.z-q.z)*W),H>M||m>I)return null;if((m>H||H!==H)&&(H=m),(I>M||I!==I)&&(I=M),0>I)return null;var u=H>=0?H:I,g=this.maxHitLen;return g&&u>g?null:this.at(u,F)},intersectTriangle:function(){var T=new Zb,s=new Zb,h=new Zb,$=new Zb;return function(u,F,Y,V,r){s.subVectors(F,u),h.subVectors(Y,u),$.crossVectors(s,h);var P,S=this.direction.dot($);if(S>0){if(V)return null;P=1}else{if(!(0>S))return null;P=-1,S=-S}T.subVectors(this.origin,u);var Z=P*this.direction.dot(h.crossVectors(T,h));if(0>Z)return null;var d=P*this.direction.dot(s.cross(T));if(0>d||Z+d>S)return null;var y=-P*T.dot($);if(0>y)return null;var f=y/S,v=this.maxHitLen;return v&&f>v?null:this.at(f,r)}}()});var Xi=s.Math.Box3=function(B,Q){this.min=B!==r?B:new Zb(1/0,1/0,1/0),this.max=Q!==r?Q:new Zb(-1/0,-1/0,-1/0)};R.assign(Xi.prototype,{set:function(G,j){return this.min.copy(G),this.max.copy(j),this},setFromArray:function(w){for(var O=1/0,C=1/0,K=1/0,i=-1/0,E=-1/0,t=-1/0,d=0,q=w.length;q>d;d+=3){var f=w[d],e=w[d+1],r=w[d+2];O>f&&(O=f),C>e&&(C=e),K>r&&(K=r),f>i&&(i=f),e>E&&(E=e),r>t&&(t=r)}return this.min.set(O,C,K),this.max.set(i,E,t),this},setFromPoints:function($){this.makeEmpty();for(var Z=0,x=$.length;x>Z;Z++)this.expandByPoint($[Z]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function($){return $.max.x<this.min.x||$.min.x>this.max.x||$.max.y<this.min.y||$.min.y>this.max.y||$.max.z<this.min.z||$.min.z>this.max.z?!1:!0},copy:function(p){return this.min.copy(p.min),this.max.copy(p.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(W){return this.min.min(W),this.max.max(W),this},expandByBox:function(L){return this.min.min(L.min),this.max.max(L.max),this},applyMatrix4:function(){var Z=[new Zb,new Zb,new Zb,new Zb,new Zb,new Zb,new Zb,new Zb];return function(E){return this.isEmpty()?this:(Z[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(E),Z[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(E),Z[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(E),Z[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(E),Z[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(E),Z[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(E),Z[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(E),Z[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(E),this.setFromPoints(Z),this)}}()});var Xq=s.Math.Sphere=function(d,$){this.center=d!==r?d:new Zb,this.radius=$!==r?$:0};R.assign(Xq.prototype,{set:function(E,H){return this.center.copy(E),this.radius=H,this},setFromPoints:function(){var J=new Xi;return function(B,u){var R=this.center;u!==r?R.copy(u):J.setFromPoints(B).getCenter(R);for(var D=0,d=0,E=B.length;E>d;d++)D=Math.max(D,R.distanceToSquared(B[d]));return this.radius=Math.sqrt(D),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(S){return this.center.copy(S.center),this.radius=S.radius,this},empty:function(){return this.radius<=0},containsPoint:function(d){return d.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(p){return p.distanceTo(this.center)-this.radius},intersectsSphere:function(T){var n=this.radius+T.radius;return T.center.distanceToSquared(this.center)<=n*n},intersectsBox:function(F){return F.intersectsSphere(this)},intersectsPlane:function(w){return Math.abs(w.distanceToPoint(this.center))<=this.radius},clampPoint:function(n,M){var I=this.center.distanceToSquared(n);return M===r&&(M=new Zb),M.copy(n),I>this.radius*this.radius&&(M.sub(this.center).normalize(),M.multiplyScalar(this.radius).add(this.center)),M},getBoundingBox:function(s){return s===r&&(s=new Xi),s.set(this.center,this.center),s.expandByScalar(this.radius),s},applyMatrix4:function(I){return this.center.applyMatrix4(I),this.radius=this.radius*I.getMaxScaleOnAxis(),this},translate:function(b){return this.center.add(b),this},equals:function(J){return J.center.equals(this.center)&&J.radius===this.radius}});var dg=s.Math.Frustum=function(w,Z,x,u,D,g){this.planes=[w!==r?w:new Jj,Z!==r?Z:new Jj,x!==r?x:new Jj,u!==r?u:new Jj,D!==r?D:new Jj,g!==r?g:new Jj]};R.assign(dg.prototype,{set:function(g,s,q,_,K,Z){var l=this.planes;return l[0].copy(g),l[1].copy(s),l[2].copy(q),l[3].copy(_),l[4].copy(K),l[5].copy(Z),this},clone:function(){return(new this.constructor).copy(this)},copy:function(v){for(var c=this.planes,Z=0;6>Z;Z++)c[Z].copy(v.planes[Z]);return this},setFromMatrix:function(K){var w=this.planes,u=K.el,e=u[0],_=u[1],B=u[2],q=u[3],m=u[4],O=u[5],o=u[6],G=u[7],b=u[8],v=u[9],a=u[10],J=u[11],j=u[12],M=u[13],U=u[14],$=u[15];return w[0].setComponents(q-e,G-m,J-b,$-j).normalize(),w[1].setComponents(q+e,G+m,J+b,$+j).normalize(),w[2].setComponents(q+_,G+O,J+v,$+M).normalize(),w[3].setComponents(q-_,G-O,J-v,$-M).normalize(),w[4].setComponents(q-B,G-o,J-a,$-U).normalize(),w[5].setComponents(q+B,G+o,J+a,$+U).normalize(),this},intersectsObject:function(){var x=new Xq;return function(K){var n=K.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),x.copy(n.boundingSphere).applyMatrix4(K.matrixWorld),this.intersectsSphere(x)}}(),intersectsSprite:function(){var P=new Xq;return function(v){return P.center.set(0,0,0),P.radius=.7071067811865476,P.applyMatrix4(v.matrixWorld),this.intersectsSphere(P)}}(),intersectsSphere:function(l){for(var m=this.planes,v=l.center,Z=-l.radius,_=0;6>_;_++){var C=m[_].distanceToPoint(v);if(Z>C)return!1}return!0},intersectsBox:function(){var b=new Zb;return function(d){for(var t=this.planes,B=0;6>B;B++){var $=t[B];if(b.x=$.normal.x>0?d.max.x:d.min.x,b.y=$.normal.y>0?d.max.y:d.min.y,b.z=$.normal.z>0?d.max.z:d.min.z,$.distanceToPoint(b)<0)return!1}return!0}}(),containsPoint:function(y){for(var v=this.planes,b=0;6>b;b++)if(v[b].distanceToPoint(y)<0)return!1;return!0}});var _p=s.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};R.assign(_p.prototype,{set:function(N,Z,v,$,_,s,I,P,y,L,K,D,t,n,X,J){var p=this.el;return p[0]=N,p[4]=Z,p[8]=v,p[12]=$,p[1]=_,p[5]=s,p[9]=I,p[13]=P,p[2]=y,p[6]=L,p[10]=K,p[14]=D,p[3]=t,p[7]=n,p[11]=X,p[15]=J,this},clone:function(){return(new _p).fromArray(this.el)},fromArray:function(K,m){m===r&&(m=0);for(var M=this.el,t=0;16>t;t++)M[t]=K[t+m];return this},getElements:function(){return this.el},scale:function(h){var g=this.el,c=h.x,A=h.y,X=h.z;return g[0]*=c,g[4]*=A,g[8]*=X,g[1]*=c,g[5]*=A,g[9]*=X,g[2]*=c,g[6]*=A,g[10]*=X,g[3]*=c,g[7]*=A,g[11]*=X,this},makeRotationFromEuler:function(y){var p=this.el,Z=y._x,h=y._y,Y=y._z,x=y._order,I=Math.cos(Z),F=Math.sin(Z),m=Math.cos(h),r=Math.sin(h),c=Math.cos(Y),A=Math.sin(Y);if("XYZ"===x){var N=I*c,P=I*A,t=F*c,M=F*A;p[0]=m*c,p[4]=-m*A,p[8]=r,p[1]=P+t*r,p[5]=N-M*r,p[9]=-F*m,p[2]=M-N*r,p[6]=t+P*r,p[10]=I*m}else if("YXZ"===x){var H=m*c,J=m*A,D=r*c,S=r*A;p[0]=H+S*F,p[4]=D*F-J,p[8]=I*r,p[1]=I*A,p[5]=I*c,p[9]=-F,p[2]=J*F-D,p[6]=S+H*F,p[10]=I*m}else if("ZXY"===x){var H=m*c,J=m*A,D=r*c,S=r*A;p[0]=H-S*F,p[4]=-I*A,p[8]=D+J*F,p[1]=J+D*F,p[5]=I*c,p[9]=S-H*F,p[2]=-I*r,p[6]=F,p[10]=I*m}else if("ZYX"===x){var N=I*c,P=I*A,t=F*c,M=F*A;p[0]=m*c,p[4]=t*r-P,p[8]=N*r+M,p[1]=m*A,p[5]=M*r+N,p[9]=P*r-t,p[2]=-r,p[6]=F*m,p[10]=I*m}else if("YZX"===x){var Q=I*m,U=I*r,d=F*m,X=F*r;p[0]=m*c,p[4]=X-Q*A,p[8]=d*A+U,p[1]=A,p[5]=I*c,p[9]=-F*c,p[2]=-r*c,p[6]=U*A+d,p[10]=Q-X*A}else if("XZY"===x){var Q=I*m,U=I*r,d=F*m,X=F*r;p[0]=m*c,p[4]=-A,p[8]=r*c,p[1]=Q*A+X,p[5]=I*c,p[9]=U*A-d,p[2]=d*A-U,p[6]=F*c,p[10]=X*A+Q}return p[3]=0,p[7]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,this},makeRotationFromQuaternion:function(V){var $=this.el,l=V._x,m=V._y,r=V._z,U=V._w,p=l+l,f=m+m,k=r+r,g=l*p,A=l*f,Y=l*k,G=m*f,X=m*k,Z=r*k,q=U*p,s=U*f,L=U*k;return $[0]=1-(G+Z),$[4]=A-L,$[8]=Y+s,$[1]=A+L,$[5]=1-(g+Z),$[9]=X-q,$[2]=Y-s,$[6]=X+q,$[10]=1-(g+G),$[3]=0,$[7]=0,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(T){var K=this.el,Z=T.el,H=Z[0],R=Z[1],m=Z[2],$=Z[3],g=Z[4],d=Z[5],I=Z[6],Y=Z[7],l=Z[8],c=Z[9],q=Z[10],k=Z[11],A=Z[12],i=Z[13],D=Z[14],W=Z[15],s=c*D*Y-i*q*Y+i*I*k-d*D*k-c*I*W+d*q*W,G=A*q*Y-l*D*Y-A*I*k+g*D*k+l*I*W-g*q*W,o=l*i*Y-A*c*Y+A*d*k-g*i*k-l*d*W+g*c*W,x=A*c*I-l*i*I-A*d*q+g*i*q+l*d*D-g*c*D,n=H*s+R*G+m*o+$*x;if(0===n)return this.identity();var Q=1/n;return K[0]=s*Q,K[1]=(i*q*$-c*D*$-i*m*k+R*D*k+c*m*W-R*q*W)*Q,K[2]=(d*D*$-i*I*$+i*m*Y-R*D*Y-d*m*W+R*I*W)*Q,K[3]=(c*I*$-d*q*$-c*m*Y+R*q*Y+d*m*k-R*I*k)*Q,K[4]=G*Q,K[5]=(l*D*$-A*q*$+A*m*k-H*D*k-l*m*W+H*q*W)*Q,K[6]=(A*I*$-g*D*$-A*m*Y+H*D*Y+g*m*W-H*I*W)*Q,K[7]=(g*q*$-l*I*$+l*m*Y-H*q*Y-g*m*k+H*I*k)*Q,K[8]=o*Q,K[9]=(A*c*$-l*i*$-A*R*k+H*i*k+l*R*W-H*c*W)*Q,K[10]=(g*i*$-A*d*$+A*R*Y-H*i*Y-g*R*W+H*d*W)*Q,K[11]=(l*d*$-g*c*$-l*R*Y+H*c*Y+g*R*k-H*d*k)*Q,K[12]=x*Q,K[13]=(l*i*m-A*c*m+A*R*q-H*i*q-l*R*D+H*c*D)*Q,K[14]=(A*d*m-g*i*m-A*R*I+H*i*I+g*R*D-H*d*D)*Q,K[15]=(g*c*m-l*d*m+l*R*I-H*c*I-g*R*q+H*d*q)*Q,this},makeRotationAxis:function(o,y){var q=Math.cos(y),S=Math.sin(y),m=1-q,v=o.x,x=o.y,G=o.z,W=m*v,z=m*x;return this.set(W*v+q,W*x-S*G,W*G+S*x,0,W*x+S*G,z*x+q,z*G-S*v,0,W*G-S*x,z*G+S*v,m*G*G+q,0,0,0,0,1),this},multiply:function(z){return this.multiplyMatrices(this,z)},premultiply:function(D){return this.multiplyMatrices(D,this)},multiplyMatrices:function(M,R){var g=M.el,Q=R.el,D=this.el,x=g[0],J=g[4],I=g[8],S=g[12],h=g[1],O=g[5],b=g[9],p=g[13],E=g[2],s=g[6],v=g[10],t=g[14],l=g[3],o=g[7],W=g[11],Z=g[15],$=Q[0],q=Q[4],f=Q[8],K=Q[12],r=Q[1],N=Q[5],n=Q[9],V=Q[13],T=Q[2],e=Q[6],i=Q[10],U=Q[14],c=Q[3],X=Q[7],Y=Q[11],u=Q[15];return D[0]=x*$+J*r+I*T+S*c,D[4]=x*q+J*N+I*e+S*X,D[8]=x*f+J*n+I*i+S*Y,D[12]=x*K+J*V+I*U+S*u,D[1]=h*$+O*r+b*T+p*c,D[5]=h*q+O*N+b*e+p*X,D[9]=h*f+O*n+b*i+p*Y,D[13]=h*K+O*V+b*U+p*u,D[2]=E*$+s*r+v*T+t*c,D[6]=E*q+s*N+v*e+t*X,D[10]=E*f+s*n+v*i+t*Y,D[14]=E*K+s*V+v*U+t*u,D[3]=l*$+o*r+W*T+Z*c,D[7]=l*q+o*N+W*e+Z*X,D[11]=l*f+o*n+W*i+Z*Y,D[15]=l*K+o*V+W*U+Z*u,this},lookAt:function(){var V=new Zb,n=new Zb,S=new Zb;return function(E,m,l){var p=this.el;return S.subVectors(E,m),0===S.lengthSq()&&(S.z=1),S.normalize(),V.crossVectors(l,S),0===V.lengthSq()&&(1===Math.abs(l.z)?S.x+=1e-4:S.z+=1e-4,S.normalize(),V.crossVectors(l,S)),V.normalize(),n.crossVectors(S,V),p[0]=V.x,p[4]=n.x,p[8]=S.x,p[1]=V.y,p[5]=n.y,p[9]=S.y,p[2]=V.z,p[6]=n.z,p[10]=S.z,this}}(),extractScale:function(){var P;return function(u){P===r&&(P=new Zb),u===r&&(u=new Zb);var T=P.setFromMatrixColumn(this,0).length(),s=P.setFromMatrixColumn(this,1).length(),Y=P.setFromMatrixColumn(this,2).length();return u.set(T,s,Y),u}}(),extractRotation:function(){var S;return function(F){S===r&&(S=new Zb),F===r&&(F=new _p);var $=this.el,j=F.el,V=1/S.setFromMatrixColumn(F,0).length(),t=1/S.setFromMatrixColumn(F,1).length(),W=1/S.setFromMatrixColumn(F,2).length();return $[0]=j[0]*V,$[1]=j[1]*V,$[2]=j[2]*V,$[4]=j[4]*t,$[5]=j[5]*t,$[6]=j[6]*t,$[8]=j[8]*W,$[9]=j[9]*W,$[10]=j[10]*W,this}}(),multiplyScalar:function(i){var V=this.el;return V[0]*=i,V[4]*=i,V[8]*=i,V[12]*=i,V[1]*=i,V[5]*=i,V[9]*=i,V[13]*=i,V[2]*=i,V[6]*=i,V[10]*=i,V[14]*=i,V[3]*=i,V[7]*=i,V[11]*=i,V[15]*=i,this},getPosition:function(z){return z===r&&(z=new Zb),z.setFromMatrixColumn(this,3)},setPosition:function(m){var t=this.el;return t[12]=m.x,t[13]=m.y,t[14]=m.z,this},toArray:function(v,d){v===r&&(v=[]),d===r&&(d=0);var B=this.el;return v[d]=B[0],v[d+1]=B[1],v[d+2]=B[2],v[d+3]=B[3],v[d+4]=B[4],v[d+5]=B[5],v[d+6]=B[6],v[d+7]=B[7],v[d+8]=B[8],v[d+9]=B[9],v[d+10]=B[10],v[d+11]=B[11],v[d+12]=B[12],v[d+13]=B[13],v[d+14]=B[14],v[d+15]=B[15],v},determinant:function(){var I=this.el,x=I[0],z=I[4],i=I[8],Y=I[12],G=I[1],W=I[5],V=I[9],U=I[13],a=I[2],S=I[6],u=I[10],H=I[14],T=I[3],q=I[7],k=I[11],Q=I[15];return T*(+Y*V*S-i*U*S-Y*W*u+z*U*u+i*W*H-z*V*H)+q*(+x*V*H-x*U*u+Y*G*u-i*G*H+i*U*a-Y*V*a)+k*(+x*U*S-x*W*H-Y*G*S+z*G*H+Y*W*a-z*U*a)+Q*(-i*W*a-x*V*S+x*W*u+i*G*S-z*G*u+z*V*a)},copy:function(s){var y=this.el,_=s.el;return y[0]=_[0],y[1]=_[1],y[2]=_[2],y[3]=_[3],y[4]=_[4],y[5]=_[5],y[6]=_[6],y[7]=_[7],y[8]=_[8],y[9]=_[9],y[10]=_[10],y[11]=_[11],y[12]=_[12],y[13]=_[13],y[14]=_[14],y[15]=_[15],this},compose:function(x,d,g){var G=this.el,h=d._x,F=d._y,C=d._z,J=d._w,e=h+h,a=F+F,s=C+C,b=h*e,_=h*a,O=h*s,o=F*a,l=F*s,W=C*s,U=J*e,A=J*a,m=J*s,B=g.x,u=g.y,Q=g.z;return G[0]=(1-(o+W))*B,G[1]=(_+m)*B,G[2]=(O-A)*B,G[3]=0,G[4]=(_-m)*u,G[5]=(1-(b+W))*u,G[6]=(l+U)*u,G[7]=0,G[8]=(O+A)*Q,G[9]=(l-U)*Q,G[10]=(1-(b+o))*Q,G[11]=0,G[12]=x.x,G[13]=x.y,G[14]=x.z,G[15]=1,this},decompose:function(){var I=new Zb,p=new _p;return function($,W,E){var v=this.el,i=I.set(v[0],v[1],v[2]).length(),l=I.set(v[4],v[5],v[6]).length(),b=I.set(v[8],v[9],v[10]).length(),O=this.determinant();0>O&&(i=-i),$.x=v[12],$.y=v[13],$.z=v[14],p.copy(this);var u=1/i,s=1/l,P=1/b;return p.el[0]*=u,p.el[1]*=u,p.el[2]*=u,p.el[4]*=s,p.el[5]*=s,p.el[6]*=s,p.el[8]*=P,p.el[9]*=P,p.el[10]*=P,W.setFromRotationMatrix(p),E.x=i,E.y=l,E.z=b,this}}()});var yi=s.Math.Triangle=function(z,c,X){this.a=z!==r?z:new Zb,this.b=c!==r?c:new Zb,this.c=X!==r?X:new Zb};R.assign(yi,{barycoordFromPoint:function(){var L=new Zb,W=new Zb,v=new Zb;return function(A,N,O,T,X){L.subVectors(T,N),W.subVectors(O,N),v.subVectors(A,N);var r=L.dot(L),u=L.dot(W),y=L.dot(v),s=W.dot(W),g=W.dot(v),o=r*s-u*u,k=X||new Zb;if(0===o)return k.set(-2,-1,-1);var j=1/o,b=(s*y-u*g)*j,C=(r*g-u*y)*j;return k.set(1-b-C,C,b)}}()});var xc=s.Math.Euler=function(l,o,G,s,U){this.set(l,o,G,s,U)};xc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],xc.DefaultOrder="XYZ",xc.ReverseOrder=function(o){return o=o[2]+o[1]+o[0],o.toUpperCase()},R.defineProperties(xc.prototype,{x:{get:function(){return this._x},set:function(n){this._x=n,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(n){this._y=n,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(M){this._z=M,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(_){this._order=_,this.onChangeCallback()}}}),R.assign(xc.prototype,{set:function(W,g,C,F,J){return wd(W)&&(J=C,F=g,C=W[2],g=W[1],W=W[0]),F?J&&(F=xc.ReverseOrder(F)):F="ZYX",this._x=W||0,this._y=g||0,this._z=C||0,this._order=F||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(D){return this._x=D._x,this._y=D._y,this._z=D._z,this._order=D._order,this.onChangeCallback(),this},setFromRotationMatrix:function(G,D,q){var B=s.Math.clamp,p=G.el||G,A=p[0],c=p[4],d=p[8],Q=p[1],b=p[5],z=p[9],S=p[2],n=p[6],r=p[10];return D=D||this._order,"XYZ"===D?(this._y=Math.asin(B(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(-z,r),this._z=Math.atan2(-c,A)):(this._x=Math.atan2(n,b),this._z=0)):"YXZ"===D?(this._x=Math.asin(-B(z,-1,1)),Math.abs(z)<.99999?(this._y=Math.atan2(d,r),this._z=Math.atan2(Q,b)):(this._y=Math.atan2(-S,A),this._z=0)):"ZXY"===D?(this._x=Math.asin(B(n,-1,1)),Math.abs(n)<.99999?(this._y=Math.atan2(-S,r),this._z=Math.atan2(-c,b)):(this._y=0,this._z=Math.atan2(Q,A))):"ZYX"===D?(this._y=Math.asin(-B(S,-1,1)),Math.abs(S)<.99999?(this._x=Math.atan2(n,r),this._z=Math.atan2(Q,A)):(this._x=0,this._z=Math.atan2(-c,b))):"YZX"===D?(this._z=Math.asin(B(Q,-1,1)),Math.abs(Q)<.99999?(this._x=Math.atan2(-z,b),this._y=Math.atan2(-S,A)):(this._x=0,this._y=Math.atan2(d,r))):"XZY"===D?(this._z=Math.asin(-B(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(n,b),this._y=Math.atan2(d,A)):(this._x=Math.atan2(-z,r),this._y=0)):console.warn("unsupported order: "+D),this._order=D,q!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var Y=new _p;return function(K,s,f){return Y.makeRotationFromQuaternion(K),this.setFromRotationMatrix(Y,s,f)}}(),setFromVector3:function(x,V){return this.set(x.x,x.y,x.z,V||this._order)},reorder:function(){var h=new _i;return function(F){return h.setFromEuler(this),this.setFromQuaternion(h,F)}}(),equals:function($){return $._x===this._x&&$._y===this._y&&$._z===this._z&&$._order===this._order},fromArray:function(E){return this._x=E[0],this._y=E[1],this._z=E[2],E[3]!==r&&(this._order=E[3]),this.onChangeCallback(),this},toArray:function(R,h){return R===r&&(R=[]),h===r&&(h=0),R[h]=this._x,R[h+1]=this._y,R[h+2]=this._z,R[h+3]=this._order,R},toVector3:function(u){return u?u.set(this._x,this._y,this._z):new Zb(this._x,this._y,this._z)},onChange:function(P){return this.onChangeCallback=P,this},onChangeCallback:function(){}});var Jo={ms_ac:function(h,b){for(var O=b.ms_ac,z=0;z<O.length;z++)vj(h,O[z])},ms_listener:function(v){v.addListeners=function(){var x=this,d=Gq;Y.mockTouch&&(d=ek.concat(Ue).concat(Kr)),x.__events__=d;
for(var m=0,$=d.length;$>m;m++){var c=d[m];"wheel"===c&&!x.handle_wheel&&x.handle_mousewheel&&(x.handle_wheel=function(D){$l(x,D)}),x["handle_"+c]&&mp(c,x.getView(),x)}},v.removeListeners=function(){var y=this,G=y.__events__;if(G){y.__events__=r;for(var t=0,N=G.length;N>t;t++)y["handle_"+G[t]]&&dc(G[t],y.getView(),y)}}},ms_fire:function(T){T.mp=function(x,U,$){this.addPropertyChangeListener(x,U,$)},T.ump=function(T,U){this.removePropertyChangeListener(T,U)},T.fp=function(K,D,v,u,J){return this.firePropertyChange(K,D,v,u,J)},T.addPropertyChangeListener=function(l,V,I){var e=this;e._62I||(e._62I=new hh),e._62I.add(l,V,I)},T.removePropertyChangeListener=function(y,K){this._62I&&this._62I.remove(y,K)},T.firePropertyChange=function(j,G,z,D,R){if(D){if(D(G,z))return!1}else if(G===z)return!1;var g=this,y=R||{};return y.property=j,y.oldValue=G,y.newValue=z,y.source=g,y.data=g,g._62I&&g._62I.fire(y),g.onPropertyChanged&&g.onPropertyChanged(y),!0}},ms_attr:function(d){d.a=function(k,X){var C=this;if(2===arguments.length)C.setAttr(k,X);else{if(!np(k))return C.getAttr(k);for(var h in k)C.setAttr(h,k[h])}return C},d.getAttr=function(C,u){if(u===r&&(u=1),this._attrObject&&C in this._attrObject)return this._attrObject[C];if(this.getImage){var F=this.getImage();if(ap(F)&&(F=lo[F]),np(F)&&"dataBindings"in F)for(var X=F.dataBindings,J=X.length-1;J>=0;J--){var R=X[J];if(R.attr===C){if("defaultValue"in R)return R.defaultValue;break}}}return u?h[C]:r},d.setAttr=function(Y,j){var n=this;n._attrObject||(n._attrObject={});var s=n._attrObject[Y];j===r?delete n._attrObject[Y]:n._attrObject[Y]=j,n.fp&&n.fp("a:"+Y,s,j)&&n.onAttrChanged&&n.onAttrChanged(Y,s,j)},d.getSerializableAttrs=function(){var j,b={};for(j in this._attrObject)b[j]=1;return b}},ms_bnb:function(w){w.getBodyColor=function(l){return l.s("body.color")},w.getBorderColor=function(L){return L.s("border.color")}},_51o:function(T){T.mi=function(l,w,n){this.addInteractorListener(l,w,n)},T.umi=function(C,k){this.removeInteractorListener(C,k)},T.fi=function(w){this.fireInteractorEvent(w)},T.addInteractorListener=function(b,K,n){var B=this;B._63I||(B._63I=new hh),B._63I.add(b,K,n)},T.removeInteractorListener=function(Y,K){this._63I&&this._63I.remove(Y,K)},T.fireInteractorEvent=function(n){this._63I&&this._63I.fire(n)},T.setInteractors=function(h){var k=this,G=k._interactors;G&&G.each(function(E){E.tearDown()}),wd(h)&&(h=new Pk(h)),k._interactors=h,h&&h.each(function(Y){Y.setUp()}),k.fp("interactors",G,h),k.invalidateSelection()},T.getInteractors=function(){return this._interactors}},_49o:function(L){L._44O=w,L._45O=w,L.getTopPainters=function(){return this._44O},L.getBottomPainters=function(){return this._45O},L.addTopPainter=function(K){var B=this;B._44O||(B._44O=new Pk),B._44O.contains(K)||(B._44O.add(K),B.redraw&&B.redraw())},L.removeTopPainter=function(f){var H=this;H._44O&&(H._44O.remove(f),H.redraw&&H.redraw())},L.addBottomPainter=function(Z){var n=this;n._45O||(n._45O=new Pk),n._45O.contains(Z)||(n._45O.add(Z),n.redraw&&n.redraw())},L.removeBottomPainter=function(u){var T=this;T._45O&&(T._45O.remove(u),T.redraw&&T.redraw())},L._93db=function(f,L){var U=this;U._45O&&U._45O.each(function(u){u.draw?u.draw(f,L):u.call(U,f,L)})},L._92db=function(_,b){var V=this;V._44O&&V._44O.each(function(y){y.draw?y.draw(_,b):y.call(V,_,b)})}},ms_sm:function(D){D.sm=function(){return this.getSelectionModel()},D.setSelectableFunc=function(d){this.sm().setFilterFunc(d)},D.getSelectableFunc=function(){return this.sm().getFilterFunc()},D.getSelectionModel=function(){var o=this;return o._selectionModel?o._selectionModel:o.dm().sm()},D.isSelectionModelShared=function(){return!this._selectionModel},D.setSelectionModelShared=function(k){var H=this,G=!H._selectionModel,U=H.handleSelectionChange,q=H.dm();G!==k&&(H.invalidateSelection&&H.invalidateSelection(),k?(q.sm().ms(U,H),H._selectionModel.ums(U,H),H._selectionModel.dispose(),H._selectionModel=w):(q.sm().ums(U,H),H._selectionModel=new pq(q),H._selectionModel.ms(U,H)),H.onSelectionModelSharedChanged(),H.fp("selectionModelShared",G,k))},D.onSelectionModelSharedChanged=function(){var P=this;P.redraw(),P.invalidateSelection&&P.invalidateSelection()},D.removeSelection=function(){var n=this.dm();n.beginTransaction(),this.sm().toSelection().each(n.remove,n),n.endTransaction()},D.selectAll=function(){var g=this;g.sm().ss(g.dm().toDatas(function(h){return g.isVisible(h)&&g.isSelectable(h)}))},D.isSelected=function(J){return this.sm().co(J)},D.isSelectedById=function(Z){var h=this.dm().getDataById(Z);return h?this.isSelected(h):!1},D.isSelectable=function(p){return this.sm().isSelectable(p)}},ms_tx:function(M){M._64I=0,M._65O=0,M.isScrollable=function(){return this.getWidth()<this._64I},M._40o=function(){return this.isScrollable()},M.getLogicalPoint=function(r){return bc(r,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},M.tx=function(j){return j===r?this.getTranslateX():(this.setTranslateX(j),void 0)},M.getTranslateX=function(){return this._65O},M.setTranslateX=function(V){var k=this,i=k.getWidth()-k._64I;i>V&&(V=i),V>0&&(V=0),V=N(V);var t=k._65O;k._65O=V,k.fp(kh,t,V)}},ms_ty:function(U){U._23Q=0,U._66O=0,U._41o=function(){return this.getHeight()<this._23Q},U.getLogicalPoint=function(S){return bc(S,this._canvas||this._view,this.tx?this.tx():0,this.ty())},U.ty=function(G){return G===r?this.getTranslateY():(this.setTranslateY(G),void 0)},U.getTranslateY=function(){return this._66O},U.setTranslateY=function(C){var F=this,T=F.getHeight()-F._23Q;T>C&&(C=T),C>0&&(C=0),C=N(C);var i=F._66O;F._66O=C,F.fp(Ze,i,C)}},ms_txy:function(K){K._65O=0,K._66O=0,K.tx=function(Z){return Z===r?this.getTranslateX():(this.setTranslateX(Z),void 0)},K.ty=function(y){return y===r?this.getTranslateY():(this.setTranslateY(y),void 0)},K.onTranslateEnded=function(){},K.setTranslate=function(c,u,T){var $=this;if(T=Re(T)){$._65I&&$._65I.stop(!0);var k=$.tx(),W=$.ty();T.action=function(J){$.setTranslate(k+(c-k)*J,W+(u-W)*J)},T._37o=function(){delete $._66I,delete $._65I,$.onTranslateEnded()},$._66I=1,$._65I=cj(T)}else $.tx(c),$.ty(u)},K.getTranslateX=function(){return this._65O},K.setTranslateX=function(W){var U=this;W=U.adjustTranslateX(W);var l=U._65O;U._65O=W,U.fp(kh,l,W)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(a){var F=this;a=F.adjustTranslateY(a);var n=F._66O;F._66O=a,F.fp(Ze,n,a)},K.adjustTranslateX=function(F){return N(F)},K.adjustTranslateY=function(s){return N(s)},K.translate=function(x,z,Y){this.setTranslate(this.tx()+x,this.ty()+z,Y)},K.getLogicalPoint=function(t){var K=this;return bc(t,this._canvas||K._view,K.tx(),K.ty())}},ms_dm:function(T){T.dm=function(C){return C?(this.setDataModel(C),void 0):this.getDataModel()},T.getDataModel=function(){return this._dataModel}},ms_lp:function(s){s.lp=function(z){return this.getLogicalPoint(z)}},ms_v:function(R){R._disabled=!1,R.setDisabled=function(C,E){var O=this,I=O._disabled;I!==C&&(I&&(zk(O._63O),delete O._63O),C&&(Ld(O._view,O._63O=ik(E)),O.iv()),O._disabled=C,O.fp("disabled",I,C))},R.isDisabled=function(){return this._disabled},R.getDisabledDiv=function(){return this._63O},R.getView=function(){return this._view},R.addToDOM=function(L){var W=this,V=W.getView(),Q=V.style;L=L||A.body,L.appendChild(V),Q.left="0",Q.right="0",Q.top="0",Q.bottom="0",B(x,"resize",function(){W.iv()}),W.iv()},R.getWidth=function(){return this._view.clientWidth},R.getHeight=function(){return this._view.clientHeight},R.setWidth=function(d){var J=this;J._view.style.width=d+qf,J.iv(),J.fp&&J.fp(rl,w,d)},R.setHeight=function(H){var J=this;J._view.style.height=H+qf,J.iv(),J.fp&&J.fp(fc,w,H)},R.setFocus=function(V){var b=this,O=b._currentEditor;return V&&O&&(O.getView&&(O=O.getView()),O.contains(V.target))?!1:(hj(b._view),b.endEditing&&b.endEditing(),b.fireViewEvent("focus"),!0)},R.iv=function(C){this.invalidate(C)},R.invalidate=function(J){var Z=this;Z._68I||(Z._68I=1,pm(Z.validate,Z,w,J),Z.onInvalidated&&Z.onInvalidated(),Z.fireViewEvent("invalidate"))},R.validate=function(){var L=this,B=L._view;if(L._68I&&(delete L._68I,B.parentNode))if(0===B.offsetWidth&&0===B.offsetHeight&&L._67I!==w)L._67I===r&&(L._67I=Y.reinvalidateCount),L._67I>0?L._67I--:L._67I=w,L.iv();else{L.fireViewEvent("beginValidate"),L.validateImpl(),L.onValidated&&L.onValidated(),L.fireViewEvent("validate");var f=L._63O;f&&(B.lastChild!==f&&(zk(f),Ld(B,f)),Ni(f,0,0,L.getWidth(),L.getHeight())),Yr(L),Tm(L),dh(L)}},R.layout=function(y,x,J,P){1===arguments.length?Ni(this,y):Ni(this,y,x,J,P)},R.addViewListener=function(Q,S,n){var _=this;_._67O||(_._67O=new hh),_._67O.add(Q,S,n)},R.removeViewListener=function(n,m){this._67O.remove(n,m)},R.fireViewEvent=function(U){var n=this;n._67O&&(ap(U)&&(U={kind:U}),n._67O.fire(U)),Y.viewListener&&Y.viewListener(n,U)}},ms_tip:function(G){G.setToolTipEnabled=function(v){var o=this;v?re||o._13o||(o.enableToolTip(),o.fp("toolTipEnabled",!1,!0)):o._13o&&(o.disableToolTip(),o.fp("toolTipEnabled",!0,!1))},G.isToolTipEnabled=function(){return!!this._13o},G.enableToolTip=function(){var Z=this;if(!re&&!Z._13o){Z._13o=function(L){var S=Z.getToolTip(L);S!=w?Y.toolTipContinual&&Y.isToolTipShowing()?eq(L,S):(Wc(),Yl={timeout:fr(He,xq),e:L,info:S}):Wc()};var y=Z.getView();B(y,Vj,Z._13o),B(y,"mouseleave",Y.hideToolTip)}},G.disableToolTip=function(){var y=this;if(y._13o){var n=y.getView();q(n,Vj,y._13o),q(n,"mouseleave",Y.hideToolTip),delete y._13o}},G.getToolTip=function(j){var D=this;if(D.getDataAt){var V=D.getDataAt(j);return V?V.getToolTip():w}return D.getValue?D.getValue():void 0}},_52o:function(Q){Q._zoom=1,Q._29I=Jq,Q.zoomIn=function(H,E){this.setZoom(this._zoom*bn,H,E)},Q.zoomOut=function(Q,C){this.setZoom(this._zoom/bn,Q,C)},Q.zoomReset=function(U,$){this.setZoom(1,U,$)},Q.scrollZoomIn=function(A){this.setZoom(this._zoom*On,w,A)},Q.scrollZoomOut=function(q){this.setZoom(this._zoom/On,w,q)},Q.pinchZoomIn=function(G){this.setZoom(this._zoom*xs,w,G)},Q.pinchZoomOut=function(D){this.setZoom(this._zoom/xs,w,D)},Q.adjustZoom=function(Z){return lb>Z?lb:Z>jo?jo:Z},Q.getZoom=function(){return this._zoom},Q.setZoom=function(J,Z,C){var I=this;if(Z=Re(Z)){I._14o&&I._14o.stop(!0);var y=I._zoom;Z.action=function(l){I._96O(y+(J-y)*l,C)},Z._37o=function(){delete I._zooming,delete I._14o,I.onZoomEnded()},I._zooming=1,I._14o=cj(Z)}else I._96O(J,C)},Q._96O=function(O,t){var R=this;if(O=R.adjustZoom(O),O!==R._zoom){R.validate();var c=R._29I,i=R._zoom;0!==c.width&&0!==c.height&&(t=t?t:{x:c.x+c.width/2,y:c.y+c.height/2},R.tx((t.x-c.x)*i-t.x*O),R.ty((t.y-c.y)*i-t.y*O)),R._zoom=O,R.fp("zoom",i,O)}}},ms_edge:function(y){y._2I=function(l){var W=this;W._44I||(W._44I=new Pk),W._42I||(W._42I=new Pk),W._44I.add(l),W._42I.add(l),W._20I()},y._4I=function(y){var M=this;M._44I||(M._44I=new Pk),M._43I||(M._43I=new Pk),M._44I.add(y),M._43I.add(y),M._20I()},y._16I=function(m){var h=this;h._44I.remove(m),h._42I.remove(m),h._44I.isEmpty()&&delete h._44I,h._42I.isEmpty()&&delete h._42I,h._20I()},y._18I=function(C){var z=this;z._44I.remove(C),z._43I.remove(C),z._44I.isEmpty()&&delete z._44I,z._43I.isEmpty()&&delete z._43I,z._20I()},y._20I=function(){var j=this;if(delete j._45I,!j._44I||j._44I.isEmpty())return delete j._70O,void 0;var D;j._44I.each(function(B){B.isLooped()&&(D||(D={}),D[B._id]||(j._45I||(j._45I=new Pk),j._45I.add(B),D[B._id]=B))}),D?(j._70O=new Pk,j._44I.each(function(h){D[h._id]?"A"===D[h._id]||(D[h._id]="A",j._70O.add(h)):j._70O.add(h)})):j._70O=j._44I},y.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},y.getSourceAgentEdges=function(){return this._46I},y.getTargetAgentEdges=function(){return this._47I},y._1I=function(C){var K=this;K._46I||(K._46I=new Pk),K._48I||(K._48I=new Pk),K._46I.add(C),K._48I.add(C),K._19I()},y._3I=function(d){var R=this;R._47I||(R._47I=new Pk),R._48I||(R._48I=new Pk),R._47I.add(d),R._48I.add(d),R._19I()},y._15I=function(g){var r=this;r._46I.remove(g),r._48I.remove(g),r._46I.isEmpty()&&delete r._46I,r._48I.isEmpty()&&delete r._48I,r._19I()},y._17I=function(e){var G=this;G._47I.remove(e),G._48I.remove(e),G._47I.isEmpty()&&delete G._47I,G._48I.isEmpty()&&delete G._48I,G._19I()},y._19I=function(){var p=this;delete p._49I;var B=p._48I;if(B&&!B.isEmpty()){var R={};B.each(function(H){R[H._id]?p._49I||(p._49I=new Pk):R[H._id]=H}),p._49I?B.each(function(T){R[T._id]&&(p._49I.add(T),delete R[T._id])}):p._49I=B}},y.getLoopedEdges=function(){return this._45I},y.getEdges=function(){return this._70O},y.getAgentEdges=function(){return this._49I},y.getSourceEdges=function(){return this._42I},y.getTargetEdges=function(){return this._43I},y._8I=function(){this._70O&&this._70O.each(function(d){d._7I()})}},ms_shadow:function(b){po.PARAMS.forEach(function(W){var R=W.replace(/(^|\.)[a-z]/g,function(E){return E[E.length-1].toUpperCase()}),y=R.charAt(0).toLowerCase()+R.substr(1);b["getShadow"+R]=function(){return this._getShadowParam(y)},b["setShadow"+R]=function(L){this._setShadowParam(y,L)}}),b.enableShadow=function(s){this.shadowMap.setShadow(!0,s)},b.disableShadow=function(){this.shadowMap.setShadow(!1)},b._getShadowParam=function(Z){return this.shadowMap.getShadow()[Z]},b._setShadowParam=function(T,P){var g=this._getShadowParam(T),d={};d[T]=P;var W=this.shadowMap;W.setShadow(W.enable,d),this.firePropertyChange("shadow"+T.charAt(0).toUpperCase()+T.substr(1),g,P)}}};xl(Y,{getVersion:function(){return"7.2.2"}},!0),xl(Y,{numberDigits:5,crossOrigin:"",baseZIndex:r,isTouchable:re,mockTouch:!0,devicePixelRatio:x.devicePixelRatio?x.devicePixelRatio:x.screen?x.screen.deviceXDPI/x.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:e.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Nr},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(Z){return Z*Z},labelColor:_n,labelSelectColor:qk,labelFont:"12px arial, sans-serif",widgetIndent:re?30:20,widgetRowHeight:re?30:20,widgetHeaderHeight:re?32:22,widgetTitleHeight:re?34:24,scrollBarColor:Up,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:re?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Tq,intersectionLineLine:yn,isEnter:sk,isEsc:bo,isDelete:Zd,isSpace:Fg,isLeft:Yf,isUp:Cc,isRight:Ve,isDown:hs,isTouchEvent:Rl,getTarget:hi,isString:ap,isNumber:wn,isBoolean:Of,isArray:wd,isSelectAll:Ak,isFunction:Ln,isObject:np,getPropertyValue:Qf,setPropertyValue:Qi,addMethod:xl,isMobile:function(){var V;return function(){return V!==r?V:(V=!1,function(Z){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Z)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Z.substr(0,4)))&&(V=!0)}(navigator.userAgent||navigator.vendor||x.opera),V)}}(),createGradient:function(K,A,S,v,P,x,r,R){var M=up[A];return M(K,S,v,P,x,r,R)},appendToScreen:function(Z){Z=Z.getView?Z.getView():Z,(A.fullscreenElement||A.mozFullScreenElement||A.webkitFullscreenElement||A.msFullscreenElement||A.body).appendChild(Z)},encodeString:function(a){return s.Math.encodeBase64(a,Y.encodeStringKey)},decodeString:function(B){return s.Math.decodeBase64(B,Y.encodeStringKey)},findView:function(o){var n=function(o,d){var u=d._ht;u&&o.push(u);var P=d.children,f=P.length;if(f)for(var H=0;f>H;H++)n(o,P[H])},D=[];n(D,A.body);var p=function(C,u){for(var Y="2d"===u?Om.GraphView:Lq.Graph3dView,d=0,e=C.length;e>d;d++)if(C[d]instanceof Y)return D[d];return null};return"all"===o?D:"2d"===o?p(D,"2d"):"3d"===o?p(D,"3d"):p(D,"3d")||p(D,"2d")},toggleFullscreen:function(r){var i=r.getView();if(A.fullscreenElement||A.mozFullScreenElement||A.webkitFullscreenElement||A.msFullscreenElement)A.exitFullscreen?A.exitFullscreen():A.msExitFullscreen?A.msExitFullscreen():A.mozCancelFullScreen?A.mozCancelFullScreen():A.webkitExitFullscreen&&A.webkitExitFullscreen();else{var X=!0;if(r.isSelfViewEvent){var L=r.getX(),R=r.getY(),m=r.getWidth(),k=r.getHeight(),B=i.style.background,O=i.style.backgroundColor;B||O||(i.style.backgroundColor="white"),i.requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen();var I=setInterval(function(){if(i!==(A.fullscreenElement||A.mozFullScreenElement||A.webkitFullscreenElement||A.msFullscreenElement))clearInterval(I),r.setX(L),r.setY(R),r.setWidth(m),r.setHeight(k),r._fullscreen=!1,i.style.oldBackgroundColor=O,r.iv();else{var w=s.Default.getWindowInfo();(X||w.width!==r.getWidth()||w.height!==r.getHeight())&&(r.setX(w.left),r.setY(w.top),r.setWidth(w.width),r.setHeight(w.height),r._fullscreen=!0,r.iv(),X=!1)}},500)}else{var p=i.style.left,M=i.style.top,m=i.style.width,k=i.style.height,B=i.style.background,O=i.style.backgroundColor;B||O||(i.style.backgroundColor="white"),i.requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen();var I=setInterval(function(){if(i!==(A.fullscreenElement||A.mozFullScreenElement||A.webkitFullscreenElement||A.msFullscreenElement))clearInterval(I),i.style.left=p,i.style.top=M,i.style.width=m,i.style.height=k,i.style.oldBackgroundColor=O,r.iv();else{var W=s.Default.getWindowInfo();(X||W.width!==r.getWidth()||W.height!==r.getHeight())&&(Ni(r),X=!1)}},500)}}},appendTimeStamp:function(I){return I},setCompType:function($,o){ap(o)&&o.substr(0,12)==Eo&&(o=Y.parse(o)),Ln(o)||np(o)?Lb[$]=o:fn($)},getCompType:function(L){var s=Lb[L];return s===r&&Kq.test(L)&&fn(L),s},getCompTypeMap:function(){return Lb},drawCompType:function(g,u,R,$,X,D){g(u,R,$,X,D)},numberListener:function(){var b={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(v){var i=v.keyCode;b[i]||65===i&&Y.isCtrlDown(v)||86===i&&Y.isCtrlDown(v)||67===i&&Y.isCtrlDown(v)||88===i&&Y.isCtrlDown(v)||i>=35&&40>=i||(v.shiftKey||48>i||i>57)&&(96>i||i>105)&&v.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(n){var T=n.target.tagName;("DIV"===T||"CANVAS"===T)&&!(Y.ignoreKeyCodes.indexOf(n.keyCode)>=0)&&("keydown"!==n.type||Yf(n)||Ve(n)||Cc(n)||hs(n)||Zd(n)||65===n.keyCode&&(n.metaKey||n.ctrlKey))&&(n.preventDefault(),n.preventManipulation&&n.preventManipulation())},getWindowInfo:function(){var C=A.documentElement,V=C&&(C.scrollLeft||C.scrollTop)?C:A.body;return{target:V,left:V.scrollLeft,top:V.scrollTop,width:x.innerWidth||V.clientWidth,height:x.innerHeight||V.clientHeight}},isDragging:function(){return!!Nr},isLeftButton:function(m){return Rl(m)?!0:0===m.button},isMiddleButton:function(B){return Rl(B)?!1:B&&(1===B.button||4&(B.buttons||0))},isRightButton:function(i){return Rl(i)?!1:i&&(2===i.button||2&(i.buttons||0))},isInput:function(k){if(!k)return!1;var u=k.tagName;return"INPUT"===u||"TEXTAREA"===u||"SELECT"===u},getTouchCount:function(u){return Rl(u)?u.touches.length:1},isDoubleClick:function(){function D(u){u.details=0,u.timeout=null,u.lastPoint=null}var e={};return Vo=new z,Pl=Vo.getTime(),function(k){if(Sf(k)>1)return!1;var q=k.button==w?"":k.button,Q=k.type+q,P=Q+"_isDoubleClick",X=e[Q];if(X||(X=e[Q]={details:0,timeout:null,lastPoint:null}),k[P]===r){k[P]=!0;var y=$c(k);X.timeout&&(hd(X.timeout),X.timeout=null);var R=Rl(k)?Y.doubleTouchRange:Y.doubleClickRange;X.lastPoint&&qd(X.lastPoint,y)>R&&D(X),X.lastPoint=y,X.details++,X.timeout=fr(function(){D(this)}.bind(X),Y.doubleClickSpeed)}return 2===X.details}}(),isShiftDown:function(z){return z?z.shiftKey:qi["16"]},isCtrlDown:function(B){return B?Am?B.metaKey:B.ctrlKey:Am?qi["91"]:qi["17"]},getClientPoint:function(M){return Rl(M)&&(M=Ig(M)),{x:M.clientX,y:M.clientY}},isMouseEvent:function(M){return M instanceof MouseEvent||0===M.type.indexOf("mouse")},getTargetElement:function(i){var x,Z=hr(i);if(x=Y.isMouseEvent(i)||!A.elementFromPoint?i.target:A.elementFromPoint(Z.x,Z.y),qm&&A.elementFromPoint){for(var m=[],d=[];"none"===x.style.pointerEvents;)m.push(x),d.push(x.style.display||""),x.style.display="none",x=A.elementFromPoint(Z.x,Z.y);m.forEach(function(S,M){S.style.display=d[M]})}return x},getPagePoint:function(d){return Rl(d)&&(d=Ig(d)),{x:d.pageX,y:d.pageY}},createObject:function(I,o){var Y=new I;for(var T in o){var v=o[T];if(Ln(v))Y[T]=v;else if(0===T.indexOf("s:"))Y.s(T.substr(2),o[T]);else if(0===T.indexOf("a:"))Y.a(T.substr(2),o[T]);else{var U=Pm(T),v=o[T];Y[U]?(Y[U](v),"setToolTip"===U&&Y.enableToolTip&&Y.enableToolTip()):Y[T]=v}}return Y},setImage:function(D,C,h,u){var g=arguments.length;4===g?Ag(D,u,C,h):2===g?ap(C)?C.substr(0,12)==Eo?lk(D,Y.parse(C)):Ag(D,C):lk(D,C):1===g&&Ag(D,D)},getImage:function(N,H,R){var B;if(N==w)return w;if(np(N)?B=N:(B=lo[N],N&&B===r&&(Jn&&Jn[N]||Ag(N,N))),H&&B&&B.tagName){var V;V="override"===R?"colors_override":"override_rgb"===R?"colors_override_rgb":"override_a"===R?"colors_override_a":"colors",B[V]||(B[V]={__count__:0});var F=B[V][H];return F||(B[V].__count__>Y.imageCacheThreshold&&(B[V]={__count__:0}),F=Wi(B,er(H),B.width,B.height,R),B[V][H]=F,B[V].__count__++),F}return B},isImageComplete:function(n,t,z){var h=Ub(n);if(!h)return!1;if(h.tagName)return h.complete;for(var j,n,v,C=h.comps,w=!0,F=0,E=C.length;E>F;F++)if(j=C[F],v=j.type,"image"===j.type){n=j.name,n&&n.func&&(n=Pb(n,t));var B=oo(n,t,z);if(!B){w=!1;break}}else if(Kq.test(v)&&Y.getCompType(v)===r){w=!1,fn(v);break}return w},getId:function(){var q=1;return function(){return++q}}(),callLater:function(B,M,c,q){var p=function(){B.apply(M,c)};return q?fr(p,q):x.requestAnimationFrame(p)},cancelLater:function(l,j){j?hd(l):x.cancelAnimationFrame(l)},clone:function(u){if(null==u||"object"!=typeof u)return u;if(u instanceof Date){var J=new Date;return J.setTime(u.getTime()),J}if(u instanceof Array){for(var J=[],Y=0,h=u.length;h>Y;Y++)J[Y]=fq(u[Y]);return J}if(u instanceof Pk){for(var J=new Pk,Y=0,h=u.length;h>Y;Y++)J.set(Y,fq(u.get(Y)));return J}if(u instanceof Xo)return u;if(u instanceof Rb){var J=new Rb;return J.deserialize(u.serialize()),J}if(u instanceof R){var J={};for(var o in u)u.hasOwnProperty(o)&&(J[o]=fq(u[o]));return J}return u},callWhenLoaded:function(G,U){U=U||100;var E=Ce(G,U);wp||(wp={}),wp[E]={tick:E,cb:G,delay:U}},beforeLoadURL:function(b,y){if(wp){var F={};for(var y in wp){var $=wp[y];hd($.tick);var u=Ce($.cb,$.delay);F[u]={tick:u,delay:$.delay,cb:$.cb}}wp=F}return Y.convertURL?Y.convertURL(b,y):b},convertURL:function(S){return S},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return Y.getImage("default_blank")},resizeImagePOT:function(t,u){if(!t||!t.tagName)return t;var e=t.width,H=t.height;if(!e||!H)return t;if(ar.isPOT(e)&&ar.isPOT(H)&&(!u||e===H))return t;var K,w;u?w=K=ar.nearestPOT(Math.min(e,H)):(K=ar.nearestPOT(e),w=ar.nearestPOT(H));var g=de(),B=g.getContext("2d");return Vp(g,K,w,1),B.drawImage(t,0,0,e,H,0,0,K,w),g},sortFunc:function(l,S){if(l===S)return 0;if(l==w&&S!=w)return 1;if(l!=w&&S==w)return-1;if(l==w&&S==w)return 0;var c,W=typeof l,j=typeof S;return W===Bk&&j===Bk?c=l.localeCompare(S):W===Qm&&j===Qm&&(c=l-S),c===r&&(c=(""+l).localeCompare(""+S)),c>0?1:0>c?-1:0},getClassMap:function(){return mi},getClass:function(K){if(ap(K)){var r,N=mi[K];if(!N){r=K.split("."),N=x;for(var V=0;V<r.length;V++)N=N[r[V]];mi[K]=N}return N}return K},def:function(N,_,p){var v,d,Z,x=function(){};if(x.prototype=_.prototype,v=new x,ap(N)){if(mi[N])throw"'"+N+"' already defined";Z=Fr(N),v.getClassName=function(){return N}}else Z=N;if(v.constructor=Z,v.getClass=function(){return Z},v.getSuperClass=function(){return _},p)for(d in p)Jo[d]&&Jo.hasOwnProperty(d)?Jo[d](v,p):lp(v,p,d);Z.prototype=v,Z.superClass=_.prototype},startAnim:function(){var s=function(E){E.duration&&(E.startTime=wk()),E.timeId=pm(E.tick,w,w,E.interval)};return function(q){return q=fq(q),q.easing=q.easing||Y.animEasing,q.duration||q.frames||(q.duration=Y.animDuration),q.t=0,q.duration?q.interval=0:(q.frame=0,q.interval=q.interval||10),q.tick=function(){if(q.duration){var d=(wk()-q.startTime)/q.duration;if(d>1&&(d=1),q.t=d,q.action(q.easing(d),d),!q.isRunning())return;1===d?q.stop():q._isPaused||(q.timeId=pm(q.tick))}else{if(q.frame++,d=q.t=q.frame/q.frames,q.action(q.easing(d),d),!q.isRunning())return;q.frame<q.frames?q._isPaused||(q.timeId=pm(q.tick,w,w,q.interval)):q.stop()}},q.resume=function(){q._isPaused&&(delete q._isPaused,q.duration?q.t<1&&(q.startTime=wk()-q.duration*q.t,q.timeId=pm(q.tick)):q.frame<q.frames&&(q.timeId=pm(q.tick,w,w,q.interval)))},q.pause=function(){_m(q.timeId,!q.duration),q._isPaused=!0},q.isPaused=function(){return this._isPaused},q.stop=function(D){q.isRunning()&&(_m(q.timeId,!q.duration),delete q.timeId,q.duration?q.t<1&&D&&(q.t=1,q.action(q.easing(1),1)):q.frame<q.frames&&D&&(q.frame=q.frames,q.action(q.easing(1),1)),q._37o&&q._37o(),q.finishFunc&&q.finishFunc())},q.isRunning=function(){return q.timeId!=w},q.delay?pm(s,w,[q],q.delay):s(q),q}}(),getTextSize:function(){var N={},t=A?de().getContext("2d"):w;return function(L,B){t.font=L?L:iq;var z=N[t.font];return z||(z=2*t.measureText("e").width+4,N[t.font]=z),{width:t.measureText(B).width+4,height:z}}}(),drawText:function(s,g,j,k,V,Z,_,A,c,o){if(g!=w){var F=Oq(j,g),J={};J.y=o&&o!==Rk?o===rd?Z+F.height/2:Z+A-F.height/2:Z+A/2,J.x=c&&c!==vq?c===hn?V+_-F.width/2:V+_/2:V+F.width/2,Yi(s,g,J,j,k)}},getDistance:function(I,D){var p=I.length;return D?3===p?G(Yq(I[0]-D[0])+Yq(I[1]-D[1])+Yq(I[2]-D[2])):2===p?G(Yq(I[0]-D[0])+Yq(I[1]-D[1])):I.z===r?G(Yq(D.x-I.x)+Yq(D.y-I.y)):G(Yq(D.x-I.x)+Yq(D.y-I.y)+Yq(D.z-I.z)):3===p?G(Yq(I[0])+Yq(I[1])+Yq(I[2])):2===p?G(Yq(I[0])+Yq(I[1])):void 0},brighter:function(t,H){return 0>H&&(H=-H),uc(t,H?H:40)},darker:function(U,q){return q>0&&(q=-q),uc(U,q?q:-40)},unionPoint:function(z,b){if(!z)return w;if(2===arguments.length)return z&&b?{x:X(z.x,b.x),y:X(z.y,b.y),width:J(z.x-b.x),height:J(z.y-b.y)}:w;var j=z;if(j._as&&(j=j._as),j.length===r)return w;var Z=j.length;if(0>=Z)return w;for(var E=1,G=j[0],t={x:G.x,y:G.y,width:0,height:0};Z>E;E++){G=j[E];var F=X(t.x,G.x),T=i(t.x+t.width,G.x),$=X(t.y,G.y),M=i(t.y+t.height,G.y);t.x=F,t.y=$,t.width=T-F,t.height=M-$}return t},unionRect:function(b,G){if(b&&!G)return fq(b);if(!b&&G)return fq(G);if(b&&G){var H={x:X(b.x,G.x),y:X(b.y,G.y)};return H.width=i(b.x+b.width,G.x+G.width)-H.x,H.height=i(b.y+b.height,G.y+G.height)-H.y,H}return w},containsPoint:function(E,U,h,k){if(k!=w&&1!==k){var Y=E.x+E.width/2,v=E.y+E.height/2;E={x:Y-E.width/2*k,y:v-E.height/2*k,width:E.width*k,height:E.height*k}}if(h){var $=E.width/2,T=E.height/2,F=O(-h),m=f(-h),I=U.x-E.x-$,W=U.y-E.y-T;return U={x:m*I-F*W,y:F*I+m*W},Vb({x:-$,y:-T,width:E.width,height:E.height},U)}return!(!E||U.x<E.x||U.y<E.y||U.x>E.x+E.width||U.y>E.y+E.height)},containsRect:function(h,m){if(!h||!m)return!1;var t=m.x,P=m.y,K=m.width,O=m.height,z=h.width,A=h.height;if(0>(z|A|K|O))return!1;var y=h.x,U=h.y;if(y>t||U>P)return!1;if(z+=y,K+=t,t>=K){if(z>=y||K>z)return!1}else if(z>=y&&K>z)return!1;if(A+=U,O+=P,P>=O){if(A>=U||O>A)return!1}else if(A>=U&&O>A)return!1;return!0},intersectsRect:function(j,m){if(!j||!m)return!1;var q=m.width,P=m.height,R=j.width,S=j.height;if(0>=R||0>=S||0>=q||0>=P)return!1;var A=m.x,f=m.y,l=j.x,v=j.y;return R+=l,S+=v,q+=A,P+=f,R>A&&S>f&&q>l&&P>v},intersection:function(p,v){if(!p||!v)return w;var E=v.x,U=v.y,$=p.x,e=p.y,k=E,q=U,H=$,J=e;return k+=v.width,q+=v.height,H+=p.width,J+=p.height,$>E&&(E=$),e>U&&(U=e),k>H&&(k=H),q>J&&(q=J),k-=E,q-=U,0>=k||0>=q?w:{x:E,y:U,width:k,height:q}},grow:function(D,u,i){i===r&&(i=u),D.x-=u,D.y-=i,D.width=D.width+2*u,D.height=D.height+2*i},getScreenPoint:function(k,V,J,Q,t,p,E){var G=J.getBoundingClientRect(),F=k*(p||1)-J.scrollLeft+(Q||0),v=V*(E||1)-J.scrollTop+(t||0),I=xm(J,!1);if(I){var M=new Zb(F,v,0);return M.applyMatrix4(I),console.log(M),{x:M.x,y:M.y}}return{x:F+G.left,y:v+G.top}},getLogicalPoint:function($,D,b,Z,i,_){var R,M,j=D.getBoundingClientRect();$.target?(Xm($)?Am?qi["91"]=!0:qi["17"]=!0:Am?qi["91"]=!1:qi["17"]=!1,qi["16"]=bg($)?!0:!1,$=Rl($)?Ig($):$,R=$.clientX,M=$.clientY):(R=$.x,M=$.y);var l=xm(D,!0);if(l){var w=new Zb(R,M,0);w.applyMatrix4(l);do{if(Math.abs(w.z)<=1e-6)break;var Q=new Zb(R,M,1);if(Q.applyMatrix4(matrix),Math.abs(Q.z)<=1e-6){w=Q;break}if(Q.sub(w),Math.abs(Q.z)<=1e-6)break;w.addScaledVector(Q,-w.z/Q.z)}while(!1);return{x:(w.x+D.scrollLeft-(b||0))/(i||1),y:(w.y+D.scrollTop-(Z||0))/(_||1)}}return{x:(R-j.left+D.scrollLeft-(b||0))/(i||1),y:(M-j.top+D.scrollTop-(Z||0))/(_||1)}},removeHTML:function(){var W;return function($){return $&&$.getView&&($=$.getView()),$&&$.parentNode?W===$?!0:(W=$,$.parentNode.removeChild($),W=w,!0):!1}}(),getToolTipDiv:function(){if(!so){so=Zn(),Al=Zn();var G=so.style;Y.baseZIndex!=w&&(G.zIndex=Sq(Y.baseZIndex)+3+""),G.whiteSpace="nowrap",G.color=Y.toolTipLabelColor,G.background=Y.toolTipBackground,G.font=Y.toolTipLabelFont,G.padding="5px",G.boxShadow="0px 0px 3px "+Y.toolTipShadowColor}return so},isToolTipShowing:function(){return so&&so.parentNode?!0:Al&&Al.parentNode?!0:!1},updateToolTipContent:function(l,h){if(Y.isToolTipShowing()&&(l&&so.__point__&&(h=l.getToolTip(l.lp(so.__point__))),h)){var m;h.html?(h=h.html,m=Al):m=so,m.innerHTML=h}},hideToolTip:function(){zk(so),zk(Al),lg()},showToolTip:function(T,S){if(!T||S==w)return Wc(),void 0;Y.getToolTipDiv();var R,E;if(S.html?(S=S.html,R=Al,zk(so)):(R=so,zk(Al)),E=R.style,R.innerHTML=S,R.parentNode||s.Default.appendToScreen(R),T.target){T=hr(T);var J=ji(),I=T.x,W=T.y,e=re?60:12;if(re){var U=R.getBoundingClientRect();E.left=I-U.width/2+qf,E.top=W-U.height-e<J.top?W+e+qf:W-U.height-e+qf}else{E.left=I+e+qf,E.top=W+e+qf;var U=R.getBoundingClientRect();U.left+U.width>J.width&&(E.left=I-e-U.width+qf),U.top+U.height>J.height&&(E.top=W-e-U.height+qf),U.left<0&&(E.left=I+e+qf),U.top<0&&(E.top=W+e+qf)}}else E.left=T.x+qf,E.top=T.y+qf;so.__point__=T,lg()},startDragging:function(o,a,t){t==r&&(t=!0),o!==Nr&&(Nr?t&&(Rl(a)?Nr.handleWindowTouchEnd(a):Nr.handleWindowMouseUp(a)):Rl(a)?(B(x,fe,Pc),B(x,_g,Hr)):(B(x,Vj,lj),B(x,lh,ym)),Nr=o)
},getImageMap:function(){return lo},toBoundaries:function(Q,R,r,Z){var m=[];return Fi(Q,R,r,Z).forEach(function(K){var k=[];K.forEach(function(i){k.push(i.x,i.y)}),m.push(k)}),m},getCurrentKeyCodeMap:function(){return qi},drawCenterImage:function(k,X,g,S,y,b,v,B){!y&&b&&b.isSelfViewEvent&&(y=b);var z=To(X,y,b),a=md(X,y,b);El(k,X,N(g-z/2),N(S-a/2),z,a,y,b,v,B)},drawStretchImage:function(p,o,c,s,_,h,b,j,g,Q,L,w){!j&&g&&g.isSelfViewEvent&&(j=g);var i,W=To(o,j,g,h),u=md(o,j,g,b);"uniform"===c?(i=X(h/W,b/u),W*=i,u*=i,s+=N((h-W)/2),_+=N((b-u)/2),h=W,b=u):"centerUniform"===c&&((W>h||u>b)&&(i=X(h/W,b/u),W*=i,u*=i),s+=N((h-W)/2),_+=N((b-u)/2),h=W,b=u);var x=p.interactiveInfo;if(x){var q;if(q="center"===c?{x:s+h/2-W/2,y:_+b/2-u/2,width:W,height:u}:{x:s,y:_,width:h,height:b},x.rect){var Z=x.compInfos,y=Z.length;y&&(Z[y-1].rect.image=o)}else x.rect=q}if("center"===c){var J=L!==!1&&(W>h||u>b);J&&(p.save(),p.beginPath(),p.rect(s,_,h,b),p.clip()),El(p,o,s+h/2-W/2,_+b/2-u/2,W,u,j,g,Q,w),J&&p.restore()}else El(p,o,s,_,h,b,j,g,Q,w)},toCanvas:function(d,I,U,j,H,B,C,h,$){d=Ub(d,C),I=I||To(d,H),U=U||md(d,H);var f=de(),p=_d(f);return h?(Vp(f,I,U,h),p.scale(h,h)):Vp(f,I,U,1),Pr(p,d,j,0,0,I,U,H,B,C,$),d&&d.clampToEdge&&(f.clampToEdge=d.clampToEdge),p.restore(),f},toGrayColor:function(q){if(!q)return q;var J=Dl(q),l=N(.299*J[0]+.587*J[1]+.114*J[2]);return"rgba("+l+","+l+","+l+","+J[3]/255+")"},createGradientImage:function(G,S,r,Q){for(var t=["L",0,0,G,0,1,0,0,1,0,0],X=0,U=Math.min(S.length,r.length);U>X;X++)t.push(r[X],S[X]);var e=s.Default.toCanvas({width:G,height:G,clampToEdge:!0,comps:[{type:"shape",rotation:Q||0,points:[0,0,G,0,G,G,0,G],background:"#ffffff",gradientPack:t}]});return e},createElement:function(R,Q,t,o){var M=A.createElement(R);return _h(M,Q||e.widgetBorder,2),M.style.font=t?t:iq,o!=w&&(M.value=o),Y.onElementCreated&&Y.onElementCreated(M),M},containedInView:function(U,u){var G=Ie(u).getBoundingClientRect();return Vb({x:G.left,y:G.top,width:G.width,height:G.height},$c(U))},isIsolating:function(){return Gj>0},setIsolating:function(W){W?Gj++:Gj--},getMSMap:function(){return Jo},stringify:function(I,A,l){var R=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var $=Rb.prototype.toJSON;Rb.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},A=l?0:A==w?2:A;var J=JSON.stringify(I,function(c,C){return"function"==typeof C?"__ht__"+(C.__ht__||C.toString()):wn(C)?Fo(C):C instanceof s.List?"__ht__list"+(C.__ht__list||Y.stringify(C._as)):C},A);return Date.prototype.toJSON=R,Rb.prototype.toJSON=$,l&&(J=Eo+dm(J)),J},parse:function(l,z){return ap(l)?l.substr(0,12)!=Eo||(l=Cq(l.substr(12)),ap(l))?(z=z||{},JSON.parse(l,function(Q,d){if(ap(d))if(z.ignoreFunction||"__ht__function"!=d.substr(0,14)){if(!z.ignoreDate&&"__ht__date"==d.substr(0,10))return new Date(Sq(d.substr(10)));if("__ht__list"===d.substr(0,10))return new Pk(Y.parse(d.substr(10)));if(!z.ignoreDataModel&&"__ht__dataModel"===d.substr(0,15)){var o=new Rb;return o.deserialize(Y.parse(d.substr(15))),o}}else{var J=d.indexOf("{")+1,g=d.lastIndexOf("}"),H=d.indexOf("(")+1,C=d.indexOf(")");if(J&&g&&H&&C)try{var i=new Function(d.substring(H,C),d.substring(J,g));return i.__ht__=d.substr(6),i}catch(V){throw console.info("=== SyntaxError ===\n",d),V}}return d})):l:l},loadJS:function(L,f){f&&L.push(f);var S=L.shift();if(wd(S))L=S.contact(L),Y.loadJS(L);else if(Ln(S))S(),Y.loadJS(L);else if(ap(S)){var R=A.createElement("script");R.onload=function(){Y.loadJS(L)},R.setAttribute("src",S),A.getElementsByTagName("head")[0].appendChild(R)}else L.length&&Y.loadJS(L)},extendClass:function(a,Q){var Y=a.prototype;for(var h in Q)Jo[h]&&Jo.hasOwnProperty(h)?Jo[h](Y,Q):Y[h]=Q[h]},toRoundedCorner:function(){function e(K,y,A){K.x=y.x,K.y=y.e||A,K.z=y.y}var P=new Zb,q=new Zb,g=new Zb,W=new Zb;return function(w,M){var f,C=0;w.getPoints&&(C=w.getElevation(),w=w.getPoints()),f=w instanceof Pk?w:new Pk(w);var D=f.size();if(0>=M)return{points:f};var V=new Pk,n=new Pk,b=f.get(0);e(P,b,C),V.add(b),n.add(1);for(var t=1;D>t;t++)if(D>t+1){var T=f.get(t),o=f.get(t+1);e(q,T,C),e(g,o,C),W.subVectors(P,q).setLength(Math.min(.99*W.length(),M)).add(q),T.e!==r||b.e!==r?V.add({x:W.x,y:W.z,e:W.y}):V.add({x:W.x,y:W.z}),V.add(T),W.subVectors(g,q).setLength(Math.min(.99*W.length(),M)).add(q),T.e!==r||o.e!==r?V.add(b={x:W.x,y:W.z,e:W.y}):V.add(b={x:W.x,y:W.z}),P.copy(W),n.addAll([2,3])}else V.add(f.get(t)),n.add(2);return{points:V,segments:n}}}(),toColorData:Dl,setCanvas:Vp,createDiv:Zn,createDisabledDiv:ik,createView:xf,createCanvas:de,appendChild:Ld,initContext:_d,checkLoadingImage:Yr,translateAndScale:Kh,layout:Ni,getPosition:Cm,drawPoints:bb,drawRoundRect:ij,drawBorder:$d,setFocus:hj,getter:dq,setter:Pm,isEmptyObject:Ae,cameraPriority:function(){var M={skybox:0,main:1e4,top:1e7,infinity:1/0};return R.seal(R.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return M.skybox},set:function(I){if(I>=M.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");M.skybox=Number(I)}},main:{configurable:!1,enumerable:!1,get:function(){return M.main},set:function(B){if(B<=M.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(B>=M.top)throw new RangeError("Main camera must have lower priority than the top camera.");M.main=Number(B)}},top:{configurable:!1,enumerable:!1,get:function(){return M.top},set:function(U){if(U<=M.main)throw new RangeError("Top camera must have higher priority than the main camera.");M.top=Number(U)}}}))}()},!0),xl(_,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var km=Y.disabledOpacity,xq=Y.toolTipDelay,Co=Y.devicePixelRatio,im=Y.autoMakeVisible,ck=Y.autoHideScrollBar,Rg=Y.imageGradient,eq=Y.showToolTip,Wc=Y.hideToolTip,rk=Y.dashPattern,zn=Y.lineCap,nf=Y.lineJoin,Cr=Y.labelColor,mf=Y.labelSelectColor,iq=Y.labelFont,fh=Y.widgetIndent,nm=Y.widgetRowHeight,fk=Y.widgetHeaderHeight,he=Y.widgetTitleHeight,Lc=Y.scrollBarColor,qn=Y.scrollBarSize,Lp=Y.scrollBarTimeout,ph=Y.scrollBarMinLength,fl=Y.scrollBarInteractiveSize,bn=Y.zoomIncrement,On=Y.scrollZoomIncrement,xs=Y.pinchZoomIncrement,jo=Y.zoomMax,lb=Y.zoomMin,Hb=Y.createObject,mc=Y.preventDefault,We=Y.setImage,Ub=Y.getImage,oo=Y.isImageComplete,Pn=Y.drawCenterImage,Pr=Y.drawStretchImage,Nb=Y.getId,pm=Y.callLater,_m=Y.cancelLater,Ui=Y.sortFunc,fq=Y.clone,Fr=Y.getClass,cj=Y.startAnim,tn=Y.brighter,hf=Y.darker,Uq=Y.drawText,Oq=Y.getTextSize,yf=Y.isLeftButton,Tf=Y.isMiddleButton,nr=Y.isRightButton,Sf=Y.getTouchCount,Ir=Y.isDoubleClick,bg=Y.isShiftDown,Xm=Y.isCtrlDown,$c=Y.getClientPoint,hr=Y.getPagePoint,qd=Y.getDistance,ln=Y.unionPoint,_f=Y.unionRect,Vb=Y.containsPoint,jr=Y.containsRect,Uh=Y.intersectsRect,Xk=Y.intersection,ji=Y.getWindowInfo,xg=Y.grow,bc=Y.getLogicalPoint,De=Y.getScreenPoint,Ah=Y.startDragging,zk=Y.removeHTML,tr=Y.createElement,yl=Y.segmentResolution,ei=Y.shapeResolution,Ii=Y.shapeSide,Ap=Y.def,Je=function(w,S,Y){Ap(D+"."+w,S,Y)},Hf=function(D,m){D.childNodes.forEach(function(d){m(d),Hf(d,m)})};xl(Y,{toolTipLabelColor:Cr,toolTipLabelFont:iq,toolTipBackground:e.toolTipBackground,toolTipShadowColor:Up,debugTipLabelFont:iq,debugTipLabelColor:Cr,debugTipBackground:e.toolTipBackground,drawBreakableText:tq,setDevicePixelRatio:function(N){Co=Y.devicePixelRatio="number"==typeof N?N:x.screen?x.screen.deviceXDPI/x.screen.logicalXDPI:1,Hf(A.body,function(f){var E=f._ht;E&&E._canvas&&(Vp(E._canvas,E.getWidth(),E.getHeight()),E.redraw?E.redraw():E.iv())})}},!0);var Hp=1e-6,jj="undefined"!=typeof Uint16Array?Uint16Array:Array,vg="undefined"!=typeof Float32Array?Float32Array:Array,Wn=function(e,N,v){var w=[e[0]-N[0],e[1]-N[1],e[2]-N[2]];if(v){var D=qd(w);D>0&&(w[0]/=D,w[1]/=D,w[2]/=D)}return w},oj=function(){var I="charCodeAt",p=2*(2*$b.length+1);for(var e in x)if(e===D+vq[0]+(qf.length+2)){var M=x[e];if(!M)break;for(var V=M.length,u=0;V>u;u++)if(M[u][I](0)===p&&M[u+1]!=w&&M[u+1]===qf[0]&&M[u+2]!=w&&M[u+2][I](0)===p){for(var n=u+3;V>n;n++)if(M[n][I](0)===p){if(0==M[n+1])for(var B,v=n+2;V>v;v++){if(M[v][I](0)===p){0==M[v-1]&&B&&(ql=B.substr(0,B.length-1));break}B==w?B=M[v]:B+=M[v]}break}break}break}return function(C){return[-C[0],-C[1],-C[2]]}}(),mj=function(_,O){return 3===_.length?_[0]*O[0]+_[1]*O[1]+_[2]*O[2]:_[0]*O[0]+_[1]*O[1]},Vd=function(){var M=new Array(16);return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M},Sp=Vd(),Zo=function(T){var q=new Array(16);return q[0]=T[0],q[1]=T[1],q[2]=T[2],q[3]=T[3],q[4]=T[4],q[5]=T[5],q[6]=T[6],q[7]=T[7],q[8]=T[8],q[9]=T[9],q[10]=T[10],q[11]=T[11],q[12]=T[12],q[13]=T[13],q[14]=T[14],q[15]=T[15],q},No=function(j,K){return j[0]=K[0],j[1]=K[1],j[2]=K[2],j[3]=K[3],j[4]=K[4],j[5]=K[5],j[6]=K[6],j[7]=K[7],j[8]=K[8],j[9]=K[9],j[10]=K[10],j[11]=K[11],j[12]=K[12],j[13]=K[13],j[14]=K[14],j[15]=K[15],j},Sh=function(J){return J[0]=1,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=1,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=1,J[11]=0,J[12]=0,J[13]=0,J[14]=0,J[15]=1,J},yb=function(Z,F){var O=Z[0],s=Z[1],h=Z[2];return Z[0]=F[0]*O+F[4]*s+F[8]*h+F[12],Z[1]=F[1]*O+F[5]*s+F[9]*h+F[13],Z[2]=F[2]*O+F[6]*s+F[10]*h+F[14],Z},Fq=function(m,t){var s=m[0],W=m[1],v=m[2],H=m[3];return m[0]=t[0]*s+t[4]*W+t[8]*v+t[12]*H,m[1]=t[1]*s+t[5]*W+t[9]*v+t[13]*H,m[2]=t[2]*s+t[6]*W+t[10]*v+t[14]*H,m[3]=t[3]*s+t[7]*W+t[11]*v+t[15]*H,m},an=function(){var M,j,Z,D,U=Bl(ol[1]+ol[7]),l=Bl(ol[0]+ol[3]-ol[10]),a=Bl(ol[8]+2),k=function(){return j=Z.charAt(M),M+=1,j},e=function(){var D="";if(j===a)for(;k();){if(j===a)return k(),D;D+=j}else k()},I=function(){for(;j&&" ">=j;)k()},N=function(){var O,N={};if(j===U){if(k(),I(),j===l)return k(),N;for(;j;){if(O=e(),I(),k(),N[O]=D(),I(),j===l)return k(),N;k(),I()}}};return D=function(){switch(I(),j){case U:return N();default:return e()}},function(Y){if(H={},Y){var Q;if(Z=Y,M=0,j=" ",Q=D(),I(),!j)return Q}}}(),vi=function(e,y){if(y){var $=O(y),p=f(y),d=e[4],m=e[5],K=e[6],C=e[7],g=e[8],s=e[9],V=e[10],c=e[11];e[4]=d*p+g*$,e[5]=m*p+s*$,e[6]=K*p+V*$,e[7]=C*p+c*$,e[8]=g*p-d*$,e[9]=s*p-m*$,e[10]=V*p-K*$,e[11]=c*p-C*$}},dl=function(t,i){if(i){var T=O(i),m=f(i),A=t[0],D=t[1],L=t[2],x=t[3],G=t[8],k=t[9],N=t[10],u=t[11];t[0]=A*m-G*T,t[1]=D*m-k*T,t[2]=L*m-N*T,t[3]=x*m-u*T,t[8]=A*T+G*m,t[9]=D*T+k*m,t[10]=L*T+N*m,t[11]=x*T+u*m}},Yb=function(b,m){if(m){var I=O(m),i=f(m),x=b[0],z=b[1],h=b[2],U=b[3],q=b[4],R=b[5],T=b[6],Q=b[7];b[0]=x*i+q*I,b[1]=z*i+R*I,b[2]=h*i+T*I,b[3]=U*i+Q*I,b[4]=q*i-x*I,b[5]=R*i-z*I,b[6]=T*i-h*I,b[7]=Q*i-U*I}},ub=function($,q,v){return cq(w,v===!1?w:$.getFinalScale3d(),$.getFinalRotation3d(),$.getRotationMode(),$.p3(),w,q)},cq=function(p,n,W,U,Z,C,V){return C||(C=Vd()),Z&&ze(C,Z),Ye(C,W,U),V&&Kc(C,C,V),n&&Ff(C,n),p&&Kc(C,C,p),C},Td=function(b,L,F){L=Sq(L),F=Sq(F);var m=this;m.g=b,m._84O=L,m._85O=F,m._70I=!0,m.F=0,m._83O=L+F,m.pen={x:0,y:0}},ms="lineDashOffset",rm="setLineDash",um=function(M){for(var W in M)1===W.length&&(ms=M[W]);return W?1:0},ee=function(Y,x,T){return Nf(x)?Y:Y[rm]?(Y[rm](x),T&&(Y.lineDashOffset=T),Y):new Td(Y,x[0],x.length>1?x[1]:x[0])},zp=function(d,s){!Nf(s)&&d[rm]&&(d[rm]($f),d.lineDashOffset=0)};if(Ap(Td,R,{_69I:6,moveTo:function(L,f){var w=this,V=w.pen;V.x=L,V.y=f,w.g.moveTo(L,f),w.start||(w.start={x:L,y:f})},lineTo:function(d,W){var Q=this,I=Q.pen,A=d-I.x,$=W-I.y,X=K($,A),c=f(X),x=O(X),v=Q._23O(I.x,I.y,d,W),y=Q._85O,D=Q._84O,M=Q._83O;if(Q.F){if(Q.F>v)return Q._70I?Q._72I(d,W):Q.moveTo(d,W),Q.F-=v,void 0;if(Q._70I?Q._72I(I.x+c*Q.F,I.y+x*Q.F):Q.moveTo(I.x+c*Q.F,I.y+x*Q.F),v-=Q.F,Q.F=0,Q._70I=!Q._70I,!v)return}var m=C(v/M);if(m){for(var H=c*D,t=x*D,i=c*y,Z=x*y,G=0;m>G;G++)Q._70I?(Q._72I(I.x+H,I.y+t),Q.moveTo(I.x+i,I.y+Z)):(Q.moveTo(I.x+i,I.y+Z),Q._72I(I.x+H,I.y+t));v-=M*m}Q._70I?v>D?(Q._72I(I.x+c*D,I.y+x*D),Q.moveTo(d,W),Q.F=y-(v-D),Q._70I=!1):(Q._72I(d,W),v===D?(Q.F=0,Q._70I=!Q._70I):(Q.F=D-v,Q.moveTo(d,W))):v>y?(Q.moveTo(I.x+c*y,I.y+x*y),Q._72I(d,W),Q.F=D-(v-y),Q._70I=!0):(Q.moveTo(d,W),v===y?(Q.F=0,Q._70I=!Q._70I):Q.F=y-v)},quadraticCurveTo:function(Z,S,F,c){var m,o=this,_=o.pen,Q=_.x,z=_.y,Y=o._22O(Q,z,Z,S,F,c),i=0,u=0,d=o._85O,R=o._84O;if(o.F){if(o.F>Y)return o._70I?o._71I(Z,S,F,c):o.moveTo(F,c),o.F-=Y,void 0;if(i=o.F/Y,m=o._20O(Q,z,Z,S,F,c,i),o._70I?o._71I(m[2],m[3],m[4],m[5]):o.moveTo(m[4],m[5]),o.F=0,o._70I=!o._70I,!Y)return}var g=Y-Y*i,b=C(g/o._83O),D=R/Y,k=d/Y;if(b)for(var V=0;b>V;V++)o._70I?(u=i+D,m=o._21O(Q,z,Z,S,F,c,i,u),o._71I(m[2],m[3],m[4],m[5]),i=u,u=i+k,m=o._21O(Q,z,Z,S,F,c,i,u),o.moveTo(m[4],m[5])):(u=i+k,m=o._21O(Q,z,Z,S,F,c,i,u),o.moveTo(m[4],m[5]),i=u,u=i+D,m=o._21O(Q,z,Z,S,F,c,i,u),o._71I(m[2],m[3],m[4],m[5])),i=u;g=Y-Y*i,o._70I?g>R?(u=i+D,m=o._21O(Q,z,Z,S,F,c,i,u),o._71I(m[2],m[3],m[4],m[5]),o.moveTo(F,c),o.F=d-(g-R),o._70I=!1):(m=o._19O(Q,z,Z,S,F,c,i),o._71I(m[2],m[3],m[4],m[5]),Y===R?(o.F=0,o._70I=!o._70I):(o.F=R-g,o.moveTo(F,c))):g>d?(u=i+k,m=o._21O(Q,z,Z,S,F,c,i,u),o.moveTo(m[4],m[5]),m=o._19O(Q,z,Z,S,F,c,u),o._71I(m[2],m[3],m[4],m[5]),o.F=R-(g-d),o._70I=!0):(o.moveTo(F,c),g===d?(o.F=0,o._70I=!o._70I):o.F=d-g)},bezierCurveTo:function(){var l=arguments;this.pen={x:l[4],y:l[5]},this.g.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5])},arc:function(_,m,e,c,E,i){i||(c=-c,E=-E),Oj(this,_,m,c,E-c,e,e,!1)},rect:function(j,Y,X,H){var B=this;B.pen={x:j,y:Y},B.moveTo(j,Y),B.lineTo(j,Y+H),B.lineTo(j+X,Y+H),B.lineTo(j+X,Y),B.lineTo(j,Y)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(F,q,I,o){var p=I-F,v=o-q;return G(p*p+v*v)},_22O:function(z,f,Z,w,u,o,s){for(var j,c,n,K,_,e,r,y=0,O=z,G=f,E=s>0?s:this._69I,P=1;E>=P;P++)n=P/E,K=1-n,_=K*K,e=2*n*K,r=n*n,j=_*z+e*Z+r*u,c=_*f+e*w+r*o,y+=this._23O(O,G,j,c),O=j,G=c;return y},_21O:function(m,Q,J,K,B,C,G,q){var i=this;if(0===G)return i._20O(m,Q,J,K,B,C,q);if(1===q)return i._19O(m,Q,J,K,B,C,G);var s=i._20O(m,Q,J,K,B,C,q);return s.push(G/q),i._19O.apply(i,s)},_20O:function(c,P,A,e,G,T,p){if(1!==p){var j=A+(G-A)*p,t=e+(T-e)*p;A=c+(A-c)*p,e=P+(e-P)*p,G=A+(j-A)*p,T=e+(t-e)*p}return[c,P,A,e,G,T]},_19O:function(W,V,v,H,w,L,U){if(1!==U){var j=W+(v-W)*U,B=V+(H-V)*U;v+=(w-v)*U,H+=(L-H)*U,W=j+(v-j)*U,V=B+(H-B)*U}return[W,V,v,H,w,L]},_72I:function(n,z){var K=this.pen;(n!==K.x||z!==K.y)&&(K.x=n,K.y=z,this.g.lineTo(n,z))},_71I:function(x,m,S,M){var v=this.pen;(x!==S||m!==M||S!==v.x||M!==v.y)&&(v.x=S,v.y=M,this.g.quadraticCurveTo(x,m,S,M))}}),a&&zh){var br=zh.toString();Dq=br.indexOf($h.substr(0,2))>0&&br.indexOf(rd+rd.substr(1,1))>1||br.indexOf(zm.substr(0,2)+$h.substr(2,2)+vq[0]+$h[4])>1?!0:!1}var Mf=w,yd=w,Tm=Y.checkLoadingCompType=function(L){Mf&&!L._72O&&(yd||(yd={}),yd[L._72O=Nb()]=L)},fn=function(t,C){if(C||(C=t),C&&(Mf||(Mf={}),!Mf[t])){var D=new cd;if(Mf[C]={request:D,url:C},C=Y.beforeLoadURL(C,t),C.data){var $=Y.parse(C.data);no(t,$),Y.handleCompTypeLoaded(t,$)}else{D.onload=function(){if(200===this.status||0===this.status){var y=Y.parse(D.getResponseText());no(t,y),Y.handleCompTypeLoaded(t,y)}else no(t,w)},D.onerror=function(){no(t,w)};var v={};v.url=encodeURI(C),v.sync=!1,D.send(v)}}},no=function(l,I){if(Lb[l]=I,delete Mf[l],Ae(Mf)&&(Mf=w,yd)){for(var $ in yd){var E=yd[$];E.invalidateAll&&E.invalidateAll(r,"compTypeLoaded",l),E.redraw&&E.redraw(),E.iv(),delete E._72O}yd=w}if(I&&yd)for(var $ in yd){var E=yd[$];E.invalidateAll&&E.invalidateAll(r,"compTypeLoading",l),E.redraw&&E.redraw(),E.iv()}},pg=e.chart,Mi="",Tr=!0,Gc=Y.compStack=[],Lg=/^style@/,Ed=/^attr@/,Xg=/^field@/,Ll={x:.5,y:.5},Wr=function(){Tr=!0},di=function(){return Tr},To=function(o,d,x,E){if(!o)return 0;if(Pb(o.fitSize,d,x)&&E)return E;var U=Pb(o.width,d,x);return null==U?20:U},md=function(d,D,r,J){if(!d)return 0;if(Pb(d.fitSize,D,r)&&J)return J;var g=Pb(d.height,D,r);return null==g?20:g},Pb=function(x,C,k){if(!x||!x.func)return x;var j,F=x.func,Q=x.value;return j=Ln(F)?k&&k.vectorDataBindingDisabled&&!x.isSafeFunc?Q:F(C,k):C instanceof Xo||(s.ui?C instanceof s.ui.View:0)?Ed.test(F)?C.a(Mi+F.slice(5)):Lg.test(F)?C.s(Mi+F.slice(6)):Xg.test(F)?C[F.slice(6)]:C[F]?C[F](k):Q:Q,Q!==r&&j==w?Q:j},El=Y.drawImage=function(){var d,e,C,o,z,y,V=3,P=6,N=function(y){var r,L,c,m=!1;return U(y,"shadow")&&(r=U(y,"shadowOffsetX")||V,L=U(y,"shadowOffsetY")||V,c=U(y,"shadowBlur")||P,m=!0),!m&&e instanceof Xo&&((Qf(e,zc,"shadow")||"shadow"===Qf(e,zc,"select.type")&&C&&C.isSelected&&C.isSelected(e))&&(r=Qf(e,zc,"shadow.offset.x")||0,L=Qf(e,zc,"shadow.offset.y")||0,c=Qf(e,zc,"shadow.blur")||0,m=!0),!m&&Qf(e,zc,"shadow2")&&(r=Qf(e,zc,"shadow2.offset.x")||0,L=Qf(e,zc,"shadow2.offset.y")||0,c=Qf(e,zc,"shadow2.blur")||0,m=!0)),m?1.5*c+Math.max(r,L):0},Z=function(A,w){A.getValue&&A.getValue.compType===w||(A.getValue=function(C){var j=U(A,C);if(j===r&&w.properties){var T=w.properties[C];T&&(j=T.defaultValue)}return j},A.getColor=function(L,H){return H===!0?v(L):v(A.getValue(L))},A.getValue.compType=w)},U=function(u,_,q){var j,W=!1;if(u.prefix&&e instanceof Xo){var I=e.a(Mi+_);I!==r&&(W=!0,j=I)}return j===r&&(j=u[_]),j&&j.func&&(W=!0,j=Pb(j,e,C)),q&&(j=q(j),W||(u[_]=j)),j},v=function(k,n){var s;return s=n?U(k,n):k,d&&d.compGray&&s?Y.toGrayColor(s):z&&s?Di(s,z,y):s},K=function(K){if(wd(K)){for(var R=new Pk,o=K.length,I=0;o>I;I+=2)R.add({x:K[I],y:K[I+1]});K=R}return K},E=function(K){var g=U(K,"anchorX"),x=U(K,"anchorY");if(g!==r||x!==r)return{x:g===r?Ll.x:g,y:x===r?Ll.y:x};var y=U(K,"type"),F=U(K,"name");if("image"!==y||!F)return Ll;var h=Ub(F);return h&&h.anchorX!==r&&h.anchorY!==r?{x:h.anchorX,y:h.anchorY}:Ll},S=function(b,n){var F=U(b,ki),w=E(b);if(wd(F)){var l=F.length,x=U(b,"relative"),r=n.width,J=n.height;if(4===l)F={x:F[0],y:F[1],width:F[2],height:F[3]},x&&(F.x*=r,F.y*=J,F.width*=r,F.height*=J);else if(3===l){var t=F[0];F={width:F[1],height:F[2]},x&&(F.width*=r,F.height*=J),"object"==typeof t?t.length&&(t={x:t[0],y:t[1]}):t=Cm(t,n,F),F.x=t.x-F.width*w.x,F.y=t.y-F.height*w.y}F.x+=U(b,"offsetX")||0,F.y+=U(b,"offsetY")||0,!x&&n.fitSize&&(F=$(b,F,n))}return F},$=function($,f,l){if(f){var M,R,y,m={x:f.x,y:f.y,width:f.width,height:f.height},s=E($),N=U($,"layoutH"),T=U($,"layoutV"),c=1,D=1,X=0,L=0,j=1,v=1;switch(N){case"left":break;case"right":m.x+=l.width-l.rw;break;case"center":m.x+=.5*(l.width-l.rw);break;case"scale":case"leftright":default:M=U($,Pj)||0,M&&(X=Math.abs(L=Math.sin(M)),j=Math.abs(v=Math.cos(M))),"leftright"!==N?(c+=j*(l.widthScale-1),D+=X*(l.widthScale-1)):(c+=m.width?j*(l.width-l.rw)/m.width:0,D+=m.height?X*(l.width-l.rw)/m.height:0,R=-Math.min(-s.x*v+s.y*L,-s.x*v-(1-s.y)*L,(1-s.x)*v+s.y*L,(1-s.x)*v-(1-s.y)*L))}switch(T){case"top":break;case"bottom":m.y+=l.height-l.rh;break;case"center":m.y+=.5*(l.height-l.rh);break;case"scale":case"topbottom":default:M==w&&(M=U($,Pj),M&&(X=Math.abs(L=Math.sin(M)),j=Math.abs(v=Math.cos(M)))),"topbottom"!==T?(c+=X*(l.heightScale-1),D+=j*(l.heightScale-1)):(c+=m.width?X*(l.height-l.rh)/m.width:0,D+=m.height?j*(l.height-l.rh)/m.height:0,y=-Math.min(-s.x*L-s.y*v,-s.x*L+(1-s.y)*v,(1-s.x)*L-s.y*v,(1-s.x)*L+(1-s.y)*v))}return(1!==c||1!==D)&&("scale"!==N&&N?"leftright"===N&&(m.x+=m.width*(1-c)*s.x+R*(l.width-l.rw)):m.x+=m.x*(l.widthScale-1)+s.x*m.width*(l.widthScale-c),"scale"!==T&&T?"topbottom"===T&&(m.y+=m.height*(1-D)*s.y+y*(l.height-l.rh)):m.y+=m.y*(l.heightScale-1)+s.y*m.height*(l.heightScale-D),m.width*=c,m.height*=D),m.width<0&&(m.width=0),m.height<0&&(m.height=0),m}},A=function(m){return wd(m)?new Pk(m):m},B=function(D,l,F,Q,M,I,x){var A=d.interactiveInfo,t=D.transform;if(t)return d.save(),d.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty),A&&A.compInfos.push({comp:D,rect:l,matrix:t.clone(),prefix:Mi,refRect:A.refRect}),!0;M===r&&(M=1),I===r&&(I=1);var W=U(D,"clipPercentage"),R=uo(F,l);if(R&&!Q&&1===M&&1===I&&!(1>W))return A&&A.compInfos.push({comp:D,rect:l,matrix:A.matrix.clone(),prefix:Mi,refRect:A.refRect}),!1;x=x||Ll;var w=l.x+l.width*x.x,P=l.y+l.height*x.y,h=F.x+F.width*x.x,E=F.y+F.height*x.y,k=F.width?M*(l.width/F.width):1,j=F.height?I*(l.height/F.height):1;if(d.save(),A&&(A.matrix.appendTranslate(w,P).appendRotate(Q).appendScale(k,j).appendTranslate(-h,-E),A.compInfos.push({comp:D,rect:l,matrix:A.matrix.clone(),prefix:Mi,refRect:A.refRect})),Hn(d,w,P),An(d,Q||0),lq(d,k,j),Hn(d,-h,-E),1>W){0>W&&(W=0);var C=Gg(F,U(D,"clipDirection"),W,N(D));d.beginPath(),d.rect(C.x,C.y,C.width,C.height),d.clip()}return!0},M=function(){d.restore()},m=function(h,p,I){var j=U(h,"path"),P=U(h,Pj),z=U(h,"scaleX"),O=U(h,"scaleY"),e=E(h),X=w,n=Wb(null,j);if(I||(I=h.unionRect,I||(I=ln(n),h.path.func||(h.unionRect=I)),X=I),I){X||(X=h.unionRect,X||(X=ln(n),h.path.func||(h.unionRect=X)));var G=B(h,I,X,P,z,O,e),N=U(h,"borderPattern"),K=ee(d,N),Q=v(h,"background"),L=v(h,"borderColor"),t=U(h,"borderWidth"),Y=U(h,"gradient"),r=v(h,"gradientColor"),S=U(h,"border3d"),m=v(h,"border3dColor"),g=U(h,"border3dAccuracy"),q=d.lineJoin,c=d.lineCap;d.lineJoin=U(h,"borderJoin")||nf,d.lineCap=U(h,"borderCap")||zn,Q?(jq(d,Q,Y,r,X),Wb(d,j),d.fill(),K!==d&&Wb(d,j)):Wb(d,j);var s=U(h,"borderWidthAbsolute");if(s&&(d.save(),d.setTransform(1,0,0,1,0,0)),t&&L&&(d.lineWidth=t,d.strokeStyle=L,d.stroke(),S&&Sn(d,L,m,t,o,g)),zp(d,N),U(h,"dash")){var A=U(h,"dashWidth")||t;if(A>0){N=U(h,"dashPattern")||rk;var K=ee(d,N,U(h,"dashOffset")),b=v(h,"dashColor")||v(Xh);K!==d&&Wb(d,j),d.strokeStyle=b,d.lineWidth=A,d.stroke(),U(h,"dash3d")&&Sn(d,b,v(h,"dash3dColor"),A,o,U(h,"dash3dAccuracy")),zp(d,N)}}s&&d.restore(),p===ki&&zf(d,Q,U(h,"depth"),X),d.lineJoin=q,d.lineCap=c,G&&M()}},L=function(i,H,p,r){var k=U(i,Tp,K),X=U(i,Pj),Z=E(i);if(k&&r.fitSize){var n=new Pk,l=ln(k),L=$(i,l,r),I=l.x+Z.x*l.width,h=l.y+Z.y*l.height,t=L.x+Z.x*L.width,b=L.y+Z.y*L.height,u=l.width?L.width/l.width:1,Y=l.height?L.height/l.height:1;k.each(function(s){n.add({x:t+(s.x-I)*u,y:b+(s.y-h)*Y})}),k=n,i.unionRect=null}var m=U(i,"scaleX"),s=U(i,"scaleY"),g=H===ii,f=w;if(!p&&g&&(p=i.unionRect,p||(p=ln(k),i.points.func||(i.unionRect=p)),f=p),p){g?f||(f=i.unionRect,f||(f=ln(k),i.points.func||(i.unionRect=f))):f=p;var c,R,G,Q,O=B(i,p,f,X,m,s,Z),V=U(i,"borderPattern"),j=ee(d,V),x=v(i,"background"),F=Ub(U(i,"repeatImage"),z,y),P=U(i,"gradientPack"),S=v(i,"borderColor"),T=U(i,"borderWidth"),J=Ub(U(i,"borderRepeatImage"),z,y),D=U(i,"segments",A),a=U(i,"gradient"),W=v(i,"gradientColor"),q=U(i,"border3d"),_=v(i,"border3dColor"),uc=U(i,"border3dAccuracy"),Zq=U(i,"closePath"),Oc=U(i,"fillRule")||"nonzero",Gc=d.lineJoin,hc=d.lineCap,wd=N(i);if(d.lineJoin=U(i,"borderJoin")||nf,d.lineCap=U(i,"borderCap")||zn,g)if(x||F||P){var hd=U(i,"fillClipPercentage");if(1>hd){0>hd&&(hd=0);var an=Gg(f,U(i,"fillClipDirection"),hd,wd);d.save(),d.beginPath(),d.rect(an.x,an.y,an.width,an.height),d.clip()}bb(d,k,D,Zq),P?io(d,P,v):F?Yk(d,F,z,y,e,C):jq(d,x,a,W,f),d.fill(Oc),P&&d.restore(),1>hd&&d.restore(),j!==d&&bb(j,k,D,Zq)}else bb(j,k,D,Zq);else if("roundRect"===H?c=U(i,"cornerRadius"):"polygon"===H?c=U(i,"polygonSide"):"arc"===H&&(c=U(i,"arcFrom"),R=U(i,"arcTo"),G=U(i,"arcClose"),Q=U(i,"arcOval")),x||F||P){var hd=U(i,"fillClipPercentage");if(1>hd){0>hd&&(hd=0);var an=Gg(f,U(i,"fillClipDirection"),hd,wd);d.save(),d.beginPath(),d.rect(an.x,an.y,an.width,an.height),d.clip()}Po(d,H,f,c,R,G,Q),P?io(d,P,v):F?Yk(d,F,z,y,e,C):jq(d,x,a,W,f),d.fill(Oc),P&&d.restore(),1>hd&&d.restore(),d!==j&&Po(j,H,f,c,R,G,Q)}else Po(j,H,f,c,R,G,Q);var Im=U(i,"borderWidthAbsolute");if(Im&&(d.save(),d.setTransform(1,0,0,1,0,0)),T&&(S||J)&&(d.lineWidth=T,J?ni(d,J,z,y,e,C):d.strokeStyle=S,d.stroke(),q&&Sn(d,S,_,T,o,uc)),zp(d,V),U(i,"dash")){var wi=U(i,"dashWidth")||T;if(wi>0){V=U(i,"dashPattern")||rk;var j=ee(d,V,U(i,"dashOffset")),Fb=v(i,"dashColor")||v(Xh);j!==d&&(g?bb(j,k,D,Zq):Po(j,H,f,c,R,G,Q)),d.strokeStyle=Fb,d.lineWidth=wi,d.stroke(),U(i,"dash3d")&&Sn(d,Fb,v(i,"dash3dColor"),wi,o,U(i,"dash3dAccuracy")),zp(d,V)}}Im&&d.restore(),H===ki&&zf(d,x,U(i,"depth"),f),d.lineJoin=Gc,d.lineCap=hc,O&&M()}},u=function(X,O){var a=z||U(X,ul),H=y||U(X,"blendMode"),x=U(X,"name"),u=Ub(x,a,H);u&&u.cacheRule!=w&&(u=xe(d,u,U(X,"stretch"),O.width,O.height,e,C,a)),u?Pr(d,u,U(X,"stretch"),O.x,O.y,O.width,O.height,e,C,a,null,H):Tr=!1},G=function(N,g){var R=U(N,"text");if(R!=w){var C=U(N,"gradientPack"),s=C?io(d,C,v):v(N,ul);Uq(d,R,U(N,"font"),s,g.x,g.y,g.width,g.height,U(N,"align"),U(N,"vAlign")),C&&d.restore()}},t=function(M,G){$d(d,v(M,ul),G.x,G.y,G.width,G.height,U(M,"width"))},_=function(u,p){var h=U(u,Wl),v=0;if(h&&(h.forEach(function(X){v+=X}),v>0)){for(var L=U(u,"colors")||pg,g=U(u,"startAngle")||0,F=U(u,"hollow"),Q=U(u,Ij),S=U(u,Hi),y=U(u,Nj),A=Q?new Pk:w,N=p.x,B=p.y,J=p.width,l=p.height,_=N+J/2,s=B+l/2,$=X(J,l)/2,V=0,T=0;T<h.length;T++){var M=h[T],W=c*M/v,K=g+W;if(d.fillStyle=L[V++],V===L.length&&(V=0),d.beginPath(),F){var r=_+f(g)*$/2,j=s+O(g)*$/2,Y=_+f(K)*$,H=s+O(K)*$;d.moveTo(r,j),d.arc(_,s,$/2,g,K,!1),d.lineTo(Y,H),d.arc(_,s,$,K,g,!0)}else d.moveTo(_,s),d.arc(_,s,$,K,g,!0);A&&(W=(g+K)/2,A.add({text:Ln(Q)?Q(M,T,v,e):M,x:_+.75*f(W)*$,y:s+.75*O(W)*$})),d.closePath(),d.fill(),g=K}A&&A.each(function(G){Uq(d,G.text,S,y,G.x,G.y,0,0,Yg)})}},s=function(r,B){var n=U(r,se);if(n&&n.length>0){var u=n.length,s=U(r,Ij),Q=U(r,Hi),R=U(r,Nj),a=s?new Pk:w,V=U(r,"minValue")||0,q=U(r,"maxValue");if(q==w&&(q=0,n.forEach(function(A){U(A,Wl).forEach(function(K){q=i(q,K)})})),V===q)return;for(var H=B.height/(q-V),o=B.y+q*H,$=U(n[0],Wl).length,T=B.width/(3*$+1),k=2*T/u,M=0,c=0;u>c;c++)for(var A=n[c],v=U(A,ul),h=U(A,"colors"),D=U(A,Wl),y=0;$>y;y++){h?d.fillStyle=h[y]:v?d.fillStyle=v:(d.fillStyle=pg[M++],M===pg.length&&(M=0));var Z=D[y],Y=Z*H,P=B.x+(1+3*y)*T+c*k;if(pb(d,P,o-Y,k,Y),a){var g=Ln(s)?s(Z,y,A,e):Z,N=Oq(Q,g).height;a.add({x:P,y:o-Y-N,width:k,height:N,text:g})}}a&&a.each(function(V){Uq(d,V.text,Q,R,V.x,V.y,V.width,V.height,Yg)})}},h=function(E,W){var C=U(E,se);if(C&&C.length>0){var O=C.length,f=U(C[0],Wl).length,u=W.width/(3*f+1),t=0,A=U(E,"maxValue"),H=U(E,Ij),n=U(E,Hi),V=U(E,Nj),L=H?new Pk:w;if(A==w){A=0;for(var _=0;f>_;_++){for(var q=0,T=0;O>T;T++)q+=U(C[T],Wl)[_];A=i(A,q)}}if(A>0){for(var _=0;f>_;_++)for(var D=W.y+W.height,T=0;O>T;T++){var Z=C[T],s=U(Z,ul),I=U(Z,Wl)[_],h=I/A*W.height;s?d.fillStyle=s:(d.fillStyle=pg[t++],t===pg.length&&(t=0)),D-=h;var j={x:W.x+(1+3*_)*u,y:D,width:2*u,height:h};pb(d,j.x,j.y,j.width,j.height),L&&(j.text=Ln(H)?H(I,_,Z,e):I,L.add(j))}L&&L.each(function(F){Uq(d,F.text,n,V,F.x,F.y,F.width,F.height,Yg)})}}},p=function(y,c){var b=U(y,se);if(b&&b.length>0){for(var D=b.length,O=U(b[0],Wl).length,$=c.width/(3*O+1),x=0,p=U(y,Ij),t=U(y,Hi),o=U(y,Nj),i=p?new Pk:w,M=0;O>M;M++){for(var X=0,T=0;D>T;T++)X+=U(b[T],Wl)[M];if(X>0){var P=c.y+c.height;for(T=0;D>T;T++){var _=b[T],j=U(_,ul),h=U(_,Wl)[M],g=h/X*c.height;j?d.fillStyle=j:(d.fillStyle=pg[x++],x===pg.length&&(x=0)),P-=g;var K={x:c.x+(1+3*M)*$,y:P,width:2*$,height:g};pb(d,K.x,K.y,K.width,K.height),i&&(K.text=Ln(p)?p(h,M,_,e):h,i.add(K))}}}i&&i.each(function(F){Uq(d,F.text,t,o,F.x,F.y,F.width,F.height,Yg)})}},n=function(L,M){var N=U(L,se);if(N&&N.length>0){var P=N.length,D=U(L,"minValue")||0,B=U(L,"maxValue");if(B==w&&(B=0,N.forEach(function(J){U(J,Wl).forEach(function(c){B=i(B,c)})})),D===B)return;for(var R=M.height/(B-D),G=M.y+B*R,O=U(N[0],Wl).length,p=M.width/(3*O+1),y=0,F=U(L,"lineWidth")||2,x=U(L,"line3d"),a=U(L,"linePoint"),T=U(L,Ij),E=U(L,Hi),Q=U(L,Nj),g=0;P>g;g++){var A=N[g],H=U(A,ul),t=U(A,Wl);H?d.strokeStyle=H:(H=d.strokeStyle=pg[y++],y===pg.length&&(y=0)),d.beginPath();for(var m=0;O>m;m++){var Z=M.x+(2+3*m)*p,f=G-t[m]*R;0===m?d.moveTo(Z,f):d.lineTo(Z,f)}if(d.lineWidth=F,d.stroke(),x&&Sn(d,H,w,F,o),a||T){var C,s=F/2+2;for(m=0;O>m;m++){var _=t[m];if(Z=M.x+(2+3*m)*p,f=G-_*R,Ln(a)?a(d,Z,f,H,m,A,e):a&&(d.fillStyle=H,d.beginPath(),d.arc(Z,f,s,0,c,!0),d.fill()),Ln(T)?C=T(_,m,A,e):T&&(C=_),C){var r=Oq(E,C).height,q=d.shadowBlur;if(q){var k=d.shadowOffsetX,h=d.shadowOffsetY,j=d.shadowColor;d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor=w}Uq(d,C,E,Q,Z,f-r-s+2,0,r,Yg),q&&(d.shadowOffsetX=k,d.shadowOffsetY=h,d.shadowBlur=q,d.shadowColor=j)}}}}}},j=function(q){d=q[0],e=q[1],C=q[2],o=q[3],z=q[4],y=q[5]},D=function(){return[d,e,C,o,z,y]},k=function(V,T){var P;C&&C.getDrawableState?P=C.getDrawableState(e):C&&C.getState?P=C.getState(e):(P=e instanceof Xo?e.s(cn):null,(P===r||null===P)&&(P=U(V,cn)));var E=U(T,cn);return E!==r&&null!==E&&E!==P?!1:U(T,Ri)},W={border:t,image:u,text:G,pieChart:_,columnChart:s,stackedColumnChart:h,percentageColumnChart:p,lineChart:n};return function(g,i,J,f,N,h,s,F,I,Q){if(i&&N&&h){var T=D();d=g,e=s,C=F,!e&&C&&C.isSelfViewEvent&&(e=C),o=C?C._zoom?C._zoom:1:1,z=I,y=Q;var $=N,b=h;if(pf()){var X,q,p,l,t;0===d[Lo]?pf[0]&&(X=!0):X=!0,d.texureImage2D?pf[1]&&(q=!0):q=!0,d.texureImage3D?pf[2]&&(p=!0):p=!0,d.drawDNDState?pf[3]&&(t=!0):t=!0,Sd.widget[0]?pf[4]&&(l=!0):l=!0,X&&q&&p&&l&&t&&($=J,b=f)}if(i.tagName)return ap(ql)&&!x[ql]||d.drawImage(i,$,b,N,h),j(T),void 0;if(0==U(i,"visible"))return j(T),void 0;z||(z=Pb(i.color,e,C)),Q||(y=Pb(i.blendMode,e,C)),ap(ql)&&!x[ql]&&(N=$,h=b);var a=To(i,e,C,N),u=md(i,e,C,h),O={x:0,y:0,width:a,height:u,fitSize:U(i,"fitSize")},n=U(i,"clip"),G=U(i,"opacity");if(O.fitSize){var _=O.rw=Pb(i.width,e,C)||20;O.widthScale=a/_;var c=O.rh=Pb(i.height,e,C)||20;O.heightScale=u/c}if(d.save(),d.interactiveInfo){var R=d.interactiveInfo.matrix,H=R.clone();R.appendTranslate($,b).appendScale(N/a,h/u),d.interactiveInfo.refRect=O}Hn(d,$,b),(a!==N||u!==h)&&d.scale(N/a,h/u),n&&(Ln(n)?n(d,a,u,e,C,i):(d.beginPath(),d.rect(0,0,a,u),d.clip())),G!=w&&(d.globalAlpha*=G),U(i,"comps").forEach(function(f){if(f.prefix){var h=Mi,T=Pb(f.prefix,e,C);T&&(Mi=Mi+T+".")}if(0==k(i,f))return f.prefix&&(Mi=h),void 0;if(Gc.splice(0,0,f),d.interactiveInfo)var q=d.interactiveInfo.matrix.clone();var G=U(f,"opacity"),$=U(f,"shadow"),N=U(f,"type"),R=U(f,"refRect")||O,I=S(f,R);if(G!=w){var b=d.globalAlpha;d.globalAlpha*=G}if($){var j=o*Y.devicePixelRatio,p=d.shadowOffsetX,s=d.shadowOffsetY,J=d.shadowBlur,X=d.shadowColor,l=U(f,"shadowOffsetX"),x=U(f,"shadowOffsetY"),D=U(f,"shadowBlur"),t=v(f,"shadowColor");d.shadowOffsetX=(l==w?V:l)*j,d.shadowOffsetY=(x==w?V:x)*j,d.shadowBlur=(D==w?P:D)*j,d.shadowColor=t||v(nj)}if("save"===N)d.save();else if("endClip"===N||"restore"===N)d.restore();else if("clip"===N)d.save(),bb(d,U(f,"points",K),U(f,"segments",A),!0),d.clip();else if(up[N])I=I||{x:0,y:0,width:R.width,height:R.height},L(f,N,I,R);else if(N===ii)L(f,N,I,R);else if("SVGPath"===N)m(f,N,I);else{I=I||{x:0,y:0,width:R.width,height:R.height};var Q=U(f,Pj),y=U(f,"scaleX"),z=U(f,"scaleY"),F=E(f),u=B(f,I,I,Q,y,z,F);if(Ln(N))Z(f,N),Y.drawCompType(N,d,I,f,e,C);else if(Y.getCompType(N)){var g=Y.getCompType(N),H=g.func||g;Z(f,g),Y.drawCompType(H,d,I,f,e,C)}else W[N]?W[N](f,I):Y.getCompType(N)===r&&Kq.test(N)&&fn(N);u&&M()}$&&(d.shadowOffsetX=p,d.shadowOffsetY=s,d.shadowBlur=J,d.shadowColor=X),G!=w&&(d.globalAlpha=b),d.interactiveInfo&&(d.interactiveInfo.matrix=q),f.prefix&&(Mi=h),Gc.splice(0,1)}),d.interactiveInfo&&(d.interactiveInfo.matrix=H),d.restore(),j(T)}}}();Y.getCurrentComp=function(){return Gc[0]},Y.getParentComp=function(){return Gc[1]},Y.getInternal=function(){return{isEnter:sk,isEsc:bo,isSpace:Fg,isLeft:Yf,isUp:Cc,isRight:Ve,isDown:hs,addMethod:xl,superCall:Lh,toPointsArray:Fi,translateAndScale:Kh,appendArray:Ho,createWorldMatrix:cq,vec3TransformMat4:yb,setCanvas:Vp,createDiv:Zn,createView:xf,createCanvas:de,createImage:Pp,initContext:_d,layout:Ni,fillRect:pb,Mat:$r,drawBorder:$d,isString:ap,setBorder:_h,getPropertyValue:Qf,setPropertyValue:Qi,drawVerticalLine:rc,draw3DRect:zf,getPinchDist:eo,isSameRect:uo,getPosition:Cm,intersectionLineRect:Tq,getNodeRect:Zl,getEdgeAgentPosition:fo,getEdgeHostPosition:Ng,getImageWidth:To,getImageHeight:md,initItemElement:Jl,drawPoints:bb,createG2:ee,closePopup:Nk,isH:gr,createAnim:Re,createNormalMatrix:Or,toColorArray:er,createNormals:Wk,toFloatArray:qc,glMV:Ob,glPop:hk,batchShape:tb,createNodeMatrix:ub,getShapeModel:el,getFaceInfo:hb,transformAppend:Jb,drawFaceInfo:Fj,glUploadData:Xp,glUploadElementData:tp,glDrawArray:rp,glDrawElement:kn,pickValueToColor:nh,to3dPointsArray:jm,setGLDebugMode:function(y){od=y
},cube:function(){return{vs:oq,is:of,uv:ok}},ui:function(){return{DataUI:Me,NodeUI:$k,EdgeUI:Xf,GroupUI:zl,ShapeUI:$i,GridUI:oc,Data3dUI:us,Node3dUI:Rh,Shape3dUI:fg}},getInternalVersion:function(){return"U2FsdGVkX18fUJhFaBv0OPFkeqK+rnvKPjo59VaCwvk="},getDragger:function(){return Nr},addMSMap:function(o){xl(Jo,o)},k:j,addEventListener:B,removeEventListener:q}},function(a){function o(H,E){H!=w&&(E==w&&Bk!=typeof H?this._54O(H,256):this._54O(H,E))}function u(){return new o(w)}function s(I,K,d,E,f,D){for(;--D>=0;){var R=K*this[I++]+d[E]+f;f=C(R/67108864),d[E++]=67108863&R}return f}function g(d,v,K,e,w,_){for(var o=32767&v,Y=v>>15;--_>=0;){var n=32767&this[d],T=this[d++]>>15,A=Y*n+T*o;n=o*n+((32767&A)<<15)+K[e]+(1073741823&w),w=(n>>>30)+(A>>>15)+Y*T+(w>>>30),K[e++]=1073741823&n}return w}function $(w,Q,u,o,v,J){for(var h=16383&Q,I=Q>>14;--J>=0;){var L=16383&this[w],m=this[w++]>>14,c=I*L+m*h;L=h*L+((16383&c)<<14)+u[o]+v,v=(L>>28)+(c>>14)+I*m,u[o++]=268435455&L}return v}function n(J){return bj.charAt(J)}function A(n,f){var i=Oq[n.charCodeAt(f)];return i==w?-1:i}function d(N){for(var j=this.t-1;j>=0;--j)N[j]=this[j];N.t=this.t,N.s=this.s}function W(J){this.t=1,this.s=0>J?-1:0,J>0?this[0]=J:-1>J?this[0]=J+this.DV:this.t=0}function p(c){var x=u();return x._58O(c),x}function k(J,u){var n,P=this;if(16==u)n=4;else if(8==u)n=3;else if(256==u)n=8;else if(2==u)n=1;else if(32==u)n=5;else{if(4!=u)return P.fromRadix(J,u),void 0;n=2}P.t=0,P.s=0;for(var z=J.length,C=!1,f=0;--z>=0;){var H=8==n?255&J[z]:A(J,z);0>H?"-"==J.charAt(z)&&(C=!0):(C=!1,0==f?P[P.t++]=H:f+n>P.DB?(P[P.t-1]|=(H&(1<<P.DB-f)-1)<<f,P[P.t++]=H>>P.DB-f):P[P.t-1]|=H<<f,f+=n,f>=P.DB&&(f-=P.DB))}8==n&&0!=(128&J[0])&&(P.s=-1,f>0&&(P[P.t-1]|=(1<<P.DB-f)-1<<f)),P._57O(),C&&o.ZERO._78O(P,P)}function Z(){for(var M=this,S=M.s&M.DM;M.t>0&&M[M.t-1]==S;)--M.t}function V(t){var G=this;if(G.s<0)return"-"+G._85O()[Jq](t);var T;if(16==t)T=4;else if(8==t)T=3;else if(2==t)T=1;else if(32==t)T=5;else{if(4!=t)return G.toRadix(t);T=2}var q,v=(1<<T)-1,P=!1,F="",s=G.t,E=G.DB-s*G.DB%T;if(s-->0)for(E<G.DB&&(q=G[s]>>E)>0&&(P=!0,F=n(q));s>=0;)T>E?(q=(G[s]&(1<<E)-1)<<T-E,q|=G[--s]>>(E+=G.DB-T)):(q=G[s]>>(E-=T)&v,0>=E&&(E+=G.DB,--s)),q>0&&(P=!0),P&&(F+=n(q));return P?F:"0"}function L(){var k=u();return o.ZERO._78O(this,k),k}function e(){return this.s<0?this._85O():this}function I(Z){var d=this,P=d.s-Z.s;if(0!=P)return P;var b=d.t;if(P=b-Z.t,0!=P)return d.s<0?-P:P;for(;--b>=0;)if(0!=(P=d[b]-Z[b]))return P;return 0}function E(q){var C,o=1;return 0!=(C=q>>>16)&&(q=C,o+=16),0!=(C=q>>8)&&(q=C,o+=8),0!=(C=q>>4)&&(q=C,o+=4),0!=(C=q>>2)&&(q=C,o+=2),0!=(C=q>>1)&&(q=C,o+=1),o}function B(){var A=this;return A.t<=0?0:A.DB*(A.t-1)+E(A[A.t-1]^A.s&A.DM)}function M(U,R){var r;for(r=this.t-1;r>=0;--r)R[r+U]=this[r];for(r=U-1;r>=0;--r)R[r]=0;R.t=this.t+U,R.s=this.s}function R(c,z){for(var P=c;P<this.t;++P)z[P-c]=this[P];z.t=i(this.t-c,0),z.s=this.s}function q(_,t){var Z,G=this,L=_%G.DB,r=G.DB-L,X=(1<<r)-1,N=C(_/G.DB),O=G.s<<L&G.DM;for(Z=G.t-1;Z>=0;--Z)t[Z+N+1]=G[Z]>>r|O,O=(G[Z]&X)<<L;for(Z=N-1;Z>=0;--Z)t[Z]=0;t[N]=O,t.t=G.t+N+1,t.s=G.s,t._57O()}function H(h,A){var t=this;A.s=t.s;var K=C(h/t.DB);if(K>=t.t)return A.t=0,void 0;var E=h%t.DB,m=t.DB-E,Y=(1<<E)-1;A[0]=t[K]>>E;for(var l=K+1;l<t.t;++l)A[l-K-1]|=(t[l]&Y)<<m,A[l-K]=t[l]>>E;E>0&&(A[t.t-K-1]|=(t.s&Y)<<m),A.t=t.t-K,A._57O()}function F(y,A){for(var v=this,L=0,R=0,q=X(y.t,v.t);q>L;)R+=v[L]-y[L],A[L++]=R&v.DM,R>>=v.DB;if(y.t<v.t){for(R-=y.s;L<v.t;)R+=v[L],A[L++]=R&v.DM,R>>=v.DB;R+=v.s}else{for(R+=v.s;L<y.t;)R-=y[L],A[L++]=R&v.DM,R>>=v.DB;R-=y.s}A.s=0>R?-1:0,-1>R?A[L++]=v.DV+R:R>0&&(A[L++]=R),A.t=L,A._57O()}function N(n,A){var d=this.abs(),J=n.abs(),v=d.t;for(A.t=v+J.t;--v>=0;)A[v]=0;for(v=0;v<J.t;++v)A[v+d.t]=d.am(0,J[v],A,v,0,d.t);A.s=0,A._57O(),this.s!=n.s&&o.ZERO._78O(A,A)}function _(L){for(var b=this.abs(),V=L.t=2*b.t;--V>=0;)L[V]=0;for(V=0;V<b.t-1;++V){var j=b.am(V,b[V],L,2*V,0,1);(L[V+b.t]+=b.am(V+1,2*b[V],L,2*V+1,j,b.t-V-1))>=b.DV&&(L[V+b.t]-=b.DV,L[V+b.t+1]=1)}L.t>0&&(L[L.t-1]+=b.am(V,b[V],L,2*V,0,1)),L.s=0,L._57O()}function x(c,S,p){var D=c.abs(),L=this;if(!(D.t<=0)){var R=L.abs();if(R.t<D.t)return S!=w&&S._58O(0),p!=w&&L._77O(p),void 0;p==w&&(p=u());var G=u(),h=L.s,P=c.s,O=L.DB-E(D[D.t-1]);O>0?(D._44O(O,G),R._44O(O,p)):(D._77O(G),R._77O(p));var A=G.t,i=G[A-1];if(0!=i){var j=i*(1<<L.F1)+(A>1?G[A-2]>>L.F2:0),q=L.FV/j,v=(1<<L.F1)/j,M=1<<L.F2,F=p.t,n=F-A,U=S==w?u():S;for(G._59O(n,U),p._52O(U)>=0&&(p[p.t++]=1,p._78O(U,p)),o.ONE._59O(A,U),U._78O(G,G);G.t<A;)G[G.t++]=0;for(;--n>=0;){var K=p[--F]==i?L.DM:C(p[F]*q+(p[F-1]+M)*v);if((p[F]+=G.am(0,K,p,n,0,A))<K)for(G._59O(n,U),p._78O(U,p);p[F]<--K;)p._78O(U,p)}S!=w&&(p._45O(A,S),h!=P&&o.ZERO._78O(S,S)),p.t=A,p._57O(),O>0&&p._46O(O,p),0>h&&o.ZERO._78O(p,p)}}}function Q(S){var j=u();return this.abs()._49O(S,w,j),this.s<0&&j._52O(o.ZERO)>0&&S._78O(j,j),j}function J(v){this.m=v}function U(v){return v.s<0||v._52O(this.m)>=0?v.mod(this.m):v}function l(G){return G}function z(M){M._49O(this.m,w,M)}function y(w,l,O){w._47O(l,O),this._74O(O)}function T(O,r){O._48O(r),this._74O(r)}function m(){if(this.t<1)return 0;var Z=this[0];if(0==(1&Z))return 0;var B=3&Z;return B=15&B*(2-(15&Z)*B),B=255&B*(2-(255&Z)*B),B=65535&B*(2-(65535&(65535&Z)*B)),B=B*(2-Z*B%this.DV)%this.DV,B>0?this.DV-B:-B}function r(a){var l=this;l.m=a,l.mp=a._50O(),l.mpl=32767&l.mp,l.mph=l.mp>>15,l.um=(1<<a.DB-15)-1,l.mt2=2*a.t}function b(S){var t=u();return S.abs()._59O(this.m.t,t),t._49O(this.m,w,t),S.s<0&&t._52O(o.ZERO)>0&&this.m._78O(t,t),t}function K(O){var X=u();return O._77O(X),this._74O(X),X}function h(t){for(var y=this;t.t<=y.mt2;)t[t.t++]=0;for(var F=0;F<y.m.t;++F){var R=32767&t[F],h=R*y.mpl+((R*y.mph+(t[F]>>15)*y.mpl&y.um)<<15)&t.DM;for(R=F+y.m.t,t[R]+=y.m.am(0,h,t,F,0,y.m.t);t[R]>=t.DV;)t[R]-=t.DV,t[++R]++}t._57O(),t._45O(y.m.t,t),t._52O(y.m)>=0&&t._78O(y.m,t)}function Y(f,y){f._48O(y),this._74O(y)}function Pr(M,g,k){M._47O(g,k),this._74O(k)}function Wh(){return 0==(this.t>0?1&this[0]:this.s)}function tn(m,S){if(m>4294967295||1>m)return o.ONE;var H=u(),$=u(),d=S._73O(this),h=E(m)-1;for(d._77O(H);--h>=0;)if(S._76O(H,$),(m&1<<h)>0)S._75O($,d,H);else{var X=H;H=$,$=X}return S.revert(H)}function hp(H,_){var u;return u=256>H||_._51O()?new J(_):new r(_),this.exp(H,u)}function Nn(){var i=this;if(i.s<0){if(1==i.t)return i[0]-i.DV;if(0==i.t)return-1}else{if(1==i.t)return i[0];if(0==i.t)return 0}return(i[1]&(1<<32-i.DB)-1)<<i.DB|i[0]}function Zr(X,v){return new o(X,v)}function Fd(){var o=this;o.n=w,o.e=0,o.d=w,o.p=w,o.q=w,o.dmp1=w,o.dmq1=w,o._10A=w}function Zf(B){return B._53O(this.e,this.n)}function Rg(R){var z,W,V,U="",A=0;for(z=0;z<R.length&&R.charAt(z)!=co;++z)V=jb.indexOf(R.charAt(z)),0>V||(0==A?(U+=n(V>>2),W=3&V,A=1):1==A?(U+=n(W<<2|V>>4),W=15&V,A=2):2==A?(U+=n(W),U+=n(V>>2),W=3&V,A=3):(U+=n(W<<2|V>>4),U+=n(15&V),A=0));return 1==A&&(U+=n(W<<2)),U}function Ff(Q){var g=Q.split(""),k=Rg(Q);return g.forEach(function(X){var y=X.length;y>0&&k&&(ml+=Sq(X))}),k}function te(A,D){var J=Uf._4O.Util._56O(A,"ss"),l={},X=0;return l.v=J==D,l.t=1,l.s=0>X?-1:0,_o=l.v,X>0?l[0]=X:-1>X?l[0]=X+l.DV:l.t=0,[J,l]}function sn(F){var O=38,_=F.substring(0,O);if(_&&30==_.indexOf("05000420")){var s=["ss",F.substring(O)];return s}return[]}function Of(V,l){l=l.replace(Nm,""),l=l.replace(/[ \n]+/g,"");var Z=Zr(l,16);if(Z._55O()>this.n._55O())return 0;var N=this._37O(Z),p=N[Jq](16).replace(/^1f+00/,""),i=sn(p);if(0==i.length)return!1;for(var B,A,S,X=.5,P=Ii,b=[0,.5,.75,.875,.9375],F=[],e=[],v=[],$=c/P,E=i[1],w=te(V,E)[0],G=0,g=0;G<b.length;G++){var y=0===G%2?0:.5;for(B=0;P>=B;B++)A=(B+y)*$,S=1-b[G],F.push(f(A)*X*S,-X+2*b[G]*X,-O(A)*X*S),e.push((B+y)/P,S)}for(G=0;G<b.length-1;G++){var m=G*(P+1),k=(G+1)*(P+1);for(B=0;P>B;B++)v.push(m+B,k+B+1,k+B,m+B,m+B+1,k+B+1)}return v.forEach(function(O){g+=O}),E==w&&g>10}var ne,On=0xdeadbeefcafe,ce=15715070==(16777215&On),Jq="toString",Op="",uc="nat",Pb=function(){};S=a["D"+11182[Jq](P(2,5))];var Vg=o.prototype;uf+=Ad.substr(0,1);var To=a.navigator?a.navigator.appName:"";ce&&"Microsoft Internet Explorer"==To?(Vg.am=g,ne=30):ce&&"Netscape"!=To?(Vg.am=s,ne=26):(Vg.am=$,ne=28),Vg.DB=ne,Vg.DM=(1<<ne)-1,Vg.DV=1<<ne;var ll=52;Vg.FV=P(2,ll),Vg.F1=ll-ne,Vg.F2=2*ne-ll;var tm,Kc,bj="0123456789abcdefghijklmnopqrstuvwxyz",Oq=[],yc=function(q){return String.fromCharCode(q)};for(tm="0".charCodeAt(0),Kc=0;9>=Kc;++Kc)Oq[tm++]=Kc;for(tm="a".charCodeAt(0),Kc=10;36>Kc;++Kc)Oq[tm++]=Kc;for(tm="A".charCodeAt(0),Kc=10;36>Kc;++Kc)Oq[tm++]=Kc;var Zj=J.prototype;Zj._73O=U,Zj.revert=l,Zj._74O=z,Zj._75O=y,Zj._76O=T;var tc=r.prototype;tc._73O=b,tc.revert=K,tc._74O=h,tc._75O=Pr,tc._76O=Y,Vg._77O=d,Vg._58O=W,Vg._54O=k,Vg._57O=Z,Vg._59O=M,Vg._45O=R,Vg._44O=q,Vg._46O=H,Vg._78O=F,Vg._47O=N,Vg._48O=_,Vg._49O=x,Vg._50O=m,Vg._51O=Wh,Vg.exp=tn,Vg.toString=V,Vg._85O=L,Vg.abs=e,Vg._52O=I,Vg._55O=B,Vg.mod=Q,Vg._53O=hp,o.ZERO=p(0),o.ONE=p(1),Vg._86O=Nn;var Sg=function(d,c){var m=this;m.isPublic=!0,typeof d!==Bk?(m.n=d,m.e=c):d!=w&&c!=w&&d.length>0&&c.length>0&&(m.n=Zr(d,16),m.e=Sq(c,16))};ip=function(){var k,D,z=Ff(sg),$=z.substr(0,4),o=z.substr(4,2),C=z.substr(6,2),c=1,O=!c,d=j,W=[],N=Uj.charAt(7);if(S&&(S[Jq]().indexOf(uc)<0||S[uf][Jq]().indexOf(uc)<0||!z?k=w:(z=new S($-0,o-c,C-0),D=z.setHours(9),S[uf]()>D?k=kf[N]:O=!0)),z&&k&&k[0]&&k[v(.5)]&&d){var K=an(k[0]),Y=an(k[1]);for(var Q in Y)W.push(Q);var M,T=0,y=K[W[T]],f=Y[W[T++]],l=Y[W[T++]],H=Y[W[T++]],p=Y[W[T++]],A=Y[W[T++]],F=Y[W[T++]],V=K[W[T]],m=Y[W[T++]],R=oe._27O(d);if(y===f&&R&&m){M=f+l+H+p+A+F;var Z=!F||F===we;if(!Z&&F)for(var E,J=0,_=F.length;_>J;J++)F[J]===Zg[T]?E===we?Z=!0:E[0]===vb[5]&&we&&we.indexOf(E.substr(1))>=0?Z=!0:E=w:(E==w?E=F[J]:E+=F[J],J===_-1&&(E===we?Z=!0:E[0]===vb[5]&&we&&we.indexOf(E.substr(1))>=0&&(Z=!0)));M&&R._31O(M,m)&&R._31O(y,V)&&Z&&(!A||S[uf]()<A)&&(O=!0)}}return O||(Po=Nf),N};var Ui=Fd.prototype;Ui._37O=Zf,Ui._38O=Sg;var jb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",co="=",dq=25,Lq=10,sg="ICFhU===",io=io||function(J,r){var P={},K=P._7A={},O=K._6A=function(){function d(){}return{_80O:function(l){d.prototype=this;var c=new d;return l&&c._5A(l),c.hasOwnProperty("_82O")||(c._82O=function(){c.$super._82O.apply(this,arguments)}),c._82O.prototype=c,c.$super=this,c},_3A:function(){var X=this._80O();return X._82O.apply(X,arguments),X},_82O:function(){},_5A:function(X){for(var a in X)X.hasOwnProperty(a)&&(this[a]=X[a]);X.hasOwnProperty(Jq)&&(this.toString=X.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),p=K._39O=O._80O({_82O:function(U,E){U=this._84O=U||[],this._65O=E!=r?E:4*U.length},toString:function(j){return(j||B).stringify(this)},_89O:function(c){var s=this._84O,S=c._84O,n=this._65O,I=c._65O;if(this._57O(),n%4)for(var J=0;I>J;J++){var L=255&S[J>>>2]>>>24-8*(J%4);s[n+J>>>2]|=L<<24-8*((n+J)%4)}else if(S.length>65535)for(var J=0;I>J;J+=4)s[n+J>>>2]=S[J>>>2];else s.push.apply(s,S);return this._65O+=I,this},_57O:function(){var P=this._84O,n=this._65O;P[n>>>2]&=4294967295<<32-8*(n%4),P.length=v(n/4)},_88O:function(){var C=O._88O.call(this);return C._84O=this._84O.slice(0),C},_87O:function(a){for(var P=[],h=0;a>h;h+=4)P.push(0|4294967296*t);return new p._82O(P,a)}}),d=P._2A={},B=d._69O={stringify:function(z){var C,f=z._84O,U=z._65O,E=[];for(C=0;U>C;C++){var p=255&f[C>>>2]>>>24-8*(C%4);E.push((p>>>4).toString(16)),E.push((15&p).toString(16))}return E.join("")},_68O:function(I){for(var C=I.length,O=[],e=0;C>e;e+=2)O[e>>>3]|=Sq(I.substr(e,2),16)<<24-4*(e%8);return new p._82O(O,C/2)}},R=d._8A={stringify:function(g){var X,H=g._84O,s=g._65O,U=[];for(X=0;s>X;X++){var T=255&H[X>>>2]>>>24-8*(X%4);U.push(yc(T))}return U.join("")},_68O:function(K){var w,r=K.length,V=[];for(w=0;r>w;w++)V[w>>>2]|=(255&K.charCodeAt(w))<<24-8*(w%4);return new p._82O(V,r)}},c=d._9A={stringify:function(B){try{return decodeURIComponent(escape(R.stringify(B)))}catch(I){throw new Error("")}},_68O:function(b){return R._68O(unescape(encodeURIComponent(b)))}},L=K._32O=O._80O({_1A:function(){this._83O=new p._82O,this._23O=0},_33O:function(N){typeof N==Bk&&(N=c._68O(N)),this._83O._89O(N),this._23O+=N._65O},_25O:function(d){var t=this._83O,x=t._84O,M=t._65O,l=this._79O,s=4*l,O=M/s;O=d?v(O):i((0|O)-this._22O,0);var r=O*l,w=X(4*r,M);if(r){for(var L=0;r>L;L+=l)this._20O(x,L);var G=x.splice(0,r);t._65O-=w}return new p._82O(G,w)},_88O:function(){var X=O._88O.call(this);return X._83O=this._83O._88O(),X},_22O:0});K._66O=L._80O({cfg:O._80O(),_82O:function(R){this.cfg=this.cfg._80O(R),this._1A()},_1A:function(){L._1A.call(this),this._34O()},_81O:function(w){return this._33O(w),this._25O(),this},_72O:function(D){D&&this._33O(D);var w=this._21O();return w},_79O:16,_26O:function(o){return function(w,q){return new o._82O(q)._72O(w)}},_19O:function(i){return function(F,I){return new Z._71O._82O(i,I)._72O(F)}}});var Z=P._67O={};return P}();!function(){var g=io,w=g._7A,U=w._39O,l=w._66O,e=g._67O,v=[],s=[];!function(){function _(b){for(var Q=G(b),N=2;Q>=N;N++)if(!(b%N))return!1;return!0}function q(b){return 0|4294967296*(b-(0|b))}for(var i=2,y=0;64>y;)_(i)&&(8>y&&(v[y]=q(P(i,.5))),s[y]=q(P(i,1/3)),y++),i++}();var A=[],u=e._41O=l._80O({_34O:function(){this._64O=new U._82O(v.slice(0))},_20O:function(b,J){for(var G=this._64O._84O,j=G[0],F=G[1],w=G[2],r=G[3],S=G[4],I=G[5],y=G[6],h=G[7],D=0;64>D;D++){if(16>D)A[D]=0|b[J+D];else{var H=A[D-15],R=(H<<25|H>>>7)^(H<<14|H>>>18)^H>>>3,e=A[D-2],T=(e<<15|e>>>17)^(e<<13|e>>>19)^e>>>10;A[D]=R+A[D-7]+T+A[D-16]}var Q=S&I^~S&y,L=j&F^j&w^F&w,m=(j<<30|j>>>2)^(j<<19|j>>>13)^(j<<10|j>>>22),t=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),Y=h+t+Q+s[D]+A[D],$=m+L;h=y,y=I,I=S,S=0|r+Y,r=w,w=F,F=j,j=0|Y+$}G[0]=0|G[0]+j,G[1]=0|G[1]+F,G[2]=0|G[2]+w,G[3]=0|G[3]+r,G[4]=0|G[4]+S,G[5]=0|G[5]+I,G[6]=0|G[6]+y,G[7]=0|G[7]+h},_21O:function(){var b=this._83O,M=b._84O,K=8*this._23O,x=8*b._65O;return M[x>>>5]|=128<<24-x%32,M[(x+64>>>9<<4)+14]=C(K/4294967296),M[(x+64>>>9<<4)+15]=K,b._65O=4*M.length,this._25O(),this._64O},_88O:function(){var r=l._88O.call(this);return r._64O=this._64O._88O(),r}});g._41O=l._26O(u),g._42O=l._19O(u)}();var Nm=new RegExp("");Nm.compile("[^0-9a-f]","gi"),Fd._28O=-1,Fd._29O=-2,Ui._31O=Of,Ui._63O=Of,Fd._43O=-2;var Gj=new function(){var P=this;P._5O=function(e,i){if("8"!=e.substring(i+2,i+3))return 1;var y=Sq(e.substring(i+3,i+4));return 0==y?-1:y>0&&10>y?y+1:-2},P._13O=function(z,O){var X=P._5O(z,O);return 1>X?"":z.substring(O+2,O+2+2*X)},P._12O=function(p,D){var m=P._13O(p,D);if(""==m)return-1;var C;return C=Sq(m.substring(0,1))<8?new o(m,16):new o(m.substring(2),16),C._86O()},P._6O=function(X,l){var q=P._5O(X,l);return 0>q?q:l+2*(q+1)},P._11O=function(F,Y){var v=P._6O(F,Y),E=P._12O(F,Y);return F.substring(v,v+2*E)},P._10O=function(g,b){var l=P._6O(g,b),R=P._12O(g,b);return l+2*R},P._7O=function(L,N){var h=[],I=P._6O(L,N);h.push(I);for(var c=P._12O(L,N),d=I,r=0;;){var l=P._10O(L,d);if(l==w||l-I>=2*c)break;if(r>=200)break;h.push(l),d=l,r++}return h}};if(Gj._90O=yc(Lq+24),Gj._91O=D+yc(Lq*Lq+8),Uf==w||!Uf)var Uf={};Uf._4O!=w&&Uf._4O||(Uf._4O={});var Ie=Uf._4O;Uf._4O.Util=new function(){var m=this;m._56O=function(N){var Q=new Uf._4O._3O;return Q._30O(N)},m._4A=function(A){var G=new Uf._4O._3O;return G._36O(A)},m._11A=function(K){var D=new Ie._3O;return D._30O(K)}},Uf._4O._3O=function(){var K=this;K._8O=function(Z,S){if("ss"==Z&&"cj"==S){try{K.md=io._67O._41O._3A()}catch(z){Pb(Op)}K._24O=function(D){K.md._81O(D)},K._35O=function(M){var E=io._2A._69O._68O(M);K.md._81O(E)},K._60O=function(){var k=K.md._72O();return k[Jq](io._2A._69O)},K._30O=function(T){return K._24O(T),K._60O()},K._36O=function(f){return K._35O(f),K._60O()}}},K._24O=function(){Pb(Op)},K._35O=function(){Pb(Op)},K._60O=function(){Pb(Op)},K._30O=function(){Pb(Op)},K._36O=function(){Pb(Op)},K._8O("ss","cj")},rq=function(T){var k=qg[bs[7]],Y=1,D=!1;if(mh.a!=qg[Qm])return mh.a;if(mh.forEach(function(u){Y*=u}),T>Y){if(k&&k[1]&&k[0]){var I=k[0],q=k[1];q=q.split(Gj._90O),I=I.split(Gj._90O);var L=q[3],n=I[3],c=q[7],s=q[11],p=q[15],i=q[19],E=q[23],W=q[27],r=I[7],w=L+c+s+p+i+E,V=E?!1:!0,v=n===L;if(E){var X=E&&E.split(Pm("firefox")[3]);if(X)for(var b=0;b<X.length;b++){var Q=X[b];if(Q[0]===ri[8]&&(Q=Q.substring(1)),Tc.indexOf(Q)>=0){V=!0;break}}}D=v&&Cn()(n,r)&&Cn()(w,W)&&V&&(!i||i>T),D&&s.indexOf(ai.length)>=0&&(rq[ai.length]=ai),D&&s.indexOf(ai.length+1)>=0&&(rq[ai.length+1]=ai),D&&s.indexOf(ai.length+3)>=0&&(rq[ai.length+3]=ai)}D||(Me.prototype._42=He)}else D=!0,rq[ai.length]=rq[ai.length+1]=rq[ai.length+3]=ai;return mh.a=D,D},dq=String.fromCharCode(dq+20);var xj=function(g){return g=g.replace(Nm,Op),g=g.replace(/[ \n]+/g,Op)},Nr="30",Kf="06",sh="02",vn="03",mq=Zr,Oo=/^1f+00/,oe=function(){var L;return L={_18O:function(P){var $=P,a=$.replace(/\s+/g,""),N=Rg(a);return N},_14O:function(m){var g=this._18O(m),d=this._15O(g);return d},_15O:function(V){var A=this._17O(V);if("2a864886f70d010101"==A._61O){var C=this._16O(A.key),d=new Fd;return d._38O(C.n,C.e),d}Pb(Op)},_16O:function(Z){var $={};Z.substr(0,2)!=Nr&&Pb(Op);var n=Gj._7O(Z,0);return 2!=n.length&&Pb(Op),Z.substr(n[0],2)!=sh&&Pb(Op),$.n=Gj._11O(Z,n[0]),Z.substr(n[1],2)!=sh&&Pb(Op),$.e=Gj._11O(Z,n[1]),$},_17O:function(j){var f={};f._40O=w;var g=Gj._7O(j,0);2!=g.length&&Pb(Op);var r=g[0];j.substr(r,2)!=Nr&&Pb(Op);var v=Gj._7O(j,r);return 2!=v.length&&Pb(Op),j.substr(v[0],2)!=Kf&&Pb(Op),f._61O=Gj._11O(j,v[0]),j.substr(v[1],2)==Kf?f._40O=Gj._11O(j,v[1]):j.substr(v[1],2)==Nr&&(f._40O={},f._40O.p=Gj._70O(j,v[1],[0],sh),f._40O.q=Gj._70O(j,v[1],[1],sh),f._40O.g=Gj._70O(j,v[1],[2],sh)),j.substr(g[1],2)!=vn&&Pb(Op),f.key=Gj._11O(j,g[1]).substr(2),f}},L._17O?L:w}(),kc=oe._27O=function(R){return oe._14O(R)};Cn=function(){return function(C,A){if(C&&A){A=xj(A);var m=mq(A,P(2,4)),D=this;if(!D||!D.n||m._55O()>D.n._55O())return 0;var H=D._37O(m),y=H[Jq](P(2,4)).replace(Oo,""),w=sn(y);if(0==w.length)return!1;var d=w[0],n=w[1],_=function(r){return Uf._4O.Util._56O(r,d)},J=_(C);return n==J}}.bind(kc(j))};var $d,yj;return function(){var o=pi.length-gi.length;if(o>0)for(var v=0;o>v;v++)$d=Ie.Util,yj=xj}(),Xr=function(M,H){H=yj(H);var U=kc(ms),g=qf.length,d=2*g,V=mq(H,P(g,d)),F=U,J=!0;if(F){var m=F[to[0]];m&&V._55O()<=m._55O()&&(J=!1)}if(J)return 0;var Q=F._37O(V),N=Q[Jq](P(g,d)).replace(Oo,""),A=sn(N);if(0==A.length)return!1;var $=A[0],O=A[1],c=$d._11A(M,$);return O==c},oe}(x,R),xl(Y,{load:function(){var w={},S=function(m){return m?"c_"+(m.sync?"1":"0")+"_"+(m.post?"1":"0")+"_"+(m.responseType||"H")+"_"+(m.mimeType||"H")+"_"+(m.data?JSON.stringify(m.data):"H"):""};return function(A,T,X){var y,B=w[A],F=S(X);return B&&(y=B[F])?(y.push(T),void 0):(w[A]||(B=w[A]={count:0}),y=B[F]=[T],B.count++,Y.xhrLoad(A,function(x){delete B[F],B.count--,B.count||delete w[A],y.forEach(function(q){q(x)})},X),void 0)}}(),asyncEach:function(_,i,S){"function"!=typeof S&&(S=Function.prototype);var R=new Array(_.length),s=0,V=!1;_.forEach(function(k,u){i(k,function(b,e){return V?void 0:b?(V=!0,S(null)):(R[u]=e,s++,s===_.length?S(R):void 0)})})},xhrLoad:function(Z,_,u){var w=!1;wd(Z)||(w=!0,Z=[Z]),u=u||{};var i=u.sync,J=null,Q=u.method||"GET";return u.post&&(Q="POST"),u.method=Q,Y.asyncEach(Z,function(c,a){var z=new cd;c=Y.beforeLoadURL(c),c.data?a(null,c.data):(u.url=encodeURI(c),u.responseType?z.setResponseType(u.responseType):z.setOverrideMimeType(u.mimeType||"text/plain"),z.onload=function(){200===this.status||0===this.status?a(null,z.getResponseText()):a(!0)},z.onerror=function(){a(!0)},z.send(u))},function(o){var l="function"==typeof _;(l||i)&&(J=w&&o?o[0]:o,l&&_(J))}),i?J:void 0}});var gs=R.setPrototypeOf||function(J,M){return J.__proto__=M,J},ts=R.getPrototypeOf||function(q){return q.__proto__},Lr=R.freeze;R.isFrozen;var Rc=function(){var D=function(N){return N};return function(I){return I&&I.length?new Function("o",["return o['",I.join("']['"),"'];"].join("")):D}}(),fj=function(){var $=function(z,i){return z=i};return function(Q){return Q&&Q.length?new Function("o","v",["return o['",Q.join("']['"),"'] = v;"].join("")):$}}();!function(){function D(I){var M=[];if(I)for(var W;(W=g.exec(I))!=r;)M.push(W[1]);return M}function N(j,u){var E=M.exec(u);this._cell=j,this._key=E[1],this._format=E[2],this._style=D(E[3])}function w(S){for(var B=this._cellList=[],p=this._paramList=[],R=S.split(Y),y=0,t=R.length;t>y;++y){var z=R[y];if("{{"!==z)for(var c=z.split(m),F=0,o=c.length;o>F;++F){var V=c[F];m.test(V)?(p.push(new N(B.length,V)),B.push(r)):V.length>0&&B.push(V)}else B.push("{")}this._formatList=this._cellList.slice(0)}var k={},b={},Y=/(\{\{)/,m=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,M=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,g=/\&([\w\.]*)/g;w.prototype._73O=function(D){for(var P=this._paramList.length;P--;){var J=this._paramList[P],i=D[Sq(J._key)+1],u=b[J._format];u&&(i=u(i,J._style)),this._formatList[J._cell]=i}return this._formatList.join("")},w.prototype._map=function(A){for(var Z=this._paramList.length;Z--;){var W=this._paramList[Z],S=A[W._key],a=b[W._format];a&&(S=a(S,W._style)),this._formatList[W._cell]=S}return this._formatList.join("")};var S=function(x){var i=k[x];return i||(k[x]=i=new w(x)),i._73O(arguments)};return S.map=function(t,U){var s=k[t];return s||(k[t]=s=new w(t)),s._map(U)},S.setValueFormat=function(D,o){b[D]=o},S.gc=function(){k.length=0},S.__parsed=k,S}();var ws=function(){function D(i,n,l,h){var K=i?i.path.slice(0):[];n&&K.push(n),this.desc=l,this.name=n,this.path=Lr(K),this.getter=Rc(K),this.setter=fj(K),this.isLeaf=h,this.parent=i,this.children=[],this.childMap={}}return D.create=function(){function h(x,d,F,I){var N=I(F),B=new D(x,d,F,N);if(!N){for(var M=B.children,C=B.childMap,y=R.keys(F),U=0,O=y.length;O>U;++U){var c=y[U],V=h(B,c,F[c],I);M.push(V),C[V.name]=V}B.children=Lr(M),B.childMap=Lr(C)}return Lr(B),B}return function(B,$){return h(r,r,B,$)}}(),D.prototype.forEach=function(N,n){for(var s=this.children,J=0,S=s.length;S>J;++J){var I=s[J];N(I,n)}},D}(),Lr=R.freeze,Fc={main:{mask:1,priority:Y.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:Y.cameraPriority.top,ignore:!1}},uj="main",Xe=Fc[uj].mask,bk=function(E,d,w){if(E=E||0,!(d in Fc)){if(Im>=32)throw new Error("Only 31 render layer can be defined.");Fc[d]={mask:1<<Im++,priority:Fc[uj].priority}}if(w)for(var u in w)Fc[d][u]=w[u];return Jk=yp(R.keys(Fc)),Im=Jk.length,E|=Fc[d].mask},Vf=function(p,i){return p&&i&&p&i},yp=function(d){return d.sort(function(n,X){return Fc[n].priority-Fc[X].priority})},Jk=yp(R.keys(Fc)),Im=Jk.length;xl(Y,{setRenderLayerInfo:function(q,$){bk(0,q,$)},getRenderLayerInfo:function(l){return Fc[l]}},!0);var Pk=s.List=function(){this._as=[];var p,A,D=arguments.length;if(1===D){var c=arguments[0];if(aq(c)&&(c=c._as),wd(c))for(A=c.length,p=0;A>p;p++)this._as.push(c[p]);else c!=w&&this._as.push(c)}else if(D>1)for(p=0;D>p;p++)this._as.push(arguments[p])};Je("List",R,{forEach:function(o,$){this.each(o,$)},push:function(){for(var Q=0;Q<arguments.length;Q++)this.add(arguments[Q])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(B,Y){return Y===r?this._as.push(B):this._as.splice(Y,0,B)},addAll:function(r){aq(r)&&(r=r._as),wd(r)?Ho(this._as,r):this._as.push(r)},get:function(A){return this._as[A]},slice:function(K,n){return new Pk(this._as.slice(K,n))},remove:function(T){var b=this._as.indexOf(T);return b>=0&&b<this._as.length&&this.removeAt(b),b},removeAt:function(V){return this._as.splice(V,1)[0]},set:function(A,O){return this._as[A]=O},clear:function(){return this._as.splice(0,this._as.length)},contains:function(f){return this._as.indexOf(f)>=0},indexOf:function(M){return this._as.indexOf(M)},each:function(f,M){for(var B=0,h=this._as.length;h>B;B++){var w=this._as[B];M?f.call(M,w,B,this):f(w,B,this)}},reverseEach:function(k,r){for(var i=this._as.length-1;i>=0;i--){var U=this._as[i];r?k.call(r,U):k(U)}},getArray:function(){return this._as},toArray:function(Q,G){if(Q){for(var $,W=[],d=0,l=this._as.length;l>d;d++)$=this._as[d],G?Q.call(G,$)&&W.push($):Q($)&&W.push($);return W}return this._as.concat()},toList:function(o,R){if(o){for(var z,d=new Pk,E=0,e=this._as.length;e>E;E++)z=this._as[E],R?o.call(R,z)&&d.add(z):o(z)&&d.add(z);return d}return new Pk(this)},reverse:function(){this._as.reverse()},sort:function(U){return this._as.sort(U?U:Ui),this},toString:function(){return this._as.toString()}}),R.defineProperties(Pk.prototype,{length:{get:function(){return this._as.length},set:function(M){this._as.length=M}}});var Kn=new Pk;xl(Kn,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:je,each:je,reverseEach:je,toArray:function(){return[]},toList:function(){return new Pk},add:Bh,addAll:Bh,set:Bh,remove:Bh,removeAt:Bh,clear:Bh});var hh=s.Notifier=function(){this._f=0};Je("Notifier",R,{contains:function(K,z){if(this._ls)for(var H,h=0,J=this._ls.size();J>h;h++)if(H=this._ls.get(h),K===H.l&&z===H.s)return!0;return!1},add:function(f,m,I){var K=this,h={l:f,s:m,a:I};K._ls||(K._ls=new Pk),K._f?(K._as||(K._as=new Pk),K._as.add(h)):h.a?K._ls.add(h,0):K._ls.add(h)},remove:function(I,q){var b=this;b._ls&&(b._f?(b._rs||(b._rs=new Pk),b._rs.add({l:I,s:q})):b._remove(I,q))},_remove:function(f,Y){for(var L,O=this._ls,m=0,V=O.size();V>m;m++)if(L=O.get(m),L.l===f&&L.s===Y)return O.removeAt(m),void 0},fire:function(F){var x=this,y=x._ls;if(x._b=1e4,y){++x._f;try{for(var z,K=0,o=y.size();o>K;K++)z=y.get(K),z.s?z.l.call(z.s,F):z.l(F)}catch(F){fr(function(){throw F})}finally{if(--x._f)return;if(x._rs){for(o=x._rs.size(),K=0;o>K;K++)z=x._rs.get(K),x._remove(z.l,z.s);delete x._rs}if(x._as){for(o=x._as.size(),K=0;o>K;K++)z=x._as.get(K),z.a?y.add(z,0):y.add(z);delete x._as}}}}});var Xo=s.Data=function(){this._id=Nb()};Je("Data",R,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:w,_parent:w,_children:Kn,_childMap:w,_styleMap:w,_layer:"0",_renderLayer:uj,_renderLayerMask:Xe,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Xe},getRenderLayer:function(){return this._renderLayer||uj},setRenderLayer:function(m){var p=this,g=bk(0,m);p._renderLayerMask=g;var t=p._renderLayer;p._renderLayer=m,p.fp("renderLayer",t,p._renderLayer)},testRenderLayer:function(P){var t=Fc[P];return t&&Vf(this._renderLayerMask,Fc[P].mask)},getUIClass:function(){return w},_22Q:function(){return w},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(n,s){var V=this;if(2===arguments.length)V.setStyle(n,s);else{if(!np(n))return V.getStyle(n);for(var J in n)V.setStyle(J,n[J])}return V},fp:function(a,z,U,k,S){return this.firePropertyChange(a,z,U,k,S)},firePropertyChange:function(d,Y,o,F,E){if(F){if(F(Y,o))return!1}else if(Y===o)return!1;var y=this,s=E||{};return s.property=d,s.oldValue=Y,s.newValue=o,s.data=y,y._dataModel&&y._dataModel.handleDataPropertyChange(s),y.onPropertyChanged(s),!0},onPropertyChanged:function(g){var A=this,v=A._parent,D=g.property;if(Qq(v)){var $=A.s($e),P="s:ingroup"===D;($&&ae[D]||D===P)&&v._81I(),($||P)&&v.fp("childChange",!0,!1)}cb(v)&&(ae[D]||"elevation"===D||vl[D]||"scaleTall"===D||"tall"===D)&&v.updateFromChildren()},_21I:function(Q){var n=this;if(Q&&n._dataModel)throw"Remove data from dataModel before adding";n._dataModel=Q},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var h=0,_=this._children.toArray(),G=_.length;G>h;h++)_[h].removeFromDataModel()},getId:function(){return this._id},setId:function(I){this._id=I},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(Y,w){return this._children.toList(Y,w)},eachChild:function(a,_){this._children.each(a,_)},addChild:function(j,e){var r=this;j!==r&&(r._children===Kn&&(r._children=new Pk,r._childMap={}),e>=0||(e=r._children.size()),r._childMap[j._id]||r.isDescendantOf(j)||(j._parent&&j._parent.removeChild(j),(0>e||e>r._children.size())&&(e=r._children.size()),r._children.add(j,e),r._childMap[j._id]=j,j.setParent(r),r.onChildAdded(j,e),r.fp(ir,w,j)))},onChildAdded:function(){},removeChild:function(K){var j=this;if(j._childMap&&j._childMap[K._id]){var D=j._children.remove(K);delete j._childMap[K._id],j.fp(ir,K,w),K.setParent(w,D),j.onChildRemoved(K,D)}},onChildRemoved:function(){},getChildAt:function(u){return this._children.get(u)},clearChildren:function(){var W=this;if(!W._children.isEmpty())for(var l=0,g=W._children.toArray(),C=g.length;C>l;l++)W.removeChild(g[l])},getParent:function(){return this._parent},setParent:function(g,Q){var h=this;if(!(h._73I||h._parent===g||h===g||g&&g.isDescendantOf(h))){var U,n=h._parent;h._parent=g,h._73I=1,n?(Q==w&&(Q=n.getChildren().indexOf(h)),n.removeChild(h)):h._dataModel&&Q==w&&(Q=h._dataModel.getRoots().indexOf(h)),g&&(g.addChild(h),U=g.getChildren().indexOf(h)),delete h._73I,h.fp("parent",n,g,r,{oldIndex:Q,newIndex:U}),h.onParentChanged(n,g)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(T){return T?this.isDescendantOf(T)||T.isDescendantOf(this):!1},isParentOf:function(D){return D&&this._childMap?!!this._childMap[D._id]:!1},isDescendantOf:function(C){if(!C||C.isEmpty())return!1;for(var l=this._parent;l;){if(C===l)return!0;l=l._parent}return!1},getStyle:function(A,o){o===r&&(o=1);var N=this._styleMap?this._styleMap[A]:r;return N===r&&o?V[A]:N},setStyle:function(Q,E){var b=this;b._styleMap||(b._styleMap={});var C=b._styleMap[Q];E===r?delete b._styleMap[Q]:b._styleMap[Q]=E,b.fp("s:"+Q,C,E)&&b.onStyleChanged(Q,C,E)},onStyleChanged:function(){},iv:function(y){this.invalidate(y)},invalidate:function(p){this.fp(p||"*",!1,!0)},toString:function(){var A=this;return A._displayName||A._name||A._tag||A._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(z,t){var $=this,U=$.s(li);$.beginTransaction(),U||$.s(li,U={}),t?U[z]=t:delete U[z],$.fp(li,w,U),$.endTransaction()},removeStyleIcon:function(N){var n=this.s(li);if(n){var Q=n[N];delete n[N],this.fp(li,w,n)}return Q},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(y){var G=this;if(G.hasOwnProperty("_anchor")||G.hasOwnProperty("_anchorElevation")){var p=G.getAnchor3d(),u={x:p.x-.5,y:p.y-.5,z:p.z-.5};ze(y,[-u.x,-u.y,-u.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var b,w={};for(b in this._styleMap)w[b]=1;return w},getCurrentPrefix:function(){return this._interactPrefix||Mi},ca:function(D,u){var E=this.getCurrentPrefix();return D=E+D,2===arguments.length?this.a(D,u):this.a(D)}});var Rb=s.DataModel=function(){var N=this;N._isDeserializing=0,N._datas=new Pk,N._dataMap={},N._roots=new Pk,N._rootMap={},N._fsDataMap={},N._78O={},N._reflectorMap={},N._36I=new hh,N._35I=new hh,N._serializeNotifier=new hh,N._selectionModel=new pq(N);var I=N._29Q=[],S=N._scheduleCallback=function(){for(var X=Date.now(),n=0;n<I.length;n++){var Z=I[n];Z.enabled&&X-Z.lastTime>Z.interval&&(Z.beforeAction&&Z.beforeAction(),Z.action&&N.each(function(u){Z.action(u)}),Z.afterAction&&Z.afterAction(),Z.lastTime=X)}I.length&&(N._30Q=x.requestAnimationFrame(S))}};Je("DataModel",R,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:r,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:r,_init:r,_envmap:r,_cubicEnvmap:!1,_postProcessingData:r,sm:function(){return this.getSelectionModel()},mm:function(X,d,Q){this.addDataModelChangeListener(X,d,Q)},umm:function(u,W){this.removeDataModelChangeListener(u,W)},md:function(Y,W,x){this.addDataPropertyChangeListener(Y,W,x)},umd:function(k,t){this.removeDataPropertyChangeListener(k,t)
},mh:function(P,j,X){this.addHierarchyChangeListener(P,j,X)},umh:function(K,x){this.removeHierarchyChangeListener(K,x)},getAttrObject:function(){return this._attrObject},setAttrObject:function(X){return this._attrObject=X},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(w){return this._dataMap[w]},removeDataById:function(Y){this.remove(this.getDataById(Y))},toDatas:function(i,P){return this._datas.toList(i,P)},each:function(J,x){this._datas.each(J,x)},getDataByTag:function(M){return this._78O[M]},getTagMap:function(){return this._78O},removeDataByTag:function(r){this.remove(this.getDataByTag(r))},add:function(b,P,v){var R=this,O=b._id,B=b._tag,$=R._roots;if(R._dataMap[O])throw"'"+O+"' already exists";B!=w&&(R._78O[B]=b),R._dataMap[O]=b,v>=0?R._datas.add(b,v):R._datas.add(b),b._parent||(R._rootMap[O]=b,P>=0?$.add(b,P):$.add(b)),b.s("fullscreen")!==r&&(R._fsDataMap[O]=b),b.s("shape3d.reflector")&&(R._reflectorMap[O]=b),b._21I(R),R.onAdded(b),R._36I.fire({kind:"add",data:b,rootsIndex:P,datasIndex:v})},onAdded:function(){},remove:function(U,D){if(U){var P=this,l=U._id,n=D&&D.keepStructure,m=D&&D.keepChildren,I=U.getTag();if(U._dataModel===P){var S=U instanceof So;S&&Y.setIsolating(!0),this.beginTransaction(),n?P._removingData||(P._removingData=U):P.prepareRemove(U),m||U.toChildren().each(function(a){P.remove(a,D)},P),n?P._removingData===U&&(U._parent&&U._parent.removeChild(U),delete P._removingData):U._parent&&U._parent.removeChild(U);var b=P._datas.remove(U);delete P._dataMap[l],I!=w&&delete P._78O[I];var u;P._rootMap[l]&&(delete P._rootMap[l],u=P._roots.remove(U)),P._fsDataMap[l]&&delete P._fsDataMap[l],P._reflectorMap[l]&&delete P._reflectorMap[l],U._21I(w),P.onRemoved(U),P._36I.fire({kind:Ge,data:U,rootsIndex:u,datasIndex:b}),this.endTransaction(),S&&Y.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var j=this;if(j._datas.size()){var h=j._historyManager?this.toJSON():r;j._datas.toArray().forEach(function(d){d._21I(w)}),j._datas.clear(),j._dataMap={},j._roots.clear(),j._rootMap={},j._fsDataMap={},j._reflectorMap={},j._78O={},j._36I.fire({kind:qb,json:h})}},contains:function(B){return B&&B._dataModel===this},handleDataPropertyChange:function($){var u=this,q=$.data,N=$.property;if("parent"===N){var p=q._id,U=u._rootMap,J=u._roots;q._parent?U[p]&&(delete U[p],J.remove(q)):U[p]||(U[p]=q,J.add(q))}else if("tag"===N){var k=$.oldValue,G=$.newValue,Q=u._78O;k!=w&&delete Q[k],G!=w&&(Q[G]=q)}else if("s:fullscreen"===N){var p=q._id,l=u._fsDataMap;$.oldValue!=w&&delete l[p],$.newValue!=w&&(l[p]=q)}else if("s:shape3d.reflector"===N){var p=q._id,M=u._reflectorMap;$.oldValue&&delete M[p],$.newValue&&(M[p]=q)}this.onDataPropertyChanged(q,$),this._35I.fire($)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(S,h,A){this._36I.add(S,h,A)},removeDataModelChangeListener:function(m,l){this._36I.remove(m,l)},addSerializeListener:function(b,B,m){this._serializeNotifier.add(b,B,m)},removeSerializeListener:function(s,d){this._serializeNotifier.remove(s,d)},fireSerializeEvent:function(t){this._serializeNotifier.fire(t)},addDataPropertyChangeListener:function(y,C,M){this._35I.add(y,C,M)},removeDataPropertyChangeListener:function(q,r){this._35I.remove(q,r)},_38I:function(P,M,H){this._37I&&this._37I.fire({data:P,oldIndex:M,newIndex:H})},addHierarchyChangeListener:function(K,J,Z){this._37I||(this._37I=new hh),this._37I.add(K,J,Z)},removeHierarchyChangeListener:function(F,L){this._37I.remove(F,L)},getSiblings:function(W){var V=W._parent;return V?V._children:this._roots},eachByHierarchical:function(k,I,J){if(I)return this._eachByHierarchical(k,I,J);for(var Z=0,i=this._roots,h=i.size();h>Z;Z++)if(this._eachByHierarchical(k,i.get(Z),J)===!1)return!1;return!0},_eachByHierarchical:function(K,E,_){if(_){if(K.call(_,E)===!1)return!1}else if(K(E)===!1)return!1;for(var D=E.size(),b=0;D>b;b++)if(this._eachByHierarchical(K,E.getChildAt(b),_)===!1)return!1;return!0},reverseEachByHierarchical:function(A,L,R){if(L)return this._reverseEachByHierarchical(A,L,R);for(var d=this._roots,h=d.size(),o=h-1;o>=0;o--)if(this._reverseEachByHierarchical(A,d.get(o),R)===!1)return!1;return!0},_reverseEachByHierarchical:function(V,x,X){for(var m=x.size(),e=m-1;e>=0;e--)if(this._reverseEachByHierarchical(V,x.getChildAt(e),X)===!1)return!1;if(X){if(V.call(X,x)===!1)return!1}else if(V(x)===!1)return!1;return!0},eachByDepthFirst:function(C,s,W){if(s)return this._11I(C,s,W);for(var l=0,P=this._roots,S=P.size();S>l;l++)if(this._11I(C,P.get(l),W)===!1)return!1;return!0},_11I:function(p,C,I){for(var U=C.size(),W=0;U>W;W++)if(this._11I(p,C.getChildAt(W),I)===!1)return!1;if(I){if(p.call(I,C)===!1)return!1}else if(p(C)===!1)return!1;return!0},eachByBreadthFirst:function(O,$,V){var k=new Pk;for($?k.add($):this._roots.each(k.add,k);k.size()>0;)if($=k.removeAt(0),$.eachChild(k.add,k),V){if(O.call(V,$)===!1)return!1}else if(O($)===!1)return!1;return!0},moveTo:function(Q,T){var z=this.getSiblings(Q),W=z.indexOf(Q);W===T||0>W||T>=0&&T<=z.size()&&(z.remove(Q),T>z.size()&&T--,z.add(Q,T),this._38I(Q,W,T))},moveUp:function(t){this.moveTo(t,this.getSiblings(t).indexOf(t)-1)},moveDown:function(N){this.moveTo(N,this.getSiblings(N).indexOf(N)+1)},moveToTop:function(R){this.moveTo(R,0)},moveToBottom:function(n){this.moveTo(n,this.getSiblings(n).size())},moveSelectionUp:function(O){this.beginTransaction(),O||(O=this.sm());var P=new Pk;Hk(O,P,this._roots),P.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(i){this.beginTransaction(),i||(i=this.sm());var I=new Pk;gg(i,I,this._roots),I.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(Z){this.beginTransaction(),Z||(Z=this.sm());var y=new Pk;go(Z,y,this._roots),y.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(O){this.beginTransaction(),O||(O=this.sm());var q=new Pk;Bp(O,q,this._roots),q.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(i,C,g){var T=this.getDatas();null==g&&(g=T.indexOf(i)),g===C||0>g||C>=0&&C<=T.size()&&(T.remove(i),C>T.size()&&C--,T.add(i,C),this._76I(i,g,C))},bringForward:function(T){this.moveToIndex(T,this.getDatas().indexOf(T)+1)},bringToFront:function(x){this.moveToIndex(x,this.size())},sendBackward:function(T){this.moveToIndex(T,this.getDatas().indexOf(T)-1)},sendToBack:function(u){this.moveToIndex(u,0)},bringSelectionForward:function(T){this.beginTransaction(),T||(T=this.sm());for(var e=new Pk,t=this.getDatas(),$=!1,g=0;g<t.size();g++){var I=t.get(t.size()-1-g);T.contains(I)?$&&e.add(I):$=!0}e.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(t){this.beginTransaction(),t||(t=this.sm());for(var O=new Pk,h=this.getDatas(),f=0;f<h.size();f++){var r=h.get(f);t.contains(r)&&O.add(r)}O.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(a){this.beginTransaction(),a||(a=this.sm());for(var A=new Pk,x=this.getDatas(),k=!1,v=0;v<x.size();v++){var Y=x.get(v);a.contains(Y)?k&&A.add(Y):k=!0}A.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(z){this.beginTransaction(),z||(z=this.sm());for(var t=new Pk,T=this.getDatas(),F=0;F<T.size();F++){var a=T.get(T.size()-1-F);z.contains(a)&&t.add(a)}t.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(W){var H=this;H.removeScheduleTask(W),W.enabled==w&&(W.enabled=!0),W.interval==w&&(W.interval=10),W.lastTime=Date.now(),H._29Q.push(W),H._30Q==w&&(H._30Q=x.requestAnimationFrame(H._scheduleCallback))},removeScheduleTask:function(Q){var u=this,y=u._29Q,A=y.indexOf(Q);A>=0&&y.splice(A,1),y.length||u._30Q==w||(x.cancelAnimationFrame(u._30Q),delete u._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(E){this._historyManager||new s.HistoryManager(this),null!=E&&this._historyManager.setMaxHistoryCount(E),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(e){this._historyManager&&this._historyManager.undo(e)},redo:function(h){this._historyManager&&this._historyManager.redo(h)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(K){this._historyManager&&this._historyManager.addHistory(K)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(q){q?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return this._cubicEnvmap},setCubicEnvmap:function(d){var r=this._cubicEnvmap;this._cubicEnvmap=d,this.fp("cubicEnvmap",r,d)}});var pq=s.SelectionModel=function(j){var Q=this;Q._68O=ao,Q._map={},Q._73O=new Pk,Q._74I=new hh,Q._21I(j)};Je("SelectionModel",R,{ms_fire:1,ms_dm:1,ms:function(w,u,R){this.addSelectionChangeListener(w,u,R)},ums:function(I,w){this.removeSelectionChangeListener(I,w)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Sj},co:function(T){return this._map[T._id]!=w},ss:function(O){this.setSelection(O)},as:function(i){this.appendSelection(i)},rs:function(o){this.removeSelection(o)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(o){var A=this;if(A._68O!==o&&(o===to||o===Sj||o===ao)){A.cs();var _=A._68O;A._68O=o,A.fp("selectionMode",_,o)}},_21I:function(o){var p=this,N=p._dataModel;N!==o&&(N&&(p.cs(),N.umm(p.handleDataModelChange,p)),p._dataModel=o,o.mm(p.handleDataModelChange,p,!0),p.fp(Ck,N,o))},dispose:function(){var o=this;o.cs(),o._dataModel.umm(o.handleDataModelChange,o)},handleDataModelChange:function(A){var S=this;if(A.kind===Ge){var F=A.data;S.co(F)&&(S._73O.remove(F),delete S._map[F._id],S._75I(Ge,new Pk(F)))}else A.kind===qb&&S.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(q){var e=this;if(e._filterFunc!==q){e.cs();var j=e._filterFunc;e._filterFunc=q,e.fp("filterFunc",j,e._filterFunc)}},_75I:function(K,V,q,j){q&&(this._73O.each(function(p){j[p._id]?q.remove(p):q.add(p)}),V=q.toList()),this._74I.fire({kind:K,datas:new Pk(V)})},addSelectionChangeListener:function(L,W,R){this._74I.add(L,W,R)},removeSelectionChangeListener:function(f,W){this._74I.remove(f,W)},_97O:function(l,M){for(var r,O=this,P=0,h=new Pk(l);P<h.size();P++)r=h.get(P),(O._filterFunc&&!O._filterFunc(r)||M&&O.co(r)||!M&&!O.co(r)||!O._dataModel.contains(r))&&(h.removeAt(P),P--);return h},appendSelection:function(Y){var a=this;if(a._68O!==to){var f,P,G=a._73O,D=a._97O(Y,!0);D.isEmpty()||(a.sg()&&(f=new Pk(G),P=a._map,G.clear(),a._map={},D=new Pk(D.get(D.size()-1))),D.each(function($){G.add($),a._map[$._id]=$}),a._75I("append",D,f,P))}},removeSelection:function(t){var C=this,n=C._97O(t),v=0,j=n.size();if(0!==j){for(;j>v;v++){var p=n.get(v);C._73O.remove(p),delete C._map[p._id]}C._75I(Ge,n)}},toSelection:function(m,W){return this._73O.toList(m,W)},getSelection:function(){return this._73O},each:function(j,I){this._73O.each(j,I)},setSelection:function(e){var I=this,h=I._73O;if(I._68O!==to&&!(h.isEmpty()&&!e||1===h.size()&&I.ld()===e)){var x=new Pk(h),n=I._map;h.clear(),I._map={};var c=I._97O(e,!0);I.sg()&&c.size()>1&&(c=new Pk(c.get(c.size()-1))),c.each(function(V){h.add(V),I._map[V._id]=V}),I._75I("set",w,x,n)}},clearSelection:function(){var n=this,b=n._73O;if(b.size()>0){var X=b.toList();b.clear(),n._map={},n._75I(qb,X)}},selectAll:function(){var G=this;if(G._68O!==to){var s,h,M=G._dataModel.toDatas();if(G._filterFunc)for(s=0;s<M.size();s++)h=M.get(s),G._filterFunc(h)||(M.removeAt(s),s--);var U=G._73O,f=new Pk(U),E=G._map;U.clear(),G._map={},G.sg()&&M.size()>1&&(M=new Pk(M.get(M.size()-1)));var F=M.size();for(s=0;F>s;s++)h=M.get(s),U.add(h),G._map[h._id]=h;G._75I("all",w,f,E)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(E){return this._map[E._id]!=w},getLastData:function(){var J=this._73O;return J.size()>0?J.get(J.size()-1):w},getFirstData:function(){var H=this._73O;return H.size()>0?H.get(0):w},isSelectable:function(Y){var k=this;return Y&&k._68O!==to?k._filterFunc?k._filterFunc(Y):!0:!1},getTopSelection:function(){var M=this,I=new Pk;return M._73O.each(function(Y){for(var L=Y.getParent();L;){if(M.contains(L)){Y=w;break}L=L.parent}Y&&I.add(Y)}),I}});var Zl=function(){return ui(0),function(P,z){var I;if(Oi(z)){var n=P.getDataUI(z);n&&n._88I&&(I=n._88I.rect)}return I?I:z.getRect()}}();xl(Y,{edgeGroupAgentFunc:w,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:e.rectSelectBorder,graphViewRectSelectBackground:Od,graphViewEditPointSize:re?17:7,graphViewEditPointBorderColor:e.editPointBorder,graphViewEditPointBackground:e.editPointBackground,setEdgeType:function(V,J,z){hg[V]=J,$q[V]=z},getEdgeType:function(U){return hg[U]},getEdgeTypeMap:function(){return hg},getNodeRect:Zl},!0);var Yj={"layout.h":r,"layout.v":r,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":r,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:r,ingroup:!0,"body.color":r,"2d.gray":!1,fullscreen:r,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:r,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":nj,"select.width":1,"select.padding":2,"select.type":ki,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":nj,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":r,"border.width":2,"border.padding":2,"border.type":ki,label:r,"label.font":r,"label.color":Cr,"label.background":r,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":r,"label.max":r,"label.opacity":r,"label.scale":1,"label.align":r,"label.selectable":!0,label2:r,"label2.font":r,"label2.color":Cr,"label2.background":r,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":r,"label2.max":r,"label2.opacity":r,"label2.scale":1,"label2.align":r,"label2.selectable":!0,note:r,"note.expanded":!0,"note.font":r,"note.color":mf,"note.background":nj,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":r,"note.toggleable":!0,"note.border.width":1,"note.border.color":r,"note.opacity":r,"note.scale":1,"note.align":r,note2:r,"note2.expanded":!0,"note2.font":r,"note2.color":mf,"note2.background":nj,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":r,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":r,"note2.opacity":r,"note2.scale":1,"note2.align":r,"group.type":r,"group.image":r,"group.image.stretch":"fill","group.repeat.image":r,"group.border.repeat.image":r,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":r,"group.title.color":mf,"group.title.background":e.groupTitleBackground,"group.title.align":vq,"group.title.orientation":rd,"group.background":e.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":r,"group.border.color":Xl,"group.border.radius":r,"group.border.cap":zn,"group.border.join":nf,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":w,"group.gradient.color":"#FFF",shape:r,"shape.background":Xl,"shape.repeat.image":r,"shape.border.repeat.image":r,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Xl,"shape.border.3d":!1,"shape.border.3d.color":r,"shape.border.3d.accuracy":r,"shape.border.cap":zn,"shape.border.join":nf,"shape.border.pattern":r,"shape.gradient":w,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":rk,"shape.dash.offset":0,"shape.dash.color":Xh,"shape.dash.width":r,"shape.dash.3d":!1,"shape.dash.3d.color":r,"shape.dash.3d.accuracy":r,"shape.polygon.side":6,"shape.arc.from":g,"shape.arc.to":c,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":r,"shape.gradient.pack":r,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":r,"shape.foreground.gradient":w,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":r,"autolayout.hgap":r,"autolayout.vgap":r,"edge.type":r,"edge.points":r,"edge.segments":r,"edge.color":Xl,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":r,"edge.3d.accuracy":r,"edge.cap":zn,"edge.join":nf,"edge.source.position":17,"edge.source.anchor.x":r,"edge.source.anchor.y":r,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":r,"edge.target.anchor.y":r,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":r,"edge.dash":!1,"edge.dash.pattern":rk,"edge.dash.offset":0,"edge.dash.color":Xh,"edge.dash.width":r,"edge.dash.3d":!1,"edge.dash.3d.color":r,"edge.dash.3d.accuracy":r,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":r,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":r,"grid.column.percents":r,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":e.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":e.gridCellBorderColor,"grid.block":r,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":e.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Cr,"text.gradient.pack":r,"text.font":iq,"text.shadow":!1,"text.shadow.color":nj,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,keepPosition:!0};Yj[cn]=r,xl(V,Yj,!0),xl(Rb,{_76I:function(w,U,g){this._39I&&this._39I.fire({data:w,oldIndex:U,newIndex:g})},addIndexChangeListener:function(i,B,g){var X=this;X._39I||(X._39I=new hh),X._39I.add(i,B,g)},removeIndexChangeListener:function(e,Z){this._39I.remove(e,Z)},prepareRemove:function(D){Dn(D)&&(D.setSource(w),D.setTarget(w)),D._70O&&D._70O.toList().each(this.remove,this),D._69O&&D._69O.toList().each(function(V){V.setHost(w)}),D._host&&D.setHost(w)},onAdded:function(Q){this.isAutoAdjustIndex()&&this.adjustIndex(Q)},onDataPropertyChanged:function(i,O){Af[O.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(i)},isAdjustable:function($){return Km($)||Dn($)},isAdjustedToBottom:function(C){return Qq(C)?C.isExpanded()&&ge(C):!1},adjustIndex:function(W){var Y=this;this.isHierarchicalRendering()||(Y.isAdjustedToBottom(W)?(Y.sendToBottom(W),W.eachChild(Y.adjustIndex,Y)):Y.sendToTop(W))},sendToTop:function(J){var S=this;if(S.contains(J)&&S.isAdjustable(J)){var h=S._datas;if(J!==h.get(S.size()-1)){var p=h.indexOf(J);h.removeAt(p),h.add(J),S._76I(J,p,S.size()-1)}if(Dn(J)){var U=J._40I;U&&!S.isAdjustedToBottom(U)&&S.sendToTop(U),U=J._41I,U&&!S.isAdjustedToBottom(U)&&S.sendToTop(U)}J._69O&&J._69O.each(function(i){i.isRelatedTo(J)||Km(J)&&i.isLoopedHostOn(J)||S.sendToTop(i)}),J.ISubGraph||(!Qq(J)||J.isExpanded())&&J._adjustChildrenToTop&&J.eachChild(function(s){Dn(s)||S.sendToTop(s)})}},sendToBottom:function(J,z){var d=this;if(J!==z&&d.contains(J)&&d.isAdjustable(J)&&(!z||d.contains(z))){var f=d._datas,B=f.remove(J),Q=z?d._datas.indexOf(z):0;if(f.add(J,Q),B!==Q){d._76I(J,B,Q);var u=J._parent;!u||u.ISubGraph||Dn(u)||d.sendToBottom(J._parent,J)}}}}),xl(Jo,{ms_edit:function(n){n._46O=function(L){var N=this,Y=N.gv.dm(),s=N._index,u=N._89I,e=N._node,R=N._shape,k=N._edge,C=N._77I;e&&u?(this.fi({kind:"endEditRect",event:L,data:e,direction:u}),Y.endTransaction()):R&&s>=0?(N.fi({kind:"endEditPoint",event:L,data:R,index:s}),Y.endTransaction()):k&&s>=0?(N.fi({kind:"endEditPoint",event:L,data:k,index:s}),Y.endTransaction()):C&&(N.fi({kind:"endEditRotation",event:L,data:C}),Y.endTransaction())},n._78I=function(a){var H=this;H.autoScroll(a);var A=H.gv.lp(a),l=H._index,j=H._89I,s=H._node,X=H._shape,G=H._edge,m=H._77I;if(s&&j)H._80O(A),H.fi({kind:"betweenEditRect",event:a,data:s,direction:j});else if(X&&l>=0)A.e=X.getPoints().get(l).e,X.setPoint(l,A),H.fi({kind:"betweenEditPoint",event:a,data:X,index:l});else if(G&&l>=0){var L=G.s(cs);A.e=L.get(l).e,L.set(l,A),G.fp(cs,w,L),H.fi({kind:"betweenEditPoint",event:a,data:G,index:l})}else if(m){var Z=m.p(),D=m.getScale(),R=T+K(A.y-Z.y,A.x-Z.x);D.y<0&&(R+=g),J(R)<.04&&(R=0),m.setRotation(R),H.fi({kind:"betweenEditRotation",event:a,data:m})}},n._80O=function(Z){var G=this,T=G._node,f=G._rect,_=f.x,X=f.y,r=f.width,w=f.height,N=G._89I,q=G._anchor,o=G._matrix,Z=o.tfi(Z);"northwest"===N?f=ln(Z,{x:_+r,y:X+w}):N===ai?f=ln({x:_,y:Z.y},{x:_+r,y:X+w}):"northeast"===N?f=ln({x:_,y:Z.y},{x:Z.x,y:X+w}):N===Ad?f=ln({x:Z.x,y:X},{x:_+r,y:X+w}):N===zj?f=ln({x:_,y:X},{x:Z.x,y:X+w}):"southwest"===N?f=ln({x:Z.x,y:X},{x:_+r,y:Z.y}):"south"===N?f=ln({x:_,y:X},{x:_+r,y:Z.y}):"southeast"===N&&(f=ln({x:_,y:X},Z)),T.setPosition(o.tf(f.x+f.width*q.x,f.y+f.height*q.y)),T.setWidth(f.width),T.setHeight(f.height)},n._80I=function(M,A,W,o){var D=this,P=D.gv._zoom,V=(D.gv.getEditPointSize()+2)/P;return Vb({x:A-V/2,y:W-V/2,width:V,height:V},M)?(D._89I!==o&&(D._89I=o),!0):!1},n._79I=function(e,J,h){var c=this,j=c.gv,B=J?j.getDataUI(J):w,T=B?B._55O:w;if(T){var $,R,n,l,W=j._zoom,S=(j.getEditPointSize()+2)/W,o=j.lp(e);if(Km(J)){if(T._56O&&Km(J)&&(R=T._98o,Vb({x:R.x-S/2,y:R.y-S/2,width:S,height:S},o)))return c._77I=J,h&&c.fi({kind:"beginEditRotation",event:e,data:J}),c.setCursor("crosshair"),!0;if(T._43O&&J instanceof gj)for(n=J.getPoints(),$=n.size()-1;$>=0;$--)if(R=n.get($),Vb({x:R.x-S/2,y:R.y-S/2,width:S,height:S},o))return c._index=$,c._shape=J,h&&c.fi({kind:"beginEditPoint",event:e,data:J,index:$}),c.setCursor("crosshair"),!0;if(T._42O)for(var U=J.getEditControlPoints(),m=["northwest",-1,-1,Ad,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,zj,1,0,"northeast",1,-1,ai,0,-1],$=0,l=U.length;l>$;$++){var b=m[3*$],z=U[$];if(c._80I(o,z.x,z.y,b)){c._node=J;var v=J.getWidth(),E=J.getHeight(),L=J.getAnchor();c._rect={x:-v*L.x,y:-E*L.y,width:v,height:E},c._anchor=L,c._matrix=J.getMatrix();var _=J.getRotation(),x=f(_),N=O(_),F=m[3*$+1]*Mh(J.getScale().x),I=m[3*$+2]*Mh(J.getScale().y),K=Math.atan2(-N*F-x*I,x*F-N*I),C=(Math.round(K/(Math.PI/4))+8)%8,i=[mm,"nesw-resize",Uj,"nwse-resize",mm,"nesw-resize",Uj,"nwse-resize"][C];return c.setCursor(i),h&&c.fi({kind:"beginEditRect",event:e,data:J,direction:c._89I}),!0}}}if(T._43O&&Dn(J)&&J.s(Th)===Tp&&(n=J.s(cs)))for($=n.size()-1;$>=0;$--)if(R=n.get($),Vb({x:R.x-S/2,y:R.y-S/2,width:S,height:S},o))return c._index=$,c._edge=J,h&&c.fi({kind:"beginEditPoint",event:e,data:J,index:$}),c.setCursor("crosshair"),!0}return!1}},ms_gv:function(c){c._currentSubGraph=w,c._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},c.upSubGraph=function(){this.setCurrentSubGraph(ks(this._currentSubGraph))},c.isVisible=function(j){var X=this;if(ks(j)!==X._currentSubGraph)return!1;if(Dn(j)){var E=j._40I,_=j._41I;if(!E||!_)return!1;if(!(j.s("edge.independent")||X.isVisible(E)&&X.isVisible(_)))return!1;if(j.isEdgeGroupHidden())return!1}else for(var O=j._parent;O&&!O.ISubGraph;){if(Qq(O)&&(!O.isExpanded()||!X.isVisible(O)))return!1;O=O._parent}if(j._parent instanceof So&&!X.isVisible(j._parent))return!1;if(j._refGraph instanceof sh&&!X.isVisible(j._refGraph))return!1;if(X instanceof $p){if(!j.s("3d.visible"))return!1}else{var N=X.getLayersInfo();if(N){var G=N[j._layer];if(G&&G.visible===!1)return!1}if(!j.s("2d.visible"))return!1}return X._visibleFunc?X._visibleFunc(j):!0},c.handleSelectionChange=function(T){var q=this;T.datas.each(function(r){q.invalidateData(r);var O=r._parent;Qq(O)&&Km(r)&&r.s($e)&&(q.invalidateData(O),O._49I&&O._49I.each(function(z){q.invalidateData(z)}))}),q.onSelectionChanged(T)},c.onSelectionChanged=function(Y){var i=this,b=i.sm();if(1===b.size()&&("set"===Y.kind||"append"===Y.kind)){var Z=b.ld();i.isAutoMakeVisible()&&i.makeVisible(Z),i.adjustIndex&&i._dataModel.isAutoAdjustIndex()&&i.adjustIndex(Z)}},c.makeVisible=function(q){if(q){var A=this,e=A.getDataUI?A.getDataUI(q):A.getData3dUI(q);if(e){var i=q,L=ks(q);for(L!==A._currentSubGraph&&A.setCurrentSubGraph(L);(i=i._parent)&&i!==L;)Qq(i)&&i.setExpanded(!0);A._23I=q,A.iv()}}},c.getLabel=function(O){var n=O.getStyle(Ij);return n===r?O.getName():n},c.getLabelBackground=function($){return $.getStyle("label.background")},c.getLabelColor=function(T){return T.getStyle("label.color")},c.getLabel2=function(x){return x.getStyle("label2")},c.getLabel2Background=function(L){return L.getStyle("label2.background")},c.getLabel2Color=function(g){return g.getStyle("label2.color")},c.getNote=function(M){return M.getStyle(uh)},c.getNoteBackground=function(b){return b.getStyle("note.background")},c.getNote2=function(T){return T.getStyle(Rd)},c.getNote2Background=function(y){return y.getStyle("note2.background")},c.handleClick=function(E,r,D){var x=this;r?(x.fi({kind:"clickData",event:E,data:r,part:D}),x.onDataClicked(r,E)):(x.fi({kind:"clickBackground",event:E}),x.onBackgroundClicked(E))},c.handleDoubleClick=function(U,O,i){var L=this;yf(U)&&(O?(L.fi({kind:"doubleClickData",event:U,data:O,part:i}),L.onDataDoubleClicked(O,U,i),L.checkDoubleClickOnNote(U,O,i)||L.checkDoubleClickOnRotation&&L.checkDoubleClickOnRotation(U,O,i)||(Dn(O)?L.onEdgeDoubleClicked(O,U,i):O.ISubGraph?L.onSubGraphDoubleClicked(O,U,i):Qq(O)?L.onGroupDoubleClicked(O,U,i):O.IDoorWindow?L.onDoorWindowDoubleClicked(O,U,i):O.ICSGBox&&L.onCSGBoxDoubleClicked(O,U,i))):(L.fi({kind:"doubleClickBackground",event:U}),L.onBackgroundDoubleClicked(U)))},c.onSubGraphDoubleClicked=function(O){this.setCurrentSubGraph(O)},c.onEdgeDoubleClicked=function(p,v){this.isEditable(p)||(p.ISubGraph&&!Xm(v)?this.setCurrentSubGraph(p):p.s("edge.toggleable")&&p.toggle())},c._39Q=function(k){return this.isInteractive(k)?this.preventDefaultWhenInteractive(k):!1},c.preventDefaultWhenInteractive=function(e){return e.s("preventDefaultWhenInteractive")},c.onGroupDoubleClicked=function(Y){Y.s("group.toggleable")&&Y.toggle()},c.onDoorWindowDoubleClicked=function(P){P.s("dw.toggleable")&&P.toggle(!0)},c.onCSGBoxDoubleClicked=function(t,g){var Q=this;if(Q instanceof $p){var l=Q.intersectObject(g,t);l&&t.s(l.part+".toggleable")&&t.toggleFace(l.part,!0)}},c.onBackgroundClicked=function(){},c.onBackgroundDoubleClicked=function(){this.upSubGraph()},c.onDataClicked=function(){},c.onDataDoubleClicked=function(){},c.onAutoLayoutEnded=function(){},c.onMoveEnded=function(){},c.onPanEnded=function(){},c.onPinchEnded=function(){},c.onRectSelectEnded=function(){},c.onZoomEnded=function(){},c.serialize=function(Z){return this.dm().serialize(Z)},c.toJSON=function(){return this.dm().toJSON()},c.deserialize=function(B,v){var R=this;v=v instanceof Xo?{rootParent:v}:Of(v)?{setId:v}:Ln(v)?{finishFunc:v}:v||{},v.view=R;var m=R.dm();return v.__innerHandler__=function(h){if(Of(m.a("toolTipEnable"))&&(m.a("toolTipEnable")?R.enableToolTip():R.disableToolTip()),R instanceof s.graph.GraphView&&(Of(m.a("zoomable"))&&R.setZoomable&&R.setZoomable(m.a("zoomable")),Of(m.a("pannable"))&&R.setPannable&&R.setPannable(m.a("pannable")),Of(m.a("rectSelectable"))&&R.setRectSelectable&&R.setRectSelectable(m.a("rectSelectable")),m.a("fitContent")===!0&&R.fitContent&&R.fitContent(!0,0)),R instanceof s.graph3d.Graph3dView){var q=h.scene;q&&q.shadow!=w&&R.shadowMap.setShadow(q.shadow,q.shadowParams);var Y=m.a("sceneContext");Y?(Y.eye&&R.setEye(Y.eye),Y.center&&R.setCenter(Y.center),wn(Y.far)&&R.setFar(Y.far),wn(Y.near)&&R.setNear(Y.near)):(wn(m.a("sceneNear"))&&R.setNear(m.a("sceneNear")),wn(m.a("sceneFar"))&&R.setFar(m.a("sceneFar")),q&&(q.eye&&R.setEye(q.eye),q.center&&R.setCenter(q.center))),Of(m.a("sceneShadowEnabled"))&&(m.a("sceneShadowEnabled")?R.enableShadow():R.disableShadow()),m.a("sceneShadowDegreeX")&&R.setShadowDegreeX(m.a("sceneShadowDegreeX")),m.a("sceneShadowDegreeZ")&&R.setShadowDegreeZ(m.a("sceneShadowDegreeZ")),m.a("sceneShadowIntensity")&&R.setShadowIntensity(m.a("sceneShadowIntensity")),m.a("sceneShadowQuality")&&R.setShadowQuality(m.a("sceneShadowQuality")),m.a("sceneShadowType")&&R.setShadowType(m.a("sceneShadowType")),m.a("sceneShadowRadius")&&R.setShadowRadius(m.a("sceneShadowRadius")),m.a("sceneShadowBias")&&R.setShadowBias(m.a("sceneShadowBias")),Of(m.a("sceneDashEnable"))&&R.setDashDisabled(!m.a("sceneDashEnable")),ap(m.a("sceneHighlightMode"))&&R.setHighlightMode(m.a("sceneHighlightMode")),wn(m.a("sceneHighlightWidth"))&&R.setHighlightWidth(m.a("sceneHighlightWidth")),m.a("sceneHighlightColor")&&R.setHighlightColor(m.a("sceneHighlightColor")),Of(m.a("sceneHeadlightEnable"))&&R.setHeadlightDisabled(!m.a("sceneHeadlightEnable")),wn(m.a("sceneHeadlightRange"))&&R.setHeadlightRange(m.a("sceneHeadlightRange")),m.a("sceneHeadlightColor")&&R.setHeadlightColor(m.a("sceneHeadlightColor")),wn(m.a("sceneHeadlightIntensity"))&&R.setHeadlightIntensity(m.a("sceneHeadlightIntensity")),wn(m.a("sceneHeadlightAmbientIntensity"))&&R.setHeadlightAmbientIntensity(m.a("sceneHeadlightAmbientIntensity")),Of(m.a("sceneFogEnable"))&&R.setFogDisabled(!m.a("sceneFogEnable")),m.a("sceneFogMode")&&R.setFogMode(m.a("sceneFogMode")),Of(m.a("sceneFogDensity"))&&R.setFogDensity(!m.a("sceneFogDensity")),m.a("sceneFogColor")&&R.setFogColor(m.a("sceneFogColor")),wn(m.a("sceneFogNear"))&&R.setFogNear(m.a("sceneFogNear")),wn(m.a("sceneFogFar"))&&R.setFogFar(m.a("sceneFogFar")),Of(m.a("sceneBatchBrightnessDisabled"))&&R.setBatchBrightnessDisabled(m.a("sceneBatchBrightnessDisabled")),Of(m.a("sceneBatchBlendDisabled"))&&R.setBatchBlendDisabled(m.a("sceneBatchBlendDisabled")),Of(m.a("sceneBatchColorDisabled"))&&R.setBatchColorDisabled(m.a("sceneBatchColorDisabled")),m.a("sceneBatchInfoMap")&&R.setBatchInfoMap(m.a("sceneBatchInfoMap")),wn(m.a("sceneMoveStep"))&&R.setMoveStep(m.a("sceneMoveStep")),wn(m.a("sceneRotateStep"))&&R.setRotateStep(m.a("sceneRotateStep"));var X=m.a("sceneSkyboxType")||"sphere";if(X!=w){var j={},u=!1;if("sphere"===X){j.shape3d=X;var e=m.a("sceneSkyboxImage");e&&(j["shape3d.image"]=e,u=!0)}else j.shape3d=r,["front","back","left","right","top","bottom"].forEach(function(S){var I=S+".image",k=S.charAt(0).toUpperCase()+S.slice(1),w=m.a("sceneSkybox"+k+"Image");w&&(j[I]=w,u=!0)});if(u){var C=new Wd;C.s3(20,20,20),j["body.color"]=m.a("sceneSkyboxBodyColor"),j.envmap=m.a("sceneSkyboxEnvmap"),j.light=!1,j["texture.wrap"]="clampToEdge",C.s(j),["X","Y","Z"].forEach(function(X){var p=m.a("sceneSkyboxRotation"+X);wn(p)&&C["setRotation"+X](p)}),R.setSkybox(C)}}}},m.deserialize(B,v.rootParent,v)},c.isDebugTipShowing=function(){return!!this._debugDiv},c.showDebugTip=function(){var L=this,M=L._debugDiv;if(!M){M=L._debugDiv=A.createElement("div"),M.style.position="absolute",M.style.overflow="hidden",M.style.font=Y.debugTipLabelFont,M.style.padding="6px",M.style.backgroundColor=Y.debugTipBackground,M.style.color=Y.debugTipLabelColor;
var r=L.getView();L._79O?r.insertBefore(M,L._79O):r.appendChild(M);var D=function(){L.redraw();var e=L._canvas,Z="FPS: "+L._fpsInfo.fps+"<br/>"+"Datas: "+L.dm().getDatas().length+(e?"<br/>Size: "+e.width+" * "+e.height:""),k=L.dm()._historyManager;k&&(Z+="<br/>Undoes: "+k.getHistories().length+" index: "+k.getHistoryIndex());var Q=L.getDebugTip();Q&&(Z+="<hr>"+Q),M.innerHTML=Z,L._isDebugging&&requestAnimationFrame(D)};requestAnimationFrame(D),L._isDebugging=!0}},c.hideDebugTip=function(){var D=this,y=D._debugDiv;y&&(delete D._debugDiv,D.getView().removeChild(y),D._isDebugging=!1)},c.updateDOMAppendMatrix=function(){var J=this.getView();J&&(J.updateAppendMatrix=!0)},c.countFrame=function(){if(this._isDebugging){var f=Date.now(),l=this._fpsInfo;f-l.time>1e3?(l.fps=Math.round(1e5*(l.frames+1)/(f-l.time))/100,l.time=f,l.frames=0):l.frames++}}},ms_icons:function(r){r.getRotation=function(O){return O==w?0:O},r._15O=function(){var Q=this,T=Q.s(li);if(T){var t=Q,D=Q.data||Q._data,r=Q._38o={icons:T,rects:{}};for(var q in T){var I=T[q],B=Pb(I.shape3d,D,t);if(!(Pb(I.visible,D,t)===!1||Pb(I.for3d,D,t)&&!Q.I3d||B&&!Q.I3d)){var K=B?[B]:Pb(I.names,D,t),V=K?K.length:0,p=Pb(I.position,D,t)||3,U=Pb(I.offsetX,D,t)||0,u=Pb(I.offsetY,D,t)||0,s=Pb(I.direction,D,t)||zj,J=Pb(I.gap,D,t),f=J!=w?J:1,z=Pb(I.rotation,D,t),j=Pb(I.keepOrien,D,t),W=Pb(I.rotationFixed,D,t)?z:Q.getRotation(z,j,p),Y=w,R=r.rects[q]=new Array(V);R.rotation=W;for(var m=0;V>m;m++){var y,d,E,N,h=K[m];if(B)E=0,N=0;else{var L=Ub(h);E=Pb(I.width,D,t),N=Pb(I.height,D,t),E==w&&(E=To(L,D)),N==w&&(N=md(L,D))}if(Y?s===zj?U+=E/2:s===Ad?U-=E/2:s===ai?u-=N/2:u+=N/2:Y={width:E,height:N},Q.I3d){var n=-E/2,S=-N/2;d={width:E,height:N,mat:Q._16O(Pb(I.autorotate,D,t),p,Y,Pb(I.face,D,t)||_j,Pb(I.t3,D,t),Pb(I.r3,D,t),Pb(I.rotationMode,D,t),U,u),vs:new vg([n,-S,0,n,-S-N,0,n+E,-S-N,0,n+E,-S,0])}}else y=Q.getPosition(p,U,u,Y,Pb(I.positionFixed,D,t)),d={x:y.x-E/2,y:y.y-N/2,width:E,height:N},Q._68o(d,W);R[m]=d,s===zj?U+=E/2+f:s===Ad?U-=E/2+f:s===ai?u-=N/2+f:u+=N/2+f}}}}}}});var ur={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},rs={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Zp={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Af={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ae={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},wh={"edge.type":1,"edge.group":1},vl={rotation:1,rotationX:1,rotationZ:1},Db={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},is={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Gl={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Qd={shape:1,thickness:1,position:1,anchor:1,scale:1},ks=function(b){if(!b)return w;if(Dn(b)){var q=b._40I,B=b._41I;if(!q||!B)return w;var n=ks(q),l=ks(B);return n===l?n:w}for(var h=b._parent;Dn(h)&&!h.ISubGraph;)h=h._parent;return h?h.ISubGraph?h:ks(h):w},hm=function(P,k,y,g){var r=k.getStyle(y)*g;r&&xg(P,r),r=k.getStyle(y+".left")*g,r&&(P.x-=r,P.width+=r),r=k.getStyle(y+".right")*g,r&&(P.width+=r),r=k.getStyle(y+".top")*g,r&&(P.y-=r,P.height+=r),r=k.getStyle(y+".bottom")*g,r&&(P.height+=r),P.width<0&&(P.width=-P.width,P.x-=P.width),P.height<0&&(P.height=-P.height,P.y-=P.height)},ge=function(b){for(var P,Q=0,v=b.size();v>Q;Q++)if(P=b.getChildAt(Q),Km(P)&&ge(P))return!0;return b.hasAgentEdges()},Rf=function(f){if(!f)return w;for(var B=f._parent;Qq(B);){if(!Qq(B._parent))return B.isExpanded()?f:B;B.isExpanded()||(f=B),B=B._parent}return f},Do=function(j,r){if(!j||!r)return w;var e,Y,H,T=ks(j),t=ks(r);if(T!==t){for(;t&&T!==t;)t=ks(t);if(T===t)return j;e=new Pk,e.add(j,0);for(var q=j._parent;Km(q)&&!r.isDescendantOf(q);)e.add(q,0),q=q._parent;for(H=e.size(),Y=0;H>Y;Y++){var U=e.get(Y);if(Qq(U)&&!U.isExpanded())return U;if(U.ISubGraph)return U}return j}return j},vp=function(i){if(i.isLooped())return i._source;var U=Rf(i._source),M=Rf(i._target);return U===M?i._source:Do(U,M)},jb=function(h){if(h.isLooped())return h._target;var g=Rf(h._source),V=Rf(h._target);return g===V?h._target:Do(V,g)},Ng=function(u,t,V){"target"!==V&&(V="source");var q="target"===V?t.getTargetAgent():t.getSourceAgent(),y="edge."+V+".";if(Dn(q)){var I=u.getDataUI(q);I._79o();var U=t.s(y+"index");if(U>=0){var F=vk(I);return F[Math.max(0,Math.min(U,F.length-1))]}var H=t.s(y+"percent")||0;H=Math.max(0,Math.min(H,1));var d=il(I);return as(d,100*H)}return fo(u,q,t.s(y+"position"),t.s(y+"offset.x"),t.s(y+"offset.y"),t.s(y+"anchor.x"),t.s(y+"anchor.y"))},fo=function(e,R,U,D,M,_,q){if(!R)return w;var p,b=R.getRotation?R.getRotation():0;if(_!==r||q!==r){_=_===r?.5:_,q=q===r?.5:q;var i=R.getScale();if(b&&!Oi(R,e)||i.x<0||i.y<0){var v=R.getPosition(),x=R.getWidth(),J=R.getHeight(),Q=R.getAnchor(),c=new $r(b,v.x,v.y,i.x,i.y);U=c.tf((_-Q.x)*x,(q-Q.y)*J)}else p=Zl(e,R),U={x:p.x+_*p.width,y:p.y+q*p.height}}else U=Cm(U,Zl(e,R));if(b){var P=f(b),o=O(b),A=D*P-M*o;M=D*o+M*P,D=A}return U.x+=D,U.y+=M,U},_e=function(Q,O){if(!Q||!O)return w;var u,z,e,Z,n,y;if(Q===O){if(Z=Q.getLoopedEdges(),!Z)return w;Z=new Pk(Z)}else{if(n=Q.getAgentEdges(),y=O.getAgentEdges(),!n||!y)return w;for(z=n.size(),u=0;z>u;u++)e=n.get(u),y.contains(e)&&(Z||(Z=new Pk),Z.add(e))}if(Z)for(u=0;u<Z.size();u++)e=Z.get(u),e.getStyle(Th)===Tp&&(e._22I(w),Z.removeAt(u),u--);return Z},Bj=function(b,o){var X=_e(b,o);if(X&&!X.isEmpty()){if(1===X.size())return X.get(0)._22I(w),void 0;var I=new Pk,a=new Pk;X.each(function(o){var r=o.s("edge.group");I.contains(r)||I.add(r)}),I.sort(),I.each(function(o){a.add(new s.EdgeGroup(X.toList(function(s){return o===s.s("edge.group")}),a))}),a.each(function(j){j.each(function(L){L._22I(j)})})}},ps=function(H,U,S){var a=H._canvas;H._zoom;var u=bc(U,a),l=bc(S,a);return{x:u.x-l.x,y:u.y-l.y}},_c=function(v,P){if(P){var B=P.rect,$=P.color,J=P.rotation,D=P.labelWidth,Q=P.background,C=P.opacity,l=P.scale,Y=l!=w&&1!==l;if(C!=w){var K=v.globalAlpha;v.globalAlpha*=C}if(J||Y){v.save();var Z=B.x+B.width/2,F=B.y+B.height/2;Hn(v,Z,F),J&&An(v,J),Y&&v.scale(l,l),Hn(v,-Z,-F)}if(Q&&pb(v,B.x,B.y,B.width,B.height,Q),D){var T=B.width,V=v.createLinearGradient(B.x,B.y,B.x+T,B.y);V.addColorStop(0,$),V.addColorStop(.9,$),V.addColorStop(1,Xn),$=V,B.width=D}tq(v,P.ss,B,P.font,$,P.align),D&&(B.width=T),(J||Y)&&v.restore(),C!=w&&(v.globalAlpha=K)}},Jg=function(B,f){if(f){var _=f.rect,o=_.x,Z=_.y,W=_.width,h=_.height,M=f.background,s=f.backgroundImage,k=f.borderWidth,m=f.borderColor,P=f.labelWidth,A=f.opacity,E=f.scale,q=E!=w&&1!==E;if(A!=w){var i=B.globalAlpha;B.globalAlpha*=A}if(q){B.save();var x=_.x+_.width/2,O=_.y+_.height/2;Hn(B,x,O),B.scale(E,E),Hn(B,-x,-O)}if(f.expanded){var D=X(8,W/4),r=Z+h-8;if(B.fillStyle=M,B.beginPath(),B.moveTo(o,Z),B.lineTo(o,r),B.lineTo(o+W/2,r),B.lineTo(o+W/2,Z+h),B.lineTo(o+W/2+D,r),B.lineTo(o+W,r),B.lineTo(o+W,Z),B.closePath(),B.fill(),k&&(B.lineWidth=k,B.lineJoin="round",B.lineCap="round",m?(B.strokeStyle=m,B.stroke()):(B.strokeStyle=hf(M),B.beginPath(),B.moveTo(o+W,Z),B.lineTo(o+W,r),B.lineTo(o+W/2+D,r),B.lineTo(o+W/2,Z+h),B.stroke(),B.strokeStyle=tn(M),B.beginPath(),B.moveTo(o+W,Z),B.lineTo(o,Z),B.lineTo(o,r),B.lineTo(o+W/2,r),B.lineTo(o+W/2,Z+h),B.stroke())),s)Pr(B,Ub(s),ef,_.x,_.y,_.width,_.height-8,f.data,f.view);else{if(_.height-=8,M=f.color,P){var N=W,e=B.createLinearGradient(o,Z,o+N,Z);e.addColorStop(0,M),e.addColorStop(.9,M),e.addColorStop(1,Xn),M=e,_.width=P}tq(B,f.ss,_,f.font,M,f.align),P&&(_.width=N),_.height+=8}}else if(f.icon)El(B,Ub(f.icon),o,Z,W,h,f.data,f.view);else{var b=W/2;k&&(B.lineWidth=k,B.lineJoin="round",B.lineCap="round",B.strokeStyle=m?m:hf(M),B.beginPath(),B.arc(o+b,Z+b,b,T,1.6*g,!0),B.moveTo(o+b,Z+h),B.lineTo(o+W-b/5,Z+b),B.stroke(),B.strokeStyle=m?m:tn(M),B.beginPath(),B.arc(o+b,Z+b,b,1.6*g,T,!0),B.moveTo(o+b,Z+h),B.lineTo(o+b/5,Z+b),B.stroke()),B.fillStyle=M,B.beginPath(),B.arc(o+b,Z+b,b,0,c,!0),B.moveTo(o+b,Z+h),B.lineTo(o+W-b/5,Z+b),B.lineTo(o+b/5,Z+b),B.closePath(),B.fill(),B.fillStyle=f.color,B.beginPath(),B.arc(o+b,Z+b,b/3,0,c,!0),B.fill()}q&&B.restore(),A!=w&&(B.globalAlpha=i)}},ed=function(W,j){return j>2*W?W:j/2},Sk=function(C,N,x,M){if(!C||!N)return 0;var n=K(N.y-C.y,N.x-C.x);return x||(n=N.x<C.x?n+g:n),n+M},Tj=function(r,h,F,k,t,d,l){l&&(r.x>h.x||r.x===h.x&&r.y>h.y)&&(F=Uc[F],t=-t);var j=Cm(F,{x:0,y:0,width:qd(r,h),height:0},d);return j.x+=k,j.y+=t,j=new $r(K(h.y-r.y,h.x-r.x)).tf(j),j.x+=r.x,j.y+=r.y,j},Ci=function(w,W,X,_,o){if(w._19Q=!0,!X.getEdgeGroup())return _?X.s("edge.gap"):0;if(Dn(X.getSourceAgent())||Dn(X.getTargetAgent()))return 0;var I,x=0,z=0,j=0;if(X.getEdgeGroup().getSiblings().each(function(E){E.each(function(T){if(W.isVisible(T)&&T.s(Th)==o){var h=T.s("edge.gap");I?(z+=j/2+h/2,j=h):(I=T,j=h),T===X&&(x=z)}})}),_)return z-x+j;var J=x-z/2;return I&&X._40I!==I._40I&&(w._19Q=!1),J},Bc=function(){var R=function($){var f=[];return $.forEach(function(o){f.push({x:o.x,y:o.y}),f.push({x:o.x+o.width,y:o.y+o.height}),f.push({x:o.x+o.width,y:o.y}),f.push({x:o.x,y:o.y+o.height})}),f};return function(x,Q,I){if("oval"===x){var q=0,A=I.height/I.width,C=A*A,r=I.x+I.width/2,u=I.y+I.height/2,L=R(Q);L.forEach(function(E){var k=E.x-r,j=E.y-u,G=k*k+j*j/C;G>q&&(q=G)}),q=G(q);var $=A*q;return{x:r-q,y:u-$,width:2*q,height:2*$}}if("circle"===x){var B=0,r=I.x+I.width/2,u=I.y+I.height/2,L=R(Q);return L.forEach(function(I){var R=I.x-r,Y=I.y-u,m=R*R+Y*Y;m>B&&(B=m)}),B=G(B),{x:r-B,y:u-B,width:2*B,height:2*B}}return"roundRect"===x?(xg(I,X(I.width,I.height)/16),I):I}}(),Om=s.graph={},$j=function(Z,g,k){Ap(D+".graph."+Z,g,k)};s.layout={};var df={},xe=function(v,W,K,f,I,Q,S,z){var C=S._zoom;if(C!==S._cacheZoom&&(S._cacheZoom=C,S._cacheImage={}),C*=Co,f=Math.ceil(f*C),I=Math.ceil(I*C),f>2048||I>2048)return W;var T=[W.uuid,f,I,K].join("_");W.cacheRule&&(T+="_"+Pb(W.cacheRule,Q,S));var E=S._cacheImage[T];return E||(Wr(),E=s.Default.toCanvas(W,f,I,K,Q,S,z),di()&&(S._cacheImage[T]=E)),E};xl(Y,{setImageCacheRule:function(p,v){var N;v||"object"!=typeof p?(N={},N[p]=v):N=p;for(var q in N){var O=N[q];ap(q)?(Ap=Ub(q),Ap?Ap.cacheRule=O:df[q]=O):q.cacheRule=O}}});var zg={comps:[{type:ii,points:[85,50,70,115,100,71,86,107,88,49,57,77,82,99,116,99,114,79,109,49,50,98,86,101,68,71,52,98,105,70,81,98,53,66,72,113,100,98,103,87,103,43,111,61],borderWidth:1,borderColor:w}]};if(zg[rl]=zg[fc]=160,x.Image){var am=new x.Image;am.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",We("default_blank",am)}We("node_image",Pp(30,30,[{type:ki,rect:[4,5,22,16],gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[2,3,26,20],borderWidth:1,borderColor:Xl},{type:ki,rect:[11,23,8,4],background:Xl},{type:ki,rect:[6,27,18,2],background:Xl}])),We("node_icon",Pp(16,16,[{type:ki,rect:[2,2,12,10],gradient:Rg,gradientColor:Io,background:Xl},{type:wr,rect:[2,2,12,10],width:1,color:Xl},{type:ki,rect:[6,12,4,2],background:Xl},{type:ki,rect:[4,14,8,1],background:Xl}])),We("block_icon",Pp(16,16,[{type:wr,rect:[1,1,14,14],width:1,color:Xl}])),We("group_image",Pp(66,39,[{type:ki,rect:[44.3,18,18.1,12.8],gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[3.3,17.8,18.1,12.8],gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Xl,gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[26.2,29.4,12.8,4.2],background:Xl},{type:ki,rect:[21.3,33.5,22.5,2.3],background:Xl},{type:ki,rect:[5.3,32.7,14.1,2.1],background:Xl},{type:ki,rect:[9,30.4,6.7,2.4],background:Xl},{type:ki,rect:[50,30.7,6.7,2.4],background:Xl},{type:ki,rect:[46.3,33,14.1,2.1],background:Xl}])),We("group_icon",Pp(16,16,[{type:ki,rect:[4,12,4,2],background:Xl},{type:ki,rect:[2,13,8,1],background:Xl},{type:ki,rect:[12,12,2,1],background:Xl},{type:ki,rect:[11,13,4,1],background:Xl},{type:ki,rect:[10,7,6,5],gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[1,2,10,10],gradient:Rg,gradientColor:Io,background:Xl},{type:wr,rect:[1,2,10,10],width:1,color:Xl}])),We("refGraph_icon",Pp(16,16,[{type:"shape",borderWidth:1,borderColor:Xl,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Xl,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),We("edge_icon",Pp(16,16,[{type:ki,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[10.8,1,4,4],background:Xl},{type:ki,rect:[1,11,4,4],background:Xl}])),We("subGraph_image",Pp(72,45,[{type:ii,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[29.6,30.7,3.6,1.8],background:Xl},{type:ki,rect:[28.4,32.3,6,1.2],background:Xl},{type:ki,rect:[37.3,32,10.8,1.8],background:Xl},{type:ki,rect:[39.1,29.9,7.2,2.3],background:Xl},{type:ki,rect:[26.6,23.7,9.6,7.2],gradient:Rg,gradientColor:Io,background:Xl},{type:ki,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Xl,gradient:Rg,gradientColor:Io,background:Xl}])),We("subGraph_icon",Pp(17,17,[{type:ii,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Rg,gradientColor:Io,background:Xl}])),We("shape_icon",Pp(16,16,[{type:ii,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Xl}])),We("polyline_icon",Pp(16,16,[{type:ii,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Xl},tc(7.5,.4),tc(7.5,6.3),tc(13.6,6.3),tc(13.6,14),tc(.7,13.9),tc(.7,.3)])),We("grid_icon",Pp(16,16,[{type:ki,rect:[1,1,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[6,1,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[11,1,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[11,6,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[6,6,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[1,6,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[11,11,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[6,11,4,4],background:Xl,gradient:Rg,gradientColor:Io},{type:ki,rect:[1,11,4,4],background:Xl,gradient:Rg,gradientColor:Io}])),We("light_icon",Pp(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Xl},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Xl,gradient:Rg,gradientColor:Io,background:{func:function(S){var r=S?S.s(Vl):w;return wd(r)?"rgb("+Sq(255*r[0])+","+Sq(255*r[1])+","+Sq(255*r[2])+")":r||Xl}}}])),We("text_icon",Pp(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Xl}])),We("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),We("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),We("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),We("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Ki=function(x,D,L,b,I,y){var U,p,m,X,i,S,T,t,M,B,e,J=[];if(Math.abs(b)>2*Math.PI&&(b=2*Math.PI),i=Math.ceil(Math.abs(b)/(Math.PI/4)),U=b/i,p=-U,m=-L,i>0){S=x+Math.cos(L)*I,T=D+Math.sin(-L)*y,J.push({x:S,y:T});for(var h=0;i>h;h++)m+=p,X=m-p/2,t=x+Math.cos(m)*I,M=D+Math.sin(m)*y,B=x+Math.cos(X)*(I/Math.cos(p/2)),e=D+Math.sin(X)*(y/Math.cos(p/2)),J.push({x:B,y:e}),J.push({x:t,y:M})}return J},Vh=function(p){if(p){var k=p._data;if(k instanceof s.Shape)return{points:k.getPoints(),segments:k.getSegments()};var l;if(k instanceof s.Edge&&(l=p._78o)){var Y,$,Q=l.type,J=l.points,T=l.segments,u=l.edgeTypeInfo;if(!Q||J){var e=l.sourcePoint,M=e.x,B=e.y,F=l.targetPoint,q=F.x,I=F.y;if(Q)T?(Y=new Pk({x:M,y:B}),Y.addAll(J),Y.add({x:q,y:I}),$=new Pk(T._as)):(Y=new Pk({x:M,y:B}),J.each(function(C){Y.add(C)}),Y.add({x:q,y:I}));else if(l.looped){Y=new Pk(Ki(M,B,0,2*Math.PI,l.radius,l.radius)),$=new Pk([1]);for(var Z=0;Z<(Y.size()-1)/2;Z++)$.add(3)}else Y=new Pk,l.center?(Y.add({x:l.c1.x,y:l.c1.y}),Y.add({x:M,y:B}),Y.add({x:q,y:I}),Y.add({x:l.c2.x,y:l.c2.y})):(Y.add({x:M,y:B}),Y.add({x:q,y:I}))}else u&&(Y=new Pk(u.points._as),u.segments&&($=new Pk(u.segments._as)));return{points:Y,segments:$}}}},il=function(Z,t,b){if(null==t){var g=Vh(Z);if(!g)return;t=g.points,b=g.segments}if(t){if(Array.isArray(t)&&(t=new Pk(t)),"number"==typeof t.get(0)){for(var D=new s.List,e=0;e<t.size();e+=2)D.add({x:t.get(e),y:t.get(e+1)});t=D}if(!b){b=[1];for(var I=t.length-1;I>0;I--)b.push(2)}Array.isArray(b)&&(b=new Pk(b));for(var X=Fi(t._as,b._as,50),U=X.length,G=[],e=0;U>e;e++){var P=X[e];P.length>1&&G.push(P)}return G}},ak=function(Y){for(var z=0,o=Y.length-1,M=0;o>M;M++){var p=Y[M],g=Y[M+1],d=g.x-p.x,x=g.y-p.y;z+=Math.sqrt(d*d+x*x)}return z},Pi=function(m,i){for(var F=0,j=i.length,k=0;j>k;k++){var z=i[k];if(F+=z,F>m)return k}return Math.min(k,j-1)},lf=function(I,n){for(var B=0,c=0,J=0,X=I.length-1,K=0;X>K;K++){var h=I[K],a=I[K+1],A=a.x-h.x,N=a.y-h.y;if(J=Math.sqrt(A*A+N*N),B+=J,B>n){B-=J,c=K;break}}var U=I[c],b=I[c+1],P=Math.atan2(b.y-U.y,b.x-U.x),W=n-B,N=Math.sin(P)*W,A=Math.cos(P)*W;return{x:U.x+A,y:U.y+N}},as=function(o,w){if(o){var p;if(0===w)p=o[0][0];else if(100===w)o=o[o.length-1],p=o[o.length-1];else{for(var k=0,U=[],i=o.length,M=0;i>M;M++){var c=o[M],I=ak(c);k+=I,U.push(I)}for(var E=k*w/100,H=Pi(E,U),n=0,S=0;H>S;S++)n+=U[S];E-=n,p=lf(o[H],E)}return p}},vk=function(N){var u,q,H,o,I=Vh(N),h=[],D=I.points,K=I.segments,Z=-1;for(q=0,H=K?K.length:D.length;H>q;q++){if(u=K?K.get(q):1,3===u)o=2;else if(4===u)o=3;else{if(5===u)continue;o=1}Z+=o,h.push(D.get(Z))}return h},ne=function(J,P,D,M){function O(p){if(p>=0&&1>=p){q=P(p);var V=(J.x-q.x)*(J.x-q.x)+(J.y-q.y)*(J.y-q.y);return C>V?(C=V,y=p,!0):!1}}D=D||100,M=M||1e-5;for(var C=1/0,y=0,q=new Vq,A=0;D>A;++A)O(A/D);for(var r=1/(2*D);r>M;)O(y-r)||O(y+r)||(r/=2);return y};xl(Y,{_edgeProtectMethod:{getStraightLinePoints:il,calculateLineLength:ak,calcSegmentIndexByDistance:Pi,calculatePointAlongLine:lf,getPercentPosition:as,getRealPointsFromDataUI:vk}});var ld=function(Q,X){for(var b=Q.vertices,H=0;H<b.length;H++){var J=b[H],O=J.y;J.y=J.z,J.z=-O,X&&(J.y+=X)}},yj=function(B){for(var W,t,O,s,v,z,i=[],_=[],l=[],e=B.faces,E=0,k=0,J=0,Q=e.length;Q>E;E++,k+=6,J+=9){var r=e[E];1===r.i?(W||(W=[],t=[],O=[]),Aq(r,E,k,J,B,W,O,t)):2===r.i?(s||(s=[],v=[],z=[]),Aq(r,E,k,J,B,s,z,v)):Aq(r,E,k,J,B,i,l,_)}return{vs:i,uv:_,ns:l,top_vs:W,top_uv:t,top_ns:O,bottom_vs:s,bottom_uv:v,bottom_ns:z}},Aq=function(H,X,u,i,c,E,D,l){var K=c.vertices,F=c.faceVertexUvs,n=K[H.a],Y=K[H.b],U=K[H.c];E.push(n.x,n.y,n.z,Y.x,Y.y,Y.z,U.x,U.y,U.z);var L,B,b,z=H.vertexNormals;3===z.length?(L=z[0],B=z[1],b=z[2]):L=B=b=H.normal,D.push(L.x,L.y,L.z,B.x,B.y,B.z,b.x,b.y,b.z);var w=F[0][X][0],P=F[0][X][1],e=F[0][X][2];l.push(w.x,w.y,P.x,P.y,e.x,e.y)},gq=function(){function H(j,c){return j.dot(c)>0}function u(g,w,a,h,I,X,J){for(var s,v,k=[w,a,h],C=[I,X,J],U=[],r=k.length,d=!0;r--&&d;){for(var M=k[r],W=C.length,F=!1;W--;)if(M.equals(C[W])){C.splice(W,1),U.push(M),F=!0;break}if(!F){if(s){d=!1;break}s=M}}return d&&2===U.length&&(v=C[0],y.subVectors(s,U[0]),P.subVectors(v,U[0]),z.subVectors(s,U[1]),y.x*z.y*P.z+z.x*P.y*y.z+P.x*y.y*z.z-P.x*z.y*y.z-P.y*z.z*y.x-P.z*z.x*y.y<1e-6&&(S.subVectors(v,U[1]),n.subVectors(U[1],U[0]),H(n,y)&&H(n,P)&&(n.negate(),H(n,z)&&H(n,S))))?(g.push(U[1].x,U[1].y,U[1].z),g.push(s.x,s.y,s.z),g.push(s.x,s.y,s.z),g.push(U[0].x,U[0].y,U[0].z),g.push(U[0].x,U[0].y,U[0].z),g.push(v.x,v.y,v.z),g.push(v.x,v.y,v.z),g.push(U[1].x,U[1].y,U[1].z),2):(g.push(w.x,w.y,w.z),g.push(a.x,a.y,a.z),g.push(a.x,a.y,a.z),g.push(h.x,h.y,h.z),g.push(h.x,h.y,h.z),g.push(w.x,w.y,w.z),1)}function g(){this._vertexMap={},this._lineMap={},this._lineList=[]}function l(V,S,r,y,v,D,T){var C=[r,v];V[0]===y&&C.reverse();var A=[C[0]._key,C[1]._key].join("|"),i=V._triangles[A];i||(V._triangles[A]=i={});var F=[D._key,T._key].join("|");i[F]||(i[F]=[D,T])}function N(y,C,n){var H=y._planes[n._key];if(!H)for(var X in y._planes){var t=y._planes[X];if(t._normal.angleTo(n)<.001){H=t;break}}return H?(H._vertices.indexOf(C)<0&&H._vertices.push(C),void 0):(y._planes[n._key]={_normal:n,_vertices:[C]},void 0)}function j(w,k){return 0===k?"0|0|0":1/0===Math.abs(k)?[w.x,w.y,w.z].join("|"):[Math.round(U.angleTo(w)*k),Math.round(V.angleTo(w)*k),Math.round(s.angleTo(w)*k)].join("|")}function $(g,T){var t=g._ctlineModel;if(t||(g._ctlineModel=t=[]),t[0])return t[0];var y;y=wd(g)?g:[g];var n,P,e,A,E,q,i,I,z,S,O,B,L,$,j,H,K,k,s,h=["","top_","bottom_"];t=[];var R=[];for(Zi(y,T,R),n=0,P=R.length;P>n;n++)if(S=R[n])for(Gi(S),e=0,A=h.length;A>e;e++)if(z=S[h[e]+"lvs"])for(K=t.length,k=z.length,t.length=K+k,s=0;k>s;++s,++K)t[K]=z[s];else if(i=S[h[e]+"vs"]){I=S[h[e]+"is"],q=I?I.length:i.length/3;for(var E=0;q-1>E;)I?(O=I[E],B=I[E+1],L=I[E+2],$=I[E+3],j=I[E+4],H=I[E+5]):(O=E,B=E+1,L=E+2,$=E+3,j=E+4,H=E+5),o.fromArray(i,3*O),G.fromArray(i,3*B),x.fromArray(i,3*L),F.fromArray(i,3*$),C.fromArray(i,3*j),X.fromArray(i,3*H),E+=3*u(t,o,G,x,F,C,X);q>E&&(I?(O=I[E],B=I[E+1],L=I[E+2]):(O=E,B=E+1,L=E+2),o.fromArray(i,3*O),G.fromArray(i,3*B),x.fromArray(i,3*L),t.push(o.x,o.y,o.z),t.push(G.x,G.y,G.z),t.push(G.x,G.y,G.z),t.push(x.x,x.y,x.z),t.push(x.x,x.y,x.z),t.push(o.x,o.y,o.z))}return g._ctlineModel[0]=t,t}function t(R,H,b){var M=R._ctlineModel;M||(R._ctlineModel=M=[]);var u=M[1];if(u&&u.epsilon===b)return u;u=[],u.epsilon=b;var v;v=wd(R)?R:[R];var l,B,N,h,O,A,D,p,m,V,i,E,y=["","top_","bottom_"],F=new g,I=[];for(Zi(v,H,I),l=0,B=I.length;B>l;l++)if(m=I[l])for(Gi(m),N=0,h=y.length;h>N;N++)if(D=m[y[N]+"vs"]){p=m[y[N]+"is"],A=p?p.length:D.length/3;for(var O=0,O=0;A>O;O+=3)p?(V=p[O],i=p[O+1],E=p[O+2]):(V=O,i=O+1,E=O+2),F._addTriangle(D,r,V,i,E,b)}return F._toLineVS(u),R._ctlineModel[1]=u,u}function b(h,l,M){var A=h._ctlineModel;A||(h._ctlineModel=A=[]);var J=A[1];if(J&&J.epsilon===M)return J;J=[],J.epsilon=M;var s;s=wd(h)?h:[h];var B,U,W,m,j,R,Y,u,P,t,N,G,r,c=["","top_","bottom_"],f=new g,a=[];for(Zi(s,l,a),B=0,U=a.length;U>B;B++)if(t=a[B])for(Gi(t),W=0,m=c.length;m>W;W++)if(Y=t[c[W]+"vs"]){u=t[c[W]+"is"],P=t[c[W]+"ns"],R=u?u.length:Y.length/3;for(var j=0,j=0;R>j;j+=3)u?(N=u[j],G=u[j+1],r=u[j+2]):(N=j,G=j+1,r=j+2),f._addTriangle(Y,P,N,G,r,M)}return f._toLineVS(J),h._ctlineModel[2]=J,J}var o=new Zb,G=new Zb,x=new Zb,F=new Zb,C=new Zb,X=new Zb,y=new Zb,z=new Zb,P=new Zb,S=new Zb,n=new Zb,p=new Zb;g.prototype._findVertex=function(l,I){p.fromArray(l,3*I);var L=[p.x,p.y,p.z].join(","),P=this._vertexMap[L];if(!P){var Y=p.clone();Y._key=L,this._vertexMap[L]=P=Y}return P},g.prototype._findLine=function(O,M){var Q=[O,M];O._key>M._key&&Q.reverse(),Q._key=[Q[0]._key,Q[1]._key].join("|");var v=this._lineMap[Q._key];return v||(this._lineMap[Q._key]=v=Q,Q._triangles={},Q._planes={},this._lineList.push(Q)),v};var U=new Zb(1,0,0),V=new Zb(0,1,0),s=new Zb(0,0,1),f=new Zb,J=new Zb;return g.prototype._addTriangle=function(y,I,i,b,g,$){var d,Q,U,F=this._findVertex(y,i),M=this._findVertex(y,b),s=this._findVertex(y,g),R=this._findLine(F,M),O=this._findLine(M,s),E=this._findLine(s,F);I?(d=(new Zb).fromArray(I,3*i),d._key=j(d,$),Q=(new Zb).fromArray(I,3*b),Q._key=j(Q,$),U=(new Zb).fromArray(I,3*g),U._key=j(U,$),l(R,F,d,M,Q,s,U),l(O,M,Q,s,U,F,d),l(E,s,U,F,d,M,Q)):(J.subVectors(s,M),f.subVectors(M,F),d=(new Zb).crossVectors(f,J),d._key=j(d,$),N(R,s,d),N(O,F,d),N(E,M,d))},g.prototype._toLineVS=function(f){for(var i=this._lineList,y=0,p=i.length;p>y;++y){var _=i[y],O=!1;for(var H in _._triangles)if(1==R.keys(_._triangles[H]).length){f.push(_[0].x,_[0].y,_[0].z,_[1].x,_[1].y,_[1].z),O=!0;break}if(!O)for(var K in _._planes)if(1==_._planes[K]._vertices.length){f.push(_[0].x,_[0].y,_[0].z,_[1].x,_[1].y,_[1].z),O=!0;break}}},[$,t,b]}(),vh=function(l,j){var h=l._lineModel;if(h)return h;var S;S=wd(l)?l:[l];var L,q,o,v,p,B,V,t,k,e,Q,J,w=["","top_","bottom_"];h=[];var x=[];for(Zi(l,j,x),L=0,q=x.length;q>L;L++)if(k=x[L])for(o=0,v=w.length;v>o;o++)if(V=k[w[o]+"vs"]){t=k[w[o]+"is"],B=t?t.length:V.length/3;for(var p=0;B>p;p+=3)t?(e=t[p],Q=t[p+1],J=t[p+2]):(e=p,Q=p+1,J=p+2),e*=3,Q*=3,J*=3,h.push(V[e],V[e+1],V[e+2],V[Q],V[Q+1],V[Q+2],V[Q],V[Q+1],V[Q+2],V[J],V[J+1],V[J+2],V[J],V[J+1],V[J+2],V[e],V[e+1],V[e+2])}return l._lineModel=h,h},Ai=function(h,o,C,B,z,G,Y,U,H){C==w&&(C=!0),B==w&&(B=!0),Y==w&&(Y=1),U==w&&(U=0);var T=new cc;return bb(T,h,o,H),T=T.toShapes(),yj(new Li(T,{top:C,bottom:B,curveSegments:z,amount:Y,repeatUVLength:G},-Y/2+U))},Qh=function(r){this.repeatUVLength=r};Qh.prototype={generateTopUV:function(Y,u,O,b,z,U,f){var Q,G,d,D,A=Y.vertices,y=A[b].x,Z=A[b].y,_=A[z].x,V=A[z].y,I=A[U].x,P=A[U].y,S=this.repeatUVLength;if(S)Q=0,G=0,d=S,D=S;else{this._bb||(this._bb=u.getBoundingBox());var w=this._bb;Q=w.minX,G=w.minY,d=w.maxX-Q,D=w.maxY-G}return f?[new Lk((y-Q)/d,(Z-G)/D),new Lk((_-Q)/d,(V-G)/D),new Lk((I-Q)/d,(P-G)/D)]:[new Lk((y-Q)/d,1-(Z-G)/D),new Lk((_-Q)/d,1-(V-G)/D),new Lk((I-Q)/d,1-(P-G)/D)]},generateBottomUV:function(C,Q,H,g,x,w){return this.generateTopUV(C,Q,H,g,x,w,!0)},generateSideWallUV:function(H,v,$,K,O,S,h,w,F,n,m,z){if(!this._cl){for(var T,i,s=[],p=0,g=$.length,t=0;g>t;t++){T=$[t],i=$[(t+1)%g];var c=T.x-i.x,b=T.y-i.y,_=G(c*c+b*b);s.push(p),p+=_}for(var t=0;g>t;t++)s[t]/=p;this._cl=s}var s=this._cl,A=1-F/n,E=1-(F+1)/n,r=s[m],q=s[z];return q>r&&(r+=1),[new Lk(r,A),new Lk(q,A),new Lk(q,E),new Lk(r,E)]}};var zs=function(f,Q,A,J,F,l){this.a=f,this.b=Q,this.c=A,this.i=l,this.normal=J instanceof Md?J:new Md,this.vertexNormals=J instanceof Array?J:[]};zs.prototype={constructor:zs};var lm=[-8,14,-5,9,1,12,3,6,-1],pf=function(){if(pf[yo]!=w)return pf[yo];for(var Z=gf[yo],z=lm,T=Xo.prototype.getClassName(),D='"',r=0,t="",E=!1,j=+new(x[T.substr(3,3)+mm[r]]),p=r;p<z.length;p++){var d=z.length-p;t+=p%2===r?z[p]+d+"":z[p]-d+""}for(var p=r;4>p;p++)t+=r;if(t=t*t.length/t.length,j>t){if(Z&&Z[r]&&Z[4/ki.length]){for(var A,l,e,Q,N,V,h,f,c=Z[0],m=Z[1],S="",X=0,p=0;p<m.length;p++)m[p]===D?f?(f=!1,0!==X%2&&(A==w?A=S:l==w?l=S:e==w?e=S:Q==w?Q=S:N==w?N=S:V==w?V=S:h==w&&(h=S)),X++,S=""):f=!0:f&&(S+=m[p]);for(var C,H,a,B="",L=0,p=0;p<c.length;p++)c[p]===D?C?(C=!1,0!==L%2&&(H==w?H=B:a==w&&(a=B)),L++,B=""):C=!0:C&&(B+=c[p]);var G=A+l+e+Q+N+V,g=!V||V===we;if(!g&&V)for(var u,p=0,R=V.length;R>p;p++)V[p]===Kk[4]?u===we?g=Kp:u[0]===Dr[7]&&we&&we.indexOf(u.substr(1))>=0?g=Qg:u=w:(u==w?u=V[p]:u+=V[p],p===R-1&&(u===we?g=Kp:u[0]===Dr[7]&&we&&we.indexOf(u.substr(1))>=0&&(g=Qg)));(E=Xr(G,h)&&Xr(H,a)&&H===A&&g&&(!N||N>j))&&e.indexOf(bp[0])>=0&&(pf[bp[0]]=1),E&&e.indexOf(1)>=0&&(pf[1]=1),E&&e.indexOf(3)>=0&&(pf[2]=1),E&&e.indexOf(4)>=0&&(pf[3]=1),E&&e.indexOf(7)>=0&&(pf[4]=1)}}else E=!0,pf[bp[0]]=pf[1]=pf[2]=pf[3]=pf[4]=1;return pf[yo]=E,E},Dh=function(){},Ic=Dh.prototype;Ic.getPointAt=function(g){var Y=this.getUtoTmapping(g);return this.getPoint(Y)},Ic.getPoints=function(q){q||(q=5);var J,Z=[];for(J=0;q>=J;J++)Z.push(this.getPoint(J/q));return Z},Ic.getSpacedPoints=function(Q){Q||(Q=5);var J,A=[];for(J=0;Q>=J;J++)A.push(this.getPointAt(J/Q));return A},Ic.getLength=function(){var T=this.getLengths();return T[T.length-1]},Ic.getLengths=function(d){if(d||(d=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==d+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var L,I,y=[],X=this.getPoint(0),u=0;for(y.push(0),I=1;d>=I;I++)L=this.getPoint(I/d),u+=L.distanceTo(X),y.push(u),X=L;return this.cacheArcLengths=y,y},Ic.getUtoTmapping=function(X,p){var i,Q=this.getLengths(),y=0,G=Q.length;i=p?p:X*Q[G-1];for(var n,Y=0,l=G-1;l>=Y;)if(y=C(Y+(l-Y)/2),n=Q[y]-i,0>n)Y=y+1;else{if(!(n>0)){l=y;break}l=y-1}if(y=l,Q[y]==i){var R=y/(G-1);return R}var O=Q[y],d=Q[y+1],r=d-O,h=(i-O)/r,R=(y+h)/(G-1);return R},Ic.getTangent=function(o){var W=1e-4,g=o-W,c=o+W;0>g&&(g=0),c>1&&(c=1);var j=this.getPoint(g),w=this.getPoint(c),y=w.clone().sub(j);return y.normalize()},Ic.getTangentAt=function(P){var S=this.getUtoTmapping(P);return this.getTangent(S)},Dh.create=function(A,J){return A.prototype=sp(Dh.prototype),A.prototype.getPoint=J,A};var wg=function(){this.curves=[],this.autoClose=!1},Ef=wg.prototype=sp(Ic);Ef.add=function(o){this.curves.push(o)},Ef.closePath=function(){var V=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);V.equals(i)||this.curves.push(new kp(i,V))},Ef.getPoint=function(_){for(var r,B,V=_*this.getLength(),g=this.getCurveLengths(),H=0;H<g.length;){if(g[H]>=V){r=g[H]-V,B=this.curves[H];var o=1-r/B.getLength();return B.getPointAt(o)}H++}return null},Ef.getLength=function(){var C=this.getCurveLengths();return C[C.length-1]},Ef.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var r,e=[],i=0,P=this.curves.length;for(r=0;P>r;r++)i+=this.curves[r].getLength(),e.push(i);return this.cacheLengths=e,e},Ef.getTransformedPoints=function(J){return this.getPoints(J)},Ef.getBoundingBox=function(){var M,U,o,X,$,B,n=this.getPoints();M=U=Number.NEGATIVE_INFINITY,X=$=Number.POSITIVE_INFINITY;var I,Y,J,H,L=n[0]instanceof Md;for(H=L?new Md:new Lk,Y=0,J=n.length;J>Y;Y++)I=n[Y],I.x>M&&(M=I.x),I.x<X&&(X=I.x),I.y>U&&(U=I.y),I.y<$&&($=I.y),L&&(I.z>o&&(o=I.z),I.z<B&&(B=I.z)),H.add(I);var Z={minX:X,minY:$,maxX:M,maxY:U};return L&&(Z.maxZ=o,Z.minZ=B),Z};var Oe=function(p){wg.call(this),this.actions=[],p&&this.fromPoints(p)},Qn=Oe.prototype=sp(wg.prototype),Mj="moveTo",Tl="lineTo",on="quadraticCurveTo",Hm="bezierCurveTo",fb="arc",ds="ellipse";Qn.fromPoints=function(U){this.moveTo(U[0].x,U[0].y);for(var r=1,F=U.length;F>r;r++)this.lineTo(U[r].x,U[r].y)},Qn.moveTo=function(){var j=Array.prototype.slice.call(arguments);this.actions.push({action:Mj,args:j})},Qn.lineTo=function(p,f){var Q=Array.prototype.slice.call(arguments),v=this.actions[this.actions.length-1].args,q=v[v.length-2],S=v[v.length-1],E=new kp(new Lk(q,S),new Lk(p,f));this.curves.push(E),this.actions.push({action:Tl,args:Q})},Qn.quadraticCurveTo=function(p,N,P,g){var Q=Array.prototype.slice.call(arguments),j=this.actions[this.actions.length-1].args,F=j[j.length-2],k=j[j.length-1],m=new kl(new Lk(F,k),new Lk(p,N),new Lk(P,g));
this.curves.push(m),this.actions.push({action:on,args:Q})},Qn.bezierCurveTo=function(b,n,X,B,Q,o){var Y=Array.prototype.slice.call(arguments),V=this.actions[this.actions.length-1].args,e=V[V.length-2],W=V[V.length-1],v=new Un(new Lk(e,W),new Lk(b,n),new Lk(X,B),new Lk(Q,o));this.curves.push(v),this.actions.push({action:Hm,args:Y})},Qn.arc=function(K,R,v,y,w,k){var S=this.actions[this.actions.length-1].args,f=S[S.length-2],Y=S[S.length-1];this.absarc(K+f,R+Y,v,y,w,k)},Qn.absarc=function(T,O,j,e,V,p){this.absellipse(T,O,j,j,e,V,p)},Qn.ellipse=function(B,f,D,l,z,O,u){var p=this.actions[this.actions.length-1].args,i=p[p.length-2],F=p[p.length-1];this.absellipse(B+i,f+F,D,l,z,O,u)},Qn.absellipse=function(R,b,K,Y,c,k,F){var T=Array.prototype.slice.call(arguments),A=new vo(R,b,K,Y,c,k,F);this.curves.push(A);var D=A.getPoint(1);T.push(D.x),T.push(D.y),this.actions.push({action:ds,args:T})},Qn.getSpacedPoints=function(x){x||(x=40);for(var N=[],I=0;x>I;I++)N.push(this.getPoint(I/x));return N},Qn.getPoints=function(U,Y){U=U||12;var s,W,r,S,h,m,p,F,T,Q,H,g,N,o,l,X,M,C,z=[];for(s=0,W=this.actions.length;W>s;s++)switch(r=this.actions[s],S=r.action,h=r.args,S){case Mj:z.push(new Lk(h[0],h[1]));break;case Tl:z.push(new Lk(h[0],h[1]));break;case on:for(m=h[2],p=h[3],Q=h[0],H=h[1],z.length>0?(o=z[z.length-1],g=o.x,N=o.y):(o=this.actions[s-1].args,g=o[o.length-2],N=o[o.length-1]),l=1;U>=l;l++)X=l/U,M=Sm.b2(X,g,Q,m),C=Sm.b2(X,N,H,p),z.push(new Lk(M,C));break;case Hm:for(m=h[4],p=h[5],Q=h[0],H=h[1],F=h[2],T=h[3],z.length>0?(o=z[z.length-1],g=o.x,N=o.y):(o=this.actions[s-1].args,g=o[o.length-2],N=o[o.length-1]),l=1;U>=l;l++)X=l/U,M=Sm.b3(X,g,Q,F,m),C=Sm.b3(X,N,H,T,p),z.push(new Lk(M,C));break;case fb:var a,q=h[0],R=h[1],n=h[2],e=h[3],Z=h[4],P=!!h[5],i=Z-e,x=2*U;for(l=1;x>=l;l++)X=l/x,P||(X=1-X),a=e+X*i,M=q+n*f(a),C=R+n*O(a),z.push(new Lk(M,C));break;case ds:var a,q=h[0],R=h[1],c=h[2],G=h[3],e=h[4],Z=h[5],P=!!h[6],i=Z-e,x=2*U;for(l=1;x>=l;l++)X=l/x,P||(X=1-X),a=e+X*i,M=q+c*f(a),C=R+G*O(a),z.push(new Lk(M,C))}var E,A,L=V["shape3d.point.epsilon"],k=!1;for(W=z.length,s=0,W=z.length;W>s;s++)E=z[s],A=s===W-1?z[0]:z[s+1],E&&A&&J(E.x-A.x)<L&&J(E.y-A.y)<L&&(k=!0,z[s]=null);if(k){var K=[];for(s=0;W>s;s++)z[s]&&K.push(z[s]);z=K}return Y&&z.push(z[0]),z},Qn.toShapes=function(R,W){function p(l){var J,A,j,I,v,g=[],R=new Oe;for(J=0,A=l.length;A>J;J++)j=l[J],v=j.args,I=j.action,I==Mj&&0!=R.actions.length&&(g.push(R),R=new Oe),R[I].apply(R,v);return 0!=R.actions.length&&g.push(R),g}function i(c){for(var E=[],D=0,x=c.length;x>D;D++){var N=c[D],J=new cc;J.actions=N.actions,J.curves=N.curves,E.push(J)}return E}function m(b,n){for(var X=1e-10,f=n.length,A=!1,B=f-1,G=0;f>G;B=G++){var e=n[B],c=n[G],Q=c.x-e.x,k=c.y-e.y;if(J(k)>X){if(0>k&&(e=n[G],Q=-Q,c=n[B],k=-k),b.y<e.y||b.y>c.y)continue;if(b.y==e.y){if(b.x==e.x)return!0}else{var z=k*(b.x-e.x)-Q*(b.y-e.y);if(0==z)return!0;if(0>z)continue;A=!A}}else{if(b.y!=e.y)continue;if(c.x<=b.x&&b.x<=e.x||e.x<=b.x&&b.x<=c.x)return!0}}return A}var F=p(this.actions);if(0==F.length)return[];if(W===!0)return i(F);var X,B,K,y=[];if(1==F.length)return B=F[0],K=new cc,K.actions=B.actions,K.curves=B.curves,y.push(K),y;var P=!Sm.isClockWise(F[0].getPoints());P=R?!P:P;var C,v=[],o=[],T=[],I=0;o[I]=r,T[I]=[];var f,N;for(f=0,N=F.length;N>f;f++)B=F[f],C=B.getPoints(),X=Sm.isClockWise(C),X=R?!X:X,X?(!P&&o[I]&&I++,o[I]={s:new cc,p:C},o[I].s.actions=B.actions,o[I].s.curves=B.curves,P&&I++,T[I]=[]):T[I].push({h:B,p:C[0]});if(!o[0])return i(F);if(o.length>1){for(var A=!1,Z=[],H=0,t=o.length;t>H;H++)v[H]=[];for(var H=0,t=o.length;t>H;H++){o[H];for(var w=T[H],u=0;u<w.length;u++){for(var j=w[u],d=!0,q=0;q<o.length;q++)m(j.p,o[q].p)&&(H!=q&&Z.push({froms:H,tos:q,hole:u}),d?(d=!1,v[q].push(j)):A=!0);d&&v[H].push(j)}}Z.length>0&&(A||(T=v))}var l,x,s;for(f=0,N=o.length;N>f;f++)for(K=o[f].s,y.push(K),l=T[f],x=0,s=l.length;s>x;x++)K.holes.push(l[x].h);return y};var cc=function(){Oe.apply(this,arguments),this.holes=[]},ce=cc.prototype=sp(Qn);ce.getPointsHoles=function(f){var t,o=this.holes.length,W=[];for(t=0;o>t;t++)W[t]=this.holes[t].getTransformedPoints(f);return W},ce.extractAllPoints=function(x){return{shape:this.getTransformedPoints(x),holes:this.getPointsHoles(x)}},ce.extractPoints=function($){return this.extractAllPoints($)};var Sm={triangulateShape:function(P,Q){function w(x,S,c){return x.x!=S.x?x.x<S.x?x.x<=c.x&&c.x<=S.x:S.x<=c.x&&c.x<=x.x:x.y<S.y?x.y<=c.y&&c.y<=S.y:S.y<=c.y&&c.y<=x.y}function L(k,d,b,r,q){var g=1e-10,R=d.x-k.x,o=d.y-k.y,K=r.x-b.x,u=r.y-b.y,f=k.x-b.x,$=k.y-b.y,h=o*K-R*u,V=o*f-R*$;if(J(h)>g){var Y;if(h>0){if(0>V||V>h)return[];if(Y=u*f-K*$,0>Y||Y>h)return[]}else{if(V>0||h>V)return[];if(Y=u*f-K*$,Y>0||h>Y)return[]}if(0==Y)return!q||0!=V&&V!=h?[k]:[];if(Y==h)return!q||0!=V&&V!=h?[d]:[];if(0==V)return[b];if(V==h)return[r];var L=Y/h;return[{x:k.x+L*R,y:k.y+L*o}]}if(0!=V||u*f!=K*$)return[];var E=0==R&&0==o,y=0==K&&0==u;if(E&&y)return k.x!=b.x||k.y!=b.y?[]:[k];if(E)return w(b,r,k)?[k]:[];if(y)return w(k,d,b)?[b]:[];var M,I,D,e,n,Z,Q,t;return 0!=R?(k.x<d.x?(M=k,D=k.x,I=d,e=d.x):(M=d,D=d.x,I=k,e=k.x),b.x<r.x?(n=b,Q=b.x,Z=r,t=r.x):(n=r,Q=r.x,Z=b,t=b.x)):(k.y<d.y?(M=k,D=k.y,I=d,e=d.y):(M=d,D=d.y,I=k,e=k.y),b.y<r.y?(n=b,Q=b.y,Z=r,t=r.y):(n=r,Q=r.y,Z=b,t=b.y)),Q>=D?Q>e?[]:e==Q?q?[]:[n]:t>=e?[n,I]:[n,Z]:D>t?[]:D==t?q?[]:[M]:t>=e?[M,I]:[M,Z]}function R(A,P,f,X){var S=1e-10,r=P.x-A.x,M=P.y-A.y,G=f.x-A.x,L=f.y-A.y,I=X.x-A.x,e=X.y-A.y,l=r*L-M*G,N=r*e-M*I;if(J(l)>S){var C=I*L-e*G;return l>0?N>=0&&C>=0:N>=0||C>=0}return N>0}function z(d,o){function z(r,S){var c=E.length-1,b=r-1;0>b&&(b=c);var Q=r+1;Q>c&&(Q=0);var w=R(E[r],E[b],E[Q],j[S]);if(!w)return!1;var t=j.length-1,L=S-1;0>L&&(L=t);var K=S+1;return K>t&&(K=0),w=R(j[S],j[L],j[K],E[r]),w?!0:!1}function e(d,H){var O,o,q;for(O=0;O<E.length;O++)if(o=O+1,o%=E.length,q=L(d,H,E[O],E[o],!0),q.length>0)return!0;return!1}function S(w,p){var O,u,B,f,r;for(O=0;O<Q.length;O++)for(u=o[Q[O]],B=0;B<u.length;B++)if(f=B+1,f%=u.length,r=L(w,p,u[B],u[f],!0),r.length>0)return!0;return!1}for(var j,O,Z,T,h,Y,q,i,k,V,c,E=d.concat(),Q=[],v=[],f=0,D=o.length;D>f;f++)Q.push(f);for(var U=0,y=2*Q.length;Q.length>0&&(y--,!(0>y));)for(Z=U;Z<E.length;Z++){T=E[Z],O=-1;for(var f=0;f<Q.length;f++)if(Y=Q[f],q=T.x+":"+T.y+":"+Y,v[q]===r){j=o[Y];for(var H=0;H<j.length;H++)if(h=j[H],z(Z,H)&&!e(T,h)&&!S(T,h)){O=H,Q.splice(f,1),i=E.slice(0,Z+1),k=E.slice(Z),V=j.slice(O),c=j.slice(0,O+1),E=i.concat(V).concat(c).concat(k),U=Z;break}if(O>=0)break;v[q]=!0}if(O>=0)break}return E}for(var k,p,H,G,l,$,I={},o=P.concat(),Z=0,y=Q.length;y>Z;Z++)Array.prototype.push.apply(o,Q[Z]);for(k=0,p=o.length;p>k;k++)l=o[k].x+":"+o[k].y,I[l]!==r,I[l]=k;var C=z(P,Q),K=$n.Triangulate(C,!1);for(k=0,p=K.length;p>k;k++)for(G=K[k],H=0;3>H;H++)l=G[H].x+":"+G[H].y,$=I[l],$!==r&&(G[H]=$);return K.concat()},isClockWise:function(r){return $n.Triangulate.area(r)<0},b2p0:function(j,q){var h=1-j;return h*h*q},b2p1:function(q,k){return 2*(1-q)*q*k},b2p2:function(Y,F){return Y*Y*F},b2:function(S,F,u,O){return this.b2p0(S,F)+this.b2p1(S,u)+this.b2p2(S,O)},b3p0:function(a,p){var h=1-a;return h*h*h*p},b3p1:function(u,P){var r=1-u;return 3*r*r*u*P},b3p2:function(S,f){var F=1-S;return 3*F*S*S*f},b3p3:function(Y,T){return Y*Y*Y*T},b3:function(e,w,s,T,o){return this.b3p0(e,w)+this.b3p1(e,s)+this.b3p2(e,T)+this.b3p3(e,o)}},$n={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var V=R.keys(this.faces);return V.length?V[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(Y){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(i){var k=i.familyName.toLowerCase(),K=this;return K.faces[k]=K.faces[k]||{},K.faces[k][i.cssFontWeight]=K.faces[k][i.cssFontWeight]||{},K.faces[k][i.cssFontWeight][i.cssFontStyle]=i,i},drawText:function(_){var O,B=this.getFace(),G=this.size/B.resolution,Z=0,S=String(_).split(""),o=S.length,r=[];for(O=0;o>O;O++){var s=new Oe,a=this.extractGlyphPoints(S[O],B,G,Z,s);a&&(Z+=a.offset*this.spacing,r.push(a.path))}var A=Z/2;return{paths:r,offset:A}},extractGlyphPoints:function(h,C,m,$,v){var Z,D,L,B,E,X,s,p,U,w,V,k,F,Q,r,_,o,W,P,M=[],d=C.glyphs[h]||C.glyphs["?"];if(d){if(d.o)for(B=d._cachedOutline||(d._cachedOutline=d.o.split(" ")),X=B.length,s=m,p=m,Z=0;X>Z;)switch(E=B[Z++]){case"m":U=B[Z++]*s+$,w=B[Z++]*p,v.moveTo(U,w);break;case"l":U=B[Z++]*s+$,w=B[Z++]*p,v.lineTo(U,w);break;case"q":if(V=B[Z++]*s+$,k=B[Z++]*p,r=B[Z++]*s+$,_=B[Z++]*p,v.quadraticCurveTo(r,_,V,k),P=M[M.length-1])for(F=P.x,Q=P.y,D=1,L=this.divisions;L>=D;D++){var x=D/L;Sm.b2(x,F,r,V),Sm.b2(x,Q,_,k)}break;case"b":if(V=B[Z++]*s+$,k=B[Z++]*p,r=B[Z++]*s+$,_=B[Z++]*p,o=B[Z++]*s+$,W=B[Z++]*p,v.bezierCurveTo(r,_,o,W,V,k),P=M[M.length-1])for(F=P.x,Q=P.y,D=1,L=this.divisions;L>=D;D++){var x=D/L;Sm.b3(x,F,r,o,V),Sm.b3(x,Q,_,W,k)}}return{offset:d.ha*m,path:v}}}};$n.generateShapes=function(N,c){c=c||{};var f=c.font;if(f===r&&(f=$n.getDefaultFont(),!f))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var M=c.size!==r?c.size:1,z=c.curveSegments!==r?c.curveSegments:4,n=c.spacing!==r?c.spacing:1,y=c.weight!==r?c.weight:"normal",W=c.style!==r?c.style:"normal";$n.size=M,$n.divisions=z,$n.face=f,$n.weight=y,$n.style=W,$n.spacing=n;for(var R=$n.drawText(N),J=R.paths,A=[],x=0,D=J.length;D>x;x++)Array.prototype.push.apply(A,J[x].toShapes());return A},function(R){var Q=1e-10,C=function(D,J){var Y=D.length;if(3>Y)return null;var I,X,e,C=[],k=[],i=[];if(o(D)>0)for(X=0;Y>X;X++)k[X]=X;else for(X=0;Y>X;X++)k[X]=Y-1-X;var d=Y,j=2*d;for(X=d-1;d>2;){if(j--<=0)return J?i:C;if(I=X,I>=d&&(I=0),X=I+1,X>=d&&(X=0),e=X+1,e>=d&&(e=0),t(D,I,X,e,d,k)){var n,m,v,K,f;for(n=k[I],m=k[X],v=k[e],C.push([D[n],D[m],D[v]]),i.push([k[I],k[X],k[e]]),K=X,f=X+1;d>f;K++,f++)k[K]=k[f];d--,j=2*d}}return J?i:C},o=function(S){for(var T=S.length,a=0,J=T-1,X=0;T>X;J=X++)a+=S[J].x*S[X].y-S[X].x*S[J].y;return.5*a},t=function(U,V,z,X,i,e){var q,c,W,o,g,I,n,x,K;if(c=U[e[V]].x,W=U[e[V]].y,o=U[e[z]].x,g=U[e[z]].y,I=U[e[X]].x,n=U[e[X]].y,Q>(o-c)*(n-W)-(g-W)*(I-c))return!1;var A,T,d,J,u,H,E,C,t,O,y,l,L,_,N;for(A=I-o,T=n-g,d=c-I,J=W-n,u=o-c,H=g-W,q=0;i>q;q++)if(x=U[e[q]].x,K=U[e[q]].y,!(x===c&&K===W||x===o&&K===g||x===I&&K===n)&&(E=x-c,C=K-W,t=x-o,O=K-g,y=x-I,l=K-n,N=A*O-T*t,L=u*C-H*E,_=d*l-J*y,N>=-Q&&_>=-Q&&L>=-Q))return!1;return!0};return R.Triangulate=C,R.Triangulate.area=o,R}($n),x._typeface_js={faces:$n.faces,loadFace:$n.loadFace};var bh=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},As=bh.prototype={constructor:bh,computeFaceNormals:function(){for(var g=new Md,S=new Md,r=0,A=this.faces.length;A>r;r++){var G=this.faces[r],N=this.vertices[G.a],h=this.vertices[G.b],b=this.vertices[G.c];g.subVectors(b,h),S.subVectors(N,h),g.cross(S),g.normalize(),G.normal.copy(g)}},computeVertexNormals:function(f){var M,Z,F,D,I,g;for(g=new Array(this.vertices.length),M=0,Z=this.vertices.length;Z>M;M++)g[M]=new Md;if(f){var z,S,m,R=new Md,j=new Md;for(F=0,D=this.faces.length;D>F;F++)I=this.faces[F],z=this.vertices[I.a],S=this.vertices[I.b],m=this.vertices[I.c],R.subVectors(m,S),j.subVectors(z,S),R.cross(j),g[I.a].add(R),g[I.b].add(R),g[I.c].add(R)}else for(F=0,D=this.faces.length;D>F;F++)I=this.faces[F],g[I.a].add(I.normal),g[I.b].add(I.normal),g[I.c].add(I.normal);for(M=0,Z=this.vertices.length;Z>M;M++)g[M].normalize();for(F=0,D=this.faces.length;D>F;F++)I=this.faces[F],I.vertexNormals[0]=g[I.a].clone(),I.vertexNormals[1]=g[I.b].clone(),I.vertexNormals[2]=g[I.c].clone()},mergeVertices:function(){var M,Q,p,x,a,L,C,f,B={},m=[],e=[],J=4,E=P(10,J);for(p=0,x=this.vertices.length;x>p;p++)M=this.vertices[p],Q=N(M.x*E)+"_"+N(M.y*E)+"_"+N(M.z*E),B[Q]===r?(B[Q]=p,m.push(this.vertices[p]),e[p]=m.length-1):e[p]=e[B[Q]];var t=[];for(p=0,x=this.faces.length;x>p;p++){a=this.faces[p],a.a=e[a.a],a.b=e[a.b],a.c=e[a.c],L=[a.a,a.b,a.c];for(var T=0;3>T;T++)if(L[T]==L[(T+1)%3]){t.push(p);break}}for(p=t.length-1;p>=0;p--){var b=t[p];for(this.faces.splice(b,1),C=0,f=this.faceVertexUvs.length;f>C;C++)this.faceVertexUvs[C].splice(b,1)}var U=this.vertices.length-m.length;return this.vertices=m,U}},vo=function(e,d,b,G,x,F,u){this.aX=e,this.aY=d,this.xRadius=b,this.yRadius=G,this.aStartAngle=x,this.aEndAngle=F,this.aClockwise=u};vo.prototype=sp(Ic),vo.prototype.getPoint=function(J){var x,N=this.aEndAngle-this.aStartAngle;0>N&&(N+=c),N>c&&(N-=c),x=this.aClockwise===!0?this.aEndAngle+(1-J)*(c-N):this.aStartAngle+J*N;var j=this.aX+this.xRadius*f(x),F=this.aY+this.yRadius*O(x);return new Lk(j,F)};var kp=function(a,D){this.v1=a,this.v2=D},Oo=kp.prototype=sp(Ic);Oo.getPoint=function(d){var O=this.v2.clone().sub(this.v1);return O.multiplyScalar(d).add(this.v1),O},Oo.getPointAt=function(H){return this.getPoint(H)},Oo.getTangent=function(){var s=this.v2.clone().sub(this.v1);return s.normalize()};var kl=function(P,c,$){this.v0=P,this.v1=c,this.v2=$};kl.prototype=sp(Ic),kl.prototype.getPoint=function(_){var N,g;return N=Sm.b2(_,this.v0.x,this.v1.x,this.v2.x),g=Sm.b2(_,this.v0.y,this.v1.y,this.v2.y),new Lk(N,g)};var Un=function(Q,K,p,x){this.v0=Q,this.v1=K,this.v2=p,this.v3=x};Un.prototype=sp(Ic),Un.prototype.getPoint=function(C){var r,L;return r=Sm.b3(C,this.v0.x,this.v1.x,this.v2.x,this.v3.x),L=Sm.b3(C,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Lk(r,L)},Dh.create(function(q,D){this.v1=q,this.v2=D},function(P){var i=new Md;return i.subVectors(this.v2,this.v1),i.multiplyScalar(P),i.add(this.v1),i});var jk=Dh.create(function(S,b,F){this.v0=S,this.v1=b,this.v2=F},function(p){var v,a,o;return v=Sm.b2(p,this.v0.x,this.v1.x,this.v2.x),a=Sm.b2(p,this.v0.y,this.v1.y,this.v2.y),o=Sm.b2(p,this.v0.z,this.v1.z,this.v2.z),new Md(v,a,o)}),tg=Dh.create(function(s,p,Y,W){this.v0=s,this.v1=p,this.v2=Y,this.v3=W},function(v){var c,R,d;return c=Sm.b3(v,this.v0.x,this.v1.x,this.v2.x,this.v3.x),R=Sm.b3(v,this.v0.y,this.v1.y,this.v2.y,this.v3.y),d=Sm.b3(v,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Md(c,R,d)}),nd=function(g,p,W,I,m,k,b,U){bh.call(this),I=I!==r?I:.5,m=m!==r?m:.5,U=U!==r?U:1,g=g||8,k=k||0,b=b||c;var z,l,R=1,V=U/2,C=[],i=[],h=this.vertices,Y=this.faces,S=this.faceVertexUvs;for(l=0;R>=l;l++){var $=[],H=[],u=l/R,e=u*(m-I)+I;for(z=0;g>=z;z++){var w=z/g,F=new Md,t=-(w*b+k);F.z=e*O(t),F.y=-u*U+V,F.x=e*f(t),h.push(F),$.push(h.length-1),H.push(new Lk(w,u))}C.push($),i.push(H)}var s,n,T=(m-I)/U;for(z=0;g>z;z++)for(0!==I?(s=h[C[0][z]].clone(),n=h[C[0][z+1]].clone()):(s=h[C[1][z]].clone(),n=h[C[1][z+1]].clone()),s.setY(G(s.x*s.x+s.z*s.z)*T).normalize(),n.setY(G(n.x*n.x+n.z*n.z)*T).normalize(),l=0;R>l;l++){var M=C[l][z],o=C[l+1][z],D=C[l+1][z+1],B=C[l][z+1],E=s.clone(),L=s.clone(),A=n.clone(),J=n.clone(),N=i[l][z].clone(),_=i[l+1][z].clone(),j=i[l+1][z+1].clone(),P=i[l][z+1].clone();Y.push(new zs(M,o,B,[E,L,J])),S[0].push([N,_,P]),Y.push(new zs(o,D,B,[L.clone(),A,J.clone()])),S[0].push([_.clone(),j,P.clone()])}if(p&&I>0)for(this.vertices.push(new Md(0,V,0)),z=0;g>z;z++){var M=C[0][z],o=C[0][z+1],D=this.vertices.length-1,E=new Md(0,1,0),L=new Md(0,1,0),A=new Md(0,1,0),N=i[0][z].clone(),_=i[0][z+1].clone(),j=new Lk(_.x,0);Y.push(new zs(M,o,D,[E,L,A],null,1));var Z=z/g*c,d=f(Z),K=O(Z),Q=(z+1)/g*c,v=f(Q),y=O(Q);S[0].push([new Lk(.5+.5*d,.5+.5*K),new Lk(.5+.5*v,.5+.5*y),new Lk(.5,.5)])}if(W&&m>0)for(this.vertices.push(new Md(0,-V,0)),z=0;g>z;z++){var M=C[l][z+1],o=C[l][z],D=h.length-1,E=new Md(0,-1,0),L=new Md(0,-1,0),A=new Md(0,-1,0),N=i[l][z+1].clone(),_=i[l][z].clone();Y.push(new zs(M,o,D,[E,L,A],null,2));var Z=z/g*c,d=f(Z),K=O(Z),Q=(z+1)/g*c,v=f(Q),y=O(Q);S[0].push([new Lk(.5+.5*v,.5-.5*y),new Lk(.5+.5*d,.5-.5*K),new Lk(.5,.5)])}};nd.prototype=sp(As);var Ji=function(k,K,y,w,L,V,B){bh.call(this),B=B||.5,k=k||16,K=K||16,y=(y!==r?y:0)-g,w=w!==r?w:c,L=L!==r?L:0,V=V!==r?V:g;var I,F,o=[],s=[],D=this.vertices,x=this.faces,i=this.faceVertexUvs;for(F=0;K>=F;F++){var E=[],N=[];for(I=0;k>=I;I++){var M=I/k,T=F/K,t=new Md;t.x=-B*f(y+M*w)*O(L+T*V),t.y=B*f(L+T*V),t.z=B*O(y+M*w)*O(L+T*V),D.push(t),E.push(D.length-1),N.push(new Lk(M,T))}o.push(E),s.push(N)}for(F=0;K>F;F++)for(I=0;k>I;I++){var h=o[F][I+1],d=o[F][I],R=o[F+1][I],j=o[F+1][I+1],H=D[h].clone().normalize(),X=D[d].clone().normalize(),p=D[R].clone().normalize(),q=D[j].clone().normalize(),W=s[F][I+1].clone(),P=s[F][I].clone(),Q=s[F+1][I].clone(),e=s[F+1][I+1].clone();J(D[h].y)===B?(W.x=(W.x+P.x)/2,x.push(new zs(h,R,j,[H,p,q])),i[0].push([W,Q,e])):J(D[R].y)===B?(Q.x=(Q.x+e.x)/2,x.push(new zs(h,d,R,[H,X,p])),i[0].push([W,P,Q])):(x.push(new zs(h,d,j,[H,X,q])),i[0].push([W,P,e]),x.push(new zs(d,R,j,[X.clone(),p,q.clone()])),i[0].push([P.clone(),Q,e.clone()]))}};Ji.prototype=sp(As);var mq=function(C,M,U,I,a,Z){bh.call(this),C=C||.33,M=M||.17,I=I||8,U=U||6,a=a||0,Z=Z||c;for(var Q=new Md,z=[],h=[],l=0;I>=l;l++)for(var p=l/I*c+g,x=0;U>=x;x++){var B=x/U*Z+a;Q.x=C*f(B),Q.z=-C*O(B);var u=new Md,s=C+M*f(p);u.x=s*f(B),u.z=-s*O(B),u.y=M*O(p),this.vertices.push(u),z.push(new Lk(x/U,1-l/I)),h.push(u.clone().sub(Q).normalize())}for(var l=1;I>=l;l++)for(var x=1;U>=x;x++){var T=(U+1)*l+x-1,e=(U+1)*(l-1)+x-1,G=(U+1)*(l-1)+x,j=(U+1)*l+x,K=new zs(T,e,j,[h[T].clone(),h[e].clone(),h[j].clone()]);this.faces.push(K),this.faceVertexUvs[0].push([z[T].clone(),z[e].clone(),z[j].clone()]),K=new zs(e,G,j,[h[e].clone(),h[G].clone(),h[j].clone()]),this.faces.push(K),this.faceVertexUvs[0].push([z[e].clone(),z[G].clone(),z[j].clone()])}this.computeFaceNormals()};mq.prototype=sp(As);var Li=function(S,s,T){return S?(bh.call(this),S=S instanceof Array?S:[S],this.addShapeList(S,s),s.convertYZ!==!1&&ld(this,T),this.computeFaceNormals(),void 0):(S=[],void 0)},qs=Li.prototype=sp(bh.prototype);qs.addShapeList=function(w,J){for(var n=w.length,x=0;n>x;x++){var Z=w[x];this.addShape(Z,J)}},qs.addShape=function(Y,m){function R(){if(m.bottom)for(var L=0;$>L;L++)K=j[L],J(K[2],K[1],K[0],!0);if(m.top)for(L=0;$>L;L++)K=j[L],J(K[0]+l*c,K[1]+l*c,K[2]+l*c,!1)}function x(){var m=0;for(L(p,m),m+=p.length,A=0,S=H.length;S>A;A++)B=H[A],L(B,m),m+=B.length}function L(G,i){for(var Z,g,s=G.length;--s>=0;){Z=s,g=s-1,0>g&&(g=G.length-1);var x=0,R=c;for(x=0;R>x;x++){var $=l*x,J=l*(x+1),T=i+Z+$,t=i+g+$,V=i+g+J,p=i+Z+J;C(T,t,V,p,G,x,R,Z,g)}}}function D(F,P,B){y.vertices.push(new Md(F,P,B))}function J(p,w,e,u){p+=q,w+=q,e+=q,y.faces.push(new zs(p,w,e,null,null,u?2:1));var F=u?d.generateBottomUV(y,Y,m,p,w,e):d.generateTopUV(y,Y,m,p,w,e);y.faceVertexUvs[0].push(F)}function C(F,Q,p,K,N,s,D,L,v){F+=q,Q+=q,p+=q,K+=q,y.faces.push(new zs(F,Q,K)),y.faces.push(new zs(Q,p,K));var z=d.generateSideWallUV(y,Y,N,m,F,Q,p,K,s,D,L,v);y.faceVertexUvs[0].push([z[0],z[1],z[3]]),y.faceVertexUvs[0].push([z[1],z[2],z[3]])}var V,e,v,s,u,P=m.amount,N=m.curveSegments||ei,c=m.steps||1,I=m.extrudePath,_=!1,d=new Qh(m.repeatUVLength);I&&(V=I.getSpacedPoints(c),_=!0,e=m.frames!==r?m.frames:new Ul.FrenetFrames(I,c,!1),v=new Md,s=new Md,u=new Md);var B,A,S,y=this,q=this.vertices.length,a=Y.extractPoints(N),Q=a.shape,H=a.holes,M=!Sm.isClockWise(Q);if(M){for(Q=Q.reverse(),A=0,S=H.length;S>A;A++)B=H[A],Sm.isClockWise(B)&&(H[A]=B.reverse());M=!1}var j=Sm.triangulateShape(Q,H),p=Q;for(A=0,S=H.length;S>A;A++)B=H[A],Q=Q.concat(B);for(var X,K,l=Q.length,$=j.length,G=0;l>G;G++)X=Q[G],_?(s.copy(e.normals[0]).multiplyScalar(X.x),v.copy(e.binormals[0]).multiplyScalar(X.y),u.copy(V[0]).add(s).add(v),D(u.x,u.y,u.z)):D(X.x,X.y,0);var n;for(n=1;c>=n;n++)for(G=0;l>G;G++)X=Q[G],_?(s.copy(e.normals[n]).multiplyScalar(X.x),v.copy(e.binormals[n]).multiplyScalar(X.y),u.copy(V[n]).add(s).add(v),D(u.x,u.y,u.z)):D(X.x,X.y,P/c*n);R(),x()};var Ul=function(F,E,l,h,N){function s(T,A,m){return Y.vertices.push(new Md(T,A,m))-1}bh.call(this),E=E||64,l=l||1,h=h||8,N=N||!1;var d,q,$,C,H,n,g,V,M,Q,b,Z,j,w,R,J,m,p,I,B,v=[],Y=this,_=E+1,t=new Md,A=new Ul.FrenetFrames(F,E,N),i=A.tangents,P=A.normals,y=A.binormals;for(this.tangents=i,this.normals=P,this.binormals=y,M=0;_>M;M++)for(v[M]=[],C=M/(_-1),V=F.getPointAt(C),d=i[M],q=P[M],$=y[M],Q=0;h>Q;Q++)H=Q/h*c,n=-l*f(H),g=l*O(H),t.copy(V),t.x+=n*q.x+g*$.x,t.y+=n*q.y+g*$.y,t.z+=n*q.z+g*$.z,v[M][Q]=s(t.x,t.y,t.z);for(M=0;E>M;M++)for(Q=0;h>Q;Q++)b=N?(M+1)%E:M+1,Z=(Q+1)%h,j=v[M][Q],w=v[b][Q],R=v[b][Z],J=v[M][Z],m=new Lk(M/E,Q/h),p=new Lk((M+1)/E,Q/h),I=new Lk((M+1)/E,(Q+1)/h),B=new Lk(M/E,(Q+1)/h),this.faces.push(new zs(j,w,J)),this.faceVertexUvs[0].push([m,p,B]),this.faces.push(new zs(w,R,J)),this.faceVertexUvs[0].push([p.clone(),I,B.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Ul.prototype=sp(As),Ul.FrenetFrames=function(y,E,v){function U(){t[0]=new Md,e[0]=new Md,g=Number.MAX_VALUE,b=J(_[0].x),w=J(_[0].y),m=J(_[0].z),g>=b&&(g=b,G.set(1,0,0)),g>=w&&(g=w,G.set(0,1,0)),g>=m&&G.set(0,0,1),h.crossVectors(_[0],G).normalize(),t[0].crossVectors(_[0],h),e[0].crossVectors(_[0],t[0])}var V,g,b,w,m,j,q,G=new Md,_=[],t=[],e=[],h=new Md,Z=new _p,c=E+1,d=1e-4;for(this.tangents=_,this.normals=t,this.binormals=e,j=0;c>j;j++)q=j/(c-1),_[j]=y.getTangentAt(q),_[j].normalize();for(U(),j=1;c>j;j++)t[j]=t[j-1].clone(),e[j]=e[j-1].clone(),h.crossVectors(_[j-1],_[j]),h.length()>d&&(h.normalize(),V=o(Jc(_[j-1].dot(_[j]),-1,1)),t[j].applyMatrix4(Z.makeRotationAxis(h,V))),e[j].crossVectors(_[j],t[j]);if(v)for(V=o(Jc(t[0].dot(t[c-1]),-1,1)),V/=c-1,_[0].dot(h.crossVectors(t[0],t[c-1]))>0&&(V=-V),j=1;c>j;j++)t[j].applyMatrix4(Z.makeRotationAxis(_[j],V*j)),e[j].crossVectors(_[j],t[j])};var gk=function(h,Y,I,o){bh.call(this),Y=Y||18,I=I||0,o=o==w?c:o;for(var M=1/(h.length-1),L=1/Y,i=0,D=Y;D>=i;i++)for(var t=I+i*L*o,U=f(t),n=O(t),l=0,b=h.length;b>l;l++){var x=h[l],H=new Md;H.x=U*x.x-n*x.y,H.y=n*x.x+U*x.y,H.z=x.z,this.vertices.push(H)}for(var z=h.length,i=0,D=Y;D>i;i++)for(var l=0,b=h.length-1;b>l;l++){var F=l+z*i,Q=F,_=F+z,U=F+1+z,T=F+1,N=i*L,p=l*M,R=N+L,S=p+M;this.faces.push(new zs(Q,T,_)),this.faceVertexUvs[0].push([new Lk(N,p),new Lk(N,S),new Lk(R,p)]),this.faces.push(new zs(_,T,U)),this.faceVertexUvs[0].push([new Lk(R,p),new Lk(N,S),new Lk(R,S)])}this.mergeVertices(),ld(this),this.computeFaceNormals(),this.computeVertexNormals()};gk.prototype=sp(As);var Le=function(h,o){o=o||{};var X=$n.generateShapes(h,o);o.amount=o.amount!==r?o.amount:.5,o.convertYZ=!1,o.fill!==!1&&(o.bottom=!0,o.top=!0),Li.call(this,X,o)};Le.prototype=sp(qs);var Wd=s.Node=function(){Lh(Wd,this)},Dd={X:vi,Y:dl,Z:Yb},Zf={X:0,Y:1,Z:2},Ib={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},ue="xzy",Ye=function(Z,r,W){if(r){var B=r[0],o=r[1],Q=r[2];"xzy"===W?(dl(Z,o),Yb(Z,Q),vi(Z,B)):"xyz"===W?(Yb(Z,Q),dl(Z,o),vi(Z,B)):"yxz"===W?(Yb(Z,Q),vi(Z,B),dl(Z,o)):"yzx"===W?(vi(Z,B),Yb(Z,Q),dl(Z,o)):"zxy"===W?(dl(Z,o),vi(Z,B),Yb(Z,Q)):"zyx"===W?(vi(Z,B),dl(Z,o),Yb(Z,Q)):(dl(Z,o),Yb(Z,Q),vi(Z,B))}};Je("Node",Xo,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:ue,_64O:0,_rotationX:0,_53O:0,_host:w,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return $k},_22Q:function(){return Rh},getX:function(){return this.p().x},setX:function(K){this.p(K,this.p().y)},getY:function(){return this.p().y},setY:function(l){this.p(this.p().x,l)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(E){this.setAnchor(E,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(i){this.setAnchor(this.getAnchor().x,i)},getScaleX:function(){return this.getScale().x},setScaleX:function(X){this.setScale(X,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(C){this.setScale(this.getScale().x,C)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(j){var $=(new xc).setFromQuaternion(j,xc.ReverseOrder(this.getRotationMode()));return this.r3($.x,$.y,$.z)},getQuaternion:function(){return(new _i).setFromEuler(this.getEuler())},getEuler:function(){var z=this.r3();return(new xc).set(z[0],z[1],z[2],xc.ReverseOrder(this.getRotationMode()))},setEuler:function(c){return c=c.clone().reorder(xc.ReverseOrder(this.getRotationMode())),this.r3(c.x,c.y,c.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(K,d){yb(K,cq(w,w,this.r3(),this.getRotationMode())),this.translate3d(K[0]*d,K[1]*d,K[2]*d)},translateFront:function(Y){this.translate3dBy([0,0,1],Y)},translateBack:function(a){this.translate3dBy([0,0,-1],a)},translateLeft:function(H){this.translate3dBy([-1,0,0],H)},translateRight:function(Q){this.translate3dBy([1,0,0],Q)},translateTop:function(e){this.translate3dBy([0,1,0],e)},translateBottom:function(q){this.translate3dBy([0,-1,0],q)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(h,B,u){1===arguments.length&&(B=h[1],u=h[2],h=h[0]),this.p(h,u),this.setElevation(B)},translate3d:function(T,t,Q){1===arguments.length&&(t=T[1],Q=T[2],T=T[0]),this.translate(T,Q),this.setElevation(this._54O+t)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(r,x,L){1===arguments.length&&(x=r[1],L=r[2],r=r[0]),this.setSize(r,L),this.setTall(x)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(X,G,x){1===arguments.length&&(G=X[1],x=X[2],X=X[0]),this.setRotationX(X),this.setRotation(-G),this.setRotationZ(x)},setRotationY:function(r){this.setRotation(-r)},getRotationY:function(){return-this._64O},lookAtDirection:function(H,U){U=U||_j;var d=this,Q=qd(H);U===_j?(d.r3([-m(H[1]/Q),-K(H[2],H[0])+T,0]),d.setRotationMode("xzy")):U===hn?(d.r3(0,-K(H[2],H[0]),m(H[1]/Q)),d.setRotationMode("zyx")):U===vq?(d.r3(0,-K(H[2],H[0])+g,-m(H[1]/Q)),d.setRotationMode("zyx")):U===rd?(d.r3([-m(H[1]/Q)+T,-K(H[2],H[0])+T,0]),d.setRotationMode("xzy")):U===fi&&(d.r3([-m(H[1]/Q)-T,-K(H[2],H[0])+T,0]),d.setRotationMode("xzy")),U===bf&&(d.r3([-m(H[1]/Q)+g,-K(H[2],H[0])+T,g]),d.setRotationMode("zxy"))},lookAt:function($,M){return this.lookAtDirection(Wn($,this.p3()),M)},lookAtX:function(){var w=new Zb,q=new Zb,X=new Zb,W=new _p,o=new _p,y=new xc;return function(m,S){var F=ub(this);if(W.fromArray(F),X.copy(this.p3()),w.copy(m).sub(X),!(w.lengthSq()<1e-6)){w.normalize(),S===_j?q.set(0,0,1):S===bf?q.set(0,0,-1):S===vq?q.set(-1,0,0):S===hn?q.set(1,0,0):S===rd?q.set(0,1,0):S===fi&&q.set(0,-1,0),q.applyMatrix4(W).sub(X).normalize();var I=Math.acos(w.dot(q));if(I){var H=w.clone().cross(q);H.lengthSq()<1e-6&&(S===rd||S===fi?H.set(0,0,1).applyMatrix4(W).sub(X):H.set(0,1,0).applyMatrix4(W).sub(X)),H.normalize(),y.set(this.r3(),this.getRotationMode(),!0),W.makeRotationFromEuler(y),o.makeRotationAxis(H,-I),y.setFromRotationMatrix(o.multiply(W)),this.r3([y.x,y.y,y.z])}}}}(),getHost:function(){return this._host},setHost:function(n){var W=this;if(W!==n&&W._host!==n){var b=W._host;b&&b._removeAttach(W),W._host=n,W._host&&W._host._addAttach(W),W.fp("host",b,n),W.onHostChanged(b,n)}},getAttaches:function(){return this._69O},_addAttach:function(x){var y=this;y._69O||(y._69O=new Pk),y._69O.add(x),y.fp("attaches",w,x)},_removeAttach:function(r){var C=this;C._69O.remove(r),C._69O.isEmpty()&&delete C._69O,C.fp("attaches",r,w)},getImage:function(){if(this._pendingCheckImageJSON){var O=Y.getImage(this._image);O&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof sh&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(B){var p=this,L=p._image,g=p.getWidth(),K=p.getHeight();p._image=B,p.fp("image",L,B)&&(null!=B&&(np(B)||ap(B)&&/\.json$/i.test(B))&&(this._pendingCheckImageJSON=!0),p.fp(rl,g,p.getWidth()),p.fp(fc,K,p.getHeight()))},getElevation:function(){return this._54O},setElevation:function(L){var Y=this;if(!Y._50O){Y._50O=1;var V=Y._54O;Y._54O=L,Y.fp(yh,V,L),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(U){var M=this;if(!M._49O){M._49O=1;var q=M._64O;M._64O=U,M.fp(Pj,q,U),delete M._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(j){var H=this;if(!H._51O){H._51O=1;var S=H._rotationX;H._rotationX=j,H.fp("rotationX",S,j),delete H._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(E){var p=this;if(!p._52O){p._52O=1;var d=p._53O;p._53O=E,p.fp("rotationZ",d,E),delete p._52O}},getPosition:function(){return this._position},setPosition:function(Z,R){var N=this;if(!N._50I){N._50I=1;var V;if(V=2===arguments.length?{x:Z,y:R}:Z,V.x!==N._position.x||V.y!==N._position.y){var K=N._position;N._position=V,N.fp(ie,K,V)}delete N._50I}},translate:function(V,F){var W=this._position;this.p(W.x+V,W.y+F)},getWidth:function(){var J=this;if(J._width>=0)return J._width;var r=J.getStyle("shape3d");if(r){var L=kk(r);if(L&&L.rawS3)return L.rawS3[0];if("billboard"===r||"plane"===r){var z=Ub(J.getStyle("shape3d.image"));return z?To(z,J):20}}var z=Ub(J._image);return z?To(z,J):20},setWidth:function(X){var i=this,k=i._width;i._width=X,i.fp(rl,k,X)},getHeight:function(){var r=this;if(r._height>=0)return r._height;var V=r.getStyle("shape3d");if(V){var O=kk(V);if(O&&O.rawS3)return O.rawS3[2];if("plane"===V){var i=Ub(r.getStyle("shape3d.image"));return i?md(i,r):20}if("billboard"===V)return 2}var i=Ub(r._image);return i?md(i,r):20},setHeight:function(W){var U=this,j=U._height;U._height=W,U.fp(fc,j,W)},getTall:function(){var d=this;if(d._tall>=0)return d._tall;var H=d.getStyle("shape3d");if(H){var h=kk(H);if(h&&h.rawS3)return h.rawS3[1];if("billboard"===H){var J=Ub(d.getStyle("shape3d.image"));return J?md(J,d):20}if("plane"===H)return 2}return 20},setTall:function(D){var o=this,x=o._tall;o._tall=D,o.fp("tall",x,D)},setSize:function(m,y){var r=this;2===arguments.length?(r.setWidth(m),r.setHeight(y)):(r.setWidth(m.width),r.setHeight(m.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(W,o,U,e,a){var r=this,u=r.getAnchor(),X=r.getScale();arguments.length<=2&&(a=o,o=W.y,U=W.width,e=W.height,W=W.x);var z=a&&X.x<0?1-u.x:u.x,S=a&&X.y<0?1-u.y:u.y;r.p(W+U*z,o+e*S),a&&(U/=Math.abs(X.x),e/=Math.abs(X.y)),r.setWidth(U),r.setHeight(e)},getMatrix:function(){var n=this,j=n._64O,K=n._position,Y=n.getScale();return new $r(j,K.x,K.y,Y.x,Y.y)},getAnchorRect:function(){var T=this,z=T.getWidth(),l=T.getHeight(),C=T.getAnchor();return{x:-z*C.x,y:-l*C.y,width:z,height:l}},toLocal:function(d){return this.getMatrix().tfi(d)},toGlobal:function(t){return this.getMatrix().tf(t)},getAttachPosition:function(){var c=new $r;return function(y,B,Z,l){Z=Z||0,l=l||0;var T=this,b=T.getAnchor(),r=T._64O,W=T._position,p=T.getScale();return c.setFromTransform(r,W.x,W.y).tf({x:Z+p.x*T.getWidth()*(y-b.x),y:l+p.y*T.getHeight()*(B-b.y)})}}(),isInRect:function(H){H=this.toLocal(H);var C=this.getWidth(),b=this.getHeight();return H.x+=C*this.getAnchorX(),H.y+=b*this.getAnchorY(),!(H.x<0||H.y<0||H.x>C||H.y>b)},getRect:function(){var F=this,j=F.getWidth(),X=F.getHeight(),D=F.getAnchor(),t={x:-j*D.x,y:-X*D.y,width:j,height:X},M=F.getMatrix();return t=ln([M.tf(t.x,t.y),M.tf(t.x+t.width,t.y),M.tf(t.x+t.width,t.y+t.height),M.tf(t.x,t.y+t.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var h=this,P=h.getAnchor(),j=h._anchorElevation;return{x:P.x,y:j,z:P.y}},setAnchorElevation:function(P){var H=this,C=H._anchorElevation;return C!==P?(H._anchorElevation=P,H.fp("anchorElevation",C,P),!0):!1},setAnchor3d:function(H,g,o,i){var Y,j=this;"number"==typeof H?Y={x:H,y:g,z:o}:(Y=H.length?{x:H[0],y:H[1],z:H[2]}:H,i=g);var A=j.getDataModel();A&&A.beginTransaction();var W=j.getAnchor3d(),b=j.setAnchor(Y.x,Y.z);if(j.setAnchorElevation(Y.y)&&(b=!0),b&&i&&!Gj){j.getAnchor3d();var V=ub(j),e=yb([Y.x-W.x,Y.y-W.y,Y.z-W.z],V);j.p3(e)}return A&&A.endTransaction(),b},getAnchor:function(){var W=this;if(W.hasOwnProperty("_anchor"))return W._anchor;
var q=Ub(W._image);return q&&q.anchorX!==r?{x:q.anchorX,y:q.anchorY}:W._anchor},setAnchor:function(z,g,h){var s,Q=this;"number"==typeof z?s={x:z,y:g}:(s=z.length?{x:z[0],y:z[1]}:z,h=g);var B=Q.getAnchor();if(B.x!==s.x||B.y!==s.y){var $=Q.getDataModel();if($&&$.beginTransaction(),Q._anchor=s,Q.fp("anchor",B,s),h&&!Gj){var K=Q.getPosition(),D=Q.getSize(),P=Q.getRotation(),N=Q.getScale(),p=-D.width*(B.x-s.x)*N.x,Y=-D.height*(B.y-s.y)*N.y,c=O(P),H=f(P);Q.setPosition(K.x+H*p-c*Y,K.y+c*p+H*Y)}return $&&$.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(E,U){var r,M=this;r=2===arguments.length?{x:E,y:U}:E;var V=M.getScale();(V.x!==r.x||V.y!==r.y)&&(M._scale=r,M.fp("scale",V,r))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var K=this,L=K._scaleTall,p=K.getScale();return[p.x,L,p.y]},getFinalScale3d:function(){var V=this,E=V.s3(),w=V._dynamicScale3d,s=V.getScale3d();return E&&(s[0]*=E[0],s[1]*=E[1],s[2]*=E[2]),w&&(s[0]*=w[0],s[1]*=w[1],s[2]*=w[2]),s},getFinalRotation3d:function(){var Q=this;return Q._dynamicRotation||Q.r3()},setScaleTall:function(t){var Q=this,g=Q._scaleTall;g!==t&&(Q._scaleTall=t,Q.fp("scaleTall",g,t))},setScale3d:function(z,G,A){var e,L=this;e="number"==typeof z?{x:z,y:G,z:A}:z.length?{x:z[0],y:z[1],z:z[2]}:z,L.setScaleTall(e.y),L.setScale(e.x,e.z)},getCorners:function(W,k){W==w&&(W=0),k==w&&(k=W);var h=this,g=h.getAnchor(),t=h.getWidth(),z=h.getHeight(),E=-t*g.x-W,q=-z*g.y-k,u=t+2*W,j=z+2*k,a=h.getMatrix();return[a.tf(E,q),a.tf(E,q+j),a.tf(E+u,q+j),a.tf(E+u,q)]},getEditControlPoints:function(x,h,E){h==w&&(h=0),E==w&&(E=h);var Z=this,V=Z.getAnchor(),F=Z.getWidth(),Q=Z.getHeight(),o=-F*V.x-h,S=-Q*V.y-E,K=F+2*h,c=Q+2*E;if(x)return[{x:o,y:S},{x:o,y:0},{x:o,y:S+c},{x:0,y:S+c},{x:o+K,y:S+c},{x:o+K,y:0},{x:o+K,y:S},{x:0,y:S}];var p=Z.getMatrix();return[p.tf(o,S),p.tf(o,0),p.tf(o,S+c),p.tf(0,S+c),p.tf(o+K,S+c),p.tf(o+K,0),p.tf(o+K,S),p.tf(0,S)]},rotateAt:function(o,E,l){var S=this,d=S._position,N=S._64O,H=new $r(N,d.x,d.y).tf(o,E),A=G(o*o+E*E),V=K(d.y-H.y,d.x-H.x)+l;S.setRotation(N+l),S.p(H.x+A*f(V),H.y+A*O(V))},onParentChanged:function(){Wd.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var c={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(o){c[o]=!0}),function(t){var _=this;Wd.superClass.onPropertyChanged.call(_,t),c[t.property]&&!_._layoutUpdating&&_.updateLayoutParameters(null,t.property),_._69O&&_._69O.each(function(z){z.handleHostPropertyChange(t)}),_._49I&&_._49I.each(function(s){s.fp("agentChange",!0,!1)}),"a:layout"===t.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(W){this.updateAttach(W)},onStyleChanged:function(N){Wd.superClass.onStyleChanged.apply(this,arguments),Gl[N]&&this.updateAttach()},updateAttach:function(g){var n=this;return Gj?(n.updateLayoutParameters(),void 0):(n._51I||(n._51I=1,n._71O(g),delete n._51I),void 0)},_71O:function(_){var R,u,V,g,f,x,r,U,H=this,n=H._host,p=_?_.property:w,S=_?_.oldValue:w,B=_?_.newValue:w;if(n instanceof Wd&&(r=Ub(n.getImage()),r&&r.layoutAttach&&(U=r.layoutAttach)),_&&!Db[p]&&"a:layout"!==p.substring(0,8)||!U||U(n,this))if(n instanceof s.Grid){if(p===yh)H.setElevation(H._54O+B-S);else if(!_||is[p]){if(R=H.s("attach.row.index"),u=H.s("attach.column.index"),V=n.getCellRect(R,u),!V)return;g=H.s("attach.row.span"),f=H.s("attach.column.span"),(1!==g||1!==f)&&(V=_f(V,n.getCellRect(R+g-1,u+f-1))),hm(V,H,"attach.padding",1),H.setRect(V)}}else if(n instanceof gj&&(x=H.s("attach.index"))>=0&&(!_||Qd[p])){var m=H.s("attach.thickness"),I=n.getScale(),h=Math.max(I.x,I.y);m>0&&H.setHeight(n.getThickness()*m*h);var Y=H.s("attach.offset"),c=n.getPoints(),k=c.size();if(k>x){var q=n.getPointsMatrix2d(),o=c.get(x),C=k===x+1?c.get(0):c.get(x+1);o=q.apply(o),C=q.apply(C);var e=[C.x-o.x,C.y-o.y],d=qd(e);if(d){H.s("attach.offset.relative")&&(Y*=d),H.s("attach.offset.opposite")&&(Y=d-Y);var M={x:o.x+e[0]/d*Y,y:o.y+e[1]/d*Y},v=H.s("attach.gap");v&&(H.s("attach.gap.relative")&&(v*=n.getThickness()*h),M=qe(w,M,C,v)),H.p(M),H.setRotation(K(e[1],e[0]))}}}else _&&(p===ie?H.translate(B.x-S.x,B.y-S.y):p===yh?H.setElevation(H._54O+B-S):vl[p]?H._11Q(n,p,B-S):("anchor"===p||"width"===p||"height"===p||"scale"===p)&&H.layout(n))},_11Q:function(){var c=new s.Math.Euler,z=s.Math.Euler.ReverseOrder,r=new s.Math.Vector2,e=new s.Math.Vector2;return function(T,X,a){var f=this,t=T.p3(),v=T.r3(),g=f.p3(),J=f.r3();if(X===Pj&&(X="rotationY",a=-a),(X===Pj||"rotationY"===X)&&0===J[0]&&0===J[2]&&0===v[0]&&0===v[2]&&0===g[1]&&0===t[1])return f.setRotation(-J[1]-a),r.set(g[0],g[2]).rotateAround(e.set(t[0],t[2]),-a),f.p(r.x,r.y),void 0;var N=Ib[T.getRotationMode()],Y=N[0],I=N[1],V=N[2],B=Dd[Y],$=Dd[I],m=Dd[V],d=Vd();X===Pj+Y?(m(d,v[Zf[V]]),$(d,v[Zf[I]]),B(d,a),$(d,-v[Zf[I]]),m(d,-v[Zf[V]])):X===Pj+I?(m(d,v[Zf[V]]),$(d,a),m(d,-v[Zf[V]])):X===Pj+V&&m(d,a);var G=Wn(g,t);yb(G,d),f.p3(t[0]+G[0],t[1]+G[1],t[2]+G[2]);var n=f.getRotationMode();Ye(d,f.r3(),n),c.setFromRotationMatrix(d,z(n)),f.r3([c.x,c.y,c.z])}}(),isHostOn:function($){var D=this;if(D._host&&$&&$._69O)for(var V={},m=D._host;m&&m!==D&&!V[m._id];){if(m===$)return!0;V[m._id]=m,m=m._host}return!1},isLoopedHostOn:function(b){return this.isHostOn(b)&&b.isHostOn(this)},getScaledSize:function(){var F=this.getSize(),J=this.getScale();return F.width*=Math.abs(J.x),F.height*=Math.abs(J.y),F},layout:function(X){if(X=X||this.getHost()){var g=this,z=g.s("layout.h")||"center",I=g.s("layout.v")||"center";if("center"!==z||"center"!==I){var O=new s.Math.Vector2,S=X.getPosition(),i=X.getAnchor(),K=X.getScaledSize();g.getPosition();var R,q,v,j,d,u=1,n=1;switch(g._layoutUpdating=!0,z){case"left":O.setX(g._layoutHValue-i.x*K.width);break;case"right":O.setX((1-i.x)*K.width-g._layoutHValue);break;case"leftright":R=K.width-g._layoutHValue[2],v=g.getRotation()-X.getRotation(),j=Math.abs(Math.sin(v)),d=Math.abs(Math.cos(v)),u+=d*R/g._layoutHValue[3],n+=j*R/g._layoutHValue[4],O.setX(g._layoutHValue[1]+(g._layoutHValue[5]-i.x)*K.width);break;case"center":O.setX((.5-i.x)*K.width-g._layoutHValue);break;case"scale":v=g.getRotation()-X.getRotation(),j=Math.abs(Math.sin(v)),d=Math.abs(Math.cos(v)),O.setX((.5-i.x)*K.width-g._layoutHValue[1]*K.width/g._layoutHValue[0]),q=K.width/g._layoutHValue[2]-1,u+=d*q,n+=j*q}switch(I){case"top":O.setY(g._layoutVValue-i.y*K.height);break;case"bottom":O.setY((1-i.y)*K.height-g._layoutVValue);break;case"topbottom":v||(v=g.getRotation()-X.getRotation(),j=Math.abs(Math.sin(v)),d=Math.abs(Math.cos(v))),R=K.height-g._layoutVValue[2],u+=j*R/g._layoutVValue[3],n+=d*R/g._layoutVValue[4],O.setY(g._layoutVValue[1]+(g._layoutVValue[5]-i.y)*K.height);break;case"center":O.setY((.5-i.y)*K.height-g._layoutVValue);break;case"scale":v||(v=g.getRotation()-X.getRotation(),j=Math.abs(Math.sin(v)),d=Math.abs(Math.cos(v))),O.setY((.5-i.y)*K.height-g._layoutVValue[1]*K.height/g._layoutVValue[0]),q=K.height/g._layoutVValue[2]-1,u+=j*q,n+=d*q}if("leftright"===z||"scale"===z||"topbottom"===I||"scale"===I){var o=this.getScale(),N=Math.abs(o.x),a=Math.abs(o.y);"leftright"===z||"scale"===z?g.setSize(g._layoutHValue[3]*u/N,g._layoutHValue[4]*n/a):g.setSize(g._layoutVValue[3]*u/N,g._layoutVValue[4]*n/a)}O.rotateAround(null,X.getRotation()),this.setPosition(O.x+S.x,O.y+S.y),g._layoutUpdating=r}}},updateLayoutParameters:function(h,t){if(h=h||this.getHost()){var Z=this,a=Z.s("layout.h"),f=Z.s("layout.v");if(a||f){var S,Q,X,E,C,F,n=new s.Math.Vector2,K=h.getPosition(),r=h.getAnchor(),k=h.getScaledSize(),D=Z.getPosition(),i=Z.getScaledSize();switch(n.set(D.x-K.x,D.y-K.y),n.rotateAround(null,-h.getRotation()),a){case"left":Z._layoutHValue=n.x+r.x*k.width;break;case"right":Z._layoutHValue=-n.x+(1-r.x)*k.width;break;case"center":Z._layoutHValue=-n.x+(.5-r.x)*k.width;break;case"leftright":case"scale":"scale"===a?S=-n.x+(.5-r.x)*k.width:(Q=Z.getAnchor(),X=Z.getRotation()-h.getRotation(),E=Math.cos(X),C=Math.sin(X),F=-Math.min(-Q.x*E+Q.y*C,-Q.x*E-(1-Q.y)*C,(1-Q.x)*E+Q.y*C,(1-Q.x)*E-(1-Q.y)*C),S=n.x-(F-r.x)*k.width),"position"===t&&"object"==typeof Z._layoutHValue?(Z._layoutHValue[0]=k.width,Z._layoutHValue[1]=S):Z._layoutHValue=[k.width,S,k.width,i.width,i.height,F]}switch(f){case"top":Z._layoutVValue=n.y+r.y*k.height;break;case"bottom":Z._layoutVValue=-n.y+(1-r.y)*k.height;break;case"center":Z._layoutVValue=-n.y+(.5-r.y)*k.height;break;case"topbottom":case"scale":"scale"===f?S=-n.y+(.5-r.y)*k.height:(X||(Q=Z.getAnchor(),X=Z.getRotation()-h.getRotation(),E=Math.cos(X),C=Math.sin(X)),F=-Math.min(-Q.x*C-Q.y*E,-Q.x*C+(1-Q.y)*E,(1-Q.x)*C-Q.y*E,(1-Q.x)*C+(1-Q.y)*E),S=n.y-(F-r.y)*k.height),"position"===t&&"object"==typeof Z._layoutVValue?(Z._layoutVValue[0]=k.height,Z._layoutVValue[1]=S):Z._layoutVValue=[k.height,S,k.height,i.width,i.height,F]}}}},getSerializableProperties:function(){var $=Wd.superClass.getSerializableProperties.call(this);return xl($,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),$}});var Ne=s.Edge=function(P,w){var Z=this;Lh(Ne,Z),Z.setSource(P),Z.setTarget(w)};Je("Edge",Xo,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Xf},_22Q:function(){return Jd},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(M){if(M===this)return!1;if(Km(M))return!0;for(var p,d,T,O,Q,l=[this],L=-1,I=0;I>L;)if(L++,p=l[L],d=p._44I)for(d=d.getArray(),O=0,Q=d.length;Q>O;O++)if(T=d[O],Dn(T)&&!(l.indexOf(T)>=0)){if(T===M)return!1;l.push(T),I++}return!0},setSource:function(t){var O=this;if(O._source!==t&&O.canSetSourceTarget(t)){var I=O._source;O._source=t,I&&I._16I(O),t&&t._2I(O),O._7I(),O.fp("source",I,t)}},setTarget:function(S){var T=this;if(T._target!==S&&T.canSetSourceTarget(S)){var w=T._target;T._target=S,w&&w._18I(T),S&&S._4I(T),T._7I(),T.fp("target",w,S)}},isLooped:function(){var s=this;return s._source===s._target&&Km(s._source)&&Km(s._target)},onPropertyChanged:function(){var o=this;o._49I&&o._49I.each(function(V){V.fp("agentChange",!0,!1)})},_7I:function(){var W,l=this,F=vp(l);l._40I!==F&&(W=this._40I,W&&W._15I(l),l._40I=F,F&&F._1I(l),l.fp("sourceAgent",W,F),Bj(W,l._41I),Bj(F,l._41I));var H=jb(l);l._41I!==H&&(W=l._41I,W&&W._17I(l),l._41I=H,H&&H._3I(l),l.fp("targetAgent",W,H),Bj(W,l._40I),Bj(H,l._40I))},_22I:function(k){this._52I=k,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var R=this;return R._52I&&R._52I.get(0)!==R&&!R.getStyle(ng)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var k=this,t=k._52I;return t&&!k.getStyle(ng)&&t.size()>1&&k===t.get(0)},toggle:function(){this.beginTransaction();var C=this._52I,u=!this.s(ng);C&&C.size()>1&&(C.each(function(y){y.s(ng,u)}),C.getSiblings().each(function(l){l!==C&&l.each(function(N){N.fp("edgeGroup",w,l)})})),this.endTransaction()},setStyle:function(t,T){(t===cs||"edge.segments"===t)&&(T=wb(T)),Ne.superClass.setStyle.call(this,t,T)},onStyleChanged:function(j){Ne.superClass.onStyleChanged.apply(this,arguments),wh[j]&&Bj(this._41I,this._40I)},getSerializableProperties:function(){var S=Ne.superClass.getSerializableProperties.call(this);return xl(S,{source:1,target:1}),S}});var jp=s.Group=function(){Lh(jp,this)};Je("Group",Wd,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return zl},onChildAdded:function(){jp.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){jp.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var r=this;if(!r._54I&&!Gj){var v=r.getChildrenRect();v&&(r._53I=1,r.p(Cm(r.s("group.position"),v,r.getSize())),delete r._53I)}},getChildrenRect:function(){var Q,D=this;return D.eachChild(function(w){Km(w)&&(Q=_f(Q,D.getChildRect(w)))}),Q},getChildRect:function(G){var k;return Km(G)&&G.s($e)&&(Qq(G)&&G.isExpanded()&&G.eachChild(function(F){k=_f(k,G.getChildRect(F))}),!k&&G.getRect&&(k=G.getRect())),k},setPosition:function(y,$){var x=this;if(!x._54I){var m;m=2===arguments.length?{x:y,y:$}:y,Gj||x._53I||(x._54I=1,$m(x._children,m.x-x._position.x,m.y-x._position.y),delete x._54I),jp.superClass.setPosition.call(this,m)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(g){var m=this;if(m._57O!==g){var y=m._57O;m._57O=g,m.fp("expanded",y,m._57O),m._fireInvalidateDeep(),m._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(S){Qq(S)?S._fireInvalidateDeep():S.iv()})},_8I:function(){jp.superClass._8I.call(this),this.eachChild(function($){Km($)&&$._8I()})},onStyleChanged:function(l){jp.superClass.onStyleChanged.apply(this,arguments),"group.position"===l&&this._81I()},getSerializableProperties:function(){var h=jp.superClass.getSerializableProperties.call(this);return h.expanded=1,h}});var So=s.Block=function(){Lh(So,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Je("Block",Wd,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return kd},_22Q:function(){return Pe},onChildAdded:function(){So.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){So.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function e(k,y,U){V.fromArray(ub(y));var o=y.getAnchor3d();k.push((new Zb).set(0-o.x,0-o.y,0-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(0-o.x,0-o.y,1-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(0-o.x,1-o.y,0-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(0-o.x,1-o.y,1-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(1-o.x,0-o.y,0-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(1-o.x,0-o.y,1-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(1-o.x,1-o.y,0-o.z).applyMatrix4(V).applyMatrix4(U)),k.push((new Zb).set(1-o.x,1-o.y,1-o.z).applyMatrix4(V).applyMatrix4(U))}function i(B,A){var J=(new _p).makeRotationFromEuler(this.getEuler()).setPosition((new Zb).fromArray(this.p3()));J.getInverse(J),B.forEach(function(D){Km(D)&&e(A,D,J)})}var V=new _p;return function(m,V){if(m instanceof Wd&&(m=[m]),!m||0===m.length)return w;var V=[];i.call(this,m,V);var M=[1/0,1/0,1/0],R=[-1/0,-1/0,-1/0];return V.forEach(function(n){M[0]=Math.min(n.x,M[0]),M[1]=Math.min(n.y,M[1]),M[2]=Math.min(n.z,M[2]),R[0]=Math.max(n.x,R[0]),R[1]=Math.max(n.y,R[1]),R[2]=Math.max(n.z,R[2])}),{min:M,max:R}}}(),updateFromChildren:function(){var k=this;if(!Gj&&!k._updatingToChildren&&k._syncSize&&0!==k.size()&&!k._freezeSyncFromChildren){var i=this._getBoundingBox(k.toChildren(Km));if(i){k._updatingFromChildren=1;var n=(new Zb).fromArray(this.getScale3d()),R=(new Zb).fromArray(i.min),v=(new Zb).fromArray(i.max),U=Y.blockMinSize,W=new Zb,V=v.clone().sub(R);0===V.x&&W.setX(.5),0===V.y&&W.setY(.5),0===V.z&&W.setZ(.5);var $=this._width==w||-1===this._width,u=new Zb(this.getAnchor3d());if($||this._anchorChanged||!this.s("keepPosition")){var N=u.clone().multiply(V).add(R).applyEuler(this.getEuler()).add((new Zb).fromArray(this.p3()));this.p3([N.x,N.y,N.z])}else{var s=n.clone().multiply((new Zb).fromArray(this.s3())),p=V.clone();0===p.x&&p.setX(U),0===p.y&&p.setY(U),0===p.z&&p.setZ(U);var o=u.clone().multiply(s),b=o.clone().multiplyScalar(-1).sub(R).divide(p).add(o.divide(p)).add(W);this.setAnchor3d(b.x,b.y,b.z)}var B=new Zb(1,1,1).divide(n).multiply(V);this.s3(Math.abs(B.x),Math.abs(B.y),Math.abs(B.z)),delete k._updatingFromChildren}}},setPosition:function(Q,g){var x=this;if(!x._updatingToChildren){var l;l=2===arguments.length?{x:Q,y:g}:Q,Gj||x._updatingFromChildren||(x._updatingToChildren=1,$m(x._children,l.x-x._position.x,l.y-x._position.y),delete x._updatingToChildren),So.superClass.setPosition.call(this,l)}},setSize3d:function(){this.beginTransaction(),So.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(T){var b=this;if(!b._updatingToChildren){this.beginTransaction(),T=i(T,Y.blockMinSize);var V=b.getTall();if(T!==V&&So.superClass.setTall.call(b,T),!Gj&&!b._updatingFromChildren){b._updatingToChildren=1;var S=T/V;b._adjustChildTallOrScale(S,"size"),delete b._updatingToChildren,b.updateFromChildren()}this.endTransaction()}},setWidth:function(h){return this.setSize(h,this.getHeight())},setHeight:function(y){return this.setSize(this.getWidth(),y)},setSize:function(z,d){var n=Y.blockMinSize;z=i(z,n),d=i(d,n);var b=this;if(!b._updatingToChildren){2!==arguments.length&&(d=z.height,z=z.width),this.beginTransaction();var W=b.getWidth(),G=b.getHeight();if(z!==W&&So.superClass.setWidth.call(b,z),d!==G&&So.superClass.setHeight.call(b,d),!Gj&&!b._updatingFromChildren){b._updatingToChildren=1;var _=z/W,J=d/G;b._adjustChildScaleOrSize(_,J,"size"),delete b._updatingToChildren,b.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(Y,B,l){var j=this;if(j._syncSize){var w=j.getPosition(),o=j.getRotation();j.getScale(),j.eachChild(function(M){if(Km(M)){var F=M.getPosition(),m=M.getRotation(),y=M.getWidth(),t=M.getHeight(),X=M.getScale(),_=X.x*y,R=X.y*t;if(0!==_&&0!==R){var c=new $r(m,F.x,F.y,_,R);c.translate(-w.x,-w.y),c.rotate(-o),m=K(c.b*Math.sign(_),c.a*Math.sign(_)),c.scale(Y,B);var H,W,A,T=f(m);if(Math.abs(T)<.001?(H=O(m),W=c.b/H,A=-c.c/H):(W=c.a/T,A=c.d/T),"scale"===l)M.setScale(W/y,A/t);else if("size"===l){var p=W/X.x,x=A/X.y;M.setScale(Mh(W)*Math.abs(X.x),Mh(A)*Math.abs(X.y)),M instanceof s.Shape?(M.setWidthForce(Math.max(Math.abs(p),1e-5)),M.setHeightForce(Math.max(Math.abs(x),1e-5))):M.setSize(Math.max(.01,Math.abs(p)),Math.max(.01,Math.abs(x)))}c.rotate(o),c.translate(w.x,w.y),M.setPosition(c.tx,c.ty)}}})}},_calcChangeFactor:function(n,F,N,Q){var k,V,P,h;return k=J(n),V=J(N),P=k>V?k/V:V/k,k=J(F),V=J(Q),h=k>V?k/V:V/k,i(P,h)},setElevation:function(K){var y=this;if(!y._updatingToChildren){var F=y.getElevation(),N=K-F;0!==N&&(Gj||y._updatingFromChildren||(y._updatingToChildren=1,$m(y._children,0,N,0),delete y._updatingToChildren),So.superClass.setElevation.apply(y,arguments))}},setScaleTall:function(Q){var l=this;if(!l._updatingToChildren){var $=l.getScaleTall();if(J(Q)<.01&&(Q=.01*(Mh(Q)||Mh($))),So.superClass.setScaleTall.call(l,Q),!Gj&&!l._updatingFromChildren){l._updatingToChildren=1;var W=Q/$;l._adjustChildTallOrScale(W,"size"),delete l._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(A,w){var g=this;if(g._syncSize){var z=g.getElevation();g.eachChild(function(S){if(Km(S))if("size"===w){var b=S.getTall();0>A&&S.setScaleTall(-1*S.getScaleTall()),S.setTall(Math.max(.01,Math.abs(b*A))),S.setElevation(z+(S.getElevation()-z)*A)}else{var f=S.getScaleTall();S.setScaleTall(f*A)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var i=So.superClass.setAnchor3d.apply(this,arguments);return i&&!Gj&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),i}},setAnchor:function(){var J=this;if(!J._updatingToChildren){var Q=J.getAnchor(),m=So.superClass.setAnchor.apply(J,arguments);if(Gj||J._updatingFromChildren||!J._syncSize)return m;J._updatingToChildren=1;var S=J.getAnchor();J.getPosition();var L=J.getSize(),$=J.getScale(),n=J.getRotation(),Y=-L.width*$.x*(Q.x-S.x),X=-L.height*$.y*(Q.y-S.y),w=O(n),H=f(n),F=H*Y-w*X,j=w*Y+H*X;return J.eachChild(function(p){if(Km(p)){var b=p.getPosition();p.setPosition(b.x-F,b.y-j)}}),delete J._updatingToChildren,m}},setAnchorElevation:function(){var R=this;if(!R._updatingToChildren){var m=R.getAnchorElevation(),i=So.superClass.setAnchorElevation.apply(R,arguments);if(Gj||R._updatingFromChildren||!R._syncSize)return i;R._updatingToChildren=1;var O=R.getAnchorElevation(),n=R.getTall(),P=R.getScaleTall(),T=-n*P*(m-O);return R.eachChild(function(a){if(Km(a)){var N=a.getElevation();a.setElevation(N-T)}}),delete R._updatingToChildren,i}},setRotation:function(h){this._updateChildrenRotation3d("rotation",h)},setRotationX:function(p){this._updateChildrenRotation3d("rotationX",p)},setRotationZ:function(O){this._updateChildrenRotation3d("rotationZ",O)},_updateChildrenRotation3d:function(h,O){var D=this;if(!D._updatingToChildren){var f=D[dq(h)]();if(So.superClass[Pm(h)].call(D,O),!Gj&&!D._updatingFromChildren){D._updatingToChildren=1;var G=O-f;D.eachChild(function(t){Km(t)&&t._11Q(D,h,G)}),delete D._updatingToChildren}}},setScale:function(g,r){var i=this;if(!i._updatingToChildren){null==r&&(r=g.y,g=g.x);var u=i.getScale();if(J(g)<.01&&(g=.01*(Mh(g)||Mh(u.x))),J(r)<.01&&(r=.01*(Mh(r)||Mh(u.y))),So.superClass.setScale.call(i,g,r),!Gj&&!i._updatingFromChildren){i._updatingToChildren=1;var X=g/u.x,U=r/u.y;i._adjustChildScaleOrSize(X,U,"size"),delete i._updatingToChildren,i.updateFromChildren()}}},onPropertyChanged:function(H){var J=this;So.superClass.onPropertyChanged.call(J,H),"s:3d.visible"===H.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(R){R.s("batch")&&R.iv(),R instanceof So&&R._invalidateChildrenBatch()})},getSerializableProperties:function(){var l=So.superClass.getSerializableProperties.call(this);return l.clickThroughEnabled=1,l.syncSize=1,l}});var Df=s.Grid=function(){Lh(s.Grid,this)};Je("Grid",Wd,{IRotatable:!1,_icon:"grid_icon",_image:w,getUIClass:function(){return oc},setRotation:function(){},getCellRect:function(G,c){var E=this,t=E.s("grid.row.count"),M=E.s("grid.column.count");if(0>=t||0>=M||0>G||G>=t||0>c||c>=M)return w;var b,m,Q,L=E.getRect(),J=E.s("grid.row.percents"),a=E.s("grid.column.percents");if(hm(L,E,"grid.border",-1),J&&J._as&&(J=J._as),a&&a._as&&(a=a._as),J&&J.length===t){for(Q=0,b=0;G>b;b++)Q+=L.height*J[b];L.y+=Q,L.height=L.height*J[G]}else L.height=L.height/t,L.y+=L.height*G;if(a&&a.length===M){for(m=0,b=0;c>b;b++)m+=L.width*a[b];L.x+=m,L.width=L.width*a[c]}else L.width=L.width/M,L.x+=L.width*c;return xg(L,-E.s("grid.gap")),L}});var vf=s.Text=function(){Lh(vf,this),this.setSize(100,50),this.s("text","TEXT")};Je("Text",Wd,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return fd},setWidth:function(H){H||(H=.001),vf.superClass.setWidth.call(this,H)},setHeight:function(k){k||(k=.001),vf.superClass.setHeight.call(this,k)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),We("__text__",{width:{value:100,isSafeFunc:!0,func:function(M){return M?M._width:100}},height:{value:50,isSafeFunc:!0,func:function(M){return M?M._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradientPack:{func:"style@text.gradient.pack"}}]});var gj=s.Shape=function(){Lh(gj,this),this._59O=new Pk};gj.__de__=zg,Je("Shape",Wd,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return $i},_22Q:function(){return fg},getLength:function(y){return th(Fi(this._59O,this._58O,y,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var h=this._58O;return h?new Pk(h._as.slice(0)):h},setSegments:function(a){var F=this._58O;a=a?wd(a)?new Pk(a.slice(0)):new Pk(a._as.slice(0)):null,(F&&a&&F._as.join(",")!==a._as.join(",")||F!==a)&&(this._58O=a,this.fp("segments",F,a))},getPoints:function(){return this._59O},toPoints:function(){var n=this._59O;return new Pk(n._as.slice(0))},getPointsMatrix2d:function(){var h=this,W=new ar.Matrix2d,f=h.getPosition(),v=h.getScale(),k=h.getRotation();return W.translate(-f.x,-f.y).scale(v.x,v.y).rotate(k).translate(f.x,f.y),W},getPointsMatrix3d:function(){return function(){var J=this,P=new ar.Matrix4,D=P.getElements(),j=J.p3();ze(D,j),Ye(D,J.getFinalRotation3d(),J.getRotationMode());var l=J.getScale3d(),y=J._dynamicScale3d;return y&&(l[0]*=y[0],l[1]*=y[1],l[2]*=y[2]),Ff(D,l),ze(D,oj(j)),P}}(),setPoints:function(D,s){var M=this,U=M._59O;D=D?wd(D)?new Pk(D.slice(0)):new Pk(D._as.slice(0)):new Pk;var r,$,v,T,z,u;s&&(r=M.getPosition(),u=new $r(M.getRotation(),0,0,M.getScale().x,M.getScale().y)),(U&&D&&U._as.join(",")!==D._as.join(",")||U!==D)&&(M._59O=D,M.fs(),M.fp("points",U,D)),s&&($=M.getPosition(),v=$.x-r.x,T=$.y-r.y,z=u.tf(v,T),M.setPosition($.x-v+z.x,$.y-T+z.y))},addPoint:function(E,f,D){var J=this.toPoints();J.add(E,f),this.setPoints(J,D)},setPoint:function(O,A,G){var a=this.toPoints();a.set(O,A),this.setPoints(a,G)},removePointAt:function(S){var e=this.toPoints();e.removeAt(S),this.setPoints(e)},setWidthForce:function($){var q=this;if(!q._55I&&!Gj&&q.getWidth()){q._55I=1;var n=q._position.x,g=$/q.getWidth(),x=q.toPoints(),j=new Pk;1!==g&&(x.each(function(e){j.add({x:(e.x-n)*g+n,y:e.y,e:e.e})}),q.setPoints(j),kf(q,[g,0,0,1,n*(1-g),0]),q.fs()),delete q._55I}gj.superClass.setWidth.call(q,$)},setWidth:function(b){return this.setWidthForce(Hp>b?Hp:b)},setHeightForce:function(q){var a=this;if(!a._55I&&!Gj&&a.getHeight()){a._55I=1;var P=a._position.y,B=q/a.getHeight(),I=a.toPoints(),e=new Pk;1!==B&&(I.each(function(G){e.add({x:G.x,y:(G.y-P)*B+P,e:G.e})}),a.setPoints(e),kf(a,[1,0,0,B,0,P*(1-B)]),a.fs()),delete a._55I}gj.superClass.setHeight.call(a,q)},setHeight:function(C){return this.setHeightForce(Hp>C?Hp:C)},setAnchorElevation:function(Z){var o=this;o._55I=!0;var p=o._updatingAnchor3d,q=!Gj&&!p;if(q){var m,g=Z,j=o.getAnchorElevation(),J=o.getTall();m=J*(j-g),0!==m&&o.shiftPointsElevation(m)}var i=gj.superClass.setAnchorElevation.apply(o,arguments);return p||delete o._55I,i},getShapeElevation:function(){var H=this,S=H._54O;return S-(H.getTall()||0)*(H._anchorElevation-.5)},setAnchor3d:function(K,Q,F,U){var I,m=this;"number"==typeof K?I={x:K,y:Q,z:F}:(I=K.length?{x:K[0],y:K[1],z:K[2]}:K,U=Q),m._55I=!0,m._updatingAnchor3d=!0;var i=m.getDataModel();if(i&&i.beginTransaction(),!Gj){var O=m.getAnchor3d(),t=m.getSize(),x=m.getTall(),V=t.width*(O.x-I.x),n=t.height*(O.z-I.z),v=x*(O.y-I.y);U||m.shiftPoints(V,n,v);var l=m.p3()}var J=gj.superClass.setAnchor3d.apply(m,arguments);if(!Gj&&U){var S=m.p3();m.shiftPoints(S[0]-l[0]+V,S[2]-l[2]+n,S[1]-l[1]+v)}return i&&i.endTransaction(),delete m._updatingAnchor3d,delete m._55I,J},setAnchor:function(H,k,S){var W=this;W._55I=!0;var J=W._updatingAnchor3d,Y=!Gj&&!J;if(Y){var b,u,c;"number"==typeof H?c={x:H,y:k}:(c=H.length?{x:H[0],y:H[1]}:H,S=k);var m=W.getAnchor(),i=W.getSize();b=i.width*(m.x-c.x),u=i.height*(m.y-c.y),S||W.shiftPoints(b,u);var h=W.getPosition()}var s=gj.superClass.setAnchor.apply(W,arguments);if(Y){var f=W.getPosition();S&&W.shiftPoints(f.x-h.x+b,f.y-h.y+u)}return J||delete W._55I,s},shiftPoints:function(l,p,c){if(l||p||c){var n=this,q=n.getElevation()||0,A=n.toPoints(),K=new Pk;A.each(function(u){var o=u.e;c&&(o=(o==w?q:o)+c),K.add({x:u.x+l,y:u.y+p,e:o})}),n.setPoints(K),n.fs()}},shiftPointsElevation:function(g){return this.shiftPoints(0,0,g)},setPosition:function(s,A){var X,O=this;if(!O._28Q){if(O._28Q=1,!O._55I&&!Gj){X=2===arguments.length?{x:s,y:A}:s;var Q=X.x-O._position.x,g=X.y-O._position.y;if(0===Q&&0===g)return delete O._28Q,void 0;O._55I=1,O.shiftPoints(Q,g),kf(O,[1,0,0,1,Q,g]),delete O._55I}gj.superClass.setPosition.apply(O,arguments),delete O._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var m=this;if(2!==m._59O.size())return!1;var p=m._58O;return p?2===p.size()&&1===p.get(0)&&2===p.get(1)?!0:!1:!0},fireShapeChange:function(){var A=this;if(!A._55I&&!Gj){var L=ln(A._59O);L&&(A._55I=1,A.setRect(L),delete A._55I)}A.fp(ii,!1,!0)},getSerializableProperties:function(){var $=gj.superClass.getSerializableProperties.call(this);return $.segments=1,$.points=1,$.thickness=1,$.closePath=1,$}});var pd=s.Points=function(){Lh(pd,this)};Je("Points",Wd,{_22Q:function(){return Ds},setPoints:function(A){this.points=A,this._pointsDirty=!0,this.fp("points",w,this.points)},setPoint:function(l,O){this.points||(this.points=[]),this.points[3*l]=O[0],this.points[3*l+1]=O[1],this.points[3*l+2]=O[2],this._pointsDirty=!0,this.fp("points",w,this.points)},setPointsColor:function(n){this.colors=n,this._colorsDirty=!0,this.fp("colors",w,this.colors)},setPointColor:function(c,D){this.colors||(this.colors=[]),D?(D=er(D),this.colors[3*c]=D[0],this.colors[3*c+1]=D[1],this.colors[3*c+2]=D[2]):(this.colors[3*c]=r,this.colors[3*c+1]=r,this.colors[3*c+2]=r),this._colorsDirty=!0,this.fp("colors",w,this.colors)},setPointsSize:function(H){this.sizes=H,this._sizesDirty=!0,this.fp("sizes",w,this.sizes)},setPointSize:function(S,F){this.sizes||(this.sizes=[]),this.sizes[S]=F?F:r,this._sizesDirty=!0,this.fp("sizes",w,this.sizes)},getPointInfo:function(m){var D=3*m,u=this.points;if(!u||u[D]===r||u[D+1]===r||u[D+2]===r)return null;var l=[u[D],u[D+1],u[D+2]],F=this.mat||ub(this),T=[l[0],l[1],l[2]];yb(T,F);var g=this.colors;return{size:this.sizes&&this.size[m]||this.s("points.size"),color:g&&g[D]?[g[D],g[D+1],g[D+2]]:this.s("points.color"),local:l,world:T}},getSerializableProperties:function(){var C=pd.superClass.getSerializableProperties.call(this);return C.points=1,C.colors=1,C.sizes=1,C}});var rn=s.Polyline=function(){Lh(rn,this),this.s({"shape.background":null,"shape.border.width":2})};Je("Polyline",gj,{_icon:"polyline_icon",_22Q:function(){return Es},getUIClass:function(){return Gh},setClosePath:function(){},setTall:function($){var k=this,m=k.getDataModel();if(m&&m.beginTransaction(),!k._55I&&!k._24Q&&!Gj&&k.getTall()){k._24Q=1;var _=k._54O,M=$/k.getTall();if(1!==M){var B=k.toPoints(),q=new Pk;B.each(function(g){q.add({x:g.x,y:g.y,e:g.e==w?g.e:(g.e-_)*M+_})}),k.setPoints(q),k.fs()}delete k._24Q}rn.superClass.setTall.call(k,$),m&&m.endTransaction()},setElevation:function(u){var b=this,D=b.getDataModel();if(D&&D.beginTransaction(),!b._55I&&!b._24Q&&!Gj){b._24Q=1;var C=u-b._54O;0!==C&&b.shiftPointsElevation(C),delete b._24Q}rn.superClass.setElevation.apply(b,arguments),D&&D.endTransaction()},fireShapeChange:function(){var S=this,l=S._59O;if(!S._55I&&!S._24Q&&!Gj){var j=l.size();if(j){var $=1,e=l.get(0),V=S._54O;e.e==w&&(e.e=V);for(var Z=e.e,M=0;j>$;$++){e=l.get($),e.e==w&&(e.e=V);var z=X(Z,e.e),W=i(Z+M,e.e);Z=z,M=W-z}S._24Q=1,S.setTall(M),S.setElevation(Z+M*S._anchorElevation),delete S._24Q}}rn.superClass.fireShapeChange.apply(S,arguments)}});var wf=s.SubGraph=function(){Lh(wf,this)};Je("SubGraph",Wd,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){wf.superClass._8I.call(this),this.eachChild(function(J){Km(J)&&J._8I()})}}),Y.loadingRefGraph=0;var sh=s.RefGraph=function(){Lh(sh,this)};Je("RefGraph",So,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(J){var C=this._ref;this._ref=J,this.fp("ref",C,J),this.updateRef()},_21I:function(){sh.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var l=this;if(Y.loadingRefGraph++,l.clearChildrenFromDataModel(),Y.loadingRefGraph--,l._ref&&l._dataModel){l._xhrLoadHandler&&(l._xhrLoadHandler.cancel=!0);var O=Gj,z=l._xhrLoadHandler=function($){if($&&l._dataModel){Y.loadingRefGraph++;var P=l._pendingUpdateInfo={needToRestore:O};O&&(P.p3=l.p3(),P.s3=l.s3(),P.r3=l.r3(),P.anchor3d=l.getAnchor3d(),P.scale3d=l.getScale3d()),l.r3(0,0,0),l.setScale3d(1,1,1),l.setAnchor3d(.5,.5,.5),l.p3(0,0,0);var p=Y.parse($),y=l._dataModel.deserialize(p,l,{justDatas:!0});y.each(function(p){p._refGraph=l}),l.checkPendingUpdateInfo(),Y.loadingRefGraph--,Y.handleRefGraphLoaded(l,y,p)}};z.xhrLoadCalled=!1,Y.load(l._ref,function(C){z.cancel||(z.xhrLoadCalled?z(C):pm(function(){z(C)
}))}),z.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var Z=this,S=Z._pendingUpdateInfo;if(!S)return Z.onPendingUpdated&&(Y.loadingRefGraph++,Z.onPendingUpdated(),Y.loadingRefGraph--),void 0;var M=!0;this.eachChild(function(N){(N._pendingCheckImageJSON||N._pendingUpdateInfo)&&(M=!1)}),M&&(Y.loadingRefGraph++,Z._pendingUpdateInfo=null,Z.updateFromChildren(),S.needToRestore&&(Z.setAnchor3d(S.anchor3d),Z.setScale3d(S.scale3d),Z.r3(S.r3),Z.p3(S.p3)),this.getParent()instanceof sh&&this.getParent().checkPendingUpdateInfo(),Z.onPendingUpdated&&Z.onPendingUpdated(),Y.loadingRefGraph--)},getSerializableProperties:function(){var b=sh.superClass.getSerializableProperties.call(this);return b.ref=1,b}}),s.EdgeGroup=function(H,f){this._70O=H,this._siblings=f;for(var z,d,Z=0,m=H.size(),D=V[ng];m>Z;Z++)if(z=H.get(Z).getStyle(ng,!1),z!=w){D=z;break}D==w&&(D=!0);var t=Y.edgeGroupAgentFunc;for(t&&(d=t(H),d&&d!==H.get(0)&&(H.remove(d),H.add(d,0))),Z=0;m>Z;Z++)H.get(Z).s(ng,D)},Je("EdgeGroup",R,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(r){return this._70O.get(r)},indexOf:function(z){return this._70O.indexOf(z)},each:function(x,u){this._70O.each(x,u)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(l,G){this._siblings.each(function(a){a._70O.each(l,G)})}});var Sc=function(j,y,D){var X=In[j]={type:j,action:y};if(D)for(var u in D)X[u]=D[u]};xl(Y,{setConnectAction:Sc,getConnectAction:function(I,K){if(!K){if(!I)return null;K=I.getCurrentConnectActionType()}return In[K]},doConnectAction:function(J,d,o,m){m=m||J.getCurrentConnectActionType();var R=In[m];if(!R)return!1;var B=R.action;return B?(d instanceof Ph.Group?J.sm().getSelection().each(function(G){B.call(null,J,G,o)}):B.call(null,J,d,o),!0):!1},doDeleteConnectionAction:function(O,p,l){l=l||O.getCurrentConnectActionType();var k=In[l];if(!k||!k.delete)return!1;var T=k.delete.action;return T?(p instanceof Ph.Group?O.sm().getSelection().each(function(p){T.call(null,O,p)}):T.call(null,O,p),!0):!1}});var Qc=s.JSONSerializer=function(q,r){this.dm=this._dataModel=q,this._hierarchical=Y.forceHierarchicalSerialization?!0:r==w?q.isHierarchicalRendering():r};Je("JSONSerializer",R,{ms_ac:["hierarchical"],serialize:function(q){return Y.stringify(this.toJSON(),q)},toJSON:function(){var X=this,T=X.dm,d=T.getRoots(),w=X.json={v:Y.getVersion(),p:{},a:{},d:[]},$=T.getSerializableAttrs();T.getInit()&&(w.init=T.getInit()),T.getName()&&(w.p.name=T.getName()),T.getBackground()&&(w.p.background=T.getBackground()),T.getLayers()&&(w.p.layers=T.getLayers()),T.getEnvmap()&&(w.p.envmap=T.getEnvmap()),T.isCubicEnvmap()&&(w.p.cubicEnvmap=T.isCubicEnvmap()),w.p.autoAdjustIndex=T.isAutoAdjustIndex(),w.p.hierarchicalRendering=T.isHierarchicalRendering();for(var n in $){var u=T.a(n);u!==r&&X[bs](n,u,w.a)}return Ae(w.a)&&delete w.a,X._hierarchical?d.each(X.serializeData,this):T.each(function(m){X.serializeData(m)}),T.fireSerializeEvent({type:"serialize",json:w}),T.getPostProcessingData()&&(w.p.postProcessingData=T.getPostProcessingData()),w},isSerializable:function(){return!0},getProperties:function(K){return K.getSerializableProperties()},getStyles:function(J){return J.getSerializableStyles()},getAttrs:function(A){return A.getSerializableAttrs()},serializeData:function(G){var v=this;if(v.isSerializable(G)&&!G._refGraph){var t,J,r,N,H=Fr(G.getClassName())||G.getClass(),z=new H,l={c:G.getClassName(),i:G.getId(),p:{},s:{},a:{}};v.json.d.push(l),t=v.getProperties(G);for(J in t)if(/^_/.test(J)){if(r=G[J],!("_width"!==J&&"_height"!==J||r!=w&&-1!==r)){var K;((G.s("layout.h")||G.s("layout.v"))&&G.getHost()||G instanceof s.Node&&(K=G.getParent())&&K instanceof s.Block||G.s("fullscreen"))&&(r=G[J]="_width"===J?G.getWidth():G.getHeight())}r!==z[J]&&v[bs](J.substr(1),r,l.p)}else N=dq(J),G[N]&&(r=G[N](),r!==z[N]()&&v[bs](J,r,l.p));t=v.getStyles(G);for(J in t)r=G.s(J),r!==z.s(J)&&v[bs](J,r,l.s);t=v.getAttrs(G);for(J in t)r=G.a(J),r!==z.a(J)&&v[bs](J,r,l.a);Ae(l.p)&&delete l.p,Ae(l.s)&&delete l.s,Ae(l.a)&&delete l.a}v._hierarchical&&G.getChildren().each(v.serializeData,v)},serializeValue:function(m,f,P){aq(f)?f={__a:f._as}:f instanceof Xo?f={__i:f.getId()}:f instanceof Rb&&(f={__dm:f.serialize(0)}),P[m]=f},deserialize:function(G,C,g){var z=this;return ap(G)&&/.json$/.test(G)?(Y.xhrLoad(G,function(o){z.deserializeImpl(o,C,g)}),void 0):z.deserializeImpl(G,C,g)},deserializeImpl:function(Z,a,e){var E=this,u=E.dm;u.setDeserializing(!0),e=Of(e)?{setId:e}:Ln(e)?{finishFunc:e}:e||{},Z=E.json=ap(Z)?Y.parse(Z):Z,!e.justDatas&&Z.a&&Z.a.onPreDeserialize&&!e.disableOnPreDeserialize&&Z.a.onPreDeserialize(Z,u,e.view),u.beginTransaction(),Gj++,E._82I={};var x=new Pk,r=new Pk,R=0,s=Z.d.length;if(e.justDatas||(!e.disableInit&&Ln(Z.init)&&Z.init(u),u.setInit(Z.init)),!e.justDatas){for(var O in Z.a)u.a(O,E[Sg](Z.a[O]));for(var y in Z.p)u[Pm(y)](Z.p[y])}for(;s>R;R++){var i=Z.d[R],W=Fr(i.c),L=new W,B=i.i;e.setId&&B!=w&&(L._id=B),E._82I[B]=L,x.add(L),r.add(i)}for(R=0;s>R;R++)E.deserializeData(x.get(R),r.get(R));return x.each(function(R){a&&!R.getParent()&&R.setParent(a),u.add(R)}),e.__innerHandler__&&e.__innerHandler__(Z,u,e.view,x),u.fireSerializeEvent({type:"deserialize",json:Z}),Gj--,u.endTransaction(),!e.justDatas&&Z.a&&Z.a.onPostDeserialize&&!e.disableOnPostDeserialize&&Z.a.onPostDeserialize(Z,u,e.view,x),e.finishFunc&&e.finishFunc(Z,u,e.view,x),u.setDeserializing(!1),x},deserializeData:function(G,x){for(var i in x.p)G[Pm(i)](this[Sg](x.p[i]));for(i in x.s)G.s(i,this[Sg](x.s[i]));for(i in x.a)G.a(i,this[Sg](x.a[i]))},deserializeValue:function(l){if(np(l)){var a=l.__i;if(a!=w)return this._82I[a];if(a=l.__dm,a!=w){var z=new s.DataModel;return z.deserialize(a),z}if(a=l.__a,wd(a))return new Pk(a)}return l}}),xl(Rb,{serialize:function(u,B){return new Qc(this,B).serialize(u)},toJSON:function(R){return new Qc(this,R).toJSON()},deserialize:function(e,D,I){return new Qc(this).deserialize(e,D,I)}});var Jh=s.OverlappingBox=function(g){this.gv=g,this.boxes={}};Je("OverlappingBox",R,{clear:function(){var r,S,K=this.boxes;for(r in K)S=K[r],S.length=0},isOverlapping:function(i,E){var b,F,G=this,x=G.boxes,Z=x[i];Z?(b=Z.rects,F=Z.length):Z=x[i]={rects:b=[],length:F=0};var P,s,E;for(P=0;F>P;P++)if(s=b[P],s.x<E.x+E.w&&s.x+s.w>E.x&&s.y<E.y+E.h&&s.h+s.y>E.y)return!0;return b.length<=F?(b.push(E),Z.length++):b[Z.length++]=E,!1}}),xl(Y,{fetch:function(r,P){var E="GET",v=!1,w=null,b="";P&&(E=P.method||"GET",v=P.sync,b=P.url,w=P.data||null),r.open(E,b,!v),P.responseType?r.responseType=P.responseType:P.overrideMimeType&&r.overrideMimeType&&r.overrideMimeType(P.overrideMimeType),r.send(w)},convertImageSrc:function(n,e){e&&"function"==typeof e||(e=function(){}),e(n)}});var cd=s.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Je("Request",R,{_responseType:null,_overrideMimeType:"text/plain",send:function(S){var f=this._xhr,i=this.onload,k=this.onerror;this.getResponseType()?S.responseType=this.getResponseType():this.getOverrideMimeType()&&(S.overrideMimeType=this.getOverrideMimeType()),f.onload=i,f.onerror=k,Y.fetch(f,S)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Y){this._responseType=Y},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(X){this._overrideMimeType=X},getResponseText:function(){var W=this._xhr;return W.response||W.responseText}}),Om.GraphView=function(c){var j=this;j._24I={},j._34I=new Pk,j._25I={},j._56I={},j._view=xf(1,j),j._canvas=de(j._view),j.dm(c?c:new Rb),this._coreInteractor=new rh(this),j.setEditable(!1),j.setScrollBarVisible(Y.graphViewScrollBarVisible),j._initView()},$j("GraphView",R,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[rf,sd,wq,ri,"resettable","editInteractor",Dr,"zoomable","pannable","rectSelectable","autoScrollZone",Zg,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:Y.graphViewZoomable,_resettable:Y.graphViewResettable,_pannable:Y.graphViewPannable,_rectSelectable:Y.graphViewRectSelectable,_autoScrollZone:Y.graphViewAutoScrollZone,_rectSelectBackground:Y.graphViewRectSelectBackground,_rectSelectBorderColor:Y.graphViewRectSelectBorderColor,_editPointSize:Y.graphViewEditPointSize,_editPointBorderColor:Y.graphViewEditPointBorderColor,_editPointBackground:Y.graphViewEditPointBackground,_scrollBarColor:Lc,_scrollBarSize:qn,_autoHideScrollBar:ck,_autoMakeVisible:im,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(k){this._dataModel.setLayers(k)},setEditable:function(B){var V=this,h=V.__interactorMap__;if(!h){var J=Om.XEditInteractor;h=V.__interactorMap__={scrollBar:new bm(V),select:new tl(V),edit:J?new J(V):new Mc(V),text:new uk(V),move:new Cf(V),"default":new Gf(V),touch:new Vc(V,{editable:!1})}}B?(V._uieditable=!0,V.setInteractors([h.scrollBar,h.select,h.edit,h.text,h.move,h.default,h.touch])):(V._uieditable=!1,V.setInteractors([h.scrollBar,h.select,h.move,h.default,h.touch]))},getCanvas:function(){return this._canvas},_33I:function(l){var b=l.getUIClass();return b?new b(this,l):w},getDataUI:function(C){var v=this,R=v._25I[C._id];return R===r&&(R=v._33I(C),v._25I[C._id]=R),R},getNodeRect:function(L){return Y.getNodeRect(this,L)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(j){var i=this.getDataUI(j);return i?(i._79o(),i._78o):null},getEdgeSourcePosition:function(O){var H=this,u=H.getDataUI(O),g=u.s,x=u._data._40I;return fo(H,x,g("edge.source.position"),g("edge.source.offset.x"),g("edge.source.offset.y"),g("edge.source.anchor.x"),g("edge.source.anchor.y"))},getEdgeTargetPosition:function(i){var f=this,z=f.getDataUI(i),g=z.s,d=z._data._41I;return fo(f,d,g("edge.target.position"),g("edge.target.offset.x"),g("edge.target.offset.y"),g("edge.target.anchor.x"),g("edge.target.anchor.y"))},invalidateAll:function(T){var J=this;if(T){for(var t in J._25I){var D=J._25I[t];D&&D.dispose()}J._25I={},J._56I={},J._24I={},J._34I.clear(),J.redraw()}else J.dm().each(function(m){J.invalidateData(m)})},invalidateSelection:function(){var z=this;z.sm().each(function(Q){z.invalidateData(Q)})},invalidateData:function(S){var J=this;J._24I[S._id]=S,J._21Q(S),J.iv()},_21Q:function(X){var z=this,R=z._24I;if(Dn(X)&&$q[X.s(Th)]){var x=X.getSourceAgent();x&&x.getAgentEdges().each(function(D){R[D._id]=D}),x=X.getTargetAgent(),x&&x.getAgentEdges().each(function(n){R[n._id]=n}),z.iv()}},redraw:function(V){var e=this;e._32I||(V?e._34I.add(V):(e._32I=1,e._34I.clear()),e.iv())},each:function(w,e){var T,E,O,r=0,X=this.getLayers(),g=this._dataModel,v=g._datas._as,k=v.length;if(X){for(var G=X.length;G>r;r++)if(O=X[r],np(O)&&(O=O.name),g.isHierarchicalRendering()){var $=function(C){return C._layer===O?e?w.call(e,C):w(C):void 0};if(this._dataModel.eachByHierarchical($)===!1)return}else for(var l=0;k>l;l++)if(T=v[l],T._layer===O&&(E=e?w.call(e,T):w(T),E===!1))return}else if(g.isHierarchicalRendering())this._dataModel.eachByHierarchical(w,null,e);else for(;k>r;r++)if(T=v[r],E=e?w.call(e,T):w(T),E===!1)return},reverseEach:function(W,Y){var k,O,G,b,L=this._dataModel,p=L._layers,i=L._datas._as,U=i.length;if(p){for(k=p.length-1;k>=0;k--)if(b=p[k],np(b)&&(b=b.name),L.isHierarchicalRendering()){var q=function(w){return w._layer===b?Y?W.call(Y,w):W(w):void 0};if(L.reverseEachByHierarchical(q)===!1)return}else for(var Q=U-1;Q>=0;Q--)if(O=i[Q],O._layer===b&&(G=Y?W.call(Y,O):W(O),G===!1))return}else if(L.isHierarchicalRendering())L.reverseEachByHierarchical(W,null,Y);else for(k=U-1;k>=0;k--)if(O=i[k],G=Y?W.call(Y,O):W(O),G===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var M=this,G=M._84I;if(!G){var f=this.dm().a("width"),n=this.dm().a("height");f>0&&n>0?M._84I={x:0,y:0,width:f,height:n}:(M.each(function(e){M.isVisible(e)&&(G=_f(G,M.getDataUIBounds(e)))}),M._84I=G?G:Jq)}return M._84I},getScrollRect:function(){return _f(this.getContentRect(),this._29I)},makeCenter:function(H,F,B){var X=this;if(!X.getWidth()||!X.getHeight())return B||pm(X.makeCenter,X,[H,F,!0],500),void 0;X.makeVisible(H),X.validate();var E=X.getDataUIBounds(H);if(E){var N=X.getWidth(),f=X.getHeight(),A=E.x+E.width/2,L=E.y+E.height/2,K=-A*X._zoom+N/2,x=-L*X._zoom+f/2;X.setTranslate(K,x,F)}},fitData:function(D,Q,M,W,d){var n=this;if(!n.getWidth()||!n.getHeight())return d||pm(n.fitData,n,[D,Q,M,W,!0],500),void 0;var J=function(){n.makeVisible(D),n.validate();var R=n.getDataUIBounds(D);R&&(R=fq(R),xg(R,M==w?20:M),n.fitRect(R,Q,W))};Q?Y.callWhenLoaded(J):J()},fitContent:function(H,N,Z,k){var J=this;if(!J.getWidth()||!J.getHeight())return k||pm(J.fitContent,J,[H,N,Z,!0],500),void 0;var t=function(){J.validate();var x=fq(J.getContentRect());xg(x,N==w?20:N),J.fitRect(x,H,Z)};H?Y.callWhenLoaded(t):t()},fitRect:function(O,k,n){var H=this,d=H.getWidth(),F=H.getHeight(),E=O.x+O.width/2,i=O.y+O.height/2,r=X(d/O.width,F/O.height),S=H._zoom,c=-E*S+d/2,Y=-i*S+F/2;0===r||isNaN(r)||(n&&(r=X(1,r)),k?(H._65I&&(delete H._65I.finishFunc,H._65I.stop(!0)),H._14o&&H._14o.stop(!0),H.setTranslate(c,Y,{finishFunc:function(){H.setZoom(r,k)}})):(H.setTranslate(c,Y),H.setZoom(r)))},fitSelection:function(V,x,L){var j=this,m=j.sm(),J=null;m.size()&&(m.each(function($){J=_f(j.getDataUIBounds($),J)}),V&&xg(J,V),j.fitRect(J,x,L))},toCanvas:function(V,n,Z){n=n||this._zoom,this.validateImpl();var b=this,t=b.getContentRect();Z&&xg(t,Z),t.width||(t.width=10),t.height||(t.height=10);var x=de(),O=t.x*n,I=t.y*n,d=Math.ceil(t.width*n),f=Math.ceil(t.height*n);Vp(x,d,f,1);var G=_d(x);return V=V||this._dataModel.getBackground(),V&&pb(G,0,0,d,f,V),Hn(G,-O,-I),G.scale(n,n),b._42(G),G.restore(),x},toDataURL:function(X,q,e,j){return this.toCanvas(X,e,j).toDataURL(q||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(m,W){var e=this,F=e.dm().getBackground();if(F){var T=e.dm().a("width"),S=e.dm().a("height");T>0&&S>0&&pb(m,0,0,T,S,F)}var p=e.__htmlOrderList,P=[],x=e._forcedLayoutHTML;if(e._93db(m,W),e.each(function(D){var G=e.getDataUI(D);if(G){var J=e._56I[D._id],B=G._htmlView;if(J){var a=G._79o();if(B=G._htmlView,s.HtmlNode&&D instanceof s.HtmlNode)G._42(m);else{var k=e.getViewRect(),u=B&&B.layoutHTML;!W||Uh(W,a)?(u&&(B.layoutHTML(),G.__outerLayout&&delete G.__outerLayout),G._42(m)):Uh(k,a)||!u||G.__outerLayout&&!x||(B.layoutHTML(),G.__outerLayout=!0)}}B&&(P.push(B),B.getView&&(B=B.getView()),B.style.display=J?"block":to)}}),p&&P.length>0){var C=!1;if(p.length!==P.length)C=!0;else for(var o=0;o<P.length;o++)if(P[o]!==p[o]){C=!0;break}C&&(P.forEach(function(H){H.autoAdjustIndex!==!1&&e.appendHTML(H,!0)}),this.__htmlOrderList=P)}else this.__htmlOrderList=P;e._92db(m,W)},validateImpl:function(){this.tryUpdateRootData();var e,y,r,A,S,T=this,H=T.tx(),B=T.ty(),s=T._zoom,V=T._canvas,q=this.getWidth(),O=this.getHeight(),c=T._29I,R={x:-H/s,y:-B/s,width:q/s,height:O/s},o={},U=T._34I,p=T._24I,P=T._32I,j=T._23I;T._24I={},(q!==V.clientWidth||O!==V.clientHeight)&&(Vp(V,q,O),P=1,T._forcedLayoutHTML=1),P||uo(R,c)||(P=1,T._forcedLayoutHTML=1),T._29I=R,T.each(function(a){y=a._id;var X=o[y]=T.isVisible(a);X!==T._56I[y]&&(p[y]=a,r=T.getDataUI(p[y]),r&&r._84o(X),T._84o(a,X))},T);for(y in p)r=T.getDataUI(p[y]),r&&(!P&&T._56I[y]&&(S=r._79o(),S&&U.add(S)),r.invalidate()),T._83I=1;if(T._56I=o,!P)for(y in p)o[y]&&(r=T.getDataUI(p[y]),r&&(S=r._79o(),S&&U.add(S)));if(P?A=R:(U.each(function(M){Uh(R,M)&&(A=_f(A,M))}),A&&(xg(A,i(1,1/s)),A.x=C(A.x*s)/s,A.y=C(A.y*s)/s,A.width=v(A.width*s)/s,A.height=v(A.height*s)/s,A=Xk(R,A))),T._74O=A,A&&0!==A.width&&0!==A.height){e=_d(V);var g=A.x,a=A.y,x=A.width,J=A.height;g=Math.floor((g*s+H)*Co),a=Math.floor((a*s+B)*Co),x=Math.ceil(x*s*Co)+1,J=Math.ceil(J*s*Co)+1,P||(A.x=(g/Co-H)/s,A.y=(a/Co-B)/s,A.width=x/Co/s,A.height=J/Co/s),e.beginPath(),e.rect(g,a,x,J),e.clip(),e.clearRect(g,a,x,J),Kh(e,H,B,s),T._42(e,A),e.restore(),delete T._74O}if(U.clear(),delete T._32I,delete T._forcedLayoutHTML,j&&q>0&&O>0){var r=T.getDataUI(j);if(r){var S=r._79o(),n=T._29I,W=n.x,d=n.y,l=n.width,K=n.height,s=T._zoom;S&&!Uh(S,n)&&(S.x+S.width<W&&T.tx(-S.x*s),S.x>W+l&&T.tx(-(S.x+S.width-l)*s),S.y+S.height<d&&T.ty(-S.y*s),S.y>d+K&&T.ty(-(S.y+S.height-K)*s))}delete T._23I}T._83I&&(delete T._83I,delete T._84I),T._98O(),T.countFrame(),Ae(T._24I)||pm(T.iv,T)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var W,P=this.getFullscreenDatas();for(var h in P)W=P[h],this.scaleRootData(W);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(H){var L=H.s("fullscreen");if("uniform"===L||"fill"===L){H.getRotation()&&H.setRotation(0);var t=H.s("fullscreen.gap")||0,d=this.getWidth(),S=this.getHeight();if(d&&S){var F,n,T,v=d-2*t,Z=S-2*t,w=H.getAnchor(),A=H.getScaledSize(),N=A.width,i=A.height,x=H.s("fullscreen.lock");if(x)return"uniform"===L?v/Z>N/i?(F=Z/i,N=i*v/Z):(F=v/N,i=N*Z/v):"v"===x?(F=Z/i,N=v/F,H.getWidth()!==N&&H.setWidth(N)):(F=v/N,i=Z/F,H.getHeight()!==i&&H.setHeight(i)),this.setZoom(F),n=t-(H.getX()-w.x*N)*F,T=t-(H.getY()-w.y*i)*F,n!==this.tx()&&this.tx(n),T!==this.ty()&&this.ty(T),void 0;n=this.tx(),T=this.ty(),F=this._zoom;var s={x:(-n+t)/F,y:(-T+t)/F,width:v/F,height:Z/F};if("uniform"===L){var V=N/i,D=Math.min(s.width,s.height*V),P=D/V;s.x+=.5*(s.width-D),s.y+=.5*(s.height-P),s.width=D,s.height=P}v=s.width/H.getScaleX(),Z=s.height/H.getScaleY(),(H.getWidth()!=v||H.getHeight()!==Z)&&H.setSize(v,Z);var p=s.x+w.x*s.width,y=s.y+w.y*s.height,C=H.getPosition();(p!==C.x||y!==C.y)&&H.setPosition(p,y)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(u){var k=this;u!==k.isScrollBarVisible()&&(u?(Ld(k._view,k._79O=Zn()),Ld(k._79O,k._27I=Zn()),Ld(k._79O,k._28I=Zn())):(zk(k._79O),delete k._79O,delete k._27I,delete k._28I),k.fp("scrollBarVisible",!u,u))},getDebugTip:function(){return""},showScrollBar:function(){var L=this;L._79O&&(L._85I||(fr(function(){L._86I()},Lp),L.iv()),L._85I=new Date)},_86I:function(){var W=this;if(W._85I){var p=new Date,B=p.getTime();B-W._85I.getTime()>=Lp?(delete W._85I,W.iv()):fr(function(){W._86I()},Lp)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var P=this,x=this._27I,k=this._28I;if(P._79O){if(P._autoHideScrollBar&&!P._85I)return x.style.visibility=$h,k.style.visibility=$h,void 0;var d=P.getScrollBarColor(),Y=P._zoom,b=P.getScrollBarSize(),h=P.getViewRect(),w=P.getScrollRect(),i=h.height*Y,m=w.height*Y,p=h.width*Y-b-2,L=i*((h.y-w.y)*Y/m),$=i*(i/m),z=x.style;m-.5>i?(ph>$&&(L=L+$/2-ph/2,0>L&&(L=0),L+ph>i&&(L=i-ph),$=ph),Ni(x,p,L,b,$),z.visibility=Ri,z.background=d,z.borderRadius=b/2+qf):z.visibility=$h;var y=h.width*Y,g=w.width*Y,L=h.height*Y-b-2,p=y*((h.x-w.x)*Y/g),R=y*(y/g),z=k.style;g-.5>y?(ph>R&&(p=p+R/2-ph/2,0>p&&(p=0),p+ph>y&&(p=y-ph),R=ph),Ni(k,p,L,R,b),z.visibility=Ri,z.background=d,z.borderRadius=b/2+qf):z.visibility=$h}},setDataModel:function(f){var D=this,g=D._dataModel,r=D._selectionModel;g!==f&&(g&&(g.ump(D.handleDataModelPropertyChange,D),g.umm(D.handleDataModelChange,D),g.umd(D.handleDataPropertyChange,D),g.removeIndexChangeListener(D._75O,D),g.removeHierarchyChangeListener(D.handleHierarchyChange,D),r||g.sm().ums(D.handleSelectionChange,D)),D._dataModel=f,f.mp(D.handleDataModelPropertyChange,D),f.mm(D.handleDataModelChange,D),f.md(D.handleDataPropertyChange,D),f.addIndexChangeListener(D._75O,D),f.addHierarchyChangeListener(D.handleHierarchyChange,D),r?r._21I(f):f.sm().ms(D.handleSelectionChange,D),D.invalidateAll(!0),D.fp(Ck,g,f),D.updateBackground())},getLayersInfo:function(){if(this._layersInfo===r){var k=this.getLayers();k?(this._layersInfo={},k.forEach(function(P){var G=np(P)?P.name:P;this._layersInfo[G]=P},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(H,o,n){var x,g,A=this,G=A.getDataUI(H),O=il(G),s=ne(o,function(C){return as(O,100*C)},100,.001),j=as(O,100*s);if(!n){var D=vk(G),N=new Vq(j.x,j.y),h=49/(A._zoom*A._zoom);for(x=0,g=D.length;g>x;x++)if(N.distanceToSquared(D[x])<h)return{index:x,point:D[x],distance:Math.sqrt((D[x].x-o.x)*(D[x].x-o.x)+(D[x].y-o.y)*(D[x].y-o.y))}}return{percent:s,point:j,distance:Math.sqrt((j.x-o.x)*(j.x-o.x)+(j.y-o.y)*(j.y-o.y))}},calculateAttachPoint:function(){var Q=new Vq,a=new Vq,e=new Vq;return function(P,v){var m=this.getAttachPoints(P);if(!m||!m.length)return null;e.set(v.x,v.y);for(var l,h,q,d,f,o=1/0,X=0,U=m.length;U>X;X++)q=m[X],a.x=q.x,a.y=q.y,Q.x=q.offsetX||0,Q.y=q.offsetY||0,d=fo(this,P,0,Q.x,Q.y,a.x,a.y),h=e.distanceToSquared(d),o>h&&(l=X,o=h,f=d);o=Math.sqrt(o);var G=this.getAttachStyle(P);if("close"===G){var V=P.s("attach.close.threshold")/this._zoom;if(o>V)return null}return{index:l,distance:o,info:m[l],point:f}}}(),getAttachPoints:function(V){var Q=V.s("attach.points");if(Q)return Q;var f=Ub(V._image);return f?Pb(f.attachPoints,V,this)||null:void 0},getAttachStyle:function(b){var J=b.s("attach.style");if(J)return J;var s=Ub(b._image);return s?Pb(s.attachStyle,b,this)||"close":void 0},updateLayers:function(){this._layersInfo=r,this.invalidateSelection(),this.redraw()},updateBackground:function(){var w=this.dm().a("width"),C=this.dm().a("height");this._canvas.style.background=w>0&&C>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(K){if("background"===K.property){var S=this._canvas.style.background,j=K.newValue||"";this.updateBackground(),this.fp("canvasBackground",S,j),this.redraw()}else"a:width"===K.property||"a:height"===K.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===K.property?this.updateLayers():"hierarchicalRendering"===K.property&&this.redraw()},handleDataPropertyChange:function(W){this.dm().isHierarchicalRendering()&&"parent"===W.property&&W.data.hasChildren()&&this.redraw(),this.invalidateData(W.data)},onPropertyChanged:function(V){var D=this,B=V.property;if(D.redraw(),"zoom"===B){var h=D.sm().getSelection();h.size()&&h.each(function(I){I.invalidate()})}else"dataModel"===B&&(D._83I=1);Zp[B]?D.showScrollBar():B===Dr&&D.onCurrentSubGraphChanged(V)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(K){var y=this,M=K.kind,s=K.data;if(y._83I=1,"add"===M)y.invalidateData(s),Dn(s)&&s.getEdgeGroup()&&s.getEdgeGroup().eachSiblingEdge(y.invalidateData,y);else if(M===Ge){y._21Q(s);var Q=s._id,p=y._25I[Q];if(p){if(y._56I[Q]){var R=p._79o();R&&y.redraw(R)}p.dispose(),delete y._25I[Q],delete y._24I[Q],delete y._56I[Q]}s===y._currentSubGraph&&y.setCurrentSubGraph(w)}else M===qb&&(y.invalidateAll(!0),y.setCurrentSubGraph(w))},_75O:function(f){this.invalidateData(f.data)},handleHierarchyChange:function(V){this.dm().isHierarchicalRendering()&&V.data.hasChildren()&&this.redraw(),this.invalidateData(V.data)},adjustIndex:function(e){var n=this;if(n.isVisible(e)){n.dm().beginTransaction();for(var E=e;E._parent&&n.isVisible(E._parent);)E=E._parent;E&&E!==e&&n._dataModel.adjustIndex(E),n._dataModel.adjustIndex(e),n.dm().endTransaction()}},getImage:function(N){return N.getImage?N.getImage():r},getSelectWidth:function($){var s=Ub(this.getImage($));return s&&Pb(s.disableSelectedBorder,$,this)?0:$.s("select.width")},getSelectColor:function(u){return u.s("select.color")},isSelectable:function(I,v){if(this.isSelected(I))return!0;if(!v&&I.getParent()instanceof So&&this.isSelectable(I.getParent(),!0)&&I.getParent().isSyncSize())return!1;var n=this.getLayersInfo();if(n){var s=n[I._layer];if(s&&s.selectable===!1)return!1}return I.s("2d.selectable")&&this.sm().isSelectable(I)},isMovable:function(F){var v=this;if(Dn(F)&&F.getStyle(Th)!==Tp)return!1;var U=this.getLayersInfo();if(U){var q=U[F._layer];if(q&&q.movable===!1)return!1}return F.s("2d.movable")?v._movableFunc?v._movableFunc(F):!0:!1},isEditable:function(u){var j=this;if(s._uiSerializing)return j._uieditable;if(!j._editInteractor||!j.isSelected(u))return!1;if(Qq(u)){var p=j.getDataUI(u);if(!p||p._88I)return!1}if(Dn(u)&&u.getStyle(Th)!==Tp)return!1;var Q=this.getLayersInfo();if(Q){var D=Q[u._layer];if(D&&D.editable===!1)return!1}return u.s("2d.editable")?j._editableFunc?j._editableFunc(u):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(g){return Km(g)&&0!==g.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(g):!0},isRectEditable:function(M){return this._rectEditableFunc?this._rectEditableFunc(M):!0},isAnchorEditable:function(L){return this._anchorEditableFunc?this._anchorEditableFunc(L):!0},isRotationEditable:function(k){return k.setRotation&&k.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(k):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(h){var X=h.getAnchor(),m=h.getScale(),g=this._zoom,R=Uo(h.getRotation(),0,-h.getHeight()*m.y*X.y-(m.y<0?-1:1)*(re?32:16)/g),x=h.p();return R.x+=x.x,R.y+=x.y,R},getLogicalPoint:function(n){var q=this;return bc(n,q._canvas,q.tx(),q.ty(),q._zoom,q._zoom)},getScreenPoint:function(S,L){var B,Q=this;return"object"==typeof S?S.x!==r?(B=S.x,L=S.y):(B=S[0],L=S[1]):B=S,De(B,L,Q._canvas,Q.tx(),Q.ty(),Q._zoom,Q._zoom)},getSelectedDataAt:function(H){var X=this;return this.getDataAt(H,function(W){return X.isSelected(W)})},getDataInfoAt:function(Q,F,V){var s,K=this.lp(Q),I=this.getDataAt(K,F,V);if(I){var n=this.getDataUI(I);s={data:I,ui:n,point:K};var j=n._38o;if(j){var l=j.icons;for(var $ in l){var m=l[$],c=j.rects[$];if(c)for(var X=Pb(m.names,I,this),i=X?X.length:0,x=c.rotation,q=i-1;q>=0;q--){var g=X[q],S=c[q];if(Vb(S,K,x))return s.part="icons",s.name=$,s.icon=g,s.rect=S,s.index=q,s.rotation=x,s}}}if(this.isNoteVisible(I)){if(n.note2Info&&Vb(n.note2Info.clickRect,K,w,n.note2Info.scale))return s.part="note2",s;if(n.noteInfo&&Vb(n.noteInfo.clickRect,K,w,n.noteInfo.scale))return s.part="note",s}if(this.isLabelVisible(I)){if(n.label2Info&&Vb(n.label2Info.rect,K,n.label2Info.rotation,n.label2Info.scale))return s.part="label2",s;if(n.labelInfo&&Vb(n.labelInfo.rect,K,n.labelInfo.rotation,n.labelInfo.scale))return s.part="label",s}if(I.isInRect&&I.isInRect(K))return s.part="body",s}return s},getDataAt:function(M,z,H){M.target&&(M=this.lp(M));var m,o=this._zoom;return this.reverseEach(function(R){return(z?z(R):this.isSelectable(R))&&this.rectIntersects(R,ih(M.x,M.y,H,o))?(m=R,!1):void 0},this),m},getIconInfoAt:function(y,C){var N=this;if(y.target&&(y=N.lp(y)),C||(C=N.getDataAt(y)),C){var m=N.getDataUI(C);if(m&&m._38o){var j,I=m._38o,J=new Pk;for(j in I.icons)J.add(j);for(var B=J.size()-1;B>=0;B--){j=J.get(B);for(var u=I.rects[j],O=u.rotation,s=u.length-1;s>=0;s--){var W=u[s],D=W.width,S=W.height,E={x:y.x-W.x-D/2,y:y.y-W.y-S/2};O!=w&&(E=Uo(-O,E.x,E.y));var W={x:-D/2,y:-S/2,width:D,height:S};if(Vb(W,E))return{key:j,index:s,name:I.icons[j].names[s],rect:u[s],point:y,rotation:O,relativeRect:W,relativePoint:E,data:C}}}}}return w},getDatasInRect:function(Z,b,o){o===r&&(o=1);var s=this,p=new Pk;return s.reverseEach(function(X){o&&!s.isSelectable(X)||(b?s.rectIntersects(X,Z):s.rectContains(X,Z))&&p.add(X)}),p},moveSelection:function(H,D){var W=this;W.dm().beginTransaction(),$m(W.sm().toSelection(W.isMovable,W),H,D),W.dm().endTransaction()},moveDatas:function(P,S,v){var H=this;H.dm().beginTransaction(),P instanceof Pk||(P=new Pk(P)),$m(P,S,v),H.dm().endTransaction()},getDataUIBounds:function(I){var J=this.getDataUI(I);return J?J._79o():w},drawData:function(D,N,C){var O=this.getDataUI(N);if(O){var $=O._79o();(!C||Uh(C,$))&&(O._42(D),N instanceof s.Block&&N.eachChild(function(W){this.isVisible(W)&&this.drawData(D,W,C)},this))}},getBoundsForGroup:function(Z){return Z.s($e)?this.getDataUIBounds(Z):w},isPixelPerfect:function(M){return M.s("pixelPerfect")},rectIntersects:function(e,M){this.validate();var m=w;if(this._56I[e._id]){var F=this._25I[e._id];if(F){var d=F._79o();if(jr(M,d))m=!0;else if((M=Xk(M,d))&&(F.rectIntersects&&(m=F.rectIntersects(M)),m==w)){if(!this.isPixelPerfect(e))return!0;var l=M.x,O=M.y,h=M.width,K=M.height,z=this._zoom,s=Y.hitMaxArea,$=h*K*z*z;if($>s){var G=Math.sqrt(s/$);z*=G}h*=z,K*=z,2>h&&(h=2),2>K&&(K=2),l*=z,O*=z;var W=gm(h,K);Hn(W,-l,-O),W.scale(z,z),this._drawForChecking=!0,this.drawData(W,e,M),this._drawForChecking=!1;try{for(var Z=0,b=W.getImageData(0,0,h,K).data;Z<b.length;Z+=4)if(0!==b[Z+3]){m=!0;break}W.restore()}catch(H){Gr=w,m=!1}}}}return m?!0:!1},rectContains:function($,i){if(this._56I[$._id]){var r=this._25I[$._id];if(r)return jr(i,r._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(n){if(!Y.isInput(n.target)){var S=this,c=S._focusData,H=c&&S._25I[c._id],j=0,V=S._dataModel._datas;if(!(c&&c._enabled&&c._editable&&H&&H.onKeyDown&&H.onKeyDown(n)===!0))if(9===n.keyCode&&(c&&(j=V.indexOf(c),bg(n)?-1===--j&&(j=0):++j===V.size()&&(j=0)),S._focusData=c=V.get(j),S.sm().setSelection(c)),Ak(n)?S.selectAll():Fg(n)&&S.isResettable()&&S.reset(),S.sm().isEmpty()){if(S._editing)return;var Q=S.tx(),T=S.ty(),l=!1,q=bg()?100:10;Yf(n)&&(Q-=q,l=!0),Cc(n)&&(T-=q,l=!0),Ve(n)&&(Q+=q,l=!0),hs(n)&&(T+=q,l=!0),l&&S.setTranslate(Q,T)}else{Zd(n)&&S.handleDelete(n);var C=bg()?10:1;Yf(n)&&(S.moveSelection(-C,0),S.fi({kind:"moveLeft"})),Cc(n)&&(S.moveSelection(0,-C),S.fi({kind:"moveUp"})),Ve(n)&&(S.moveSelection(C,0),S.fi({kind:"moveRight"})),hs(n)&&(S.moveSelection(0,C),S.fi({kind:"moveDown"}))}}},handleScroll:function(m,l){if(mc(m),this.isZoomable()){if(!this.getEditInteractor()){var Y=this.getDataAt(m);if(Y){var D=Ub(this.getImage(Y));if(D&&Pb(D.scrollable,Y,this))return}}var y=this.lp(m);l>0?this.scrollZoomIn(y):0>l&&this.scrollZoomOut(y)}},handlePinch:function(_,i,p){this.isZoomable()&&(Math.abs(i-p)<Y.pinchZoomThreshold||(i>p?this.pinchZoomIn(_):this.pinchZoomOut(_)))},checkDoubleClickOnNote:function(U,P){var O=this,E=O.lp(U),z=O.getDataUI(P),Y=z.note2Info;return Y&&P.s("note2.toggleable")&&Vb(Y.clickRect,E)?(P.s(Mr,!P.s(Mr)),O.fi({kind:"toggleNote2",event:U,data:P}),!0):(Y=z.noteInfo,Y&&P.s("note.toggleable")&&Vb(Y.clickRect,E)?(P.s(dk,!P.s(dk)),O.fi({kind:"toggleNote",event:U,data:P}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(B,C){var m=this,P=m.getAutoScrollZone(),l=P/m.getZoom(),p=P/4,Q=m._29I,A=m.lp(B),N={x:m.tx(),y:m.ty()};return A&&P>0&&Q&&(A.x-Q.x<l?m.translate(p,0):Q.x+Q.width-A.x<l&&m.translate(-p,0),A.y-Q.y<l?m.translate(0,p):Q.y+Q.height-A.y<l&&m.translate(0,-p)),N.x=m.tx()-N.x,N.y=m.ty()-N.y,C&&(C.x+=N.x,C.y+=N.y),N},getMoveMode:function(F,C){var X=C.s("2d.move.mode");return X?X:qi["88"]?"x":qi["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(m,l,U){var x=this;return"currentSubGraph"===l?{__i:m.getId()}:U.serializeProperty(m,l,x)},deserializeProperty:function(I,r,i){var z=this;if("currentSubGraph"===r){var n=z.dm(),h=n.__idMap;return h[I.__i]}return i.deserializeProperty(I,r,z)},setDefaultCursor:function(N,e){this._defaultCursor=N,e!==!1&&this.setCursor(N)},setCursor:function(k){"default"===k&&(k=this._defaultCursor||k);var X=this.getView().style;X.cursor=k,X.cursor="-webkit-"+k,X.cursor="-moz-"+k},getCurrentConnectActionType:function(){return this._currentActionType
},setCurrentConnectActionType:function(y){return y===w||Y.getConnectAction(null,y)?(this._currentActionType=y,this.redraw(),!0):!1},getEditStyle:function(B){var L=this.getEditInteractor();return L?L.getStyle(B):r},setEditStyle:function(C,i,u){var v=this.getEditInteractor();return v?(v.setStyle(C,i,u),!0):!1},isConnectActionVisible:function(H){var j=Y.getConnectAction(this);if(!j)return!1;var Z=j.visible;return Ln(Z)&&(Z=Z(this,H)),Z},isInteractive:function(E){if(this._drawForChecking)return!1;var M=Ub(this.getImage(E));return M&&Pb(M.interactive,E,this)?!0:E.s("interactive")},appendHTML:function(J,P){var m=this.getView();if(!(P||J&&J.parentNode!==m))return!1;var v=J.getView&&J.getView();if(!P&&v&&v.parentNode===m)return!1;(J.getView||J.isSelfViewEvent)&&(J=J.getView());var F=this.getEditInteractor();return F&&F._canvas?m.insertBefore(J,F._canvas):this.isScrollBarVisible()?m.insertBefore(J,this.getView().lastChild):Ld(m,J),!0},_layoutHTMLImpl:function(m,Z,r){if(arguments.length>1){var o,w=this,e=w._zoom;if(Z.getView&&(o=Z,Z=Z.getView()),Z.style.position="absolute",r){var L=m.getRect();Ni(o||Z,w.tx()+L.x*e,w.ty()+L.y*e,L.width*e,L.height*e)}else{var k=new Rp,L=m.getAnchorRect(),D=m.getPosition(),T=m.getScale(),c=Z.style;Ni(o||Z,L),k.appendTranslate(w.tx(),w.ty()),k.appendScale(e,e),k.append(new Rp(m.getRotation(),D.x,D.y,T.x,T.y)),jg(c,"transform","matrix("+k.a.toFixed(5)+", "+k.b.toFixed(5)+", "+k.c.toFixed(5)+",\n    "+k.d.toFixed(5)+", "+k.tx.toFixed(5)+", "+k.ty.toFixed(5)+")"),jg(c,"transformOrigin",(-L.x).toFixed(5)+"px "+(-L.y).toFixed(5)+"px"),Z.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(i){return i instanceof vf?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(t){var V="state",o=t.s(V);if(o)return o;var j=Ub(t._image);return j?Pb(j[V],t,this)||null:void 0},getShape:function(O){return O.getStyle(ii)}}),R.defineProperties(Om.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(f){this._layoutHTML=f}}});var Me=function(N,J){var u=this;u.gv=N,u.s=function(P){return J.getStyle(P)},u._data=J,u._87I=new Pk};Ap(Me,R,{_6I:w,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var l=this,R=l.gv.isSelected(l._data);return!R||l.isShadowed()?0:l.gv.getSelectWidth(l._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function($){var Q=this._data,l=this.gv.getBodyColor(Q);return l?l:$?Q.getStyle($):w},_2Q:function(_){return this.s(_)},_1Q:function(v,P,c,g){var H=this.s,J=H("2d.gray"),S=H(P+".dash.color");if(J&&(S=Y.toGrayColor(S)),v.strokeStyle=S,v.lineWidth=c,v.stroke(),H(P+".dash.3d")){var h=H(P+".dash.3d.color");Sn(v,S,J?Y.toGrayColor(h):h,c,this.gv._zoom,H(P+".dash.3d.accuracy"))}zp(v,g)},invalidate:function(){this._6I=w},_79o:function(){var x=this;if(!x._6I){var H=x._data,n=x.gv;x.labelInfo=x.label2Info=x.noteInfo=x.note2Info=x._38o=w,x._87I.clear(),x.interactiveInfo=n.isInteractive(H)?{}:w,x._3O(),x._55O=n.isEditable(H)?{_42O:n.isRectEditable(H),_43O:n.isPointEditable(H),_56O:n.isRotationEditable(H)}:w,x._6I=x._81o()}return x._6I},_3O:function(){},getPosition:function(){return Jq},_68o:function($,A){$&&this._87I.add(Vi($,A))},_81o:function(){var T=this,$=T.s;T._24O(Ij,"getLabel"),T._24O(pl,"getLabel2"),T._26O(uh,"getNote"),T._26O(Rd,"getNote2"),T._15O(),T._55O&&T._48O();var Z;if(T._87I.each(function(s){Z=_f(Z,s)}),Z){var g=T.isShadowed(),H=$("shadow2"),B=fq(Z);H?(B.x+=$("shadow2.offset.x"),B.y+=$("shadow2.offset.y"),xg(B,$("shadow2.blur"))):g&&(B.x+=$("shadow.offset.x"),B.y+=$("shadow.offset.y"),xg(B,$("shadow.blur"))),Z=_f(Z,B)}return T._87I.clear(),Z},_42:function(W){var j=this,q=j._data,B=j.gv,p=j.s,N=p("opacity"),S=this.isShadowed(),k=p("shadow2");if(S||k){var b=W.shadowOffsetX,K=W.shadowOffsetY,n=W.shadowBlur,V=W.shadowColor,P=B.getZoom()*Y.devicePixelRatio,$=S?"shadow":"shadow2";W.shadowOffsetX=p($+".offset.x")*P,W.shadowOffsetY=p($+".offset.y")*P,W.shadowBlur=p($+".blur")*P,W.shadowColor=S?j.getSelectColor():p($+".color")}if(N!=w){var J=W.globalAlpha;W.globalAlpha=N}j._80o(W),B.isLabelVisible(q)&&((!B._drawForChecking||p("label.selectable"))&&_c(W,j.labelInfo),(!B._drawForChecking||p("label2.selectable"))&&_c(W,j.label2Info)),B.isNoteVisible(q)&&(Jg(W,j.noteInfo),Jg(W,j.note2Info)),j._99O(W),N!=w&&(W.globalAlpha=J),(S||k)&&(W.shadowOffsetX=b,W.shadowOffsetY=K,W.shadowBlur=n,W.shadowColor=V)},_80o:function(){},_47O:function(){},_24O:function(U,F){var v=this,e=v._data,k=v.gv,r=v.s,y=k[F](e);if(y!=w){var W=r(U+".scale"),q=r(U+".max"),z=r(U+".position"),b=v[U+"Info"]={label:y,scale:W,color:k[F+"Color"](e),font:r(U+".font"),opacity:r(U+".opacity"),align:r(U+".align"),rotation:v.getRotation(r(U+".rotation"),!1,z),background:k[F+"Background"](e)},P=eh(b,y);q>0&&q<P.width&&(b.labelWidth=P.width,P.width=q),1!==W&&(P.width*=W,P.height*=W);var Z=v.getPosition(z,r(U+".offset.x"),r(U+".offset.y"),P,r(U+".position.fixed"));if(P.x=Z.x-P.width/2,P.y=Z.y-P.height/2,v._68o(b.rect=P,b.rotation),1!==W){var X=P.width/W,N=P.height/W;b.rect={x:Z.x-X/2,y:Z.y-N/2,width:X,height:N}}}},_26O:function(q,B){var U=this,N=U.gv,A=U._data,l=U.s,n=N[B](A);if(n!=w){var h,g,T=l(q+".scale"),y=U[q+"Info"]={note:n,scale:T,data:A,view:N,expanded:l(q+".expanded"),font:l(q+".font"),color:l(q+".color"),opacity:l(q+".opacity"),align:l(q+".align"),icon:l(q+".icon"),backgroundImage:l(q+".backgroundImage"),borderWidth:l(q+".border.width"),borderColor:l(q+".border.color"),background:N[B+"Background"](A)},J=U.getPosition(l(q+".position"),l(q+".offset.x"),l(q+".offset.y")),C=J.x,z=J.y;if(y.expanded){var t,o=l(q+".max"),$=l(q+".backgroundImage");$?($=Ub($),t={width:To($,A),height:md($,A)}):t=eh(y,n),t.width+=6,t.height+=2,o>0&&o<t.width&&(y.labelWidth=t.width,t.width=o),h=t.width,g=t.height+8,y.clickRect={x:C-h*T/2,y:z-g*T,width:h*T,height:g*T*t.height/g}}else{var d=l(q+".icon");d?(d=Ub(d),h=To(d,A),g=md(d,A)):(h=12,g=18),y.clickRect={x:C-h*T/2,y:z-g*T,width:h*T,height:g*T}}y.rect={x:C-h/2,y:z-g*T/2-g/2,width:h,height:g};var p=v(y.borderWidth/2)*T;U._68o({x:C-h*T/2-p,y:z-g*T-p,width:h*T+2*p,height:g*T+2*p})}},_48O:function(){},_99O:function(b){var y=this,M=y._38o;if(M){var v=y.gv,W=y._data,l=M.icons,E=y.interactiveInfo;E&&(E._38o={});for(var D in l){var x=l[D],h=M.rects[D];if(h){E&&(E._38o[D]=[]);var n=Pb(x.opacity,W,v),$=Pb(x.names,W,v),F=$?$.length:0,k=h.rotation;if(n!=w){var X=b.globalAlpha;b.globalAlpha*=n}for(var q=0;F>q;q++){var K=$[q],s=Ub(K),e=h[q];if(k){var m=e.x+e.width/2,i=e.y+e.height/2;b.save(),Hn(b,m,i),An(b,k),Hn(b,-m,-i)}E&&E._38o[D].push(b.interactiveInfo={compInfos:[],matrix:k?new Rp(k,m,i).appendTranslate(-m,-i):new Rp}),Pr(b,s,Pb(x.stretch,W,v),e.x,e.y,e.width,e.height,y._data,y.gv),b.interactiveInfo=w,k&&b.restore()}n!=w&&(b.globalAlpha=X)}}}}});var $k=function(W,K){Lh($k,this,[W,K])};Ap($k,Me,{_checkEmptyRect:!0,_40O:function(B,q){var N=this,W=N.s,d=B.rect;(B.borderColor=N.gv.getBorderColor(N._data))&&(B.borderType=W("border.type"),B.borderWidth=W("border.width"),B.borderPadding=W("border.padding"),q=i(q,B.borderPadding+B.borderWidth/2));var z=N._data.getScale(),x=i(1,i(J(z.x),J(z.y)));if(B.selectWidth=N.getSelectWidth()){var M=N.gv._zoom;B.selectType=W("select.type"),B._97o=N.getSelectColor(),B.selectPadding=W("select.padding"),q=i(q,(B.selectPadding+B.selectWidth/2/M)/x)}q>0&&(q*=x,d=fq(d),xg(d,q)),N._68o(d)},_39O:function(j,O){var T,B=this,Q=O.rect;if(O.borderWidth>0&&(T=O.borderPadding,j.strokeStyle=O.borderColor,j.lineWidth=O.borderWidth,Po(j,O.borderType,{x:Q.x-T,y:Q.y-T,width:Q.width+2*T,height:Q.height+2*T}),j.stroke()),O.selectWidth>0){var I=B.gv._zoom;if(T=O.selectPadding,j.strokeStyle=O._97o,j.lineWidth=O.selectWidth/I,O.rotation!=w){j.save(),j.translate(O.position.x,O.position.y),j.rotate(O.rotation);var t=B._data,F=t.getWidth(),m=t.getHeight(),U=O.scale,K=O.anchor;Q={x:U.x*-F*K.x,y:U.y*-m*K.y,width:U.x*F,height:U.y*m}}Po(j,O.selectType,{x:Q.x-T,y:Q.y-T,width:Q.width+2*T,height:Q.height+2*T}),O.rotation!=w&&j.restore(),j.stroke()}},dispose:function(){var V=this,t=V._htmlView;$k.superClass._3O.call(V),t&&(t.onHTMLRemoved&&t.onHTMLRemoved(),zk(t))},_3O:function(){var G=this,v=G.s,m=G._data,K=G.gv,X=K.getShape(m),$=G.getBodyColor(),I=v("shape.border.color"),r=G._83o=X?{shape:X,_53o:G.getBodyColor("shape.background"),_27Q:Ub(v("shape.repeat.image"),$),shapeGradientPack:v("shape.gradient.pack"),_54o:v("shape.border.width"),_55o:I,shapeBorderRepeatImage:Ub(v("shape.border.repeat.image"),I),_56o:v("shape.border.3d"),_57o:v("shape.border.3d.color"),_58o:v("shape.border.3d.accuracy"),shapeGradient:v("shape.gradient"),_59o:v("shape.gradient.color"),_60o:v("shape.border.pattern"),_61o:v("shape.border.cap"),_62o:v("shape.border.join"),shapeForeground:v("shape.foreground"),bodyColor:$,gray:v("2d.gray")}:{img:Ub(K.getImage(m),$),bodyColor:$,gray:v("2d.gray"),stretch:v("image.stretch")};if(a&&!Dq);else{var y,V=r.img;V&&V.renderHTML?(G._htmlInfo&&G._htmlInfo.img!==V&&(G._htmlInfo=w),G._htmlInfo||(G._htmlInfo={img:V,cache:{}}),y=V.renderHTML(m,K,G._htmlInfo.cache)):G._htmlInfo=w,G._htmlView&&G._htmlView!==y&&(G._htmlView.onHTMLRemoved&&G._htmlView.onHTMLRemoved(),zk(G._htmlView.getView?G._htmlView.getView():G._htmlView)),(G._htmlView=y)&&K.appendHTML(y)&&(y.onHTMLAddedSync&&y.onHTMLAddedSync(),y.onHTMLAdded&&pm(y.onHTMLAdded)),r.rect=m.getRect(),r.position=m.p(),r.scale=m.getScale(),r.anchor=m.getAnchor(),r.rotation=m.getRotation(),X===ki&&(r._63o=v("shape.depth"));var R=0;if(X)R=gf(w,r._54o/2,r._62o),G.s("shape.dash")&&(R=i(R,(G.s("shape.dash.width")||r._54o)/2));else if(V&&V.boundExtend)if(R=Pb(V.boundExtend,m,K),V.boundExtendAbsolute){var g=m.getScale();R/=K._zoom*i(1,i(J(g.x),J(g.y)))}else if(!Pb(V.fitSize,m,K)){var u=Pb(V.width,m,K),Q=Pb(V.height,m,K);R*=i(m.getWidth()/u,m.getHeight()/Q)}G._40O(r,R);var j=Qo(m,K.isSelected(m)),D=v("clip.percentage");if(1>D&&(0>D&&(D=0),r.clipRect=Gg(m.getAnchorRect(),v("clip.direction"),D,j)),X){var n=v("shape.fill.clip.percentage");1>n&&(0>n&&(n=0),r.shapeClipRect=Gg(m.getAnchorRect(),v("shape.fill.clip.direction"),n,j));var E=v("shape.foreground.clip.percentage");1>E&&(0>E&&(E=0),r.shapeForegroundClipRect=Gg(m.getAnchorRect(),v("shape.foreground.clip.direction"),E,j))}}},getPosition:function(i,X,q,w){var D=Cm(i,this._83o.rect,w);return D.x+=X,D.y+=q,D},_80o:function(z){var R=this,b=R.s,m=R.gv,D=R._data,X=R._83o,I=X.rect,q=X.position,f=X.rotation,v=X.anchor,l=X.scale,$=X.shape,M=X.clipRect;if(!R._checkEmptyRect||I.width>0&&I.height>0){var N=D.getSize();if(N.x=-N.width*v.x,N.y=-N.height*v.y,z.save(),Hn(z,q.x,q.y),An(z,f),lq(z,l.x,l.y),M&&(z.beginPath(),z.rect(M.x,M.y,M.width,M.height),z.clip()),m._drawForChecking&&X.img&&Pb(X.img.pixelPerfect,D,m)===!1)pb(z,N.x,N.y,N.width,N.height,"#888888");else if(R.freeDraw)R.freeDraw(z,N,X);else if($){var d,h,F,P,g=X._60o,C=ee(z,g),O=X._27Q,u=X._54o,s=X.shapeGradientPack,L=X.gray,_=z.lineJoin,c=z.lineCap,y=function(a){return L?Y.toGrayColor(a):a};"roundRect"===$?d=b("shape.corner.radius"):"polygon"===$?d=b("shape.polygon.side"):"arc"===$&&(d=b("shape.arc.from"),h=b("shape.arc.to"),F=b("shape.arc.close"),P=b("shape.arc.oval")),z.lineJoin=X._62o,z.lineCap=X._61o;var n=y(X._53o);if(n||O||s){var A=X.shapeClipRect;A&&(z.save(),z.beginPath(),z.rect(A.x,A.y,A.width,A.height),z.clip()),Po(z,$,N,d,h,F,P),s?io(z,s,function(n){return Di(n,X.bodyColor)}):O?Yk(z,O,y(X.bodyColor),null,D,m):jq(z,n,X.shapeGradient,y(X._59o),N),z.fill(),s&&z.restore(),A&&z.restore(),z!==C&&Po(C,$,N,d,h,F,P)}else Po(C,$,N,d,h,F,P);var j=X.shapeForeground;if(j){z.save();var V=X.shapeForegroundClipRect;V&&(z.beginPath(),z.rect(V.x,V.y,V.width,V.height),z.clip()),Po(z,$,N,d,h,F,P),jq(z,j,b("shape.foreground.gradient"),y(b("shape.foreground.gradient.color")),N),z.fill(),z.restore()}if(u>0){var J=b("shape.border.width.absolute");J&&(z.save(),z.setTransform(1,0,0,1,0,0)),z.lineWidth=u;var Q=y(X._55o);X.shapeBorderRepeatImage?ni(z,X.shapeBorderRepeatImage,Q,null,D,m):z.strokeStyle=Q,z.stroke(),J&&z.restore(),X._56o&&Sn(z,Q,y(X._57o),u,m._zoom,X._58o)}if(zp(z,g),b("shape.dash")){var T=b("shape.dash.width")||u;if(T>0){g=b("shape.dash.pattern");var C=ee(z,g,R._2Q("shape.dash.offset"));C!==z&&Po(C,$,N,d,h,F,P),R._1Q(z,"shape",T,g)}}zf(z,n,X._63o,N),z.lineJoin=_,z.lineCap=c}else{var S=R.interactiveInfo;S&&(z.interactiveInfo=S.bodyInfo={compInfos:[],matrix:new Rp(f,q.x,q.y,l.x,l.y)}),X.gray&&(z.compGray=!0);var o=X.img;o&&o.cacheRule!=w&&(o=xe(z,o,X.stretch,N.width,N.height,D,m,X.bodyColor)),Pr(z,o,X.stretch,N.x,N.y,N.width,N.height,D,m,X.bodyColor),z.compGray=!1,z.interactiveInfo=w}z.restore()}R._39O(z,X)},_48O:function(){},_47O:function(){}});var Xf=function(X,W){Lh(Xf,this,[X,W])},pc=function(V,r,v,c){var x=qd(V,r);return v=c?X(v,x):ed(v,x),x?v/=x:v=0,{x:V.x+(r.x-V.x)*v,y:V.y+(r.y-V.y)*v}};Ap(Xf,Me,{_3O:function(){var q,d=this,j=d._data,h=d.gv,y=d.s,z=y(Th),x=j.isLooped(),v=y("edge.width"),V=d.getBodyColor("edge.color"),s=y("edge.center"),t=y("edge.offset"),l=h.getBorderColor(j),A=l?y("border.width"):0,b=d.getSelectWidth(),M=j._40I,S=j._41I,N=d._78o=M&&S?{looped:x,type:z,width:v,center:s,color:V,repeatImage:Ub(y("edge.repeat.image"),V),borderColor:l,borderWidth:A,_97o:b?d.getSelectColor():w,selectWidth:b,pattern:y("edge.pattern"),cap:y("edge.cap"),join:y("edge.join"),is3d:y("edge.3d"),_67o:y("edge.3d.color"),_66o:y("edge.3d.accuracy"),gray:y("2d.gray")}:w;if(N){var U=Y.getEdgeType(z);if(U){var F=U(j,Ci(d,h,j,x,z),h,d._19Q);F.points&&F.points.size()>1?(N.edgeTypeInfo=F,q=ln(N.edgeTypeInfo.points)):F[Um]&&F.rect&&(N.edgeTypeInfo=F,q=F.rect)}else{var c=y("edge.source.anchor.x"),H=y("edge.source.anchor.y"),R=y("edge.target.anchor.x"),L=y("edge.target.anchor.y"),Z=Ng(h,j,"source"),T=Ng(h,j,"target");if(z===Tp){var u=N.points=y(cs)||Kn,p=u.size();N.segments=y("edge.segments");var _=c!==r||H!==r||Dn(M),B=R!==r||L!==r||Dn(S);if(!s)if(t)_||(Z=pc(Z,p?u.get(0):T,t,p)),B||(T=pc(T,p?u.get(p-1):Z,t,p));else{var J;_||(J=Tq(Z,p?u.get(0):T,Zl(h,M)),J&&(Z={x:J[0],y:J[1]})),B||(J=Tq(p?u.get(p-1):Z,T,Zl(h,S)),J&&(T={x:J[0],y:J[1]}))}q=_f(ln(N.points),ln(Z,T))}else{var o=Ci(d,h,j,x,z);if(d._19Q||(o=-o),x)Z=fq(Z),Z.x=h.getNodeRect(M).x,N.radius=o,q={x:Z.x-o,y:Z.y-o,width:2*o,height:2*o};else{var D=qd(Z,T),$=ed(t,D),G={x:$,y:o},a={x:D-$,y:o},f=K(T.y-Z.y,T.x-Z.x),W=N.mat=new $r(f);if(N.orienAngle=f,N.angle=T.x<Z.x?f+g:f,N.rect={x:G.x,y:G.y,width:a.x-G.x,height:0},N.origin=Z,G=W.tf(G),G.x+=Z.x,G.y+=Z.y,a=W.tf(a),a.x+=Z.x,a.y+=Z.y,s){var P={x:D,y:0};P=W.tf(P),P.x+=Z.x,P.y+=Z.y,q=ln([Z,G,a,P]),N.c1=Z,N.c2=P}else q=ln(G,a);Z=G,T=a}}N.sourcePoint=Z,N.targetPoint=T,j._lastSourcePoint=Z,j._lastTargetPoint=T}var E=0;y("edge.dash")&&(E=y("edge.dash.width")||v);var Q="square"===N.cap?.71:.5;gf(q,i(E*Q,v*Q+A+b),N.join),d._68o(q)}},getRotation:function(h,y,i){h=h||0;var I=this._78o;if(I){var d,l=I.angle,F=I.points,t=I.edgeTypeInfo;if(l!=w)return y?I.orienAngle+h:l+h;if(t&&t[Um])return t.getRotation?t.getRotation(this,h,y,i):0;if(t&&t.points){var o=t.points;return d=o.size(),rs[i]?d&&0===d%2?Sk(o.get(d/2-1),o.get(d/2),y,h):h:ur[i]?Sk(o.get(0),o.get(1),y,h):Sk(o.get(d-2),o.get(d-1),y,h)}if(F)return d=F.size(),rs[i]?d&&0===d%2?Sk(F.get(d/2-1),F.get(d/2),y,h):h:ur[i]?Sk(I.sourcePoint,d?F.get(0):I.targetPoint,y,h):Sk(d?F.get(d-1):I.sourcePoint,I.targetPoint,y,h)}return h},getPosition:function(r,P,n,z,q){var B=this._78o;if(B){var G,J=B.type,K=B.points,H=B.edgeTypeInfo,E=B.sourcePoint,Q=B.targetPoint;if(!J)return B.looped?{x:E.x-B.radius+P,y:E.y+n}:(q&&E&&Q&&(E.x>Q.x||E.x===Q.x&&E.y>Q.y)&&(r=Uc[r],n=-n),G=Cm(r,B.rect,z),G.x+=P,G.y+=n,G=B.mat.tf(G),G.x+=B.origin.x,G.y+=B.origin.y,G);if(H&&H[Um])return H.getPosition?H.getPosition(this,r,P,n,z,q):{x:(E.x+Q.x)/2,y:(E.y+Q.y)/2};if(K){var G,t=K.size();if(rs[r]){if(t){var e=t%2;if(0===e)return Tj(K.get(t/2-1),K.get(t/2),r,P,n,z,q);G=K.get((t-e)/2)}else G={x:(E.x+Q.x)/2,y:(E.y+Q.y)/2};return G=Cm(r,{x:G.x,y:G.y,width:0,height:0},z),G.x+=P,G.y+=n,G}return ur[r]?Tj(E,t?K.get(0):Q,r,P,n,z,q):Tj(t?K.get(t-1):E,Q,r,P,n,z,q)}if(H){var s=H.points,t=s.size();if(rs[r]){var e=t%2;return 0===e?Tj(s.get(t/2-1),s.get(t/2),r,P,n,z,q):(G=s.get((t-e)/2),G=Cm(r,{x:G.x,y:G.y,width:0,height:0},z),G.x+=P,G.y+=n,G)}return ur[r]?Tj(s.get(0),s.get(1),r,P,n,z,q):Tj(s.get(t-2),s.get(t-1),r,P,n,z,q)}}return Jq},_42:function(s){this._78o&&Xf.superClass._42.call(this,s)},drawPath:function(k,E){k.beginPath();var X=E.type,K=E.points,Z=E.segments,M=E.edgeTypeInfo;if(!X||K){var q=E.sourcePoint,$=q.x,D=q.y,v=E.targetPoint,I=v.x,o=v.y;if(X)if(Z){var b=new Pk({x:$,y:D});b.addAll(K),b.add({x:I,y:o}),bb(k,b,Z)}else k.moveTo($,D),K.each(function(f){k.lineTo(f.x,f.y)}),k.lineTo(I,o);else E.looped?k.arc($,D,E.radius,0,c,!0):E.center?(k.moveTo(E.c1.x,E.c1.y),k.lineTo($,D),k.lineTo(I,o),k.lineTo(E.c2.x,E.c2.y)):(k.moveTo($,D),k.lineTo(I,o))}else M&&(M.points?bb(k,M.points,M.segments):M[Um]&&M[Um](k,M))},_80o:function(v){var U=this,k=U.s,t=U._78o,w=t.width,F=t.selectWidth,c=t.borderWidth,q=t.repeatImage,C=v.lineJoin,n=v.lineCap,G=t.gray,e=t.pattern;v.lineJoin=t.join,v.lineCap=t.cap,U.drawPath(ee(v,e),t);var r=k("edge.width.absolute");r&&(v.save(),v.setTransform(1,0,0,1,0,0)),F&&(v.strokeStyle=t._97o,v.lineWidth=w+2*(c+F),v.stroke()),c&&(v.strokeStyle=G?Y.toGrayColor(t.borderColor):t.borderColor,v.lineWidth=w+2*c,v.stroke());var z=G?Y.toGrayColor(t.color):t.color;if(q?ni(v,q,z,null,U._data,U.gv):v.strokeStyle=z,v.lineWidth=w,v.stroke(),t.is3d){var T=G?Y.toGrayColor(t._67o):t._67o;Sn(v,z,T,w,U.gv._zoom,t._66o)}if(zp(v,e),k("edge.dash")){e=k("edge.dash.pattern");var E=ee(v,e,U._2Q("edge.dash.offset"));E!==v&&U.drawPath(E,t),U._1Q(v,"edge",k("edge.dash.width")||w,e)}r&&v.restore(),v.lineJoin=C,v.lineCap=n},_48O:function(){},_47O:function(){}});var zl=function(D,A){Lh(zl,this,[D,A])};Ap(zl,$k,{_3O:function(){var o,f,i=this,V=i.s,l=i._data,J=i.gv;if(i._88I=w,l.isExpanded()&&l.eachChild(function(N){if(Km(N)){var i=J.getBoundsForGroup(N);i&&(f||(f=[]),f.push(i),o=_f(o,i))}}),o){var q=J.getLabel(l),x=V("group.type"),U=V("group.border.width")||0,j=V("group.border.width.absolute"),M=U/2;j&&(U/=J._zoom),o=Bc(x,f,o),hm(o,l,"group.padding",1),xg(o,U);var T=i._88I={type:x,rect:o,_64o:o};if(!x&&q!=w){var k,g=i.labelInfo={label:q,color:V("group.title.color"),font:V("group.title.font"),align:V("group.title.align")},C=eh(g,q),W=C.width+U,c=C.height+U,R=V("group.title.align"),u=V("group.title.orientation");if(u===rd||u===fi?(o.height+=U,W>o.width&&(o.width=W)):(u===vq||u===hn)&&(o.width+=U,W>o.height&&(o.height=W)),k=R===vq?o.x:R===hn?o.x+o.width-W:o.x+o.width/2-W/2,u===fi)T.titleRect={x:o.x,y:o.y+o.height,width:o.width,height:c},T.rect={x:o.x,y:o.y,width:o.width,height:o.height+c},g.rect={x:k,y:o.y+o.height,width:W,height:c};else if(u===vq){var z=T.titleRect={x:o.x-c,y:o.y,width:c,height:o.height};T.rect={x:o.x-c,y:o.y,width:o.width+c,height:o.height},g.rect={x:z.x+c/2-o.height/2,y:z.y+o.height/2-c/2,width:o.height,height:c},g.rotation=-Math.PI/2}else if(u===hn){var z=T.titleRect={x:o.x+o.width,y:o.y,width:c,height:o.height};T.rect={x:o.x,y:o.y,width:o.width+c,height:o.height},g.rect={x:z.x+c/2-o.height/2,y:z.y+o.height/2-c/2,width:o.height,height:c},g.rotation=Math.PI/2}else T.titleRect={x:o.x,y:o.y-c,width:o.width,height:c},T.rect={x:o.x,y:o.y-c,width:o.width,height:o.height+c},g.rect={x:k,y:o.y-c-M,width:W,height:c+U}}i._40O(T,V("group.border.width")/2)}else zl.superClass._3O.call(i)},getPosition:function(A,y,z,O){var J=this._88I;if(J){var Y=Cm(A,J.rect,O);return Y.x+=y,Y.y+=z,Y}return zl.superClass.getPosition.apply(this,arguments)},_24O:function(G,d){var b=this._88I;(!b||b.type||"label2"===G)&&zl.superClass._24O.call(this,G,d)},_80o:function(v){var O=this,N=O._88I;if(N){var x=O._data,j=O.s,Y=O.gv,F=N.type,E=N.rect,J=N._64o,I=N.titleRect,L=O.getBodyColor(),G=Ub(j("group.image"),L),n=j("group.image.stretch"),e=O.getBodyColor("group.background"),z=Ub(j("group.repeat.image"),L),k=j("group.gradient.pack"),M=j("group.gradient"),u=j("group.gradient.color"),$=j("group.border.width"),i=j("group.border.color"),g=j("group.border.pattern"),d=j("group.title.orientation"),U=j("group.depth"),c=j("group.border.radius"),Q=j("group.border.join"),t=j("group.border.cap"),A=j("group.border.width.absolute");A&&($/=Y._zoom);var C=i,q=j("group.border.repeat.image");if(q&&(q=Ub(q,i))&&(C=ch(v,q,i,null,x,Y)),F){var K=v.lineJoin,s=v.lineCap;if(v.lineJoin=Q,v.lineCap=t,G){if(v.save(),Po(v,F,E,c),v.clip(),Pr(v,G,n,E.x,E.y,E.width,E.height,x,Y,L),v.restore(),$>0){var B=ee(v,g);Po(B,F,E,c),v.lineWidth=$,v.strokeStyle=C,v.stroke(),zp(v,g)}}else{var B=ee(v,g);e||z||k?(Po(v,F,E,c),k?io(v,k,function(v){return Di(v,L)}):z?Yk(v,z,L,null,x,Y):jq(v,e,M,u,E),v.fill(),k&&v.restore(),v!==B&&Po(B,F,E,c)):Po(B,F,E,c),$>0&&(v.lineWidth=$,v.strokeStyle=C,v.stroke()),zp(v,g),F===ki&&zf(v,e,U,E)}v.lineJoin=K,v.lineCap=s}else{var H=j("group.title.background");if((!c||0>c)&&(c=0),G)Pr(v,G,n,J.x,J.y,J.width,J.height,x,Y,O.getBodyColor());else if(e||z)if(z?Yk(v,z,L,null,x,Y):jq(v,e,M,u,J),0===$)Po(v,ki,J),v.fill(),zf(v,e,U,J);else{switch(v.beginPath(),d){case fi:ij(v,J.x,J.y,J.width,J.height,c,c,0,0);break;case vq:ij(v,J.x,J.y,J.width,J.height,0,c,0,c);break;case hn:ij(v,J.x,J.y,J.width,J.height,c,0,c,0);break;case rd:ij(v,J.x,J.y,J.width,J.height,0,0,c,c)}v.fill()}if(I&&H)if(0===$)pb(v,I.x,I.y,I.width,I.height,H),zf(v,H,U,I);else{switch(v.beginPath(),v.fillStyle=H,d){case fi:ij(v,I.x,I.y,I.width,I.height,0,0,c,c);break;case vq:ij(v,I.x,I.y,I.width,I.height,c,0,c,0);break;case hn:ij(v,I.x,I.y,I.width,I.height,0,c,0,c);break;case rd:ij(v,I.x,I.y,I.width,I.height,c,c,0,0)}v.fill()}if($>0){var B=ee(v,g);if(Po(B,"roundRect",E,c),v.save(),v.lineWidth=$,v.strokeStyle=C,v.lineJoin=Q,v.lineCap=t,v.closePath(),v.stroke(),I&&j("group.splitLine")){var p=I.x,R=I.y,X=I.width,f=I.height;v.beginPath(),d===fi?(v.moveTo(p,R),v.lineTo(p+X,R)):d===vq?(v.moveTo(p+X,R),v.lineTo(p+X,R+f)):d===hn?(v.moveTo(p,R),v.lineTo(p,R+f)):(v.moveTo(p,R+f),v.lineTo(p+X,R+f))}v.stroke(),v.restore(),zp(B,g)}}O._39O(v,N)}else zl.superClass._80o.call(O,v)}});var kd=function(Q,S){Lh(kd,this,[Q,S])};Ap(kd,$k,{_80o:function(w){this._39O(w,this._83o)}});var $i=function(O,x){Lh($i,this,[O,x])};Ap($i,$k,{_3O:function(){var j=this,k=j._data,x=j.s,Z=j.gv,X=k.getPoints(),l=Z.getBorderColor(k),R=l?x("border.width"):0,A=j.getSelectWidth(),e=x("shape.border.width"),T=k.getRect(),H=k.getAnchorRect(),D=Z.getBodyColor(k),u=x("shape.border.color"),q=j._99o=X.isEmpty()?w:{rect:T,rotation:k.getRotation(),fillRule:x("shape.fill.rule"),scale:k.getScale(),position:k.p(),points:X,segments:k.getSegments(),bodyColor:D,borderColor:l,borderWidth:R,_94o:x("shape.border.3d"),_95o:x("shape.border.3d.color"),_96o:x("shape.border.3d.accuracy"),_97o:A?j.getSelectColor():w,selectWidth:A,_53o:x("shape.background"),_27Q:Ub(x("shape.repeat.image"),D),shapeGradientPack:x("shape.gradient.pack"),_54o:e,_55o:u,shapeBorderRepeatImage:Ub(x("shape.border.repeat.image"),u),shapeGradient:x("shape.gradient"),_59o:x("shape.gradient.color"),_60o:x("shape.border.pattern"),_61o:x("shape.border.cap"),_62o:x("shape.border.join"),shapeForeground:x("shape.foreground"),gray:x("2d.gray")};if(q){H.x+=q.position.x,H.y+=q.position.y,q.gradientRect=H;var M=k.getScale(),b=i(1,i(J(M.x),J(M.y)));x("shape.dash")&&x("shape.dash.width")>e&&(e=x("shape.dash.width"));var y,F=x("shape.border.width.absolute");y=F?(e+R+A)/j.gv._zoom/b:e*("square"===q._61o?.71:.5)+R+A/j.gv._zoom/b,y&&(y*=b,T=fq(T),gf(T,y,q._62o)),j._68o(T);var C=Qo(k,Z.isSelected(k)),N=x("clip.percentage");1>N&&(0>N&&(N=0),q.clipRect=Gg(k.getAnchorRect(),x("clip.direction"),N,C));var K=x("shape.fill.clip.percentage");1>K&&(0>K&&(K=0),q.shapeClipRect=Gg(k.getAnchorRect(),x("shape.fill.clip.direction"),K,C));var E=x("shape.foreground.clip.percentage");1>E&&(0>E&&(E=0),q.shapeForegroundClipRect=Gg(k.getAnchorRect(),x("shape.foreground.clip.direction"),E,C))}},getPosition:function(s,y,i,S){var w=this._99o;if(w){var u=Cm(s,w.rect,S);return u.x+=y,u.y+=i,u}return Jq},_42:function(b){this._99o&&$i.superClass._42.call(this,b)},_80o:function(X){var q,g=this,E=g.s,a=g._99o,J=a.position,Z=a.scale,x=a.rotation,H=a.borderWidth,C=a.selectWidth/g.gv._zoom,u=a._27Q,K=a.shapeGradientPack,m=a._54o,s=a.clipRect,h=a.shapeClipRect,f=a.points,y=a.segments,$=g._data.isClosePath(),S=a.fillRule,M=a.gray,_=function(O){return M?Y.toGrayColor(O):O},U=_(a._53o),P=U||u||K;X.save(),Hn(X,J.x,J.y),An(X,x),lq(X,Z.x,Z.y),s&&(X.beginPath(),X.rect(s.x,s.y,s.width,s.height),X.clip()),P&&h&&(X.save(),X.beginPath(),X.rect(h.x,h.y,h.width,h.height),X.clip()),Hn(X,-J.x,-J.y);var o=a._60o,l=ee(X,o),b=X.lineJoin,N=X.lineCap;X.lineJoin=a._62o,X.lineCap=a._61o;var D=_(a.bodyColor);P?(bb(X,f,y,$),K?io(X,K,function(M){return Di(M,a.bodyColor)}):u?Yk(X,u,D,null,g._data,g.gv):(q=D?D:U,jq(X,q,a.shapeGradient,_(a._59o),a.gradientRect)),X.fill(S),K&&X.restore(),h&&(X.restore(),Hn(X,-J.x,-J.y)),l!==X&&bb(l,f,y,$)):bb(l,f,y,$);var t=a.shapeForeground;if(t){X.save();var v=a.shapeForegroundClipRect;v&&(Hn(X,J.x,J.y),X.beginPath(),X.rect(v.x,v.y,v.width,v.height),X.clip(),Hn(X,-J.x,-J.y)),bb(X,f,y,$),jq(X,t,E("shape.foreground.gradient"),_(E("shape.foreground.gradient.color")),a.gradientRect),X.fill(S),X.restore()}var V=E("shape.border.width.absolute");if(V&&(X.save(),X.setTransform(1,0,0,1,0,0)),C&&(X.strokeStyle=a._97o,X.lineWidth=m+2*(H+C),X.stroke()),H&&(X.strokeStyle=_(a.borderColor),X.lineWidth=m+2*H,X.stroke()),m&&(q=_(a._55o),a.shapeBorderRepeatImage?ni(X,a.shapeBorderRepeatImage,q,null,g._data,g.gv):(!U&&D&&(q=D),X.strokeStyle=q),X.lineWidth=m,X.stroke(),a._94o&&Sn(X,q,_(a._95o),m,g.gv._zoom,a._96o)),zp(X,o),E("shape.dash")){var G=E("shape.dash.width")||m;if(G>0){o=E("shape.dash.pattern");var l=ee(X,o,g._2Q("shape.dash.offset"));l!==X&&bb(l,f,y,$),g._1Q(X,"shape",G,o)}}V&&X.restore(),X.lineJoin=b,X.lineCap=N,X.restore()},_48O:function(){},_47O:function(){}});var Gh=function(L,M){Lh(Gh,this,[L,M])};Ap(Gh,$i,{getRotation:function(h,x,n){h=h||0;var g=this._data.getPoints(),W=g.size();return W>1?rs[n]?W&&0===W%2?Sk(g.get(W/2-1),g.get(W/2),x,h):h:ur[n]?Sk(g.get(0),g.get(1),x,h):Sk(g.get(W-2),g.get(W-1),x,h):h},getPosition:function(N,n,L,P,w){var J=this._data.getPoints(),C=J.size();if(C>1){if(rs[N]){var f=C%2;if(0===f)return Tj(J.get(C/2-1),J.get(C/2),N,n,L,P,w);var $=J.get((C-f)/2),Z={x:$.x,y:$.y,width:0,height:0};return $=Cm(N,Z,P),$.x+=n,$.y+=L,$}return ur[N]?Tj(J.get(0),J.get(1),N,n,L,P,w):Tj(J.get(C-2),J.get(C-1),N,n,L,P,w)}return Jq}});var oc=function(e,S){Lh(oc,this,[e,S])};Ap(oc,$k,{_3O:function(){var O=this;oc.superClass._3O.call(O);var o=O.s,x=O._83o;O._82o=x.img||x.shape?w:{background:O.getBodyColor("grid.background"),depth:o("grid.depth"),rect:x.rect,_88o:o("grid.cell.depth"),cellBorderColor:o("grid.cell.border.color"),_89o:o("grid.row.count"),_90o:o("grid.column.count"),block:o("grid.block"),_91o:o("grid.block.color"),_92o:o("grid.block.padding"),_93o:o("grid.block.width")}},_80o:function(p){var M=this,T=M._82o;if(!T)return oc.superClass._80o.call(M,p),void 0;var b,O,L=M._data,k=T.background,h=T.rect,g=T.block,d=T._91o,u=T._92o,i=T._93o,Z=T._88o,D=T.cellBorderColor,m=T._89o,G=T._90o;if(k)if(pb(p,h.x,h.y,h.width,h.height,k),zf(p,k,T.depth,h),Z)for(b=0;m>b;b++)for(O=0;G>O;O++)h=L.getCellRect(b,O),h&&zf(p,k,Z,h);else if(D){for(p.beginPath(),b=0;m>b;b++)for(O=0;G>O;O++)h=L.getCellRect(b,O),h&&p.rect(h.x,h.y,h.width,h.height);p.strokeStyle=D,p.lineWidth=1,p.stroke()}if("h"===g)for(b=0;m>b;b++)h=_f(L.getCellRect(b,0),L.getCellRect(b,G-1)),xg(h,u),$d(p,d,h.x,h.y,h.width,h.height,i);else if("v"===g)for(O=0;G>O;O++)h=_f(L.getCellRect(0,O),L.getCellRect(m-1,O)),xg(h,u),$d(p,d,h.x,h.y,h.width,h.height,i);M._39O(p,M._83o)}});var fd=function(j,r){Lh(fd,this,[j,r])};Ap(fd,$k,{_checkEmptyRect:!1,_81o:function(){var X=this._data,U=fd.superClass._81o.call(this),o=X.s("text");if(o!=w){var g,b,f=X.s("text.font"),Z=X.s("text.align"),F=X.s("text.vAlign"),m=Oq(f,o),i=m.width,K=m.height,M=X.getAnchor(),u=X.getWidth(),z=X.getHeight();"left"===Z?g=-u*M.x:"center"===Z?g=-u*M.x+(u-i)/2:"right"===Z&&(g=u*(1-M.x)-m.width),"top"===F?b=-z*M.y:"middle"===F?b=-z*M.y+(z-K)/2:"bottom"===F&&(b=z*(1-M.y)-m.height);var H,r=X.getMatrix();if(H=ln([r.tf(g,b),r.tf(g+i,b),r.tf(g+i,b+K),r.tf(g,b+K)]),U=_f(U,H),U&&X.s("text.shadow")){var T=fq(U);T.x+=X.s("text.shadow.offset.x"),T.y+=X.s("text.shadow.offset.y"),xg(T,X.s("text.shadow.blur")),U=_f(U,T)}}return U}});var Wm=Om.Interactor=function(u){this.gv=this._graphView=u};$j("Interactor",R,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(D){this.gv.fi(D)},setCursor:function(F){re||this.gv.setCursor(F)},startDragging:function(J){var A=this;A._lastClientPoint=$c(J),A._lastLogicalPoint=A.gv.lp(J),Ah(A,J)},clearDragging:function(){var z=this;z._lastClientPoint=z._lastLogicalPoint=z._logicalPoint=w},autoScroll:function(g){return this.gv.autoScroll(g,this._lastClientPoint)}});var hc=w,Jr=function(J){hc.handleWindowTouchMove(J)},gc=function(I){hc.handleWindowTouchEnd(I),q(x,fe,Jr),q(x,_g,gc),hc=w},be=function(k){hc.handleWindowMouseMove(k)},Mb=function(I){hc.handleWindowMouseUp(I),q(x,Vj,be),q(x,lh,Mb),hc=w},Id=function(g,h){if(g!==hc){var a=Rl(h);hc?a?hc.handleWindowTouchEnd(h):hc.handleWindowMouseUp(h):a?(B(x,fe,Jr),B(x,_g,gc)):(B(x,Vj,be),B(x,lh,Mb)),hc=g}},rh=function(d){var c=this;c.gv=d,c._is2d=d instanceof Om.GraphView,c._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Il,"wheel"].forEach(function(J){c.addListener(J)}),c.initImageResource()};Ap(rh,Wm,{enableVR:function(B){var p=this;if(!!p._vrEnable!==B)if(p._vrEnable=B,B)p.gv.vr.mp(p.onVRControllerChange,p);else if(p.gv.vr.ump(p.onVRControllerChange,p),p._vrRayPolyline){var O=p.gv.dm();O.remove(p._vrRayPolyline),O.remove(p._vrRayHitPoint),p._vrRayPolyline=r,p._vrRayHitPoint=r}},onVRControllerChange:function(a){var U=this,N=a.property,I=a.newValue,P=U.gv.vr.getController(I.id),Z=P.getRay();Z&&("gamepad.button.trigger"===N?"down"===I._62O?U.handle_mousedown(Z):U.handleWindowMouseUp(Z):"gamepad.pose"===N&&(U.handle_mousemove(Z),U.handleWindowMouseMove(Z)))},drawVRRay:function(D,t,i){var H,O=this,c=O.gv,r=O._vrRayPolyline,w=!1;if(r)H=O._vrRayHitPoint;else{var m=c.dm();O._vrRayPolyline=r=new s.Polyline,O._vrRayHitPoint=H=new s.Node,H.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),H.setAnchor3d(.5,.5,.499);var R=.2/c.vr.measureOflength;H.s3(R,R,R),r.s("intersect",!1),H.s("intersect",!1),m.add(r),m.add(H),w=!0}if(t){var U=i.world,V=i.worldNormal,v=U.x,I=U.y,T=U.z;r.s("shape.border.color","red"),r.setPoints([{x:D.origin.x,y:D.origin.z,e:D.origin.y},{x:v,y:T,e:I}]),H.s("3d.visible",!0),H.p3(v,I,T),H.lookAtDirection([V.x,V.y,V.z],"front")}else{r.s("shape.border.color","blue");var Z=new s.Math.Vector3;Z.copy(D.direction).setLength(1e3/O.gv.vr.measureOflength).add(D.origin),r.setPoints([{x:D.origin.x,y:D.origin.z,e:D.origin.y},{x:Z.x,y:Z.z,e:Z.y}]),H.s("3d.visible",!1)}c.fi({kind:"vrRayIntersect",ray:D,data:t,intersect:i,polyline:r,hitNode:H,begin:w})},setPreventEventDefault:function($,p){var F=this,T=F._eventListeners[$];T?T._prevent=p:F._eventListeners[$]=T={_removal:r,_prevent:p}},removeListener:function(O){var e=this,v=e._eventListeners[O];v&&v._removal&&(v._removal(),v._removal=r)},addListener:function(t){var R=this,i=R._eventListeners[t];if(i||(R._eventListeners[t]=i={_removal:r,_prevent:!0}),!i||!i._removal){var N=function(w){i._prevent&&Y.preventDefault(w),R.disabled||("wheel"===t?$l(R,w):R["handle_"+t](w))};B(R.gv.getView(),t,N),i._removal=function(){q(R.gv.getView(),t,N)}}},handleWindowTouchMove:function(V){this.handleWindowMouseMove(V)},handleWindowMouseMove:function(c){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",c):(this.handleDownInfo("onBeginDrag",c),this.isDragging=!0))
},handleWindowTouchEnd:function(_){this.handleWindowMouseUp(_)},handleWindowMouseUp:function(i){if(this.isDragging&&(this.handleDownInfo("onEndDrag",i),this.isDragging=!1),this.downInfo){var B=this.handle("onUp",i);if(B&&B.data===this.downInfo.data){this.handleMissingUp(i);var t=this,J=2===i.button?"onContextMenu":"onClick";if(!t._dbclickTimer)return t._dbclickTimer=fr(function(){delete t._dbclickTimer,t.handleClick(i,J,B),this.downInfo=w},Y.clickDelay),void 0;hd(t._dbclickTimer),delete t._dbclickTimer,J="onDoubleClick",t.handleClick(i,J,B)}else this.handleDownInfo("onUp",i);this.downInfo=w,this.downComps=w}},handle_mouseleave:function(A){var e=this,B=e.gv,m=e.currentInfo?e.currentInfo.data:w;if(m){m.s("onLeave")&&m.s("onLeave")(A,m,B),e.fire("data","onLeave",A,m);var i=e.currentInfo?e.currentInfo.hits:w;if(i)for(var Y in i)e.handleLeave(A,Y);e.currentInfo=w}},handle_mousewheel:function(T){T.scrollDelta=T.wheelDelta/40,this.handle("onScroll",T)},handle_DOMMouseScroll:function(Q){Q.scrollDelta=2===Q.axis?-Q.detail:0,this.handle("onScroll",Q)},handle_touchstart:function(R){this.handle_mousedown(R)},handle_touchmove:function(E){this.handle("onMove",E)},handle_mousedown:function(y){this.isDragging&&(this.handleDownInfo("onEndDrag",y),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",y),this.downInfo&&Id(this,y)},handle_mousemove:function(h){var Q=this,D=Q.gv;if(Q._hoverTimer&&(hd(Q._hoverTimer),delete Q._hoverTimer),!D._panning&&!D._moving){var K,p,l,Z=Q.handle("onMove",h),v=this.currentInfo?this.currentInfo.data:w,r=this.currentInfo?this.currentInfo.hits:w;if(Z&&(p=Z.data,l=Z.hits,Q._hoverTimer=fr(function(){hd(Q._hoverTimer),delete Q._hoverTimer,Q.handle("onHover",h,Z)},D.getHoverDelay()||Y.hoverDelay)),p!==v){if(v&&(v.s("onLeave")&&v.s("onLeave")(h,v,D),this.fire("data","onLeave",h,v)),p&&(p.s("onEnter")&&p.s("onEnter")(h,p,D),this.fire("data","onEnter",h,p)),r)for(K in r)this.handleLeave(h,K);if(l)for(K in l){var g=l[K],I=p._interactPrefix=g.prefix,T=I&&p.a(I+"onEnter")||g.target.onEnter;T&&T.call(g.target,h,p,D,g.point,g.width,g.height),this.fire(g.type,"onEnter",g.event,g.data,g.image,g.comp,g.point,g),p._interactPrefix=null}}else{if(r)for(K in r)l&&l[K]||this.handleLeave(h,K);if(l)for(K in l)if(!r||!r[K]){var g=l[K],I=p._interactPrefix=g.prefix,T=I&&p.a(I+"onEnter")||g.target.onEnter;T&&T.call(g.target,h,p,D,g.point,g.width,g.height),this.fire(g.type,"onEnter",g.event,g.data,g.image,g.comp,g.point,g),p._interactPrefix=null}}this.currentInfo=Z}},handle:function(O,a,U){var t,M=this,G=M.gv;if(M._is2d){if(U=U||G.getDataInfoAt(a),!U||!G.isInteractive(U.data))return;if(t=U.ui.interactiveInfo){var i,w=U.data;if(w.s(O)&&w.s(O)(a,w,G),this.fire("data",O,a,w),"body"===U.part&&t.bodyInfo)i="body",U.hits=this.handleImage(i,G.getImage(w),O,a,w,U.point,t.bodyInfo);else if("icons"===U.part&&t._38o){var j=t._38o[U.name];j&&j[U.index]&&(i="icons|"+U.name+"|"+U.index,U.hits=this.handleImage(i,U.icon,O,a,w,U.point,j[U.index]))}}return U}var w,p;if(!U)if(a&&a instanceof s.Math.Ray){var u=G.vr.intersectWorld(a);if(w=u.data,p=u.intersect,M.drawVRRay(a,w,p),!w)return;var K=G.getData3dUI(w);if(t=K.interactiveInfo,!t)return;U={data:w,part:p.part,ui:K}}else{if(U=G.getDataInfoAt(a),!U)return;U&&(U={data:U.data,part:U.part})}if(G.isInteractive(U.data)){if(!p){w=U.data;var K=G.getData3dUI(w);if(U.ui=K,t=K.interactiveInfo,!t)return U;if(p=G.intersectObject(a,w),!p)return}w.s(O)&&w.s(O)(a,w,G),this.fire("data",O,a,w);var o,b=p.part;return"body"!==b&&(o=w.s(b+".image")||w.s("shape3d."+b+".image")),o||(o=w.s("all.image")||w.s("shape3d.image")),o?(t="object"==typeof o?t[o.uuid]:t[o],t&&t.bodyInfo?(U.part="body",U.interactiveInfo=t,U.point=this._convertUVToPoint(p.uv,t),U.image=o,U.hits=this.handleImage("body",o,O,a,w,U.point,t.bodyInfo),U):U):U}},_handleLeaveOrMissing:function(V,g,L){var R="leave"===V?this.currentInfo:this.downInfo;if(R){var W=R.interactiveInfo||R.ui.interactiveInfo;if(W){var b,X,u=R.data;if(this._is2d){if(X=this.gv.lp(g),"body"===R.part&&W.bodyInfo)b="body","leave"===V?this.handleLeaveImage(L,b,this.gv.getImage(u),g,u,X,W.bodyInfo):this.handleMissingUpImage(b,this.gv.getImage(u),g,u,X,W.bodyInfo);else if("icons"===R.part&&W._38o){var $=W._38o[R.name];$&&$[R.index]&&(b="icons|"+R.name+"|"+R.index,"leave"===V?this.handleLeaveImage(L,b,R.icon,g,u,X,$[R.index]):this.handleMissingUpImage(b,R.icon,g,u,X,$[R.index]))}}else{if(!W.bodyInfo)return;var x=this.gv.intersectObject(g,u);X=x&&x.uv?this._convertUVToPoint(x.uv,W):{x:1/0,y:1/0},"leave"===V?this.handleLeaveImage(L,"body",R.image,g,u,X,W.bodyInfo):this.handleMissingUpImage("body",R.image,g,u,X,W.bodyInfo)}}}},handleClick:function(q,O,h){var J=this,Z=this.downInfo;if(Z&&h){var V,x=h.interactiveInfo||h.ui.interactiveInfo,R=h.data,e=this.gv;if(R.s(O)&&R.s(O)(q,R,e),J.fire("data",O,q,R),x)if(this._is2d){if(Z.part===h.part){var G=e.lp(q);"body"===h.part&&x.bodyInfo&&(V="body",this.handleClickImage(V,e.getImage(R),O,q,R,G,x.bodyInfo,h))}}else{if(!x.bodyInfo)return;var I=e.intersectObject(q,R);if(!I)return;G=this._convertUVToPoint(I.uv,x),this.handleClickImage("body",Z.image,O,q,R,G,x.bodyInfo,h)}}},handleDownInfo:function(o,V){if(this.downInfo){var m=this.downInfo,k=this.gv,T=m.interactiveInfo||m.ui.interactiveInfo;if(T){var Z,L=m.data;if(L.s(o)&&L.s(o)(V,L,k),this.fire("data",o,V,L),this._is2d){var S=k.lp(V);if("body"===m.part&&T.bodyInfo)Z="body",this.handleDownInfoImage(Z,k.getImage(L),o,V,L,S,T.bodyInfo);else if("icons"===m.part&&T._38o){var x=T._38o[m.name];x&&x[m.index]&&(Z="icons|"+m.name+"|"+m.index,this.handleDownInfoImage(Z,m.icon,o,V,L,S,x[m.index]))}}else{if(!T.bodyInfo)return;var b=k.intersectObject(V,L);if(!b)return;S=this._convertUVToPoint(b.uv,T),this.handleDownInfoImage("body",m.image,o,V,L,S,T.bodyInfo)}}}},fire:function(i,S,b,u,B,_,K,l){this.gv.fi({kind:S,type:i,event:b,data:u,image:B,comp:_,view:this.gv,point:K,width:l?l.width:r,height:l?l.height:r})},handleImage:function(G,E,o,W,j,x,e){var h={};if(E&&(E=Ub(E))){var P=this.gv,X=e.rect,F=this.convertPoint(x,e);F.inRect&&(E[o]&&E[o](W,j,P,F,X.width,X.height),this.fire("image",o,W,j,E,r,F,X),h[G+"|image"]={target:E,type:"image",image:E,data:j,event:W,point:F,width:X.width,height:X.height});for(var S,q=e.compInfos,O=E,B=q.length-1;B>=0;B--){var V=q[B],J=V.comp;if(F=this.convertPoint(x,V,O,J,P,j),F.inRect){X=V.rect;var p=j._interactPrefix=V.prefix,k=p&&j.a(p+o)||J[o];if(k&&(S=k.call(J,W,j,P,F,X.width,X.height)),this.fire("comp",o,W,j,E,J,F,X),S!==!0&&(E=X.image)&&(E[o]&&(S=E[o](W,j,P,F,X.width,X.height)),this.fire("image",o,W,j,E,r,F,X)),j._interactPrefix=null,h[G+"|"+B]={target:J,type:"comp",comp:J,image:E,data:j,event:W,point:F,width:X.width,height:X.height,prefix:p},this.downComps&&this.downComps.push(J),E&&(h[G+"|"+B+"|image"]={target:E,type:"image",image:E,data:j,event:W,point:F,width:X.width,height:X.height,prefix:p}),S===!0)break}}}return h},handleLeave:function(K,H){return this._handleLeaveOrMissing("leave",K,H)},handleMissingUp:function(s){return this._handleLeaveOrMissing("missing",s)},handleLeaveImage:function(m,X,i,K,n,M,O){if(i&&(i=Ub(i))){var L=this.gv,A=O.rect,z=this.convertPoint(M,O);m===X+"|image"&&(i.onLeave&&i.onLeave(K,n,L,z,A.width,A.height),this.fire("image","onLeave",K,n,i,r,z,A));for(var R,B=O.compInfos,$=i,e=B.length-1;e>=0;e--){var t=B[e],c=t.comp;z=this.convertPoint(M,t,$,c,L,n),A=t.rect;var E=n._interactPrefix=t.prefix;if(m===X+"|"+e){var y=E&&n.a(E+"onLeave")||c.onLeave;y&&(R=y.call(c,K,n,L,z,A.width,A.height)),this.fire("comp","onLeave",K,n,i,c,z,A)}if(R!==!0&&(i=A.image)&&m===X+"|"+e+"|image"&&(i.onLeave&&(R=i.onLeave(K,n,L,z,A.width,A.height)),this.fire("image","onLeave",K,n,i,r,z,A)),n._interactPrefix=null,R===!0)break}}},handleMissingUpImage:function(X,S,z,f,A,s){var D="onUp",G=this.downInfo.hits;if(G&&S&&(S=Ub(S))){var q=this.gv,y=s.rect,p=this.convertPoint(A,s);!p.inRect&&G[X+"|image"]&&(S[D]&&S[D](z,f,q,p,y.width,y.height),this.fire("image",D,z,f,S,r,p,y));for(var c,$=s.compInfos,v=S,F=$.length-1;F>=0;F--){var b=$[F],B=b.comp;if(p=this.convertPoint(A,b,v,B,q,f),!p.inRect){y=b.rect;var R=f._interactPrefix=b.prefix;if(G[X+"|"+F]){var n=R&&f.a(R+D)||B[D];n&&(c=n.call(B,z,f,q,p,y.width,y.height)),this.fire("comp",D,z,f,S,B,p,y)}if(c!==!0&&(S=y.image)&&G[X+"|"+F+"|image"]&&(S[D]&&(c=S[D](z,f,q,p,y.width,y.height)),this.fire("image",D,z,f,S,r,p,y)),f._interactPrefix=null,c===!0)break}}}},handleDownInfoImage:function(i,E,A,p,N,M,j){var c=this.downInfo.hits;if(c&&E&&(E=Ub(E))){var h=this.gv,V=j.rect,a=this.convertPoint(M,j);c[i+"|image"]&&(E[A]&&E[A](p,N,h,a,V.width,V.height),this.fire("image",A,p,N,E,r,a,V));for(var K,m=j.compInfos,H=E,S=m.length-1;S>=0;S--){var $=m[S],G=$.comp;a=this.convertPoint(M,$,H,G,h,N),V=$.rect;var T=N._interactPrefix=$.prefix,R=["onDrag","onEndDrag"].indexOf(A)>=0;if(!R&&c[i+"|"+S]||R&&this.downComps&&this.downComps.indexOf(G)>=0){var Z=T&&N.a(T+A)||G[A];Z&&(K=Z.call(G,p,N,h,a,V.width,V.height)),this.fire("comp",A,p,N,E,G,a,V)}if(K!==!0&&(E=V.image)&&c[i+"|"+S+"|image"]&&(E[A]&&(K=E[A](p,N,h,a,V.width,V.height)),this.fire("image",A,p,N,E,r,a,V)),N._interactPrefix=null,K===!0)break}}},handleClickImage:function(C,y,n,L,R,X,A,s){var W=this.downInfo.hits,j=s.hits;if(W&&y&&(y=Ub(y))){var Z=this.gv,d=A.rect,m=this.convertPoint(X,A);W[C+"|image"]&&(y[n]&&y[n](L,R,Z,m,d.width,d.height),this.fire("image",n,L,R,y,r,m,d));for(var I,J=A.compInfos,U=y,o=J.length-1;o>=0;o--){var M=J[o],p=M.comp;m=this.convertPoint(X,M,U,p,Z,R),d=M.rect;var $=R._interactPrefix=M.prefix;if(W[C+"|"+o]&&j[C+"|"+o]){var K=$&&R.a($+n)||p[n];K&&(I=K.call(p,L,R,Z,m,d.width,d.height)),this.fire("comp",n,L,R,y,p,m,d)}if(I!==!0&&(y=d.image)&&W[C+"|"+o+"|image"]&&(y[n]&&(I=y[n](L,R,Z,m,d.width,d.height)),this.fire("image",n,L,R,y,r,m,d)),R._interactPrefix=null,I===!0)break}}},initImageResource:function(){Y.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(f,F){if(!f)return{x:1/0,y:1/0};var c=F.bodyInfo.rect,Z=f.clone(),i=f.multiply({x:c.width,y:c.height});return i.local=Z,i},convertPoint:function(f,o,d,K,L,O){var F=o.rect,V=o.matrix.applyInverse(f).sub(F),J=V.x>=0&&V.y>=0&&V.x<=F.width&&V.y<=F.height;if(!J)return V;if(K&&Pb(K.pixelPerfect,O,L)){var F,W=1;this._is2d?(W=L.getZoom(),F=ih(f.x,f.y,r,W)):F=ih(f.x,f.y);var B=!1,c=F.x,Q=F.y,g=F.width,P=F.height,m=Y.hitMaxArea,e=g*P*W*W;if(e>m){var U=Math.sqrt(m/e);W*=U}g*=W,P*=W,2>g&&(g=2),2>P&&(P=2),c*=W,Q*=W;var h=gm(g,P),I=new Rp(0,-c,-Q,W,W);I.append(o.matrix),L._drawForChecking=!0,K.transform=I,o.refRect&&o.refRect.fitSize&&(K.refRect=o.refRect);var k=d.comps;d.comps=[K],El(h,d,0,0,g,P,O,self),d.comps=k,delete K.refRect,delete K.transform,L._drawForChecking=!1;try{for(var $=0,N=h.getImageData(0,0,g,P).data;$<N.length;$+=4)if(0!==N[$+3]){B=!0;break}h.restore()}catch(X){Gr=w,B=!1}V.inRect=B}else V.inRect=!0;return V}});var Gf=Om.DefaultInteractor=function(e){Lh(Gf,this,[e])};$j("DefaultInteractor",Wm,{handle_mousedown:function(A){mc(A);var E=this,V=E.gv,I=V.getDataAt(A);if(V.setFocus(A)&&!V._editing&&!V._scrolling){Ir(A)?V.handleDoubleClick(A,I):V.handleClick(A,I);var y=Tf(A);!Fg()&&!y&&I&&(V.isMovable(I)||V._39Q(I))||!V.isPannable()||!yf(A)&&!y||Xm(A)||(E._tx=V.tx(),E._ty=V.ty(),E.startDragging(A))}},handleWindowMouseUp:function(R){var b=this,H=b.gv;H._panning&&(delete H._panning,H.onPanEnded(),b.fi({kind:"endPan",event:R})),delete b._tx,delete b._ty,b.clearDragging()},handle_mousemove:function(y){var q=this,z=q.gv;q._hoverTimer&&(hd(q._hoverTimer),delete q._hoverTimer),q._hoverTimer=fr(function(){q.fi({kind:"hover",event:y}),hd(q._hoverTimer),delete q._hoverTimer},z.getHoverDelay()||Y.hoverDelay)},handle_touchmove:function(K){this.handle_mousemove(K)},handleWindowMouseMove:function(p){var Y=this,Q=Y.gv;Y.fi({kind:Q._panning?"betweenPan":"beginPan",event:p}),Q._panning=1;var t=ps(Q,p,Y._lastClientPoint);Q.setTranslate(Y._tx+t.x,Y._ty+t.y)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta)},handle_DOMMouseScroll:function(h){2===h.axis&&this.gv.handleScroll(h,-h.detail)},handle_keydown:function(I){this.gv.handleKeyDown(I)}});var tl=Om.SelectInteractor=function(w){Lh(tl,this,[w])};$j("SelectInteractor",Wm,{_42:function(){var J=this,Y=J.gv,V=Y.getZoom(),D=J.mark,q=J.div;q||(q=J.div=Zn(),Ld(J.getView(),q));var C={};C.x=D.x*V+Y.tx(),C.y=D.y*V+Y.ty(),C.width=D.width*V,C.height=D.height*V,Ni(q,C),this.intersects()?(q.style.border="",q.style.background=Y.getRectSelectBackground()):(q.style.background="",q.style.border="1px solid "+Y.getRectSelectBorderColor())},handle_mousedown:function(j){var S=this,G=S.gv;if(S._57I=w,S.pendingClickThrough=w,!(G._editing||G._scrolling||Fg()||Tf(j))){var r=G.getDataAt(j),s=G.sm();r?Xm(j)?s.co(r)?s.rs(r):s.as(r):s.co(r)?r instanceof So&&r.isClickThroughEnabled()&&yf(j)&&(S.pendingClickThrough=$c(j)):s.ss(r):Xm(j)||!G.isPannable()?yf(j)&&(Xm(j)||s.cs(),G.isRectSelectable()&&(S.startDragging(j),G._77O=1)):yf(j)&&(S._57I=$c(j))}},handle_mouseup:function(A){var t=this,C=t.gv,i=t._57I;if(i&&(qd(i,$c(A))<=1&&C.sm().cs(),t._57I=w),t.pendingClickThrough){if(qd(t.pendingClickThrough,$c(A))<=1){var s=C.getDataAt(A);if(s instanceof So&&s.isClickThroughEnabled()){var c=C.getDataAt(A,function(p){var $=p.getParent()===s&&C.isSelectable(p,!0);return $});c&&(A.clickThrough=!0,C.sm().ss(c))}}t.pendingClickThrough=w}},handleWindowMouseUp:function(j){this.clear(j)},handleWindowMouseMove:function(n){var g=this,H=g.gv;g._logicalPoint=H.lp(n),g.mark?(g.fi({kind:"betweenRectSelect",event:n}),H.isPannable()&&g.autoScroll(n),g.redraw()):g.fi({kind:"beginRectSelect",event:n}),g.mark=ln(g._lastLogicalPoint,g._logicalPoint),g.redraw()},intersects:function(){var p=this,Y=p._lastLogicalPoint,S=p._logicalPoint;return Y.x>S.x||Y.y>S.y},clear:function(S){var L=this,f=L.gv,K=L.mark;if(L._57I=w,L.pendingClickThrough=w,L._lastLogicalPoint){if(K){if(0!==K.width&&0!==K.height){var J=f.getDatasInRect(K,L.intersects());if(!J.isEmpty()){var W=f.sm(),U=W.toSelection();J.each(function(Y){W.co(Y)?U.remove(Y):U.add(Y)}),W.ss(U)}}zk(L.div),delete L.div,delete L.mark,L.redraw(),L.fi({kind:"endRectSelect",event:S}),f.onRectSelectEnded()}L.clearDragging(),delete f._77O}},redraw:function(){var H=this;H._draw||(H._draw=1,fr(function(){H.mark&&H._42(),delete H._draw},16))}});var Cf=Om.MoveInteractor=function(r){Lh(Cf,this,[r])};$j("MoveInteractor",Wm,{handle_mousedown:function(Q){var G=this,$=G.gv;if(yf(Q)&&!$._editing&&!$._scrolling&&!Fg()){var H=$.getSelectedDataAt(Q);!H||$._39Q(H)&&!$.isMovable(H)?$._focusData=w:(G._data=H,$.handleMouseDown&&$.handleMouseDown(Q,H),G.startDragging(Q),$.isMovable(H)&&($._moving=1))}},handleWindowMouseUp:function(S){var s=this,y=s.gv;y.handleMouseUp&&y.handleMouseUp(S,s._data),s.clear(S)},handleWindowMouseMove:function(a){var $=this,Q=$._data,m=$.gv;if((!m._93O||!m._93O(a,Q))&&m._moving){$._logicalPoint||$.fi({kind:"prepareMove",event:a});var O=$._logicalPoint?"betweenMove":"beginMove",u={kind:O,event:a},H=$._logicalPoint=m.lp(a);"beginMove"!==O||$._alreadyBeginTransaction||($._alreadyBeginTransaction=!0,m.getDataModel().beginTransaction());var q=$._calcShift(O,a),r=q.x,h=q.y,p=$.gv.getMoveMode(a,Q);p&&("x"===p?h=0:"y"===p?r=0:"xy"!==p&&(r=h=0)),m.moveSelection(r,h),$._lastLogicalPoint=H,$.autoScroll(a),$.fi(u)}},_calcShift:function(){var c=this,A=c._logicalPoint,P=c._lastLogicalPoint,n=A.x-P.x,r=A.y-P.y;return{x:n,y:r}},clear:function(Z){var y=this,T=y.gv;y._lastLogicalPoint&&(y._lastLogicalPoint=y._data=T._moving=w,y._logicalPoint&&(y.fi({kind:"endMove",event:Z}),T.onMoveEnded()),y.clearDragging()),y._alreadyBeginTransaction&&(y._alreadyBeginTransaction=!1,T.getDataModel().endTransaction())}});var uk=Om.TextEditInteractor=function(k){Lh(uk,this,[k]),this.init()};$j("TextEditInteractor",Wm,{init:function(){var g=this,R=this.input=A.createElement("input"),l=R.style;R.text="text",l.border="1px solid #d8d8d8",l.position="absolute",l.padding="2px 3px",l.outline="none",l.marginLeft="-90px",l.marginTop="-16px",l.backgroundColor="rgba(255,255,255, 0.9)",l.fontSize="14px",l.width="180px",l.height="32px",l.boxShadow="0 0 13px rgba(16,142,233, 0.5)",l.textAlign="center",l.boxSizing="border-box",B(R,"keyup",function(A){sk(A)&&g.endTextEdit()}),B(R,"focus",function(){R.select()});var p=this.textarea=A.createElement("textarea"),M=this.wrap=A.createElement("div");M.appendChild(p),l=p.style,l.margin=0,l.padding="4px",l.overflow="hidden",l.boxSizing="border-box",l.position="absolute",l.outline="none",l.backgroundColor="transparent",l.resize="none",l.textAlign="center",l.fontSize="14px",l.border="none",l.borderWidth=0,l.width="100%",l.top="50%",l=M.style,l.boxSizing="border-box",l.margin=0,l.padding=0,l.position="absolute",l.boxShadow="0 0 13px rgba(16,142,233, 0.5)",l.border="1px solid #d8d8d8",l.backgroundColor="rgba(255,255,255, 0.9)",l.width="180px",l.marginLeft="-90px",B(p,"keydown",function(X){return(bg()||Xm())&&sk(X)?(g.endTextEdit(),void 0):(g.calculateTextareaHeight(String.fromCharCode(X.keyCode)),void 0)}),B(p,"focus",function(){p.select()});var C=function(d){d.stopPropagation()};B(R,"mousedown",C),B(R,"touchstart",C),B(p,"mousedown",C),B(p,"touchstart",C),g.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],g.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",g.handleWindowClick=function(p){var X=g._editingDOM;if(X){var R=X.getBoundingClientRect(),L=$c(p);Vb(R,L)||g.endTextEdit()}}},handle_mousedown:function(H){var j=this,P=j.gv;if(Ir(H)&&!P._editing){var _=P.getDataAt(H);if(_){var r=P.getTextEditInfo(_);r&&(this._editInfo=r,this._editTarget=_,P._editing=!0,r.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var $=this,N=$.gv,u=$._editTarget,q=$.getTargetValue(),j=$.textarea,Q=$.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===q||q===r)&&(q=""),j.value=q,$._editingDOM=j,N.getView().appendChild(Q),this.layoutHTML(Q,u),this.calculateTextareaHeight(),fr(function(){j.focus(),B(x,"mousedown",$.handleWindowClick),B(x,"touchstart",$.handleWindowClick)},10)},handleTextEdit:function(){var j=this,u=j.gv,N=j._editTarget,W=j.getTargetValue(),l=j.input;(null===W||W===r)&&(W=""),l.value=W,j._editingDOM=l,u.getView().appendChild(l),this.layoutHTML(l,N),fr(function(){l.focus(),B(x,"mousedown",j.handleWindowClick),B(x,"touchstart",j.handleWindowClick)},10)},layoutHTML:function(o,W){var l=this.gv,t=l.getZoom();if(W instanceof s.Node){var D=W.getRect();o.style.left=(D.x+D.width/2)*t+l.tx()+"px",o.style.top=(D.y+D.height/2)*t+l.ty()+"px"}else if(W instanceof s.Edge){var G=l.getDataUI(W),D=G._6I;o.style.left=(D.x+D.width/2)*t+l.tx()+"px",o.style.top=(D.y+D.height/2)*t+l.ty()+"px"}},endTextEdit:function(){var b=this,k=b._editInfo.isMultiline?b.wrap:b.input,d=b._editInfo.isMultiline?b.textarea:b.input;b.setTargetValue(d.value),b.gv.getView().removeChild(k),b.gv._editing=!1,delete b._editingDOM,q(x,"mousedown",b.handlelick),q(x,"touchstart",b.handleWindowClick)},setTargetValue:function(b){var A=this,e=A._editTarget,g=A._editInfo,P=g.accessType,D=g.name;if(D&&P||(P="p",D="name"),"p"===P){var r=s.Default.setter(D);e[r](b)}else"a"===P?e.a(D,b):e.s(D,b)},getTargetValue:function(){var Q=this,O=Q._editTarget,K=Q._editInfo,i=K.accessType,L=K.name;if(L&&i||(i="p",L="name"),"p"===i){var Z=s.Default.getter(L);return O[Z]()}return"a"===i?O.a(L):O.s(L)},createHiddenTextarea:function(){this.hiddenTextarea=A.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(m,N){if(N&&this.computedStyleCache)return this.computedStyleCache;var i=this,H=x.getComputedStyle(m),K=H.getPropertyValue("box-sizing")||H.getPropertyValue("-moz-box-sizing")||H.getPropertyValue("-webkit-box-sizing"),k=parseFloat(H.getPropertyValue("padding-bottom"))+parseFloat(H.getPropertyValue("padding-top")),P=parseFloat(H.getPropertyValue("border-bottom-width"))+parseFloat(H.getPropertyValue("border-top-width")),S=i.SIZING_STYLE.map(function(z){return z+":"+H.getPropertyValue(z)}).join(";"),F={sizingStyle:S,paddingSize:k,borderSize:P,boxSizing:K};return N&&(this.computedStyleCache=F),F},calculateTextareaHeight:function(p){p=p||"";var n=this,P=n.textarea,V=n.hiddenTextarea,N=n.wrap,U=32,q=n.calculateHTMLStyle(P,!1),Y=q.paddingSize,X=q.borderSize,u=q.boxSizing,M=q.sizingStyle;V.setAttribute("style",M+";"+n.HIDDEN_TEXTAREA_STYLE),V.value=P.value+p;var I=V.scrollHeight;"border-box"===u?I+=X:"content-box"===u&&(I-=Y),P.style.height=I+"px",P.style.marginTop=0-.5*I+"px",N.style.height=Math.max(I,U)+"px",N.style.marginTop=I*-.5+"px"}});var bm=Om.ScrollBarInteractor=function(A){Lh(bm,this,[A])};$j("ScrollBarInteractor",Wm,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(r){var e=this.gv.getViewRect();return this._41o()&&(e.x+e.width-this.gv.lp(r).x)*this.gv.getZoom()<fl},isH:function(H){var t=this.gv.getViewRect();return this._40o()&&(t.y+t.height-this.gv.lp(H).y)*this.gv.getZoom()<fl},handle_mousemove:function(j){this.handle_touchmove(j)},handle_touchmove:function(I){if(!Nr&&yf(I)&&this.gv.isScrollBarVisible()){var S=this,x=S.isV(I),P=S.isH(I);(x||P)&&S.gv.showScrollBar(),S.gv._scrolling=x||P}},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(J){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=w,this.fi({kind:"endScroll",event:J})},handle_mousedown:function(L){this.handle_touchstart(L)},handle_touchstart:function(k){var K=this;if(K.gv.setFocus(k),mc(k),K.handle_touchmove(k),!(Sf(k)>1)&&K.gv._scrolling&&K.gv.isScrollBarVisible()){K._cp=$c(k),K._tx=K.gv.tx(),K._ty=K.gv.ty();var F=K.isV(k);K._state=F?"vScroll":"hScroll",Ah(K,k),K.fi({kind:"beginScroll",event:k})}},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(_){var U=$c(_),q=this.gv.getViewRect(),H=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-U.y)*H.height/q.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-U.x)*H.width/q.width),this.fi({kind:"betweenScroll",event:_})}});var Vc=Om.TouchInteractor=function(o,y){y=y||{},y.selectable===r&&(y.selectable=!0),y.movable===r&&(y.movable=!0),y.pannable===r&&(y.pannable=!0),y.pinchable===r&&(y.pinchable=!0),y.editable===r&&(y.editable=!0),this.params=y,Lh(Vc,this,[o])};$j("TouchInteractor",Wm,{ms_edit:1,setUp:function(){var M=this;Vc.superClass.setUp.call(M),re&&M.params.editable&&M.gv.setEditInteractor(M)},tearDown:function(){var k=this;Vc.superClass.tearDown.call(k),re&&k.params.editable&&k.gv.setEditInteractor(w)},clear:function(J){var S=this,a=S.gv;a._moving&&(S.fi({kind:"endMove",event:J}),delete a._moving,a.onMoveEnded(),a.dm().endTransaction()),a._panning&&(S.fi({kind:"endPan",event:J}),delete a._panning,a.onPanEnded()),a._pinching&&(S.fi({kind:"endPinch",event:J}),delete a._pinching,a.onPinchEnded()),a._editing&&(S._46O(J),S._77I=S._node=S._edge=S._shape=S._rect=S._89I=S._index=a._editing=w),S.pendingClickThrough=S._moving=S._panning=S._pinching=S._editing=S._57I=S._data=S._beginHistory=w,S.clearDragging()},handle_touchstart:function(b){var L=this;if(!L.gv._editing){mc(b),L._57I=w,L.pendingClickThrough=w;var H=L.params,g=L.gv,x=g.sm(),v=g.getDataAt(b),D=Sf(b);if(1===D){if(Ir(b))return g.handleDoubleClick(b,v),void 0;g.handleClick(b,v),v&&(g.handleMouseDown&&g.handleMouseDown(b,v),L._data=v),H.selectable||(v=w),v&&(x.co(v)?v instanceof So&&v.isClickThroughEnabled()&&(L.pendingClickThrough=$c(b)):x.ss(v),H.editable&&g.isEditable(v)&&L._79I(b,v,!0)?(L._editing=1,L.startDragging(b)):H.movable&&g.isMovable(v)&&(L._moving=1,L.startDragging(b))),v&&g.isMovable(v)||(L._57I=$c(b),H.pannable&&g.isPannable()&&(L._panning=1,L.startDragging(b),L._translate={x:g.tx(),y:g.ty()}))}else if(H.pinchable&&2===D){if(v&&g._39Q(v))return;L._pinching=1,L.startDragging(b);var s=g.getView(),T=g.getZoom(),j=s.getBoundingClientRect(),f=b.touches[0],K=b.touches[1],G={x:(f.clientX+K.clientX)/2-j.left,y:(f.clientY+K.clientY)/2-j.top};G.x-=g.tx(),G.y-=g.ty(),G.x/=T,G.y/=T,L._p=G,L._d=eo(b)}}},handle_touchend:function(A){var p=this,v=p.gv,T=p._57I,J=p._data;if(T&&(qd(T,$c(A))<=1&&!v.getDataAt(A)&&v.sm().cs(),p._57I=w),J&&v.handleMouseUp&&v.handleMouseUp(A,J),p.pendingClickThrough){if(qd(p.pendingClickThrough,$c(A))<=1){var J=v.getDataAt(A);if(J instanceof So&&J.isClickThroughEnabled()){var $=v.getDataAt(A,function(c){var f=c.getParent()===J&&v.isSelectable(c,!0);return f});$&&(A.clickThrough=!0,v.sm().ss($))}}p.pendingClickThrough=w}},handleWindowTouchEnd:function(f){this.clear(f)},handleWindowTouchMove:function(s){var U=this,M=U.gv,y=Sf(s);if(1===y){var S=$c(s),Z=ps(M,S,U._lastClientPoint),r=qd({x:0,y:0},Z);if(U._editing&&(U._beginHistory||(U._beginHistory=1,M.dm().beginTransaction()),M._editing=1,U._78I(s)),U._moving){if(!M._moving&&r<Y.touchMoveThreshold)return;U._beginHistory||(U._beginHistory=1,M.dm().beginTransaction()),U.handleMove(s)}else if(U._panning){if(!M._panning&&r<Y.touchMoveThreshold)return;M.setTranslate(U._translate.x+Z.x,U._translate.y+Z.y),U.fi({kind:M._panning?"betweenPan":"beginPan",event:s}),M._panning=1}}else if(2===y&&U._pinching){var x=eo(s);M.handlePinch(U._p,x,U._d),U._d=x,U.fi({kind:M._pinching?"betweenPinch":"beginPinch",event:s}),M._pinching=1}},handleMove:function(B){var C=this,v=C.gv,O=v.lp(B);v._93O&&v._93O(B,C._data)||(v.moveSelection(O.x-C._lastLogicalPoint.x,O.y-C._lastLogicalPoint.y),C._lastLogicalPoint=O,C.autoScroll(B),C.fi({kind:v._moving?"betweenMove":"beginMove",event:B}),v._moving=1)}});var s=x.ht,Ph=s.graph._editor={Math:s.Math,Guide:{}};Ph.getStyle=function(G){var U,Q=Ph.StyleMap;return Q&&(U=Q[G],U!==r)?U:Ph.DefaultStyleMap[G]},Ph.setStyle=function(c,z){var S=Ph.StyleMap;S||(S=Ph.StyleMap={}),S[c]=z},Ph.inEdit=function(o){return o._inXEdit===!0},Ph.startEdit=function(S){S._inXEdit=!0,Ph.Inject.doInject(S)},Ph._46O=function(R){R._inXEdit=!1,Ph.Inject.undoInject(R)},Ph.toScreenPosition=function(O,u){var s=O.tx(),A=O.ty(),Y=O._zoom;return new Ph.Math.Vector2(u.x*Y+s,u.y*Y+A)},Ph.checkHit=function($,F,a){return $.distanceTo(F)<a?!0:!1},Ph.toWorldPosition=function(y,X){var I=y.tx(),N=y.ty(),p=y._zoom;return{x:(X.x-I)/p,y:(X.y-N)/p}},Ph.setAntialias=function(E,I){for(var x,m=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],C=0,O=m.length;O>C&&(x=m[C],!(x in E));C++);E[x],E[x]=I},Ph.getTargetCornersOnScreen=function(x,f){if(!f)return null;var l,P=[];if(Oi(f,x)){var W=Zl(x,f);l=[{x:W.x,y:W.y},{x:W.x+W.width,y:W.y},{x:W.x+W.width,y:W.y+W.height},{x:W.x,y:W.y+W.height}]}else{if(!f.getCorners)return null;l=f.getCorners()}return l.forEach(function(R){var y=Ph.toScreenPosition(x,R);P.push(y.x,y.y)}),P},Ph.log=function(){};var ug=Ph.Inject={_modules:[]};ug.registAsModule=function(P,C){var p={},Q={};for(var $ in P){var u=C.prototype[$];p[$]=u}P.getBackup=function(F){return p[F]},P.getBackups=function(){return p},Q.doInject=function(){for(var G in P)"getBackup"!==G&&(C.prototype[G]=P[G])},Q.undoInject=function(){for(var j in P)"getBackup"!==j&&(C.prototype[j]=p[j])},ug._modules.push(Q)},ug.doInject=function(M){for(var O,z=ug._modules,P=0,d=z.length;d>P;P++)O=z[P],O.doInject(M)},ug.undoInject=function(Q){for(var q,G=ug._modules,N=0,b=G.length;b>N;N++)q=G[N],q.undoInject(Q)};var Wm=s.graph.EditInteractor=function(C){var t=this,a=A.createElement("canvas");a.className="editCanvas",a.style.position="absolute",t._styleMap={},t._canvas=a,t._context=a.getContext("2d"),Wm.superClass.constructor.call(t,C),this._editDetail=!1,Ph.setAntialias(t._context,!1),t._subModules=[new Ph.Anchor(t),new Ph.RotateX(t),new Ph.MoveDummy(t),new Ph.Rect(t),new Ph.Curve(t),new Ph.MoveHelper(t)],t._gridGuide=new Ph.Guide.Grid(t),t._rectGuide=new Ph.Guide.Rect(t),t._hoverGuide=new Ph.Guide.Hover(t)},Mc=Wm;s.Default.def(Wm,s.graph.Interactor,{ms_edit:1,ms_fire:1}),R.defineProperties(Wm.prototype,{editDetail:{get:function(){var S=!!this._editDetail;return S},set:function(t){var _=this,c=_._editDetail;c!==t&&(_._editDetail=t,_.gv._editing=t,_.fp("editDetail",c,t),_.fp("pointsEditingMode",c,t),_.fi({kind:t?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(s){(!this._editDetail||s)&&(this.gv._editing=s,s||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(y){this._editing=y,this.gvEditing=y}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(v){var t=this;t.editDetail!==v&&(v?t._tryEnterEditDetailMode():t._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var J=this._gridEnabled;if(!J)return!1;var m=this.gv;return m?!0:!0},set:function(h){h!==this._gridEnabled&&(this._gridEnabled=h,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(y){y!==this._agEnabled&&(this._agEnabled=y,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Wm.prototype.getSubModule=function(b){var r,e,U,z=this._subModules;for(e=0,U=z.length;U>e;e++)if(r=z[e],r.catalog===b)return r},Wm.prototype.invokeSubModule=function(V,y){for(var t,X,E,i=this,x=i._subModules,G=Array.prototype.slice.call(arguments,2),B=0,u=x.length;u>B;B++)if(t=x[B],X=t[V],X&&(E=X.apply(t,G),E!=r&&y))return t},Wm.prototype.invokeSubModuleInverse=function(h,g){var E=this,M=E._subModules;if(M)for(var d,t,l,L=Array.prototype.slice.call(arguments,2),z=M.length-1;z>=0;z--)if(d=M[z],t=d[h],t&&(l=t.apply(d,L),l!=r&&g))return d},Wm.prototype.setUp=function(){Ph.log("setUp");var V=this,v=V.gv,w=v.getView(),g=V._canvas;Wm.superClass.setUp.call(V),v.setEditInteractor(V),v._79O?w.insertBefore(g,v._79O):w.appendChild(g),Ph.startEdit(v),V.invokeSubModule("setUp"),v.dm().mm(V._onDataModelChanged,V),v.dm().md(V._onDataPropertyChanged,V)},Wm.prototype.tearDown=function(){Ph.log("tearDown");var H=this,M=H.gv,R=M.getView();H._resetCustomCursorStyle(),Wm.superClass.tearDown.call(H),M.dm().umm(H._onDataModelChanged,H),M.dm().umd(H._onDataPropertyChanged,H),M.setEditInteractor(null),R.removeChild(H._canvas),H._drawTimer&&(hd(H._drawTimer),H._drawTimer=null),Ph._46O(M),H.invokeSubModule("tearDown")},Wm.prototype._onDataModelChanged=function(i){var M=this;("clear"===i.kind||"remove"===i.kind&&M.editDetail&&i.data===M.getSubModule("Curve").target)&&(M.editDetail=!1,M._42())},Wm.prototype._onDataPropertyChanged=function(z){var V=this;if(V.editDetail){var I=V.getSubModule("Curve"),p=z.data;p===I.target&&(p._writing||I._handleDataChanged(z))}},Wm.prototype.clear=function(){Ph.log("clear")},Wm.prototype.redraw=function(){this._42()},Wm.prototype._42=function(){var n=this;n._drawTimer||(n._drawTimer=fr(function(){n._drawTimer=null,n.drawImpl()},0))},Wm.prototype.drawImpl=function(){var d;for(d in{_42:!0})break;return function(){var N=this,W=N._canvas,j=N.gv,k=j.getWidth(),$=j.getHeight(),S=N._context,A=s.Default.getInternal(),Q=Y.devicePixelRatio;(W.width!==k||W.height!==$)&&A.setCanvas(W,k,$,Q),S.clearRect(0,0,W.width,W.height);var D=N._getValidSelection();
S.save(),S.scale(Q,Q),N._gridGuide._42(),N.invokeSubModuleInverse(d,!1,S,j,D),N._rectGuide._42(),N._hoverGuide._42(),S.restore()}}(),Wm.prototype._getValidSelection=function(){var u=this,x=u.gv,U=x.sm().getSelection(),Q=[];return U.each(function(y){x.isVisible(y)&&x.isEditable(y)&&Q.push(y)}),Q},Wm.prototype.handle_touchmove=function(m){return this.handle_mousemove(m)},Wm.prototype.handle_mousemove=function(N){if(!s.Default.isDragging()){var A=this;if((A.editDetail||!Fg()&&!Tf(N))&&!A.gv._externalEditing)if(A.gvEditing=!1,A._checkEdit(N))A.gvEditing=!0;else{if(!A.getStyle("hoverGuideVisible"))return;A.hoverData=A.gv.getDataAt(N),A._42()}}},Wm.prototype.handle_touchstart=function(b){return this.handle_mousedown(b)},Wm.prototype.handle_mousedown=function(r){mc(r);var k=this;if((k.editDetail||!Fg()&&!Tf(r))&&!k.gv._externalEditing){if(Ir(r)&&!r.clickThrough){if(k.editDetail){if(k._tryQuitEditDetailMode(r))return}else if(k._tryEnterEditDetailMode())return;k.gv.dm().beginTransaction();var F=k.invokeSubModule("handleDoubleClick",!0,r);if(k.gv.dm().endTransaction(),F)return}var c=k._checkEdit(r);c&&(k._downPosition=k._getLogicalPoint(r),k.gv.dm().beginTransaction(),c.startEdit(k,r),k.editing=!0)}},Wm.prototype._checkEdit=function(H){var W=this,k=W.gv,g=W._getLogicalPoint(H),F=W.invokeSubModule("check",!0,k,H,g)||null;return W._editMod=F,F},Wm.prototype.handleWindowTouchMove=function(G){return this.handleWindowMouseMove(G)},Wm.prototype.handleWindowMouseMove=function(Q){var U=this,N=U._downPosition;if(N){var D=U._getLogicalPoint(Q);if(D.distanceTo(N)<U.getStyle("moveSensitivity"))return;delete U._downPosition}var $=U._editMod;$&&$.handleEdit(U.gv,Q)},Wm.prototype._getLogicalPoint=function(N){var t=this,F=s.Default.getLogicalPoint(N,t._canvas);return new Ph.Math.Vector2(F)},Wm.prototype.handleWindowTouchEnd=function(y){return this.handleWindowMouseUp(y)},Wm.prototype.handleWindowMouseUp=function(){var k;for(k in{_46O:!0})break;return function(M){var W=this;W.editing=!1,W.setCursor("default"),W.invokeSubModule(k,!1,M),W._42(),W.gv.dm().endTransaction()}}(),Wm.prototype.handle_mousewheel=function(Q){var Z=this;mc(Q),Z.invokeSubModule("preHandleScroll",!0)||Z.gv.handleScroll(Q,Q.wheelDelta)},Wm.prototype.handleDelete=function(){var T=this;if(!T.editDetail){T.gv.dm().beginTransaction();var s=T.invokeSubModule("handleNormalStateDelete",!0);return T.gv.dm().endTransaction(),s||T.gv.removeSelection(),void 0}T.gv.dm().beginTransaction(),T.invokeSubModule("handleDelete",!0),T.gv.dm().endTransaction(),T._42()},Wm.prototype.handle_keydown=function(k){var j=this;if((k.metaKey||k.ctrlKey)&&j._42(),Fg(k)&&!j.editing)return j.gvEditing=!1,j.setCursor("default"),j._42(),void 0;var i=sk(k);return j.editDetail?((i||bo(k))&&(j.editDetail=!1,j._42()),j.gv.dm().beginTransaction(),j.invokeSubModule("handle_keydown",!0,k),j.gv.dm().endTransaction(),void 0):(j.gv.dm().beginTransaction(),j.invokeSubModule("handleNormalStateKeyDown",!0,k),j.gv.dm().endTransaction(),i&&j._tryEnterEditDetailMode(),void 0)},Wm.prototype.handle_keyup=function(b){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,b),this.gv.dm().endTransaction()},Wm.prototype._tryEnterEditDetailMode=function(){var k=this;return!k.editDetail&&k.invokeSubModule("canEnterEditDetailMode",!0)&&1===k._getValidSelection().length?(k.editDetail=!0,k._42(),!0):void 0},Wm.prototype._tryQuitEditDetailMode=function(S){var q=this;return q.editDetail?!S||q.invokeSubModule("canQuitEditDetailMode",!0,S)?(q.editDetail=!1,q._42(),!0):!1:!1},Wm.prototype.setStyle=function(U,T,E){var m=this;E?Ph.setStyle(U,T):m._styleMap[U]=T,"baseColor"===U&&(xk=T),m.fp("styleChanged",null,{key:U,value:T,base:E}),m._42()},Wm.prototype.getStyle=function(J){var X=this,s=X._styleMap[J];return s!==r?s:Ph.getStyle(J)},Wm.prototype.setCursor=function(Z){this._resetCustomCursorStyle(),s.graph.EditInteractor.superClass.setCursor.call(this,Z)},Wm.prototype._drawHostGuide=function(e){var D=this,v=D._context,u=D.gv;Ph.Icons.DrawIcon(D,v,Ph.Icons.NodeHoverGuide,e.corners);var U=e.host;if(U){var B=u.getAttachPoints(U);if(B&&B.length)for(var W=0,C=B.length;C>W;W++){var H=B[W],c=fo(u,U,0,H.offsetX||0,H.offsetY||0,H.x,H.y);c=Ph.toScreenPosition(u,c),c.isAttach=e.attach===W,Ph.Icons.DrawIcon(D,v,Ph.Icons.AttachPoint,c)}}},Wm.prototype._resetCustomCursorStyle=function(){var Z=this;if(Z._customStyle){var I=this.gv.getView();I.classList&&I.classList.remove&&I.classList.remove(Z._customStyle),Z._customStyle=null}},Wm.prototype._setRotateCursor=function(X){var t=this,J=t._cursorFactory;J||(J=t._cursorFactory=new Ph.CursorFactory(t));var W=J.getRotateCursor(X),q=t.gv.getView();t._resetCustomCursorStyle(),t._customStyle=W,q.classList&&q.classList.add&&q.classList.add(W)};var Zr=Ph.Group=function(G){var Y=this;Y._entities=G,Y._64O=0,Y._position={x:0,y:0},Y._scale={x:1,y:1},Y._anchor={x:.5,y:.5},Y._anchor2={x:.5,y:.5}};Zr.prototype={},Zr.prototype.constructor=Zr;var Se=null;Zr.findOrCreateGroup=function(k){if(Se&&Se.checkIsMe(k))return Se;var o=new Ph.Group(k);return o.getKeyOb()?(Se=o,o):void 0},Zr.prototype.checkIsMe=function(X){var q=this._entities;if(q.length!==X.length)return!1;var N,h={},b=X.length;for(N=0;b>N;N++)h[X[N]._id]=!0;for(N=0;b>N;N++)if(!h[q[N]._id])return!1;return!0},Zr.prototype.getRotation=function(){return this._64O},Zr.prototype.getPosition=function(){return this._position},Zr.prototype.getAnchor=function(){return this._anchor},Zr.prototype.getWidth=function(){return this._width},Zr.prototype.getScale=function(){return this._scale},Zr.prototype.getSize=function(){return{width:this._width,height:this._height}},Zr.prototype.getHeight=function(){return this._height},Zr.prototype.getKeyOb=function(){for(var d=this._entities,e=d.length-1;e>=0;e--){var v=d[e];if(this.isNode(v))return v}},Zr.prototype.getAnchor2=function(){var x=this,S=x.rotateCenter;if(S)return S;var T=x.getKeyOb();if(!T)return x._anchor;var C=x._anchor2,H=T.getMatrix();return H.tf({x:T.getWidth()*(C.x-T.getAnchor().x),y:T.getHeight()*(C.y-T.getAnchor().y)})},Zr.prototype.setAnchor2=function(F,k){var f=this,D=f.getKeyOb();if(D){var p,X=D.getMatrix();p="number"==typeof F?{x:F,y:k}:F;var g=X.tfi(p);f._anchor2={x:D.getAnchor().x+g.x/D.getWidth(),y:D.getAnchor().y+g.y/D.getHeight()}}},Zr.prototype.setRotation=function(){},Zr.prototype.beginRotate=function(O){this.rotateCenter=O.pos,this.rotateMode=O.groupRotateMode},Zr.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Zr.prototype.addRotation=function(z,W,a){return"batch"===W?this._addRotationInBatchMode(z,a):"block"===W?this._addRotationInBlockMode(z,a):void 0},Zr.prototype._addRotationInBlockMode=function(P,V){var F=this,o=F.rotateCenter||F.getPosition();F._entities.forEach(function(M){if(F.isNode(M)&&(!V||V(M))){var x=M.getMatrix();x.translate(-o.x,-o.y),x.rotate(P),x.translate(o.x,o.y);var J=Math.sign(M.getScale().x);M.setRotation(K(x.b*J,x.a*J)),M.setPosition(x.tx,x.ty)}})},Zr.prototype._addRotationInBatchMode=function(p,o){var H=this,q=H._anchor2;H._entities.forEach(function(R){if(H.isNode(R)&&(!o||o(R))){var f=R.getAnchor(),z=R.getMatrix(),s=z.tf({x:R.getWidth()*(q.x-f.x),y:R.getHeight()*(q.y-f.y)}),n=new Ph.Math.Matrix2d;n.set(z.a,z.b,z.c,z.d,z.tx,z.ty),n.translate(-s.x,-s.y),n.rotate(p),n.translate(s.x,s.y);var Q=Math.sign(R.getScale().x);R.setRotation(K(n.b*Q,n.a*Q)),R.setPosition(n.tx,n.ty)}})},Zr.prototype.setPosition=function(p){var x,g,m,Q,k=this,w=k._position,h=p.x-w.x,l=p.y-w.y,e=k._entities;for(g=0,m=e.length;m>g;g++)x=e[g],Km(x)&&(Q=x.getPosition(),x.setPosition(Q.x+h,Q.y+l));k._position=p},Zr.prototype.setScale=function(Y,_){var K=this,d=Y/K._scale.x,b=_/K._scale.y;K._adjustChildScaleOrSize(d,b,"size"),K._scale={x:Y,y:_}},Zr.prototype.getRect=function(){var I=this,S=I._position,U=I._width,V=I._height;return{x:S.x-U/2,y:S.y-V/2,width:U,height:V}},Zr.prototype.setSize=function(T,C){var K=this,T=Math.max(1,T),C=Math.max(1,C),f=T/K._width,h=C/K._height;K._adjustChildScaleOrSize(f,h,"size"),K._width=T,K._height=C},Zr.prototype._adjustChildScaleOrSize=function(Y,x,b){var z,X,J,k,s,e,S,A,$,V,r,I,B,t,g=this,T=g._position,d=g._entities,U=new Ph.Math.Matrix2d;for(X=0,J=d.length;J>X;X++)if(z=d[X],g.isNode(z)){if(k=z.getPosition(),s=z.getRotation(),e=z.getWidth(),S=z.getHeight(),A=z.getScale(),r=A.x*e,I=A.y*S,U.identity().scale(r,I).rotate(s).translate(k.x,k.y).translate(-T.x,-T.y).rotate(-g._64O),s=K(U.b*Math.sign(r),U.a*Math.sign(r)),U.scale(Y,x),$=Math.cos(s),V=Math.sin(s),Math.abs($)<.001?(B=U.b/V,t=-U.c/V):(B=U.a/$,t=U.d/$),"scale"===b)z.setScale(B/e,t/S);else if("size"===b){var Q=B/A.x,i=t/A.y;z.setScale(Mh(B)*Math.abs(A.x),Mh(t)*Math.abs(A.y)),z.setSize(Math.max(.1,Math.abs(Q)),Math.max(.1,Math.abs(i)))}U.rotate(g._64O).translate(T.x,T.y),z.setPosition(U.tx,U.ty)}},Zr.prototype.getMatrix=function(){var E=this,P=E._position,u=s.Default.getInternal(),W=E._scale;return new u.Mat(E._64O,P.x,P.y,W.x,W.y)},Zr.prototype.toGlobal=function(r){return this.getMatrix().tf(r)},Zr.prototype.getCorners=function(){var S=this,T=S._width,e=S._height,n=S._anchor,H=-T*n.x,D=-e*n.y,w=S.getMatrix();return[w.tf(H,D),w.tf(H,D+e),w.tf(H+T,D+e),w.tf(H+T,D)]},Zr.prototype.calcInfo=function(){var L,C,o,P,X,n,O=this,I=[],B=O._entities,x=O._64O;for(P=0,X=B.length;X>P;P++)n=B[P],O.isNode(n)&&n.getCorners&&I.push.apply(I,n.getCorners());if(I.length){var E=Math.cos(-x),R=Math.sin(-x),q=1/0,Q=-1/0,H=1/0,F=-1/0;for(P=0,X=I.length;X>P;P++)o=I[P],L=o.x,C=o.y,o.x=E*L-R*C,o.y=R*L+E*C,q=Math.min(q,o.x),Q=Math.max(Q,o.x),H=Math.min(H,o.y),F=Math.max(F,o.y);O._width=(Q-q)/O._scale.x,O._height=(F-H)/O._scale.y,E=Math.cos(x),R=Math.sin(x);var k=O._anchor;L=q+(Q-q)*k.x,C=H+(F-H)*k.y,O._position={x:E*L-R*C,y:R*L+E*C}}},Zr.prototype.isNode=function(f){return Km(f)?Oi(f)?f.size()?!1:!0:!0:!1},Zr.prototype._42=function(U,M,t){var s,H,h,F,N,D,I,R,f=this,O=f._entities,e=f.rotateMode;for("batch"===e&&(R=f.getKeyOb()),s=0,H=O.length;H>s;s++)h=O[s],f.isNode(h)&&(D=h.getRect(),F=Ph.toScreenPosition(t,{x:D.x,y:D.y}),N=Ph.toScreenPosition(t,{x:D.x+D.width,y:D.y+D.height}),I={min:F,max:N},h===R&&(I.isKeyOb=!0),Ph.Icons.DrawIcon(U,M,Ph.Icons.GroupSubEntityRect,I))};var Xj=Ph.CurveActiving=function(J,K){this._curve=J,this._interactor=J._interactor,this.silent=!0;for(var S in K)this[S]=K[S];delete this.silent};Xj.prototype={},Xj.prototype.constructor=Xj,R.defineProperties(Xj.prototype,{point:{get:function(){return this._point},set:function(K){var T=this;T._point=K,T.editingCtrl||T.silent||T._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(L){var b=this;b._pairs=L,b.editingCtrl&&!b.silent&&b._firePointChange()}}}),Xj.prototype._firePointChange=function(){var N=this,I=N.getCurrentEditingPoint(),X=N._interactor;if(!I)return X.fi({kind:"selectPoint"}),void 0;var Y=this._curve.target;if(Y){var V=Ph.getDataMatrix(Y).invert(),f=I.e;I=V.apply(Ph.toWorldPosition(X.gv,I)),I.e=f;var w=N._lastFirePoint;w&&Math.abs(I.x-w.x)<1e-5&&Math.abs(I.y-w.y)<1e-5&&(I.e==r&&w.e==r||Math.abs(I.e-w.e)<1e-5)||(N._lastFirePoint=I,X.fi({kind:"selectPoint",x:I.x,y:I.y,e:I.e}))}},Xj.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Xj.prototype.getCurrentEditingPoint=function(){var u=this,T=u.editingCtrl;if(T){var I=u.pairs;if(I){var d=I[T.pairId];if(d){var r=d[T.type];if(r)return r}}}return u._point};var Yo=Ph.CursorFactory=function($){var D=this;D._interactor=$,D._rotateCursorStyles={}};Yo.prototype={},Yo.prototype.constructor=Yo,Yo.prototype.getRotateCursor=function(V){var C=this;0>V&&(V+=2*Math.PI);var t=C._interactor,n=t.getStyle("rotateCursorSize"),B=t.getStyle("rotateCursorRound"),y=Math.round(180*(V/Math.PI)/B);y*B>=360&&(y=0);var R=C._rotateCursorStyles,U="htCustomRotateStyle_"+n+"_"+B+"_"+y;return R[U]||(C._produceRotateCursor(U,n,B,y),R[U]=!0),U},Yo.prototype._produceRotateCursor=function(P,F,O,l){var E=this;E._interactor;var v=E._canvas;v||(v=E._canvas=A.createElement("canvas"));var m=Y.devicePixelRatio;v.width=v.height=F*m,v.style.width=v.style.height=F+" px";var L=v.getContext("2d");Ph.setAntialias(L,!1),L.scale(m,m);var C,D,N,n,o,K=Math.round(F/2),B=""+K+" "+K+",auto !important;",h=4;C=Math.PI/180*l*O,L.clearRect(0,0,F,F),L.save(),L.scale(F/32,F/32),L.translate(16,15),L.rotate(C+Math.PI/2),L.beginPath(),L.moveTo(-8,0),L.lineTo(-8,h),L.lineTo(-8+h,h),L.moveTo(8,0),L.lineTo(8,h),L.lineTo(8-h,h),L.moveTo(-8,h),L.quadraticCurveTo(0,-6,8,h),L.restore(),L.lineCap="round",L.lineJoin="miter",L.strokeStyle="white",L.lineWidth=4,L.stroke(),L.strokeStyle="black",L.lineWidth=2,L.stroke(),D=JSON.stringify(v.toDataURL()),n="cursor:url("+D+")"+B,1!==m&&(N='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+F+'px" height="'+F+'px"><image xlink:href='+D+' width="'+F+'" height="'+F+'"/></svg>',n+="cursor:url(data:image/svg+xml;base64,"+btoa(N)+")"+B,n+="cursor:-webkit-image-set(url("+D+")"+m+"x,url("+D+")1x)"+B),o=A.createElement("style"),o.textContent="body."+P+" *, ."+P+"{"+n+"}",A.head.appendChild(o)};var Df=Ph.Guide.Grid=function(d){var s=this;s._interactor=d,s._alignmentGuideId=0,s._xAlignmentGuide=[],s._yAlignmentGuide=[]};Df.prototype={},Df.prototype.constructor=Df,R.defineProperties(Df.prototype,{gridBlockSize:{get:function(){var v=this;return v._gridBlockSize||v._interactor.getStyle("gridBlockSize")},set:function(E){this._gridBlockSize=E,this._interactor._42()}},gridThickLinesEvery:{get:function(){var T=this;return T._gridThickLinesEvery||T._interactor.getStyle("gridThickLinesEvery")},set:function(e){this._gridThickLinesEvery=e,this._interactor._42()}},gridEnabled:{get:function(){var d=this,b=d._interactor;return b.gridEnabled&&d.isValidGrid()}}}),Df.prototype._42=function(){var $=this,e=$._interactor;$.gridEnabled&&$.drawGrid(),e.alignmentGuideEnabled&&$.drawAlignmentGuide()},Df.prototype.makeMatrix=function(){var q=this,Z=q._interactor.getStyle("gridAngle"),t=q._interactor.getStyle("gridRotation"),y=new Ph.Math.Matrix2d,D=Math.sin(Z),k=Math.cos(Z);return y.set(1,0,k,D,0,0),y.rotate(t),y},Df.prototype.isValidGrid=function(){var u=this,f=Math.PI,H=u._interactor,X=H.gv;if(X._zoom<H.getStyle("gridZoomThreshold"))return!1;var J=H.getStyle("gridAngle"),R=Math.abs(180*(J%f/f)),i=1-1e-8;return i>R||R>180-i?!1:!0},Df.prototype.drawAlignmentGuide=function(){var m=this,Z=m._interactor,n=Z.gv,q=Z._canvas,g=Z._context,z=q.width,I=q.height,r=n.tx(),$=n.ty(),Y=n._zoom;g.beginPath(),g.strokeStyle=Z.getStyle("gridAlignmentGuideColor"),g.lineWidth=1,m._xAlignmentGuide.forEach(function(y){var J=y.p*Y+r;g.moveTo(J,0),g.lineTo(J,I)}),m._yAlignmentGuide.forEach(function(M){var p=M.p*Y+$;g.moveTo(0,p),g.lineTo(z,p)}),g.stroke()},Df.prototype.drawGrid=function(){function y(Y,X,d,a){var g=Ph.toScreenPosition(j,p.apply({x:Y,y:X})),r=Ph.toScreenPosition(j,p.apply({x:d,y:a}));z.moveTo(g.x,g.y),z.lineTo(r.x,r.y)}var X=this,M=X._interactor,t=X.gridBlockSize,n=X.gridThickLinesEvery,e=M.getStyle("gridThickColor"),i=M.getStyle("gridLightColor"),j=M.gv,Y=M._canvas,z=M._context,g=Y.width,o=Y.height,p=X.makeMatrix(),m=p.applyInverse(Ph.toWorldPosition(j,{x:0,y:0})),R=p.applyInverse(Ph.toWorldPosition(j,{x:g,y:0})),I=p.applyInverse(Ph.toWorldPosition(j,{x:0,y:o})),u=p.applyInverse(Ph.toWorldPosition(j,{x:g,y:o})),d=Math.min(m.x,R.x,I.x,u.x),x=Math.max(m.x,R.x,I.x,u.x),U=Math.min(m.y,R.y,I.y,u.y),s=Math.max(m.y,R.y,I.y,u.y);g=x-d,o=s-U;var A=Math.ceil(d/t),N=Math.floor(x/t),F=Math.ceil(U/t),J=Math.floor(s/t);j.tx(),j.ty(),j._zoom;var Z,C,P;for(z.save(),z.lineWidth=1,z.beginPath(),z.strokeStyle=e,P=Math.ceil(A/n)*n;N>=P;P+=n)Z=P*t,y(Z,U,Z,s);for(P=Math.ceil(F/n)*n;J>=P;P+=n)C=P*t,y(d,C,x,C);for(z.stroke(),z.beginPath(),z.strokeStyle=i,P=A;N>=P;P++)0!==P%n&&(Z=P*t,y(Z,U,Z,s));for(P=F;J>=P;P++)0!==P%n&&(C=P*t,y(d,C,x,C));z.stroke(),z.restore()},Df.prototype.getAlignmentGuides=function(){var G=this;return{x:G._xAlignmentGuide,y:G._yAlignmentGuide}},Df.prototype.addAlignmentGuide=function(p,F,m){var G=this,C="x"===p?G._xAlignmentGuide:G._yAlignmentGuide,m=m?m:++G._alignmentGuideId,M={p:F,id:m};if(C.length){var P=G._findClosestAlignmentGuide(M.p,C);P.dis<0?C.splice(P.index+1,0,M):C.splice(P.index,0,M)}else C.push(M);return G._interactor._42(),m},Df.prototype.findClosest=function(R,Q,C){var X=this,z=X._interactor,U=z.gv;C&&(R=Ph.toWorldPosition(U,R));var x,Y,k,P=1/0,e=1/0,g=R.x,q=R.y;if(X.gridEnabled){var G=X.gridBlockSize,L=X.makeMatrix(),W=L.applyInverse(R);W=L.apply({x:Math.round(W.x/G)*G,y:Math.round(W.y/G)*G}),P=W.x-g,e=W.y-q,k=!0}if(z.alignmentGuideEnabled&&(x=X._findClosestAlignmentGuide(g,X._xAlignmentGuide).dis,Y=X._findClosestAlignmentGuide(q,X._yAlignmentGuide).dis,Math.abs(x)<Math.abs(P)&&(P=x,k=!0),Math.abs(Y)<Math.abs(e)&&(e=Y,k=!0)),k){k=!1;var D=U._zoom,Z=z.getStyle("smartGuideThreshold")/D,B={};if(Math.abs(P)<Z&&"y"!==Q&&(B.x=C?P*D:P,k=!0),Math.abs(e)<Z&&"x"!==Q&&(B.y=C?e*D:e,k=!0),k)return B}},Df.prototype._findClosestAlignmentGuide=function(T,f){if(!f.length)return{dis:1/0};for(var Z,x=0,e=f.length-1;e-x>1;)Z=Math.floor((x+e)/2),f[Z].p<T?x=Z:e=Z;var R=f[x].p-T,Y=f[e].p-T;return Math.abs(R)<=Math.abs(Y)?{line:f[x],dis:R,index:x}:{line:f[e],dis:Y,index:e}},Df.prototype.removeAllAlignmentGuide=function(R){var J=this;"y"!==R&&(J._xAlignmentGuide=[]),"x"!==R&&(J._yAlignmentGuide=[]),J._interactor._42()},Df.prototype.removeAlignmentGuide=function(j){for(var m,E,C,N=this,s=N._xAlignmentGuide,X=0;2>X;X++)for(s=0===X?N._xAlignmentGuide:N._yAlignmentGuide,m=0,E=s.length;E>m;m++)if(C=s[m],C.id===j)return s.splice(m,1),N._interactor._42(),{axis:0===X?"x":"y",position:C.p};return!1},Df.prototype.adjustAlignmentGuide=function(m,D){var J=this,V=J.removeAlignmentGuide(m);return V?(J.addAlignmentGuide(V.axis,D,m),!0):!1};var ys=Ph.Guide.Rect=function(T){var d=this;d._interactor=T};ys.prototype={},ys.prototype.constructor=ys,ys.prototype.gatherRects=function(){var L,U,I,R,S=this,r=S._interactor.gv,O=[],s=[],E={x:O,y:s},Q={},x=r.getDataModel(),g=x.a("width"),W=x.a("height");g&&W&&(L=0,U=0,I=g,R=W,O.push({node:x,type:0,p:L},{node:x,type:1,p:L+I/2},{node:x,type:2,p:L+I}),s.push({node:x,type:0,p:U},{node:x,type:1,p:U+R/2},{node:x,type:2,p:U+R}),Q[x._id||0]={x:L,y:U,width:I,height:R}),x.each(function(K){if(Km(K)&&!r.isSelected(K)&&r.isVisible(K)&&r.isValidGuideLineSource(K)){var j=!1;if(r.sm().getSelection().each(function(Q){j||(K.isHostOn(Q)?j=!0:K.isDescendantOf(Q)&&(j=!0))}),!j){var D=K.getRect();L=D.x,U=D.y,I=D.width,R=D.height,O.push({node:K,type:0,p:L},{node:K,type:1,p:L+I/2},{node:K,type:2,p:L+I}),s.push({node:K,type:0,p:U},{node:K,type:1,p:U+R/2},{node:K,type:2,p:U+R}),Q[K._id]=D}}}),O.sort(function(n,N){return n.p-N.p}),s.sort(function(a,s){return a.p-s.p}),S._grid=E,S._87I=Q},ys.prototype.gatherLines=function(g,V,j){var p,H,M,G,y,r,D,N,W,E,m,Q,T=this,q=[T.findClosest({x:g.x,y:g.y},V),T.findClosest({x:g.x+g.w/2,y:g.y+g.h/2},V),T.findClosest({x:g.x+g.w,y:g.y+g.h},V)],k={},C=T._87I;j=j||255;var i,X;for(T._guideLine=[],p=0;2>p;p++)for(k={},0===p?(G="y",N=g.x,W=N+g.w):(G="x",N=g.y,W=N+g.h),H=0;3>H;H++)y=q[H],y&&isFinite(y[G])&&(i=1<<3*p+H,j&i&&(r=y[G+"Line"],D=r.node,X=D._id||0,k[X]||(k[X]=!0,Q=C[X],"y"===G?(E=Q.x,m=Q.x+Q.width):(E=Q.y,m=Q.y+Q.height),M=r.p,T._guideLine.push({type:G,a:N,b:W,c:E,d:m,p:M,center:1===r.type}))))},ys.prototype._binarySearchClosest=function(d,u){if(!u.length)return{dis:1/0};for(var L,U=0,y=u.length-1;y-U>1;)L=Math.floor((U+y)/2),u[L].p<d?U=L:y=L;var I=u[U].p-d,l=u[y].p-d;return Math.abs(I)<=Math.abs(l)?{line:u[U],dis:I}:{line:u[y],dis:l}},ys.prototype.findClosest=function(F,L,g){var J=this,f=J._interactor,a=f.gv,v=J._grid;g&&(F=Ph.toWorldPosition(a,F));var u,E=J._binarySearchClosest(F.x,v.x),V=J._binarySearchClosest(F.y,v.y),h=E.dis,$=V.dis,r=a._zoom,_=f.getStyle("smartGuideThreshold")/r,t={};return Math.abs(h)<_&&"y"!==L&&(t.x=g?h*r:h,t.xLine=E.line,u=!0),Math.abs($)<_&&"x"!==L&&(t.y=g?$*r:$,t.yLine=V.line,u=!0),u?t:void 0},ys.prototype._42=function(){var T=this,J=T._guideLine;if(J&&!s.Default.isCtrlDown()){var X=T._interactor;if(X.getStyle("guideLineVisible")){var w,x,O,D,d,I,l,P,R,a,S,L,p,f,q,A,B,g=X.gv,$=X._context,F=g.tx(),j=g.ty(),i=g._zoom,k=X.getStyle("guideLineTextSpacing");for(w=0,x=J.length;x>w;w++)O=J[w],P=O.type,R=O.p,a=O.a,S=O.b,L=O.c,p=O.d,f=Math.min(a,L),q=Math.max(S,p),"x"===P?(D=R*i+F,d=f*i+j,I=D,l=q*i+j):(D=f*i+F,d=R*i+j,I=q*i+F,l=d),Ph.Icons.DrawIcon(X,$,Ph.Icons.MoveLineGuide,{rect:[D,d,I,l],center:O.center}),p>=a&&S>=L||(f=a>p?p:S,q=a>p?a:L,B=q-f,"x"===P?(O.center2center||(D-=k,I=D),d=f*i+j,l=q*i+j,A=Ph.Icons.MoveLineGuideDistanceV):"y"===P&&(O.center2center||(d-=k,l=d),D=f*i+F,I=q*i+F,A=Ph.Icons.MoveLineGuideDistanceH),Ph.Icons.DrawIcon(X,$,A,{x0:D,y0:d,x1:I,y1:l,dis:B}))}}},ys.prototype.clear=function(){this._guideLine=null};var Hd=Ph.Guide.Hover=function(y){var G=this;G._interactor=y};Hd.prototype={},Hd.prototype.constructor=Hd,R.defineProperties(Hd.prototype,{}),Hd.prototype._42=function(){var g=this._interactor;if(g.getStyle("hoverGuideVisible")&&!g.gvEditing){var X=g.hoverData,J=g.gv;if(!Km(X)||J.isSelected(X))return g.hoverData=null,void 0;var t=Zl(J,X),q=Ph.toScreenPosition(J,{x:t.x,y:t.y}),o=Ph.toScreenPosition(J,{x:t.x+t.width,y:t.y+t.height});Ph.Icons.DrawIcon(g,g._context,Ph.Icons.HoverDataRect,{min:q,max:o,color:g.getStyle("hoverGuideColor")||g.getStyle("baseColor")})}},Ph.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Vn=Ph.Icons={},pp=1e4,js=null,xk=Ph.DefaultStyleMap.baseColor,Kb="rgb(183,232,135)",Ar="rgb(255,204,153)",wm=6;s.Default.setImage("Icons.RectPoint",{width:wm,height:wm,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return xk}},rect:[0,0,wm,wm]}]}),Vn.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var f=Vn.GroupSubEntityRect.data;if(!f)return[];var C=f.min,m=f.max;return[C.x,C.y,C.x,m.y,m.x,m.y,m.x,C.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Vn.GroupSubEntityRect.data.isKeyOb?xk:xk}}}]};var cl=4;Vn.HoverDataRect={comps:[{type:"shape",points:{func:function(){var i=Vn.HoverDataRect.data;if(!i)return[];var w=i.min,x=i.max,A=cl;return w.x-=A,w.y-=A,x.x+=A,x.y+=A,[w.x,w.y,w.x,x.y,x.x,x.y,x.x,w.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Vn.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Vn.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Vn.Line.data.P1.x,Vn.Line.data.P1.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Vn.Line.data.P2.x,Vn.Line.data.P2.y],wm,wm]}}}]},Vn.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Vn.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Vn.Rect={comps:[{type:"shape",points:{func:function(){var W=Vn.Rect.data;if(!W)return[];var B=W.LT,b=W.LB,L=W.RB,H=W.RT;return[B.x,B.y,b.x,b.y,L.x,L.y,H.x,H.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return xk}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},rect:{func:function(){return[[Vn.Rect.data.LT.x,Vn.Rect.data.LT.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},rect:{func:function(){return[[Vn.Rect.data.LB.x,Vn.Rect.data.LB.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},rect:{func:function(){return[[Vn.Rect.data.RB.x,Vn.Rect.data.RB.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},rect:{func:function(){return[[Vn.Rect.data.RT.x,Vn.Rect.data.RT.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},visible:{func:function(){return Vn.Rect.data.L?!0:!1}},rect:{func:function(){return[[Vn.Rect.data.L.x,Vn.Rect.data.L.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},visible:{func:function(){return Vn.Rect.data.R?!0:!1}},rect:{func:function(){return[[Vn.Rect.data.R.x,Vn.Rect.data.R.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},visible:{func:function(){return Vn.Rect.data.T?!0:!1}},rect:{func:function(){return[[Vn.Rect.data.T.x,Vn.Rect.data.T.y],wm,wm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vn.Rect.data.rotation}},visible:{func:function(){return Vn.Rect.data.B?!0:!1}},rect:{func:function(){return[[Vn.Rect.data.B.x,Vn.Rect.data.B.y],wm,wm]}}}]};var Uf=16;s.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return xk}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return xk}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Vn.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Vn.Anchor.data.POS.x,Vn.Anchor.data.POS.y],Uf,Uf]}}}]},Vn.TipShiftX=12,Vn.TipShiftY=12;var Pg=[8,28];Vn.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Vn.TipHelper.data.helperPos.x,Vn.TipHelper.data.helperPos.y,Pg[0]*Vn.TipHelper.data.size,Pg[1]]}},background:{func:function(){return js.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Vn.TipHelper.data.text}},rect:{func:function(){return[Vn.TipHelper.data.helperPos.x,Vn.TipHelper.data.helperPos.y,Pg[0]*Vn.TipHelper.data.size,Pg[1]]}},color:{func:function(){return js.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Kj=7;Vn.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Vn.ShapePoint.data.dynamicVisible}},rect:{func:function(){var I=Vn.ShapePoint.data.point,O=Vn.ShapePoint.data.size||Kj;return[I,O+10,O+10]}},background:{func:function(){var C=Date.now(),j=Vn.ShapePoint.data.dynamicPeriod||1500,v=Math.sin(C%j/j*Math.PI);return"rgba(27,124,22,"+.5*v+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var W=Vn.ShapePoint.data.point,s=Vn.ShapePoint.data.size||Kj;return[W,s,s]}},background:{func:function(){var F=Vn.ShapePoint.data.isEnd;return F?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Vn.ShapePoint.data.color||xk}}},{type:"rect",visible:{func:function(){return!!Vn.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return xk}},rect:{func:function(){var l=5;return[Vn.ShapePoint.data.point,l,l]}}}]},Vn.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Vn.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Vn.ShapeBgCurve.data.P}},segments:{func:function(){return Vn.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var v=Date.now(),R=Vn.ShapeBgCurve.data.dynamicPeriod||1500,B=Math.sin(v%R/R*Math.PI);return"rgba(27,124,22,"+.3*B+")"}}},{type:"shape",points:{func:function(){return Vn.ShapeBgCurve.data.P}},segments:{func:function(){return Vn.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Vn.ShapeBgCurve.data.color||xk}}}]};var Nh=8;Vn.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var x=Vn.ShapeHighlighPoint.data;return[[x.x,x.y],Nh,Nh]}},background:{func:function(){return js.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var mo=10;Vn.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var v=Vn.ShapeHighlighRealPoint.data;return[[v.x,v.y],mo,mo]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return xk}}}]};var Lj=8;Vn.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var F=Vn.ShapeHighlighCtrlPoint.data,K=F.x,B=F.y,_=Lj/2;return[K-_,B-_,K-_,B+_,K+_,B+_,K+_,B-_]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return js.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return js.getStyle("shapeCtrlPointBorderColor")||xk}}}]};var gp=3;Vn.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Vn.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:gp,borderColor:{func:function(){return js.getStyle("curveHighlightColor")}}}]},Vn.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Vn.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Vn.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Vn.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Vn.MoveLineGuide.data.center?Kb:Ar}}}]};var jn=5;Vn.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var O=Vn.MoveLineGuideDistanceH.data,v=O.x0,f=O.y0;return[v,f-jn,v,f+jn]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ar},{type:"shape",points:{func:function(){var A=Vn.MoveLineGuideDistanceH.data,L=A.x1,j=A.y1;return[L,j-jn,L,j+jn]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ar},{type:"text",text:{func:function(){return Math.round(Vn.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var T=Vn.MoveLineGuideDistanceH.data;return[[(T.x0+T.x1)/2,T.y0-10],20,20]}},color:Ar,font:"12px Arial",align:"center"}]},Vn.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var V=Vn.MoveLineGuideDistanceV.data,X=V.x0,f=V.y0;return[X-jn,f,X+jn,f]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ar},{type:"shape",points:{func:function(){var $=Vn.MoveLineGuideDistanceV.data,m=$.x1,W=$.y1;return[m-jn,W,m+jn,W]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ar},{type:"text",text:{func:function(){return Math.round(Vn.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var b=Vn.MoveLineGuideDistanceV.data;return[[b.x0-10,(b.y0+b.y1)/2],20,20]}},color:Ar,font:"12px Arial",align:"center"}]},s.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Vn.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var y=Vn.EdgeElevationGuide.data,R=y.x,f=y.y,u=js.getStyle("curveElevationIntersectSize"),B=js.getStyle("curveElevationGuideShift");
return R+=B[0],f+=B[1],[R-u,f-u,2*u,2*u]}}}]},s.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),s.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Vn.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Vn.ConnectGuide.data.rotation}},rect:{func:function(){var y=Vn.ConnectGuide.data.connect;y.x,y.y;var S=js.getStyle("connectGuideIntersectSize");return[[y.x,y.y],2*S,2*S]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var O=Vn.ConnectGuide.data.cursorPos||Vn.ConnectGuide.data.connect,C=js.getStyle("connectGuideIntersectSize");return[[O.x,O.y],2*C-2,2*C-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var S=Vn.ConnectGuide.data.connect,q=Vn.ConnectGuide.data.cursorPos||S;return[S.x,S.y,S.x+.5*(q.x-S.x),S.y,q.x+.5*(S.x-q.x),q.y,q.x,q.y]}}}]},s.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),s.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Vn.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var q=Vn.ConnectGuideGarbage.data.hover;return q?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var L=Vn.ConnectGuideGarbage.data,l=js.getStyle("connectGuideGarbageIntersectsize");return L.hover&&(l+=5),[[L.x,L.y],2*l,2*l]}}}]};var ho=6;Vn.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Vn.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var j=Vn.ShapeActivingCtrl.data;return[j.point.x,j.point.y,j.c1.x,j.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return xk}}},{type:"shape",visible:{func:function(){return Vn.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var C=Vn.ShapeActivingCtrl.data;return[C.point.x,C.point.y,C.c2.x,C.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return xk}}},{type:"shape",visible:{func:function(){return Vn.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var n=Vn.ShapeActivingCtrl.data.c1,a=n.x,c=n.y,B=ho/2;return"c1"===Vn.ShapeActivingCtrl.data.hl&&(B+=.5),[a-B,c-B,a-B,c+B,a+B,c+B,a+B,c-B]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return js.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Vn.ShapeActivingCtrl.data.hl?js.getStyle("shapeCtrlPointHighlightBorder")||xk:js.getStyle("shapeCtrlPointBorderColor")||xk}}},{type:"shape",visible:{func:function(){return Vn.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var Q=Vn.ShapeActivingCtrl.data.c2,n=Q.x,l=Q.y,X=ho/2;return"c2"===Vn.ShapeActivingCtrl.data.hl&&(X+=.5),[n-X,l-X,n-X,l+X,n+X,l+X,n+X,l-X]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return js.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Vn.ShapeActivingCtrl.data.hl?js.getStyle("shapeCtrlPointHighlightBorder")||xk:js.getStyle("shapeCtrlPointBorderColor")||xk}}}]},Vn.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return xk}},rect:{func:function(){return[[Vn.RoundPoint.data.x,Vn.RoundPoint.data.y],wm,wm]}}}]},Vn.AttachPoint={comps:[{type:"rect",background:{func:function(){return Vn.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return xk}},rect:{func:function(){var U=Vn.AttachPoint.data.isAttach?wm+4:wm;return[[Vn.AttachPoint.data.x,Vn.AttachPoint.data.y],U,U]}}}]},Vn.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Vn.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Vn.SimpleRect.data.color||xk}},rect:{func:function(){var c=Vn.SimpleRect.data;return[c.x,c.y,c.width,c.height]}}}]},s.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Vn.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var D=Vn.MoveDummy.data;return[[D.pos.x,D.pos.y],2*D.size,2*D.size]}}}]},Ph.Icons.DrawIcon=function(c,H,d,t){d.width=d.height=pp,d.data=t,js=c,s.Default.drawImage(H,d,0,0,pp,pp)},Ph.Icons.MapPoints=function(I,z){for(var Y=0,y=I.length;y>Y;Y++)I[Y]/=z},Ph.roundTo=function(d,E,k){var O=Math.abs(d%E);return k>O||k>E-O?E*Math.round(d/E):d},Ph.toFixed=function(D){return Math.round(100*D)/100},Ph.getDataMatrix=function(L){if(L instanceof s.Shape){var Y=new s.Math.Matrix2d,b=L.getPosition();return Y.translate(-b.x,-b.y).scale(L.getScale().x,L.getScale().y).rotate(L.getRotation()).translate(b.x,b.y),Y}return L.getMatrix?L.getMatrix():new s.Math.Matrix2d};var zd=Ph.Math.Curve=function(){this._curves=[]};zd.prototype={},zd.prototype.constructor=zd,zd.prototype.createFromHtShape=function(l,y,V){y instanceof s.List&&(y=y.toArray());var i,K,j,S,a,$,G,Z=this,L=null,x=null,Q=0,p=Ph.Math.Vector2,M=Ph.Math.CubicBezier,w=function(H){return new p(l[H],l[H+1],V?V[H/2]:r)};for(K=0,j=y.length;j>K;K++){switch(S=y[K],a=null,S){case 1:x=w(Q),L=x,Q+=2;break;case 2:i=w(Q),Q+=2,a=new M(x,x.clone(),i.clone(),i),x=i;break;case 3:$=w(Q),i=w(Q+2),Q+=4,a=new M(x,$.clone().sub(x).multiplyScalar(2/3).add(x),$.clone().sub(i).multiplyScalar(2/3).add(i),i),x=i;break;case 4:$=w(Q),G=w(Q+2),i=w(Q+4),Q+=6,a=new M(x,$,G,i),x=i;break;case 5:if(!L)break;a=new M(x,x.clone(),L.clone(),L),x=null,L=null}a&&(a._index=Z._curves.length,Z._curves.push(a))}},zd.prototype.checkPoint=function(b,G){var O,d,n,i,j,u=this,Q=u._curves;for(O=0,d=Q.length;d>O;O++)if(i=Q[O],j=i.intersectRect(b,G,G),j.length)return n=0,j.forEach(function(J){n+=J.t}),n/=j.length,b=i.getPointAt(n),b.t=n,{bezier:i,intersection:b}},zd.prototype.insertKnot=function(G,E){var i=G.insertKnot(E),n=this,V=n._curves;V.splice(G._index,1,i[0],i[1])},zd.prototype._isCloseEnough=function(y,L){return Math.abs(y.x-L.x)<1e-6&&Math.abs(y.y-L.y)<1e-6},zd.prototype._isSamePoint=function(H,g){return H===g},zd.prototype.moveRealPoint=function(i,a){var n=this,c=n._curves,P=a.clone().sub(i);c.forEach(function(O){var f=O._p1;O._p2,O._p3;var S=O._p4;n._isSamePoint(f,i)&&(O._p2.add(P),O._p1=a),n._isSamePoint(S,i)&&(O._p3.add(P),O._p4=a)})},zd.prototype.moveCtrlDueToRealPointMovement=function(F,X){var m=this,v=m._curves,x=function(D){D.add(X),D.e&&X.e&&(D.e+=X.e)};v.forEach(function(j){var W=j._p1;j._p2,j._p3;var A=j._p4;m._isSamePoint(W,F)&&x(j._p2),m._isSamePoint(A,F)&&x(j._p3)})},zd.prototype.moveCtrlPoint=function(i,t,L){var m=i[L];if(m){m.e!==r&&(t.e=m.e);var j=this,K=j._curves;t.clone().sub(m),K.forEach(function(G){var o;"c2"===L?o="_p2":"c1"===L&&(o="_p3"),j._isSamePoint(G[o],m)&&(G[o]=t)}),i[L]=t}},zd.prototype.deleteRealPoint=function(A,z){var N,l,d,$,g,P,G,O=this,E=O._curves,F={},f=[],_=Ph.Math.CubicBezier;for(l=0,d=E.length;d>l;l++)N=E[l],$=N._p1,g=N._p2,P=N._p3,G=N._p4,(F[l]||!O._isSamePoint($,A))&&(O._isSamePoint(G,A)?d>l+1&&O._isSamePoint(E[l+1]._p1,A)&&(z||f.push(new _($,g,E[l+1]._p3,E[l+1]._p4))):f.push(N));O._curves=f},zd.prototype.findPairs=function(u,g){var Z,Y,q,b,h,s,v,P,i=this,T=i._curves,c={},a=[];for(Y=0,q=T.length;q>Y;Y++)Z=T[Y],b=Z._p1,h=Z._p2,s=Z._p3,v=Z._p4,!c[Y]&&i._isSamePoint(b,u)&&(g?a.push({point:b,r2:v}):a.push({point:b,c2:h})),i._isSamePoint(v,u)&&(P=g?{point:v,r1:b}:{point:v,c1:s},q>Y+1&&i._isSamePoint(T[Y+1]._p1,u)&&(g?P.r2=T[Y+1]._p4:P.c2=T[Y+1]._p2,c[Y+1]=!0),a.push(P));return a},zd.prototype.toHtShape=function(){var $=this,F=$._curves,c=[],D=[],w={x:1/0,y:1/0};return F.forEach(function(J){var Q=J._p1,o=J._p2,L=J._p3,g=J._p4;return $._isCloseEnough(Q,w)||(c.push(1),D.push(Q.clone())),w=g,$._isCloseEnough(Q,o)&&$._isCloseEnough(L,g)?(c.push(2),D.push(g.clone()),void 0):(c.push(4),D.push(o.clone(),L.clone(),g.clone()),void 0)}),{segments:c,points:D}};var Nm=Ph.Math.CubicBezier=function(U,d,b,s){var k=this;k._id=Ph.Math.CubicBezier._globalId++,k._p1=U,k._p2=d,k._p3=b,k._p4=s};Nm._globalId=1,Nm.prototype={},Nm.prototype.constructor=Nm,Nm.prototype.toString=function(){return this._id},Nm.prototype.intersectRect=function(T,y,l){var m=y/2,Y=l/2,z=T.x,E=T.y,B=Ph.Math.Vector2,r=new B(-m+z,-Y+E),M=new B(m+z,Y+E),J=new B(M.x,r.y),O=new B(r.x,M.y),A=this,p=A.intersectLine(r,J),e=A.intersectLine(J,M),P=A.intersectLine(M,O),k=A.intersectLine(O,r),x=p.concat(e).concat(P).concat(k);return x},Nm.prototype.intersectLine=function(E,F){var c,P,M,A,S,o,H,x,t,u,Q,f,R,Z=this,n=E.clone().min(F),w=E.clone().max(F);A=Z._p1,S=Z._p2,o=Z._p3,H=Z._p4,c=A.clone().multiplyScalar(-1),P=S.clone().multiplyScalar(3),M=o.clone().multiplyScalar(-3),Q=c.add(P).add(M).add(H),c=A.clone().multiplyScalar(3),P=S.clone().multiplyScalar(-6),M=o.clone().multiplyScalar(3),u=c.add(P).add(M),c=A.clone().multiplyScalar(-3),P=S.clone().multiplyScalar(3),t=c.add(P),x=A.clone(),R=new Ph.Math.Vector2(E.y-F.y,F.x-E.x),f=E.x*F.y-F.x*E.y;for(var i=Z.getRoots(R.dot(Q),R.dot(u),R.dot(t),R.dot(x)+f),V=new Array,r=0,W=i.length;W>r;r++){var j=i[r];if(!(0>j||j>1)){var J=Z.getPointAt(j);J.t=j,E.x==F.x?n.y<=J.y&&J.y<=w.y&&V.push(J):E.y==F.y?n.x<=J.x&&J.x<=w.x&&V.push(J):J.x>=n.x&&J.y>=n.y&&J.x<=w.x&&J.y<=w.y&&V.push(J)}}return V},Nm.prototype.solveTForPoint=function(W){var s,D,C,g,Z=this;s=Z._p1.x-W.x,D=Z._p2.x-W.x,C=Z._p3.x-W.x,g=Z._p4.x-W.x;for(var V=Z.getRoots(g-3*C+3*D-s,3*C-6*D+3*s,3*D-3*s,s),X=r,M=1/0,E=0,S=V.length;S>E;E++){var h=V[E];if(!(0>h||h>1)){var m=Z.getPointAt(h);m.t=h;var n=Math.abs(m.y-W.y);M>n&&(M=n,X=m)}}return X},Nm.prototype.getPointAt=function(Y){var f=this,U=f._p1,h=f._p2,S=f._p3,n=f._p4,i=U.clone().lerp(h,Y),E=h.clone().lerp(S,Y),A=S.clone().lerp(n,Y),x=i.lerp(E,Y),m=E.lerp(A,Y);return x.lerp(m,Y)},Nm.prototype.getPointByPercentage=function(h){var v=this.length*h,k=this._cacheLength,o=k.length;if(0===v)return k[0].point;if(h>=1)return k[o-1].point;for(var R=0;o>R;R++){var I=k[R];if(!(I.len<v)){var e=k[R-1];return I.point.clone().sub(e.point).setLength(v-e.len).add(e.point)}}},Nm.prototype.getTByPercentage=function(p){var d=this.length*p,M=this._cacheLength,s=M.length;if(0===d||0>=p)return M[0].t;if(p>=1)return M[s-1].t;for(var J=0;s>J;J++){var V=M[J];if(!(V.len<d)){var T=M[J-1];return(d-T.len)/(V.len-T.len)*(V.t-T.t)+T.t}}},Nm.prototype.getRoots=function(O,W,C,J){var r,A,Z,T,D,o=new Array;if(Math.abs(O)<1e-6){var r=W,A=C/r,Z=J/r,T=A*A-4*Z;if(T>0){var D=Math.sqrt(T);o.push(.5*(-A+D)),o.push(.5*(-A-D))}else 0==T&&o.push(.5*-A)}W/=O,C/=O,J/=O,r=(3*C-W*W)/3,A=(2*W*W*W-9*C*W+27*J)/27;var b=W/3,B=A*A/4+r*r*r/27,x=A/2;if(Math.abs(B)<=1e-6&&(B=0),B>0){var Y,j,D=Math.sqrt(B);Y=-x+D,j=Y>=0?Math.pow(Y,1/3):-Math.pow(-Y,1/3),Y=-x-D,Y>=0?j+=Math.pow(Y,1/3):j-=Math.pow(-Y,1/3),o.push(j-b)}else if(0>B){var E=Math.sqrt(-r/3),V=Math.atan2(Math.sqrt(-B),-x)/3,H=Math.cos(V),i=Math.sin(V),t=Math.sqrt(3);o.push(2*E*H-b),o.push(-E*(H+t*i)-b),o.push(-E*(H-t*i)-b)}else{var Y;Y=x>=0?-Math.pow(x,1/3):Math.pow(-x,1/3),o.push(2*Y-b),o.push(-Y-b)}return o},Nm.prototype._70I=function(){var D=this;return D._p1.distanceToSquared(D._p2)<1e-10&&D._p3.distanceToSquared(D._p4)<1e-10},Nm.prototype.insertKnot=function(W){var C=this,n=C._p1,G=C._p2,E=C._p3,R=C._p4,F=n.clone().lerp(G,W),U=G.clone().lerp(E,W),l=E.clone().lerp(R,W),O=F.clone().lerp(U,W),e=U.clone().lerp(l,W),A=O.clone().lerp(e,W);return C._70I()?(n.clone().lerp(R,W),[new Ph.Math.CubicBezier(n,n.clone(),A.clone(),A),new Ph.Math.CubicBezier(A,A.clone(),R.clone(),R)]):[new Ph.Math.CubicBezier(n,F,O,A),new Ph.Math.CubicBezier(A,e,l,R)]},R.defineProperties(Nm.prototype,{length:{get:function(){var y=this._cacheLength;if(!y){y=this._cacheLength=[];for(var W=this._p1,c=0,B=0;1>=c;){var V=this.getPointAt(c+=.001);B+=V.clone().sub(W).length(),W=V,y.push({len:B,t:c,point:V.clone()})}}return y[y.length-1].len}},p1:{get:function(){return this._p1},set:function(g){this._p1=g,this._cacheLength=r}},p2:{get:function(){return this._p2},set:function(W){this._p2=W,this._cacheLength=r}},p3:{get:function(){return this._p3},set:function(K){this._p3=K,this._cacheLength=r}},p4:{get:function(){return this._p4},set:function(Y){this._p4=Y,this._cacheLength=r}}});var Xf=s.Default.getInternal().ui().EdgeUI,Gp={_47O:function(I){var z=this,o=Gp.getBackups()._47O;Ph.inEdit(z.gv)||o.call(z,I)}};Ph.Inject.registAsModule(Gp,Xf);var $k=s.Default.getInternal().ui().NodeUI,op={_47O:function(q){var f=this,J=op.getBackups()._47O;Ph.inEdit(f.gv)||J.call(f,q)},getSelectWidth:function(){var q=this,h=q.gv,B=q._data;if(h.isEditable(B)&&Ph.inEdit(h))return 0;var o=op.getBackup("getSelectWidth");return o.call(q)}};Ph.Inject.registAsModule(op,$k);var bl=s.graph.GraphView,Fe={_editPointSize:function(){var $=s.Default.isTouchable,D=Ph.getStyle("pointSize");return D[$?0:1]}(),isPointEditable:function(R){var Z=this;if(Ph.inEdit(Z))return Z._pointEditableFunc?Z._pointEditableFunc(R):!0;var A=Fe.getBackup("isPointEditable");A.call(Z,R)},isEditable:function(u){var G,F=this,i=Fe.getBackup("isEditable");if(G=u instanceof Ph.Group?!0:i.call(F,u),!Ph.inEdit(F))return G;if(!(u instanceof s.Edge))return G;if(!u.s("2d.editable"))return!1;var $=F.getEditableFunc();return $?$(u):!0},_42:function(A,k){var d=this,I=Fe.getBackups()._42;if(I.call(d,A,k),Ph.inEdit(d)){var b=d.getEditInteractor();b.drawImpl()}}};Ph.Inject.registAsModule(Fe,bl);var $i=s.Default.getInternal().ui().ShapeUI,lr={_47O:function(l){var I=this,X=lr.getBackups()._47O;Ph.inEdit(I.gv)||X.call(I,l)}};Ph.Inject.registAsModule(lr,$i);var Gf=s.graph.DefaultInteractor,xr={handle_mousewheel:function(c){var j=this,K=xr.getBackup("handle_mousewheel");Ph.inEdit(j.gv)||K.call(j,c)}};Ph.Inject.registAsModule(xr,Gf);var Cf=s.graph.MoveInteractor,hq={_calcShift:function(L,u){var N=this,Z=hq.getBackup("_calcShift"),y=N.gv;if(!Ph.inEdit(y))return Z.call(N,L,u);var h=y.getEditInteractor(),k=h.getSubModule("Move").calcShift(L,u,N);return k||Z.call(N,L,u)},clear:function(Y){var Q=this,A=hq.getBackup("clear");A.call(Q,Y);var e=Q.gv;if(Ph.inEdit(e)){var D=e.getEditInteractor();D.getSubModule("Move").clear(Y)}}};Ph.Inject.registAsModule(hq,Cf);var ys=Ph.Rect=function(Z){this.catalog="Rect",this._interactor=Z};ys.prototype={},ys.prototype.constructor=ys,ys.prototype.gatherInfo=function(c,J){var k=this;if(1===J.length){var g=J[0];return g instanceof s.Shape&&g._70I()?k.gatherLine(c,g):Oi(g,c)?!1:k.gatherSingleTarget(c,g)}return J.length>1?k.gatherMultiTargets(c,J):!1},ys.prototype.gatherSingleTarget=function(x,O){if(O.getCorners){var L,K=this,T=K.info;K.target=O,L=K.screenInfo={};var S=O.getCorners();T.LT=new Ph.Math.Vector2(S[0]),T.LB=new Ph.Math.Vector2(S[1]),T.RB=new Ph.Math.Vector2(S[2]),T.RT=new Ph.Math.Vector2(S[3]),T.T=T.LT.clone().add(T.RT).divideScalar(2),T.B=T.LB.clone().add(T.RB).divideScalar(2),T.L=T.LT.clone().add(T.LB).divideScalar(2),T.R=T.RT.clone().add(T.RB).divideScalar(2);for(var R in T)L[R]=Ph.toScreenPosition(x,T[R]);var A=K._interactor,f=A.getStyle("checkSize"),$=function(b,m,H){var O=m.clone().sub(b).setLength(-f),k=H.clone().sub(b).setLength(-f),M=O.add(k).add(b);return M};return L.rotLT=$(L.LT,L.RT,L.LB),L.rotLB=$(L.LB,L.LT,L.RB),L.rotRB=$(L.RB,L.LB,L.RT),L.rotRT=$(L.RT,L.LT,L.RB),L.rotT=L.rotLT.clone().add(L.rotRT).divideScalar(2),L.rotB=L.rotLB.clone().add(L.rotRB).divideScalar(2),L.rotL=L.rotLT.clone().add(L.rotLB).divideScalar(2),L.rotR=L.rotRT.clone().add(L.rotRB).divideScalar(2),L.rotation=O.getRotation(),K.gatherConnectInfo(),!0}},ys.prototype.gatherConnectInfo=function(){var j=this,z=j.target,g=j._interactor,h=j.screenInfo,b=g.gv;if(b.isConnectActionVisible(z)&&g.getStyle("connectGuideVisible")){var o;z.s&&(o=z.s("connectGuideShift")),o||(o=g.getStyle("connectGuideShift"));var d=z.getAnchor(),q=z.getSize(),Z=z.toGlobal({x:q.width*(o[0]-d.x),y:q.height*(o[1]-d.y)});Z=Ph.toScreenPosition(b,Z),h.P1?Z.add(h.P2.clone().sub(h.P1).setLength(o[2])):(Z.add(h.RT.clone().sub(h.LT).setLength(o[2])),Z.add(h.LB.clone().sub(h.LT).setLength(o[3]))),h.connect=Z}},ys.prototype.gatherMultiTargets=function(P,Z){var u=Ph.Group.findOrCreateGroup(Z);if(!u)return!1;var x=this;return x.editing&&"rotate"!==x.editing.mode||u.calcInfo(),x.gatherSingleTarget(P,u)},ys.prototype.gatherLine=function(q,c){this.target=c;var g=this.screenInfo={},M=c.getPoints(),t=Ph.getDataMatrix(c);return g.P1=Ph.toScreenPosition(q,t.apply(M.get(0))),g.P2=Ph.toScreenPosition(q,t.apply(M.get(1))),this.gatherConnectInfo(),!0},ys.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ys.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ys.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ys.prototype.check=function(r,k,g){if(s.Default.isLeftButton(k)){var D=this;if(D.editing=null,D.tipInfo=null,D.screenInfo){var N=D.target,J=r.isEditable(N),n=D.screenInfo;if(J&&n.connect){var f=D._checkConnect(g);if(f)return f}if(n.P1)return D._checkLine(g);var H,d,S,l=null,h=D._interactor,L=h.getStyle("checkSize");if(J&&r.isRectEditable(N))for(d=0;d<Ph.Rect.ResizeKeys.length;d++)if(S=Ph.Rect.ResizeKeys[d],Ph.checkHit(g,n[S],L)){l=S,H="resize";break}if(!l&&J&&r.isRotationEditable(N)&&!h.getStyle("rotateAsClock")){var u=h.getStyle("rotateCheckSize");for(d=0;d<Ph.Rect.RotateKeys.length;d++)if(S=Ph.Rect.RotateKeys[d],Ph.checkHit(g,n[S],u)){l=S,H="rotate";break}}if(!l)return h.setCursor("default"),void 0;if("rotate"===H){var A,Y=r.lp(k);if(N instanceof Ph.Group){var o=h.getStyle("groupRotateModeKey");"string"==typeof o&&(o=[o]);for(var i=!1,_=0,O=o.length;O>_;_++)if(k[o[_]]){i=!0;break}var c=h.getStyle("groupRotateModeDefault");A=i?"batch"===c?"block":"batch":c}var T="batch"===A?N.getAnchor2():N.getPosition(),b=Math.atan2(Y.y-T.y,Y.x-T.x);h._setRotateCursor(b),D.editing={mode:H,key:l,pos:T,flipY:N.getScale().y<0,rotation:N.getRotation(),hitRot:b},A&&(D.editing.groupRotateMode=A)}else{var W=Ph.Rect.ResizeKeys.indexOf(l),v=Ph.Rect.ResizeDirection[W],p=Math.cos(N.getRotation()),Q=Math.sin(N.getRotation()),q=v.x*Math.sign(N.getScale().x),V=v.y*Math.sign(N.getScale().y),x=Math.atan2(-Q*q-p*V,p*q-Q*V),e=(Math.round(x/(Math.PI/4))+8)%8,a=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][e];this._interactor.setCursor(a);var B=N.getWidth(),G=N.getHeight(),I=N.getAnchor();D.editing={mode:H,key:l,rect:{x:-B*I.x,y:-G*I.y,width:B,height:G},anchor:I,matrix:N.getMatrix()}}return l}}},ys.prototype._checkLine=function(E){var X=this;X.screenInfo;var Q,c=X._interactor.getStyle("checkSize");if(Ph.checkHit(E,X.screenInfo.P1,c))Q="P1";else{if(!Ph.checkHit(E,X.screenInfo.P2,c))return this._interactor.setCursor("default"),void 0;Q="P2"}return X.editing={mode:"line",key:Q},Q},ys.prototype._checkConnect=function(B){var E=this,k=E.screenInfo,P=E._interactor,L=P.getStyle("connectGuideIntersectSize"),S=k.connect,A=B.x,K=S.x;if(K>A&&L>K-A&&Math.abs(S.y-B.y)<L||A>=K&&Ph.checkHit(B,S,L)){var q="connect",H=Y.getConnectAction(P.gv);if(E.editing={mode:q},H&&H.delete)if(E.target instanceof Ph.Group){var W=!0;P.gv.sm().getSelection().each(function(r){H.delete.visible.call(null,P.gv,r)||(W=!1)}),E.editing.hasDeleteAction=W}else H.delete.visible.call(null,P.gv,E.target)&&(E.editing.hasDeleteAction=!0);return P.setCursor("default"),q}},ys.prototype._fireEditEvent=function(s,M){var y=this._interactor,d=this.editing;if(d){var p=d.mode;p="rotate"===p?"Rotation":"connect"===p?"Connection":"resize"===p?"Rect":p[0].toUpperCase()+p.slice(1),y.fi({kind:s+"Edit"+p,event:M})}},ys.prototype.startEdit=function(M,E){M.startDragging(E);var x=this;x._interactor.fi({kind:"prepareEdit",event:E});var X=x.editing,B=x.target;if(X){if(x._fireEditEvent("begin",E),"rotate"===X.mode)return X.groupRotateMode&&B.beginRotate(X),void 0;if("connect"!==X.mode)("line"===X.mode||B&&0===B.getRotation())&&(x._inSmartGuide=!0,x._interactor.rectGuide.gatherRects());else if(X.hasDeleteAction){var s=M.gv,w=x._interactor.getStyle("connectGuideGarbageShift");X.garbageInfo={x:s.getWidth()*w[0]+w[2],y:s.getHeight()*w[1]+w[3],size:x._interactor.getStyle("connectGuideGarbageIntersectsize")},M._42()}}},ys.prototype._46O=function(H){var t,n,q=this,U=q.editing,D=q.target;if(U){if("connect"===U.mode&&!U.canceled&&!U.deleted)try{U.garbageInfo&&U.garbageInfo.hover?Y.doDeleteConnectionAction(q._interactor.gv,D):Y.doConnectAction(q._interactor.gv,D,U.target)}catch(G){console.error(G)}n=U.freezeFlag,t=q.editing.groupRotateMode,q._fireEditEvent("end",H),q.editing=null}q.tipInfo=null,q._inSmartGuide&&(q._interactor.rectGuide.clear(),q._inSmartGuide=!1),t&&D&&D.endRotate(),D instanceof s.Block&&(n===r?delete D._freezeSyncFromChildren:D._freezeSyncFromChildren=n,D.updateFromChildren())},ys.prototype.handleNormalStateDelete=function(){var u=this,g=u.editing;if(g&&"connect"===g.mode&&!g.canceled&&!g.deleted){if(g.garbageInfo){try{Y.doDeleteConnectionAction(u._interactor.gv,u.target)}catch(N){console.error(N)}g.garbageInfo=null}return g.cursorPos=null,g.targetCorners=null,g.deleted=!0,u._interactor._42(),!0}},ys.prototype.handleNormalStateKeyDown=function($){var W=this,t=W.editing;return!t||"connect"!==t.mode||t.canceled||t.deleted?void 0:s.Default.isEsc($)?(t.cursorPos=null,t.targetCorners=null,t.canceled=!0,W._interactor._42(),!0):void 0},ys.prototype.handleEdit=function(q,h){var U=this,J=U.editing;if(J){var E,I,V,D,y,k=U.target,l=J.key,x=J.mode,p=q.lp(h),b=U._interactor;if("connect"===x){if(J.canceled)return;if(J.deleted)return;J.cursorPos=b._getLogicalPoint(h);var r=J.garbageInfo;return r&&Ph.checkHit(J.cursorPos,r,r.size)?(r.hover=!0,J.target=null,J.targetCorners=null):(r&&(r.hover=!1),J.target=q.getDataAt(p,function(w){return q.isSelectable(w)?Km(w)?!0:!1:!1})||null,J.targetCorners=Ph.getTargetCornersOnScreen(q,J.target)),b._42(),void 0}if("rotate"===x){var g,z,o=J.pos,w=Math.atan2(p.y-o.y,p.x-o.x);if(J.groupRotateMode?z=w-J.hitRot:(g=w-J.hitRot,z=J.rotation+g),z%=2*Math.PI,0>z&&(z+=2*Math.PI),!s.Default.isCtrlDown(h)){var F,G;bg(h)?(F=b.getStyle("shiftRotateRound"),G=F/2):(F=b.getStyle("rotateRound"),G=b.getStyle("rotateSensitivity")),z=Ph.roundTo(z,F,G)}J.groupRotateMode?(g=z-(J.lastRotation||0),0!==g&&(k.addRotation(g,J.groupRotateMode,function(N){return q.isRotationEditable(N)}),J.lastRotation=z)):k.setRotation(z),b._setRotateCursor(w),z>Math.PI&&(z-=2*Math.PI);var i=180*(z/Math.PI);i=i.toFixed(2),E=""+i+""}else if("resize"===x){var Q=J.rect;V=Q.x,D=Q.y;var Z,u=Q.width,L=Q.height,T=J.anchor,$=J.matrix,v=k.s&&k.s("keepAspectRatio")||b.getStyle("keepAspectRatio");bg(h)&&(v=!v);var a=U._unionPointMode1,Y=U._unionPointMode2;if(U._inSmartGuide&&!s.Default.isCtrlDown(h)&&!v){var R;"L"===l||"R"===l?R="x":("T"===l||"B"===l)&&(R="y"),U._adsorbedToClosest(p,R),y=!0}Z=$.tfi(p);var X;"LT"===l?(Q=a(Z,{x:V+u,y:D+L},u,L,v),X=9):"T"===l?(Q=Y({x:V,y:Z.y},{x:V+u,y:D+L},u,L,v,"v"),X=1):"RT"===l?(Q=a(Z,{x:V,y:D+L},u,L,v),X=33):"L"===l?(Q=Y({x:Z.x,y:D},{x:V+u,y:D+L},u,L,v,"h"),X=8):"R"===l?(Q=Y({x:V,y:D},{x:Z.x,y:D+L},u,L,v,"h"),X=32):"LB"===l?(Q=a(Z,{x:V+u,y:D},u,L,v),X=12):"B"===l?(Q=Y({x:V,y:D},{x:V+u,y:Z.y},u,L,v,"v"),X=4):"RB"===l&&(Q=a(Z,{x:V,y:D},u,L,v),X=36);var K=$.tf(Q.x+Q.width*T.x,Q.y+Q.height*T.y);k instanceof s.Block&&(J.hasOwnProperty("freezeFlag")||(J.freezeFlag=k._freezeSyncFromChildren,k._freezeSyncFromChildren=!0)),k.setPosition(K),k.setSize(Q.width,Q.height),y&&(I=k.getRect(),b.rectGuide.gatherLines({node:k,x:I.x,y:I.y,w:I.width,h:I.height},R,X)),E=""+Math.round(Q.width)+" * "+Math.round(Q.height)}else if("line"===x){if(bg(h)){var B=k.getPoints(),S="P1"===l?B.get(1):B.get(0),A={x:p.x-S.x,y:p.y-S.y},t=b.getStyle("shiftLineRotateRound"),j=U._shiftDirList;if(!j||U._shiftRotateRound!==t){U._shiftRotateRound=t,U._shiftDirList=j=[];for(var M=0;M<Math.PI;M+=t)j.push({x:O(M),y:f(M)})}for(var d,_=0,N=0,e=j.length;e>N;N++){var P=j[N],m=P.x*A.x+P.y*A.y;Math.abs(m)>Math.abs(_)&&(_=m,d=P)}p={x:S.x+d.x*_,y:S.y+d.y*_},b.rectGuide.clear()}else U._inSmartGuide&&!s.Default.isCtrlDown(h)&&(U._adsorbedToClosest(p),y=!0);var C=Ph.getDataMatrix(k).applyInverse(p);k.setPoint("P1"===l?0:1,C,!0);var W=k.getPoints(),H=W.get(0),c=W.get(1);V=H.x-c.x,D=H.y-c.y,E=" "+Math.round(Math.sqrt(V*V+D*D))+" ",y&&(I=k.getRect(),b.rectGuide.gatherLines({node:k,x:I.x,y:I.y,w:I.width,h:I.height}))}if(E){var n=s.Default.getLogicalPoint(h,b._canvas);n.x+=Ph.Icons.TipShiftX,n.y+=Ph.Icons.TipShiftY,U.tipInfo={helperPos:n,text:E,size:E.length}}U._fireEditEvent("between",h)}},ys.prototype._unionPointMode1=function(p,g,h,q,e){if(e&&h&&q){var T=p.x-g.x,_=p.y-g.y;Math.abs(T*q)<Math.abs(_*h)?(_=Math.sign(_)*Math.abs(T*q/h),p.y=g.y+_):(T=Math.sign(T)*Math.abs(_*h/q),p.x=g.x+T)}return s.Default.unionPoint(p,g)},ys.prototype._unionPointMode2=function(z,R,K,I,g,i){var B=s.Default.unionPoint(z,R);if(g&&K&&I){var w;"v"===i?(w=B.x+B.width/2,B.width=K*B.height/I,B.x=w-B.width/2):(w=B.y+B.height/2,B.height=I*B.width/K,B.y=w-B.height/2)}return B},ys.prototype._adsorbedToClosest=function(x,e){var w=this,V=w._interactor,o=V.rectGuide.findClosest(x,e),j=V.gridGuide.findClosest(x,e),S=1/0,d=1/0;o&&(isFinite(o.x)&&(S=o.x),isFinite(o.y)&&(d=o.y)),j&&(isFinite(j.x)&&Math.abs(j.x)<Math.abs(S)&&(S=j.x),isFinite(j.y)&&Math.abs(j.y)<Math.abs(d)&&(d=j.y)),isFinite(S)&&(x.x+=S),isFinite(d)&&(x.y+=d)},ys.prototype._42=function(A,r,e){var Z=this;Z.info={},Z.screenInfo=null;var h=Z._interactor;if(!h.editDetail&&Z.gatherInfo(r,e)){var V=Z.editing,D=V?V.groupRotateMode:null,X=Z.screenInfo;if("block"!==D){if(X.P1?Ph.Icons.DrawIcon(h,A,Ph.Icons.Line,X):Ph.Icons.DrawIcon(h,A,Ph.Icons.Rect,X),X.connect&&(Ph.Icons.DrawIcon(h,A,Ph.Icons.ConnectGuide,{rotation:X.rotation,connect:X.connect,cursorPos:V?V.cursorPos:null}),V)){if(V.targetCorners){for(var C={x:1/0,y:1/0},z={x:-1/0,y:-1/0},m=0,W=V.targetCorners.length;W>m;m+=2)C.x=Math.min(C.x,V.targetCorners[m]),z.x=Math.max(z.x,V.targetCorners[m]),C.y=Math.min(C.y,V.targetCorners[m+1]),z.y=Math.max(z.y,V.targetCorners[m+1]);Ph.Icons.DrawIcon(h,A,Ph.Icons.HoverDataRect,{min:C,max:z,color:h.getStyle("hoverGuideColor")||h.getStyle("baseColor")})}V.garbageInfo&&Ph.Icons.DrawIcon(h,A,Ph.Icons.ConnectGuideGarbage,V.garbageInfo)}Z.tipInfo&&Ph.Icons.DrawIcon(h,A,Ph.Icons.TipHelper,Z.tipInfo)}Z.target instanceof Ph.Group&&Z.target._42(h,A,r)}};var En=Ph.Anchor=function(p){this.catalog="Anchor",this._interactor=p};En.prototype={},En.prototype.constructor=En,En.prototype.gatherInfo=function(w,e){var m=this;if(1===e.length){var j=e[0];if(!j.getAnchor)return;if(j instanceof s.Shape&&j._70I())return;if(Oi(j,w))return;return m.gatherSingleTarget(w,e[0])}return e.length>1?m.gatherMultiTargets(w,e):!1},En.prototype.gatherSingleTarget=function(h,R){var g=this;return g.info.POS=R.getPosition(),g.screenInfo.POS=Ph.toScreenPosition(h,g.info.POS),g.target=R,!0},En.prototype.gatherMultiTargets=function(M,Z){var W=this,U=Ph.Group.findOrCreateGroup(Z);return U?(W.screenInfo.POS=Ph.toScreenPosition(M,U.getAnchor2()),W.target=U,!0):!1},En.prototype.isVisible=function(){var U=this,G=U._interactor;if(G.getStyle("anchorVisible")===!1)return!1;var W=U.target;if(W){if(this.editing)return!0;var f=W.getAnchor(),s=G.getStyle("anchorOutsideVisibleThreshold");if(f.x<-s||f.x>1+s||f.y<-s||f.y>1+s)return!0;var P=W.getSize(),y=W.getScale(),b=Math.min(Math.abs(P.width*y.x),Math.abs(P.height*y.y));
if(b*G.gv._zoom<G.getStyle("anchorHideThreshold"))return!1}return!0},En.prototype.check=function(C,i,R){if(s.Default.isLeftButton(i)){var g=this,t=g._interactor;if(g.isVisible()&&t.getStyle("anchorMovable")!==!1){g.editing=null,g.tipInfo=null;var P=g.target;if(P&&C.isAnchorEditable(P)&&C.isEditable(P)){var k;if(g.screenInfo&&(k=g.screenInfo.POS)&&Ph.checkHit(R,new Ph.Math.Vector2(k),t.getStyle("checkSize"))){if(P instanceof Ph.Group)return g.editing={},!0;var H=P.getWidth(),F=P.getHeight(),U=P.getAnchor();return g.editing={rect:{x:-H*U.x,y:-F*U.y,width:H,height:F},anchor:U,matrix:P.getMatrix()},!0}}}}},En.prototype.startEdit=function(U,e){U.startDragging(e),U.fi({kind:"beginEditAnchor",event:e})},En.prototype._46O=function(v){var P=this;P.editing&&(P.editing=null,P._interactor.fi({kind:"endEditAnchor",event:v})),P.tipInfo=null},En.prototype.handleEdit=function(y,E){var o=this,p=o.target;if(p){var e=o.editing;if(e){var b=y.lp(E),Z=o._interactor;if(p instanceof Ph.Group)return p.setAnchor2(b),Z._42(),void 0;var z=e.matrix,c=z.tfi(b),n=e.rect,K=(c.x-n.x)/n.width,_=(c.y-n.y)/n.height;if(!s.Default.isCtrlDown(E)){var F=Z.getStyle("anchorRound"),T=Z.getStyle("anchorSensitivity");K=Ph.roundTo(K,F,T),_=Ph.roundTo(_,F,T)}p.setAnchor(K,_,!0);var q=s.Default.getLogicalPoint(E,Z._canvas);q.x+=Ph.Icons.TipShiftX,q.y+=Ph.Icons.TipShiftY;var j=""+K.toFixed(2)+", "+_.toFixed(2);o.tipInfo={helperPos:q,text:j,size:j.length},Z.fi({kind:"betweenEditAnchor",event:E})}}},En.prototype._42=function(D,B,I){var d=this;d.info={},d.screenInfo={};var f=d._interactor;f.editDetail||d.gatherInfo(B,I)&&d.isVisible()&&(Ph.Icons.DrawIcon(f,D,Ph.Icons.Anchor,d.screenInfo),d.tipInfo&&Ph.Icons.DrawIcon(f,D,Ph.Icons.TipHelper,d.tipInfo))};var Oh=Ph.MoveDummy=function(y){this.catalog="MoveDummy",this._interactor=y};Oh.prototype={},Oh.prototype.constructor=Oh,Oh.prototype.gatherInfo=function(){var E=this,C=this._interactor.getSubModule("Rect");if(C){var L=C.screenInfo;if(L){var O=E._interactor,T=E.getMovableTarget(C.target);if(T){var t=O.getStyle("moveDummyThreshold");if(t!==!1){var F=L.LT||L.P1,d=L.RT||L.P2,W=L.LB||F;if(F){var l=L.P1,R=Math.min(F.distanceTo(W),F.distanceTo(d));if(!(t!==!0&&R>t)){var o=O.getStyle("moveDummyPosition"),m=d.clone().sub(F),N=W.clone().sub(F),A=o[2],H=o[3];if(l){var j=O.getStyle("moveDummyLineExtraShift");j&&(A+=j[0],H+=j[1])}var c=F.clone().add(m.clone().multiplyScalar(o[0])).add(m.setLength(A)).add(N.clone().multiplyScalar(o[1])).add(N.setLength(H));return E.screenInfo.pos=c,E.screenInfo.size=O.getStyle("moveDummySensitivity"),!0}}}}}}},Oh.prototype.getMovableTarget=function($){var g=this._interactor.gv;if(Km($)){if(g.isMovable($))return $}else if($ instanceof Ph.Group)for(var l=$._entities,Q=l.length-1;Q>=0;Q--){var W=l[Q];if(Km(W)&&g.isMovable(W))return W}return null},Oh.prototype.getMoveInteractor=function(){for(var N,d,o,e=this._interactor.gv,p=e.getInteractors(),N=0,d=p.length;d>N;N++)if(o=p.get(N),o instanceof Cf)return o},Oh.prototype.startEdit=function(g,c){g.startDragging(c);var J=this.getMoveInteractor();if(J){var y=this.selectedTarget,k=g.gv;k._moving=1,J._data=y,k.handleMouseDown&&k.handleMouseDown(c,y)}},Oh.prototype._46O=function(j){var I=this,A=I.getMoveInteractor();A&&(A.handleWindowMouseUp(j),I.selectedTarget=null)},Oh.prototype.handleEdit=function(p,j){var q=this.getMoveInteractor();q&&q.handleWindowMouseMove(j)},Oh.prototype.check=function(K,d,G){if(this.selectedTarget=null,s.Default.isLeftButton(d)&&!K._scrolling&&!Fg()){var f=this;if(f.screenInfo){var b=f.screenInfo.pos;if(b&&!(G.distanceTo(b)>f.screenInfo.size)){var O=f._interactor;return f.selectedTarget=f.getMovableTarget(O.getSubModule("Rect").target),O.setCursor("default"),!0}}}},Oh.prototype._42=function($,j,J){var c=this;c.screenInfo={};var o=c._interactor;o.editDetail||c.gatherInfo(j,J)&&(!o.editing||c.selectedTarget)&&Ph.Icons.DrawIcon(o,$,Ph.Icons.MoveDummy,c.screenInfo)};var qp=Ph.RotateX=function(g){this.catalog="RotateX",this._interactor=g};qp.prototype={},qp.prototype.constructor=qp,qp.prototype.gatherInfo=function(u,G){var e=this;if(1===G.length){var M=G[0];return M instanceof s.Shape&&M._70I()||Oi(M,u)?!1:e.gatherSingleTarget(u,M)}return G.length>1?e.gatherMultiTargets(u,G):!1},qp.prototype.gatherSingleTarget=function(){var T=new s.Math.Vector2,r=new s.Math.Vector2,D=new s.Math.Vector2,o=new s.Math.Vector2,K=function(v,e){var q=v.x-e.x,n=v.y-e.y;return q*q+n*n};return function(l,q){if(q.getCorners){var S=this,J=q.getCorners(),x=15,j=q.getPosition();T.copy(J[0]),D.copy(J[1]),o.copy(J[3]),r.copy(T).add(o).divideScalar(2).add(T.sub(D).setLength(x/l.getZoom()));var O=Math.max(K(j,J[0]),K(j,J[1]),K(j,J[2]),K(j,J[3]));return S.info.POS=r.clone(),S.screenInfo.POS=Ph.toScreenPosition(l,S.info.POS),S.screenInfo.LEN=Math.sqrt(O)*l.getZoom()+x,S.screenInfo.CENTER=Ph.toScreenPosition(l,j),S.target=q,!0}}}(),qp.prototype.gatherMultiTargets=function(Z,Q){var B=this,D=Ph.Group.findOrCreateGroup(Q);if(!D)return!1;var B=this;return B.gatherSingleTarget(Z,D)},qp.prototype.isVisible=function(){var G=this._interactor;if(!G.getStyle("rotateAsClock"))return!1;var K=this.target;if(!K)return!0;var h=G.gv;return h.isEditable(K)&&h.isRotationEditable(K)?!0:!1},qp.prototype.check=function(b,B,L){var $=this,n=$._checkImpl(b,B,L);return(n||$._clockPainted)&&$._interactor._42(),n},qp.prototype._checkImpl=function(G,i,H){if(s.Default.isLeftButton(i)){var f=this;f.editing=null,f.tipInfo=null;var R;if(f.screenInfo&&(R=f.screenInfo.POS)&&f.isVisible()){var j=f._interactor;if(Ph.checkHit(H,R,j.getStyle("checkSize"))){var X=f.target,I=G.lp(i),D=X.getPosition(),B=Math.atan2(I.y-D.y,I.x-D.x);return j._setRotateCursor(B),f.editing={pos:D,rotation:X.getRotation(),hitRot:B,groupRotateMode:"block",screenInfo:{CENTER:f.screenInfo.CENTER,LEN:f.screenInfo.LEN}},!0}}}},qp.prototype.startEdit=function(j,J){j.startDragging(J),j.fi({kind:"beginEditRotation",event:J}),this.target instanceof Ph.Group&&this.target.beginRotate(this.editing)},qp.prototype._46O=function(M){var O=this;O.editing&&(O.editing=null,O._interactor.fi({kind:"endEditRotation",event:M})),O.target instanceof Ph.Group&&O.target.endRotate(),O.tipInfo=null},qp.prototype.handleEdit=function(O,v){var K=this,i=K.editing;if(i){var g,J,h=K.target,q=O.lp(v),Q=K._interactor,u=i.pos,y=Math.atan2(q.y-u.y,q.x-u.x),V=h instanceof Ph.Group;if(V?J=y-i.hitRot:(g=y-i.hitRot,J=i.rotation+g),J%=2*Math.PI,0>J&&(J+=2*Math.PI),!s.Default.isCtrlDown(v)){var $,B;bg(v)?($=Q.getStyle("shiftRotateRound"),B=$/2):($=Q.getStyle("rotateRound"),B=Q.getStyle("rotateSensitivity")),J=Ph.roundTo(J,$,B)}V?(g=J-(i.lastRotation||0),0!==g&&(h.addRotation(g,i.groupRotateMode,function(H){return O.isRotationEditable(H)}),i.lastRotation=J)):h.setRotation(J),Q._setRotateCursor(y),J>Math.PI&&(J-=2*Math.PI);var U=180*(J/Math.PI),W=""+U.toFixed(2)+"",P=s.Default.getLogicalPoint(v,Q._canvas);P.x+=Ph.Icons.TipShiftX,P.y+=Ph.Icons.TipShiftY,K.tipInfo={helperPos:P,text:W,size:W.length},Q.fi({kind:"betweenEditRotation",event:v})}},qp.prototype._42=function(f,C,E){var c=this;c._clockPainted=!1,c.info={},c.screenInfo={};var I=c._interactor;I.editDetail||c.gatherInfo(C,E)&&c.isVisible()&&(Ph.Icons.DrawIcon(I,f,Ph.Icons.RoundPoint,c.screenInfo.POS),c.tipInfo&&Ph.Icons.DrawIcon(I,f,Ph.Icons.TipHelper,c.tipInfo),c.editing&&c.drawClock(f))},qp.prototype.drawClock=function(i){i.save();var I=this;I._clockPainted=!0;var m=I.editing||{},G=m.screenInfo||I.screenInfo,w=G.LEN,l=w+8,x=w+18;i.save(),i.translate(G.CENTER.x,G.CENTER.y),i.beginPath(),i.strokeStyle="rgb(150, 150, 150)";for(var g,Q,p,o,N,t=0;360>t;t++)g=t*Math.PI/180,0===t%5&&(Q=f(g)*w,p=O(g)*w,o=f(g)*l,N=O(g)*l,i.moveTo(Q,p),i.lineTo(o,N)),0===t%45&&(Q=f(g)*w,p=O(g)*w,o=f(g)*x,N=O(g)*x,i.moveTo(Q,p),i.lineTo(o,N));i.stroke(),i.rotate(-T);var J=m.lastRotation||I.target.getRotation();i.beginPath(),i.fillStyle="rgba(255, 0, 0, 0.1)",i.strokeStyle="rgb(157, 157, 157)",i.moveTo(0,0),i.arc(0,0,x,0,J,!1),i.fill(),i.beginPath(),i.moveTo(0+x,0),i.arc(0,0,x,0,J,!1),i.stroke(),i.restore()};var zd=Ph.Curve=function(J){this.catalog="Curve",this._interactor=J};zd.prototype={},zd.prototype.constructor=zd,R.defineProperties(zd.prototype,{activing:{get:function(){return this._activing},set:function(o){var R=this;if(o)R._activing=new Ph.CurveActiving(this,o),R._activing._firePointChange();else{var l=R._activing;l&&l.dispose(),R._activing=null}}}}),zd.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},zd.prototype.setUp=function(){var L=this,s=L._interactor;s&&s.gv.mp(L._onGraphviewPropertyChanged,L)},zd.prototype._onGraphviewPropertyChanged=function(z){("zoom"===z.property||"translateX"===z.property||"translateY"===z.property)&&this._handleDataChanged()},zd.prototype.tearDown=function(){var p=this,e=p._interactor;e&&e.gv.ump(p._onGraphviewPropertyChanged,p)},zd.prototype.canEnterEditDetailMode=function(){var m=this,X=m._interactor,_=X._getValidSelection();if(1===_.length){var W=_[0],d=W instanceof s.Edge;if(W instanceof s.Shape||d){if(d){var B=W.s("edge.type");if(B&&"points"!==B)return}var C=X.gv;if(C.isPointEditable(W)&&C.isEditable(W))return m.target=W,!0}}},zd.prototype.canQuitEditDetailMode=function(n){var d=this,h=d._interactor._getLogicalPoint(n);return d._checkEditRealPoint(h)?void 0:d._interactor.gv.getDataAt(n)!==d.target?!0:void 0},zd.prototype.preHandleScroll=function(){var O=this.editing;return O&&O.inEdit?!0:void 0},zd.prototype.getCurrentSelectintStatus=function(){var d=this;if(d.activing&&!d.activing.selections){if(d.activing.status!=r)return d.activing.status;var o=function(K){var $=d.activing.status;d.activing.status=K,d._interactor.fp("shapePointStatus",$,K)},m=Ph.Curve.PointType,R=d.activing.point,y=d.activing.pairs;if(!y||1!==y.length)return o(m.Mirrored);var e=y[0],P=e.c1&&e.c1.isNearEnough(R),F=e.c2&&e.c2.isNearEnough(R);if(!e.c1||!e.c2)return P||F?o(m.Straight):o(m.Disconnected);if(P&&F)return o(m.Straight);if(P||F)return o(m.Asymmetric);var b=e.c1.clone().sub(R),I=e.c2.clone().sub(R);return Math.abs(b.x*I.y-b.y*I.x)>1e-5||b.x*I.x>0?o(m.Disconnected):Math.abs(b.length()-I.length())>1e-5?o(m.Asymmetric):o(m.Mirrored)}},zd.prototype.handle_keydown=function(g){var o=this;if(o._interactor.editDetail){var y=Ph.Curve.PointType;"1"===g.key?o._setCurrentSelectionStatus(y.Straight):"2"===g.key?o._setCurrentSelectionStatus(y.Mirrored):"3"===g.key?o._setCurrentSelectionStatus(y.Disconnected):"4"===g.key&&o._setCurrentSelectionStatus(y.Asymmetric)}},zd.prototype.setCurrentSelectionStatus=function(N){var R=this,L=R._interactor;if(L){var j=L.gv;j.dm().beginTransaction(),this._setCurrentSelectionStatus(N),j.dm().endTransaction()}},zd.prototype._setCurrentSelectionStatus=function(y){var b=this,K=b.activing;if(K){var X=b.getCurrentSelectintStatus();if(null!==X&&X!==y){K.status=y;var $=b.activing.point,I=b.activing.pairs;if(I&&1===I.length){var B=I[0],t=b.screenInfo.curve,e=Ph.Curve.PointType,V=b._interactor,v=function(){b._writeToHt(),V.fp("shapePointStatus",X,y),b.check(V.gv,null,new Ph.Math.Vector2(V._lastLogicalPoint))};if(y===e.Straight)return t.moveCtrlPoint(B,$,"c1"),t.moveCtrlPoint(B,$,"c2"),v(),void 0;if(X===e.Straight){var c=t.findPairs($,!0),H=c[0],M=H.r1||$,l=H.r2||$,N=l.clone().sub(M).multiplyScalar(.25);return t.moveCtrlPoint(B,$.clone().sub(N),"c1"),t.moveCtrlPoint(B,$.clone().add(N),"c2"),v(),void 0}var s=B.c1,p=B.c2;if(s&&p){if(y===e.Mirrored)return t.moveCtrlPoint(B,$.clone().multiplyScalar(2).sub(p),"c1"),v(),void 0;if(y===e.Asymmetric&&X===e.Disconnected){var n=s.clone().sub($).length(),N=$.clone().sub(p).setLength(n).add($);return t.moveCtrlPoint(B,N,"c1"),v(),void 0}}K._firePointChange(),V.fp("shapePointStatus",X,y),b.check(V.gv,null,new Ph.Math.Vector2(V._lastLogicalPoint))}}}},zd.prototype._handleDataChanged=function(){var C="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(i){var B=this;if(B.screenInfo&&B.target){if(i&&C.indexOf(i.property)<0)return;var F=B._interactor;B.gatherSingleTarget(F.gv,B.target,!0),B.check(F.gv,null,new Ph.Math.Vector2(F._lastLogicalPoint)),F._42()}}}(),zd.prototype.gatherSingleTarget=function(E,$,c){var T,e,D=this;D.screenInfo&&D.screenInfo.curve&&(e=D.screenInfo.curve._curves);var b=D.editing;T=b?D.screenInfo:D.screenInfo={};var W,S,f=$ instanceof s.Edge;f?(W=$.s("edge.segments"),S=$.s("edge.points")||new s.List):(W=$._58O,S=$._59O),T.S=W;var Q,U=T.P=[],A=Ph.getDataMatrix($);if($ instanceof s.Polyline||$ instanceof s.Edge&&D._interactor.getStyle("edgeElevationEditable"))Q=$.getElevation&&$.getElevation()||0,T.E=[];else{var M=!1;S.each(function(s){s.e!==r&&(M=!0)}),M&&(T.E=[])}if(S.each(function(H){T.E&&T.E.push(H.e!=r?H.e:Q),H=A.apply(H);var d=Ph.toScreenPosition(E,H);U.push(d.x,d.y)}),f){var V=U.length,t=Ph.toScreenPosition(E,$._lastSourcePoint||(V?{x:U[0],y:U[1]}:{x:0,y:0})),Z=Ph.toScreenPosition(E,$._lastTargetPoint||(V?{x:U[V-2],y:U[V-1]}:{x:0,y:0}));U.splice(0,0,t.x,t.y),U.push(Z.x,Z.y),T.E&&(T.E.splice(0,0,"head"),T.E.push("tail"))}if(!T.S||!T.S.size()){T.S=new s.List,T.S.add(1);for(var P=0;P<U.length/2-1;P++)T.S.add(2)}if((!b||c)&&D.convertToCubicBezier(e),D.activing&&(c||!D.editing||"realPoint"===D.editing.type)){var G=T.curve.findPairs(D.activing.point);D.activing.pairs=G}},zd.prototype._convertToNewPoint=function(z,w,O,l){var y,i,L;for(y=0,i=w.length;i>y;y++){if(L=w[y],L._p1.isNearEnough(z)&&(!l||l.indexOf(L._p1)<0))return L._p1;if(L._p4.isNearEnough(z)&&(!l||l.indexOf(L._p4)<0))return L._p4}if(O)for(y=0,i=Math.min(O.length,i);i>y;y++){if(L=O[y],L._p1===z&&(!l||l.indexOf(w[y]._p1)<0))return w[y]._p1;if(L._p4===z&&(!l||l.indexOf(w[y]._p4)<0))return w[y]._p4}},zd.prototype.convertToCubicBezier=function(j){var L,w,d=this,C=new Ph.Math.Curve,Q=d.screenInfo;if(C.createFromHtShape(Q.P,Q.S,Q.E),Q.curve=C,d.activing){var s=C._curves;L=d.activing.point,w=d._convertToNewPoint(L,s,j);var O=[];if(w&&(d.activing.point=w,O.push(w)),d.activing.selections){var r=-1,G=d.activing.selections;G.forEach(function(B){r++,w=d._convertToNewPoint(B,s,j,O),w&&(G[r]=w,O.push(w))})}}},zd.prototype.check=function(d,g,o){if(!g||yf(g)||Tf(g)){var R=this;if(R._interactor.setCursor("default"),R.editing=null,R.highlight=null,R.tipInfo=null,R.edgeEditResult=null,R.screenInfo){if(Fg()||g&&Tf(g))return R._interactor._42(),!0;if(R._checkEditCtrlPoint(o))return R._interactor._42(),!0;if(R._checkEditRealPoint(o))return R._interactor._42(),!0;if(R._checkEditElevation(o))return R._interactor._42(),!0;var e=R.screenInfo.curve,p=e.checkPoint(o,R._interactor.getStyle("curveIntersectSize"));if(p){var s=R.highlight={};s.type="insertKnot",s.bezier=p.bezier,s.point=p.intersection}return R._interactor._42(),!0}}},zd.prototype.getAdjacentBeziers=function(B){var x=this.screenInfo;if(x){var a,G,H,T=x.curve._curves,$=[],U=r;for(a=0,G=T.length;G>a;a++)if(H=T[a],U===r){if(H._p4.isNearEnough(B)){$.push(H),U=a;continue}}else{if(H._p1.isNearEnough(B))return $.push(H),$;if(H._p4.isNearEnough(B)){$[0]=H,U=a;continue}}}},zd.prototype.roundCorner=function(D){if(this.activing&&this.screenInfo){var M=this.screenInfo.curve,T=M._curves,s=this.getAdjacentBeziers(this.activing.point),F=s[1],N=F._index;F=F.insertKnot(F.getTByPercentage(D/F.length))[1],T[N]=F;var q=F.p1,i=s[0],v=i._index;i=i.insertKnot(i.getTByPercentage(1-D/i.length))[0],T[v]=i;var f=i.p4,d=this.activing.point,h=new Ph.Math.CubicBezier(f,d.clone().sub(f).multiplyScalar(2/3).add(f),d.clone().sub(q).multiplyScalar(2/3).add(q),q);T.splice(N,0,h),this._writeToHt(),this.activing=null,this._interactor._42()}},zd.prototype._checkEditRealPoint=function(z){var A,H,f,j,U,Q,d=this,K=d.screenInfo.curve._curves,q=d._interactor.getStyle("curvePointIntersectSize"),u=1/0;for(q*=q,f=0,j=K.length;j>f;f++)A=K[f],U=A._p1,Q=z.distanceToSquared(U),u>Q&&(u=Q,H=U),U=A._p4,Q=z.distanceToSquared(U),u>Q&&(u=Q,H=U);if(u>q)return!1;var N=d.highlight={};return N.type="changeRealPoint",N.point=H,d.editing={type:"realPoint",point:H,shiftGuide:{point:H.clone(),dir:"x",limit:0}},d._interactor.setCursor("crosshair"),!0},zd.prototype._checkEditElevation=function(M){var C=this;if(!C._interactor.getStyle("curveElevationVisible"))return!1;var b=C.target;if(b instanceof s.Edge&&!C._interactor.getStyle("edgeElevationEditable"))return!1;var L=C.activing;if(!L)return!1;var r=L.getCurrentEditingPoint();if(!r)return!1;var m=C._interactor,w=m.getStyle("curveElevationGuideShift"),f=m.getStyle("curveElevationIntersectSize"),g=M.distanceToSquared({x:r.x+w[0],y:r.y+w[1]});if(!(g>f*f)){var x=C.highlight={};x.type="elevation";var J=new Ph.Math.Vector2(M.x,M.y,r.e);return C.editing={type:"elevation",startPoint:J},C._interactor.setCursor("crosshair"),!0}},zd.prototype._checkEditCtrlPoint=function(A){var Q=this;if(Q.activing&&!Q.activing.selections){var G=Q.getCurrentSelectintStatus();if(G!==Ph.Curve.PointType.Straight){var v=Q.activing.pairs;if(v){var c=Q._interactor.getStyle("curvePointIntersectSize");c*=c;var f,k,S,t,l,b,X,Z,u,e=1/0;for(X=0,u=v.length;u>X;X++)for(t=v[X],Z=0;2>Z;Z++)l=0===Z?"c1":"c2",t[l]&&(b=A.distanceToSquared(t[l]),e>b&&(e=b,f=t,k=X,S=l));if(e>c)return!1;Q.activing.hlpair=f,Q.activing.hltype=S;var m=Q.highlight={};return m.type="changeCtrlPoint",m.point=f[S],Q.editing={type:"ctrlPoint",pair:f,pairId:k,ctrlType:S,direction:f[S].clone().sub(Q.activing.point).normalize()},Q._interactor.setCursor("crosshair"),!0}}}},zd.prototype.startEdit=function(P,E){P.startDragging(E);var c=this;c.highlight&&"insertKnot"===c.highlight.type&&(c.insertKnot(),c.gatherSingleTarget(c._interactor.gv,c.target),c.activing=null,c._checkEditRealPoint(c._interactor._getLogicalPoint(E)));var J=c._activing;if(J){var t=c.editing?c.editing.type:null;"ctrlPoint"===t?J.editingCtrl={pairId:c.editing.pairId,type:J.hltype}:"realPoint"===t&&(J.editingCtrl=!1)}var I=c.highlight,R=s.Default.isCtrlDown(E);if(!I||Fg()||Tf(E)){var L=c._interactor.gv;if(!L.setFocus(E)||L._scrolling)return;return R?c._multiSelect={startPoint:L.lp(E)}:L.isPannable()&&(yf(E)||Tf(E))&&(c._pan={tx:L.tx(),ty:L.ty()},P.fi({kind:"beginPan",event:E})),void 0}if("changeRealPoint"===I.type){var x,Q=c.activing?c.activing.point:null,f=c.activing?c.activing.selections:null;if(R&&c.activing)Q===I.point?(f?(c.activing={point:f[0]},f.length>1&&(f.splice(0,1),c.activing.selections=f)):c.activing=null,c.editing=null):f&&(x=f.indexOf(I.point))>=0?(f.length>1?f.splice(x,1):delete c.activing.selections,c.editing=null):f?(f.push(Q),c.activing={point:I.point,selections:f}):c.activing={point:I.point,selections:[Q]};else if(f)Q===I.point||((x=f.indexOf(I.point))>=0?(f.splice(x,1,Q),c.activing={point:I.point,selections:f}):c.activing={point:I.point});else{var m;Q===I.point&&(m=c.activing.status),c.activing={point:I.point},m&&(c.activing.status=m)}P.fi({kind:"beginEditPoint",event:E})}},zd.prototype.insertKnot=function(){var l=this,N=l.highlight,V=l.screenInfo.curve;V.insertKnot(N.bezier,N.point.t),l._writeToHt()},zd.prototype._writeToHt=function(){var d,x,I=this,N=I.screenInfo.curve,g=N.toHtShape(),w=g.points,M=[],o=g.segments,m=I._interactor.gv;m.dm().beginTransaction();var X,v,n=I.target,E=n instanceof s.Edge,f=Ph.getDataMatrix(n).invert();v=n instanceof s.Polyline||n instanceof s.Edge&&I._interactor.getStyle("edgeElevationEditable"),v&&(X=n.getElevation&&n.getElevation()||0);for(var F=0,R=w.length;R>F;F++)d=w[F],x=Ph.toWorldPosition(m,d),x=f.apply(x),isFinite(d.e)&&d.e!==X&&(x.e=d.e),M.push(x);if(n._writing=!0,E){n.s("edge.type","points"),n.setStyle("edge.segments",o),n.setStyle("edge.points",M.slice(1,M.length-1)),n.setStyle("edge.source.offset.x",0),n.setStyle("edge.source.offset.y",0),n.setStyle("edge.target.offset.x",0),n.setStyle("edge.target.offset.y",0);var J=I._nextChangeEdgeHost;delete I._nextChangeEdgeHost,J&&("source"===J.type?n.setSource(J.host):n.setTarget(J.host)),I._writeEdgeHostAnchor("source",M[0]),I._writeEdgeHostAnchor("target",M[M.length-1])}else M.length?(n.setSegments(o),n.setPoints(M,!0)):n.removeFromDataModel();m.dm().endTransaction(),delete n._writing},zd.prototype._writeEdgeHostAnchor=function(R,E){var v=this,G=v.target,$=v._calcHostAnchor(G,R,E);$.index!==r?(G.setStyle("edge."+R+".index",$.index),G.setStyle("edge."+R+".percent",r),G.setStyle("edge."+R+".anchor.x",r),G.setStyle("edge."+R+".anchor.y",r)):$.percent!==r?(G.setStyle("edge."+R+".percent",$.percent),G.setStyle("edge."+R+".index",r),G.setStyle("edge."+R+".anchor.x",r),G.setStyle("edge."+R+".anchor.y",r)):(G.s("edge."+R+".anchor.x",$.x),G.s("edge."+R+".anchor.y",$.y),$.offsetX||$.offsetY?(G.s("edge."+R+".offset.x",$.offsetX),G.s("edge."+R+".offset.y",$.offsetY)):(G.s("edge."+R+".offset.x",0),G.s("edge."+R+".offset.y",0)))},zd.prototype._calcHostAnchor=function(h,L,O,r){r||(r="source"===L?h.getSource():h.getTarget());var s=this._interactor.gv,Y=s.calculateAttachPoint(r,O);if(Y)return Y.info;if(Dn(r)){var $=s.calculateEdgePosition(r,O);return $}var t=r.getRotation(),n=r.getAnchor();Oi(r,s)&&(t=0);var f=r.getScale();if(t||f.x<0||f.y<0){var u=r.getMatrix(),v=u.tfi(O),B=r.getSize();return{x:v.x/B.width+n.x,y:v.y/B.height+n.y}}var o=Zl(s,r),d={x:(O.x-o.x)/o.width,y:(O.y-o.y)/o.height};return d},zd.prototype._handlePanning=function(S){var N=this,d=N._pan;if(d){d.started=!0;var z=N._interactor,V=z.gv,I=z._lastClientPoint,K=$c(S),_=ps(V,K,I);V.setTranslate(d.tx+_.x,d.ty+_.y),N.gatherSingleTarget(z.gv,N.target),z._42(),z.fi({kind:"betweenPan",event:S})}},zd.prototype.handleEdit=function(g,d){var V=this,H=V.editing;if(V._pan)return V._handlePanning(d),void 0;if(V._multiSelect)return V._multiSelect.endPoint=g.lp(d),V._interactor.redraw(),void 0;if(H){H.inEdit=!0;var f,C,X,e=V._interactor._getLogicalPoint(d),E=s.Default.isCtrlDown(d),l=s.Default.isShiftDown(d),D=H.type,a=V.activing;if(V._guideInfo=null,"ctrlPoint"===D&&l){var O=V.editing.direction.clone();f=a.point;var T=O.dot(e.clone().sub(f));e=O.setLength(T).add(f)}else if("ctrlPoint"===D||"realPoint"===D){var O;if("realPoint"===D&&l){var K=V.editing.shiftGuide;C=K.point;var q=Math.abs(e.x-C.x),z=Math.abs(e.y-C.y);q>z&&q>K.limit&&"y"===K.dir&&(K.dir="x"),z>q&&z>K.limit&&"x"===K.dir&&(K.dir="y"),O=K.dir,"x"===O?(e.y=C.y,K.limit=Math.max(K.limit,q)):"y"===O&&(e.x=C.x,K.limit=Math.max(K.limit,z))}var A=V._isEditEdgeSourceTarget();if(A){var J=V._editEdgeSourceTarget(A,e,E);J&&(V.edgeEditResult=J,X=J.tipText)}else if(!E){var N=V._guidingToEdit(e,O),P="realPoint"===D?V._interactor.gridGuide.findClosest(e,O,!0):null,t=1/0,m=1/0;P&&(P.x&&(t=P.x),P.y&&(m=P.y));var I=!1;N&&(N.xList&&(Math.abs(N.x)<=Math.abs(t)?(I=!0,t=N.x):delete N.xList),N.yList&&(Math.abs(N.y)<=Math.abs(m)?(I=!0,m=N.y):delete N.yList),I&&(V._guideInfo=N)),isFinite(t)&&(e.x+=t),isFinite(m)&&(e.y+=m),I&&(N.v=e)}}var _=V.screenInfo.curve;if("realPoint"===H.type){f=H.point,f.e!==r&&(e.e=f.e),_.moveRealPoint(f,e),H.point=e,V.highlight.point=e;var k=a.status,x=a.selections;if(V.activing={point:e,status:k},x){var L=e.clone().sub(f),Y=0;x.forEach(function(H){var f=H.clone().add(L);_.moveRealPoint(H,f),x[Y++]=f}),V.activing.selections=x}}else if("ctrlPoint"===H.type){var w=a.pairs,h=w[H.pairId];_.moveCtrlPoint(h,e,H.ctrlType);var o=a.status,u=Ph.Curve.PointType;if((o===u.Mirrored||o===u.Asymmetric)&&h.c1&&h.c2){var f=new Ph.Math.Vector2(a.point),Q="c1"===H.ctrlType?"c2":"c1";if(o===Ph.Curve.PointType.Mirrored)_.moveCtrlPoint(h,f.clone().multiplyScalar(2).sub(e),Q);else if(o===u.Asymmetric){var T=h[Q].clone().sub(f).length(),B=f.clone().sub(h[H.ctrlType]).setLength(T).add(f);isNaN(B.x)||_.moveCtrlPoint(h,B,Q)}}a._firePointChange()}else if("elevation"===H.type){C=H.startPoint;var i=C.e+(C.y-e.y)/g._zoom;V._setCurrentPointImpl("e",i),a._firePointChange(),X="E: "+Ph.toFixed(i)}var F=s.Default.getLogicalPoint(d,V._interactor._canvas);if(F.x+=Ph.Icons.TipShiftX,F.y+=Ph.Icons.TipShiftY,!X){var n=Ph.toWorldPosition(g,e);X=""+Ph.toFixed(n.x)+", "+Ph.toFixed(n.y)}V.tipInfo={helperPos:F,text:X,size:X.length},V._writeToHt(),V._interactor.fi({kind:"betweenEditPoint",event:d})}},zd.prototype._setCurrentPointImpl=function(B,c){var W=this,C=W._activing;if(!C)return!1;var p=W.target;if(!p)return!1;var o=C.getCurrentEditingPoint();if(!o)return!1;var T=C.editingCtrl;if(!T)var f=o.clone();if("e"===B)o.e=c;else{var A;if("x"===B||"y"===B){var N=C._lastFirePoint;A="x"===B?{x:c,y:N?N.y:0}:{x:N?N.x:0,y:c}}else"object"==typeof B?(A=B,B.e!==r&&(o.e=B.e)):(A={x:arguments[0],y:arguments[1]},arguments[2]!==r&&(o.e=arguments[2]));var M=Ph.getDataMatrix(p);A=Ph.toScreenPosition(W._interactor.gv,M.apply(A)),o.x=A.x,o.y=A.y}if(!T){var m=f.multiplyScalar(-1).add(o);o.e&&f.e&&(m.e=o.e-f.e);var S=W.screenInfo.curve;S.moveCtrlDueToRealPointMovement(o,m);var n=C.selections;if(n){var e=0;n.forEach(function(L){var b=L.clone().add(m);isFinite(m.e)&&(b.e=(isFinite(L.e)?L.e:p.getElevation()||0)+m.e),S.moveRealPoint(L,b),n[e++]=b}),C.selections=n}}return!0},zd.prototype.setCurrentPoint=function(p,o){return this._setCurrentPointImpl(p,o)?(this._writeToHt(),!0):!1},zd.prototype._isEditEdgeSourceTarget=function(){var U=this,_=U.target;if(!(_ instanceof s.Edge))return!1;var n=U.editing.point,f=U.screenInfo.curve._curves;return n===f[0]._p1?"source":n===f[f.length-1]._p4?"target":!1},zd.prototype._editEdgeSourceTarget=function(K,l,R){var c,S=this,b=S.target;if(c="source"===K?b.getSource():b.getTarget()){var F,W=S._interactor.gv,N=Ph.toWorldPosition(W,l),O=S._calcHostAnchor(b,K,N,c);if(F=O.index!==r||O.percent!==r?O.distance*W.getZoom()>S._interactor.getStyle("edgeHostEdgeMaxDistance"):S._interactor.getStyle("edgeHostDetectPerFrame")?!0:O.x<0||O.x>1||O.y<0||O.y>1?!0:!1){var Q=W.getDataAt(N,function(N){return W.isSelectable(N)?W.isSourceTargetEditable(b,N,K)?b.canSetSourceTarget(N,K)?!0:!1:!1:!1});if(Q){var n=S._calcHostAnchor(b,K,N,Q);c=Q,S._nextChangeEdgeHost={type:K,host:Q},O=n}}var x,e,X;if(R||O.x===r)(O.percent!==r||O.index!==r)&&(e=O.point);else{var z=S._interactor.getStyle("anchorRound"),V=S._interactor.getStyle("anchorSensitivity");x=W.calculateAttachPoint(c,N),x?O=x.info:(O.x=Ph.roundTo(O.x,z,V),O.y=Ph.roundTo(O.y,z,V)),e=fo(W,c,0,O.offsetX||0,O.offsetY||0,O.x,O.y)}e&&(X=Ph.toScreenPosition(W,e),l.x=X.x,l.y=X.y),S._edgeHostGuideInfo={corners:Ph.getTargetCornersOnScreen(W,c),attach:x?x.index:-1,host:c};var C;return O.percent!==r?C="percent: "+O.percent.toFixed(2):O.index!==r?C="index: "+O.index:(C=""+O.x.toFixed(2)+", "+O.y.toFixed(2),(O.offsetX||O.offsetY)&&(C+=" offset: "+O.offsetX.toFixed(2)+", "+O.offsetY.toFixed(2))),{host:c,anchor:O,tipText:C}}},zd.prototype._guidingToEdit=function(t,X){var T,i,c=this;if(T=c.screenInfo.curve){i=T._curves;var E,M,B,e,S,G,L,R,k=1/0,O=1/0,w=[];for(c.editing&&"realPoint"===c.editing.type&&(R=c.editing.point),S=0,G=2*i.length;G>S;S++)L=i[Math.floor(S/2)][S%2?"_p4":"_p1"],w.indexOf(L)>=0||(w.push(L),R&&R===L||(B=L.x-t.x,e=L.y-t.y,Math.abs(B)<Math.abs(k)?(k=B,E=[L]):B===k&&E.push(L),Math.abs(e)<Math.abs(O)?(O=e,M=[L]):e===O&&M.push(L)));var $=c._interactor.getStyle("smartGuideThreshold");if((Math.abs(k)>$||"y"===X)&&(E=null),(Math.abs(O)>$||"x"===X)&&(M=null),E||M){var P=!1,j={};if(E&&(P=!0,j.xList=E,j.x=k),M&&(P=!0,j.yList=M,j.y=O),P)return j}}},zd.prototype._46O=function(h){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditPoint",event:h})),v._guideInfo=null,v._edgeHostGuideInfo=null,v._pan&&(v._pan=null,v._interactor.fi({kind:"endPan",event:h})),v._multiSelect&&(v._handleMultiSelect(v._multiSelect),v._multiSelect=null),v.tipInfo=null,v.edgeEditResult=null},zd.prototype._handleMultiSelect=function(c){if(c.startPoint&&c.endPoint){var i,P,S,g,b,q=this,w=q._interactor,_=w.gv,y=Ph.toScreenPosition(_,c.startPoint),Y=Ph.toScreenPosition(_,c.endPoint),n=s.Default.unionPoint(y,Y),u=q.screenInfo.curve._curves,G=[],d=function(f){f.x>=n.x&&f.y>=n.y&&f.x<=n.x+n.width&&f.y<=n.y+n.height&&G.indexOf(f)<0&&G.push(f)};for(i=0,P=u.length;P>i;i++)b=u[i],d(b._p1),d(b._p4);if(G.length){var J=q.activing||{},t=J.selections||[];for(J.point&&t.push(J.point),i=0,P=t.length;P>i;i++)S=t[i],g=G.indexOf(S),g>=0?G[g]=r:G.push(S);var h=G;for(G=[],i=0,P=h.length;P>i;i++)h[i]&&G.push(h[i]);P=G.length,0===P?q.activing=null:1===P?q.activing={point:G[0]}:(S=G[P-1],q.activing={point:S,selections:G.splice(0,P-1)}),w.redraw()}}},zd.prototype._canDeletePoint=function(I,E){var B=this.target;if(!(B instanceof s.Edge))return!0;var H=I._curves[0],M=I._curves[I._curves.length-1];return H._p1===E||M._p4===E?!1:!0},zd.prototype.handleDelete=function(){var f=this;if(f.activing&&f.screenInfo){var O=s.Default.isShiftDown(),T=f.screenInfo.curve;f._canDeletePoint(T,f.activing.point)&&T.deleteRealPoint(f.activing.point,O),f.activing.selections&&f.activing.selections.forEach(function(s){f._canDeletePoint(T,s)&&T.deleteRealPoint(s,O)}),f.activing=null,delete f.editing,delete f.tipInfo,delete f.edgeEditResult,delete f._pan,delete f._multiSelect,f._writeToHt(),f._interactor.fp("deleteShapePoint",!1,!0)}},zd.prototype.handleDoubleClick=function(m){var J=this,c=J._interactor._getLogicalPoint(m);if(J.screenInfo&&J._checkEditRealPoint(c)){var x=J.getCurrentSelectintStatus(),i=Ph.Curve.PointType;return x=x===i.Mirrored?i.Straight:i.Mirrored,J._setCurrentSelectionStatus(x),J._interactor._42(),!0}},zd.prototype._drawHighlight=function(_){var P=this,Z=P.highlight;if(Z){var K=Z.bezier,V=P._interactor;K&&Ph.Icons.DrawIcon(V,_,Ph.Icons.ShapeHighlightCurve,[K._p1.x,K._p1.y,K._p2.x,K._p2.y,K._p3.x,K._p3.y,K._p4.x,K._p4.y]);var f=Z.point;f&&"insertKnot"===Z.type&&Ph.Icons.DrawIcon(V,_,Ph.Icons.ShapeHighlighPoint,f)}},zd.prototype._drawGuide=function(C){var T=this,M=T._guideInfo;if(M){var c,u,Y,i,V=M.v;for(c=0;2>c;c++)if(i=0===c?M.xList:M.yList)for(u=0,Y=i.length;Y>u;u++)Ph.Icons.DrawIcon(T._interactor,C,Ph.Icons.ShapeGuideLine,[V.x,V.y,i[u].x,i[u].y])}},zd.prototype._drawCurrentPoint=function(p){var n=this;if(n.activing){var M=n.activing,I=n.getCurrentSelectintStatus(),D=n._interactor;if(I!==Ph.Curve.PointType.Straight){var $=M.pairs;M.hlpair,M.hltype;var u=M.selections,R=M.editingCtrl;if($&&!u){var V,l,G;for(l=0,G=$.length;G>l;l++)V=$[l],R&&l===R.pairId&&V[R.type]?Ph.Icons.DrawIcon(D,p,Ph.Icons.ShapeActivingCtrl,{point:V.point,c1:V.c1,c2:V.c2,hl:R.type}):Ph.Icons.DrawIcon(D,p,Ph.Icons.ShapeActivingCtrl,V)}}Ph.Icons.DrawIcon(D,p,Ph.Icons.ShapeHighlighRealPoint,n.activing.point),u&&u.forEach(function(K){Ph.Icons.DrawIcon(D,p,Ph.Icons.ShapeHighlighRealPoint,K)})}},zd.prototype.clear=function(){var x=this;x.editing=null,x._guideInfo=null,x.activing=null,x.highlight=null},zd.prototype._42=function(p){var c=this;c.info={},c.editing||(c.screenInfo=null);var H=c._interactor;if(!H.editDetail)return c.clear(),void 0;var F=H.gv;if(!c.target||!F.isSelected(c.target)||!F.isVisible(c.target))return H.editDetail=!1,c.clear(),void 0;if(c.gatherSingleTarget(F,c.target),Ph.Icons.DrawIcon(H,p,Ph.Icons.ShapeBgCurve,c.screenInfo),c._interactor.getStyle("curveElevationVisible")&&(c.target instanceof s.Polyline||c.target instanceof s.Edge&&c._interactor.getStyle("edgeElevationEditable"))&&c.activing){var B=c.activing.getCurrentEditingPoint();B&&"string"!=typeof B.e&&Ph.Icons.DrawIcon(H,p,Ph.Icons.EdgeElevationGuide,B)}if(c._drawHighlight(p),c._drawCurrentPoint(p),c._getRealPoint().forEach(function(v){Ph.Icons.DrawIcon(H,p,Ph.Icons.ShapePoint,v)}),c._drawGuide(p),c.tipInfo&&c._interactor.getStyle("curveTipVisible")&&Ph.Icons.DrawIcon(H,p,Ph.Icons.TipHelper,c.tipInfo),c._edgeHostGuideInfo&&H._drawHostGuide(c._edgeHostGuideInfo),c.edgeEditResult&&c._drawEdgeHostHighlight(p,c.edgeEditResult.host,c.edgeEditResult.anchor),c._multiSelect&&c._multiSelect.endPoint){var n=s.Default.unionPoint(Ph.toScreenPosition(F,c._multiSelect.startPoint),Ph.toScreenPosition(F,c._multiSelect.endPoint));n.color=F.getRectSelectBorderColor(),p.save(),p.setTransform(1,0,0,1,0,0);var P=Y.devicePixelRatio,y=n.borderWidth=Math.round(P);y/=2,n.x=Math.round(n.x*P)+y,n.y=Math.round(n.y*P)+y,n.width=Math.round(n.width*P),n.height=Math.round(n.height*P),Ph.Icons.DrawIcon(H,p,Ph.Icons.SimpleRect,n),p.restore()}},zd.prototype._drawEdgeHostHighlight=function(b,d,E){this.drawEdgeHostHighlight(b,d,E),this._interactor.redraw()},zd.prototype.drawEdgeHostHighlight=function(Z,V,W){if(Dn(V)){var i,j,$,M,q=this,C=q._interactor,y=C.gv,X=y.getDataUI(V),w=Vh(X),P=[];
for($=0,M=w.points.length;M>$;$++)j=Ph.toScreenPosition(y,w.points.get($)),P.push(j.x,j.y);w.segments&&(i=w.segments.toArray());var L=C.getStyle("edgeHostHighlighPeriod"),u=C.getStyle("edgeHostEdgeHighlighColor");Ph.Icons.DrawIcon(C,Z,Ph.Icons.ShapeBgCurve,{P:P,S:i,color:u,dynamicVisible:W.index===r,dynamicPeriod:L}),u=C.getStyle("edgeHostPointHighlighColor");var I=vk(X);for($=0,M=I.length;M>$;$++){var t=I[$],R=Ph.toScreenPosition(y,t);Ph.Icons.DrawIcon(C,Z,Ph.Icons.ShapePoint,{point:{x:R.x,y:R.y},color:u,size:12,dynamicVisible:$===W.index,dynamicPeriod:L})}}},zd.prototype._getRealPoint=function(){var J,I=this.screenInfo,l=I.P,a=I.S,$=-1,y=[],U=-1,m=a.length;return a.each(function(P){U++;var v=1;if(3===P)v=2;else if(4===P)v=3;else if(5===P)return;$+=v,J=U+1>=m?!0:1===a.get(U+1)?!0:!1,y.push({point:{x:l[2*$],y:l[2*$+1]},segmentIndex:U,pointIndex:$,isEnd:J})}),y},zd.prototype.getEditingPointsInfo=function(u){var $=this,K=$.activing;if(!K)return!1;var R=K.point;if(!R)return!1;var W=this._getRealPoint(),i=[{screen:R}];K.selections&&K.selections.forEach(function(q){i.push({screen:q})});var x,P,h=W.length;return i.forEach(function(K){for(x=0;h>x;x++)if(P=W[x],K.screen.isNearEnough(P.point)){K.segmentIndex=P.segmentIndex,K.pointIndex=P.pointIndex,K.point=$.target.getPoints().get(P.pointIndex);break}}),u&&i.sort(function(W,$){return W.segmentIndex-$.segmentIndex}),i};var mr=Ph.MoveHelper=function(O){var y=this;y.catalog="Move",y._interactor=O};mr.prototype={},mr.prototype.constructor=mr,mr.prototype.calcShift=function(H,Z,f){var m,z,O=this,P=O._interactor.gv,o=P.lp(Z);if("beginMove"===H&&O._gatherGridInfo(f._lastLogicalPoint||o),m=O._target){var L=m.downPosition;if(L){var y=O._interactor.getStyle("moveSensitivity")/P._zoom;if(L.distanceTo(o)<y)return{x:0,y:0};delete m.downPosition}var e;z=s.Default.isShiftDown(Z),z&&(o=O._dealShiftDown(o),e=m.shiftGuide.dir);var l,d=m.rawPos={x:m.pos.x+o.x-m.lp.x,y:m.pos.y+o.y-m.lp.y};if(s.Default.isCtrlDown(Z)){if(l=O._calcShiftByAddon(),O._target.node instanceof Ph.Group){var q=O._target.node;q._position.x+=l.x,q._position.y+=l.y}return l}var M=O._interactor.rectGuide;if(m.node instanceof s.Data&&m.node.s("2d.attachable")){var W=O._calcAttachNodeShift(m.node,d);if(M.clear(),W)return W}for(var b,A=m.x+d.x,J=m.y+d.y,r={x:A,y:J},u={x:A+m.w/2,y:J+m.h/2},k={x:A+m.w,y:J+m.h},C=O._interactor.gridGuide,N=[M.findClosest(r,e),M.findClosest(u,e),M.findClosest(k,e),C.findClosest(r,e),C.findClosest(u,e),C.findClosest(k,e)],G=1/0,v=1/0,R=0,p=N.length;p>R;R++)b=N[R],b&&(A=b.x,J=b.y,isFinite(A)&&Math.abs(A)<Math.abs(G)&&(G=A),isFinite(J)&&Math.abs(J)<Math.abs(v)&&(v=J));if(isFinite(G)||(G=0),isFinite(v)||(v=0),l=O._calcShiftByAddon(G,v),O._target.node instanceof Ph.Group){var q=O._target.node;q._position.x+=l.x,q._position.y+=l.y}var V=m.node;if(!Oi(V,P)){var S=d.x+G,$=d.y+v;O._interactor.rectGuide.gatherLines({node:V,x:m.x+S,y:m.y+$,w:m.w,h:m.h},e)}return l}},mr.prototype._calcShiftByAddon=function(b,k){var y=this._target,g=y.rawPos,A=y.node.getPosition();return b=b||0,k=k||0,{x:g.x-A.x+b,y:g.y-A.y+k}},mr.prototype._dealShiftDown=function(X){var o=this,g=o._target.shiftGuide,R=o._target.lp,n=Math.abs(X.x-R.x),U=Math.abs(X.y-R.y);n>U&&n>g.limit&&"y"===g.dir&&(g.dir="x"),U>n&&U>g.limit&&"x"===g.dir&&(g.dir="y");var I=g.dir;return"x"===I?(X.y=R.y,g.limit=Math.max(g.limit,n)):"y"===I&&(X.x=R.x,g.limit=Math.max(g.limit,U)),X},mr.prototype._isAttachableLineShape=function(X){if(!X.getSegments)return!1;var t=X.getSegments();if(!t)return!0;t instanceof s.List&&(t=t.getArray());for(var O=1,C=t.length;C>O;O++)if(2!==t[O])return!1;return!0},mr.prototype._calcAttachNodeShift=function(){var T=new Vq,B=new Vq,v=new Vq,J=new Vq;return function(e,D){var L=this._interactor.gv,K=e.getHost(),t=L.getDataAt(D,function(H){return H.s("2d.hostable")?!0:!1});if(t&&K!==t&&e.setHost(t),!t)return this._edgeHostGuideInfo=null,e.setHost(null);var Y=this._edgeHostGuideInfo={corners:Ph.getTargetCornersOnScreen(L,t),host:t,attach:-1};if(this._isAttachableLineShape(t)){for(var R,d,W,Q,w,F,y=t.getPoints(),b=y.size(),Z=t.getPointsMatrix2d(),f=1/0,x=0;b>x&&(x!==b-1||t.isClosePath());x++)0!==x?B.copy(v):Z.apply(y.get(x),B),Z.apply(x===b-1?y.get(0):y.get(x+1),v),T.copy(D).sub(B),J.copy(v).sub(B),R=J.length(),J.divideScalar(R),d=T.dot(J),0>d?d=0:d>R&&(d=R),J.multiplyScalar(d).add(B),W=T.copy(D).sub(J).lengthSq(),f>W&&(f=W,F=x,Q=d,w=R);return Math.sqrt(f)*L.getZoom()>this._interactor.getStyle("attachThreshold")?(e.s({"attach.index":-1}),e.setHost(null),void 0):(e.s("attach.offset.opposite")&&(Q=w-Q),e.s({"attach.index":F,"attach.offset":e.s("attach.offset.relative")?Q/w:Q}),{x:0,y:0})}var N=L.calculateAttachPoint(t,D);if(N){var l=N.point;return Y.attach=N.index,this._calcShiftByAddon(l.x-D.x,l.y-D.y)}}}(),mr.prototype._gatherGridInfo=function(V){var Y,d=this,y=d._interactor,s=y._getValidSelection();if(s.length){if(1===s.length){if(Y=s[0],!Y.getRect)return d._target=null,void 0}else if(Y=Ph.Group.findOrCreateGroup(s),!Y)return d._target=null,void 0}else{var s=y.gv.sm().getSelection();if(s.length&&(Y=s.get(0),!Y.getRect))return d._target=null,void 0}if(Y){var H=Y.getPosition(),B=Y.getRect();d._target={node:Y,x:B.x-H.x,y:B.y-H.y,w:B.width,h:B.height,lp:{x:V.x,y:V.y},pos:{x:H.x,y:H.y},shiftGuide:{dir:"x",limit:0},downPosition:new Ph.Math.Vector2(V)},y.rectGuide.gatherRects()}},mr.prototype.clear=function(){var P=this;P._edgeHostGuideInfo=null,P._interactor.rectGuide.clear(),P._interactor._42()},mr.prototype._42=function(){var h=this._edgeHostGuideInfo;h&&this._interactor._drawHostGuide(h)};var Mo=R.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),ig=function(){function h(Z,y){var b=r;return function(){return b||(b=Z.getExtension(y)),b}}function J(G,E){E==r&&(E={}),E.version=M&&(G instanceof WebGL2RenderingContext||R.prototype.toString.call(G)===q)?2:1,E.extensions=function(){for(var U={},P=G.getSupportedExtensions(),C=P.length;C--;)U[name]=h(G,P[C]);return U}();for(var m=R.keys(O),W=0,$=m.length;$>W;++W){var u=m[W];E[u]=G.getParameter(O[u])}if(E.version>1){m=R.keys(Q);for(var W=0,$=m.length;$>W;++W){var u=m[W];E[u]=G.getParameter(Q[u])}}return E}var M="undefined"!=typeof WebGL2RenderingContext,q="[object WebGL2RenderingContext]",O={aliasedLineWidthRange:Mo.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Mo.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Mo.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Mo.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Mo.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Mo.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Mo.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Mo.MAX_TEXTURE_SIZE,maxVaryingVectors:Mo.MAX_VARYING_VECTORS,maxVertexAttribs:Mo.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Mo.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Mo.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Mo.MAX_VIEWPORT_DIMS},Q={max3DTextureSize:Mo.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Mo.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Mo.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Mo.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Mo.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Mo.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Mo.MAX_DRAW_BUFFERS,maxElementIndex:Mo.MAX_ELEMENT_INDEX,maxElementsIndices:Mo.MAX_ELEMENTS_INDICES,maxElementsVertices:Mo.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Mo.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Mo.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Mo.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Mo.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Mo.MAX_SAMPLES,maxTextureLODBias:Mo.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Mo.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Mo.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Mo.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Mo.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Mo.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Mo.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Mo.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Mo.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Mo.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Mo.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(h){var n=h._info;return n||(h._info=n=J(h,n)),n}}}(),Hl=function(){function e(Z,m,L){return{def:Z,getter:L?function(R){var V=ig.for(R);return V.version>1?R.getParameter(m):Z}:function(x){return x.getParameter(m)},setter:L?function(h,e){var t=ig.for(h);t.version>1&&h.pixelStorei(m,e)}:function(o,f){o.pixelStorei(m,f)}}}function H(J){return"string"==typeof J?er(J):J.r!==r?(X[0]=J.r,X[1]=J.g,X[2]=J.b,X[3]=J.a,X):J.red!==r?(X[0]=J.red,X[1]=J.green,X[2]=J.blue,X[3]=J.alpha,X):J}function N(w){return Z(w)?Array.prototype.slice.call(w,0):w}function i(d,w,F){this.gl=w,this._record=F||{},this._branches={},this._leafSync={},this._struct=d;for(var b=d.children,c=b.length;c--;){var Q=b[c],T=Q.name;Q.isLeaf?(this._leafSync[T]=!1,this._record[T]=N(Q.desc.def)):this._record[T]={}}}function t(x){function k(_,Q){i.call(this,x,_,Q);for(var r=I.length;r--;){var v=I[r];this._branches[v._name]=new v._type(_,this._record[v._name])}}function V(j,q){function L(N,U){for(var c=z,V=!1;c--;)N[c]!==U[c]&&(N[c]=U[c],V=!0);return V}var r=j.name,d=Z(j.desc.def),z=d&&j.desc.def.length;if(j.isLeaf){var Y=j.desc.setter,i=j.desc.parse;R.defineProperty(q,r,{configurable:!1,enumerable:!0,get:function(){return this._record[r]},set:d?function(w){i&&(w=i(w)),(L(this._record[r],w)||!this._leafSync[r])&&(Y(this.gl,this._record[r]),this._leafSync[r]=!0)}:function(G){this._record[r]===G&&this._leafSync[r]||(Y(this.gl,G),this._record[r]=G,this._leafSync[r]=!0)}})}else I.push({_name:r,_type:t(j)}),R.defineProperty(q,r,{configurable:!1,enumerable:!0,get:function(){return this._branches[r]},set:function(y){this._branches[r].apply(y)}})}var I=[];return M(k,i),x.forEach(V,k.prototype),k}var X="undefined"!=typeof Float32Array&&new Float32Array(4),F={viewport:{def:[0,0,0/0,0/0],getter:function(Q){return Q.getParameter(Q.VIEWPORT)},setter:function(l,M){var q=M[2]!==M[2]?l.drawingBufferWidth-M[0]:M[2],u=M[3]!==M[3]?l.drawingBufferHeight-M[1]:M[3];l.viewport(M[0],M[1],q,u)}},dither:{def:!1,getter:function(r){return r.isEnabled(r.DITHER)},setter:function(d,G){G?d.enable(d.DITHER):d.disable(d.DITHER)}},rasterizerDiscard:{def:!1,getter:function(l){var U=ig.for(l);return U.version>1&&l.isEnabled(l.RASTERIZER_DISCARD)},setter:function(f,n){var t=ig.for(f);1!==t.version&&(n?f.enable(f.RASTERIZER_DISCARD):f.disable(f.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(C){return C.lineWidth?C.getParameter(C.LINE_WIDTH):1},setter:function(S,$){S.lineWidth&&S.lineWidth($)}},color:{clear:{def:[0,0,0,0],getter:function(T){return T.getParameter(T.COLOR_CLEAR_VALUE)},setter:function(P,K){P.clearColor(K[0],K[1],K[2],K[3])},parse:H},mask:{def:[!0,!0,!0,!0],getter:function(Y){return Y.getParameter(Y.COLOR_WRITEMASK)},setter:function(V,x){V.colorMask(x[0],x[1],x[2],x[3])}}},blend:{enabled:{def:!1,getter:function(w){return w.isEnabled(w.BLEND)},setter:function(f,p){p?f.enable(f.BLEND):f.disable(f.BLEND)}},color:{def:[0,0,0,0],getter:function(H){return H.getParameter(H.BLEND_COLOR)},setter:function(d,b){d.blendColor(b[0],b[1],b[2],b[3])},parse:H},equation:{def:[Mo.FUNC_ADD,Mo.FUNC_ADD],getter:function(t){return[t.getParameter(t.BLEND_EQUATION_RGB),t.getParameter(t.BLEND_EQUATION_ALPHA)]},setter:function(w,S){w.blendEquationSeparate(S[0],S[1])},parse:function(N){var $=N.length;return $>1?N:1===$?(X[1]=X[0]=N[0],X):(X[1]=X[0]=N,X)}},func:{def:[Mo.ONE,Mo.ZERO,Mo.ONE,Mo.ZERO],getter:function(i){return[i.getParameter(i.BLEND_SRC_RGB),i.getParameter(i.BLEND_DST_RGB),i.getParameter(i.BLEND_SRC_ALPHA),i.getParameter(i.BLEND_DST_ALPHA)]},setter:function(c,u){c.blendFuncSeparate(u[0],u[1],u[2],u[3])},parse:function(p){var C=p.length;return C>3?p:(X[2]=X[0]=p[0],X[3]=X[1]=p[1],X)}}},cullFace:{enabled:{def:!1,getter:function(A){return A.isEnabled(A.CULL_FACE)},setter:function(v,j){j?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE)}},mode:{def:Mo.BACK,getter:function(H){return H.getParameter(H.CULL_FACE_MODE)},setter:function(B,V){B.cullFace(V)}},frontFace:{def:Mo.CCW,getter:function(e){return e.getParameter(e.FRONT_FACE)},setter:function(M,P){M.frontFace(P)}}},scissor:{enabled:{def:!1,getter:function(Q){return Q.isEnabled(Q.SCISSOR_TEST)},setter:function(q,n){n?q.enable(q.SCISSOR_TEST):q.disable(q.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(w){return w.getParameter(w.SCISSOR_BOX)},setter:function(n,R){var c=R[2]!==R[2]?n.drawingBufferWidth-R[0]:R[2],w=R[3]!==R[3]?n.drawingBufferHeight-R[1]:R[3];n.scissor(R[0],R[1],c,w)}}},depth:{enabled:{def:!1,getter:function(m){return m.isEnabled(m.DEPTH_TEST)},setter:function(T,Y){Y?T.enable(T.DEPTH_TEST):T.disable(T.DEPTH_TEST)}},clear:{def:1,getter:function(H){return H.getParameter(H.DEPTH_CLEAR_VALUE)},setter:function(e,V){e.clearDepth(V)}},mask:{def:!0,getter:function(e){return e.getParameter(e.DEPTH_WRITEMASK)},setter:function(s,z){s.depthMask(z)}},range:{def:[-1,1],getter:function(Z){return Z.getParameter(Z.DEPTH_RANGE)},setter:function(Y,r){Y.depthRange(r[0],r[1])}},func:{def:Mo.LESS,getter:function(z){return z.getParameter(z.DEPTH_FUNC)},setter:function(Y,b){Y.depthFunc(b)}}},stencil:{enabled:{def:!1,getter:function(v){return v.isEnabled(v.STENCIL_TEST)},setter:function(b,$){$?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST)}},clear:{def:0,getter:function(p){return p.getParameter(p.STENCIL_CLEAR_VALUE)},setter:function(e,A){e.clearStencil(A)}},frontMask:{def:255,getter:function(w){return w.getParameter(w.STENCIL_WRITEMASK)},setter:function(i,c){i.stencilMaskSeparate(i.FRONT,c)}},frontOp:{def:[Mo.KEEP,Mo.KEEP,Mo.KEEP],getter:function(C){return[C.getParameter(C.STENCIL_FAIL),C.getParameter(C.STENCIL_PASS_DEPTH_FAIL),C.getParameter(C.STENCIL_PASS_DEPTH_PASS)]},setter:function(b,R){b.stencilOpSeparate(b.FRONT,R[0],R[1],R[2])}},frontFunc:{def:[Mo.ALWAYS,0,255],getter:function(j){return[j.getParameter(j.STENCIL_FUNC),j.getParameter(j.STENCIL_REF),j.getParameter(j.STENCIL_VALUE_MASK)]},setter:function(h,I){h.stencilFuncSeparate(h.FRONT,I[0],I[1],I[2])}},backMask:{def:255,getter:function(h){return h.getParameter(h.STENCIL_BACK_WRITEMASK)},setter:function(j,G){j.stencilMaskSeparate(j.BACK,G)}},backOp:{def:[Mo.KEEP,Mo.KEEP,Mo.KEEP],getter:function(G){return[G.getParameter(G.STENCIL_BACK_FAIL),G.getParameter(G.STENCIL_BACK_PASS_DEPTH_FAIL),G.getParameter(G.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(M,Y){M.stencilOpSeparate(M.BACK,Y[0],Y[1],Y[2])}},backFunc:{def:[Mo.ALWAYS,0,255],getter:function(r){return[r.getParameter(r.STENCIL_BACK_FUNC),r.getParameter(r.STENCIL_BACK_REF),r.getParameter(r.STENCIL_BACK_VALUE_MASK)]},setter:function(y,C){y.stencilFuncSeparate(y.BACK,C[0],C[1],C[2])}}},hint:{generateMipmap:{def:Mo.DONT_CARE,getter:function(Y){return Y.getParameter(Y.GENERATE_MIPMAP_HINT)},setter:function(E,z){E.hint(E.GENERATE_MIPMAP_HINT,z)}},fragmentShaderDerivative:{def:Mo.DONT_CARE,getter:function(n){var J=ig.for(n);return 1!==J.version||J.extensions.OES_standard_derivatives?n.getParameter(Mo.FRAGMENT_SHADER_DERIVATIVE_HINT):Mo.DONT_CARE},setter:function(R,M){var G=ig.for(R);return G.version>1||G.extensions.OES_standard_derivatives?(R.hint(Mo.FRAGMENT_SHADER_DERIVATIVE_HINT,M),void 0):void 0}}},pixelStore:{packAlignment:e(4,Mo.PACK_ALIGNMENT,!1),unpackAlignment:e(4,Mo.UNPACK_ALIGNMENT,!1),unpackFlipY:e(!1,Mo.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:e(!1,Mo.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:e(Mo.BROWSER_DEFAULT_WEBGL,Mo.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:e(0,Mo.PACK_ROW_LENGTH,!0),packSkipPixels:e(0,Mo.PACK_SKIP_PIXELS,!0),packSkipRows:e(0,Mo.PACK_SKIP_ROWS,!0),unpackRowLength:e(0,Mo.UNPACK_ROW_LENGTH,!0),unpackImageHeight:e(0,Mo.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:e(0,Mo.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:e(0,Mo.UNPACK_SKIP_ROWS,!0),unpackSkipImages:e(0,Mo.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(g){return g.isEnabled(g.POLYGON_OFFSET_FILL)},setter:function(m,q){q?m.enable(m.POLYGON_OFFSET_FILL):m.disable(m.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(R){return[R.getParameter(R.POLYGON_OFFSET_FACTOR),R.getParameter(R.POLYGON_OFFSET_UNITS)]},setter:function(t,R){t.polygonOffset(R[0],R[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(V){return V.isEnabled(V.SAMPLE_COVERAGE)},setter:function(o,q){q?o.enable(o.SAMPLE_COVERAGE):o.disable(o.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(h){return h.isEnabled(h.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(u,X){X?u.enable(u.SAMPLE_ALPHA_TO_COVERAGE):u.disable(u.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(K){return[K.getParameter(K.SAMPLE_COVERAGE_VALUE),K.getParameter(K.SAMPLE_COVERAGE_INVERT)]},setter:function(h,u){h.sampleCoverage(u[0],u[1])}}}},Y=ws.create(F,function(y){return"def"in y});i.prototype.reset=function(){for(var N=this._struct.children,o=N.length;o--;){var R=N[o],_=R.name;R.isLeaf?this[_]=R.desc.def:this._branches[_].reset()}},i.prototype.save=function(X){X==r&&(X={});for(var J=this._struct.children,h=J.length;h--;){var U=J[h],y=U.name;if(U.isLeaf)X[y]=N(this._record[y]);else{var E=X[y];E==r&&(X[y]=E={}),this._branches[y].save(E)}}return X},i.prototype.sync=function(M,h){for(var i=this._struct.children,l=i.length;l--;){var e=i[l],T=e.name;e.isLeaf?(h||!this._leafSync[T])&&(M?(this._record[T]=e.desc.getter(this.gl),this._leafSync[T]=!0):(e.desc.setter(this.gl,this._record[T]),this._leafSync[T]=!0)):this._branches[T].sync(M,h)}},i.prototype.syncLoss=function(){for(var C=this._struct.children,N=C.length;N--;){var U=C[N];U.isLeaf?this._leafSync[U.name]=!1:this._branches[U.name].syncLoss()}},i.prototype.apply=function(b){for(var I=this._struct.children,v=I.length;v--;){var l=I[v],D=l.name;D in b&&(l.isLeaf?this[D]=b[D]:this._branches[D].apply(b[D]))}},i.prototype.append=function(S){var $=this._struct.childMap;for(var x in S){var v=$[x];v&&(v.isLeaf?this[x]=S[x]:this._branches[x].append(S[x]))}};var x=t(Y);return function(B){var t=B._state;return t||(B._state=t=new x(B)),t}}(),Lf=function(){function b(y,d,w,S){if(y){var O=y.length;if(O!=r)for(var T=0;S>T;++T)d[w+T]=y[T];else y.toArray&&y.toArray(d,w)}else for(var T=0;S>T;++T)d[w+T]=0}function q(a,W,$){var v=a[0];if(0>=v||v>0)return a;var m=W*$,l=K[m];if(l==r&&(K[m]=new Float32Array(m)),0!==W){b(v,l,0,$);for(var M=1,S=0;M!==W;++M)S+=$,b(a[M],l,S,$)}return l}function F($,E){$.uniform1f(this.addr,E)}function h(n,W){n.uniform1fv(this.addr,W)}function u(J,w){if(w.x!=r)J.uniform2f(this.addr,w.x,w.y);else{var Q=K[2];Q.set(w,0),J.uniform2fv(this.addr,Q)}}function g(F,C){F.uniform2fv(this.addr,q(C,this.size,2))
}function d(U,C){if(C.x!=r)U.uniform3f(this.addr,C.x,C.y,C.z);else if(C.r!=r)U.uniform3f(this.addr,C.r,C.g,C.b);else if(C.red!=r)U.uniform3f(this.addr,C.red,C.green,C.blue);else{var g=K[3];g.set(C,0),U.uniform3fv(this.addr,g)}}function a(V,n){V.uniform3fv(this.addr,q(n,this.size,3))}function $(q,m){if("string"==typeof m&&(m=er(m)),m.x!=r)q.uniform4f(this.addr,m.x,m.y,m.z,m.w);else if(m.r!=r)q.uniform4f(this.addr,m.r,m.g,m.b,m.a);else if(m.red!=r)q.uniform4f(this.addr,m.red,m.green,m.blue,m.alpha);else{var n=K[4];n.set(m,0),q.uniform4fv(this.addr,n)}}function Y(s,h){s.uniform4fv(this.addr,q(h,this.size,4))}function j(o,I){o.uniform1i(this.addr,I)}function Z(h,s){h.uniform1iv(this.addr,s)}function U(T,Y){T.uniform2iv(this.addr,Y)}function A(r,l){r.uniform3iv(this.addr,l)}function B(Q,L){Q.uniform4iv(this.addr,L)}function t(I,n){I.uniform1i(this.addr,W[n?1:0])}function z(m,O){var l=K[4];l.set(O,0),m.uniformMatrix2fv(this.addr,!1,l)}function E(f,g){f.uniformMatrix2fv(this.addr,!1,q(g,this.size,4))}function m(h,S){var o=K[9];o.set(S,0),h.uniformMatrix3fv(this.addr,!1,o)}function n(a,E){a.uniformMatrix3fv(this.addr,!1,q(E,this.size,9))}function O(x,C){var k=K[16];k.set(C,0),x.uniformMatrix4fv(this.addr,!1,k)}function p(x,N){x.uniformMatrix4fv(this.addr,!1,q(N,this.size,16))}function L(G,E){G.uniform1i(this.addr,this.slots[0]),G.activeTexture(G.TEXTURE0+this.slots[0]),G.bindTexture(G.TEXTURE_2D,E||G._emptyTexture)}function c(G,F){G.uniform1iv(this.addr,this.slots);for(var C=this.slots.length;C--;)G.activeTexture(G.TEXTURE0+this.slots[C]),G.bindTexture(G.TEXTURE_2D,F[C]||G._emptyTexture)}function s(j,a){j.uniform1i(this.addr,this.slots[0]),j.activeTexture(j.TEXTURE0+this.slots[0]),j.bindTexture(j.TEXTURE_CUBE_MAP,a||j._emptyCubeTexture)}function D(Y,C){Y.uniform1iv(this.addr,this.slots);for(var u=this.slots.length;u--;)Y.activeTexture(Y.TEXTURE0+this.slots[u]),Y.bindTexture(Y.TEXTURE_CUBE_MAP,C[u]||Y._emptyCubeTexture)}function f(Y,I,v){V[Y]=[I,v]}function S(Q,R,W){switch(Q.type){case 35678:case 35680:if("uSampler"===W)return[0];if("uBlendSampler"===W)return[1];for(var P=Q.size,f=new Int32Array(P),b=0;P>b;++b)f[b]=R.usedTextureSlot++;return f}return r}function y(J,D,A,Y,e){this.name=J,this.addr=D,this.size=Y?A.size:0,this.activeInfo=A,this.setter=V[A.type][Y?1:0],this.slots=S(A,e,J),Lr(this)}function Q(m,$,L,V){var J=m.name,i=J.length;for(G.lastIndex=0;;){var l=G.exec(J),h=G.lastIndex,a=l[1],S="]"===l[2],A=l[3];if(S&&(a=0|a),A===r||"["===A&&h+2===i){L[a]=new y(a,$,m,A!==r,V);break}var k=L[a];k==r&&(L[a]=k={}),L=k}}function w(o,L,t){this.gl=L,this._program=t,this._leaves={},this._branches={},this._struct=o}function P(Y){function G(r,k){w.call(this,Y,r,k);for(var F=J.length;F--;){var e=J[F];this._branches[e._name]=new e._type(r,k)}}function g(p,K){var o=p.name;if(p.isLeaf){var E=l("d.setter(this.gl, v);",["v"],["d"],[p.desc]);R.defineProperty(K,o,{configurable:!1,enumerable:!0,get:function(){return E},set:E})}else J.push({_name:o,_type:P(p)}),R.defineProperty(K,o,{configurable:!1,enumerable:!0,get:function(){return this._branches[o]},set:function(p){this._branches[o].apply(p)}})}var J=[];return M(G,w),Y.forEach(g,G.prototype),G}function X(z,T){for(var I=z.getProgramParameter(T,z.ACTIVE_UNIFORMS),f={},x={usedTextureSlot:2};I--;){var g=z.getActiveUniform(T,I),H=g.name,E=z.getUniformLocation(T,H);Q(g,E,f,x)}var u=ws.create(f,function(m){return"addr"in m}),M=P(u);return R.defineProperty(M.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:x.usedTextureSlot}),new M(z,T)}var K=[];if("function"==typeof Float32Array)for(var o=1;17>o;++o)K[o]=new Float32Array(o);var W=[0,1],V=[];f(Mo.FLOAT,F,h),f(Mo.FLOAT_VEC2,u,g),f(Mo.FLOAT_VEC3,d,a),f(Mo.FLOAT_VEC4,$,Y),f(Mo.INT,j,Z),f(Mo.INT_VEC2,U,U),f(Mo.INT_VEC3,A,A),f(Mo.INT_VEC4,B,B),f(Mo.BOOL,t,Z),f(Mo.BOOL_VEC2,U,U),f(Mo.BOOL_VEC3,A,A),f(Mo.BOOL_VEC4,B,B),f(Mo.FLOAT_MAT2,z,E),f(Mo.FLOAT_MAT3,m,n),f(Mo.FLOAT_MAT4,O,p),f(Mo.SAMPLER_2D,L,c),f(Mo.SAMPLER_CUBE,s,D);var G=/([\w\d_]+)(\])?(\[|\.)?/g;return w.prototype.apply=function(m){for(var N=this._struct.children,z=N.length;z--;){var E=N[z],o=E.name;o in m&&(E.isLeaf?this[o]=m[o]:this._branches[o].apply(m[o]))}},w.prototype.append=function(F){var H=this._struct.childMap;for(var V in F){var x=H[V];x&&(x.isLeaf?this[V]=F[V]:this._branches[V].append(F[V]))}},function(Q,s){var K=s._uniforms;return K||(s._uniforms=K=X(Q,s)),K}}(),ic=function(){function C(i,h,e){h.vertexAttrib1f(i.addr,e)}function B(Y,M,F){if(F.x!=r)M.vertexAttrib2f(Y.addr,F.x,F.y);else{var Q=S[2];Q.set(F,0),M.vertexAttrib2fv(Y.addr,Q)}}function I(N,A,l){if(l.x!=r)A.vertexAttrib3f(N.addr,l.x,l.y,l.z);else if(l.r!=r)A.vertexAttrib3f(N.addr,l.r,l.g,l.b);else if(l.red!=r)A.vertexAttrib3f(N.addr,l.red,l.green,l.blue);else{var V=S[3];V.set(l,0),A.vertexAttrib3fv(N.addr,V)}}function v(f,R,X){if("string"==typeof X&&(X=er(X)),X.x!=r)R.vertexAttrib4f(f.addr,X.x,X.y,X.z,X.w);else if(X.r!=r)R.vertexAttrib4f(f.addr,X.r,X.g,X.b,X.a);else if(X.red!=r)R.vertexAttrib4f(f.addr,X.red,X.green,X.blue,X.alpha);else{var y=S[4];y.set(X,0),R.vertexAttrib4fv(f.addr,y)}}function q(s,N,n){n=n.el||n;for(var S=0,j=0;2>S;++S)N.vertexAttrib2f(s.addr,n[j++],n[j++])}function W(D,E,v){v=v.el||v;for(var O=0,e=0;3>O;++O)E.vertexAttrib3f(D.addr,v[e++],v[e++],v[e++])}function Q(i,w,M){M=M.el||M;for(var r=0,k=0;4>r;++r)w.vertexAttrib4f(i.addr,M[k++],M[k++],M[k++],M[k++])}function f(U,k,O,T,Y,J,m){k.bindBuffer(k.ARRAY_BUFFER,O),k.vertexAttribPointer(U.addr,1,T||k.FLOAT,!!Y,J||0,m||0),k.bindBuffer(k.ARRAY_BUFFER,null)}function s(p,L,b,T,i,w,C){L.bindBuffer(L.ARRAY_BUFFER,b),L.vertexAttribPointer(p.addr,2,T||L.FLOAT,!!i,w||0,C||0),L.bindBuffer(L.ARRAY_BUFFER,null)}function K(K,l,Y,Q,L,T,i){l.bindBuffer(l.ARRAY_BUFFER,Y),l.vertexAttribPointer(K.addr,3,Q||l.FLOAT,!!L,T||0,i||0),l.bindBuffer(l.ARRAY_BUFFER,null)}function d(q,k,m,W,X,t,c){k.bindBuffer(k.ARRAY_BUFFER,m),k.vertexAttribPointer(q.addr,4,W||k.FLOAT,!!X,t||0,c||0),k.bindBuffer(k.ARRAY_BUFFER,null)}function D(S,e,g,R,N,T,P){var T=T||4,P=P||0;e.bindBuffer(e.ARRAY_BUFFER,g),e.vertexAttribPointer(S.addr,2,R||e.FLOAT,!!N,T,P),e.vertexAttribPointer(S.addr+1,2,R||e.FLOAT,!!N,T,P+2),e.bindBuffer(e.ARRAY_BUFFER,null)}function t(H,x,R,z,A,K,s){var K=K||9,s=s||0;x.bindBuffer(x.ARRAY_BUFFER,R),x.vertexAttribPointer(H.addr,3,z||x.FLOAT,!!A,K,s),x.vertexAttribPointer(H.addr+1,3,z||x.FLOAT,!!A,K,s+3),x.vertexAttribPointer(H.addr+2,3,z||x.FLOAT,!!A,K,s+6),x.bindBuffer(x.ARRAY_BUFFER,null)}function L(p,O,t,B,z,v,D){var v=v||16,D=D||0;O.bindBuffer(O.ARRAY_BUFFER,t),O.vertexAttribPointer(p.addr,4,B||O.FLOAT,!!z,v,D),O.vertexAttribPointer(p.addr+1,4,B||O.FLOAT,!!z,v,D+4),O.vertexAttribPointer(p.addr+2,4,B||O.FLOAT,!!z,v,D+8),O.vertexAttribPointer(p.addr+3,4,B||O.FLOAT,!!z,v,D+12),O.bindBuffer(O.ARRAY_BUFFER,null)}function b($,t,I){y[$]=function(a,s,G,k,F,B){this.addr==r||this.addr<0||(s==r||s===!1?a.disableVertexAttribArray(this.addr):ts(s)===m?(a.enableVertexAttribArray(this.addr),I(this,a,s,G,k,F,B)):(a.disableVertexAttribArray(this.addr),t(this,a,s)))}}function z(K,P,q){this.name=K,this.addr=P,this.activeInfo=q,this.setter=y[q.type],Lr(this)}function j(O,W,T){this.gl=W,this.program=T,this._branches={},this._struct=O}function T(y){function L(O,r){j.call(this,y,O,r);for(var Z=S.length;Z--;){var Q=S[Z];this._branches[Q._name]=new Q._type(O,r)}}function v(g,r){var O=g.name;if(g.isLeaf){var z=l("d.setter(this.gl, v);",["v"],["d"],[g.desc]);R.defineProperty(r,O,{configurable:!1,enumerable:!0,get:function(){return z},set:z})}else S.push({_name:O,_type:T(g)}),R.defineProperty(r,O,{configurable:!1,enumerable:!0,get:function(){return this._branches[O]},set:function(J){this._branches[O].apply(J)}})}var S=[];return M(L,j),y.forEach(v,L.prototype),L}function A(C,w){for(var Y=C.getProgramParameter(w,C.ACTIVE_ATTRIBUTES),s={};Y--;){var n=C.getActiveAttrib(w,Y),m=n.name,J=C.getAttribLocation(w,m);s[m]=new z(m,J,n)}var I=ws.create(s,function(R){return"addr"in R}),e=T(I);return new e(C,w)}for(var S=[],U=1;17>U;++U)S[U]=new vg(U);var y=[],m="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return b(Mo.FLOAT,C,f),b(Mo.FLOAT_VEC2,B,s),b(Mo.FLOAT_VEC3,I,K),b(Mo.FLOAT_VEC4,v,d),b(Mo.FLOAT_MAT2,q,D),b(Mo.FLOAT_MAT3,W,t),b(Mo.FLOAT_MAT4,Q,L),j.prototype.disable=function(){for(var m=this._struct.children,s=m.length;s--;){var Q=m[s],f=Q.name;Q.isLeaf?this.gl.disableVertexAttribArray(Q.desc.addr):this._branches[f].disable()}},j.prototype.apply=function(A){for(var s=this._struct.children,g=s.length;g--;){var h=s[g],e=h.name;e in A&&(h.isLeaf?this[e]=A[e]:this._branches[e].apply(A[e]))}},j.prototype.append=function(Z){var n=this._struct.childMap;for(var C in Z){var c=n[C];c&&(c.isLeaf?this[C]=Z[C]:this._branches[C].append(Z[C]))}},function(U,m){var o=m._attribs;return o||(m._attribs=o=A(U,m)),o}}(),Qp=function(k){var J=this;R.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:k,writable:!1},glState:{configurable:!1,enumerable:!1,value:Hl(k),writable:!1}}),J._currProgram=r,J._currUniforms=r,J._currAttribs=r,J._sync=!0};R.defineProperties(Qp.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(l){var E=this;E._sync&&l===E._currProgram||(E.gl.useProgram(l),E._currProgram=l,E._currUniforms=Lf(E.gl,l),E._currAttribs=ic(E.gl,l),E._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var O=this;return O._currProgram&&!O._sync&&(O.gl.useProgram(O._currProgram),O._sync=!0),O._currUniforms},set:function(U){var Y=this;Y._currUniforms&&(Y._currProgram&&!Y._sync&&(Y.gl.useProgram(Y._currProgram),this._sync=!0),Y._currUniforms.apply(U))}},attribs:{configurable:!1,enumerable:!1,get:function(){var Z=this;return Z._currProgram&&!Z._sync&&(Z.gl.useProgram(Z._currProgram),Z._sync=!0),Z._currAttribs},set:function(W){var M=this;M._currUniforms&&(M._currProgram&&!M._sync&&(M.gl.useProgram(M._currProgram),this._sync=!0),M._currAttribs.apply(W))}}}),Qp.prototype.useProgram=function(w){var I=this;I._sync&&w===I._currProgram||(I.gl.useProgram(w),I._currProgram=w,I._currUniforms=Lf(I.gl,w),I._currAttribs=ic(I.gl,w),I._sync=!0)},Qp.prototype.directState=function(){return this.glState},Qp.prototype.directUniforms=function(){return this._currUniforms},Qp.prototype.directAttribs=function(){return this._currAttribs},Qp.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Qp.for=function(V){var s=V._renderState;return s||(V._renderState=s=new Qp(V)),s};var mk="directional",Zc="point",jc="spot",Vl="light.color",xn={},Ej=function(g,w){ap(w)&&Hg.test(w)?zi(g,w):np(w)&&w.modelType?Zh(g,w):w===r?delete sg[g]:sg[g]=w},Mq=function(h){return h},kk=function(v){v=Y.convertShape3dModelName(v);var P;if(np(v)){if(v.modelType){if(v.uuid){if(P=sg[v.uuid])return P}else v.uuid=s.Math.generateUUID();return P===r&&(sj&&sj[v.uuid]||Zh(v.uuid,v)),r}return v}return P=sg[v],v&&P===r&&Hg.test(v)&&(sj&&sj[v]||zi(v,v)),P},lc=function(J,U){J.frameStack?J.frameStack.push(U):J.frameStack=[U],J.bindFramebuffer(J.FRAMEBUFFER,U)},sm=function(p){var d=p.frameStack;if(d){if(d.pop(),d.length)return p.bindFramebuffer(p.FRAMEBUFFER,d[d.length-1]),void 0;p.frameStack=null}p.bindFramebuffer(p.FRAMEBUFFER,null)};xl(Y,{graph3dViewAttributes:w,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:g/60,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Od,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:g,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:g/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Ej,getShape3dModel:kk,convertShape3dModelName:Mq,getShape3dModelMap:function(){return sg},getCachedShape3dModelMap:function(){return gd},createMatrix:function(C,s){wd(C)||(C=[C]);for(var V=C.length-1;V>=0;V--){var Z=C[V];s=cq(Z.mat,Z.s3,Z.r3,Z.rotationMode,Z.t3,s)}return s},transformVec:function(U,k){return yb(U,k)},glBindFrame:lc,glUnbindFrame:sm,createBoxModel:function(){return{vs:oq,ns:jd,uv:ok,is:of}},createRoundRectModel:function(J,B){return Fm.roundRect(J,B)},createStarModel:function(H,c){return Fm.star(H,c)},createRectModel:function(r,h){return Fm.rect(r,h)},createTriangleModel:function(Y,h){return Fm.triangle(Y,h)},createRightTriangleModel:function(O,W){return Fm.rightTriangle(O,W)},createParallelogramModel:function(t,b){return Fm.parallelogram(t,b)},createTrapezoidModel:function(y,D){return Fm.trapezoid(y,D)},createSmoothSphereModel:function(Q,t,X,W,s,a,i){return yj(new Ji(Q,t,X,W,s,a,i))},createSphereModel:function($,L,T,C,Q,l,t){return $?_l($,L,T,C,Q,l,t):Y.createSmoothSphereModel()},createSmoothConeModel:function(I,W,f,n,D){return Yc(I,W,f,n,D)},createConeModel:function(w,Q,Y,P,r,g){return w?Yn(w,Q,Y,P,r,g):Yc(g)},createSmoothCylinderModel:function(O,E,S,q,r,i,f,B){return yj(new nd(O,E,S,q,r,i,f,B))},createCylinderModel:function(K,U,V,Q,X,R,D,t){return K?gn(K,U,V,Q,X,R,D,t):qr(R,D)},createSmoothTorusModel:function(L,o,I,e,W,n){return yj(new mq(L,o,I,e,W,n))},createTorusModel:function(n,z,G,k,Q,V,S,$){return n?_k(n,z,G,k,Q,V,S,$):wc(V,S)},createExtrusionModel:function(V,O,w,L,s,f,Q,b){return oi(V,O,w,L,s,f,Q,b)},createSmoothRingModel:function(N,Y,G,q,r,t){for(var v=[],I=0;I<N.length-1;I+=2)v.push({x:N[I],y:N[I+1]});for(N=Fi(v,Y,G)[0],v=[],I=0;I<N.length;I++){var u=N[I];v.push(new Md(u.x,0,u.y))}return yj(new gk(v,t,q,r))},createTextGeometry:function(m,V){return yj(new Le(m,V))},loadFontFace:function(F,P){Y.xhrLoad(F,function(n){if(!n)return P();var v;try{v=JSON.parse(n)}catch(L){v=JSON.parse(n.substring(65,n.length-2))}$n.loadFace(v),P&&P(v.familyName.toLowerCase())},P?null:{sync:!0})},createRingModel:function(c,J,o,W,y,U,q,t,K,B){for(var F=[],k=0;k<c.length-1;k+=2)F.push({x:c[k],y:c[k+1]});U=U||Y.shapeSide,q=q||0,t=t||U;var V,C,M,T,G,z,x,X,N,s,k,i,S,e,Q,p,I,P,h=[],g=[],D=K?[]:w,$=K?[]:w,E=B?[]:w,v=B?[]:w,j=W?[]:w,b=W?[]:w,H=y?[]:w,m=y?[]:w,c=Fi(F,J,o),R=th(c),r=0,Z=2*Math.PI/U;return c.forEach(function(c){if(M=c.length,M>1){if(T=c[0],W)for(z=T.x,X=T.y,k=q;t>k;k++)i=k+1,S=k*Z,e=i*Z,Q=f(S),p=O(S),I=f(e),P=O(e),j.push(Q*z,X,-p*z,I*z,X,-P*z,0,X,0),b.push(.5-.5*Q,.5-.5*p,.5-.5*I,.5-.5*P,.5,.5);for(s=0;M>s;s++){for(G=c[s],z=T.x,x=G.x,X=T.y,N=G.y,V=r/R,r+=qd(T,G),C=r/R,k=q;t>k;k++)i=k+1,S=k*Z,e=i*Z,Q=f(S),p=O(S),I=f(e),P=O(e),h.push(Q*x,N,-p*x,I*x,N,-P*x,Q*z,X,-p*z,I*x,N,-P*x,I*z,X,-P*z,Q*z,X,-p*z),g.push(k/U,C,i/U,C,k/U,V,i/U,C,i/U,V,k/U,V),K&&k===q&&(D.push(0,X,0,0,N,0,Q*x,N,-p*x,Q*x,N,-p*x,Q*z,X,-p*z,0,X,0),$.push(0,.5-X,0,.5-N,2*x,.5-N,2*x,.5-N,2*z,.5-X,0,.5-X)),B&&i===t&&(E.push(0,X,0,I*x,N,-P*x,0,N,0,I*x,N,-P*x,0,X,0,I*z,X,-P*z),v.push(1,.5-X,1-2*x,.5-N,1,.5-N,1-2*x,.5-N,1,.5-X,1-2*z,.5-X));T=G}if(y)for(z=T.x,X=T.y,k=q;t>k;k++)i=k+1,S=k*Z,e=i*Z,Q=f(S),p=O(S),I=f(e),P=O(e),H.push(I*z,X,-P*z,Q*z,X,-p*z,0,X,0),m.push(.5-.5*I,.5+.5*P,.5-.5*Q,.5+.5*p,.5,.5)}}),{vs:h,uv:g,bottom_vs:H,bottom_uv:m,top_vs:j,top_uv:b,from_vs:D,from_uv:$,to_vs:E,to_uv:v}}},!0),xl(V,{"3d.move.mode":r,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":r,"edge.gradient.color":r,"edge.source.t3":r,"edge.target.t3":r,"light.type":Zc,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":g/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":nj,"wf.short":!1,"wf.mat":r,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:r,"transparent.mask":!1,brightness:r,"select.brightness":.7,"repeat.uv.length":r,"shadow.cast":!0,"shadow.receive":!0,bloom:!1,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":r,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":_j,"label.t3":r,"label.r3":r,"label.texture.scale":2,"label.rotationMode":ue,"label.light":!1,"label.blend":r,"label.reverse.flip":!1,"label.reverse.color":Vr,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":_j,"label2.t3":r,"label2.r3":r,"label2.texture.scale":2,"label2.rotationMode":ue,"label2.light":!1,"label2.blend":r,"label2.reverse.flip":!1,"label2.reverse.color":Vr,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":_j,"note.t3":r,"note.r3":r,"note.texture.scale":2,"note.rotationMode":ue,"note.light":!1,"note.blend":r,"note.reverse.flip":!1,"note.reverse.color":Vr,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":_j,"note2.t3":r,"note2.r3":r,"note2.texture.scale":2,"note2.rotationMode":ue,"note2.light":!1,"note2.blend":r,"note2.reverse.flip":!1,"note2.reverse.color":Vr,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:r,"shape3d.color":Xl,"shape3d.top.color":r,"shape3d.bottom.color":r,"shape3d.from.color":r,"shape3d.to.color":r,"shape3d.image":r,"shape3d.top.image":r,"shape3d.bottom.image":r,"shape3d.from.image":r,"shape3d.to.image":r,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":r,"shape3d.side.to":r,"shape3d.smooth":r,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":r,"shape3d.opacity":r,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Vr,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":r,"shape3d.uv.scale":r,"shape3d.top.uv.offset":r,"shape3d.top.uv.scale":r,"shape3d.bottom.uv.offset":r,"shape3d.bottom.uv.scale":r,"shape3d.from.uv.offset":r,"shape3d.from.uv.scale":r,"shape3d.to.uv.offset":r,"shape3d.to.uv.scale":r,"shape3d.top.cap":r,"shape3d.bottom.cap":r,"shape3d.start.angle":0,"shape3d.sweep.angle":c,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.ratio":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":r,"texture.filter":r,"texture.filter.min":r,"texture.filter.mag":r,"texture.wrap":r,"points.image":r,"points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"all.light":!0,"all.visible":!0,"all.color":Xl,"all.image":r,"all.blend":r,"all.opacity":r,"all.reverse.flip":!1,"all.reverse.color":Vr,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":r,"all.uv.offset":r,"all.uv.scale":r,"all.discard.selectable":!0,mat:r,"left.mat":r,"right.mat":r,"top.mat":r,"bottom.mat":r,"front.mat":r,"back.mat":r,"edge.source.anchor.elevation":r,"edge.target.anchor.elevation":r},!0);var od,tk=!1,$g=[0,0,0,0],Gm=function(K){return K instanceof qj},vs=function(c){return[c.x,c.e||0,c.y]},Rj=function(I,Z,U){for(var Z=er(Z||0),S=Z[0],l=Z[1],b=Z[2];U--;)I.push(S,l,b)},xh=function(D,x,i){for(var x=er(x||0),E=x[0],g=x[1],r=x[2],K=x[3];i--;)D.push(E,g,r,K)},Jb=function(C,V,x){if(V)for(var l,s,D,e=V[0],E=V[1],r=V[2],_=V[4],K=V[5],B=V[6],p=V[8],d=V[9],S=V[10],q=V[12],H=V[13],A=V[14],u=x.length,W=0,W=0;u>W;W+=3)l=x[W],s=x[W+1],D=x[W+2],C.push(e*l+_*s+p*D+q,E*l+K*s+d*D+H,r*l+B*s+S*D+A);else Ho(C,x)},en=function(G,y){var B=y.s("light.intensity"),J=er(y.s(Vl)),N=J[0],Y=J[1],L=J[2];1!==B&&(N*=B,Y*=B,L*=B),G.push(N,Y,L,y.s("light.disabled")?1:0)},db=function(y,L){var t=Qp.for(L),C=t.directUniforms();C.uHeadlightRange=y._headlightRange,C.uHeadlightAmbientIntensity=y._headlightAmbientIntensity;var a=y._headlightIntensity,u=er(y._headlightColor);1!==a&&(u=[u[0]*a,u[1]*a,u[2]*a]),C.uHeadlightColor=[u[0],u[1],u[2],y._headlightDisabled?1:0];var X=y._59O,W=y._spots,g=y._dirs;if(X.length){var O=[],x=[],j=[];X.forEach(function(C){en(O,C),Ho(x,y._transformPointToViewSpace(C.p3())),j.push(C.s("light.range"))}),C.uPointColor=O,C.uPointRange=j,C.uPointPosition=x}if(W.length){var I=[],M=[],l=[],P=[],h=[],Q=[];W.forEach(function(u){en(I,u),Ho(M,y._transformPointToViewSpace(u.p3())),Ho(h,y._transformDirectionToViewSpace(u.p3(),u.s("light.center"))),l.push(u.s("light.range")),P.push(f(u.s("light.angle")/2)),Q.push(u.s("light.exponent"))}),C.uSpotColor=I,C.uSpotRange=l,C.uSpotAngle=P,C.uSpotExponent=Q,C.uSpotPosition=M,C.uSpotDirection=h}if(g.length){var R=[],d=[];g.forEach(function(M){en(R,M),Ho(d,y._transformDirectionToViewSpace(M.p3()))}),C.uDirColor=R,C.uDirDirection=d}},ll=function(v,C){return Math.max(v.getRotateMinPhi()+Hp,Math.min(v.getRotateMaxPhi()-Hp,C))},Op=function(){return.05+t()/2},ob=function(C,T,i,W){var Z,V=C.getEye();return C.isOrtho()?(Z=Wn(C.getCenter(),V),Z[0]+=W[0],Z[1]+=W[1],Z[2]+=W[2]):Z=V,Gb(T,i,W,Z)},Gb=function(m,v,F,O){var l=mj(m,v),i=Wn(O,F,!0),p=mj(i,v);if(J(p)<Hp)return w;var k=(l-mj(F,v))/p;return[F[0]+i[0]*k,F[1]+i[1]*k,F[2]+i[2]*k]},Dc=function(A,k){return{x:2*A.x-k.x,y:2*A.y-k.y}},qe=function(d,l,Z,c){var u,Y;if(!d)return u=K(l.y-Z.y,Z.x-l.x),{x:l.x+c*O(u),y:l.y+c*f(u)};if(!Z)return u=K(d.y-l.y,l.x-d.x),{x:l.x+c*O(u),y:l.y+c*f(u)};var h=Wn([d.x,d.y,0],[l.x,l.y,0],!0),J=Wn([Z.x,Z.y,0],[l.x,l.y,0],!0),P=-(h[0]+J[0])/2,m=-(h[1]+J[1])/2,L=G(P*P+m*m);if(Hp>L)return u=K(d.y-l.y,l.x-d.x),{x:l.x+c*O(u),y:l.y+c*f(u)};var y=d.x-l.x,q=d.y-l.y,W=Z.x-l.x,N=Z.y-l.y,X=G(y*y+q*q),C=G(W*W+N*N);u=o(mj(h,J))/2,Y=h[1]*J[0]-h[0]*J[1]>0?-1:1,P/=L,m/=L;var R=c/O(u),A=i(X,C)/f(u);L=Math.min(R,A);var U={x:l.x+Y*L*P,y:l.y+Y*L*m};return Z.b&&R>C/f(u)&&(U.adjust=!0),U},Eq=function(J){var L=J[1],_=J[2],c=J[3],a=J[6],u=J[7],I=J[11];J[1]=J[4],J[2]=J[8],J[3]=J[12],J[4]=L,J[6]=J[9],J[7]=J[13],J[8]=_,J[9]=a,J[11]=J[14],J[12]=c,J[13]=u,J[14]=I},Ro=function(F){var M=F[0],k=F[1],s=F[2],H=F[3],z=F[4],f=F[5],p=F[6],y=F[7],v=F[8],d=F[9],W=F[10],O=F[11],q=F[12],e=F[13],Y=F[14],E=F[15],S=M*f-k*z,B=M*p-s*z,j=M*y-H*z,X=k*p-s*f,o=k*y-H*f,V=s*y-H*p,P=v*e-d*q,Q=v*Y-W*q,T=v*E-O*q,u=d*Y-W*e,N=d*E-O*e,I=W*E-O*Y,i=S*I-B*N+j*u+X*T-o*Q+V*P;return i?(i=1/i,F[0]=(f*I-p*N+y*u)*i,F[1]=(s*N-k*I-H*u)*i,F[2]=(e*V-Y*o+E*X)*i,F[3]=(W*o-d*V-O*X)*i,F[4]=(p*T-z*I-y*Q)*i,F[5]=(M*I-s*T+H*Q)*i,F[6]=(Y*j-q*V-E*B)*i,F[7]=(v*V-W*j+O*B)*i,F[8]=(z*N-f*T+y*P)*i,F[9]=(k*T-M*N-H*P)*i,F[10]=(q*o-e*j+E*S)*i,F[11]=(d*j-v*o-O*S)*i,F[12]=(f*Q-z*u-p*P)*i,F[13]=(M*u-k*Q+s*P)*i,F[14]=(e*B-q*X-Y*S)*i,F[15]=(v*X-d*B+W*S)*i,void 0):w},ze=function(L,r){if(r){var o=r[0],f=r[1],c=r[2];L[12]=L[0]*o+L[4]*f+L[8]*c+L[12],L[13]=L[1]*o+L[5]*f+L[9]*c+L[13],L[14]=L[2]*o+L[6]*f+L[10]*c+L[14],L[15]=L[3]*o+L[7]*f+L[11]*c+L[15]}},Ff=function(_,Y){if(Y){var H=Y[0],W=Y[1],J=Y[2];_[0]=_[0]*H,_[1]=_[1]*H,_[2]=_[2]*H,_[3]=_[3]*H,_[4]=_[4]*W,_[5]=_[5]*W,_[6]=_[6]*W,_[7]=_[7]*W,_[8]=_[8]*J,_[9]=_[9]*J,_[10]=_[10]*J,_[11]=_[11]*J}},Kc=function(E,P,y){var G=P[0],N=P[1],a=P[2],x=P[3],H=P[4],T=P[5],F=P[6],f=P[7],j=P[8],i=P[9],s=P[10],L=P[11],O=P[12],r=P[13],c=P[14],q=P[15],C=y[0],U=y[1],J=y[2],v=y[3];return E[0]=C*G+U*H+J*j+v*O,E[1]=C*N+U*T+J*i+v*r,E[2]=C*a+U*F+J*s+v*c,E[3]=C*x+U*f+J*L+v*q,C=y[4],U=y[5],J=y[6],v=y[7],E[4]=C*G+U*H+J*j+v*O,E[5]=C*N+U*T+J*i+v*r,E[6]=C*a+U*F+J*s+v*c,E[7]=C*x+U*f+J*L+v*q,C=y[8],U=y[9],J=y[10],v=y[11],E[8]=C*G+U*H+J*j+v*O,E[9]=C*N+U*T+J*i+v*r,E[10]=C*a+U*F+J*s+v*c,E[11]=C*x+U*f+J*L+v*q,C=y[12],U=y[13],J=y[14],v=y[15],E[12]=C*G+U*H+J*j+v*O,E[13]=C*N+U*T+J*i+v*r,E[14]=C*a+U*F+J*s+v*c,E[15]=C*x+U*f+J*L+v*q,E},eg=function(l,h,R,Q){var B,K,g,A,P,O,m,F,W,q,e=h[0],$=h[1],T=h[2],y=Q[0],d=Q[1],H=Q[2],V=R[0],N=R[1],j=R[2];return J(e-V)<Hp&&J($-N)<Hp&&J(T-j)<Hp?Sh(l):(m=e-V,F=$-N,W=T-j,q=1/G(m*m+F*F+W*W),m*=q,F*=q,W*=q,B=d*W-H*F,K=H*m-y*W,g=y*F-d*m,q=G(B*B+K*K+g*g),q?(q=1/q,B*=q,K*=q,g*=q):(B=0,K=0,g=0),A=F*g-W*K,P=W*B-m*g,O=m*K-F*B,q=G(A*A+P*P+O*O),q?(q=1/q,A*=q,P*=q,O*=q):(A=0,P=0,O=0),l[0]=B,l[1]=A,l[2]=m,l[3]=0,l[4]=K,l[5]=P,l[6]=F,l[7]=0,l[8]=g,l[9]=O,l[10]=W,l[11]=0,l[12]=-(B*e+K*$+g*T),l[13]=-(A*e+P*$+O*T),l[14]=-(m*e+F*$+W*T),l[15]=1,l)},Si=function(O,i,l,K,P){var I=1/$(i/2),u=1/(K-P);return O[0]=I/l,O[1]=0,O[2]=0,O[3]=0,O[4]=0,O[5]=I,O[6]=0,O[7]=0,O[8]=0,O[9]=0,O[10]=(P+K)*u,O[11]=-1,O[12]=0,O[13]=0,O[14]=2*P*K*u,O[15]=0,O},co=function(I,D,$,q,P,m,M){var t=1/(D-$),x=1/(q-P),T=1/(m-M);return I[0]=-2*t,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=-2*x,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=2*T,I[11]=0,I[12]=(D+$)*t,I[13]=(P+q)*x,I[14]=(M+m)*T,I[15]=1,I},fs=function(n,p){var T=p[0],x=p[1],D=p[2],U=p[3],H=T*T+x*x+D*D+U*U,S=H?1/H:0;return n[0]=-T*S,n[1]=-x*S,n[2]=-D*S,n[3]=U*S,n},rr=function(G,V){var t=V[0]+V[5]+V[10],d=0;return t>0?(d=2*Math.sqrt(t+1),G[3]=.25*d,G[0]=(V[6]-V[9])/d,G[1]=(V[8]-V[2])/d,G[2]=(V[1]-V[4])/d):V[0]>V[5]&V[0]>V[10]?(d=2*Math.sqrt(1+V[0]-V[5]-V[10]),G[3]=(V[6]-V[9])/d,G[0]=.25*d,G[1]=(V[1]+V[4])/d,G[2]=(V[8]+V[2])/d):V[5]>V[10]?(d=2*Math.sqrt(1+V[5]-V[0]-V[10]),G[3]=(V[8]-V[2])/d,G[0]=(V[1]+V[4])/d,G[1]=.25*d,G[2]=(V[6]+V[9])/d):(d=2*Math.sqrt(1+V[10]-V[0]-V[5]),G[3]=(V[1]-V[4])/d,G[0]=(V[8]+V[2])/d,G[1]=(V[6]+V[9])/d,G[2]=.25*d),G},Bs=function(O,r,H){var I=r[0],s=r[1],B=r[2],k=r[3],x=I+I,Z=s+s,t=B+B,N=I*x,y=I*Z,o=I*t,J=s*Z,U=s*t,D=B*t,c=k*x,R=k*Z,n=k*t;return O[0]=1-(J+D),O[1]=y+n,O[2]=o-R,O[3]=0,O[4]=y-n,O[5]=1-(N+D),O[6]=U+c,O[7]=0,O[8]=o+R,O[9]=U-c,O[10]=1-(N+J),O[11]=0,O[12]=H[0],O[13]=H[1],O[14]=H[2],O[15]=1,O},le=function(G,H){if(G.vr.enable){var M=G.vr.getViewMatrix(H);if(M)return M}return eg(H?H:Vd(),G._eye,G._center,G._up)},Nd=function(c,u){if(c.vr.enable){var F=c.vr.getProjectMatrix();if(F)return F}if(!u&&c._computedProjectMatrix)return Zo(c._computedProjectMatrix);var J=c.getAspect(),G=c._near,I=c._far,D=Vd();if(c._ortho){var L=c._orthoWidth/2,Q=L/J;co(D,-L,L,-Q,Q,G,I)}else Si(D,c._fovy,J,G,I);return D},Wk=function(O,c){if(!O)return w;var R=0,k=1,V=2,F=[],B=0,J=O.length,q=J/3;if(c){for(;J>B;B++)F[B]=0;for(B=0;B<c.length;B+=3){var f=[],L=[],W=[];f[R]=O[3*c[B+1]+R]-O[3*c[B]+R],f[k]=O[3*c[B+1]+k]-O[3*c[B]+k],f[V]=O[3*c[B+1]+V]-O[3*c[B]+V],L[R]=O[3*c[B+2]+R]-O[3*c[B+1]+R],L[k]=O[3*c[B+2]+k]-O[3*c[B+1]+k],L[V]=O[3*c[B+2]+V]-O[3*c[B+1]+V],W[R]=f[k]*L[V]-f[V]*L[k],W[k]=f[V]*L[R]-f[R]*L[V],W[V]=f[R]*L[k]-f[k]*L[R];for(var $=0;3>$;$++)F[3*c[B+$]+R]+=W[R],F[3*c[B+$]+k]+=W[k],F[3*c[B+$]+V]+=W[V]}}else for(B=0;q>B;B+=3){var f=[],L=[],W=[];f[R]=O[3*(B+1)+R]-O[3*B+R],f[k]=O[3*(B+1)+k]-O[3*B+k],f[V]=O[3*(B+1)+V]-O[3*B+V],L[R]=O[3*(B+2)+R]-O[3*(B+1)+R],L[k]=O[3*(B+2)+k]-O[3*(B+1)+k],L[V]=O[3*(B+2)+V]-O[3*(B+1)+V],W[R]=f[k]*L[V]-f[V]*L[k],W[k]=f[V]*L[R]-f[R]*L[V],W[V]=f[R]*L[k]-f[k]*L[R];for(var $=0;3>$;$++)F[3*(B+$)+R]=W[R],F[3*(B+$)+k]=W[k],F[3*(B+$)+V]=W[V]}for(B=0;J>B;B+=3){var m=[];m[R]=F[B+R],m[k]=F[B+k],m[V]=F[B+V];var r=G(m[R]*m[R]+m[k]*m[k]+m[V]*m[V]);0===r&&(r=Hp),m[R]=m[R]/r,m[k]=m[k]/r,m[V]=m[V]/r,F[B+R]=m[R],F[B+k]=m[k],F[B+V]=m[V]}return new vg(F)},ah=function(V,S,d,b){if(d||(d=V.createTexture()),S){var c=V.TEXTURE_2D,F=V.REPEAT,M=V.CLAMP_TO_EDGE,i=V.TEXTURE_MIN_FILTER;b=b||Ik;var f=b.minFilter||b.filter||V.LINEAR,x=b.magFilter||b.filter||V.LINEAR;V.activeTexture(V.TEXTURE0),me(V,d),V.texImage2D(c,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,S),Wj(V,V.TEXTURE_MAG_FILTER,x);var X=S.naturalWidth||S.width,J=S.naturalHeight||S.height;ar.isPOT(X)&&ar.isPOT(J)&&!b.clampToEdge&&!S.clampToEdge?(Wj(V,V.TEXTURE_WRAP_S,F),Wj(V,V.TEXTURE_WRAP_T,F),Wj(V,i,f===V.NEAREST?V.NEAREST_MIPMAP_NEAREST:V.LINEAR_MIPMAP_LINEAR),b.mipmapMaxLevel!==r&&Wj(V,V.TEXTURE_MAX_LEVEL,b.mipmapMaxLevel),V.generateMipmap(c)):(Wj(V,V.TEXTURE_WRAP_S,M),Wj(V,V.TEXTURE_WRAP_T,M),Wj(V,i,f)),me(V,w)}return d},Ym=function(X,o){var U=new Uint8Array(4);return o=o||X.createTexture(),X.activeTexture(X.TEXTURE0),me(X,o),Wj(X,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texImage2D(X.TEXTURE_2D,0,X.RGBA,1,1,0,X.RGBA,X.UNSIGNED_BYTE,U),o},Mg=function(q,I){var m=new Uint8Array(4);return I=I||q.createTexture(),q.activeTexture(q.TEXTURE0),q.bindTexture(q.TEXTURE_CUBE_MAP,I),q.texParameteri(q.TEXTURE_CUBE_MAP,q.TEXTURE_MAG_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_CUBE_MAP,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,m),q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,m),q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,m),q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,m),q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,m),q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,m),I},Fd=function(X){X._26I&&X._prg&&(X._26I.deleteProgram(X._prg),X._prg=w)},Kd=function(H,b,E,m){var R=H.createShader(E);return H.shaderSource(R,m),H.compileShader(R),H.attachShader(b,R),R},Qj=function(k){return k.createBuffer()},me=function(d,S){d.bindTexture(d.TEXTURE_2D,S||d._emptyTexture)},Wj=function(M,Y,N){M.texParameteri(M.TEXTURE_2D,Y,N)},mg=function(a,g){var W=Qp.for(a).directState();W.polygonOffset.enabled=!0,W.polygonOffset.value=g},Gn=function(A){var P=Qp.for(A).directState();P.polygonOffset.enabled=!1},fp=function(W,x){if(x){var u=Qp.for(W).directState();u.color.clear=er(x)}},dn=function(A){var y=Qp.for(A),i=y.directUniforms(),u=y.directAttribs();i.uFix=!0,u.aNormal=!1},Eh=function(N){var o=Qp.for(N),V=o.directUniforms();o.directAttribs(),V.uFix=!1},zr=function(x,g,B,z,b,C,A,r){var k=Qp.for(x),Y=k.directState(),c=k.directUniforms();x._picking||(B?(c.uBlend=!0,c.uBlendColor=B):c.uBlend=!1,c.uLight=z==w?!0:z,wn(b)&&1!==b&&(c.uPartOpacity=b),c.uReverseFlip=C==w?!1:C,c.uFixPickReverseColor=A||Vr),Y.cullFace.enabled=r?!0:!1},_b=function(C){if(!C._picking){var U=Qp.for(C),N=U.directUniforms();N.uPartOpacity=1}},Ec=function(){var a=[0,0,1,1];return function(j,m,S,h,_,y,Z,L,V){var N=Qp.for(j),W=N.directUniforms(),I=N.directAttribs();return S?(W.uTexture=!0,W.uDiscardSelectable=Of(h)?h:!0,I.aUv=Xp(j,_,y,w,2),V?(W.uBlendTexture=!0,W.uBlendSampler=V):(W.uBlendTexture=!1,W.uBlendSampler=j._emptyBlendTexture),W.uSampler=S,Z?(a[0]=Z[0],a[1]=Z[1]):(a[0]=0,a[1]=0),L?(a[2]=L[0],a[3]=L[1]):(a[2]=1,a[3]=1),W.uOffsetScale=a,void 0):(W.uSampler=j._emptyTexture,W.uBlendSampler=j._emptyBlendTexture,void 0)}}(),xj=function(r,f,I){var i=Qp.for(r),O=i.directUniforms(),X=i.directAttribs();r.activeTexture(r.TEXTURE0),me(r,w),r.activeTexture(r.TEXTURE1),me(r,w),I&&(X.aUv=!1,O.uTexture=!1,O.uSampler=r._emptyTexture,O.uBlendTexture=!1,O.uBlendSampler=r._emptyBlendTexture)},Bo=function(W,r,y,l,d,T){var V=Qp.for(W),x=V.directUniforms(),J=V.directAttribs();!y||qm||rb||W.lineWidth(y),l&&!W._picking&&(x.uFixPickReverseColor=l),d&&(J.aPosition=Xp(W,d,T,w))},rp=function(I,N,e,M){od&&(M=I[od]),I.drawArrays(M==w?I.TRIANGLES:M,N,e);var o=I._renderInfo;o&&(o.calls++,o.vertices+=e,(M==w||M===I.TRIANGLES)&&(o.faces+=e/3),M===I.LINES&&(o.lines+=e/2),M===I.POINTS&&(o.points+=e))
},kn=function(l,g,U,r,D){od&&(r=l[od]),l.drawElements(r==w?l.TRIANGLES:r,U,D==w?l.UNSIGNED_SHORT:D,g==w?0:2*g);var X=l._renderInfo;X&&(X.calls++,X.vertices+=U,(r==w||r===l.TRIANGLES)&&(X.faces+=U/3),r===l.LINES&&(X.lines+=U/2),r===l.POINTS&&(X.points+=U))},Cb=function(s,g,d){var P=s.ARRAY_BUFFER;return s.bindBuffer(P,g),d&&s.bufferData(P,d,s.STATIC_DRAW),g},Xp=function(h,Z,j,n,V){return j?sb(h,h.ARRAY_BUFFER,Z,j):Cb(h,Z,j,n,V)},Ao=function(G,N,L){var h=G.ELEMENT_ARRAY_BUFFER;G.bindBuffer(h,N),L&&G.bufferData(h,L,G.STATIC_DRAW)},tp=function(z,t,o){sb(z,z.ELEMENT_ARRAY_BUFFER,t,o)},sb=function(Y,S,G,v){var q=v._bufId;q||(q=v._bufId=s.Math.generateIncreasingID());var G,D=Y._bufPool;return(G=D[q])&&G._buf?Y.bindBuffer(S,G._buf):(G=D[q]={_buf:Qj(Y)},Y.bindBuffer(S,G._buf),Y.bufferData(S,v,Y.STATIC_DRAW)),G._fid=Y._renderInfo.frame,G._buf},Ke=function(k,h){h!=w&&h>=0&&k.enableVertexAttribArray(h)},vm=function(V,E){E!=w&&E>=0&&V.disableVertexAttribArray(E)},hk=function(S,e){var o=S.getGL();S._prg;var d=Qp.for(o),n=d.directUniforms();d.directAttribs(),S._7O=S._8O.pop(),e&&(n.uMVMatrix=S._7O,S._6O=e,n.uNMatrix=e)},Or=function(R,C){return C||(C=Vd()),No(C,R),Ro(C),Eq(C),C},Ob=function(K,h){var Q=K.getGL(),v=K._7O,L=Qp.for(Q),A=L.directUniforms();h?(K._8O.push(Zo(v)),A.uMMatrix=h,Kc(v,v,h),K._7O=v):A.uMMatrix=Sp,A.uMVMatrix=v,A.uNMatrix=Or(v,K._6O)},Tn={body:0,label:1,label2:2,note:3,note2:4,symbol:5},uq=10,vd=function(j,d,U,t,H,u){var q;if(U){var g=t._pickId;g||(g=t._pickId=d._pickIdUsed,d._pickIdUsed+=uq);var m,s=Tn[H];if(null!=s)m=g+s;else{var C=t._pickExtraPartMap;C||(C=t._pickExtraPartMap={}),(m=C[H])||(m=C[H]=d._pickIdUsed++)}d[m]||(d[m]={data:t,part:H}),q=nh(m)}else q=$g;if(!u){var Y=Qp.for(j),V=Y.directUniforms();V.uFixPickReverseColor=q}return q},Xc=function(i,x,w){"target"!==w&&(w="source");var A="target"===w?x.getTargetAgent():x.getSourceAgent(),f="edge."+w+".";if(Km(A)){var h=x.s(f+"anchor.x"),P=x.s(f+"anchor.elevation"),d=x.s(f+"anchor.y"),b=ub(A,i.getMat(A)),B=A.getAnchor3d();return yb([(h===r?.5:h)-B.x,(P===r?.5:P)-B.y,(d===r?.5:d)-B.z],b)}var t=x.s(f+"index"),K=i.getData3dUI(A);if(!K.info||!K.info.list)return!1;if(t>=0){var e,k,l,c,p,Z=K.info._lastPointsSegments,F=Z.points,X=Z.segments,g=-1,E=-1;for(l=0,c=X?X.length:F.length;c>l;l++){if(k=X?X.get(l):1,3===k)p=2;else if(4===k)p=3;else{if(5===k)continue;p=1}if(g+=p,E++,E===t){e=F.get(g);break}}return e||(e=F.get(F.length-1)),[e.x,e.e||0,e.y]}var N=x.s(f+"percent")||.5;if(N=Math.max(0,Math.min(N,1)),!K||!K.getCache)return!1;var H=K.getCache(),c=H[H.length-1].length,Z=i.getLineOffset(A,N*c),y=Z.point;return[y.x,y.y,y.z]},kc=function(){var Q={center:function(e,k,l,i,T){var K=-k[1]/2,d={x:-k[0]/2,y:K,width:k[0],height:k[1]},A=Cm(e,d,l);return[A.x+i,-A.y-T,Op()]},front:function(F,K,b,I,m){var h=-K[1]/2,u={x:-K[0]/2,y:h,width:K[0],height:K[1]},v=Cm(F,u,b);return[v.x+I,-v.y-m,K[2]/2+Op()]},back:function(G,v,s,C,P){var k=-v[0]/2,u=-v[1]/2,a={x:k,y:u,width:v[0],height:v[1]},x=Cm(G,a,s);return[-x.x-C,-x.y-P,-v[2]/2-Op()]},left:function(O,G,S,T,Y){var g=-G[1]/2,e={x:-G[2]/2,y:g,width:G[2],height:G[1]},b=Cm(O,e,S);return[-G[0]/2-Op(),-b.y-Y,b.x+T]},right:function(T,g,l,w,x){var t=-g[2]/2,Q=-g[1]/2,q={x:t,y:Q,width:g[2],height:g[1]},R=Cm(T,q,l);return[g[0]/2+Op(),-R.y-x,-R.x-w]},top:function(Q,J,x,f,h){var m={x:-J[0]/2,y:-J[2]/2,width:J[0],height:J[2]},e=Cm(Q,m,x);return[e.x+f,J[1]/2+Op(),e.y+h]},bottom:function(V,J,z,K,a){var M=-J[2]/2,L={x:-J[0]/2,y:M,width:J[0],height:J[2]},D=Cm(V,L,z);return[D.x+K,-J[1]/2-Op(),-D.y-a]}};return function(o,x,z,Y,i,f){return Q[Y](o,x,z,i||0,f||0)}}(),Ek=function(k,Q,R,c,m,r,N,S,I,h){if(m&&(Q[0]+=m[0],Q[1]+=m[1],Q[2]+=m[2]),ze(k,R),S){var b=Vd();if(Ye(b,I,h),yb(Q,b),ze(k,Q),k.auto=S,k.pos=yb([0,0,0],k),r){var z=k.mat2=Vd();Ye(z,r,N)}}else Ye(k,I,h),ze(k,Q),c===vq?dl(k,-T):c===hn?dl(k,T):c===rd?vi(k,-T):c===fi?vi(k,T):c===bf&&dl(k,g),Ye(k,r,N);return k},Zj=function(v,i){var R=i.auto,T=i.mat2,x=v.gv;if(R){var _,d=Vd(),M=[0,0,0,0];_="string"==typeof R?[R.indexOf("x")<0?x._eye[0]:x._center[0],R.indexOf("y")<0?x._eye[1]:x._center[1],R.indexOf("z")<0?x._eye[2]:x._center[2]]:x._eye,rr(M,eg(Vd(),_,x._center,x._up)),Bs(d,fs(M,M),i.pos),T&&Kc(d,d,T),Ob(x,d)}else Ob(x,i)},Fp=function(Z,d,a,g,q){var A=Z.s,v=Z.gv,N=v.getGL(),b=v._prg,E=v._buffer,O=v._1O,l=Qp.for(N),f=l.directAttribs();ah(N,Gr,O),Zj(Z,a),zr(N,b,A(d+".blend"),A(d+".light"),A(d+".opacity"),A(d+".reverse.flip"),A(d+".reverse.color"),A(d+".reverse.cull")),Ec(N,b,O,q,E.uv,Em),f.aPosition=Xp(N,E.vs,g,w),f.aNormal=Xp(N,E.ns,Tg,w),tp(N,E.is,hl),kn(N,0,hl.length),xj(N,b,O),_b(N,b),hk(v)},hb=function(r,E,G){var e=r.gv,u=r.data,x=r[E]={blend:e.getBodyColor(u)||e.getFaceBlend(u,E),light:e.getFaceLight(u,E),color:e.getFaceColor(u,E),opacity:e.getFaceOpacity(u,E),transparent:e.getFaceTransparent(u,E),reverseFlip:e.getFaceReverseFlip(u,E),reverseColor:e.getFaceReverseColor(u,E),reverseCull:e.getFaceReverseCull(u,E),texture:e.getFaceImage(u,E),blendTexture:e.getFaceBlendImage(u,E),discardSelectable:e.getFaceDiscardSelectable(u,E)};if("csg"!==E){x.uv=e.getFaceUv(u,E)||G&&G[E+"Uv"],x.uvScale=e.getFaceUvScale(u,E)||G&&G[E+"UvScale"],x.uvOffset=e.getFaceUvOffset(u,E)||G&&G[E+"UvOffset"];var c=e.getFaceMat(u,E);if(c){var d=ub(u,c);u.appendAnchorMatrix3d(d),x.mat=d}}return x},Fj=function(Q,s,a,U,i){var E=Q[U];if(E){if(!i(E.transparent))return;var L=Q.data,k=Q.gv,n=k._buffer,B=k.getTexture(E.texture,L,U),x=k.getTexture(E.blendTexture,L),N=Qp.for(s),R=N.directUniforms(),I=N.directAttribs();Ec(s,a,B,E.discardSelectable,n.uv,E.tuv,E.uvOffset,E.uvScale,x),zr(s,a,E.blend,E.light,E.opacity,E.reverseFlip,E.reverseColor,E.reverseCull),E.cs&&!k._batchColorDisabled?(R.uBatchColor=!0,I.aBatchColor=Xp(s,n.batchColor,E.cs,a.aBatchColor,4)):R.uDiffuse=E.color||V["color.empty"],I.aPosition=Xp(s,n.vs,E.vs,w),I.aNormal=Xp(s,n.ns,E.ns,w),rp(s,0,E.vs.length/3),E.cs&&!k._batchColorDisabled&&(R.uBatchColor=!1,vm(s,a.aBatchColor)),_b(s,a),xj(s,a,B)}},Zi=function(k,H,A){wd(k)?k.forEach(function(e){Zi(e,H,A)}):ap(k)?Zi(el(H,k),H,A):np(k)?k.shape3d?Zi(k.shape3d,H,A):A.push(k):A.push(k)},Ch=function(w,o,q,h,x,J){var e,f,c,i,N,m,_,K,A,H,V,z=[h-o,x-q],d=w?w.length:0;for(c=0;d>c;c++){for(i=2,e=w[c],N=e[0],m=e[1];i+1<e.length;){if(_=e[i],K=e[i+1],f=yn(o,q,h,x,N,m,_,K,!0)){A=[_-N,K-m],H=qd(A),A[0]/=H,A[1]/=H,H=mj(z,A),H=H>0?J:-J,V=[A[0]*H,A[1]*H];break}N=_,m=K,i+=2}if(V)break}if(V)for(h=o+V[0],x=q+V[1],c=0;d>c;c++)for(i=2,e=w[c],N=e[0],m=e[1];i+1<e.length;){if(_=e[i],K=e[i+1],f=yn(o,q,h,x,N,m,_,K,!0))return[0,0];N=_,m=K,i+=2}return V?V:[h-o,x-q]},Gk=function(q){return"nearest"===q?Mo.NEAREST:"linear"===q?Mo.LINEAR:q},Lq=s.graph3d={},dd=function(z,Z,X){Ap(D+".graph3d."+z,Z,X)},eb="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Cj="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";xl(Y,{setBatchInfo:function(b,P){Cs[b]=P},getBatchInfo:function(R){return Cs[R]},getBatchInfoMap:function(){return Cs},setBatchInfoMap:function(T){Cs=T}},!0);var aj=[1,1,1],Kg=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ve=[1,0,0,0,0,1,0,1,1,1,1,0],cf=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],kj=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],dj=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],tf=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Mm=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ns=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],dr=function(w,h){var o=w._40Q;o.each(function(D){D.ivBatch(h)})},Kl=function(o,f,D){var A=D._id,l=f[A];if(l){var C=l.batch,p=o[C],s=p.ds,V=l.index;if(p.invalidate=!0,delete f[A],s.splice(V,1),Nf(s))return delete o[C],void 0;for(var X=l.begin,M=l.size,G=3*X,h=3*M,E=4*X,I=4*M,k=p.vs,b=p.ps,K=p.uv,Z=p.cs,t=p.bs,R=p.rs,w=p.ns,Y=p.ls;V<s.length;V++)l=f[s[V]._id],l.index--,l.begin-=M;k.splice(G,h),b.splice(E,I),K&&K.splice(2*X,2*M),Z&&Z.splice(E,I),t&&t.splice(G,h),R&&R.splice(X,M),w&&w.splice(G,h),Y&&Y.splice(X,M)}},pr=function(A,Y,i,U,L){if(!U)return w;var x=Y[U];if(!x){var C=L.getBatchInfo(U)||Ik,l=C.image?[]:w;x=Y[U]={vs:[],ns:[],uv:l,cs:l?w:C.color?w:[],bs:C.blend?[]:w,ps:[],rs:C.brightness?[]:w,ds:[]}}return x.invalidate=!0,A[i._id]={index:x.ds.length,begin:x.vs.length/3,batch:U},x.ds.push(i),x},sf=function(z,Y){return Y!=w&&1!==Y?[z[0]*Y,z[1]*Y,z[2]*Y,z[3]]:z},Ql=function(m){var f=m.shapeModel;f||(f=el(m)),f&&(f._ctlineModel=[],f._lineModel=r)},$o=function(){var B;return function(U,J,N){var y=U.getData3dUI(J),O=y.shapeModel;if(O||(O=el(y)),O||!y.shapeName){var E,W=J.s("wf.combineTriangle");if(N.geometry){if(!O&&(J instanceof s.Node&&!(J instanceof s.Shape)?(B||(B={vs:oq,is:of,uv:ok}),O=B):O=[y.left,y.front,y.right,y.back,y.top,y.bottom],!O))return r;if(W){var c=J.s("wf.normEpsilon");isNaN(c)&&(c=2),W=0|Math.min(3,Math.max(1,isNaN(W)?1:W)),E=gq[W-1](O,y,180/(Math.PI*c))}else E=vh(O,y);if(!E||0===E.length)return}else E=N.short?om:bq;var R=U.getBrightness(J),e=J.s("bloom"),L=J.s("3d.reflectable"),x=er(N.color||"white"),$=x[3]<1,A=Math.ceil(N.width)||1,n=($?"T":"O")+(e?"_1":"_0")+(L?"1_":"0_")+A,w=J.getRenderLayer(),p=U._40Q.get(w),b=p.wireframeIndexMap,M=p.wireframeModelMap,I=M[n];I||(I=M[n]={vs:[],cs:[],ps:[],ds:[],T:$,B:e,reflectable:!!L,W:A}),I.invalidate=!0;var l=I.vs,k=I.cs,f=I.ds,V=b[J._id]={index:f.length,begin:l.length/3,batch:n};f.push(J);var _=y.mat;J instanceof s.Edge||!(!_||!N.geometry&&J instanceof s.Shape)||(_=ub(J,N.mat),J.appendAnchorMatrix3d(_)),Jb(l,_,E);var j=V.size=l.length/3-V.begin;xh(k,sf(x,R),j)}}}(),ro=function(c,R,D,g,X,y,f,T,V){var B=c.getBrightness(R);B==w&&(B=1);var A=sf(er(g),B),W=A[3]<1;y=Math.ceil(y)||1;var m=(W?"T":"O")+y;if(f){var x=f[0],L=(f[1]||x)+x;m+="-"+x+"-"+L,V&&(m+="-"+Dl(V)+"-"+B,V=sf(er(V),B))}var l=R.getRenderLayer(),P=c._40Q.get(l),F=P.polylineIndexMap,b=P.polylineModelMap,$=b[m];$||($=b[m]={vs:[],cs:[],ps:[],ds:[],ls:f?[]:w,T:W,W:y},f&&($.D=x,$.G=L,$.A=V)),$.invalidate=!0;var J,Q=$.vs,j=$.cs,r=$.ds,S=$.ls,u=F[R._id]={index:r.length,begin:Q.length/3,batch:m};r.push(R),Ho(Q,D);var e,N=u.size=Q.length/3-u.begin,d=D.length,G=0,I=[];if(f||X)for(J=0;d>J;J+=6)e=qd([D[J],D[J+1],D[J+2]],[D[J+3],D[J+4],D[J+5]]),I.push(e),G+=e;if(G&&X){var t,s=sf(er(X),B),p=[s[0]-A[0],s[1]-A[1],s[2]-A[2],s[3]-A[3]],E=0;for(J=0;d>J;J+=6)t=E/G,xh(j,[A[0]+p[0]*t,A[1]+p[1]*t,A[2]+p[2]*t,A[3]+p[3]*t],1),E+=I[J/6],t=E/G,xh(j,[A[0]+p[0]*t,A[1]+p[1]*t,A[2]+p[2]*t,A[3]+p[3]*t],1)}else xh(j,A,N);if(f)for(E=T||0,J=0;d>J;J+=6)S.push(E),E+=I[J/6],S.push(E)},kg=function(N,t,P){if(t){var J=4*t.begin,I=P[t.batch].ps;if(I[J]!==N[0]||I[J+1]!==N[1]||I[J+2]!==N[2]||I[J+3]!==N[3]){for(var w=0;w<t.size;w++)I[J++]=N[0],I[J++]=N[1],I[J++]=N[2],I[J++]=N[3];I._invalidateThisFrame=!0}}},Lm=function(F,T){var $=T+["32"],o=F[T],N=F[$];o?N&&N.length===o.length?(N.set(o),N._bufId=null):F[$]=new vg(o):delete F[$]},Ih=function(M,O,$,I,p,F,a,u,n){if(wd($))$.forEach(function(P){Ih(M,O,P,I,p,F,a,u,n)});else if(ap($))Ih(M,O,el(I,$),I,p,F,a,u,n);else if(np($)){var G,i=Pb($.mat,O,M),s=Pb($.s3,O,M),g=Pb($.t3,O,M),y=Pb($.r3,O,M);if((s||y||g||i)&&(G=cq(i,s,y,Pb($.rotationMode,O,M),g),F.push(G)),$.shape3d)Ih(M,O,$.shape3d,I,p,F,a,u,$);else{var E=I.s;n=n||Ik;var L=F[0],R=F.length,X=E("shape3d.color",$.color,n.color);if(p||(p=E("shape3d.blend",$.blend,n.blend)),R>1){L=Zo(L);for(var t=1;R>t;t++)Kc(L,L,F[t])}$.vs&&E(jf,$.visible,n.visible)&&ab(L,a,u,$.vs,$.uv,$.is,p,X),$.top_vs&&E(Te,$.topVisible,n.topVisible)&&ab(L,a,u,$.top_vs,$.top_uv,$.top_is,p,E("shape3d.top.color",$.topColor,n.topColor)||X),$.bottom_vs&&E(qh,$.bottomVisible,n.bottomVisible)&&ab(L,a,u,$.bottom_vs,$.bottom_uv,$.bottom_is,p,E("shape3d.bottom.color",$.bottomColor,n.bottomColor)||X),$.from_vs&&E(td,$.fromVisible,n.fromVisible)&&ab(L,a,u,$.from_vs,$.from_uv,$.from_is,p,E("shape3d.from.color",$.fromColor,n.fromColor)||X),$.to_vs&&E(Pf,$.toVisible,n.toVisible)&&ab(L,a,u,$.to_vs,$.to_uv,$.to_is,p,E("shape3d.to.color",$.toColor,n.toColor)||X)}G&&F.pop()}},ab=function(R,Q,F,l,N,g,X,O){var s,u=Q.cs,S=Q.uv,L=Q.bs;if(g){s=g.length;for(var p=0;s>p;p++){var V=g[p];Jb(F,R,[l[3*V],l[3*V+1],l[3*V+2]]),S&&Ho(S,[N[2*V],N[2*V+1]])}}else s=l.length/3,Jb(F,R,l),S&&Ho(S,N);u&&xh(u,O,s),L&&(X?Rj(L,X,s):Ho(L,aj,s))},tb=function(o,D,N,V){var E=[];V?Ih(o.gv,o.data,V,o,o.getBodyColor(),[D],N,E):(Nc(o,vq,D,N,E),Nc(o,hn,D,N,E),Nc(o,_j,D,N,E),Nc(o,bf,D,N,E),Nc(o,rd,D,N,E),Nc(o,fi,D,N,E),Nc(o,"csg",D,N,E)),E.length&&(Ho(N.vs,E),Ho(N.ns,Wk(E)))},Nc=function(J,A,y,S,N){var s=J[A];if(s){var L=s.tuv;if(L){var _,U,E,Y,p=s.uvScale,M=s.uvOffset;if(p)for(_=L.length,U=p[0],E=p[1],Y=0;_>Y;Y+=2)L[Y]*=U,L[Y+1]*=E;if(M)for(_=L.length,U=M[0],E=M[1],Y=0;_>Y;Y+=2)L[Y]+=U,L[Y+1]+=E}ab(y,S,N,s.vs,L,w,s.blend,s.color)}},zq=function(N,E,f,P,r,T,Y,g){var m,I=f.cs,M=f.uv,X=f.bs;if(N.getFaceVisible(E,T)){var t=N.getFaceMat(E,T);if(t&&(r=ub(E,t)),Jb(Y,r,g),I&&xh(I,N.getFaceColor(E,T),6),M){var $=N.getFaceUv(E,T)||P[T+"Uv"],W=N.getFaceUvScale(E,T)||P[T+"UvScale"],z=N.getFaceUvOffset(E,T)||P[T+"UvOffset"];$=$?[$[6],$[7],$[0],$[1],$[2],$[3],$[2],$[3],$[4],$[5],$[6],$[7]]:ve;var B=$[0],C=$[1],L=$[2],J=$[3],j=$[4],q=$[5],h=$[6],y=$[7],D=$[8],u=$[9],H=$[10],F=$[11];if(W){var b=W[0],Q=W[1];B*=b,C*=Q,L*=b,J*=Q,j*=b,q*=Q,h*=b,y*=Q,D*=b,u*=Q,H*=b,F*=Q}if(z){var n=z[0],G=z[1];B+=n,C+=G,L+=n,J+=G,j+=n,q+=G,h+=n,y+=G,D+=n,u+=G,H+=n,F+=G}M.push(B,C,L,J,j,q,h,y,D,u,H,F)}X&&(m=N.getBodyColor(E)||N.getFaceBlend(E,T),m?Rj(X,m,6):Ho(X,aj,6))}},kr=function(t,K,Q,C){var Q=t._picking?t.pickColorMap:null,p=t.getGL(),R=t._prg,M=t._buffer;if(!Ae(K)){Ob(t,Kg),dn(p,R);for(var T in K){var H=K[T];if(!(C&&!H.T||!C&&H.T||t.isReflecting(p)&&H.reflectable===!1)){H.invalidate?(H.invalidate=!1,Lm(H,"vs"),Lm(H,"cs"),Lm(H,"ls"),Lm(H,"ps")):Q&&H.ps&&H.ps._invalidateThisFrame&&(H.ps._invalidateThisFrame=!1,Lm(H,"ps"));var O=H.vs32,$=Q?H.ps32:H.cs32;Bo(p,R,H.W,w,M.vs,O);var s=Qp.for(p),x=s.directUniforms(),U=s.directAttribs(),i=H.D,b=!t._dashDisabled&&i;x.uAlphaTest=V.alphaTest,p._blooming&&!H.B&&(x.blackout=!0),b&&(x.uDash=!0,x.uDashDistance=i,x.uDashGapDistance=H.G,x.uDiffuse=H.A||V["color.empty"],U.aLineDistance=Xp(p,M.lineDistance,H.ls32,w,1));var l=!t._batchColorDisabled;l&&$.length?(x.uBatchColor=!0,U.aBatchColor=Xp(p,M.batchColor,$,w,4)):(x.uBatchColor=!1,U.aBatchColor=!1),Ec(p),rp(p,0,O.length/3,p.LINES),xj(p),l&&(x.uBatchColor=!1,U.aBatchColor=!1),b&&(x.uDash=!1,U.aLineDistance=!1),p._blooming&&!H.B&&(x.blackout=!1)}}Eh(p,R),hk(t)}},Dp=function(m){m.invalidate=!1,Lm(m,"vs"),Lm(m,"ns"),Lm(m,"cs"),Lm(m,"rs"),Lm(m,"ps"),Lm(m,"bs"),Lm(m,"uv")},Zq=function(i,W,h,B,P){var I,v,G,E,U,Q,S,R,Y,z,K,h=i._picking?i.pickColorMap:null,k=i.getGL(),L=i._prg,n=Qp.for(k),F=n.directUniforms(),A=n.directAttribs(),T=i._buffer;if(!Ae(W)&&!i.drawFilter){Ob(i,Kg);for(I in W)if(v=i.getBatchInfo(I)||Ik,v.visible!==!1&&!(B&&!v.transparent||!B&&v.transparent||i.isReflecting(k)&&v.reflectable===!1)){var b=v.renderLayerMask;if(b==w&&(b=Xe),P==w&&(P=Xe),Vf(P,b)&&(G=W[I],h||!v.transparentMask)){var m=B&&v.autoSort===!0&&(i._33Q||G.invalidate);if(G.invalidate?Dp(G):h&&G.ps&&G.ps._invalidateThisFrame&&(G.ps._invalidateThisFrame=!1,Lm(G,"ps")),U=G.vs32,Q=h?G.ps32:G.cs32,Y=G.uv32,S=G.bs32,R=G.rs32,K=U.length/3,m){var _=Ei(U,i.getEye(),i);_?(G.is=_.is,G.elementTypeUint=_.useUint32):(G.is=null,G.elementTypeUint=null)}if(K){E=v.light,z=i.getTexture(v.image),zr(k,L,w,v.light,v.opacity,v.reverseFlip,v.reverseColor,v.reverseCull),Q?i._batchColorDisabled?(F.uBatchColor=!1,A.aBatchColor=!1):(F.uBatchColor=!0,A.aBatchColor=Xp(k,T.batchColor,Q,w,4)):(F.uBatchColor=!1,F.uDiffuse=v.color||V["color.empty"]);
var j=v.alphaTest;F.uAlphaTest=j===r?V.alphaTest:j,F.shadowReceive=!h&&v.shadowReceive!==!1,k._blooming&&!v.bloom&&(F.blackout=!0),v.envmap!==r?(F.uUseEnvMap=!0,F.uReflectivity=v.envmap):(F.uUseEnvMap=!1,F.uReflectivity=0);var o=S&&!i._batchBlendDisabled;o&&(F.uBatchBlend=!0,A.aBatchBlend=Xp(k,T.batchBlend,S,w));var x=R&&!i._batchBrightnessDisabled;x&&(F.uBatchBrightness=!0,A.aBatchBrightness=Xp(k,T.batchBrightness,R,w,1)),Y?Ec(k,L,z,v.discardSelectable,T.uv,Y,v.uvOffset,v.uvScale):Ec(k),A.aPosition=Xp(k,T.vs,U,w),A.aNormal=Xp(k,T.ns,G.ns32,w),G.is?(Ao(k,T.is,G.is),kn(k,0,K,null,G.elementTypeUint?k.UNSIGNED_INT:null)):rp(k,0,K),Y?xj(k,L,z):xj(k),Q&&!i._batchColorDisabled&&(F.uBatchColor=!1,A.aBatchColor=!1),o&&(F.uBatchBlend=!1,A.aBatchBlend=!1),x&&(F.uBatchBrightness=!1,A.aBatchBrightness=!1),k._blooming&&!v.bloom&&(F.blackout=!1),_b(k,L)}}}hk(i)}},Ei=function(S,M,e){var U=S.length/3,p=U>65535,v=e._glCapabilities.elementTypeUint&&p;if(!v&&p)return null;for(var H=new Array(U),I=U/3,c=new Array(I),A=0;I>A;A++)c[A]=A;c.sort(function(w,r){var q=9*w,B=[(S[q]+S[q+3]+2*S[q+6])/4,(S[q+1]+S[q+4]+2*S[q+7])/4,(S[q+2]+S[q+5]+2*S[q+8])/4];q=9*r;var c=[(S[q]+S[q+3]+2*S[q+6])/4,(S[q+1]+S[q+4]+2*S[q+7])/4,(S[q+2]+S[q+5]+2*S[q+8])/4],J=qd(M,B)-qd(M,c);return J>0?-1:0>J?1:0});for(var A=0;I>A;A++){var W=3*A,u=3*c[A];H[W]=u,H[W+1]=u+1,H[W+2]=u+2}return{useUint32:v,is:v?new Uint32Array(H):new jj(H)}},Bq={obj:function(X,O){var r={mat:X.mat,s3:X.s3,r3:X.r3,rotationMode:X.rotationMode,t3:X.t3,cube:X.cube==w?!0:X.cube,center:X.center==w?!0:X.center,ignoreMtls:X.ignoreMtls,ignoreTransparent:X.ignoreTransparent,ignoreColor:X.ignoreColor,ignoreImage:X.ignoreImage,ignoreNormal:X.ignoreNormal,prefix:X.prefix,flipY:X.flipY,flipFace:X.flipFace,reverseFlipMtls:X.reverseFlipMtls,finishFunc:function(j,o){if(j){var o=[];for(var f in j){var P=j[f];o.rawS3=P.rawS3,P.center&&(o.center=P.center),o.push(P),X.eachModel&&X.eachModel(f,P)}o.json=X,O(o)}else O()}};Y.loadObj(X.obj,X.mtl,r)},bin:function(s,h){var U={finishFunc:function(c){c?h(c):h()}};Y.loadBin(s.url,U)}};Y.getModelTypeHandlers=function(){return Bq},Y.setModelTypeHandler=function(W,j){Bq[W]=j},Y.getModelTypeHandler=function(J){return Bq[J]},Y.handleModelLoaded=function(){},Y.handleUnfoundModel=function(){};var sj=w,cg=w,dh=function(B){sj&&!B._loadingModelView_&&(cg||(cg={}),cg[B._loadingModelView_=Nb()]=B)},zi=function(C,j){sj||(sj={});var l=sj[C];if(l){if(l.url===j)return;l.request.onload=je,l.request.onerror=je}if(j.indexOf(".bin")===j.length-4)return Zh(C,{modelType:"bin",url:j},j);if(j=Y.beforeLoadURL(j),j.data){var V=Y.parse(j.data);Zh(C,V,j)}else{var f=new cd;sj[C]={request:f,url:j},f.onload=function(){if(200===this.status||0===this.status){delete sj[C];var r=Y.parse(f.getResponseText());Zh(C,r,j)}else Hq(C,Y.handleUnfoundModel(C,j)||w)},f.onerror=function(){Hq(C,Y.handleUnfoundModel(C,j)||w)};var a={};a.url=encodeURI(j),a.sync=!1,f.send(a)}},Zh=function(V,D,t){var z=D.modelType;if(!z)return Hq(V,D),Y.handleModelLoaded(V,D),void 0;var U=Y.getModelTypeHandler(z);if(U){if(sj||(sj={}),sj[V])return;sj[V]=!0;var I=function(o){o?(Hq(V,o),Y.handleModelLoaded(V,o)):Hq(V,Y.handleUnfoundModel(V,t,D)||w)};U(D,I)}else Hq(V,Y.handleUnfoundModel(V,t,D)||w)},Hq=function(U,z){if(delete sj[U],ap(z)&&Hg.test(z))return zi(U,z),void 0;if(sg[U]=z,Ae(sj)&&(sj=w,cg)){for(var K in cg){var R=cg[K];R.invalidateAll&&R.invalidateAll(r,"modelLoaded",U),R.redraw&&R.redraw(),R.iv(),delete R._loadingModelView_}cg=w}if(z&&cg)for(var K in cg){var R=cg[K];R.invalidateAll&&R.invalidateAll(r,"modelLoading",U),R.redraw&&R.redraw(),R.iv()}},Em=new vg([0,0,0,1,1,1,1,0]),Tg=new vg([0,0,1,0,0,1,0,0,1,0,0,1]),hl=new jj([0,1,2,2,3,0]),oq=new vg([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),of=new jj([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ok=new vg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),jd=Wk(oq,of),Qk=(new vg([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new jj([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[vq,_j,hn,bf,rd,fi]),bq=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],om=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],_l=function(k,r,h,Y,C,y,n){y=y||16,k=k||16,r=r||0,h=h||k;var D,a,i,u,t,d,V,v,W,K=.5,e=[],s=[],M=c/k,Q=g/y;for(D=0;y>D;D++)for(d=D+1,u=D*Q,W=d*Q,a=r;h>a;a++)V=a+1,i=a*M,v=V*M,e.push(K*O(u)*f(i),K*f(u),-K*O(u)*O(i),K*O(W)*f(v),K*f(W),-K*O(W)*O(v),K*O(u)*f(v),K*f(u),-K*O(u)*O(v),K*O(u)*f(i),K*f(u),-K*O(u)*O(i),K*O(W)*f(i),K*f(W),-K*O(W)*O(i),K*O(W)*f(v),K*f(W),-K*O(W)*O(v)),s.push(a/k,D/y,V/k,d/y,V/k,D/y,a/k,D/y,a/k,d/y,V/k,d/y);if(n){var o=[];for(D=0,t=e.length;t>D;D+=3)o.push(2*e[D],2*e[D+1],2*e[D+2])}if(Y){var S=[],A=[];for(i=r*M,D=0;y>D;D++)d=D+1,u=D*Q,W=d*Q,S.push(0,0,0,K*O(W)*f(i),K*f(W),-K*O(W)*O(i),K*O(u)*f(i),K*f(u),-K*O(u)*O(i)),A.push(0,.5,r/k,d/y,r/k,D/y)}if(C){var E=[],H=[];for(i=h*M,D=0;y>D;D++)d=D+1,u=D*Q,W=d*Q,E.push(0,0,0,K*O(u)*f(i),K*f(u),-K*O(u)*O(i),K*O(W)*f(i),K*f(W),-K*O(W)*O(i)),H.push(1,.5,h/k,D/y,h/k,d/y)}var z={vs:e,uv:s,from_vs:S,from_uv:A,to_vs:E,to_uv:H};return n&&(z.ns=o),z},wc=function(V,X,R){V=V||.17,X=X||12,R=R||18,0>V?V=0:V>.25&&(V=.25);var $,N,u,w,Z,x,n,j=.5,J=[],T=[],r=[],P=c/R,p=c/X,E=j-V;for(N=0;X>=N;N++)for(w=-g+N*p,x=f(w),Z=O(w),$=0;R>=$;$++)u=$*P,n=E+V*x,J.push(f(u)*n,Z*V,-O(u)*n),T.push($/R,1-N/X);for(N=0;X>N;N++){var C=N*(R+1),Y=(N+1)*(R+1);for($=0;R>$;$++)r.push(C+$,Y+$+1,Y+$,C+$,C+$+1,Y+$+1)}return{vs:J,uv:T,is:r}},_k=function(y,X,S,m,q,x,Y,n){Y=Y||12,y=y||18,X=X||0,S=S||y,x=x||.17,0>x?x=0:x>.25&&(x=.25);var e,D,F,h,s,Q,T,u,I,K,W=.5,J=[],L=[],k=c/y,E=c/Y,Z=W-x,w=n?[]:r;for(F=0;Y>F;F++)for(h=F+1,T=-g+F*E,u=-g+h*E,e=X;S>e;e++)D=e+1,s=e*k,Q=D*k,I=Z+x*f(T),K=Z+x*f(u),J.push(f(s)*I,O(T)*x,-O(s)*I,f(Q)*I,O(T)*x,-O(Q)*I,f(Q)*K,O(u)*x,-O(Q)*K,f(s)*I,O(T)*x,-O(s)*I,f(Q)*K,O(u)*x,-O(Q)*K,f(s)*K,O(u)*x,-O(s)*K),L.push(e/y,1-F/Y,D/y,1-F/Y,D/y,1-h/Y,e/y,1-F/Y,D/y,1-h/Y,e/y,1-h/Y),n&&w.push(f(s)*f(T),O(T),-O(s)*f(T),f(Q)*f(T),O(T),-O(Q)*f(T),f(Q)*f(u),O(u),-O(Q)*f(u),f(s)*f(T),O(T),-O(s)*f(T),f(Q)*f(u),O(u),-O(Q)*f(u),f(s)*f(u),O(u),-O(s)*f(u));if(m){var R=[],H=[];for(F=0;Y>F;F++)h=F+1,T=-g+F*E,u=-g+h*E,s=X*k,I=Z+x*f(T),K=Z+x*f(u),R.push(f(s)*I,O(T)*x,-O(s)*I,f(s)*K,O(u)*x,-O(s)*K,f(s)*Z,0,-O(s)*Z),H.push(.5+.5*f(T),.5-.5*O(T),.5+.5*f(u),.5-.5*O(u),.5,.5)}if(q){var A=[],b=[];for(F=0;Y>F;F++)h=F+1,T=-g+F*E,u=-g+h*E,s=S*k,I=Z+x*f(T),K=Z+x*f(u),A.push(f(s)*I,O(T)*x,-O(s)*I,f(s)*Z,0,-O(s)*Z,f(s)*K,O(u)*x,-O(s)*K),b.push(.5-.5*f(T),.5-.5*O(T),.5,.5,.5-.5*f(u),.5-.5*O(u))}var z={vs:J,uv:L,from_vs:R,from_uv:H,to_vs:A,to_uv:b};return n&&(z.ns=w),z},qr=function(C,$){for(var s,H,r,S=.5,m=16,A=[],e=[],Y=[],B=c/m,j=0;m>=j;j++)s=j*B,H=f(s)*S,r=O(s)*S,A.push(H,-S,r,H,S,r),e.push(1-j/m,1,1-j/m,0);for(j=0;m>j;j++)Y.push(2*j,2*j+1,2*j+3,2*j,2*j+3,2*j+2);if($){var z=[],L=[],N=[];for(z.push(0,-S,0),L.push(.5,.5),j=0;m>=j;j++)s=j*B,H=f(s),r=O(s),z.push(H*S,-S,-r*S),L.push(.5+.5*H,.5+.5*r);for(j=0;m>j;j++)N.push(0,j+2,j+1)}if(C){var Q=[],k=[],M=[];for(Q.push(0,S,0),k.push(.5,.5),j=0;m>=j;j++)s=j*B,H=f(s),r=O(s),Q.push(H*S,S,-r*S),k.push(.5+.5*H,.5-.5*r);for(j=0;m>j;j++)M.push(0,j+1,j+2)}return{vs:A,uv:e,is:Y,bottom_vs:z,bottom_uv:L,bottom_is:N,top_vs:Q,top_uv:k,top_is:M}},gn=function(V,o,l,W,k,e,M,X){V=V||12,o=o||0,l=l||V;for(var D,J,G,u,S,T,_,b,h,L=.5,t=[],g=[],x=c/V,r=o;l>r;r++)D=r+1,J=r*x,G=D*x,u=f(J)*L,S=O(J)*L,T=f(G)*L,_=O(G)*L,t.push(u,-L,-S,T,-L,-_,u,L,-S,T,-L,-_,T,L,-_,u,L,-S),g.push(r/V,1,D/V,1,r/V,0,D/V,1,D/V,0,r/V,0);if(X){var C=[];for(r=0,h=t.length;h>r;r+=3)C.push(2*t[r],0,2*t[r+2])}if(M){var i=[],y=[];for(r=o;l>r;r++)J=x*r,G=x*(r+1),u=f(J),S=O(J),T=f(G),_=O(G),i.push(u*L,-L,-S*L,0,-L,0,T*L,-L,-_*L),y.push(.5+.5*u,.5+.5*S,.5,.5,.5+.5*T,.5+.5*_)}if(e){var m=[],U=[];for(r=o;l>r;r++)J=x*r,G=x*(r+1),u=f(J),S=O(J),T=f(G),_=O(G),m.push(u*L,L,-S*L,T*L,L,-_*L,0,L,0),U.push(.5+.5*u,.5-.5*S,.5+.5*T,.5-.5*_,.5,.5)}if(W){var Z=[],w=[];J=x*o,u=f(J)*L,S=O(J)*L,b=o/V,Z.push(0,L,0,0,-L,0,u,-L,-S,u,-L,-S,u,L,-S,0,L,0),w.push(0,0,0,1,b,1,b,1,b,0,0,0)}if(k){var s=[],n=[];J=x*l,u=f(J)*L,S=O(J)*L,b=l/V,s.push(0,-L,0,0,L,0,u,L,-S,u,L,-S,u,-L,-S,0,-L,0),n.push(1,1,1,0,b,0,b,0,b,1,1,1)}var R={vs:t,uv:g,bottom_vs:i,bottom_uv:y,top_vs:m,top_uv:U,from_vs:Z,from_uv:w,to_vs:s,to_uv:n};return X&&(R.ns=C),R},Yc=function(m,C,q,U,W){C=C||18,q=q||0,U=U==w?c:U,W=W==w?.5:W;for(var l,P,L,k,G,T,y=[0,.5,.75,.875,.9375],z=[],Z=[],F=[],R=U/C,o=0;o<y.length;o++){var p=0===o%2?0:.5;for(l=0;C>=l;l++)P=(l+p)*R+q,L=1-y[o],z.push(f(P)*W*L,-W+2*y[o]*W,-O(P)*W*L),Z.push((l+p)/C,L)}for(o=0;o<y.length-1;o++){var D=o*(C+1),s=(o+1)*(C+1);for(l=0;C>l;l++)F.push(D+l,s+l+1,s+l,D+l,D+l+1,s+l+1)}for(T=z.length/3-(C+1),l=0;C>l;l++)z.push(0,W,0),Z.push((l+.5)/C,0);for(l=0;C>l;l++)F.push(T+l,T+l+1,T+(C+1)+l);if(m){var a=[],N=[],X=[];for(a.push(0,-W,0),N.push(.5,.5),l=0;C>=l;l++)P=l*R+q,k=f(P),G=O(P),a.push(k*W,-W,-G*W),N.push(.5+.5*k,.5+.5*G);for(l=0;C>l;l++)X.push(0,l+2,l+1)}return{vs:z,uv:Z,is:F,bottom_vs:a,bottom_uv:N,bottom_is:X}},Yn=function(j,$,I,Z,R,t){j=j||16,$=$||0,I=I||j;for(var s=.5,r=[],S=[],q=c/j,_=$;I>_;_++){var Q=_+1,D=q*_,g=q*Q;r.push(f(D)*s,-s,-O(D)*s,f(g)*s,-s,-O(g)*s,0,s,0),S.push(_/j,1,Q/j,1,(_+Q)/2/j,0)}if(t){var a=[],H=[];for(_=$;I>_;_++){D=q*_,g=q*(_+1);var k=f(D),y=O(D),x=f(g),U=O(g);a.push(k*s,-s,-y*s,0,-s,0,x*s,-s,-U*s),H.push(.5+.5*k,.5+.5*y,.5,.5,.5+.5*x,.5+.5*U)}}if(Z){var A=[],K=[];D=q*$,A.push(0,s,0,0,-s,0,f(D)*s,-s,-O(D)*s),K.push(0,0,0,1,$/j,1)}if(R){var i=[],B=[];D=q*I,i.push(0,-s,0,0,s,0,f(D)*s,-s,-O(D)*s),B.push(1,1,1,0,I/j,1)}return{vs:r,uv:S,bottom_vs:a,bottom_uv:H,from_vs:A,from_uv:K,to_vs:i,to_uv:B}},oi=function(q,U,u,K,y,L,r,N){for(var Z=[],v=0;v<q.length-1;v+=2)Z.push({x:q[v],y:q[v+1]});return Ai(Z,U,u,K,y,L,r,N,!1)},Fm={roundRect:function(g,y){return oi([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],g,y,3)},star:function(X,p){return oi([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],X,p)},rect:function(x,Z){return oi([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],x,Z)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(S,N){return oi([0,-.5,.5,.5,-.5,.5],[1,2,2,5],S,N)},rightTriangle:function(h,u){return oi([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],h,u)},parallelogram:function(_,W){return oi([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],_,W)},trapezoid:function(v,p){return oi([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],v,p)}},bi={sphere:1,cylinder:1,cone:1,torus:1},Ep={torus:1,sphere:1},Vg=xl(fq(Fm),{cylinder:1}),Bd=xl(fq(Fm),{cylinder:1,cone:1}),Np=function(A,q,f){var s,y=Pb(A.anchor3d,f,q),I=Pb(A.mat,f,q),S=Pb(A.s3,f,q),b=Pb(A.t3,f,q),n=Pb(A.r3,f,q),j=S||n||b||I;if(y||j){s=Zo(q._6O);var N=j?cq(I,S,n,Pb(A.rotationMode,f,q),b):Vd();y&&ze(N,[.5-y[0],.5-y[1],.5-y[2]]),Ob(q,N)}return s},Er=function(t,Q,A,R,F,y,C){if(wd(A))A.forEach(function(B){Er(t,Q,B,R,F,y,C)});else if(ap(A))Er(t,Q,el(R,A),R,F,y,C);else if(np(A))if(A.shape3d){var m=Np(A,t,Q);Er(t,Q,A.shape3d,R,F,y,A),m&&hk(t,m)}else Ol(t,Q,A,R.s,F,y,C)},Ol=function(g,m,H,i,v,I,p){if(p=p||Ik,!I||I(i("shape3d.transparent",H.transparent,p.transparent))){var D=Np(H,g,m);if(Gi(H)){var f=g.getData3dUI(m);f.dispatchBoundingBoxChanged()}var l=g._26I,o=g._prg,Y=g._buffer,Q=i("shape3d.color",H.color,p.color);v||(v=i("shape3d.blend",H.blend,p.blend));var N,y=H.opacity==w?p.opacity:H.opacity,j=i("shape3d.opacity");N=j!=w&&y!=w?y*j:y!=w?y:j,zr(l,o,v,i("shape3d.light",H.light,p.light),N,i("shape3d.reverse.flip",H.reverseFlip,p.reverseFlip),i("shape3d.reverse.color",H.reverseColor,p.reverseColor),i("shape3d.reverse.cull",H.reverseCull,p.reverseCull));var a=i("polygonOffset",H.polygonOffset,p.polygonOffset);H.vs&&i(jf,H.visible,p.visible)&&zb(l,o,Y,Q,g.getTexture(i("shape3d.image",H.image,p.image),m),i("shape3d.discard.selectable",H.discardSelectable,p.discardSelectable),H.vs,H.uv,H.ns,H.is,i("shape3d.uv.offset",H.uvOffset,p.uvOffset),i("shape3d.uv.scale",H.uvScale,p.uvScale),a),H.top_vs&&i(Te,H.topVisible,p.topVisible)&&zb(l,o,Y,i("shape3d.top.color",H.topColor,p.topColor)||Q,g.getTexture(i("shape3d.top.image",H.topImage,p.topImage),m,"top"),i("shape3d.top.discard.selectable",H.topDiscardSelectable,p.topDiscardSelectable),H.top_vs,H.top_uv,H.top_ns,H.top_is,i("shape3d.top.uv.offset",H.topUvOffset,p.topUvOffset),i("shape3d.top.uv.scale",H.topUvScale,p.topUvScale),a),H.bottom_vs&&i(qh,H.bottomVisible,p.bottomVisible)&&zb(l,o,Y,i("shape3d.bottom.color",H.bottomColor,p.bottomColor)||Q,g.getTexture(i("shape3d.bottom.image",H.bottomImage,p.bottomImage),m,"bottom"),i("shape3d.bottom.discard.selectable",H.bottomDiscardSelectable,p.bottomDiscardSelectable),H.bottom_vs,H.bottom_uv,H.bottom_ns,H.bottom_is,i("shape3d.bottom.uv.offset",H.bottomUvOffset,p.bottomUvOffset),i("shape3d.bottom.uv.scale",H.bottomUvScale,p.bottomUvScale),a),H.from_vs&&i(td,H.fromVisible,p.fromVisible)&&zb(l,o,Y,i("shape3d.from.color",H.fromColor,p.fromColor)||Q,g.getTexture(i("shape3d.from.image",H.fromImage,p.fromImage),m,"from"),i("shape3d.from.discard.selectable",H.fromDiscardSelectable,p.fromDiscardSelectable),H.from_vs,H.from_uv,H.from_ns,H.from_is,i("shape3d.from.uv.offset",H.fromUvOffset,p.fromUvOffset),i("shape3d.from.uv.scale",H.fromUvScale,p.fromUvScale),a),H.to_vs&&i(Pf,H.toVisible,p.toVisible)&&zb(l,o,Y,i("shape3d.to.color",H.toColor,p.toColor)||Q,g.getTexture(i("shape3d.to.image",H.toImage,p.toImage),m,"to"),i("shape3d.to.discard.selectable",H.toDiscardSelectable,p.toDiscardSelectable),H.to_vs,H.to_uv,H.to_ns,H.to_is,i("shape3d.to.uv.offset",H.toUvOffset,p.toUvOffset),i("shape3d.to.uv.scale",H.toUvScale,p.toUvScale),a),_b(l,o),D&&hk(g,D)}},zb=function(a,x,M,y,B,q,d,Z,C,k,g,s,h){if(d){h&&mg(a,h);var n=Qp.for(a),c=n.directUniforms(),r=n.directAttribs();c.uDiffuse=y||V["color.empty"],Z?Ec(a,x,B,q,M.uv,Z,g,s):Ec(a),r.aPosition=Xp(a,M.vs,d,w),r.aNormal=Xp(a,M.ns,C,w),k?(tp(a,M.is,k),kn(a,0,k.length,null,k instanceof Uint32Array?a.UNSIGNED_INT:null)):rp(a,0,d.length/3),Z?xj(a,x,B):xj(a),h&&Gn(a)}},el=function(L,z){var e=L.s;if(z||(z=e(cr)),!z)return w;var a=kk(z);if(a)return a;if("text"===z){var $={amount:e("shape3d.text.amount"),size:e("shape3d.text.size"),font:e("shape3d.text.font"),style:e("shape3d.text.style"),weight:e("shape3d.text.weight"),fill:e("shape3d.text.fill"),curveSegments:e("shape3d.text.curveSegments"),spacing:e("shape3d.text.spacing")},p=L.gv.getShape3dText(L.data),y=p;for(var m in $)y+="_"+($[m]===r?"U":$[m]);return L._cachedTextKey===y?L._cachedTextGeometry:(L._cachedTextKey=y,L._cachedTextGeometry=Y.createTextGeometry(p,$))}var m=z;if(bi[z]){var j=e("shape3d.side"),F=e("shape3d.side.from"),Q=e("shape3d.side.to"),A=e(td),o=e(Pf);3>j?(j=0,F=0,Q=0,A=!1,o=!1):((F==w||0>F)&&(F=0),(Q==w||Q>j)&&(Q=j),0===F&&Q===j&&(A=!1,o=!1));var q="cone"===z?!1:e("shape3d.smooth");m+="-"+j+"-"+F+"-"+Q+"-"+A+"-"+o+(q?1:0)}if(Vg[z]){var P=e(Te);m+="-"+P}if(Bd[z]){var S=e(qh);m+="-"+S}if("torus"===z){var I=e("shape3d.torus.radius");0>I?I=0:I>.25&&(I=.25),m+="-"+I}if(Ep[z]){var J=e(Ip);m+="-"+J}return a=gd[m],a||("box"===z?a=Y.createBoxModel():Fm[z]?a=Fm[z](P,S):"sphere"===z?a=Y.createSphereModel(j,F,Q,A,o,J,q):z===wo?a=Y.createCylinderModel(j,F,Q,A,o,P,S,q):"cone"===z?a=Y.createConeModel(j,F,Q,A,o,S):"torus"===z&&(a=Y.createTorusModel(j,F,Q,A,o,I,J,q)),gd[m]=a),a},Gi=function(){var g=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],l=["is","top_is","bottom_is","from_is","to_is"];return j=Wg(eb.substr(eb.indexOf("^#")+2)),um(Y[dq(Dk+g[15]+"n"+g[16])]())&&ip()?function(G){return G&&!G._complete_?(G._complete_=!0,G.vs&&Nf(G.ns)&&(G.ns=Wk(G.vs,G.is),G.boundingBox=r),G.top_vs&&Nf(G.top_ns)&&(G.top_ns=Wk(G.top_vs,G.top_is),G.top_boundingBox=r),G.bottom_vs&&Nf(G.bottom_ns)&&(G.bottom_ns=Wk(G.bottom_vs,G.bottom_is),G.bottom_boundingBox=r),G.from_vs&&Nf(G.from_ns)&&(G.from_ns=Wk(G.from_vs,G.from_is),G.from_boundingBox=r),G.to_vs&&Nf(G.to_ns)&&(G.to_ns=Wk(G.to_vs,G.to_is),G.to_boundingBox=r),g.forEach(function(o){var j=G[o];wd(j)&&(G[o]=new vg(j))}),l.forEach(function(u){var a=G[u];wd(a)&&(G[u]=new jj(a))}),!0):!1}:void 0}(),qc=function(B,y){var A=B[y];wd(A)&&(B[y]=new vg(A))};xl(Jo,{_25Q:function(s){s._16O=function(C,a,l,V,z,W,E,x,$){var M=this.info;if(M){var J,k,c,Z,h,F,g=Vd();if(rs[a]?(J=M.p3,k=M.c1,c=M.c2):ur[a]?(k=M.s1||M.c1,c=M.s2||M.c2):(k=M.t1||M.c1,c=M.t2||M.c2),J)F=kc(a,bp,l,V,x,$);else{var R=Wn(c,k),O=qd(k,c);Z=[0,-K(R[2],R[0]),m(R[1]/O)],h="zyx",J=[(k[0]+c[0])/2,(k[1]+c[1])/2,(k[2]+c[2])/2],F=kc(a,[O,0,0],l,V,x,$)}return Ek(g,F,J,V,z,W,E,C,Z,h)}return Sp},s._80o=function(C,k,d){var B=this,a=B.shapeModel;if(a){var w=B.gv;Ob(w),Er(w,B.data,a,B,B.getBodyColor(),d)}},s.createLineModel=function(I,r,d,W,Q){var y=this,$=y.s,v=jm(I,r,$(Ip)),e=$(W+".color");if(e){for(var j=[],z=0;z<v.length;z++){var p=v[z],L=p.length;if(L>1){var K=p[0];j.push(K.x,K.y,K.z);for(var O=1;L-1>O;O++)K=p[O],j.push(K.x,K.y,K.z),j.push(K.x,K.y,K.z);K=p[L-1],j.push(K.x,K.y,K.z)}}var J,f,E,l=$(Q),t=0;l&&(f=$(Q+".color"),J=$(Q+".pattern"),t=$(Q+".offset"),E=e),ro(y.gv,y.data,j,f||e,E?w:$(W+".gradient.color"),d,J||$(W+".pattern"),t,E)}return v},s.createTubeModel=function(B,D,L,l){for(var U=this,Z=U.s,c=Z("shape3d.side")||Ii,p=Z("shape3d.start.angle"),b=Z("shape3d.sweep.angle"),I=Z(Te)?Z("shape3d.top.cap"):w,F=Z(qh)?Z("shape3d.bottom.cap"):w,H="flat"===I,d="flat"===F,j=H&&(l?l.uv:Z("shape3d.top.image")),A=d&&(l?l.uv:Z("shape3d.bottom.image")),Y=l?l.uv:Z("shape3d.image"),f=Z("shape3d.smooth"),h={vs:[],uv:Y?[]:w,ns:f?[]:w,top_vs:H?[]:w,top_uv:j?[]:w,bottom_vs:d?[]:w,bottom_uv:A?[]:w},x=jm(B,D,Z(Ip),L),r=0,X=x.length;X>r;r++)yr(h,x[r],Z(Cl),L,c,p,b,I,F);if(l){var e=[];Ih(U.gv,U.data,h,U,U.getBodyColor(),U.mat?[U.mat]:[],l,e),e.length&&(Ho(l.vs,e),Ho(l.ns,Wk(e)))}else U.shapeModel=h;return x},s.getCache=function(){var n=this.info;if(n){var T=n.list;if(T){var q=n.cache;return q||(q=n.cache=sc(T)),q}}return w}}});var Xd=function(l,E){for(var L,j=0,F=l.length,a=0,V=F-1;V>=a;)if(j=C(a+(V-a)/2),L=l[j].length-E,0>L)a=j+1;else{if(!(L>0)){V=j;break}V=j-1}j=V;var x=l[j],t=x.point;return j===F-1||x.length===E||(t=(new Md).subVectors(l[j+1].point,t).normalize().multiplyScalar(E-x.length).add(t)),{point:t,tangent:x.tangent}},sc=function(R){for(var K,_,x=[],z=0,s=0;s<R.length;s++){for(var V=R[s],B=0;B<V.length;B++){K=V[B],_&&(z+=_.distanceTo(K));var A=new Md,l=V[B+1];l?A.subVectors(l,K):_?A.subVectors(K,_):A.x=1,A.normalize(),x.push({point:K,length:z,tangent:A}),_=K}_=null}return x},jm=function(V,n,L,b){L=L||yl;for(var Y=[],h=0,e=V.size();e>h;h++){var H=V.get(h);Y.push(new Md(H.x,H.e||0,H.y))}n&&(aq(n)&&(n=n._as),n.length||(n=null));for(var j,p,E,k,r,R=[],t=0,q=0,P=n?n.length:e;P>q;q++)if(r=n?n[q]:0===q?1:2,1===r)R.push(E=[]),E.push(Y[t++]);else if(2===r||5===r)if(k=2===r?Y[t++]:E[0],b){var O=n?n[q+1]:P>q+1?2:w;if(2===O||5===O){var J=E[E.length-1],f=2===O?Y[t]:E[0],Z=(new Md).subVectors(J,k),G=(new Md).subVectors(f,k),U=Z.length(),D=G.length();if(U&&D)if(b>U/2&&b>D/2)E.push(k);else for(Z.multiplyScalar(X(b,U/2)/U).add(k),G.multiplyScalar(X(b,D/2)/D).add(k),j=new jk(Z,k,G).getPoints(L),p=0;L>=p;p++)E.push(j[p])}else E.push(k)}else E.push(k);else if(3===r)for(j=new jk(E[E.length-1],Y[t++],Y[t++]).getPoints(L),p=1;L>=p;p++)E.push(j[p]);else if(4===r)for(j=new tg(E[E.length-1],Y[t++],Y[t++],Y[t++]).getPoints(L),p=1;L>=p;p++)E.push(j[p]);return R},xo=function(V){for(var W,C,q=new Md,Q=[],t=[],u=[],Y=0,e=V.length;e>Y;Y++)W=V[Y],C=V[Y+1],C?q.subVectors(C,W):q.subVectors(W,V[Y-1]),Q.push(q.normalize().clone());var h,F,i,g,N=new Md,Z=new Md,f=new _p,v=1e-4,B=Number.MAX_VALUE,R=Q[0],b=t[0]=new Md,r=u[0]=new Md;for(F=J(R.x),i=J(R.y),g=J(R.z),B>=F&&(B=F,N.set(1,0,0)),B>=i&&(B=i,N.set(0,1,0)),B>=g&&N.set(0,0,1),Z.crossVectors(R,N).normalize(),b.crossVectors(R,Z),r.crossVectors(R,b),Y=1;e>Y;Y++)t[Y]=t[Y-1].clone(),u[Y]=u[Y-1].clone(),Z.crossVectors(Q[Y-1],Q[Y]),Z.length()>v&&(Z.normalize(),h=o(Jc(Q[Y-1].dot(Q[Y]),-1,1)),t[Y].applyMatrix4(f.makeRotationAxis(Z,h))),u[Y].crossVectors(Q[Y],t[Y]);return{B:u,T:Q,N:t}},yr=function(){var V=function(L){for(var w=1;w<arguments.length;w++){var g=arguments[w];L.push(g.x,g.y,g.z)}},Y=function(s){for(var $=1;$<arguments.length;$++){var L=arguments[$].uv;s.push(L[0],L[1])}},_=function(F){for(var w=1;w<arguments.length;w++){var c=arguments[w].ns;F.push(c[0],c[1],c[2])}},H=function(m,p,Z,B,D){var l=-B*f(D),S=B*O(D);return new Md(m.x+l*Z.x+S*p.x,m.y+l*Z.y+S*p.y,m.z+l*Z.z+S*p.z)},m=function(_,G,i,R,C,b,Y,X,U){Y=Y||c;for(var Q,B=[],M=Y/C,Q=U?new Zb:w,z=0;C>=z;z++){var k=H(_,G,i,R,z*M+b);B.push(k),X!=w&&(k.uv=[X,1-z/C]),U&&(k.ns=Q.subVectors(k,_).normalize().toArray())}return B},C=function(R,w,d,a,m,U,i,$,t){t=t||c;var E=w?R.top_vs:R.bottom_vs;if(E)for(var n=w?R.top_uv:R.bottom_uv,h=t/i,o=0;i>o;o++){var N,z;w?(N=o*h+$,z=(o+1)*h+$):(z=o*h+$,N=(o+1)*h+$),V(E,H(d,a,m,U,N),H(d,a,m,U,z),d),n&&n.push(.5-.5*f(N),.5-.5*O(N),.5-.5*f(z),.5-.5*O(z),.5,.5)}};return function(f,x,a,T,U,J,t,H,s){var Z=x.length;if(Z>1){var l,i,j,Q,e,d,S,$=xo(x),A=$.T,P=$.N,R=$.B;"flat"===H&&C(f,!0,x[0],R[0],P[0],T,U,J,t),"flat"===s&&C(f,!1,x[Z-1],R[Z-1],P[Z-1],T,U,J,t);var D,X,W=[],g=v(U/2),u="round"===H,h="round"===s,p=x[0],k=A[0],O=R[0],K=P[0],z=x[Z-1],M=A[Z-1],y=R[Z-1],o=P[Z-1];if(u){for(j=1;g>=j;j++)P.splice(0,0,K),R.splice(0,0,O),A.splice(0,0,k),X=-j/g*T,x.splice(0,0,k.clone().multiplyScalar(X).add(p)),W[g-j]=G(T*T-X*X);Z+=g}if(h){for(j=1;g>=j;j++)P.push(o),R.push(y),A.push(M),X=j/g*T,x.push(M.clone().multiplyScalar(X).add(z)),W[x.length-1]=G(T*T-X*X);Z+=g}if(f.uv){var E=0,F=0,I=[];for(a&&(E=a),e=x[0],I[0]=0,j=1;Z>j;j++)Q=x[j],I[j]=e.distanceTo(Q),e=Q,a||(E+=I[j]);for(D=[],j=0;Z>j;j++)F+=I[j],D[j]=E?F/E:0}var c=f.ns?!0:!1;for(j=0;Z>j;j++){if(Q=x[j],d=R[j],S=P[j],l=m(Q,d,S,W[j]===r?T:W[j],U,J,t,D?D[j]:w,c),i)for(var b=0;U>b;b++){var L=i[b],q=i[b+1]||i[0],N=l[b],n=l[b+1]||l[0];V(f.vs,q,L,N,N,n,q),f.uv&&Y(f.uv,q,L,N,N,n,q),c&&_(f.ns,q,L,N,N,n,q)}i=l}}}}();xl(Y,{getLineLength:function(p){return p[p.length-1].length},getLineOffset:function(m,b){return Xd(m,b)},getLineCacheInfo:function(k,o,L,a){return sc(jm(k,o,L,a))}});var Vk=s.graph3d.RenderLite={},nc=new Array(0),_q=Vk.Buffer=function(C,d,q,i){this.gl=C,this.buffer=C.createBuffer(),this.type=d||C.ARRAY_BUFFER,this.drawType=i||C.STATIC_DRAW,this.data=nc,q&&this.upload(q)};_q.prototype.upload=function(E,J,w){w||this.bind();var x=this.gl;E=E||this.data,J=J||0,this.data.byteLength>=E.byteLength?x.bufferSubData(this.type,J,E):x.bufferData(this.type,E,this.drawType),this.data=E},_q.prototype.bind=function(){var q=this.gl;q.bindBuffer(this.type,this.buffer)},_q.createVertexBuffer=function(D,L,d){return new _q(D,D.ARRAY_BUFFER,L,d)},_q.createIndexBuffer=function(o,G,M){return new _q(o,o.ELEMENT_ARRAY_BUFFER,G,M)},_q.create=function(G,O,Q,F){return new _q(G,O,F)},_q.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Qe=Vk.Shader=function(P,D,i){this.gl=P,this.program=rj(P,D,i),this.attributes=ep(P,this.program);var e=Wo(P,this.program);this.uniforms=Ud(P,e)};Qe.prototype.bind=function(){this.gl.useProgram(this.program)},Qe.prototype.destroy=function(){this.gl};var rj=function(K,D,l){var Q=Nq(K,K.VERTEX_SHADER,D),h=Nq(K,K.FRAGMENT_SHADER,l);K.getShaderParameter(h,K.COMPILE_STATUS)||console.error(K.getError());var B=K.createProgram();return K.attachShader(B,Q),K.attachShader(B,h),K.linkProgram(B),K.getProgramParameter(B,K.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",K.getProgramParameter(B,K.VALIDATE_STATUS)),console.error("gl.getError()",K.getError()),""!==K.getProgramInfoLog(B)&&console.warn("Warning: gl.getProgramInfoLog()",K.getProgramInfoLog(B)),K.deleteProgram(B),B=null),K.deleteShader(Q),K.deleteShader(h),B},Nq=function(u,q,f){var l=u.createShader(q);return u.shaderSource(l,f),u.compileShader(l),u.getShaderParameter(l,u.COMPILE_STATUS)?l:(console.log(u.getShaderInfoLog(l)),null)},Wo=function(P,N){for(var W={},c=P.getProgramParameter(N,P.ACTIVE_UNIFORMS),X=0;c>X;X++){var E=P.getActiveUniform(N,X),R=E.name.replace(/\[.*?\]/,""),k=ci(P,E.type);W[R]={type:k,size:E.size,location:P.getUniformLocation(N,R),value:Jm(k,E.size)}}return W},ep=function(V,d){for(var $={},U=V.getProgramParameter(d,V.ACTIVE_ATTRIBUTES),g=0;U>g;g++){var R=V.getActiveAttrib(d,g),n=ci(V,R.type);$[R.name]={type:n,size:Ee(n),gl:V,location:V.getAttribLocation(d,R.name),pointer:yg}}return $},yg=function(U,c,V,i,E){var r=this.gl;r.enableVertexAttribArray(this.location),U instanceof Vk.Buffer||(U=Vk.Buffer.createVertexBuffer(r,U)),r.bindBuffer(U.type,U.buffer),r.vertexAttribPointer(this.location,this.size,c||r.FLOAT,V||!1,i||0,E||0)},Ee=function(Q){return Ko[Q]},Ko={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ci=function(f,r){if(!xp){var Z=R.keys(nl);xp={};for(var W=0;W<Z.length;++W){var A=Z[W];xp[f[A]]=nl[A]}}return xp[r]},xp=null,nl={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Jm=function(E,n){switch(E){case"float":return 0;case"vec2":return new Float32Array(2*n);case"vec3":return new Float32Array(3*n);case"vec4":return new Float32Array(4*n);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*n);case"ivec3":return new Int32Array(3*n);case"ivec4":return new Int32Array(4*n);case"bool":return!1;case"bvec2":return gl(2*n);case"bvec3":return gl(3*n);case"bvec4":return gl(4*n);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},gl=function(S){for(var s=new Array(S),B=0;B<s.length;B++)s[B]=!1;return s},Ud=function(_,g){var J={data:{}};J.gl=_;for(var K=R.keys(g),y=0;y<K.length;y++){var j=K[y],w=j.split("."),B=w[w.length-1],A=Bb(w,J),p=g[j];A.data[B]=p,A.gl=_,R.defineProperty(A,B,{get:fm(B),set:Og(B,p)})}return J},fm=function(R){var $=Fl.replace("%%",R);return new Function($)},Og=function(Q,i){var r,$=Dm.replace(/%%/g,Q);return r=1===i.size?Nl[i.type]:Pd[i.type],r&&($+="\nthis.gl."+r+";"),new Function("value",$)},Bb=function(w,z){for(var b=z,Z=0;Z<w.length-1;Z++){var T=b[w[Z]]||{data:{}};b[w[Z]]=T,b=T}return b},Fl=["return this.data.%%.value;"].join("\n"),Dm=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Nl={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Pd={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},po=function(K){function o(w){if("string"!=typeof w)return 0|w;switch(w){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var b=this;b.enable=!1;var D,O,z=Y.graph3dViewShadowType,c=Y.graph3dViewShadowIntensity,a=Y.graph3dViewShadowBias,l=Y.graph3dViewShadowQuality,x=Y.graph3dViewShadowRadius,k=Y.graph3dViewShadowDegreeX,X=Y.graph3dViewShadowDegreeZ,q=1,U=o(l),f=!1,I=new s.Math.Matrix4,p=new s.Math.Matrix4,N=b.pvMatrix=new s.Math.Matrix4;b.render=function(){if(!K._picking&&b.enable){var S=K.getGL();if(S){f&&b.setupShadowCamera(),K._glCapabilities&&(U=Math.min(U,K._glCapabilities.maxTextureSize)),b.map?D.setSize(U,U):D=b.map=new wl(K,K.getGL(),0,0,{samples:1,minFilter:Mo.NEAREST,magFilter:Mo.NEAREST,width:U,height:U}),S._shadowShader||(S._shadowShader=new Vk.Shader(S,po.shaderSrc.vs,po.shaderSrc.fs));var T=K._frameState,M=T.renderState.glState;M.blend.enabled=!1,M.depth.enabled=!0,M.depth.mask=!0;var l=M.color.clear.slice(0);fp(S,[1,1,1,1]),T.renderState.useProgram(S._shadowShader.program),B(),fp(S,l)}}},b.getShadow=function(){var Q={degreeX:k,degreeZ:X,intensity:c,quality:l,type:z,radius:x,bias:a};return 1!==q&&(Q.boundExtend=q),Q},b.setShadow=function(Y,T){Y=!!Y;var f=b.enable!==Y;b.enable=Y,"object"==typeof T&&(T.intensity!==r&&(c=T.intensity),T.bias!==r&&(a=T.bias),T.radius!==r&&(x=T.radius),T.degreeX!==r&&(k=T.degreeX),T.degreeZ!==r&&(X=T.degreeZ),T.quality!==r&&(l=T.quality),T.type!==r&&z!==T.type&&(z=T.type,f=!0),U=o(l),T.boundExtend!==r&&(q=T.boundExtend)),Y&&b.setupShadowCamera(),f&&Fd(K),K.iv()},b.refresh=function(){this.enable&&(this.setupShadowCamera(),K.iv())},b.tryUpdateBounding=function(C){var y=this.boundingSphere;if(y){var E=(new _p).fromArray(ub(C,K.getMat(C))),F=C.getAnchor3d(),k=new Zb;y.containsPoint(k.set(0-F.x,0-F.y,0-F.z).applyMatrix4(E))&&y.containsPoint(k.set(0-F.x,0-F.y,1-F.z).applyMatrix4(E))&&y.containsPoint(k.set(0-F.x,1-F.y,0-F.z).applyMatrix4(E))&&y.containsPoint(k.set(0-F.x,1-F.y,1-F.z).applyMatrix4(E))&&y.containsPoint(k.set(1-F.x,0-F.y,0-F.z).applyMatrix4(E))&&y.containsPoint(k.set(1-F.x,0-F.y,1-F.z).applyMatrix4(E))&&y.containsPoint(k.set(1-F.x,1-F.y,0-F.z).applyMatrix4(E))&&y.containsPoint(k.set(1-F.x,1-F.y,1-F.z).applyMatrix4(E))||b.setupShadowCamera()}},b.createShadow=function(Q){Q||(Q=K._frameState.renderState.directUniforms()),Q.shadowMatrix=N.toArray(),Q.shadowMap=D.texture,Q.shadowSize=[D.width,D.height],Q.shadowIntensity=c,Q.shadowBias=a,Q.shadowRadius=x},b.genShaderDefine=function(){var N="#define USE_SHADOWMAP\n";return"hard"===z?N+="#define SHADOWMAP_TYPE_PCF\n":"soft"===z&&(N+="#define SHADOWMAP_TYPE_PCF_SOFT\n"),N};var V;b.setupShadowCamera=function(){O||(O=b.boundingSphere=new s.Math.Sphere),f=!1;var j,Q,p=K.getBoundingBox(K.dm().toDatas(function(X){return X.s("shadow.cast")&&K.isVisible(X)}));p?(j=new Zb(p.min),Q=new Zb(p.max)):(j=new Zb(-256,-256,-256),Q=new Zb(256,256,256),f=!0),O.set(j.clone().add(Q).multiplyScalar(.5),.5*j.distanceTo(Q)*q);
var y,H=O.radius,_=K.getBoundingBox(K.dm().toDatas(function(s){return(s.s("shadow.cast")||s.s("shadow.receive"))&&K.isVisible(s)}));if(_){j.copy(_.min),Q.copy(_.max);var n=.5*j.distanceTo(Q);y=n+Math.min(n,H+O.center.distanceTo(j.add(Q).multiplyScalar(.5)))}else y=2*H;V=co(Vd(),-H,H,-H,H,y/1e3,y),N.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),N.multiply(I.fromArray(V));var T=Math.tan(-k*Math.PI/180),E=Math.tan(-X*Math.PI/180),P=H/Math.sqrt(T*T+E*E+1),x=new Zb(P*T,P,P*E);I.lookAt(x,new Zb(0,0,0),new Zb(0,1,0)).setPosition(x.add(O.center)),I.getInverse(I),N.multiply(I)};var B=function(){var l=K.getGL(),w=U,O=U;D.setSize(l,w,O),D.bind(l),l.clear(Mo.COLOR_BUFFER_BIT|Mo.DEPTH_BUFFER_BIT);var L=K._frameState,j=L.renderState,f=j.directUniforms(),R=j.directAttribs(),J=j.directState();f.projectionMatrix=V;var n=K._viewport;K.setViewport(l,0,0,w,O);var c,u,d,g;for(c=0,u=Jk.length;u>c;c++)if(d=Jk[c],!Fc[d].ignore&&(g=K._40Q.get(d))){var y=g.batchIndexMap;b.renderItems(l,f,R,J,g.opaque,y),b.renderItems(l,f,R,J,g.transparent,y),b.renderBatch(l,f,R,J,g.batchModelMap,y)}D.unbind(l),K.setViewport(l,n[0],n[1],n[2],n[3])};b._renderDirect=function(y,T,r,J){r&&r.length&&(T.position=Xp(y,K._buffer.vs,r,w),J?(tp(y,K._buffer.is,J),kn(y,0,J.length,null,J instanceof Uint32Array?y.UNSIGNED_INT:null)):rp(y,0,r.length/3))},b.renderShapeModel=function(x,O,U,X){var D,Y,E;if(wd(U))for(Y=0,E=U.length;E>Y;Y++)D=U[Y],D&&b.renderShapeModel(x,O,D,X);else ap(U)?b.renderShapeModel(x,O,el(X,U),X):np(U)&&(U.shape3d?b.renderShapeModel(x,O,U.shape3d,X):b.renderShapeModelImpl(x,O,U))},b.renderShapeModelImpl=function(Z,r,f){Gi(f),b._renderDirect(Z,r,f.vs,f.is),b._renderDirect(Z,r,f.top_vs,f.top_is),b._renderDirect(Z,r,f.bottom_vs,f.bottom_is),b._renderDirect(Z,r,f.from_vs,f.from_is),b._renderDirect(Z,r,f.to_vs,f.to_is)},b.renderBatch=function(N,T,k,R,e){if(!Ae(e)&&!K.drawFilter){T.modelViewMatrix=p.identity().premultiply(I).toArray();var d,Z,v;for(d in e)v=K.getBatchInfo(d)||Ik,v.visible!==!1&&v.shadowCast!==!1&&(Z=e[d],Z.invalidate&&Dp(Z),b._renderDirect(N,k,Z.vs32,Z.is))}},b.renderItems=function(C,Q,L,M,P,g){var D,U,W,k,r,R=P.length;for(D=0;R>D;D++)U=P[D],k=U.ui,W=U.data,!Gm(W)&&W.s("shadow.cast")&&K.isVisible(W)&&(g[W._id]||(r=k.shapeModel||el(k),r||(r=W instanceof s.Node&&!(W instanceof s.Shape)?{vs:oq,is:of}:[k.left,k.front,k.right,k.back,k.top,k.bottom]),Q.modelViewMatrix=(k.mat?p.fromArray(k.mat):p.identity()).premultiply(I).toArray(),M.cullFace.enabled=!!W.s("shape3d.reverse.cull"),b.renderShapeModel(C,L,r,k)))}};po.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","void main() {","vec3 transformed = vec3( position );","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},po.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var qj=s.Light=function(){Lh(qj,this),this.s(Vl,V[Vl]),this.s(cr,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Je("Light",Wd,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(e,W,K){qj.superClass.onStyleChanged.apply(this,arguments),e===Vl&&this.s("shape3d.color",K)}});var ac=Lq.FrameState=function(x,R){this.renderState=Qp.for(R),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=r,this.projectMatrix=r,this.viewMatrix=r,this.view=x,this.defaultProgram=r,this.pickColorMap=r,this._pvStack=[],this._renderStateStack=[]};ac.prototype.savePV=function(){var f=this.view;this._pvStack.push([Zo(this.projectMatrix),Zo(this.viewMatrix),f._18Q,Zo(f._7O)])},ac.prototype.restorePV=function(){var H=this._pvStack.pop();if(H){var U=this.view;this.projectMatrix=U._projectMatrix=H[0],this.viewMatrix=U._viewMatrix=H[1],U._18Q=H[2],U._7O=H[3]}},ac.prototype.setPV=function(W,S){var Q=this.view,J=!1;if(W&&(this.projectMatrix=Q._projectMatrix=W,J=!0),S&&(this.viewMatrix=Q._viewMatrix=S,Q._7O=Zo(S),J=!0),J){var m=Q.getWidth(),j=Q.getHeight(),l=Zo(this.projectMatrix);Q._18Q=Kc(l,l,S),Q._18Q._wh=m/j}},ac.prototype.syncEnv=function(k){var a=this,B=a.view;a.envmapReflectivity=B._envmapReflectivity||.5,a.cameraPosition=B.getEye(),a.projectMatrix=B._projectMatrix,a.viewMatrix=B._viewMatrix,a.pickColorMap=k,a.picking=B.getGL()._picking},ac.prototype.setGLState=function(){var W=[0,0,0,0],h=[!0,!0,!0,!0],i=[-1,1],c=[Mo.FUNC_ADD,Mo.FUNC_ADD],l=[Mo.SRC_ALPHA,Mo.ONE_MINUS_SRC_ALPHA,Mo.ONE,Mo.ONE_MINUS_SRC_ALPHA];return function(s,m){var L=this,o=L.renderState.gl,A=L.renderState.glState;A.dither=!1,m?A.color.mask=h:A.color.reset(),A.pixelStore.reset(),A.blend.color=W,A.blend.equation=c,A.blend.func=l,A.cullFace.enabled=!1,A.scissor.enabled=!1,A.depth.enabled=!0,A.depth.clear=1,A.depth.func=o.LEQUAL,A.depth.range=i,A.stencil.enabled=!1,A.polygonOffset.enabled=!1,s?(A.depth.mask=!1,A.blend.enabled=!0):(A.depth.mask=!0,A.blend.enabled=!1)}}(),ac.prototype.setUniforms=function(W){var v=this,Z=v.view,l=v.renderState,N=l.gl,F=l.uniforms;F.uBrightness=1,F.uOpacity=1,F.uPartOpacity=1,F.uPick=v.picking,F.uTexture=!1,F.uBlendTexture=!1,F.uAlphaTest=V.alphaTest,F.uTransparent=!!W,F.uFix=!1,F.uBatchColor=!1,F.uBatchBlend=!1,F.uBatchBrightness=!1,F.uReflectivity=v.envmapReflectivity||.5,F.uCameraPosition=v.cameraPosition,F.uPMatrix=v.projectMatrix,F.uViewMatrix=v.viewMatrix,Z.bindEnvMap(N),v.picking||(db(Z,N,r),Z._fogDisabled||(F.uFogColor=Z._fogColor,F.uFogDensity=Z._fogDensity,F.uFogNear=Z._fogNear,F.uFogFar=Z._fogFar))},ac.prototype.drawLayer=function(e){return this.view.renderLayers(e,!0)},ac.prototype.drawData=function(B,U,a){var X=this.view;if(X.isVisible(B)){var C=this.renderState,o=C.uniforms,J=X.getData3dUI(B);if(J){var E=C.gl,_=E._picking,w=X._picking,g=B._pickId;a&&(B._pickId=a),o.uPick=E._picking=X._picking=!!a,o.uTransparent=!!U,J._42(C.gl,C.program,U?p:F),o.uPick=E._picking=_,X._picking=w,B._pickId=g}}};var $p=Lq.Graph3dView=function(q,O){var s=this;s._webGLVersion=1,s._attributes=O||Y.graph3dViewAttributes,s._25I={},s._view=xf(1,s);var X=s._canvas=de(s._view);B(X,"webglcontextlost",function(x){x.preventDefault(),Fd(s),s._26I&&s._doBufferGC(s._26I,!0),s._26I=w,s._1o.onContextLost(),s._35O=!0}),B(X,"webglcontextrestored",function(){s._35O=!1,s.iv()}),s._40Q=new Qr,s._43Q={},s._44Q=-1,s._batchIndexMap={},s._batchModelMap={},s._wireframeIndexMap={},s._wireframeModelMap={},s._wireframeIndexMapSwap={},s._wireframeModelMapSwap={},s._polylineIndexMap={},s._polylineIndexMap={},s._polylineIndexMapSwap={},s._polylineIndexMapSwap={},s._8O=[],s._7O=Vd(),s._6O=Vd(),s._1o=new Dg(s),s._30O=new Hj(s),s._31O=new sq(s),s._32O=new id(s),s._raycaster=new Rq(s),s._highlightHelper=new ec(s),s._postProcessing=new Is(s),s._41Q=[],s._42Q=0,s.vr=new Fs(s),s.shadowMap=new po(s),s._33Q=!0,s._eye=fq(Y.graph3dViewEye),s._center=fq(Y.graph3dViewCenter),s._up=fq(Y.graph3dViewUp),s._lightChanged=!1,s._59O=[],s._spots=[],s._dirs=[],s._frameId=0,s._batchInfoMap={},s.overlappingBox=new Jh(s),s.dm(q?q:new Rb),s._coreInteractor=new rh(this),s.setInteractors([new sl(s)]),s._initView()},Bm={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},ti=0;dd("Graph3dView",R,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Dr,wq,"firstPersonMode",Zg,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",yo,Yg,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi"],_editable:!1,_editHelperDisabled:Y.graph3dViewEditHelperDisabled,_blockSelectable:Y.graph3dViewBlockSelectable,_devicePixelRatio:r,_boundaries:r,_moveStep:Y.graph3dViewMoveStep,_rotateStep:Y.graph3dViewRotateStep,_rotateMinPhi:Y.graph3dViewMinPhi===r?Y.graph3dViewRotateMinPhi:Y.graph3dViewMinPhi,_rotateMaxPhi:Y.graph3dViewMaxPhi===r?Y.graph3dViewRotateMaxPhi:Y.graph3dViewMaxPhi,_pannable:Y.graph3dViewPannable,_rotatable:Y.graph3dViewRotatable,_walkable:Y.graph3dViewWalkable,_resettable:Y.graph3dViewResettable,_zoomable:Y.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:Y.graph3dViewFirstPersonMode,_mouseRoamable:Y.graph3dViewMouseRoamable,_gridVisible:Y.graph3dViewGridVisible,_gridSize:Y.graph3dViewGridSize,_gridGap:Y.graph3dViewGridGap,_gridColor:Y.graph3dViewGridColor,_originAxisVisible:Y.graph3dViewOriginAxisVisible,_centerAxisVisible:Y.graph3dViewCenterAxisVisible,_axisXColor:Y.graph3dViewAxisXColor,_axisYColor:Y.graph3dViewAxisYColor,_axisZColor:Y.graph3dViewAxisZColor,_ortho:Y.graph3dViewOrtho,_orthoWidth:Y.graph3dViewOrthoWidth,_fovy:Y.graph3dViewFovy,_near:Y.graph3dViewNear,_far:Y.graph3dViewFar,_headlightColor:Y.graph3dViewHeadlightColor,_headlightIntensity:Y.graph3dViewHeadlightIntensity,_headlightRange:Y.graph3dViewHeadlightRange,_headlightAmbientIntensity:Y.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:Y.graph3dViewHeadlightDisabled,_rectSelectable:Y.graph3dViewRectSelectable,_rectSelectBackground:Y.graph3dViewRectSelectBackground,_editSizeColor:Y.graph3dViewEditSizeColor,_autoMakeVisible:im,_fogDisabled:Y.graph3dViewFogDisabled,_fogMode:Y.graph3dViewFogMode,_fogDensity:Y.graph3dViewFogDensity,_fogColor:Y.graph3dViewFogColor,_fogNear:Y.graph3dViewFogNear,_fogFar:Y.graph3dViewFogFar,_pickerResolution:Y.graph3dViewPickerResolution,_dashDisabled:Y.graph3dViewDashDisabled,_batchColorDisabled:Y.graph3dViewBatchColorDisabled,_batchBlendDisabled:Y.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:Y.graph3dViewBatchBrightnessDisabled,addCamera:function(r){var H=this,Z=R.freeze({id:H._42Q++,priority:r.priority||0,ignoreInPick:!!r.ignoreInPick,render:r.render});r.switch3DStatus&&(H._43Q[Z.id]=!0),H._41Q.push(Z),H._41Q.sort(function(C,N){return C.priority!==N.priority?C.priority-N.priority:C.id-N.id})},setEye:function(m,C,k){1===arguments.length&&(C=m[1],k=m[2],m=m[0]);var z=this._eye;z[0]=m,z[1]=C,z[2]=k,this.fp(yo,w,z)},setCenter:function(c,C,q){1===arguments.length&&(C=c[1],q=c[2],c=c[0]);var H=this._center;H[0]=c,H[1]=C,H[2]=q,this.fp(Yg,w,H)},setUp:function(E,h,f){1===arguments.length&&(h=E[1],f=E[2],E=E[0]);var Y=this._up;Y[0]=E,Y[1]=h,Y[2]=f,this.fp("up",w,Y)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Co},isTransparentMask:function(v){return v.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var V=this,I=V._aspect;return I?I:(I=V.getWidth()/V.getHeight(),I||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(G){var h=this,N=h._dataModel,i=h._selectionModel;N!==G&&(N&&(N.ump(h.handleDataModelPropertyChange,h),N.umm(h.handleDataModelChange,h),N.umd(h.handleDataPropertyChange,h),i||N.sm().ums(h.handleSelectionChange,h)),h._dataModel=G,G.mp(h.handleDataModelPropertyChange,h),G.mm(h.handleDataModelChange,h),G.md(h.handleDataPropertyChange,h),i?i._21I(G):G.sm().ms(h.handleSelectionChange,h),h._postProcessing.handleDataModleChange(N,G),h.invalidateAll(!0),h.invalidateLight(),h.fp(Ck,N,G),h._canvas.style.background=G.getBackground()||"")},handleDataModelPropertyChange:function(Z){if("background"===Z.property){var J=this._canvas.style.background,l=Z.newValue||"";this._canvas.style.background=l,this.fp("canvasBackground",J,l)}else"envmap"===Z.property?this.iv():"cubicEnvmap"===Z.property&&(this._lastEnvMap=r,this.iv())},handleDataPropertyChange:function(n){var x=n.data;this.invalidateData(x),Gm(x)&&"s:light.type"===n.property?this.invalidateLight():"s:shadow.cast"===n.property?this.shadowMap.tryUpdateBounding(x):("s:alwaysOnTop"===n.property||"s:shape3d.alwaysOnTop"===n.property)&&(n.newValue?x.setRenderLayer("top"):x.setRenderLayer(r))},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(d){var B=this,M=d.property;B.iv(),B._18Q=w,"eye"===M?B._33Q=!0:"devicePixelRatio"===M?B._42(w,B.getDevicePixelRatio()):Bm[M]&&Fd(B)},_5O:function(O){var e=O._22Q();return e?new e(this,O):w},getData3dUI:function(s){var h=this._25I[s._id];return h===r&&(h=this._5O(s),this._25I[s._id]=h),h},invalidateAll:function(p){var Z=this;if(p){for(var W in Z._25I){var C=Z._25I[W];C&&C.dispose()}Z._25I={},Z.iv(),dr(Z)}else dr(Z),Z.dm().each(function(G){Z.invalidateData(G)})},invalidateSelection:function(){var u=this;u.sm().each(function(E){u.invalidateData(E)})},invalidateData:function(W){var M=this,i=M.getData3dUI(W);i&&(i.iv(),M.iv()),dr(M,W)},getShape3dText:function(f){return f.getStyle("shape3d.text")||this.getLabel(f)},invalidateBatch:function(o){var t=this,B=t._40Q;B.each(function(w){t._invalidateBatch(w.batchModelMap,w.batchIndexMap,w.polylineModelMap,w.polylineIndexMap,w.wireframeModelMap,w.wireframeIndexMap,o),w.markBatchInvalid()})},_invalidateBatch:function(I,b,B,N,e,z,H){var Y=this,A=I[H],R=[],f={};if(A){A.ds.forEach(function(w){var B=Y.getData3dUI(w);B&&B.iv(),delete b[w._id],R.push(w._id)}),delete I[H];for(var n,a,F,i,V,u,S,_,E,D=[e,B],X=[z,N],d=0;d<D.length;d++){var p=D[d],v=X[d];for(f={},_=0;_<R.length;_++){var w=v[R[_]];if(w){delete v[R[_]],E=w.batch,n=p[E];var Q=w.begin,l=w.size,J=3*Q,x=3*l,j=4*Q,L=4*l;for(a=n.ds,F=n.vs,i=n.cs,V=n.ps,u=n.ls,S=w.index,n.invalidate=!0,a[S]=r,S=J;J+x>S;S++)F[S]=r;for(S=j;j+L>S;S++)i[S]=r;for(S=j;j+L>S;S++)V[S]=r;if(u)for(S=J;J+x>S;S++)u[S]=r;f[E]=!0}}for(E in f){n=p[E],a=n.ds,F=n.vs,i=n.cs,V=n.ps,u=n.ls;var W=[];for(S=0;S<a.length;S++)a[S]!==r&&W.push(a[S]);if(0===W.length)delete p[E];else{for(n.ds=W,W=[],S=0;S<F.length;S++)F[S]!==r&&W.push(F[S]);for(n.vs=W,W=[],S=0;S<i.length;S++)i[S]!==r&&W.push(i[S]);for(n.cs=W,W=[],S=0;S<V.length;S++)V[S]!==r&&W.push(V[S]);if(n.ps=W,u){for(W=[],S=0;S<u.length;S++)u[S]!==r&&W.push(u[S]);n.ls=W}}}}Y.iv()}},handleDataModelChange:function(h){var Y=this,g=h.kind,v=h.data;if("add"===g)Y.invalidateData(v),Dn(v)&&v.getEdgeGroup()&&v.getEdgeGroup().eachSiblingEdge(Y.invalidateData,Y),Gm(v)&&Y.invalidateLight();else if(g===Ge){var T=v._id,B=Y._25I[T];B&&(B.dispose(),delete Y._25I[T],Y.iv()),v===Y._currentSubGraph&&Y.setCurrentSubGraph(w),dr(Y,v),Gm(v)&&Y.invalidateLight()}else g===qb&&(Y.invalidateAll(!0),Y.setCurrentSubGraph(w),dr(Y),Y.invalidateLight())},toCanvas:function(R,J,A){var m=this,Z=m.getGL();if(m.validate(),R){var g=Z.getParameter(Z.COLOR_CLEAR_VALUE);fp(Z,R)}m._42(w,1);var F=m.getWidth()||1,h=m.getHeight()||1,v=new Uint8Array(4*F*h),p=de(),i=p.getContext("2d");Z.readPixels(0,0,F,h,Z.RGBA,Z.UNSIGNED_BYTE,v),Vp(p,F,h,1);for(var x=i.getImageData(0,0,F,h),L=x.data,O=0;O<L.length;O+=4){var M=O/4,o=C(M/F),_=M-o*F;M=4*((h-1-o)*F+_),L[M]=v[O],L[M+1]=v[O+1],L[M+2]=v[O+2],L[M+3]=v[O+3]}if(i.putImageData(x,0,0),R&&fp(Z,g),m._42(w,m.getDevicePixelRatio()),J&&A){var Q=de(),d=Q.getContext("2d");return Vp(Q,J,A,1),Y.drawImage(d,p,0,0,J,A),Q}return p},toDataURL:function(T,O){var $=this,B=$.getGL();if($.validate(),T){var n=B.getParameter(B.COLOR_CLEAR_VALUE);fp(B,T)}$._42(w,1);var A=$._canvas.toDataURL(O||"image/png",1);return T&&fp(B,n),$._42(w,$.getDevicePixelRatio()),A},getGL:function(){var W=this._26I;if(W)return this.acquireProgram(),W;if(!this._35O){var q=this,l=q._canvas,Y=q._attributes;if(!Y||Y.requestWebGL2!==!1)try{W=l.getContext("webgl2",Y)||l.getContext("experimental-webgl2",Y),W&&(q._webGLVersion=2,q._26I=W)}catch(o){}if(!W)try{W=l.getContext("webgl",Y)||l.getContext("experimental-webgl",Y)}catch(o){throw new Error("WebGL not supported")}if(!W)throw new Error("WebGL not supported");q._26I=W;var R=q._frameState=new ac(this,W);q._glExtensions=new k(W),q._glCapabilities=new u(W,q._glExtensions),q._2O={},W._emptyCubeTexture=Mg(W),W._compiledShader={},W._emptyTexture=Ym(W),W._emptyBlendTexture=Ym(W),W._bufPool={},W._id=++ti,R.setGLState(),q._buffer={vs:Qj(W),ns:Qj(W),is:Qj(W),uv:Qj(W),batchColor:Qj(W),batchBlend:Qj(W),batchBrightness:Qj(W),lineDistance:Qj(W)},q._1O=ah(W);var U=q._cube={vs:Qj(W),ns:Qj(W),is:Qj(W),uv:Qj(W)};return Cb(W,U.vs,oq),Cb(W,U.ns,jd),Cb(W,U.uv,ok),Ao(W,U.is,of),q.acquireProgram(),W._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},W}},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<Y.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},acquireProgram:function(){var K=this,J=K._26I;if(J){var l=Y.getImage(K.getEnvmap()),E=l&&l.tagName?!0:!1,p=K._prg&&K._prg.envMapFlag?!0:!1;if(!K._prg||E!==p){var h=K._prg=J.createProgram();if(!h)return w;h.envMapFlag=E;var z=K._dirs.length,f=K._spots.length,y=K._59O.length,r=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];z&&r.push("uDirColor","uDirDirection"),f&&r.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),y&&r.push("uPointColor","uPointRange","uPointPosition"),tk||(eb=Wg(eb.substring(0,eb.indexOf("^#"))),Cj=Wg(Cj),tk=!0);var X=["#define MAX_DIR "+z,"#define MAX_SPOT "+f,"#define MAX_POINT "+y,K._fogDisabled?"":"#define FOG","exp2"===K.getFogMode()?"#define FOG_EXP2":"",K._dashDisabled?"":"#define DASH",E?"#define USE_ENVMAP":"",K.isOrtho()?"#define ORTHOGRAPHIC":"",K._batchColorDisabled?"":"#define BATCHCOLOR",K._batchBlendDisabled?"":"#define BATCHBLEND",K._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",K.shadowMap.enable?K.shadowMap.genShaderDefine():"",""].join("\n"),k=Kd(J,h,J.VERTEX_SHADER,eb.replace("PREFIX",X));J.getShaderParameter(k,J.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",J.getShaderInfoLog(k));var m=Kd(J,h,J.FRAGMENT_SHADER,Cj.replace("PREFIX",X));J.getShaderParameter(m,J.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",J.getShaderInfoLog(m)),qm?r.push("aPosition"):(h.aPosition=0,J.bindAttribLocation(h,0,"aPosition")),J.linkProgram(h),r.forEach(function(y){h[y]=/^u/.test(y)?J.getUniformLocation(h,y):J.getAttribLocation(h,y)});var e=this._frameState;e.renderState.program=e.defaultProgram=h,J.deleteShader(k),J.deleteShader(m)}}},getBrightness:function(u){var O=u.s("brightness"),n=this.isSelected(u)?u.s("select.brightness"):w;return O==w?n:n==w?O:O*n},setHighlightMode:function($){var Z;Z="selection"===$||"selected"===$?ec.Mode.Selection:"mouseover"===$||"hover"===$?ec.Mode.MouseOver:"style"===$?ec.Mode.Style:ec.Mode.Disable;var X=this._highlightHelper.mode;this._highlightHelper.mode=Z,this.firePropertyChange("highlightMode",X,Z)},getHighlightMode:function(){var Q=this._highlightHelper.mode;return Q===ec.Mode.Selection?"selected":Q===ec.Mode.MouseOver?"hover":Q===ec.Mode.Style?"style":"disabled"},getDataHighlightMode:function(q){return q.s("highlight.mode")},getHighlightColor:function(){return this._highlightHelper.color||V["highlight.color"]},setHighlightColor:function(B){var m=this._highlightHelper.color;this._highlightHelper.color=B,this.firePropertyChange("highlightColor",m,B)},getHighlightWidth:function(){return this._highlightHelper.width||V["highlight.width"]},setHighlightWidth:function(J){var _=this._highlightHelper.width;this._highlightHelper.width=J,this.firePropertyChange("highlightWidth",_,J)},bindEnvMap:function(h){var y=this,m=Qp.for(h),n=m.directUniforms(),X=y.getEnvmap(),f=Y.getImage(X);if(f&&f.tagName){if(X!==y._lastEnvMap){var e={};if(y.dm().isCubicEnvmap()){var g=To(f),u=md(f);if(0===g||0===u)return;var H=g/4,Q=u/3,j={top:{x:H,y:0},left:{x:0,y:Q},front:{x:H,y:Q},right:{x:2*H,y:Q},back:{x:3*H,y:Q},bottom:{x:H,y:2*Q}};["top","left","front","right","back","bottom"].forEach(function(a){var J=j[a],U=e[a]=de();Vp(U,H,Q,1);var n=_d(U);n.drawImage(f,J.x,J.y,H,Q,0,0,H,Q),n.restore(),e[a]=Y.resizeImagePOT(U,!0)})}else f=Y.resizeImagePOT(f,!0);y._envMapTexture&&h.deleteTexture(y._envMapTexture);var A=y._envMapTexture=h.createTexture();h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_CUBE_MAP,A),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.right||f),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.left||f),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.top||f),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.bottom||f),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.front||f),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.back||f),h.bindTexture(h.TEXTURE_CUBE_MAP,h._emptyCubeTexture),y._lastEnvMap=X}n.uEnvMap=y._envMapTexture}},getWireframe:function(C){var S=C.s("wf.visible"),G=C.s("wf.width");return S===!0||G>0&&"selected"===S&&this.isSelected(C)?{color:C.s("wf.color"),width:G,"short":C.s("wf.short"),mat:C.s("wf.mat")}:void 0},_transformPointToViewSpace:function(u){var o=[u[0],u[1],u[2]];return yb(o,this._viewMatrix),o},_transformDirectionToViewSpace:function(j,I){var t=[j[0],j[1],j[2]];yb(t,this._viewMatrix);var h=I?[I[0],I[1],I[2]]:[0,0,0];yb(h,this._viewMatrix);var Y=h[0]-t[0],f=h[1]-t[1],R=h[2]-t[2],H=Math.sqrt(Y*Y+f*f+R*R);return H?[Y/H,f/H,R/H]:[Y,f,R]},getWireframeGeometry:function(e){return e.s("wf.geometry")?{color:e.s("wf.color"),width:e.s("wf.width"),mat:e.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(Q){return Q.s("body.color")},getMat:function(q){return q.getMat?q.getMat():q.s("mat")},getFaceMat:function(i,C){return i.getFaceMat?i.getFaceMat(C):i.s(C+".mat")},getFaceBlend:function(g,z){return g.s(z+".blend")||g.s("all.blend")},getFaceColor:function(n,m){return n.s(m+".color")||n.s("all.color")},getFaceImage:function(W,h){return W.s(h+".image")||W.s("all.image")},getFaceBlendImage:function(O,M){return O.s(M+".blend.image")||O.s("all.blend.image")},getFaceDiscardSelectable:function(u,L){var q=u.s(L+".discard.selectable");return q==w?u.s("all.discard.selectable"):q},getFaceUv:function(O,d){return O.s(d+".uv")||O.s("all.uv")},getFaceUvOffset:function(P,Z){return P.s(Z+".uv.offset")||P.s("all.uv.offset")},getFaceUvScale:function(S,o){return S.s(o+".uv.scale")||S.s("all.uv.scale")},getFaceLight:function(D,A){var X=D.s(A+".light");return X==w?D.s("all.light"):X},getFaceVisible:function(g,a){var F=g.s(a+".visible");return F==w?g.s("all.visible"):F},getFaceOpacity:function(U,V){var e=U.s(V+".opacity");return e==w?U.s("all.opacity"):e},getFaceTransparent:function(n,W){var y=n.s(W+".transparent");return y==w?n.s("all.transparent"):y},getFaceReverseColor:function(w,u){return w.s(u+".reverse.color")||w.s("all.reverse.color")},getFaceReverseFlip:function(S,k){var P=S.s(k+".reverse.flip");return P==w?S.s("all.reverse.flip"):P},getFaceReverseCull:function(H,E){var $=H.s(E+".reverse.cull");return $==w?H.s("all.reverse.cull"):$},getTextureMap:function(){return this._2O},deleteTexture:function(Z){var w=this,X=w._2O[Z];X&&(delete w._2O[Z],w.getGL().deleteTexture(X))},renderPickScene:function(){var w=this.getGL();this._picking=w._picking=!0,this.renderScene(),this._picking=w._picking=!1},invalidateCachedTexture:function(r){var h=this.getData3dUI(r);h.invalidateCachedTexture(this.getGL()),this.invalidateData(r)},invalidateShape3dCachedImage:function(q){this.invalidateCachedTexture(q)},invalidateCachedGeometry:function(A){var q=this.getData3dUI(A);q.invalidateCachedGeometry(),this.invalidateData(A)},isInteractive:function(Q){return Q.s("interactive")},getTexture:function(X,C,L){if(!X)return w;var p=this,Z=p.getGL(),Q=p._2O[X];if(!Q){var o=Ub(X),I={};if(!o)return Z._emptyTexture;if(C){I.mipmapMaxLevel=C.s("texture.mipmap.max");var u=C.s("texture.wrap");I.clampToEdge="clampToEdge"===u?!0:"repeat"===u?!1:r}if(o.uuid||(o.uuid=s.Math.generateUUID()),o.tagName){if(o.dynamic)return ah(Z,o,p._1O,I);Q=p._2O[X]=ah(Z,o,r,I)}else{var v,D=C&&(C.s("texture.cache")||C.s("shape3d.image.cache")||o.textureCache),b=p.vr.isPresenting();if(b&&(C._textureUpdateFrame===Z._renderInfo.frame?D=!0:C._textureUpdateFrame=Z._renderInfo.frame),D&&(v=p.getData3dUI(C),Q=v.getCachedTexture(L),Q&&v.interactiveInfo&&Q.interactiveInfo&&(v.interactiveInfo[Q.interactiveInfo.key]=Q.interactiveInfo.info)),!Q){var V=Z._renderInfo.textureCache;if(D){if(V.time>Y.graph3dMaxVectorCacheTime)return p.redraw(),Z._emptyTexture;if(!oo(o,C))return Z._emptyTexture}var c;C&&(1!==C.s("texture.scale")?c=C.s("texture.scale"):1!==C.s("shape3d.texture.scale")&&(c=C.s("shape3d.texture.scale"))),c||(c=1);var P=C&&(C.s("fixSizeOnScreen")||C.s("shape3d.fixSizeOnScreen")),h=P?Z.NEAREST:Z.LINEAR;P?"number"==typeof P&&(c*=0>P?1:P):C&&(C.s("vector.dynamic")||C.s("shape3d.vector.dynamic"))&&(v||(v=p.getData3dUI(C)),P=v.getVectorDynamicSize());var m,M,S,G=C&&C.s("shape3d");"billboard"===G?S=C.getTall()/C.getWidth():"plane"===G&&(S=C.getHeight()/C.getWidth());var n=To(o,C);if(P){var E;E=D?p._devicePixelRatio||Co:p.getDevicePixelRatio(),m=P[0]>0?P[0]*E:c*n*E,M=P[1]>0?P[1]*E:c*(S?md(o,C,p,Math.min(4096,n*S)):md(o,C))*E}else m=c*n,M=c*(S?md(o,C,p,Math.min(4096,n*S)):md(o,C));if(m>=1&&M>=1){var k=0;(D||b)&&(k=Date.now());var _=p._glCapabilities.maxTextureSize;m=Math.min(m,_),M=Math.min(M,_);var y=gm(m,M);if(!v&&C&&(v=p.getData3dUI(C)),v&&v.interactiveInfo){var $=X;"object"==typeof $&&($=$.uuid||($.uuid=s.Math.generateUUID()));var j=v.interactiveInfo[$]={};y.interactiveInfo=j.bodyInfo={compInfos:[],matrix:new Rp,rect:{x:0,y:0,width:m,height:M}}}El(y,o,0,0,m,M,C,p),y.interactiveInfo&&(y.interactiveInfo=null),y.restore(),V.count++,V.pixels+=m*M,C?(I.minFilter=Gk(C.s("texture.filter.min")||C.s("texture.filter"))||h,I.magFilter=Gk(C.s("texture.filter.mag")||C.s("texture.filter"))||h):I.minFilter=I.magFilter=h,D||b?(Q=ah(Z,Gr,null,I),v.setCachedTexture(Q,L),V.time+=Date.now()-k,j&&(Q.interactiveInfo={key:$,info:j}),Gr=null):Q=ah(Z,Gr,p._1O,I)}}}}return Q},redraw:function(){this.iv()},validateImpl:function(){var E=this;if(E._lightChanged){E._lightChanged=!1;var M=[],n=[],g=[];E.dm().each(function(_){if(Gm(_)){var V=_.s("light.type");V===Zc?M.push(_):V===jc?n.push(_):V===mk&&g.push(_)}}),(M.length!==E._59O.length||n.length!==E._spots.length||g.length!==E._dirs.length)&&Fd(E),E._59O=M,E._spots=n,E._dirs=g}E._42(),E._1o.iv()},getRenderInfo:function(){var R=this.getGL();return R?R._renderInfo:void 0},getDebugTip:function(){var n=this,M=n.getRenderInfo();if(M){var w=n.getGL()._validBufCount||0,j="Draw Calls: "+M.calls+"<br/>"+"Vertices: "+M.vertices+"<br/>"+"Faces: "+M.faces+"<br/>"+"Lines: "+M.lines+"<br/>"+(M.points?"Points: "+M.points+"<br/>":"")+"Buffers: "+w+"<br/>"+"Cache Models: "+R.keys(gd).length+"<br/>"+"Shape3d Models: "+R.keys(sg).length;if(n.vr.isPresenting()&&(j+="<br/>VR fps: "+n.vr.getFps()),M.textureCache){var d=M.textureCache.count;if(j+="<br/>2D Dynamic Textures: "+M.textureCache.count,d>0){var I,P=M.textureCache.pixels;I=P>1e6?Math.round(P/1e6)+"M":P>1e3?Math.round(P/1e3)+"K":Math.round(P),j+="<br/>2D Dynamic pixels: "+I}}return j}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var a=new s.Math.Box3,o=new s.Math.Matrix4;return function(t){var S=t;if(S instanceof s.Data&&(S=this.getData3dUI(S)),!S.mat)return!0;var E=S.getBoundingBox();a.copy(E).applyMatrix4(o.fromArray(S.mat));var p=this.getFrustum();return p.intersectsBox(a)}}(),updateScene:function(){var x=this;x._81O=w,x.overlappingBox.clear(),x._40Q.init();var h,C,Z,K=this.dm().getDatas().getArray(),o=K.length,q=this.getGL(),V=this._40Q;for(h=0;o>h;h++)C=K[h],Z=this.getData3dUI(C),Z&&Z.update(this,q,V);x._40Q.onUpdated()},renderScene:function(){function I(I,N){b.setGLState(I,N),b.setUniforms(I),b.renderState.attribs.disable(),h=W.directUniforms(),f=W.directAttribs(),f.disable()}function H(P){for(;z>Z;Z++){var G=g[Z];if(!U||!G.ignoreInPick){if(G.priority>=P)break;(!m._43Q[m._44Q=G.id]||rq[li.length])&&(G.render(d,m,b),I())}}}var m=this;m.shadowMap.render(),m._44Q=-1;var f,b=m._frameState,W=b.renderState,i=W.glState,h=W.directUniforms(),d=m.getGL(),j=m._prg;W.syncLoss(),m._projectMatrix=Nd(m),le(m,m._7O),m._viewMatrix=Zo(m._7O),b.syncEnv(this._picking?this.pickColorMap:r),W.useProgram(j),I(!1,!0),d.clear(d.DEPTH_BUFFER_BIT);var U=m._picking,g=this._41Q,Z=0,z=g.length;if(H(Y.cameraPriority.skybox),U){var A=i.color.clear.slice(0);fp(d,[0,0,0,0])}else fp(d,[0,0,0,0]),i.blend.enabled=!1,i.depth.enabled=!1,i.depth.mask=!1,m.drawSky(d,j),m.drawReflectors(d)&&(m._projectMatrix=Nd(m),le(m,m._7O),m._viewMatrix=Zo(m._7O),b.syncEnv(),I()),i.blend.enabled=!1,i.depth.enabled=!0,i.depth.mask=!0,h.uTransparent=!1,m._31O._42(d,j);if(!d.textureBatch||rq[(ONE_FRAME_TIME-6)/2]){!U&&m.shadowMap.enable&&m.shadowMap.createShadow(h);for(var F=0,L=Jk.length;L>F;F++){var u=Jk[F],X=Fc[u];if(!X.ignore){var Q=X.priority;H(Q),this.renderLayer(u)}}i.depth.enabled=!1,h.uTransparent=!1,h.shadowReceive=!1,U?m.drawFilter||m._30O._42(d,j):(i.blend.enabled=!1,i.depth.mask=!0,m._32O._42(d,j),m._30O._42(d,j),m._highlightHelper._42(d,j)),i.depth.enabled=!0,H(Y.cameraPriority.infinity),U&&fp(d,A),Cb(d,w),Ao(d,w),m._44Q=-1}},renderLayers:function(U,h){h&&(U=yp(U));for(var B=0,P=U.length;P>B;B++)this.renderLayer(U[B])},renderLayer:function(l){var u=this,v=u._picking,A=u._40Q.get(l);if(A){var D,_,W,o=u.getGL(),V=u._frameState,H=V.renderState,c=H.glState,G=H.directUniforms(),X=A.opaque,y=A.transparent,P=A.batchModelMap,k=A.polylineModelMap,j=A.wireframeModelMap,o=u.getGL(),I=u._prg;v||(c.blend.enabled=!1,c.depth.enabled=!0,c.depth.mask=!0),G.uTransparent=!1,Fc[l].clearDepth!==!1&&o.clear(o.DEPTH_BUFFER_BIT);var m=this.drawFilter;if(m)for(W=X,D=0,_=W.length;_>D;D++)m(W[D].data)!==!0&&W[D].ui._42(o,I,F);else{for(W=X,D=0,_=W.length;_>D;D++)W[D].ui._42(o,I,F);if(v)for(W=y,D=0,_=W.length;_>D;D++)W[D].ui._46Q(o);Zq(u,P),kr(u,k),kr(u,j)}if(v||(c.blend.enabled=!0,c.depth.mask=!1),u._45Q=G.uTransparent=!0,m)for(W=y,D=0,_=W.length;_>D;D++)m(W[D].data)!==!0&&W[D].ui._42(o,I,p);else{for(W=y,D=0,_=W.length;_>D;D++)W[D].ui._42(o,I,p);Zq(u,P,null,!0),kr(u,k,null,!0),kr(u,j,null,!0)}u._45Q=null}},drawV2:function(F){var h=this;if(!h._35O&&(!Pl||rq(Pl))){var P=h.getWidth(),Q=h.getHeight();if(P&&Q){var q=h.getGL();if(q){var i=h._canvas;if(F||(F=h.getDevicePixelRatio()),P!==i.clientWidth||Q!==i.clientHeight){Vp(i,P,Q,F);var J=F;P&&Math.abs(q.drawingBufferWidth-P*F)>1&&(J=Math.min(J,q.drawingBufferWidth/P)),Q&&Math.abs(q.drawingBufferHeight-Q*F)>1&&(J=Math.min(J,q.drawingBufferHeight/Q)),J!==F&&(h.setDevicePixelRatio(F=J),Vp(i,P,Q,F)),h._18Q=null}q.clear(q.COLOR_BUFFER_BIT);var D=q._renderInfo;D.calls=0,D.vertices=0,D.faces=0,D.lines=0,D.points=0,D.textureCache={time:0,count:0,pixels:0},D.frame=++h._frameId,D.cacheTimeCost=0,D.reflectDepth=0,P*=F,Q*=F;
do{if(h.vr.enable&&h.vr.render(q,P,Q))break;if(h.updateScene(),h._postProcessing.render(q,P,Q))break;h.setViewport(q,0,0,P,Q),h.renderScene()}while(!1);h._33Q=!1,h.countFrame(),h._doBufferGC(q)}}}},_42:function(K,x){return this.drawV2(x)},drawReflectors:function(d){d._renderInfo.reflectDepth++;var n,T,q,C=this,l=C._dataModel.getReflectors(),r=!1;for(n in l)T=l[n],C.isVisible(T)&&(q=C.getData3dUI(T),q&&q.drawReflector(d)&&(r=!0));return d._renderInfo.reflectDepth--,r},isReflecting:function(R){return R._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(g,p){return this._postProcessing.enableModule(g,p)},getPostProcessingModule:function(C){return this._postProcessing.getModule(C)},getPostProcessingValue:function(A,i){var e=this._postProcessing.getModule(A);return e?e[i]:r},setPostProcessingValue:function(D,M,d){var v=this.getPostProcessingValue(D,M),U=this._postProcessing.getModule(D);U&&v!==d&&("enable"===M?this.enablePostProcessing(D,d):U[M]=d,this.firePropertyChange("postProcessing."+D+"."+M,v,d))},setViewport:function(I,_,u,r,q){this._viewport=[_,u,r,q],Qp.for(I).directState().viewport=this._viewport},getRenderState:function(){return Qp.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(T){this._bufferGCInterval=T},_doBufferGC:function(z,F){var I,l,s=z._bufPool,V=0,$=0,q=z._renderInfo.frame,E=this._bufferGCInterval||10;for(I in s)V++,l=s[I],l&&(F||q-l._fid>E?(z.deleteBuffer(l._buf),l._buf=null,s[I]=null):$++);if(V/2>$&&V>128){var B={};for(I in s)s[I]&&(B[I]=s[I]);z._bufPool=B}z._validBufCount=$},_swapLineMap:function(){var X=this;Ug=X._polylineModelMap,X._polylineModelMap=X._polylineModelMapSwap,X._polylineModelMapSwap=Ug,Ug=X._wireframeModelMap,X._wireframeModelMap=X._wireframeModelMapSwap,X._wireframeModelMapSwap=Ug,Ug=X._polylineIndexMap,X._polylineIndexMap=X._polylineIndexMapSwap,X._polylineIndexMapSwap=Ug,Ug=X._wireframeIndexMap,X._wireframeIndexMap=X._wireframeIndexMapSwap,X._wireframeIndexMapSwap=Ug},_updateSkybox:function(V){if(this._skybox&&V){var M=V.property,O=!1,a=this._skybox;if("eye"===M||"forceUpdate"===M){var $=this._eye;a.p3($[0],$[1],$[2]),O=!0}if("near"===M||"far"===M||"forceUpdate"===M){var q=this._near,w=this._far,Z=a.getFinalScale3d();if(Z[0]/=2,Z[1]/=2,Z[2]/=2,Z[0]<=q||Z[0]>=w||Z[1]<=q||Z[1]>=w||Z[2]<=q||Z[2]>=w){var d=2*q*w/(q+w),K=Math.min(Z[0],Z[1],Z[2]),f=d/K,y=a.getScale3d();a.setScale3d(y[0]*f,y[1]*f,y[2]*f),O=!0}}O&&this.invalidateData(a)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(O){return this.setSkybox(O)},getSkybox:function(){return this._skybox},setSkybox:function(m){var O=this._skybox;return O===m?(m&&this._updateSkybox({property:"forceUpdate"}),void 0):(O&&(this._skyboxStyleMap&&O.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&O.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&O.p3(this._skyboxP3),this._skyboxP3=null),this._skybox=m,this.ump(this._updateSkybox,this),m&&(m.dm()&&m.dm().remove(m),this._skyboxStyleMap=s.Default.clone(m.getStyleMap()),this._skyboxAnchor3d=m.getAnchor3d(),m.setAnchor3d(.5,.5,.5),this._skyboxP3=m.p3().slice(0),m.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})),this.fp("skybox",O,m),void 0)},drawSky:function(R,b){var H=this,m=H._skybox;if(m){var c=Qp.for(R).directUniforms(),t=H._headlightIntensity,J=er(H._headlightColor),b=H._prg;1!==t&&(J=[J[0]*t,J[1]*t,J[2]*t]),c.uHeadlightColor=[J[0],J[1],J[2],1];var p=H.getData3dUI(m);if(p){var X=H.isOrtho(),_=X||this._computedProjectMatrix;if(_){var I=H._projectMatrix;X&&(H._ortho=!1),c.uPMatrix=H._projectMatrix=Nd(H,!0)}var K=m.p3(),f=this._eye;(K[0]!==f[0]||K[1]!==f[1]||K[2]!==f[2])&&(m._position.x=f[0],m._54O=f[1],m._position.y=f[2]),p.validate(),p._42(R,b,n),_&&(X&&(H._ortho=!0),c.uPMatrix=H._projectMatrix=I)}R.clear(R.DEPTH_BUFFER_BIT),c.uHeadlightColor=[J[0],J[1],J[2],H._headlightDisabled?1:0]}},getLogicalPoint:function(b){return bc(b,this._canvas)},isRectOverlapping:function(A){var Q=this.getData3dUI(A);return Q._rectOverlapping},getHitFaceInfo:function(n){n.target&&(n=this.lp(n));var b=this.getDataInfoAt(n);if(b){var o=this.intersectObject(n,b.data);if(o)return{data:b.data,face:o.part}}return w},unproject:function(B,U){var x=this,z=x.getWidth(),T=x.getHeight(),V=B.target?x.lp(B):B,Y=V.x-z/2,v=V.y-T/2,f=2*(Y/z),o=2*(-1*v/T);U=U||0;var M=Vd(),Q=Nd(x),d=le(x);Kc(M,Q,d),Ro(M);var K=Fq([f,o,U,1],M);return[K[0]/K[3],K[1]/K[3],K[2]/K[3]]},getDataAt:function(u){var g=this.getDataInfoAt(u);return g?g.data:w},getDataInfoAt:function(t,T,Q){return t.target&&(t=this.lp(t)),this._1o.get(ih(t.x,t.y,T),!0,Q)},getDatasInRect:function(M){return this._1o.get(M)},setEditable:function(c){var s=this,h=s._editable;s._editable=c,this.fp(ag,h,c)},isEditable:function(C){var P=this;return C?P._editable?Km(C)?C.s("3d.editable")?P._editableFunc?P._editableFunc(C):!0:!1:!1:!1:P._editable},isSelectable:function(N){return N.s("3d.selectable")&&this.sm().isSelectable(N)},isMovable:function(F){var B=this;return Dn(F)&&F.getStyle(Th)!==Tp?!1:F.s("3d.movable")?B._movableFunc?B._movableFunc(F):!0:!1},isSizeEditable:function($){return Km($)?this._sizeEditableFunc?this._sizeEditableFunc($):!0:!1},isRotationEditable:function(Q){return Km(Q)&&Q.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Q):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(a){this.setZoom(bn,a)},zoomOut:function(N){this.setZoom(1/bn,N)},setZoom:function(){var $=new Zb,w=new Zb,G=new Zb,X=new Zb;return function(b,q){if(1!==b){var C=this;C._14o&&C._14o.stop(!0);var N,E=1/b;$.copy(C.getCenter()),w.copy(C.getEye());var j=C._ortho;if(j){if(N=C._orthoWidth,N<C._moveStep&&b>1)return}else if($.distanceTo(w)<C._moveStep&&1>E)return;var D=!1;return C._zoomToCenter===!1&&C._lastZoomLP&&(G.copy(w).sub($).normalize(),C._81O=null,X.copy(C.getHitPosition(C._lastZoomLP,$.toArray(),G.toArray())),D=!0,C._lastZoomHit=X),(q=Re(q))?(q.action=function(H){C.fi({kind:C._zooming?"betweenZoom":"beginZoom"}),C._zooming=1;var L=(E-1)*H+1;j&&C.setOrthoWidth(N*L),D?(C.setEye(G.lerpVectors(X,w,L).toArray()),C.setCenter(G.lerpVectors(X,$,L).toArray())):j||C.setEye(G.lerpVectors($,w,L).toArray())},q._37o=function(){delete C._14o,delete C._zooming,C.fi({kind:"endZoom"}),C.onZoomEnded()},C._14o=cj(q)):(j&&C.setOrthoWidth(N*E),D?(C.setEye(G.lerpVectors(X,w,E).toArray()),C.setCenter(G.lerpVectors(X,$,E).toArray())):j||C.setEye(G.lerpVectors($,w,E).toArray()),void 0)}}}(),setOrthoZoom:function(S,f){return this.setZoom(S,f)},getPositionInfo:function(O){var b=this,l=b._eye,s=b._center,c=b.getAspect(),r=O?mj(Wn(s,l,!0),Wn(O,l)):qd(l,s);if(b._ortho){var y=b._orthoWidth;return{length:r,height:y/c,width:y}}var D=2*$(b._fovy/2)*r;return{length:r,height:D,width:D*c}},getCenterInfo:function(){var Q=this;return Q._81O||(Q._81O=Q.getPositionInfo()),fq(Q._81O)},rotate:function(W,A,m,X){var n=this;if(W||A){X==w&&(X=n._firstPersonMode),n._88O&&n._88O.stop(!0);var U=n._center,_=n._eye,Q=n.getCenterInfo().length,P=X?U:_,D=X?_:U,t=Wn(P,D),v=K(t[0],t[2]),y=K(G(t[0]*t[0]+t[2]*t[2]),t[1]),i=X?Yg:yo;return X&&(A=-A),(m=Re(m))?(m.action=function(E){n.fi({kind:n._rotating?"betweenRotate":"beginRotate"}),n._rotating=1;var $=v+W*E,K=y+A*E;K=X?g-ll(n,g-K):ll(n,K),t[0]=Q*O(K)*O($),t[1]=Q*f(K),t[2]=Q*O(K)*f($),P[0]=D[0]+t[0],P[1]=D[1]+t[1],P[2]=D[2]+t[2],n.fp(i,w,P)},m._37o=function(){delete n._88O,delete n._rotating,n.fi({kind:"endRotate"}),n.onRotateEnded()},n._88O=cj(m)):(v+=W,y+=A,y=X?g-ll(n,g-y):ll(n,y),t[0]=Q*O(y)*O(v),t[1]=Q*f(y),t[2]=Q*O(y)*f(v),P[0]=D[0]+t[0],P[1]=D[1]+t[1],P[2]=D[2]+t[2],n.fp(i,w,P),void 0)}},pan:function(b,D,F,X){if(b||D){var J=this;X==w&&(X=J._firstPersonMode),J._89O&&J._89O.stop(!0);var Y=le(J),k=[Y[0]*b,Y[4]*b,Y[8]*b],O=[Y[1]*D,Y[5]*D,Y[9]*D],T=k[0]+O[0],f=k[1]+O[1],p=k[2]+O[2],o=J._center,g=J._eye;if(X){var n=Ch(J.getBoundaries(),g[0],g[2],g[0]+T,g[2]+p,G(T*T+p*p));T=n[0],p=n[1]}if(F=Re(F)){var q=fq(g),h=fq(o);return F.action=function(F){J.fi({kind:J._panning?"betweenPan":"beginPan"}),J._panning=1,o[0]=h[0]+T*F,o[1]=h[1]+f*F,o[2]=h[2]+p*F,g[0]=q[0]+T*F,g[1]=q[1]+f*F,g[2]=q[2]+p*F,J.fp(yo,w,g),J.fp(Yg,w,o)},F._37o=function(){delete J._89O,delete J._panning,J.fi({kind:"endPan"}),J.onPanEnded()},J._89O=cj(F)}o[0]+=T,o[1]+=f,o[2]+=p,g[0]+=T,g[1]+=f,g[2]+=p,J.fp(yo,w,g),J.fp(Yg,w,o)}},walk:function(h,X,L){if(h){var U=this;L==w&&(L=U._firstPersonMode),U._90O&&U._90O.stop(!0);var $=U._center,z=U._eye,S=Wn($,z,!0);if(L){var e=Ch(U.getBoundaries(),z[0],z[2],z[0]+S[0]*h,z[2]+S[2]*h,J(h));if(h=qd(e),!h)return;S=[e[0]/h,0,e[1]/h]}if(X=Re(X)){var y=fq(z),p=fq($);return X.action=function(I){U.fi({kind:U._walking?"betweenWalk":"beginWalk"}),U._walking=1;var T=h*I;z[0]=y[0]+S[0]*T,z[1]=y[1]+S[1]*T,z[2]=y[2]+S[2]*T,$[0]=p[0]+S[0]*T,$[1]=p[1]+S[1]*T,$[2]=p[2]+S[2]*T,U.fp(yo,w,z),U.fp(Yg,w,$)},X._37o=function(){delete U._90O,delete U._walking,U.fi({kind:"endWalk"}),U.onWalkEnded()},U._90O=cj(X)}z[0]+=S[0]*h,z[1]+=S[1]*h,z[2]+=S[2]*h,$[0]+=S[0]*h,$[1]+=S[1]*h,$[2]+=S[2]*h,U.fp(yo,w,z),U.fp(Yg,w,$)}},handleScroll:function(T,s){T.preventDefault();var O=this,N=O._moveStep,x=O.getDataInfoAt(T);if(x){var Q=x.data;if(Q&&O.isInteractive(Q)){var G=O.intersectObject(T,Q);if(G){var L=G.part,Y=Ub(Q.s(L+".image")||Q.s("shape3d."+L+".image")||Q.s("all.image")||Q.s("shape3d.image"));if(Y&&Pb(Y.scrollable,Q,O))return}}}return O.isFirstPersonMode()?(O.isPannable()&&O.pan(0,s>0?N:-N),void 0):(O.isZoomable()&&(O._lastZoomLP=O.lp(T),O.setZoom(0>s?1/On:On),O._lastZoomLP=O._lastZoomHit=null),void 0)},handlePinch:function(Z,e){if(this.isZoomable()){if(Math.abs(Z-e)<Y.pinchZoomThreshold)return;this.setZoom(e>Z?1/xs:xs)}},reset:function(){this.setCenter(Y.graph3dViewCenter),this.setEye(Y.graph3dViewEye),this.setUp(Y.graph3dViewUp)},moveSelection:function(B,g,o){var k=this;k.dm().beginTransaction(),$m(this.sm().toSelection(this.isMovable,this),B,g,o),k.dm().endTransaction()},getMoveMode:function(a,R){var n=R.s("3d.move.mode");if(n)return n;var V="88",G="89",S="90";return bg(a)||qi[V]&&qi[G]&&qi[S]?"xyz":qi[V]&&qi[G]?"xy":qi[V]&&qi[S]?"xz":qi[G]&&qi[S]?"yz":qi[V]?"x":qi[G]?"y":qi[S]?"z":"xz"},handleTick:function(){var e=this,P=!1,h=e._moveStep,z=h,p=!1,q=!0,j=e._rotateStep*(q?-1:1);if(e.isWalkable()||(z=0),e.isPannable()||(h=0),e.isRotatable()||(j=0),e._32Q){var n=(wk()-e._32Q)/50;z*=n,h*=n,j*=n}e._31Q&&(_m(e._31Q),delete e._31Q,delete e._32Q),qo()&&(P=!0,e.pan(-h,0,p,q)),ud()&&(P=!0,e.pan(h,0,p,q)),Gd()&&(P=!0,bg()?e.pan(0,h,p,q):e.walk(z,p,q)),nk()&&(P=!0,bg()?e.pan(0,-h,p,q):e.walk(-z,p,q)),Yf()&&(P=!0,e.rotate(-j,0,p,q)),Ve()&&(P=!0,e.rotate(j,0,p,q)),Cc()&&(P=!0,e.rotate(0,-j/2,p,q)),hs()&&(P=!0,e.rotate(0,j/2,p,q)),P&&(e._32Q=wk(),e._31Q=pm(e.handleTick,e))},handleKeyDown:function(I){var U=this;!Xm(I)&&Ti[I.keyCode]?U.handleTick():Ak(I)?U.selectAll():Zd(I)?U.handleDelete(I):Fg(I)&&this.isResettable()&&U.reset()},checkDoubleClickOnNote:function(V,Y,z){var X=this;if(z===uh){if(Y.s("note.toggleable"))return Y.s(dk,!Y.s(dk)),X.fi({kind:"toggleNote",event:V,data:Y,part:z}),!0}else if(z===Rd&&Y.s("note2.toggleable"))return Y.s(Mr,!Y.s(Mr)),X.fi({kind:"toggleNote2",event:V,data:Y,part:z}),!0;return!1},checkDoubleClickOnRotation:function(X,D,g){return g===oe?(D.setRotationX(0),!0):g===Dj?(D.setRotationY(0),!0):g===ej?(D.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(W){var h=this;if(h.isOrtho())return h.getWidth()/h.getOrthoWidth();var T=h.getCenter(),G=h.getHeight(),V=h.getEye(),j=[T[0]-V[0],T[1]-V[1],T[2]-V[2]],z=[W[0]-V[0],W[1]-V[1],W[2]-V[2]],S=Math.sqrt(j[0]*j[0]+j[1]*j[1]+j[2]*j[2]),I=1/Math.tan(h.getFovy()/2);return G*S*I/(z[0]*j[0]+z[1]*j[1]+z[2]*j[2])},inViewSpace:function(E){var Y,t=this,F=t._transformPointToViewSpace(E),j=t.getAspect(),I=t.getNear(),K=t.getFar();return-F[2]<I||-F[2]>K?!1:t.isOrtho()?(Y=t.getOrthoWidth()/2,Math.abs(F[0])<=Y&&Math.abs(F[1]*j)<=Y):(Y=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2])*Math.tan(t.getFovy()/2),Math.abs(F[1]<=Y)&&Math.abs(F[0])<=Y*j)},getPVMatrix:function(){var R,J=this;return(R=J._18Q)||(R=Nd(J),J._18Q=Kc(R,R,le(J)),J._18Q._wh=J.getWidth()/2/J.getHeight()),R},getFrustum:function(){var Y=new _p,r=new dg,M=new Array(16);return function(){for(var J=this.getPVMatrix(),q=!1,U=0;16>U;U++)J[U]!==M[U]&&(q=!0,M[U]=J[U]);return q&&r.setFromMatrix(Y.fromArray(J)),r}}(),toViewPosition:function(q){var j=this,s=j.getWidth()/2,b=j.getHeight()/2,J=j.getPVMatrix();return q=Fq([q[0],q[1],q[2],1],J),{x:s+s*q[0]/q[3],y:b-b*q[1]/q[3],z:q[2]/q[3]}},getHitPosition:function(V,R,q){var i=this,G=i.getWidth(),Q=i.getHeight(),w=V.target?i.lp(V):V,M=w.x-G/2,O=w.y-Q/2,f=i.getCenterInfo(),v=le(i);R=R?R:[0,0,0],q=q?q:[0,1,0],M=M/G*f.width,O=-1*O/Q*f.height;var p=[v[0]*M,v[4]*M,v[8]*M],u=[v[1]*O,v[5]*O,v[9]*O],$=[p[0]+u[0],p[1]+u[1],p[2]+u[2]],C=i.getCenter(),H=ob(i,R,q,[$[0]+C[0],$[1]+C[1],$[2]+C[2]]);return H?H:[0,0,0]},intersectObject:function(L,y){return this._raycaster.intersectObject(L,y)},intersectObjects:function(I,n,$){return this._raycaster.intersectObjects(I,n,$)},getLineLength:function(h){this.validate();var j=this.getData3dUI(h);if(j&&j.getCache){var v=j.getCache();if(v)return v[v.length-1].length}return 0},getLineOffset:function(e,K){var T=this.getData3dUI(e);if(T&&T.getCache){var y=T.getCache();if(y){var r=Xd(y,K);if(!e.r3)return r;var k=e.r3();if(0===k[0]&&0===k[1]&&0===k[2])return r;var V=new Zb(e.p3()),z=new Zb(r.point).sub(V),J=new Zb(r.tangent).add(z),x=(new _i).setFromEuler(new xc(k,e.getRotationMode(),!0));return z.applyQuaternion(x),J.applyQuaternion(x),{point:z.add(V),tangent:J.sub(z).normalize()}}}return w},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(T,p,y){var C=this,F=C.getEye();F=[F[0],F[1],F[2]];var b=C.getCenter();if(b=[b[0],b[1],b[2]],T||(T=F),p||(p=b),C._flyAnim&&C._flyAnim.stop(!0),y=Re(y),!y)return C.setEye(T[0],T[1],T[2]),C.setCenter(p[0],p[1],p[2]),delete C._flyAnim,!0;var V=[T[0]-F[0],T[1]-F[1],T[2]-F[2]],S=[p[0]-b[0],p[1]-b[1],p[2]-b[2]];return y.action=function(U){C.setCenter(b[0]+S[0]*U,b[1]+S[1]*U,b[2]+S[2]*U),C.setEye(F[0]+V[0]*U,F[1]+V[1]*U,F[2]+V[2]*U)},y._37o=function(){delete C._flyAnim},C._flyAnim=cj(y)},flyTo:function(){function D(M,i,L){if(L instanceof s.Node){B.fromArray(ub(L,i.getMat(L)));var n=L.getAnchor3d();M.push((new Zb).set(0-n.x,0-n.y,0-n.z).applyMatrix4(B)),M.push((new Zb).set(0-n.x,0-n.y,1-n.z).applyMatrix4(B)),M.push((new Zb).set(0-n.x,1-n.y,0-n.z).applyMatrix4(B)),M.push((new Zb).set(0-n.x,1-n.y,1-n.z).applyMatrix4(B)),M.push((new Zb).set(1-n.x,0-n.y,0-n.z).applyMatrix4(B)),M.push((new Zb).set(1-n.x,0-n.y,1-n.z).applyMatrix4(B)),M.push((new Zb).set(1-n.x,1-n.y,0-n.z).applyMatrix4(B)),M.push((new Zb).set(1-n.x,1-n.y,1-n.z).applyMatrix4(B))}}var $=new Zb,N=new Zb,j=new Zb,Y=new Zb,B=new _p,w=new s.Math.Quaternion,P=new xc,v=new Xi;return function(C,q,Q){var f=this;if(Q!==r)q={animation:q,ratio:Q};else{var z=typeof q;("boolean"===z||"object"===z&&q.duration)&&(q={animation:q})}q=q||{},$.fromArray(f.getEye()),N.fromArray(f.getCenter());var a,o,k=[],h=q.center,V=q.distance===r;if(h&&j.fromArray(h),C instanceof s.Node)h||j.fromArray(C.p3()),V&&(D(k,f,C),a=k.length);else{if(C||(C=f.dm().getDatas()),!C.length)return;if((V||!h)&&(k=[],C.forEach(function(w){D(k,f,w)}),a=k.length,!a))return;h||(v.setFromPoints(k),j.copy(v.min).add(v.max).multiplyScalar(.5))}if(f.setCenter(j.x,j.y,j.z),Y.subVectors($,N),q.direction||q.worldDirection){!q.worldDirection&&C instanceof s.Node?w.setFromEuler(P.set(C.r3(),C.getRotationMode(),!0)):w.set(0,0,0,1);var F=Y.length();Y.fromArray(q.worldDirection||q.direction).applyQuaternion(w).setLength(F)}var x=0;if(V){var H,y,B,Q=q.ratio||.8,t=q.xRatio||Q,J=q.yRatio||Q;if(f.isOrtho()){var W=-1/0;for(f._eye[0]=Y.x+j.x,f._eye[1]=Y.y+j.y,f._eye[2]=Y.z+j.z,H=Nd(f),Kc(H,H,le(f)),o=0;a>o;o++)B=k[o],y=Fq([B.x,B.y,B.z,1],H),W=Math.max(W,Math.max(Math.abs(y[0])/t,Math.abs(y[1])/J));x=f.getOrthoWidth()*W,Y.add(j)}else{for(var l,u,Z=f.getNear(),O=10;O--;){for(f._eye[0]=Y.x+j.x,f._eye[1]=Y.y+j.y,f._eye[2]=Y.z+j.z,H=Nd(f),Kc(H,H,le(f)),l=!0,u=-1/0,o=0;a>o;o++){if(B=k[o],y=Fq([B.x,B.y,B.z,1],H),y[3]<Z&&O){Y.multiplyScalar(2),l=!1;break}u=Math.max(u,Math.max(Math.abs(y[0])/t,Math.abs(y[1])/J)-y[3])}if(l)break}Y.setLength(u+Y.length()).add(j)}}else Y.setLength(q.distance).add(j);f._flyAnim&&f._flyAnim.stop(!0);var n=Re(q.animation);if(n){f.setEye($.x,$.y,$.z),f.setCenter(N.x,N.y,N.z);var I=(new Zb).subVectors(Y,$),e=(new Zb).subVectors(j,N);if(x)var M=f.getOrthoWidth();var i=new Zb,d=new Zb,c=n.action,L=n._37o,S=$.clone(),U=N.clone();return n.action=function(r,G){i.copy(S).addScaledVector(I,r),d.copy(U).addScaledVector(e,r),f.setCenter(d.x,d.y,d.z),f.setEye(i.x,i.y,i.z),x&&f.setOrthoWidth((x-M)*r+M),c&&c(r,G)},n._37o=function(){delete f._flyAnim,L&&L()},{lastEye:$,lastCenter:N,eye:Y,center:j,orthoWidth:x,animation:f._flyAnim=cj(n)}}return f.setEye(Y.x,Y.y,Y.z),x&&f.setOrthoWidth(x),delete f._flyAnim,{lastEye:$,lastCenter:N,eye:Y,center:j,orthoWidth:x}}}(),getBoundingBox:function(){function V(y,b,L){r.fromArray(ub(L,b.getMat(L)));var _=L.getAnchor3d();y.push((new Zb).set(0-_.x,0-_.y,0-_.z).applyMatrix4(r)),y.push((new Zb).set(0-_.x,0-_.y,1-_.z).applyMatrix4(r)),y.push((new Zb).set(0-_.x,1-_.y,0-_.z).applyMatrix4(r)),y.push((new Zb).set(0-_.x,1-_.y,1-_.z).applyMatrix4(r)),y.push((new Zb).set(1-_.x,0-_.y,0-_.z).applyMatrix4(r)),y.push((new Zb).set(1-_.x,0-_.y,1-_.z).applyMatrix4(r)),y.push((new Zb).set(1-_.x,1-_.y,0-_.z).applyMatrix4(r)),y.push((new Zb).set(1-_.x,1-_.y,1-_.z).applyMatrix4(r))}var r=new _p;return function(D){if(D=D||this.sm().getSelection(),D instanceof s.Node&&(D=[D]),0===D.length)return w;var R=[];D.forEach(function(o){Km(o)&&V(R,this,o)},this);var l=[1/0,1/0,1/0],M=[-1/0,-1/0,-1/0];return R.forEach(function(h){l[0]=Math.min(h.x,l[0]),l[1]=Math.min(h.y,l[1]),l[2]=Math.min(h.z,l[2]),M[0]=Math.max(h.x,M[0]),M[1]=Math.max(h.y,M[1]),M[2]=Math.max(h.z,M[2])}),{min:l,max:M}}}(),setBatchInfo:function(m,I){var f=this._batchInfoMap[m];this._batchInfoMap[m]=I,this.fp("batchInfo",f,I)},getBatchInfo:function(B){return this._batchInfoMap[B]||Cs[B]}}),Lq.RenderEnv=function(b){this.gv=b,this.enable=!1},R.defineProperties(Lq.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(g){this._debugOn=g,this.capture&&this.capture()}}}),R.assign(Lq.RenderEnv.prototype,{renderEnvToCube:function(Y,I,j,m){var i=this,E=i.gv;if(!Y||!I||!j)return i.enable=!1,i._42=null,void 0;i.enable=!0;var X=Math.floor(m/Y*I),H=E.getGL(),d=i._renderTargets;d?d.length<j&&(d=i._renderTargets=d.concat(new Array(j-d.length))):d=i._renderTargets=new Array(j);for(var b=0;j>b;b++)d[b]?d[b].setSize(H,m,X):d[b]=new Lq.RenderTarget(E,H,m,X);var O=!1;i.capture=function(){O=!0,E._42(),O=!1};var J=new Zb,g=new Zb,R=new Zb,F=new Zb,e=(new Zb).setY(0),c=2*Math.PI/j,l=Y/2/Math.tan(Math.PI/j),B=2*Math.atan2(I/2,l),V=Y/I;i._42=function(p,D,I,h){var N=i._debugOn;if(!O&&!N)return!1;J.copy(E.getEye()),F.copy(E.getCenter()).sub(J);var k=Math.atan2(F.z,F.x),o=E.getNear(),U=E.getFovy(),q=E.getAspect();g.copy(E.getCenter());for(var A,x=0;j>x;x++)if(A=d[x],e.setZ(Math.cos(k)).setX(Math.sin(k)).multiplyScalar(l),k-=c,R.addVectors(J,e),E.setNear(l),E.setCenter([R.x,R.y,R.z]),E.setFovy(B),E.setAspect(V),N){var f=Math.round(D/j);Qp.for(p).glState.viewport=[f*x,0,f,I],h()}else lc(p,A.frame),Qp.for(p).glState.viewport=[0,0,A.width,A.height],p.clear(p.COLOR_BUFFER_BIT),h(),sm(p),A.assureTexture();return E.setNear(o),E.setCenter([g.x,g.y,g.z]),E.setFovy(U),E.setAspect(q),!0},i.capture()},getTextureInfo:function(F){var y=this._renderTargets;if(!y)return null;var T=this._renderTargets[F];return T?{index:F,texture:T.texture,textureName:T.uuid}:null}}),R.assign(Lq.Graph3dView.prototype,{renderEnvToCube:function(M,N,d,c){var E=this;E.envRenderer||(E.envRenderer=new Lq.RenderEnv(E)),E.envRenderer.renderEnvToCube(M,N,d,c)}});var ad=["left","front","right","back","top","bottom"],wi=Lq._RenderList=function(){function K(){z.length=0,l.length=0,T={}}function O(D){var F=D.gv,k=D.data;if(a&&!Dq)return D._renderParams=null,void 0;var o,t,B,m,$=D.shapeModel;if($){var q,X,G,j=k.s("shape3d.transparent")||k.s("points.transparent");for(wd($)||(q=Pb($.transparent,k,F),$=[$]),B=0,m=$.length;m>B;B++)G=$[B],X=Pb(G.transparent,k,F),X===r&&(X=q),X===r&&(X=j),X?t=!0:o=!0}for(B=0,m=ad.length;m>B;B++){var I=D[ad[B]];I&&(I.transparent?t=!0:o=!0)}F.isLabelVisible(k)&&(D.labelInfo&&(k.s(Ij+".transparent")?t=!0:o=!0),D.label2Info&&(k.s(pl+".transparent")?t=!0:o=!0)),F.isNoteVisible(k)&&(D.noteInfo&&(k.s(uh+".transparent")?t=!0:o=!0),D.note2Info&&(k.s(Rd+".transparent")?t=!0:o=!0)),D._38o&&(t=o=!0),t||(o=!0),D._renderParams={opaque:o,transparent:t}}function V(d,W){W&&O(d);var S=d.data,Z=S._id;if(!T[Z]){T[Z]=!0;var i=d._renderParams;i&&i.visible!==!1&&(d={ui:d,data:S,z:S._z,id:Z},i.opaque&&z.push(d),i.transparent&&l.push(d))}}function i(){z.length>1&&z.sort(U),l.length>1&&l.sort(W)}function F(a){a?(Kl(s,j,a),Kl(J,y,a),Kl(_,X,a)):(s=this.batchModelMap={},j=this.batchIndexMap={},J=this.polylineModelMap={},y=this.polylineIndexMap={},_=this.wireframeModelMap={},X=this.wireframeIndexMap={}),this.markBatchInvalid()}function $(U){U?Kl(s,j,U):(s=this.batchModelMap={},j=this.batchIndexMap={}),this.markBatchInvalid()}function n(x){x?Kl(J,y,x):(J=this.polylineModelMap={},y=this.polylineIndexMap={}),this.markBatchInvalid()}function k(g){g?Kl(_,X,g):(_=this.wireframeModelMap={},X=this.wireframeIndexMap={}),this.markBatchInvalid()}function H(){return this._batchInvalid}function R(){this._batchInvalid=!0}function A(){this._batchInvalid=null}var z=[],l=[],s={},j={},J={},y={},_={},X={},T={};return{opaque:z,transparent:l,init:K,push:V,batchModelMap:s,batchIndexMap:j,polylineModelMap:J,polylineIndexMap:y,wireframeModelMap:_,wireframeIndexMap:X,ivBatch:F,ivModelBatch:$,ivPolylineBatch:n,ivWireframeBatch:k,markBatchInvalid:R,isBatchInvalid:H,onUpdated:A,sort:i}},Qr=Lq._RenderLists=function(){function g(){for(var k in L)L[k].init()}function l(){for(var z in L)L[z].onUpdated()}function z(g,O){g=g||"main";var H=L[g];return!H&&O&&(H=L[g]=new wi),H}function r(D,y){var U=D.data.getRenderLayer(),I=z(U,!0);I.push(D,y)}function f(W){for(var Z in L)W(L[Z])}var L={};return{init:g,onUpdated:l,get:z,push:r,each:f,lists:L}},wl=Lq.RenderTarget=function(M,I,Q,S,z){var Y=this;z=z||{},z.samples=Math.min(M._glCapabilities.maxSamples,z.samples&&z.samples>1&&2===M._webGLVersion?z.samples:0),Y.options=z,Y.uuid=s.Math.generateUUID(),Y.gv=M,Y.init(M,I,z),z.samples&&!M._glCapabilities._maxSamplesChecked?Y.setSize(I,Q||1,S||1):Y.setSize(I,Q,S)};R.assign(Lq.RenderTarget.prototype,{bind:function(H){lc(H,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(m){sm(m),this.options.samples&&(m.bindFramebuffer(m.READ_FRAMEBUFFER,this._MSAAFbo),m.bindFramebuffer(m.DRAW_FRAMEBUFFER,this.frame),m.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,m.COLOR_BUFFER_BIT,m.NEAREST),m.bindFramebuffer(m.READ_FRAMEBUFFER,null),m.bindFramebuffer(m.DRAW_FRAMEBUFFER,null))},init:function(H,O,F){var Z=this,y=Z.texture=O.createTexture();O.activeTexture(O.TEXTURE0),me(O,y);var R=F.samples,p=R?O.NEAREST:O.LINEAR;O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,F.minFilter||p),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,F.magFilter||p),me(O,null),Z.render=O.createRenderbuffer(),Z.frame=O.createFramebuffer(),H._2O[Z.uuid]=y},assureTexture:function(){var t=this,k=t.uuid,P=t.gv._2O;P[k]||(P[k]=t.texture)},setSize:function(B,z,E){var f=this;if(z&&E&&(f.width!==z||f.height!==E)){var a=B.RGBA,h=B.TEXTURE_2D,t=B.RENDERBUFFER,T=B.FRAMEBUFFER,F=f.options.samples;if(B.activeTexture(B.TEXTURE0),me(B,f.texture),B.texImage2D(h,0,a,z,E,0,a,B.UNSIGNED_BYTE,w),ar.isPOT(z)&&ar.isPOT(E)&&!f.options.clampToEdge?(B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.REPEAT),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.REPEAT)):(B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_T,B.CLAMP_TO_EDGE)),B.bindRenderbuffer(t,f.render),F){var R=f.gv._glCapabilities;if(R._maxSamplesChecked)B.renderbufferStorageMultisample(t,F,B.DEPTH_COMPONENT16,z,E);else{for(B.getError();F>1&&(B.renderbufferStorageMultisample(t,F,B.DEPTH_COMPONENT16,z,E),B.getError());)F=Math.floor(F>>1);1>=F&&(F=0,B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,f.options.minFilter||B.LINEAR),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,f.options.magFilter||B.LINEAR),B.renderbufferStorage(t,B.DEPTH_COMPONENT16,z,E)),R._maxSamplesChecked=!0,R.maxSamples=f.options.samples=F}}else B.renderbufferStorage(t,B.DEPTH_COMPONENT16,z,E);F&&!f._MSAAFbo&&(f._MSAAFbo=B.createFramebuffer(),f._MSAARbO=B.createRenderbuffer()),lc(B,f.frame),B.framebufferTexture2D(T,B.COLOR_ATTACHMENT0,h,f.texture,0),F||B.framebufferRenderbuffer(T,B.DEPTH_ATTACHMENT,t,f.render),sm(B),F&&(B.bindRenderbuffer(B.RENDERBUFFER,f._MSAARbO),B.renderbufferStorageMultisample(B.RENDERBUFFER,F,B.RGBA8,z,E),lc(B,f._MSAAFbo),B.framebufferRenderbuffer(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.RENDERBUFFER,f._MSAARbO),B.framebufferRenderbuffer(T,B.DEPTH_ATTACHMENT,t,f.render),sm(B)),me(B,w),B.bindRenderbuffer(t,w),f.width=z,f.height=E}},toCanvas:function(){var n=this,k=n.gv.getGL();lc(k,n.frame);var U=n.width,V=n.height,x=new Uint8Array(4*U*V);k.readPixels(0,0,U,V,k.RGBA,k.UNSIGNED_BYTE,x),sm(k);var t=A.createElement("canvas");t.width=U,t.height=V;var S=t.getContext("2d"),u=S.createImageData(U,V);return u.data.set(x),S.putImageData(u,0,0),t}});var bd=Lq.Interactor=function(K){this.gv=this.g3d=K};dd("Interactor",R,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(S){this.gv.fi(S)},startDragging:function(z){Ah(this,z)}});var sl=Lq.DefaultInteractor=function(c){Lh(sl,this,[c])};dd("DefaultInteractor",bd,{getDataInfoAt:function(r,h){var c=this.gv,Z=c.getDataInfoAt(r);if(!c.isBlockSelectable()||!Z||!Z.data)return Z;if(!h&&c.isSelected(Z.data))return Z;for(var o=Z.data;(o=o.getParent())&&o instanceof s.Block&&c.isSelectable(o);){var I=c.isSelected(o);if(I&&h)break;if(Z={data:o,part:Z},I&&!h)break}return Z},handle_contextmenu:function(K){mc(K)},handle_mousewheel:function(d){this.gv.handleScroll(d,d.wheelDelta/40)},handle_DOMMouseScroll:function(q){2===q.axis&&this.gv.handleScroll(q,-q.detail)},handle_keydown:function(c){this.gv.handleKeyDown(c)},handle_mousedown:function(V){this.handle_touchstart(V)},handle_touchstart:function(v){mc(v);var T=this,C=T.gv,m=yf(v),B=T.getDataInfoAt(v),F=B?B.data:w,L=B?B.part:w,x=C.sm(),l=If(v),A=Sf(v);C.setFocus(v)&&(T._62O=w,T._57I=w,T.pendingClickThrough=w,T.__lastClientPoint__=$c(v),F?Xm(v)?x.co(F)?x.rs(F):x.as(F):x.co(F)?F instanceof So&&F.isClickThroughEnabled()&&yf(v)&&(T.pendingClickThrough=$c(v)):x.ss(F):m&&(Xm(v)?C.isRectSelectable()&&(T._62O=nq):T._57I=$c(v)),T._31Q&&(_m(T._31Q),delete T._31Q,delete T._32Q),T._62O||(C.isFirstPersonMode()&&(bg(v)||Tf(v)||A>2?T._62O="pan":C.isMouseRoamable()||Rl(v)?(T._62O="roaming",T.foward=l&&yf(v),T._32Q=wk(),T._31Q=pm(T.tick,T)):m||(T._62O="roaming")),T._62O||(m&&l&&Ml[L]?(T._62O=L,T.p3=F.p3()):m&&l&&Km(F)&&C.isSelected(F)?C.isMovable(F)?(T._62O="move",T.p3=F.p3(),T.movedata=F):C._39Q(F)&&(T._62O="none"):Rl(v)&&(A>2?T._62O="pan":2===A&&(T.dist=eo(v),T._62O="pinch")))),T.point=C.lp(v),Ah(T,v),Ir(v)?C.handleDoubleClick(v,F,L):C.handleClick(v,F,L))},tick:function(){var I=this,J=I.gv,O=J._moveStep;I.point&&J.isWalkable()&&(I._32Q&&(O*=(wk()-I._32Q)/50),J.walk(I.foward?O:-O),I._32Q=wk(),I._31Q=pm(I.tick,I))},handle_mouseup:function(g){this.handle_touchend(g)},handle_touchend:function(Q){var A=this._57I;if(A&&(qd(A,$c(Q))<=1&&this.gv.sm().cs(),this._57I=w),A=this.pendingClickThrough){if(qd(A,$c(Q))<=1){var B=this.getDataInfoAt(Q);B&&B.data instanceof So&&B.data.isClickThroughEnabled()&&(B=this.getDataInfoAt(Q,!0),B&&(Q.clickThrough=!0,this.gv.sm().ss(B.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(X){var q,Q,H=this,m=H.gv,t=H._62O,w=H.point,M=m.dm(),V=m.lp(X),v=V.x-w.x,K=V.y-w.y,n=m.getWidth(),g=m.getHeight();if(n&&g){var G=$c(X),P=ps(m,G,H.__lastClientPoint__),d=qd({x:0,y:0},P),B=-c*v/n,b=-c*K/g;if("roaming"===t)H.rotate(X,B/2,b/2);else if(t===oe||t===Dj||t===ej)m._86O||M.beginTransaction(),m.fi({kind:m._86O?"betweenEditRotation":"beginEditRotation",event:X}),m._86O=1,m.sm().each(function(E){if(Km(E)&&m.isRotationEditable(E)){var R=J(B)>J(b)?B:b;t===oe?E.setRotationX(E.getRotationX()+R):t===Dj?E.setRotationY(E.getRotationY()+R):t===ej&&E.setRotationZ(E.getRotationZ()+R)}});else if("move"===t||Ml[t]){if(t===Kf||t===Br||t===Go)m._87O||M.beginTransaction(),m.fi({kind:m._87O?"betweenEditScale":"beginEditScale",event:X}),m._87O=1;else{if(!m._moving){if(d<Y.touchMoveThreshold)return;M.beginTransaction()}m.fi({kind:m._moving?"betweenMove":"beginMove",event:X}),m._moving=1}var F,N=H.p3,f=m.getPositionInfo(N),k=le(m);F=t===dp?"x":t===Cg?"y":t===_r?"z":t===Kf?"sx":t===Br?"sy":t===Go?"sz":m.getMoveMode(X,H.movedata),v=v/n*f.width,K=-1*K/g*f.height;var C,o,x=[k[0]*v,k[4]*v,k[8]*v],i=[k[1]*K,k[5]*K,k[9]*K],R=x[0]+i[0],y=x[1]+i[1],s=x[2]+i[2],Z=[N[0]+R,N[1]+y,N[2]+s],$=Wn(m.getEye(),Z,!0);if("xyz"===F?(C=Z,m.moveSelection(R,y,s)):"xz"===F?(C=ob(m,N,[0,1,0],Z),C&&m.moveSelection(C[0]-N[0],0,C[2]-N[2])):"xy"===F?(C=ob(m,N,[0,0,1],Z),C&&m.moveSelection(C[0]-N[0],C[1]-N[1],0)):"yz"===F?(C=ob(m,N,[1,0,0],Z),C&&m.moveSelection(0,C[1]-N[1],C[2]-N[2])):"x"===F||"sx"===F?($[0]=0,C=ob(m,N,$,Z),C&&(o=C[0]-N[0],"x"===F?m.moveSelection(o,0,0):m.sm().each(function(d){Km(d)&&m.isSizeEditable(d)&&(q=d.getScaleX()+o/100,Q=q/d.getScaleX(),d.setScaleX(q),bg(X)&&(d.setScaleY(d.getScaleY()*Q),d.setScaleTall(d.getScaleTall()*Q)))}))):"y"===F||"sy"===F?($[1]=0,C=ob(m,N,$,Z),C&&(o=C[1]-N[1],"y"===F?m.moveSelection(0,o,0):m.sm().each(function(r){Km(r)&&m.isSizeEditable(r)&&(q=r.getScaleTall()+o/100,Q=q/r.getScaleTall(),r.setScaleTall(q),bg(X)&&(r.setScaleY(r.getScaleY()*Q),r.setScaleX(r.getScaleX()*Q)))}))):("z"===F||"sz"===F)&&($[2]=0,C=ob(m,N,$,Z),C&&(o=C[2]-N[2],"z"===F?m.moveSelection(0,0,o):m.sm().each(function(a){Km(a)&&m.isSizeEditable(a)&&(q=a.getScaleY()+o/100,Q=q/a.getScaleY(),a.setScaleY(q),bg(X)&&(a.setScaleX(a.getScaleX()*Q),a.setScaleTall(a.getScaleTall()*Q)))}))),!C)return;H.p3=C}else if(t===nq){var p=H.div;p||(p=H.div=Zn(),Ld(H.getView(),p),p.op=w,p.style.background=m.getRectSelectBackground()),m.fi({kind:m._rectSelecting?"betweenRectSelect":"beginRectSelect",event:X}),m._rectSelecting=1,p.rect=ln(p.op,V),Ni(p,p.rect)}else if("pinch"===t&&2===Sf(X)){m.fi({kind:m._pinching?"betweenPinch":"beginPinch",event:X}),m._pinching=1;var o=eo(X);m._lastZoomLP||(m._lastZoomLP=Wf(X)),m.handlePinch(o,H.dist),H.dist=o}else"pan"===t||bg(X)||Tf(X)?H.pan(X,v,K):"none"===t||m.isFirstPersonMode()||H.rotate(X,B,b);H.point=V}},pan:function($,c,R){var F=this.gv;if(F.isPannable()){var h=F.getWidth(),K=F.getHeight();if(!h||!K)return;var o=F.getCenterInfo(),d=c/h*o.width,b=-1*R/K*o.height;F.fi({kind:F._panning?"betweenPan":"beginPan",event:$}),F._panning=1,F.pan(-d,-b)}},rotate:function(F,c,p){var Y=this.gv;Y.isRotatable()&&(Y.fi({kind:Y._rotating?"betweenRotate":"beginRotate",event:F}),Y._rotating=1,Y.rotate(c,p))},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(m){var l=this,h=l.gv,f=h.dm(),U=l.div;if(U){var Q=h.getDatasInRect(U.rect);if(!Q.isEmpty()){var V=h.sm(),y=V.toSelection();Q.each(function(r){V.co(r)?y.remove(r):y.add(r)
}),V.ss(y)}zk(U)}h._moving&&(delete h._moving,h.fi({kind:"endMove",event:m}),h.onMoveEnded(),f.endTransaction()),h._panning&&(delete h._panning,h.fi({kind:"endPan",event:m}),h.onPanEnded()),h._rotating&&(delete h._rotating,h.fi({kind:"endRotate",event:m}),h.onRotateEnded()),h._86O&&(delete h._86O,h.fi({kind:"endEditRotation",event:m}),f.endTransaction()),h._87O&&(delete h._87O,h.fi({kind:"endEditScale",event:m}),f.endTransaction()),h._pinching&&(delete h._pinching,h.fi({kind:"endPinch",event:m}),h.onPinchEnded()),h._rectSelecting&&(delete h._rectSelecting,h.fi({kind:"endRectSelect",event:m}),h.onRectSelectEnded()),h._walking&&(delete h._walking,h.fi({kind:"endWalk",event:m}),h.onWalkEnded()),h._lastZoomLP=h._lastZoomHit=null,l.dist=l.point=l._62O=l.p3=l.movedata=l.div=l._57I=l.pendingClickThrough=l._32Q=l._31Q=l.foward=w,l.__lastClientPoint__=w}});var Bn=Lq.MapInteractor=function(e){Lh(Bn,this,[e]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};dd("MapInteractor",bd,{handle_contextmenu:function(O){mc(O)},handle_mousewheel:function(g){this.gv.handleScroll(g,g.wheelDelta/40)},handle_DOMMouseScroll:function(c){2===c.axis&&this.gv.handleScroll(c,-c.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(r){mc(r);var d=this,c=d.gv;if(c.setFocus(r)){var T=c.getDataInfoAt(r),I=T?T.data:w,W=T?T.part:w,n=d.editing={point:c.lp(r)};Rl(r)?n.touch=!0:(n.touch=!1,n.clickLeft=yf(r),n.pan=Tf(r)?!0:"left"===this.panButton===n.clickLeft),I&&c._39Q(I)&&(n.preventDefault=!0),Ah(d,r),Ir(r)?c.handleDoubleClick(r,I,W):c.handleClick(r,I,W)}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(){},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(D){var u=this,z=u.gv,i=u.editing;if(i){var l=z.lp(D),V=i.point,O=l.x-V.x,H=l.y-V.y;if(!i.moved){if(Math.abs(O)<u.threshold&&Math.abs(H)<u.threshold&&!(D.touches&&D.touches.length>1))return;i.moved=!0}if(!i.preventDefault)if(i.point=l,i.touch){var R=D.touches.length;if(2!==R)u.pan(D,O,H);else{if(1>=R)return;var f=D.touches,j={x:f[0].clientX,y:f[0].clientY},$={x:f[1].clientX,y:f[1].clientY},I={x:$.x-j.x,y:$.y-j.y},W=i.lastCenter,k=Math.atan2(I.y,I.x),t=i.theta,Y=0;t==w?t=i.theta=k:(Y=k-t,i.thetaStarted||Math.abs(Y)>u.touchRotateThreshold?(i.thetaStarted=!0,i.theta=k):Y=0);var C=g*(j.y+$.y)/2/z.getHeight(),G=i.phi,P=0;G==w?G=i.phi=C:(P=C-G,i.phiStarted||Math.abs(P)>u.touchRotateThreshold?(i.phiStarted=!0,i.phi=C):P=0);var p,N=Math.sqrt(I.x*I.x+I.y*I.y),M=i.vlen;if(M){var y=j.x-W.x,K=j.y-W.y,Q=$.x-W.x,o=$.y-W.y,J=Math.sqrt(y*y+K*K),B=Math.sqrt(Q*Q+o*o),s=M/2,U=u._sign2(J-s),r=u._sign2(B-s);0>U*r||0===U&&0===r?(p=1,i.vlen=N):(p||(p=N/M),i.scaleStarted||Math.abs(p-1)>u.touchScaleThreshold?(i.vlen=N,i.scaleStarted=!0):p=1)}else M=i.vlen=N,p=1;1!==p&&z.setZoom(p),(P||Y)&&u.rotate(D,Y,-P),i.lastCenter={x:($.x+j.x)/2,y:($.y+j.y)/2}}}else if(i.pan)u.pan(D,O,H);else{var E=z.getWidth(),Z=z.getHeight();if(!E||!Z)return;var e=-c*O/E,v=-c*H/Z;u.rotate(D,e,v)}}},_sign2:function(b){return Math.abs(b)<this._touchScaleCheckAccuracy?0:b>0?1:-1},handleWindowMouseUp:function(S){this.handleWindowTouchEnd(S)},handleWindowTouchEnd:function($){var r=this,I=r.editing;if(r.editing=null,I){var V=r.gv;if(I.moved||!I.clickLeft&&!I.touch)V._panning=null,V._rotating=null,V.fi({kind:I.pan?"endPan":"endRotate",event:$});else{var Q=V.getDataAt($);Q?V.sm().setSelection([Q]):V.sm().clearSelection()}}},pan:function(l,H,K){var Z=this,s=Z.gv;if(s.isPannable()){var F=s.getWidth(),x=s.getHeight();if(F&&x){var h=s.getCenterInfo(),Y=-H/F*h.width,f=1*K/x*h.height;s.fi({kind:s._panning?"betweenPan":"beginPan",event:l}),s._panning=1;var p=Z.keepHorizon,E=Z.editing.touch;if((E&&l.touches&&l.touches.length>1||!E&&bg(l))&&(p=!p),!p)return s.pan(Y,f);if(Y||f){var k=le(s),R=[k[0]*Y,k[4]*Y,k[8]*Y],z=[k[1],0,k[9]],V=Math.sqrt(z[0]*z[0]+z[2]*z[2]);V&&(z=[z[0]/V*f,0,z[2]/V*f]);var I=R[0]+z[0],X=R[1]+z[1],P=R[2]+z[2],t=s._center,O=s._eye;t[0]+=I,t[1]+=X,t[2]+=P,O[0]+=I,O[1]+=X,O[2]+=P,s.fp(yo,w,O),s.fp(Yg,w,t)}}}},rotate:function(v,s,x){var o=this,P=o.gv;if(P.isRotatable()){var j=P._center,F=P._eye,T=Wn(F,j),W=K(G(T[0]*T[0]+T[2]*T[2]),T[1]),M=ll(P,W+x);x=M-W,P.fi({kind:P._rotating?"betweenRotate":"beginRotate",event:v}),P._rotating=1,P.rotate(s,x)}}}),R.defineProperties(Bn.prototype,{panButton:{get:function(){return this._panButton},set:function(L){this._panButton=L}},minPhi:{get:function(){return this.gv.getRotateMinPhi()},set:function(N){this.gv.setRotateMinPhi(N)}},maxPhi:{get:function(){return this.gv.getRotateMaxPhi()},set:function(T){this.gv.setRotateMaxPhi(T)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(G){this._keepHorizon=G}},threshold:{get:function(){return this._threshold},set:function(h){this._threshold=h}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(z){this._touchScaleThreshold=z}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(r){this._touchRotateThreshold=r}}});var pj,cp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",vr=32,Yh=Lq.GlobeInteractor=function(U,g){Lh(Yh,this,[U]);var i,T=g.radius||6378137,e=this,m=null;pj||(pj=Zn(),pj.style.border="",pj.style.backgroundImage="url("+cp+")");var K=new _i,$=new Zb,b=new Zb,n=new Zb,u=new Vm,x="number"==typeof T?{x:T,y:T,z:T}:T,C={center:new Zb(0,0,0),radius:x},Z=function(A){U._81O=null;var f=U.getHitPosition(A,U.getCenter(),$.copy(U.getEye()).sub(b.copy(U.getCenter())).toArray());return u.origin.copy(U.getEye()),u.direction.copy(f).sub(u.origin).normalize(),u.intersectEllipsoid(C)},A=function(F,w){U._81O=null,u.origin.copy(U.getEye());for(var Y,L,v=U.getCenter(),i=$.copy(U.getEye()).sub(b.copy(U.getCenter())).toArray(),S=1,T=16,d=0,z=1,N={x:0,y:0};T--;){if(N.x=w.x+(F.x-w.x)*S,N.y=w.y+(F.y-w.y)*S,Y=U.getHitPosition(N,v,i),u.direction.copy(Y).sub(u.origin).normalize(),L=u.intersectEllipsoid(C),L&&1===S)return{hit:L};L?d=S:z=S,S=(d+z)/2}return{hit:L,out:1>S}},D=function(u,X){if(m){var b=Date.now();m.deltaTime=m.lastTime?b-m.lastTime:1e3,m.lastTime=b,m.lastAxis=u,m.lastAngle=X}X&&(K.setFromAxisAngle(u,X),U.setEye($.copy(U.getEye()).applyQuaternion(K).toArray()),U.setCenter($.copy(U.getCenter()).applyQuaternion(K).toArray()),U.setUp($.copy(U.getUp()).applyQuaternion(K).toArray()))};e._showCrossIcon=function(S){Ld(e.getView(),pj),Ni(pj,{x:S.clientX-vr/2,y:S.clientY-vr/2,width:vr,height:vr})},e._hideCrossIcon=function(){zk(pj)},e._scrollImpl=function(E,z){m={point:U.lp(E),screen:$c(E),hit:Z(E),type:"right"},m.hitNormalize=m.hit?m.hit.clone().normalize():new Zb;var n={clientX:m.screen.x,clientY:m.screen.y+10*z};e._handleMoveImpl(n),e._endMoveImpl(n)},e._startMoveImpl=function(X){i&&(i.stop(!0),i=null),m={point:U.lp(X),screen:$c(X),hit:Z(X)},m.hitNormalize=m.hit?m.hit.clone().normalize():new Zb,Rl(X)?1===X.touches.length?m.hit&&(m.type="left"):2===X.touches.length&&(m.type="touch2"):(yf(X)?m.hit&&(m.type="left"):nr(X)?m.type="right":Tf(X)&&m.hit&&(m.type="middle"),!m.hit||"right"!==m.type&&"middle"!==m.type||e._showCrossIcon(X)),m.type&&Ah(e,X)},e._handleMoveImpl=function(y){if(m)switch(m.type){case"left":return e._handleLeft(y);case"right":return e._handleRight(y);case"middle":return e._handleMiddle(y);case"touch2":return e._handleTouch2(y)}},e._endMoveImpl=function(){if(m){if(this._hideCrossIcon(),"left"===m.type||"middle"===m.type){var h=1e3*(m.lastAngle/(m.deltaTime||30)),v=m.lastAxis,u=m.lastTime,z=function(){var F=Date.now(),s=(F-u)/1e3;return u=F,h*=Math.pow(Math.abs(e.decelerationRate),3*s),Math.abs(h)<.01?(h=0,i&&i.stop(),void 0):(D(v,h*s),void 0)};i=cj({action:function(){z(arguments)},duration:5e3})}m=null}},e._handleLeft=function(u){if(!m.finished){var U=$c(u),Y=A(U,m.lastScreen||m.screen);if(m.lastScreen=U,!Y.hit)return m.finished=!0,e._endMoveImpl(u),void 0;var i=Y.hit;i.normalize();var X=m.hitNormalize,k=Math.acos(i.dot(X)),w=i.cross(X).normalize();D(w,k),Y.out&&(m.finished=!0,e._endMoveImpl(u))}},e._handleRight=function(R){var A=m.lastScreen||m.screen,I=A.y;A=m.lastScreen=$c(R);var g=A.y,Q=g-I;if(Q){var w=Math.min(.5,Q*e.scaleSpeed);$.copy(U.getEye());var v=m.hit;v||(v=$.clone().divide(x).normalize().multiply(x)),b.copy($).lerp(v,w),U.setEye(b.toArray()),$.copy(U.getUp()),b.normalize();var y=$.clone().cross(b).normalize();if(n.copy(U.getCenter()),n.sub(y.multiplyScalar(n.dot(y))),U.setCenter(n.toArray()),m.hit){var o=Z(m.screen),c=m.hitNormalize;if(o){o.normalize();var h=Math.acos(o.dot(c)),i=o.cross(c).normalize();h&&D(i,h)}}}};var Y=function(Q){return Math.abs(Q)<.01?0:Q>0?1:-1};e._handleTouch2=function(k){var M=k.touches.length;if(2===M){var X=k.touches,y={x:X[0].clientX,y:X[0].clientY},B={x:X[1].clientX,y:X[1].clientY},f={x:B.x-y.x,y:B.y-y.y},q=m.lastCenter,V=Math.atan2(f.y,f.x),L=m.theta,c=0;L==w?L=m.theta=V:(c=V-L,m.thetaStarted||Math.abs(c)>.03?(m.thetaStarted=!0,m.theta=V):c=0);var d,E=Math.sqrt(f.x*f.x+f.y*f.y),P=m.vlen;if(P){var H=y.x-q.x,$=y.y-q.y,r=B.x-q.x,A=B.y-q.y,F=Math.sqrt(H*H+$*$),e=Math.sqrt(r*r+A*A),x=P/2,t=Y(F-x),u=Y(e-x);0>t*u||0===t&&0===u?(d=1,m.vlen=E):(d||(d=E/P),m.scaleStarted||Math.abs(d-1)>.05?(m.vlen=E,m.scaleStarted=!0):d=1)}else P=m.vlen=E,d=1;var f=b.copy(U.getEye()).clone();1!==d&&U.setEye(f.setLength((f.length()-T)/d+T).toArray()),c&&D(f.normalize(),c),m.lastCenter={x:(B.x+y.x)/2,y:(B.y+y.y)/2}}},e._handleMiddle=function(P){var x=$c(P),f=m.screen;m.screen=x;var Q=(x.y-f.y)/180*Math.PI*e.rollSpeed;b.copy(U.getCenter()).sub($.copy(U.getEye())).normalize(),$.copy(U.getUp()).cross(b).normalize(),b.copy(U.getEye()).sub(m.hit).applyAxisAngle($,Q).add(m.hit);var y=b.clone();b.copy(U.getCenter()).sub(m.hit).applyAxisAngle($,Q).add(m.hit);var t=b.clone(),K=b.copy(U.getUp()).applyAxisAngle($,Q).clone(),A=!1;Q>0&&(n.copy(K),b.copy(t).sub(y).normalize(),$.copy(y).multiplyScalar(-1).normalize(),$.dot(n)-b.dot(n)>0&&(A=!0)),A||n.copy(m.hit).sub(y).dot(m.hitNormalize)>=0&&(A=!0),A||(U.setEye(y.toArray()),U.setCenter(t.toArray()),U.setUp(K.toArray()));var O=-(x.x-f.x)/180*Math.PI*e.rotateSpeed;D(m.hitNormalize,O)}};dd("GlobeInteractor",bd,{handle_contextmenu:function(E){mc(E)},handle_mousewheel:function(i){this._scrollImpl(i,i.wheelDelta/40)},handle_DOMMouseScroll:function(C){2===C.axis&&this._scrollImpl(C,-C.detail)},handle_keydown:function(e){this.gv.handleKeyDown(e)},handle_mousedown:function(y){this.handle_touchstart(y)},handle_touchstart:function(B){mc(B);var Q=this.gv;if(Q.setFocus(B)){var N=Q.getDataInfoAt(B),s=N?N.data:w;s&&Q.isInteractive(s)||this._startMoveImpl(B);var L=N?N.part:w;Ir(B)?Q.handleDoubleClick(B,s,L):Q.handleClick(B,s,L)}},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(){},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(X){this._handleMoveImpl(X)},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(B){this._endMoveImpl(B)}}),R.defineProperties(Yh.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(X){this._rotateSpeed=X}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(n){this._rollSpeed=n}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(L){this._scaleSpeed=L}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(x){this._decelerationRate=x}}});var nh=function(i){var e=2147483648|i;return[(255&e>>16)/255,(255&e>>8)/255,(255&e)/255,(255&e>>24)/255]},Dg=function(r){this.gv=r,this.gv.pickColorMap={_pickIdUsed:1e3}};Ap(Dg,R,{_iv:!0,iv:function(){this._iv=!0},get:function($,J,b){this.validate();var B=this,v=B.gv.getGL();if(!v)return w;var i,W,Q=B._resolution,H=Math.round($.x*Q),d=Math.ceil($.width*Q),D=Math.ceil($.height*Q),g=B.height-Math.round($.y*Q)-D,M=C(d/2),r=new Uint8Array(4*d*D),c=0,s=r.length,L=J?w:new Pk,G=J?w:{};if(lc(v,B.frame),v.readPixels(H,g,d,D,v.RGBA,v.UNSIGNED_BYTE,r),sm(v),J){for(;M>=c;c++)for(var U=M-c,S=M+c,P=U;S>=P;P++)for(var I=U;S>=I;I++)if((P===U||P===S||I===U||I===S)&&(i=B.info(r,4*(P*d+I)))){if(b&&b(i)===!1)continue;return i}}else for(;s>c;c+=4)if(i=B.info(r,c)){if(b&&b(i)===!1)continue;W=i.data,G[W._id]||(L.add(W),G[W._id]=W)}return L},info:function(s,w){return this.gv.pickColorMap[(s[w]<<16)+(s[w+1]<<8)+s[w+2]+((127&s[w+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var e=this,G=e.gv,I=G.getGL();if(I){var R=e._resolution=G._pickerResolution*G.getDevicePixelRatio(),T=Math.round(R*G.getWidth()),Y=Math.round(R*G.getHeight()),x=I.RGBA,j=I.TEXTURE_2D,t=I.RENDERBUFFER,k=I.FRAMEBUFFER;if(e.texture||(e.texture=ah(I),e.render=I.createRenderbuffer(),e.frame=I.createFramebuffer()),(e.width!==T||e.height!==Y)&&(I.activeTexture(I.TEXTURE0),me(I,e.texture),I.texImage2D(j,0,x,T,Y,0,x,I.UNSIGNED_BYTE,w),Wj(I,I.TEXTURE_MIN_FILTER,I.LINEAR),I.bindRenderbuffer(t,e.render),I.renderbufferStorage(t,I.DEPTH_COMPONENT16,T,Y),lc(I,e.frame),I.framebufferTexture2D(k,I.COLOR_ATTACHMENT0,j,e.texture,0),I.framebufferRenderbuffer(k,I.DEPTH_ATTACHMENT,t,e.render),me(I,w),I.bindRenderbuffer(t,w),sm(I),e.width=T,e.height=Y),e._iv){e._iv=!1;var K=!1;G._40Q.each(function(O){!K&&O.isBatchInvalid()&&(K=!0)}),K&&G.updateScene(),lc(I,e.frame),I.clear(I.COLOR_BUFFER_BIT),G.overlappingBox.clear(),G.setViewport(I,0,0,T,Y),G.renderPickScene(),sm(I)}}}});var sq=function(s){this.gv=s};Ap(sq,R,{gap:0,size:0,_42:function(k,j){var t=this,m=t.gv,i=m._gridGap,n=m._gridSize;if(m._gridVisible){if(t.gap!==i||t.size!==n){for(var u=[],S=m._gridSize/2,h=i*S,U=0;2*S+1>U;U++){var E=6*U,C=6*(2*S+1)+E;u[E]=-h,u[E+1]=0,u[E+2]=-h+U*i,u[E+3]=h,u[E+4]=0,u[E+5]=-h+U*i,u[C]=-h+U*i,u[C+1]=0,u[C+2]=-h,u[C+3]=-h+U*i,u[C+4]=0,u[C+5]=h}t.vs=new vg(u),t.gap=i,t.size=n}Ob(m),dn(k,j),Ec(k),Bo(k,j,1,m._gridColor,m._buffer.vs,t.vs),rp(k,0,t.vs.length/3,k.LINES),xj(k),Eh(k,j)}else t.vs=t.gap=t.size=w}});var id=function(U){this.gv=U};Ap(id,R,{_42:function(k,R){var a=this.gv,y=a._buffer.vs,$=a._axisXColor,I=a._axisYColor,t=a._axisZColor,m=a._originAxisVisible,N=a._centerAxisVisible;if(m||N){var o=qm?k.TRIANGLES:k.TRIANGLE_FAN,A=k.LINES;if(Ob(a),dn(k,R),Ec(k),m){var i=a.getCenterInfo(),E=X(i.width,i.height)/5,V=.8*E,x=.05*E;Bo(k,R,1.5,$,y,new vg([0,0,0,E,0,0,V,x,0,V,0,x,V,-x,0,V,0,-x,V,x,0,0,0,0,0,E,0,x,V,0,0,V,x,-x,V,0,0,V,-x,x,V,0,0,0,0,0,0,E,x,0,V,0,x,V,-x,0,V,0,-x,V,x,0,V])),rp(k,0,2,A),rp(k,1,6,o),Bo(k,R,w,I),rp(k,7,2,A),rp(k,8,6,o),Bo(k,R,w,t),rp(k,14,2,A),rp(k,15,6,o)}if(N){var L=a._center,q=L[0],B=L[1],M=L[2],i=a.getPositionInfo(L);E=X(i.width,i.height)/20,Bo(k,R,1.5,$,y,new vg([q,B,M,q+E,B,M,q,B,M,q,B+E,M,q,B,M,q,B,M+E])),rp(k,0,2,A),Bo(k,R,w,I),rp(k,2,2,A),Bo(k,R,w,t),rp(k,4,2,A)}xj(k),Eh(k,R)}}});var ec=function(C){this.gv=C,this.onMouseOver=this.onMouseOver.bind(this),this.mode=ec.Mode.Style,this.color=r,this.width=r};ec.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Ap(ec,R,{onMouseOver:function(e){Y.preventDefault(e);var B=this.gv.getDataAt(e);B!==this.mouseOverData&&(this.mouseOverData=B,this.gv.iv())},setFetchTargetFunc:function(J){this.fetchTargetFunc=J},_42:function(L,w){var H,S,T=this,m=T._mode,o=T.gv;if(!L._renderInfo.reflectDepth&&m!==ec.Mode.Disable){if(m===ec.Mode.Selection?H=o.sm().getSelection().toArray(function(M){return M.s("highlight.visible")}):m===ec.Mode.MouseOver&&T.mouseOverData&&T.mouseOverData.s("highlight.visible")&&(H=[T.mouseOverData]),T.fetchTargetFunc&&(H=T.fetchTargetFunc(H)),m===ec.Mode.Style)H=H||[],S=function(x){if(H.indexOf(x)>=0)return!1;var j=o.getDataHighlightMode(x);return j===!1?!0:j===!0?!1:"selected"===j?o.isSelected(x)?!1:!0:"hover"===j?x===T.mouseOverData?!1:!0:!0};else{if(!H||!H.length)return;S=function(c){return H.indexOf(c)<0?!0:void 0}}var o=T.gv,A=o.vr.isPresenting(),U=o.getWidth();if(A){var t=o.getWidth;U/=2,o.getWidth=function(){return U};var k=o.getViewport()}var u,Q=o.getDevicePixelRatio(),f=U*Q,q=o.getHeight()*Q;(u=T._renderTarget)?u.setSize(L,f,q):T._renderTarget=u=new Lq.RenderTarget(o,L,f,q),lc(L,u.frame),L.clear(L.COLOR_BUFFER_BIT),o.setViewport(L,0,0,f,q);var M=[];H.forEach(function(P){var h=P.getRenderLayer();M.indexOf(h)<0&&M.push(h)}),o.drawFilter=S,o.renderPickScene(),o.drawFilter=null,sm(L),qm&&vm(L,w.aPosition),vm(L,w.aNormal),A&&(o.getWidth=t,o.setViewport(L,k[0],k[1],k[2],k[3]));var y=L._compiledShader.highlight;y||(y=L._compiledShader.highlight=new Vk.Shader(L,Fk.vs,Fk.fs)),y.bind();var G=Qp.for(L),C=G.directState();C.blend.enabled=!0,L.activeTexture(L.TEXTURE0+0),me(L,u.texture),y.uniforms.image=0,y.uniforms.textureSize=[f,q],y.uniforms.edgeWidth=o.getHighlightWidth();var Y=o.getHighlightColor();if(T._lastHighlightColor!==Y){var Z=Dl(T._lastHighlightColor=Y);T._highlightColorData=[Z[0]/255,Z[1]/255,Z[2]/255,Z[3]/255]}y.uniforms.edgeColor=T._highlightColorData,T.ibuffer?(T.ibuffer.upload(),T.vbuffer.upload()):(T.ibuffer=Vk.Buffer.createIndexBuffer(L,new Uint16Array([0,2,1,1,2,3])),T.vbuffer=Vk.Buffer.createVertexBuffer(L,new Float32Array([0,0,1,0,0,1,1,1]))),y.attributes.pos.pointer(T.vbuffer),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0),C.blend.enabled=!1,me(L,null),L.useProgram(w),qm&&Ke(L,w.aPosition)}}}),R.defineProperties(ec.prototype,{mode:{get:function(){return this._mode},set:function(l){var R=this._mode;l!==R&&(this._mode=l,l===ec.Mode.MouseOver||l===ec.Mode.Style?B(this.gv.getView(),"mousemove",this.onMouseOver):(R===ec.Mode.MouseOver||R===ec.Mode.Style)&&q(this.gv.getView(),"mousemove",this.onMouseOver))}}});var Fk={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Hj=function(D){this.gv=D},dp="edit_tx",Cg="edit_ty",_r="edit_tz",oe="edit_rx",Dj="edit_ry",ej="edit_rz",Kf="edit_sx",Br="edit_sy",Go="edit_sz",Ml={};Ml[dp]=101,Ml[Cg]=102,Ml[_r]=103,Ml[oe]=104,Ml[Dj]=105,Ml[ej]=106,Ml[Kf]=107,Ml[Br]=108,Ml[Go]=109,Ap(Hj,R,{_42:function(v,D,p){var L=this,k=L.gv,B=k.sm().ld();if(B&&k.isEditable(B)&&!k.isEditHelperDisabled()&&Km(B)&&(!k.isFirstPersonMode()||!k.isMouseRoamable()&&!re)){Ob(k);var $,Y,q=k.isMovable(B),d=k.isRotationEditable(B),N=k.isSizeEditable(B),P=k._axisXColor,O=k._axisYColor,V=k._axisZColor,H=k._editSizeColor,r=B.p3(),n=qd(k.getEye(),r)/10,K=n/(p?5:10),c=.7*n,W=.4*c,A=r[0],T=r[1],s=r[2];$=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],q&&L._17O(v,D,B,p,dp,P,$,[A,T-K,s,A+c,T-K,s,A+c,T,s,A+c,T,s,A,T,s,A,T-K,s,A,T-K,s+K,A+c,T-K,s+K,A+c,T-K,s,A+c,T-K,s,A,T-K,s,A,T-K,s+K]),Y=A+c,N&&L._17O(v,D,B,p,Kf,H,$,[Y,T-K,s,Y+W,T-K,s,Y+W,T,s,Y+W,T,s,Y,T,s,Y,T-K,s,Y,T-K,s+K,Y+W,T-K,s+K,Y+W,T-K,s,Y+W,T-K,s,Y,T-K,s,Y,T-K,s+K]),Y+=W,d&&L._17O(v,D,B,p,oe,P,$,[Y,T-K,s,Y+W,T-K,s,Y+W,T,s,Y+W,T,s,Y,T,s,Y,T-K,s,Y,T-K,s+K,Y+W,T-K,s+K,Y+W,T-K,s,Y+W,T-K,s,Y,T-K,s,Y,T-K,s+K]),$=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],q&&L._17O(v,D,B,p,Cg,O,$,[A,T,s,A,T+c,s,A-K,T+c,s,A-K,T+c,s,A-K,T,s,A,T,s,A,T,s,A,T,s-K,A,T+c,s-K,A,T+c,s-K,A,T+c,s,A,T,s]),Y=T+c,N&&L._17O(v,D,B,p,Br,H,$,[A,Y,s,A,Y+W,s,A-K,Y+W,s,A-K,Y+W,s,A-K,Y,s,A,Y,s,A,Y,s,A,Y,s-K,A,Y+W,s-K,A,Y+W,s-K,A,Y+W,s,A,Y,s]),Y+=W,d&&L._17O(v,D,B,p,Dj,O,$,[A,Y,s,A,Y+W,s,A-K,Y+W,s,A-K,Y+W,s,A-K,Y,s,A,Y,s,A,Y,s,A,Y,s-K,A,Y+W,s-K,A,Y+W,s-K,A,Y+W,s,A,Y,s]),$=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],q&&L._17O(v,D,B,p,_r,V,$,[A,T,s,A,T,s+c,A,T-K,s+c,A,T-K,s+c,A,T-K,s,A,T,s,A,T-K,s,A-K,T-K,s,A-K,T-K,s+c,A-K,T-K,s+c,A,T-K,s+c,A,T-K,s]),Y=s+c,N&&L._17O(v,D,B,p,Go,H,$,[A,T,Y,A,T,Y+W,A,T-K,Y+W,A,T-K,Y+W,A,T-K,Y,A,T,Y,A,T-K,Y,A-K,T-K,Y,A-K,T-K,Y+W,A-K,T-K,Y+W,A,T-K,Y+W,A,T-K,Y]),Y+=W,d&&L._17O(v,D,B,p,ej,V,$,[A,T,Y,A,T,Y+W,A,T-K,Y+W,A,T-K,Y+W,A,T-K,Y,A,T,Y,A,T-K,Y,A-K,T-K,Y,A-K,T-K,Y+W,A-K,T-K,Y+W,A,T-K,Y+W,A,T-K,Y])}},_17O:function(U,J,i,G,D,v,c,a){var r=this.gv,L=r._buffer,o=Qp.for(U),X=o.directUniforms(),K=o.directAttribs();if(r._picking){G=r.pickColorMap;var q=Ml[D];G[q]={data:i,part:D},X.uFixPickReverseColor=nh(q)}zr(U,J,w,!0,w,!0,w,!1),X.uDiffuse=v,K.aPosition=Cb(U,L.vs,new vg(a),w),K.aNormal=Cb(U,L.ns,new vg(c),w),Ec(U),rp(U,0,12),xj(U),_b(U,J)}});var Rq=s.Raycaster=function(k){this.gv=k,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Je("Raycaster",R,{intersect:function(j){var y=this,q=y.gv,J=q.getDataAt(j);return J?y.intersectObject(j,J):null},intersectObjects:function(r,p,g){var U,Y,O,J,$=this,f=1/0,F=r.origin||(new Zb).fromArray($.gv.getEye()),L=$.maxTriangleTest,w=[];return p.forEach(function(K){g&&g(K)===!1||K.s("intersect")!==!1&&w.push(K)}),w.sort(function(c,D){return F.distanceToSquared2(c.p3())-F.distanceToSquared2(D.p3())}),$.countTriangles=0,w.forEach(function(q){$.countTriangles>L||(U=$.intersectObject(r,q),U&&(Y=F.distanceToSquared(U.world),f>Y&&(O=q,J=U,f=Y)))}),$.countTriangles=0,{data:O,intersect:J}},intersectObject:function(e,V){if(e instanceof Vm)return this._intersectObjectImpl(e,V);var x=this,h=x.gv,M=h.unproject(e),U=new Zb,v=h.getEye(),D=new Zb;if(h.isOrtho()){var S=new Zb(v);D.copy(h.getCenter()).sub(S).normalize();var z=U.copy(M).sub(S).dot(D);U.copy(D).setLength(-z).add(S.copy(M))}else U.copy(v),D.copy(M).sub(U).normalize();var y=new s.Math.Ray(U,D);return x._intersectObjectImpl(y,V)},_intersectObjectImpl:function(){function v(){var l=new Zb;return l.subVectors(C,M),e.subVectors(k,M),l.cross(e).normalize(),l}function u(T,n,f,$,Q,b,C){return yi.barycoordFromPoint(T,n,f,$,r),Q.multiplyScalar(r.x),b.multiplyScalar(r.y),C.multiplyScalar(r.z),Q.add(b).add(C),Q.clone()}var Q=new _p,H=new _p,g=new Vm,U=new Zb,x=new Zb,o=new Zb,d=new Zb,K=new Zb,k=new Zb,M=new Zb,C=new Zb,F=new Vq,T=new Vq,N=new Vq,e=new Zb,P={vs:oq,is:of,uv:ok},r=new Zb,c=Qk.slice(0);return c.push("csg"),function(a,t){var A=this.gv.getData3dUI(t),m=t.mat||A.mat;m?Q.fromArray(m):Q.identity(),H.getInverse(Q),g.copy(a).applyMatrix4(H);var h,b,G,l="body",q=A.shapeModel;if(q||(q=el(A)),q||(s.CSGNode&&t instanceof s.CSGNode||s.CSGShape&&t instanceof s.CSGShape?(G=!0,q=[A.left,A.front,A.right,A.back,A.top,A.bottom,A.csg]):t instanceof s.Node&&!(t instanceof s.Shape)?(h=!0,q=P):(b=!0,q=[A.left,A.front,A.right,A.back,A.top,A.bottom])),!q)return console.log("Can not find shape model."),null;wd(q)||(q=[q]);var e,Y,n,B,R,$,S,w,I,r,p,i,y,j,f,W,z=1/0,J=["","top_","bottom_"],Z=!1,X=this.backfaceCulling,E=[];for(Zi(q,A,E),e=0,Y=E.length;Y>e;e++)if(y=E[e])for(n=0,B=J.length;B>n;n++)if(j=J[n],S=y[j+"vs"],w=y[j+"is"],I=y[j+"uv"]||y[j+"tuv"],S){if(f=y[j+"boundingBox"]){var p=g.intersectBox(f);if(!p)continue;if(g.origin.distanceTo(p)>z)continue;W=!1}else y[j+"boundingBox"]=f=new s.Math.Box3,W=!0;for(R=0,$=w?w.length:S.length/3;$>R;R+=3)this.countTriangles++,w?(x.fromArray(S,3*w[R]),o.fromArray(S,3*w[R+1]),d.fromArray(S,3*w[R+2])):(x.fromArray(S,3*R),o.fromArray(S,3*(R+1)),d.fromArray(S,3*(R+2))),W&&(f.expandByPoint(x),f.expandByPoint(o),f.expandByPoint(d)),r=g.intersectTriangle(x,o,d,X,U),r&&(i=g.origin.distanceTo(r),z>i&&(z=i,K.copy(r),k.copy(x),M.copy(o),C.copy(d),""!==j?l=j.slice(0,-1):h?l=Qk[Math.floor(R/6)]:b?l=Qk[e]:G&&(l=c[e]),I&&(Z=!0,w?(F.fromArray(I,2*w[R]),T.fromArray(I,2*w[R+1]),N.fromArray(I,2*w[R+2])):(F.fromArray(I,2*R),T.fromArray(I,2*(R+1)),N.fromArray(I,2*(R+2))))))}if(!isFinite(z))return null;var O,D=K.clone().applyMatrix4(Q);Z&&(O=u(K,k,M,C,F,T,N));var L=v(k,M,C),V=v(k.applyMatrix4(Q),M.applyMatrix4(Q),C.applyMatrix4(Q)),_=g.direction.dot(L);return _>0&&(L.multiplyScalar(-1),V.multiplyScalar(-1)),{world:D,local:K.clone(),worldNormal:V,normal:L,uv:O,part:l}}}()});var us=function(u,Z){this.gv=u,this.s=function(J,v,I){return v==w&&(v=I),v==w?Z.getStyle(J):Pb(v,Z,u)},this.data=Z};Ap(us,R,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:r,iv:function(){this._iv=!0},update:function(K,G,X){var q=this,L=q.data;if(K||(K=q.gv,G=K.getGL(),X=G._40Q),!q.needValidate(G)||!K.isVisible(L))return X.push(this,!1),void 0;var m,J,u,_,M,R=L._id,l=q.s("autorotate")||q.s("shape3d.autorotate")||q.s("fixSizeOnScreen")||q.s("shape3d.fixSizeOnScreen")?null:q.s("batch"),V=L.getRenderLayer(),F=X.get(V,!0),n=F.batchIndexMap,O=F.batchModelMap,o=K.getBrightness(L),d=o!=w&&1!==o;m=pr(n,O,L,l,K);var W=q.validate(m,l?K.getBatchInfo(l)||Ik:w);if(m&&(J=n[R],u=J.size=m.vs.length/3-J.begin,M=m.rs))for(o=d?o:1,_=0;u>_;_++)M.push(o);var A=K.getWireframeGeometry(L);if(A)$o(K,L,A);else if(Km(L)){var s=K.getWireframe(L);s&&$o(K,L,s)}q.labelInfo=q.label2Info=q.noteInfo=q.note2Info=q._38o=w,q._24O(Ij,"getLabel"),q._24O(pl,"getLabel2"),q._26O(uh,"getNote"),q._26O(Rd,"getNote2"),q._15O(),q.interactiveInfo=K.isInteractive(L)?{}:w,F.push(this,!0),W!==!1&&(q._iv=!1)},clearWireframeGeometryCache:function(){var d=this;Ql(d),d.data.iv()},_46Q:function(t){var k=this,Y=k.data,H=k.gv;if(H.isVisible(Y)){var i=Y._id,x=H._40Q.get(Y._renderLayer,!0),N=x.batchIndexMap[i],D=x.polylineIndexMap[i],F=x.wireframeIndexMap[i];if(N||D||F){var m=vd(t,H.pickColorMap,H.isSelectable(Y),Y,Fh,!0);m&&(kg(m,N,x.batchModelMap),kg(m,D,x.polylineModelMap),kg(m,F,x.wireframeModelMap))}}},_42:function(J,R,i){function h(j,p,O){var F=p.getBrightness(O),C=O.s("alphaTest"),K=O.s("envmap"),e=Qp.for(j),z=e.directUniforms();F!=w&&1!==F&&(z.uBrightness=F),z.uAlphaTest=C,z.uUseEnvMap=K?!0:!1,z.uReflectivity=K||.01,z.shadowReceive=!N&&O.s("shadow.receive"),z.shadowCull=!N&&!!O.s("shadow.cull");var J=T.s("3d.clip.direction");if(J){var A=T.s("3d.clip.percentage");switch(0===A&&($=!1),J){case"left":J=2;break;case"top":J=3;break;case"bottom":J=4;break;case"front":J=5;break;case"back":J=6;break;case"right":default:J=1}if(0===J%2&&(A=1-A),O instanceof s.Shape){var g=O.s3(),V=O.p3(),H=O.getAnchor3d();A=3>J?(A-H.x)*g[0]+V[0]:5>J?(A-H.y)*g[1]+V[1]:(A-H.z)*g[2]+V[2]}else A-=.5;z.uClipPercent=A}z.uClipDirection=J||0,j._blooming&&!O.s("bloom")&&(z.blackout=!0)}var T=this,I=T.data,n=T.gv;if(n.isVisible(I)){var H,N=n._picking;if(N)H=n.pickColorMap;else{if(n.isTransparentMask(I)||n.isReflecting(J)&&I.s("3d.reflectable")===!1)return;H=r}if(us.getTitle===r){us.getTitle=0;for(var Q in Y)if(Q.length===pl.length+1&&Q[pl.length]===te[4].toUpperCase()&&Q[pl.length-1]===te[pl.length+1].toUpperCase()){us.getTitle=Qf;break}}if(!us.getTitle||rq[pl.length+2]){if(us.getHead===r){us.getHead=0;for(var Q in E){var L="box-sizing";6===Q.length&&Q[0]===te[4]&&Q[3]===L[0]&&Q[4]===L[1]&&Q[5]===L[2]&&(us.getHead=Qf)}}if(!us.getHead||rq[pl.length]){var x,p,c=I._id,k=n._40Q.get(I._renderLayer,!0),U=k.batchIndexMap,F=k.batchModelMap,d=n.isSelectable(I),K=!1,$=!0,Z=U[c];if(N&&(p=vd(J,H,d,I,Fh,Z),p&&!n._45Q&&(kg(p,Z,F),kg(p,k.polylineIndexMap[c],k.polylineModelMap),kg(p,k.wireframeIndexMap[c],k.wireframeModelMap))),Z||(K||(K=!0,h(J,n,I)),$&&T._80o(J,R,i)),n.isLabelVisible(I)&&((x=T.labelInfo)&&(N&&vd(J,H,d,I,Ij),K||(K=!0,h(J,n,I)),T._28O(x,Ij,i)),(x=T.label2Info)&&(N&&vd(J,H,d,I,pl),K||(K=!0,h(J,n,I)),T._28O(x,pl,i))),n.isNoteVisible(I)&&((x=T.noteInfo)&&(N&&vd(J,H,d,I,uh),K||(K=!0,h(J,n,I)),T._29O(x,uh,i)),(x=T.note2Info)&&(N&&vd(J,H,d,I,Rd),K||(K=!0,h(J,n,I)),T._29O(x,Rd,i))),(x=T._38o)&&(K||(K=!0,h(J,n,I)),T._99O(J,R,x,H,d,i)),K){var m=Qp.for(J).directUniforms();m.uBrightness=1,m.uClipDirection=0,J._blooming&&(m.blackout=!1)}}}}},prepare:function(){var i=this,$=i.data;if(!($ instanceof So)){var r,x,D,Q,R,p=i.gv,H=p.getGL(),M=$._id,j=i.s("batch"),E=p._batchIndexMap,c=p._batchModelMap,T=p.getBrightness($),t=T!=w&&1!==T;if(i.needValidate(H)){if(r=pr(E,c,$,j,p),i.validate(r,j?p.getBatchInfo(j)||Ik:w),r&&(x=E[M],D=x.size=r.vs.length/3-x.begin,R=r.rs))for(T=t?T:1,Q=0;D>Q;Q++)R.push(T);if(Km($)){var z=p.getWireframeGeometry($);if(z)$o(p,$,z);else{var N=p.getWireframe($);N&&$o(p,$,N)}}i.labelInfo=i.label2Info=i.noteInfo=i.note2Info=i._38o=w,i._24O(Ij,"getLabel"),i._24O(pl,"getLabel2"),i._26O(uh,"getNote"),i._26O(Rd,"getNote2"),i._15O(),i.interactiveInfo=p.isInteractive($)?{}:w,i._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=r},getBoundingBox:function(){var b,t,J,y,E,Q;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;b||(b={vs:oq,is:of,uv:ok},t=new Zb,J=new Zb,y=new Zb,E=new Zb,Q=new Zb);var i=this,q=i.data,f=i.shapeModel;if(f||q instanceof s.Shape||(f=el(i)),!f&&q instanceof s.Shape&&(i.prepare(),f=i.shapeModel),f||(q instanceof s.Node&&!(q instanceof s.Shape)?f=b:(i.left||i.front||i.right||i.back||i.top||i.bottom)&&(f=[i.left,i.front,i.right,i.back,i.top,i.bottom])),!f)return r;wd(f)||(f=[f]);var K,Z,B,X,d,C,v,W,w,T,$,I,j=["","top_","bottom_"],l=new s.Math.Box3,n=!1;if(i._needRecoverPosition){E.set.apply(E,q.p3());var g=q.s3();Q.set(1/(g[0]||1),1/(g[1]||1),1/(g[2]||1))}else E.set(0,0,0),Q.set(1,1,1);for(K=0,Z=f.length;Z>K;K++)if(w=f[K])for(B=0,X=j.length;X>B;B++)if(T=j[B],v=w[T+"vs"],W=w[T+"is"],v){if(I=T+"boundingBox",$=w[I],!$)for(w[I]=$=new s.Math.Box3,d=0,C=W?W.length:v.length/3;C>d;d+=3)W?(t.fromArray(v,3*W[d]).sub(E).multiply(Q),J.fromArray(v,3*W[d+1]).sub(E).multiply(Q),y.fromArray(v,3*W[d+2]).sub(E).multiply(Q)):(t.fromArray(v,3*d).sub(E).multiply(Q),J.fromArray(v,3*(d+1)).sub(E).multiply(Q),y.fromArray(v,3*(d+2)).sub(E).multiply(Q)),!t.isNaN()&&$.expandByPoint(t),!J.isNaN()&&$.expandByPoint(J),!y.isNaN()&&$.expandByPoint(y);l.expandByBox($),n=!0}return n?(this._cacheBoundingBox=l,R.freeze(l),R.freeze(l.min),R.freeze(l.max),dr(i.gv,q),l):r
}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Sp},_80o:function(){},dispose:function(){},getBodyColor:function(U){var Q=this.data,$=this.gv.getBodyColor(Q);return $?$:U?Q.getStyle(U):w},getCachedTexture:function(U){var u=this._cachedTextures;return u?u[U||"main"]:null},setCachedTexture:function(X,T){var m=this._cachedTextures;return m||(m=this._cachedTextures={}),m[T||"main"]=X,X},invalidateCachedTexture:function(Z){var d=this._cachedTextures;if(d){for(var n in d)Z.deleteTexture(d[n]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(r,I){var g=this,$=g.data,J=g.gv,B=g.s,u=J[I]($);if(u!=w){var l=B(r+".scale"),E=B(r+".max"),L=g[r+"Info"]={label:u,textureScale:B(r+".texture.scale"),color:J[I+"Color"]($),font:B(r+".font"),align:B(r+".align"),background:J[I+"Background"]($)},H=L.rect=eh(L,u);E>0&&E<H.width&&(L.labelWidth=H.width,H.width=E),H.x=H.y=0,H.width*=l,H.height*=l,L.mat=g._16O(B(r+".autorotate"),B(r+".position"),H,B(r+".face"),B(r+".t3"),B(r+".r3"),B(r+".rotationMode"));var j=H.width/2,D=H.height/2;L.vs=new vg([-j,D,0,-j,-D,0,j,-D,0,j,D,0]),H.width/=l,H.height/=l}},_26O:function($,N){var x=this,W=x.data,n=x.gv,b=x.s,L=n[N](W);if(L!=w){var M=b($+".scale"),B=this[$+"Info"]={note:L,textureScale:b($+".texture.scale"),expanded:b($+".expanded"),font:b($+".font"),color:b($+".color"),align:b($+".align"),borderWidth:b($+".border.width"),borderColor:b($+".border.color"),background:n[N+"Background"](W)};if(B.expanded){var v=b($+".max"),G=eh(B,L);G.width+=6,G.height+=2,v>0&&v<G.width&&(B.labelWidth=G.width,G.width=v);var r={x:-G.width/2,y:-8-G.height,width:G.width,height:G.height+8}}else r={x:-6,y:-18,width:12,height:18};B.mat=x._16O(b($+".autorotate"),b($+".position"),w,b($+".face"),b($+".t3"),b($+".r3"),b($+".rotationMode")),B.rect=r,1!==M&&(r=fq(r),r.x*=M,r.height*=M,r.y=-r.height,r.width*=M);var f=r.x,F=r.y,K=r.width,P=r.height;B.vs=new vg([f,-F,0,f,-F-P,0,f+K,-F-P,0,f+K,-F,0])}},eachShapeModel:function(E,$){function P(T){Gi(T),T.vs&&E(T.vs,T.is,T.ns,T.uv),T.top_vs&&E(T.top_vs,T.top_is,T.top_ns,T.top_uv),T.bottom_vs&&E(T.bottom_vs,T.bottom_is,T.bottom_ns,T.bottom_uv),T.from_vs&&E(T.from_vs,T.from_is,T.from_ns,T.from_uv),T.to_vs&&E(T.to_vs,T.to_is,T.to_ns,T.to_uv)}function O(o){var H,k,S;if(wd(o))for(k=0,S=o.length;S>k;k++)H=o[k],H&&O(H);else ap(o)?O(el(n,o),n):np(o)&&(o.shape3d?O(o.shape3d):P(o))}var n=this,F=n.data,$=$||n.shapeModel||el(n);$||($=F instanceof s.Node&&!(F instanceof s.Shape)?{vs:oq,is:of}:[n.left,n.front,n.right,n.back,n.top,n.bottom]),O($)},_28O:function(Z,R,M){if(M(this.s(R+".transparent"))){var O=Z.rect,P=Z.textureScale,S=O.width*P,L=O.height*P;if(S>=1&&L>=1){var Q=gm(S,L);1!==P&&(Q.translate(Q,O.x,O.y),Q.scale(P,P),Q.translate(Q,-O.x,-O.y)),_c(Q,Z),Q.restore(),Fp(this,R,Z.mat,Z.vs,!0)}}},_29O:function(b,s,W){if(W(this.s(s+".transparent"))){var _=b.rect,M=b.textureScale,$=_.x,E=_.y,k=_.width*M,G=_.height*M;if(k>=1&&G>=1){_.x=_.y=0;var i=gm(k,G);1!==M&&i.scale(M,M),Jg(i,b),i.restore(),_.x=$,_.y=E,Fp(this,s,b.mat,b.vs,!1)}}},_99O:function(x,i,m,M,W,k){if(m){var a=this,R=a.gv,I=a.data,e=R._buffer,_=R._1O,Q=m.icons,p=Qp.for(x),r=p.directAttribs();for(var u in Q){var V=Q[u],H=m.rects[u];if(H&&k(Pb(V.transparent,I,R))){R._picking&&vd(x,M,W,I,u);var q=Pb(V.shape3d,I,R),X=q?[q]:Pb(V.names,I,R),Z=X?X.length:0,B=Pb(V.textureScale,I,R)||1,g=Pb(V.light,I,R);g==w&&(g=q?!0:!1),zr(x,i,Pb(V.blend,I,R),g,Pb(V.opacity,I,R),Pb(V.reverseFlip,I,R),Pb(V.reverseColor,I,R),Pb(V.reverseCull,I,R));for(var d=0;Z>d;d++){var j=X[d],Y=H[d];if(Zj(a,Y.mat),q)Er(R,I,el(a,q),a);else{var N=Ub(j);if(N){var E=Y.width*B,F=Y.height*B;if(E>=1&&F>=1){var U=gm(E,F);Pr(U,N,Pb(V.stretch,I,R),0,0,E,F,I,R),U.restore(),ah(x,Gr,_),Ec(x,i,_,Pb(V.discardSelectable,I,R),e.uv,Em),r.aPosition=Cb(x,e.vs,Y.vs,w),r.aNormal=Xp(x,e.ns,Tg,w),tp(x,e.is,hl),kn(x,0,hl.length),xj(x,i,_)}}}hk(R)}_b(x,i)}}}}});var Rh=function(Q,u){Lh(Rh,this,[Q,u])};Ap(Rh,us,{_16O:function(t,k,R,s,N,H,S,l,A){var o=this.data,Y=o.getFinalScale3d(),m=kc(k,Y,R,s,l,A);if(o.hasOwnProperty("_anchor")||o.hasOwnProperty("_anchorElevation")){var d=o.getAnchor3d();m[0]-=(d.x-.5)*Y[0],m[1]-=(d.y-.5)*Y[1],m[2]-=(d.z-.5)*Y[2]}return Ek(Vd(),m,o.p3(),s,N,H,S,t,o.getFinalRotation3d(),o.getRotationMode())},clear:function(){var C=this;C.faceMat=C.mat=C.shapeModel=C.left=C.right=C.front=C.back=C.top=C.bottom=C.csg=w},needValidate:function(H){if(this._iv)return this._validateFrameId=H._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var c=H._renderInfo.frame;if(this._validateFrameId!==c)return this._validateFrameId=c,!0}return!1},validate:function(n,N){var W=this,Z=W.gv,d=W.data,S=W.shapeName=W.s(cr),G=el(W,S);if(W._updateAutoRotation(),W._updateFixSize2d(),W._updateOverlapping(),W.dispatchBoundingBoxChanged(),this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")){var O=d.getRenderLayer(),V=Z._40Q.get(O);V&&V.ivWireframeBatch(d)}var Y=ub(d,Z.getMat(d),G?W.s("shape3d.scaleable"):!0);if(d.appendAnchorMatrix3d(Y),W.clear(),W.mat=d.mat=Y,G||!S)if(W.shapeModel=G,n){var U=[];G?Ih(Z,d,G,W,W.getBodyColor(),[Y],n,U):(zq(Z,d,n,N,Y,vq,U,cf),zq(Z,d,n,N,Y,hn,U,kj),zq(Z,d,n,N,Y,rd,U,dj),zq(Z,d,n,N,Y,fi,U,tf),zq(Z,d,n,N,Y,_j,U,Mm),zq(Z,d,n,N,Y,bf,U,ns)),U.length&&(Ho(n.vs,U),Ho(n.ns,Wk(U)))}else G||(W._cubeUvs=null,W.vf(vq,0),W.vf(hn,16),W.vf(_j,8),W.vf(bf,24),W.vf(rd,32),W.vf(fi,40))},_updateAutoRotation:function(){var z=new xc,j=new _p,e=new Zb,O=new Zb,f=new Zb;return function(){var v=this,g=v.data,w=v.s("autorotate")||v.s("shape3d.autorotate");if(!w)return g._dynamicRotation&&delete g._dynamicRotation,void 0;var b=v.gv;f.copy(v.s("shape3d.autorotate.up")||b._up);var R;R="string"==typeof w?[w.indexOf("x")<0?b._eye[0]:b._center[0],w.indexOf("y")<0?b._eye[1]:b._center[1],w.indexOf("z")<0?b._eye[2]:b._center[2]]:b._eye;var Y=b._center,J=g.p3();e.copy(J),O.set(R[0]-Y[0],R[1]-Y[1],R[2]-Y[2]).add(e),j.lookAt(O,e,f),z.set(0,0,0,g.getRotationMode(),!0).setFromRotationMatrix(j);var P=g._dynamicRotation;P&&Math.abs(P[0]-z.x)<1e-5&&Math.abs(P[1]-z.y)<1e-5&&Math.abs(P[2]-z.z)<1e-5||(g._dynamicRotation=[z.x,z.y,z.z])}}(),_updateFixSize2d:function(){var p=this,G=p.data,U=p.s("fixSizeOnScreen")||p.s("shape3d.fixSizeOnScreen");if(!U)return G._dynamicScale3d&&delete G._dynamicScale3d,void 0;var d=p.gv,A=ub(G,d.getMat(G)),h=yb([0,0,0],A),$=d.toViewPosition(h);if(!isNaN($.x)&&!isNaN($.y)){var Y=yb([1,0,0],A),j=d.toViewPosition(Y),X=yb([0,1,0],A),L=d.toViewPosition(X),w=j.x-$.x,x=L.y-$.y;if(w&&x){var P,T,i=G._dynamicScale3d||[1,1,1],f=Ub(G.s("shape3d.image"));if(U[0]>0&&(P=U[0]),U[1]>0&&(T=U[1]),!P||!T){var D=U>0?U:1;P||(P=(To(f,G)||G.getWidth())*D),T||(T=(md(f,G)||G.getTall())*D)}var n=Math.abs(w/P),u=Math.abs(x/T);Math.abs(n-1)<.001&&Math.abs(u-1)<.001||(G._dynamicScale3d=[i[0]/n,i[1]/u,i[2]])}}},_updateOverlapping:function(){var $=this,Q=$.s("hide.overlapping.group");if(!Q)return $._rectOverlapping&&($._rectOverlapping=r),void 0;var o,c,W,H=$.gv,q=$.data,J=ub(q,H.getMat(q)),b=1/0,t=1/0,e=-1/0,u=-1/0,U=q.getAnchor3d(),L=U.x,X=U.y,a=U.z;for(o=0;8>o;o++){if(c=yb([(o>>2)-L,(1&o>>1)-X,(1&o)-a],J),W=H.toViewPosition(c),isNaN(W.x)||isNaN(W.y))return;b=Math.min(b,W.x),e=Math.max(e,W.x),t=Math.min(t,W.y),u=Math.max(u,W.y)}var S={x:b,y:t,w:e-b,h:u-t};$._rectOverlapping=H.overlappingBox.isOverlapping(Q,S)},getVectorDynamicSize:function(){var q,A=this,j=A.s("shape3d"),G=A.data;if("billboard"===j||"plane"===j||(q=G._currentCubeElementId)!=w){var f,$,D=A.gv,l=ub(G,D.getMat(G)),a=G.getAnchor3d(),B=.5-a.x,z=.5-a.y,x=.5-a.z,v=Math.min(A.s("vector.dynamic.maxsize"),D._glCapabilities.maxTextureSize)/D.getDevicePixelRatio(),p=function(g,i){g[0]+=B,g[1]+=z,g[2]+=x,i[0]+=B,i[1]+=z,i[2]+=x;var V=D.toViewPosition(yb(g,l)),Z=D.toViewPosition(yb(i,l)),$=V.x-Z.x,q=V.y-Z.y;return Math.min(v,Math.sqrt($*$+q*q))};if("billboard"===j)f=p([-.5,0,0],[.5,0,0]),$=p([0,-.5,0],[0,.5,0]);else if("plane"===j)f=p([-.5,0,0],[.5,0,0]),$=p([0,0,-.5],[0,0,.5]);else if(G._currentCubeElementId!=w){var X=3*of[q+1],T=3*of[q],C=3*of[q+2];f=p([oq[X],oq[X+1],oq[X+2]],[oq[C],oq[C+1],oq[C+2]]),$=p([oq[X],oq[X+1],oq[X+2]],[oq[T],oq[T+1],oq[T+2]])}return[f,$]}},vf:function(A,U){var j=this;if(j.gv.getFaceVisible(j.data,A)){var $=hb(j,A);$.mat&&(j.faceMat=!0);var O=$.uv;if(O){var z=j._cubeUvs;z||(z=j._cubeUvs=new vg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var c=0;8>c;c++)z[U+c]=O[c]}return $}},_billboardInView:function(){var v=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],G=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],n=new Xi,h=new Zb,i=new _p;return function(O){var p=this;if(!p.mat)return!0;var V=p.gv.getFrustum(),m="billboard"===O?v:G;n.makeEmpty(),i.fromArray(p.mat);for(var u=0,k=m.length;k>u;u+=3)n.expandByPoint(h.fromArray(m,u).applyMatrix4(i));return V.intersectsBox(n)}}(),_80o:function(s,D,I){var l=this;if(l._rectOverlapping)return!0;var d=l.shapeModel;if(d||!l.shapeName){var g=l.s("shape3d");if(("billboard"===g||"plane"===g)&&!l._billboardInView(g))return!0;var O=l.gv,F=l.data,v=O._cube,J=Qp.for(s),b=J.directAttribs();Ob(O,l.mat),l.s("shape3d.reflector")&&!s._picking||(d?Er(O,F,d,l,l.getBodyColor(),I):(b.aPosition=Cb(s,v.vs,w,w),b.aNormal=Cb(s,v.ns,w,w),Ao(s,v.is),l._18O(s,D,"left",0,I),l._18O(s,D,"front",6,I),l._18O(s,D,"right",12,I),l._18O(s,D,"back",18,I),l._18O(s,D,"top",24,I),l._18O(s,D,"bottom",30,I))),hk(O),l.faceMat&&(l._18O(s,D,"left",0,I,!0),l._18O(s,D,"front",6,I,!0),l._18O(s,D,"right",12,I,!0),l._18O(s,D,"back",18,I,!0),l._18O(s,D,"top",24,I,!0),l._18O(s,D,"bottom",30,I,!0))}},_18O:function(X,R,s,o,k,m){var n=this[s];if(n){if(!k(n.transparent))return;if(m&&!n.mat||!m&&n.mat)return;var $=this.data.s("polygonOffset");$&&mg(X,$),m&&Ob(this.gv,n.mat);var P=this,M=P.data,K=Qp.for(X),u=K.directUniforms();M._currentCubeElementId=o;var l=P.gv,q=l.getTexture(n.texture,M,s),F=n.uv,E=n.uvScale,g=n.uvOffset,j=n.discardSelectable;q?F?Ec(X,R,q,j,l._buffer.uv,P._cubeUvs,g,E):Ec(X,R,q,j,l._cube.uv,w,g,E):Ec(X),zr(X,R,n.blend,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),u.uDiffuse=n.color||V["color.empty"],kn(X,o,6),_b(X,R),xj(X,R,q),m&&hk(l),$&&Gn(X),M._currentCubeElementId=null}},drawReflector:function(){var I=new Zb,f=new Zb,e=new xc,q=new _p,G=new Zb,c=new Zb,u=new Zb,X=new Zb,C=new _p,P=new _p,U=new Jj,l=new Sl,W=new Sl,z=function(g,D,H){g[H]=D[0],g[H+1]=D[1],g[H+2]=D[2]},K=function(D,G){z(D,G.getEye(),0),z(D,G.getCenter(),3),z(D,G.getUp(),6)},y=function(j,K){K._eye=[j[0],j[1],j[2]],K._center=[j[3],j[4],j[5]],K._up=[j[6],j[7],j[8]],K._18Q=w;var D=K._skybox;D&&(D.p3([j[0],j[1],j[2]]),K.getData3dUI(D).iv())};return function(s){var Y=this;Y._reflectorInfo=null;var d=Y.data;if(d._reflecting)return!1;var p=Y.gv;if(p._picking)return!1;var i=Y._reflectorRenderTarget,x=p.getDevicePixelRatio(),V=p.getWidth()*x,m=p.getHeight()*x;i?i.setSize(s,V,m):i=Y._reflectorRenderTarget=new Lq.RenderTarget(p,s,V,m),I.copy(d.p3()),f.copy(p.getEye()),q.makeRotationFromEuler(e.set(d.r3(),d.getRotationMode(),!0));var E;if(!Y._reflectNormal){var E=el(Y,Y.s("shape3d"));if(!E)return!1;if(!E.ns&&E.length&&(E=E[0]),!E.ns||!E.vs)return!1;Y._reflectNormal=[E.ns[0],E.ns[1],E.ns[2]],Y._reflectorVbuffer=Vk.Buffer.createVertexBuffer(s,new Float32Array(E.vs))}if(G.copy(Y._reflectNormal),G.applyMatrix4(q),c.subVectors(I,f),c.dot(G)>0)return!1;c.reflect(G).negate(),c.add(I),u.copy(p.getCenter()).negate().add(I),u.reflect(G).negate(),u.add(I),X.copy(p.getUp()),X.reflect(G);var o=[0,0,0,0,0,0,0,0,0];K(o,p),p._eye=c.toArray(),p._center=u.toArray(),p._up=X.toArray(),p._18Q=w;var Z=p._skybox;Z&&(Z.p3(p._eye),p.getData3dUI(Z).iv()),lc(s,i.frame),s.viewport(0,0,i.width,i.height);var v=d.s("shape3d.reflector.background");if(v){var t=s.getParameter(s.COLOR_CLEAR_VALUE);fp(s,v)}else s.clearColor(0,0,0,1);Qp.for(s).glState.depth.mask=!0,s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var O=Nd(p),k=le(p);U.setFromNormalAndCoplanarPoint(G,I),U.applyMatrix4(P.fromArray(k)),l.set(U.normal.x,U.normal.y,U.normal.z,U.constant),W.x=(Math.sign(l.x)+O[8])/O[0],W.y=(Math.sign(l.y)+O[9])/O[5],W.z=-1,W.w=(1+O[10])/O[14],l.multiplyScalar(2/l.dot(W));var T=d.s("shape3d.reflector.clip"),S=T===r?.003:T;O[2]=l.x,O[6]=l.y,O[10]=l.z+1-S,O[14]=l.w;var R=p._computedProjectMatrix;p._computedProjectMatrix=O,d._reflecting=!0,p.renderScene(),p._computedProjectMatrix=R,C.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),C.multiply(P.fromArray(p._projectMatrix)),C.multiply(P.fromArray(p._viewMatrix)),v&&fp(s,t),sm(s),y(o,p);var Q=d.s("shape3d.reflector.blur");if(Q){var B=p.getPostProcessingModule("Blur");B&&B.drawImpl(s,i,Q,d.s("shape3d.reflector.blur.ratio"))}var z=s._compiledShader.reflector;z||(z=s._compiledShader.reflector=new Vk.Shader(s,xn.Reflector.vs,xn.Reflector.fs)),z.bind(),s.activeTexture(s.TEXTURE0),me(s,i.texture),z.uniforms.tDiffuse=0,z.uniforms.color=er(d.s("shape3d.reflector.color")||"rgb(128,128,128)"),z.uniforms.textureMatrix=C.toArray(),z.uniforms.modelMatrix=ub(d),z.uniforms.viewMatrix=le(p),z.uniforms.projectionMatrix=Nd(p),Y._reflectorVbuffer.upload(),z.attributes.pos.pointer(Y._reflectorVbuffer);var M=this.s("shape3d.transparent");if(M){var D=Qp.for(s).glState,L=D.depth.mask;D.depth.mask=!1}return s.drawArrays(s.TRIANGLES,0,6),M&&(D.depth.mask=L),d._reflecting=!1,s.useProgram(p._prg),me(s,w),!0}}()}),xn.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Pe=function(F,A){Lh(Pe,this,[F,A])};Ap(Pe,Rh,{_80o:function(){}});var Jd=function(e,g){Lh(Jd,this,[e,g])};Ap(Jd,us,{_25Q:1,validate:function(z){var M=this;if(!M.s("geometry.cache")||!M.info){var e=M.gv,G=M.data,u=M.s,p=u("edge.width"),d=G._40I,q=G._41I;if(M.shapeModel=M.info=w,d&&q){var a,v,x,o,c,r,D,U,V,J,h=G.isLooped(),b=u(Th),I=Y.getEdgeType(b);if(I){var S=I(G,Ci(M,e,G,h,b),e,M._19Q);if(!S.points||S.points.isEmpty())return;r=M.info={},D=S.segments,c=S.points,U=c.size();for(var j=d.getElevation(),H=q.getElevation(),f=0;U>f;f++){var C=c.get(f);C.e==w&&(C.e=j+(H-j)*f/(U-1))}V=vs(c.get(0)),J=vs(c.get(U-1));var K=U%2;0===K?(r.c1=vs(c.get(U/2-1)),r.c2=vs(c.get(U/2))):r.p3=vs(c.get((U-K)/2)),r.s1=V,r.s2=vs(c.get(1)),r.t1=vs(c.get(U-2)),r.t2=J}else{c=new Pk,r=M.info={};var k=u("edge.offset"),i=u("edge.center"),P=u("edge.source.t3"),m=u("edge.target.t3"),l=Xc(e,G,"source"),N=Xc(e,G,"target");if(!l||!N)return e.invalidateData(G),delete M.info,!1;if(P&&(l[0]+=P[0],l[1]+=P[1],l[2]+=P[2]),m&&(N[0]+=m[0],N[1]+=m[1],N[2]+=m[2]),b===Tp){D=u("edge.segments");var $=r.points=u(cs)||Kn;if(U=$.size()){V=vs($.get(0)),J=vs($.get(U-1)),!i&&k&&(x=Wn(V,l,!0),k=X(k,qd(l,V)),l=[l[0]+x[0]*k,l[1]+x[1]*k,l[2]+x[2]*k],x=Wn(N,J,!0),k=X(k,qd(J,N)),N=[N[0]-x[0]*k,N[1]-x[1]*k,N[2]-x[2]*k]);var K=U%2;0===K?(a=vs($.get(U/2-1)),v=vs($.get(U/2))):r.p3=vs($.get((U-K)/2)),r.s1=l,r.s2=V,r.t1=J,r.t2=N}else!i&&k&&(x=Wn(N,l,!0),o=qd(l,N),k=ed(k,o),l=[l[0]+x[0]*k,l[1]+x[1]*k,l[2]+x[2]*k],N=[N[0]-x[0]*k,N[1]-x[1]*k,N[2]-x[2]*k]),a=l,v=N;c.add({x:l[0],y:l[2],e:l[1]}),c.addAll($),c.add({x:N[0],y:N[2],e:N[1]})}else{var _=Ci(M,e,G,h,b);if(M._19Q||(_=-_),h){var F=l[0],Q=l[1],L=l[2],A=d.getTall()/2+_;a=[F-_,Q+A,L],v=[F+_,Q+A,L],c.add({x:F-_,y:L,e:Q}),c.add({x:F-_,y:L,e:Q+A}),c.add({x:F+_,y:L,e:Q+A}),c.add({x:F+_,y:L,e:Q})}else{x=Wn(N,l,!0),o=qd(l,N);var n={x:l[0],y:l[2]},s={x:N[0],y:N[2]},B=qe(w,n,s,_),O=B.x-n.x,R=B.y-n.y;k=ed(k,o),x[0]*=k,x[1]*=k,x[2]*=k,a=[l[0]+x[0]+O,l[1]+x[1],l[2]+x[2]+R],v=[N[0]-x[0]+O,N[1]-x[1],N[2]-x[2]+R],i?(c.add({x:l[0],y:l[2],e:l[1]}),c.add({x:a[0],y:a[2],e:a[1]}),c.add({x:v[0],y:v[2],e:v[1]}),c.add({x:N[0],y:N[2],e:N[1]})):(c.add({x:a[0],y:a[2],e:a[1]}),c.add({x:v[0],y:v[2],e:v[1]}))}}r.c1=a,r.c2=v}r._lastPointsSegments={points:c,segments:D},r.list=u(cr)===wo?M.createTubeModel(c,D,p/2,z):M.createLineModel(c,D,p,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=w}});var fg=function(y,r){Lh(fg,this,[y,r]),this._needRecoverPosition=!0};Ap(fg,Rh,{_80o:function(I,f,w){var P=this,K=P.gv,n=P.shapeModel;Ob(K,P.mat),n?Er(K,P.data,n,P,P.getBodyColor(),w):(Fj(P,I,f,"left",w),Fj(P,I,f,"front",w),Fj(P,I,f,"right",w),Fj(P,I,f,"back",w),Fj(P,I,f,"top",w),Fj(P,I,f,"bottom",w)),hk(K)},validate:function(q,W){var f,t,B=this,g=B.s,j=B.data,c=(j.p3(),j._thickness/2),n=j.isClosePath(),k=j.getPoints(),A=j.getSegments(),m=g(Ip),i=q&&q.uv;if(B.clear(),B.dispatchBoundingBoxChanged(),0>c){try{t=B.shapeModel=Ai(k,A,g(Te),g(qh),m,g(Cl),j.getTall(),j.getShapeElevation(),n)}catch(C){t=B.shapeModel={}}g(jf)?g("shape3d.image")||delete t.uv:(delete t.vs,delete t.ns,delete t.uv),g("shape3d.top.image")||delete t.top_uv,g("shape3d.bottom.image")||delete t.bottom_uv}else if(g(cr)===wo)f=Fi(k,A,m,n),t=B.shapeModel={vs:[]},g("shape3d.image")&&(t.uv=[],t.sum=g(Cl)||th(f)||1,t.len=0),g(Te)&&!n&&(t.top_vs=[],g("shape3d.top.image")&&(t.top_uv=[])),g(qh)&&!n&&(t.bottom_vs=[],g("shape3d.bottom.image")&&(t.bottom_uv=[])),B._12O(f,c);else{var l,O,D,r,o,x,$,V,F,R;if(f=Fi(k,A,m,n),o=B.vf(_j,i,!1,W),c&&(x=B.vf(bf,i,!1,W),$=n?w:B.vf(vq,i,!1,W),V=n?w:B.vf(hn,i,!1,W),F=B.vf(rd,i,!1,W),R=B.vf(fi,i,!1,W)),c){for(var Q=0,v=f.length;v>Q;Q++)f[Q]=B._tryRemoveBezierPoints(f[Q],c);B._12O(f,c)}else o&&f.forEach(function(q){if(r=q.length,r>0)for(l=q[0],D=1;r>D;D++)O=q[D],B.addV(o.vs,l,O),l=O});B._20Q(f),q||(o&&(o.ns=Wk(o.vs),qc(o,"vs"),qc(o,oh)),c&&(x&&(x.ns=Wk(x.vs),qc(x,"vs"),qc(x,oh)),$&&($.ns=Wk($.vs),qc($,"vs"),qc($,oh)),V&&(V.ns=Wk(V.vs),qc(V,"vs"),qc(V,oh)),F&&(F.ns=Wk(F.vs),qc(F,"vs"),qc(F,oh)),R&&(R.ns=Wk(R.vs),qc(R,"vs"),qc(R,oh))))}var N=B.mat=j.getPointsMatrix3d().getElements();q&&(tb(B,N,q,t),B.clear())},_20Q:function(R){var N,B,e,k,K,g,t,L=this,f=L.front,Q=L.back,U=L.top,C=L.bottom,Z=f?f.tuv:w,T=Q?Q.tuv:w,y=U?U.tuv:w,p=C?C.tuv:w,P=0;(Z||T||y||p)&&(N=L.s(Cl)||th(R)||1,R.forEach(function(q){if(B=q.length,B>0)for(g=q[0],e=1;B>e;e++)t=q[e],k=P/N,P+=qd(g,t),K=P/N,L._14O(f,k,K),L._14O(Q,1-K,1-k),L._14O(U,k,K),L._14O(C,k,K),g=t}))},_14O:function(c,Y,C){if(c){var o=c.uv,F=c.tuv;if(F){if(o)var b=o[0]+(o[6]-o[0])*Y,x=o[1]+(o[7]-o[1])*Y,U=o[2]+(o[4]-o[2])*Y,j=o[3]+(o[5]-o[3])*Y,A=o[2]+(o[4]-o[2])*C,I=o[3]+(o[5]-o[3])*C,i=o[0]+(o[6]-o[0])*C,N=o[1]+(o[7]-o[1])*C;else b=Y,x=0,U=Y,j=1,A=C,I=1,i=C,N=0;F.push(U,j,A,I,i,N,i,N,b,x,U,j)}}},_13O:function(R){var c=R.uv,Z=R.tuv;Z&&(c?Z.push(c[2],c[3],c[4],c[5],c[6],c[7],c[6],c[7],c[0],c[1],c[2],c[3]):Z.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(g,M){var H=g.length;if(4>H)return g;var Z,Y,w,V,R,v,h=!1,p=function(S){return g[S]},D=function(J){return g[H-1-J]};for(R=0;1>=R;R++)for(v=R?D:p,Y=v(0),w=v(1),Z=2;H-1>Z;Z++)if(V=v(Z),!V.remove)if(V.b){var u=qe(Y,w,V,M);u.adjust?(V.remove=!0,h=!0):(Y=w,w=V)}else Y=w,w=V;if(!h)return g;var a=[];for(Z=0;H>Z;Z++)g[Z].remove||a.push(g[Z]);return a},_12O:function(L,J){var g,r,e,O,B,V=this.s("shape3d.point.epsilon"),x=this;L.forEach(function(W){if(B=W.length,B>0)for(g={p:W[0],n:!0},O=1;B>O;O++)r=W[O],e=B-1>O?W[O+1]:w,e&&Math.abs(r.x-e.x)<V&&Math.abs(r.y-e.y)<V||x.addPoint(g,r,e,J,W)})},addPoint:function(D,Z,q,o,O){var y,H,h,Y,d,t,n,J,E,p=this,c=D.p,$=D.f,C=D.b,U=p.s("shape3d.side")||Ii,e=p.s("shape3d.start.angle"),s=p.s("shape3d.sweep.angle"),I=p.shapeModel,P=p.data.isClosePath();if(D.n&&(D.n=!1,$=P&&O.length>2?qe(O[O.length-2],c,Z,o):qe(w,c,Z,o),C=Dc(c,$),I?I.top_vs&&p._10O(C,$,U,e,s,I.top_vs,I.top_uv):(y=p.left)&&(p.addV(y.vs,C,$),p._13O(y))),H=q?qe(c,Z,q,o):P&&O.length>2?qe(c,Z,O[1],o):qe(c,Z,w,o),h=Dc(Z,H),I){var z,v,N=I.vs,X=I.uv,B=I.sum;for(X&&(z=I.len/B,I.len+=qd(c,Z),v=I.len/B),t=p._9O(C,$,U,e,s),n=p._9O(h,H,U,e,s),J=0;U>J;J++)E=J+1,Ho(N,t[E]),Ho(N,n[J]),Ho(N,t[J]),Ho(N,n[J]),Ho(N,t[E]),Ho(N,n[E]),X&&(Y=J/U,d=E/U,X.push(z,d,v,Y,z,Y,v,Y,z,d,v,d));!q&&I.bottom_vs&&p._10O(h,H,U,e,s,I.bottom_vs,I.bottom_uv,!0)}else!q&&(y=p.right)&&(p.addV(y.vs,H,h),p._13O(y)),(y=p.front)&&p.addV(y.vs,$,H),(y=p.back)&&p.addV(y.vs,h,C),(y=p.top)&&p.addH(y.vs,$,H,h,C,!0),(y=p.bottom)&&p.addH(y.vs,C,h,H,$);D.p=Z,D.f=H,D.b=h},_10O:function(o,x,K,M,B,d,z,Y){var g,C,L=this,J=L.data,w=L._9O(o,x,K,M,B),t=(o.x+x.x)/2,_=(o.y+x.y)/2,u=J.getShapeElevation(),v=0;for(v=0;K>v;v++)Y?(Ho(d,w[v]),Ho(d,w[v+1])):(Ho(d,w[v+1]),Ho(d,w[v])),Ho(d,[t,u,_]),z&&(Y?(g=c*(v+1)/K+M,C=c*v/K+M):(g=c*v/K+M,C=c*(v+1)/K+M),z.push(.5-.5*f(C),.5-.5*O(C),.5-.5*f(g),.5-.5*O(g),.5,.5))},_9O:function(M,A,I,s,Z){var R,l,V=this,r=V.data,n=[],e=(M.x+A.x)/2,z=(M.y+A.y)/2,K=r.getTall()/2,W=r.getShapeElevation(),S=0;for(Z==w&&(Z=c);I>=S;S++)R=Z*S/I+s,l=f(R),n.push([e+(M.x-e)*l,W+K*O(R),z+(M.y-z)*l]);return n},addV:function(r,I,v){var j=I.x,e=I.y,K=v.x,n=v.y,h=this.data,H=h.getShapeElevation(),l=h.getTall()/2;r.push(j,H-l,e,K,H-l,n,K,H+l,n,K,H+l,n,j,H+l,e,j,H-l,e)},addH:function(o,C,H,D,k,a){var l=this.data,g=l.getTall()/2,O=l.getShapeElevation()+(a?g:-g);o.push(C.x,O,C.y,H.x,O,H.y,D.x,O,D.y,D.x,O,D.y,k.x,O,k.y,C.x,O,C.y)},vf:function(Y,i,U,o){var n,L=this,G=L.gv.getFaceVisible(L.data,Y);return(U||G)&&(n=hb(L,Y,o),n.vs=[],n.tuv=G&&(n.texture||i)?[]:w,n.visible=G),n}});var nb,Zk,Ds=function(v,H){Lh(Ds,this,[v,H])};Ap(Ds,Rh,{validate:function(){var S=this,p=S.gv,o=S.data,z=S.s,v=er(z("points.color"));v=[v[0],v[1],v[2]];var D=z("points.size"),j=z("points.image")||"rect";("rect"===j||"circle"===j)&&("rect"===j?(nb||(nb=S._createCachedImage(j)),j=nb):(Zk||(Zk=S._createCachedImage(j)),j=Zk));var N=z("points.model");if(N){if(S._lastShapeModel!==N||!S.shapeModel){var E=el(S,N);if(!E)return;var $=[],J={};S.eachShapeModel(function(U){for(var S=0,Q=U.length;Q>S;S+=3){var Z=U[S],k=U[S+1],H=U[S+2],r=""+Z+"_"+k+"_"+H;J[r]||(J[r]=!0,$.push(Z,k,H))}},E),S.shapeModel={vs:new vg($)},o._pointsDirty=!0,S._lastShapeModel=N}}else{var P=o.points,C=P.length,U=C/3;if(o._pointsDirty||!S.shapeModel){var a=new vg(P);S.shapeModel={vs:a},o._pointsDirty=!1,S._lastShapeModel=null}}if(S.info={mat:ub(o),size:D,diffuse:v,opacity:z("points.opacity"),texture:j,alphaTest:z("points.transparent")?0:z("alphaTest")},o._colorsDirty){for(var O,s,R,B=[],L=!1,X=o.colors,u=0;C>u;u+=3)O=X[u],s=X[u+1],R=X[u+2],O===r||s===r||R===r?B.push(v[0],v[1],v[2]):(L=!0,B.push(O,s,R));S.shapeModel.cs=L?new vg(B):null,o._colorsDirty=!1}if(o._sizesDirty){for(var K=[],e=!1,Z=o.sizes,u=0;U>u;u++)Z[u]?(K.push(Z[u]),e=!0):K.push(D);S.shapeModel.ss=e?new vg(K):null,o._sizesDirty=!1}if(S._lastPointNumber!==U){var c=p.pickColorMap,T=c._pickIdUsed;c._pickIdUsed=T+U;for(var H=[],u=0;U>u;u++){var d=T+u,m=nh(d);H.push(m[0],m[1],m[2],m[3]),c[d]||(c[d]={data:o,part:u})}S.shapeModel.ps=new vg(H),S._lastPointNumber=U}this.dispatchBoundingBoxChanged()},_createCachedImage:function(B){var t=128,u=de(),f=u.getContext("2d");Vp(u,t,t,1),El(f,{width:t,height:t,comps:[{type:B,background:"white",borderWidth:0,rect:[0,0,t,t]}]},0,0,t,t);var K=s.Math.generateUUID();return lo[K]=u,K},_80o:function(C,A){var P=this,d=P.gv,s=P.shapeModel,N=P.info;if(s&&s.vs&&s.vs.length){var p=Qp.for(C);p.useProgram(P._asureProgram(C)),p.directState();var v=p.directUniforms(),f=p.directAttribs();v.modelMatrix=N.mat,v.modelViewMatrix=Kc([],d._viewMatrix,N.mat),v.projectionMatrix=d._projectMatrix,v.viewMatrix=d._viewMatrix,v.scale=d.getHeight()/2,v.size=N.size,v.diffuse=N.diffuse,v.opacity=N.opacity,v.map=d.getTexture(N.texture,P.data),v.alphaTest=N.alphaTest,v.resolution=d.getDevicePixelRatio(),f.position=Xp(C,d._buffer.vs,s.vs,w),d._picking?(v.picking=!0,f.pickColor=Xp(C,d._buffer.ps,s.ps,w),v.useColor=!1,f.color=null):(v.picking=!1,f.pickColor=null,s.cs?(v.useColor=!0,f.color=Xp(C,d._buffer.cs,s.cs,w)):(v.useColor=!1,f.color=null)),s.ss?(v.useSizeArray=!0,f.sizeArray=Xp(C,d._buffer.ss,s.ss,w)):(v.useSizeArray=!1,f.sizeArray=null),rp(C,0,s.vs.length/3,C.POINTS),p.useProgram(A)}},_asureProgram:function(Q){return Q._pointsShader||(Q._pointsShader=this.gv._postProcessing.createShader(Q,Ds.shaderSrc)),Q._pointsShader.program}}),Ds.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj4t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vv)o!jggjp!sn<!ocppjpumj!tqpjQdwlnj!o+h!<yj!sbuubuNsojpcjvuudff!kwpfsdq5!!>q!jodpljDupjmtppsQ<`mh!!vo<jogppjsunj!tgpmQpwbnu!!+t!jy{jfs<ub!NvxofjjgWpmsfne!pgnm!p>b!uo!psjfutjptmpvQuwjnp!o<<*!!v1o/j2g!p-senf!ncspppgmt!ovbtsfuT!j){5fdBfsws!b>z!<op!jbuujutspjQcwvnu!f5!dgfmwp!bu<!*t!jo{pfjBusjstbpzq<!)4!dcfpwp!m>!!jetfQnfssptgqtfodbusjuw!f4Ndbfuws!jy~)!!n<b*u15/!2n!!-*s!p|mp!ds)f5udvfswo!!>n!]s!p3m!p^D]w!!4!|^!!*>s>p!m.p!D2f/t1v<)!!g~j!f!twmpfj!e!~n!bj<os)p*m!p|Dl!djjgq!!)>q!jsdplmjpoDhw*!!|^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!4>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*j!delsjpophD<uo!jvpoQj`gmphs!n-!qcbpnp!m)!Ee3jftsdvbusyefTuf!m>f+d!usbpcmmpfD<ftvg$gjjge!!ef|g!j*offmec)b!uVdTfFm`fNTBeQs!b*dt!jveoaj!g}p}s!nh!otjblndqjmqfas)3!Eg!jn!bq*<!Q$BfNo`eFjTgV!)wepfjoej!gnfbej!og)j*$!!|~!!wf<d*5!!zeujjgdgbvqtpf!D-pfmtpvsg<gj!ej!g)!5)dafqwj!d>l!jsophm!p%D%f!tvvtgfgDjpem!ps|*!!f|tm!fe!j~g!gv<t*f!Dzpumjpdsb!q>p!!w-f{dz5y)/!swpDmp";var Es=function(y,g){Lh(Es,this,[y,g]),this._needRecoverPosition=!0};Ap(Es,us,{_25Q:1,validate:function(H){var n=this,K=n.data,P=n.s,x=K.getPoints(),g=x.size();n.dispatchBoundingBoxChanged();var X=K.p3(),z=n.mat=Vd();ze(z,X),Ye(z,K.getFinalRotation3d(),K.getRotationMode());var _=K.getScale3d(),T=K._dynamicScale3d;if(T&&(_[0]*=T[0],_[1]*=T[1],_[2]*=T[2]),Ff(z,_),ze(z,oj(X)),(!n.s("geometry.cache")||!n.shapeModel)&&(n.shapeModel=n.info=w,g>1)){var l=n.info={},k=K.getSegments(),r=K.getThickness(),R=vs(x.get(0)),Z=vs(x.get(g-1)),y=g%2;0===y?(l.c1=vs(x.get(g/2-1)),l.c2=vs(x.get(g/2))):l.p3=vs(x.get((g-y)/2)),l.s1=R,l.s2=vs(x.get(1)),l.t1=vs(x.get(g-2)),l.t2=Z,l.list=P(cr)===wo?n.createTubeModel(x,k,r/2,H):n.createLineModel(x,k,r,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=w},_80o:function(Y,n,G){var b=this,o=b.shapeModel;if(o){var N=b.gv;Ob(N,b.mat),Er(N,b.data,o,b,b.getBodyColor(),G),hk(N)}}});var Fs=s.graph3d.VR=function(F){var D=this;D.gv=F,D._controllers=[],D.switch=new Hs(D),D._enable=!1,D._defaultCallLater=s.Default.callLater,D._defaultCancelLater=_m,"undefined"!=typeof x&&"VRFrameData"in x&&(D._frameData=new x.VRFrameData),D.measureOflength=1,D.eyesOffset=[0,0,0],D._orientation=new ar.Quaternion,D._lastHeadPose=[0,0,0],D._offsetToBeAdd=[0,0,0],D._originalOrientation=null,D._fpsInfo={time:0,fps:0,frames:0}};Ap(Fs,R,{ms_fire:!0,setOriginalYRotation:function(g){var I=this;if(null==g)return I._originalOrientation=null,void 0;var K=new ar.Vector3(0,1,0),O=(new ar.Quaternion).setFromAxisAngle(K,-g),s=(new ar.Matrix4).makeRotationFromQuaternion(O);return O.setFromAxisAngle(K,g),I._originalOrientation={quaternion:O,matrixInverse:s},!0},render:function(r,y,f){var N=this,i=N.gv;if(N._deviceInAction){var e=N._device;if(e){var J=N._measureOflength;e.depthNear=i.getNear()*J,e.depthFar=i.getFar()*J;var R=N._offsetToBeAdd;if(N.eyesOffset[0]+=R[0],N.eyesOffset[1]+=R[1],N.eyesOffset[2]+=R[2],R[0]=0,R[1]=0,R[2]=0,e.isPresenting===!1)return N._controllers.forEach(function(p){p&&p.update()}),i.iv(),!1;var D=N._frameData;e.getFrameData(D);var m=D.pose.position;if(m){var t=N.toViewPosition(m);i.setEye(t),N._orientation.fromArray(D.pose.orientation),N._originalOrientation&&N._orientation.premultiply(N._originalOrientation.quaternion);var x=new ar.Vector3(0,0,-10*N._scaleFactor);x.applyQuaternion(N._orientation),i.setCenter([t[0]+x.x,t[1]+x.y,t[2]+x.z])}N._controllers.forEach(function(h){h&&h.update()}),i.setViewport(r,0,0,y/2,f),N._viewMatrix=N._copyViewMatrix(D.leftViewMatrix),N._projectMatrix=N._copyProjectMatrix(D.leftProjectionMatrix),i.updateScene(),i.renderScene(),i.setViewport(r,y/2,0,y/2,f),N._viewMatrix=N._copyViewMatrix(D.rightViewMatrix),N._projectMatrix=N._copyProjectMatrix(D.rightProjectionMatrix),i.updateScene(),i.renderScene(),N._lastViewMatrix=N._viewMatrix,N._lastProjectMatrix=N._projectMatrix,N._viewMatrix=null,N._projectMatrix=null,N.submitFrame();var O=Date.now(),p=N._fpsInfo;return O-p.time>1e3?(p.fps=Math.round(1e3*(p.frames+1)/(O-p.time)),p.time=O,p.frames=0):p.frames++,!0}}},onVRDisplayPresentChange:function(){var U=this.isPresenting();this._injectGraphView(U),this.fp("present",!U,U)},getOrientation:function(){return this._orientation},addController:function(O){O=O||0;var f=this,Z=f.getController(O);return Z?Z:(Z=new Gs(f,O),f._controllers.push(Z),Z)},getController:function(t){t=t||0;for(var m=this._controllers,e=0,I=m.length;I>e;e++)if(m[e]&&m[e].id===t)return m[e];return null},removeController:function($){$=$||0;for(var q=this._controllers,T=0,K=q.length;K>T;T++)if(q[T]&&q[T].id===$)return q.splice(T,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(O,F){var Z=this,h=Z._scaleFactor,s=Z._eyesOffset,x=Z._lastHeadPose;if(Z._originalOrientation){var w=Z._originalOrientation.quaternion,z=new ar.Vector3(O);z.applyQuaternion(w).multiplyScalar(h).toArray(x)}else x[0]=O[0]*h,x[1]=O[1]*h,x[2]=O[2]*h;return F?(F[0]=x[0]+s[0],F[1]=x[1]+s[1],F[2]=x[2]+s[2],F):[x[0]+s[0],x[1]+s[1],x[2]+s[2]]},addEyesOffset:function(m,Y,S){var I=this._offsetToBeAdd;I[0]+=m,I[1]+=Y,I[2]+=S},_copyViewMatrix:function(V){var q=this,M=q.dup(V);if(q._originalOrientation){var Z=(new ar.Matrix4).fromArray(M);Z.multiply(q._originalOrientation.matrixInverse).toArray(M)}var v=q._scaleFactor;M[12]*=v,M[13]*=v,M[14]*=v;var $=q._eyesOffset;if($&&($[0]||$[1]||$[2])){var b=$[0],h=$[1],Q=$[2];M[12]-=M[0]*b+M[4]*h+M[8]*Q,M[13]-=M[1]*b+M[5]*h+M[9]*Q,M[14]-=M[2]*b+M[6]*h+M[10]*Q}return M},shutdown:function(){var G=this._device;G&&G.isPresenting&&G.exitPresent()},isPresenting:function(){var b=this._device;return b&&b.isPresenting},_copyProjectMatrix:function(g){var _=this.dup(g),s=this._scaleFactor;return _[14]*=s,_},dup:function(P,m){for(var b=P.length,k=m||new Array(b);b--;)k[b]=P[b];return k},getViewMatrix:function(v){var Y=this._viewMatrix;return Y?this.dup(Y,v):void 0},getProjectMatrix:function(){var r=this._projectMatrix;return r?this.dup(r):void 0},submitFrame:function(){var q=this;if(q._enable&&q._deviceInAction){var B=q._device;B&&B.isPresenting&&(B.submitFrame(),q.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(B){var D=this.gv;return D.intersectObjects(B,D.dm().getDatas())},setDevice:function(F){var X=this;X._device=F},_injectGraphView:function(){var E,n,e;return function(t){var m=this.gv;if(!t)return E&&(m.getWidth=E,m.getHeight=n,m.getDevicePixelRatio=e),void 0;var N=this._device,H=N.getEyeParameters("left"),h=H.renderWidth,u=H.renderHeight;
E=m.getWidth,n=m.getHeight,e=m.getDevicePixelRatio,m.getWidth=function(){return 2*h},m.getHeight=function(){return u},m.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(I){var S=this;if(!I)return pm=s.Default.callLater=S._defaultCallLater,_m=s.Default.cancelLater=S._defaultCancelLater,void 0;var S=this;pm=s.Default.callLater=function(z,l,T,y){var Z=S._device;return Z&&Z.isPresenting?y?fr(function(){pm(z,l,T)},y):Z.requestAnimationFrame(function(){S._deviceInAction=!0,z.apply(l,T),S._deviceInAction=!1}):S._defaultCallLater(z,l,T,y)},_m=s.Default.cancelLater=function(Q,J){var Z=S._device;return Z&&Z.isPresenting?J?hd(Q):Z.cancelAnimationFrame(Q):S._defaultCancelLater(Q,J)}}}),R.defineProperties(Fs.prototype,{enable:{get:function(){return this._enable},set:function($){var f=this;f._enable!==$&&(f._enable=$,$?(f.switch.showButton(),f._injectCallLaterFunc(!0)):(f.shutdown(),f.switch.hideButton(),f._injectCallLaterFunc(!1)),f.fp("enable",!$,$))}},measureOflength:{get:function(){return this._measureOflength},set:function(i){this._measureOflength=i;var v=this._scaleFactor=1/i;this._controllers.forEach(function(D){D&&D._setScaleFactor(v)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(h){this._eyesOffset=h}},controllerModel:{get:function(){return this._controllerModel},set:function(O){var n;"object"==typeof O?(n=O.mtl,O=O.obj):(n=O+".mtl",O+=".obj");var $=this,k=$._controllerModel;k&&k.obj===O&&k.mtl===n||(k=$._controllerModel={obj:O,mtl:n},Y.loadObj(O,n,{finishFunc:function(M,A){$._controllerModel===k&&Y.setShape3dModel("vrControllerModel",A)}}))}},interactive:{get:function(){return!!this._interactive},set:function(S){!!S!=!!this._interactive&&(this._interactive=S,S&&this.addController(0),this.gv.getCoreInteractor().enableVR(S))}}});var Gs=function(I,O){function q(L){var Y=navigator.getGamepads&&navigator.getGamepads();if(Y)for(var J=0,A=0,b=Y.length;b>J;J++){var N=Y[J];if(N){var k=N.id;if("OpenVR Gamepad"===k||0===k.indexOf("Oculus Touch")||k.indexOf("Controller")>=0){if(A===L)return N;A++}}}}function g(c,W,H){return Math.abs(c[0]-W[0])<H&&Math.abs(c[1]-W[1])<H&&Math.abs(c[2]-W[2])<H?!0:!1}var s=this;s.vr=I,s.id=O;var S,a,N=[0,0],C=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],E=new Wd;E.s("shape3d","vrControllerModel"),E.isController=!0,E.s("intersect",!1),s.getGamepad=function(){return a},s.isButtonPressed=function(T){for(var B,X=0,U=C.length;U>X;X++)if(B=C[X],B.id===T)return B.pressed;return!1},s.getNode=function(){return E};var X=.003;s.setRotationEpsilon=function(A){X=A};var z=5e-4,t=z;s.setPositionEpsilon=function(W){z=W,t=W*s.vr._scaleFactor},s._setScaleFactor=function(h){E.s3(h,h,h),t=z*h},s._setScaleFactor(s.vr._scaleFactor);var y,$=new _i,H=new _p,d=[0,0,0],m=[0,0,0],k=new xc,R=new Zb,Z=new Vm;s.getRay=function(){return y?(Z.origin.fromArray(d),Z.direction.copy(R),y=!1,Z):Z},s.update=function(){if(S=a,a=q(O),!a||a.pose===r)return a=null,E.s("3d.visible",!1),void 0;if(Y.getShape3dModel("vrControllerModel")){E.dm()||I.gv.dm().add(E),E.s("3d.visible",!0);var z=a.pose;if(null!==z){if(z.position&&(s.vr.toViewPosition(z.position,d),g(E.p3(),d,t)||(y=!0,E.p3(d))),z.orientation){$.fromArray(z.orientation);var _=s.vr._originalOrientation;_&&$.premultiply(_.quaternion),R.set(0,0,-1).applyQuaternion($).normalize(),H.makeRotationFromQuaternion($),k.set(0,0,0,E.getRotationMode(),!0).setFromRotationMatrix(H),m[0]=k.x,m[1]=k.y,m[2]=k.z,g(E.r3(),m,X)||(y=!0,E.r3(m))}y&&I.fp("gamepad.pose",null,{position:d,rotation:m,id:O});var f=a.axes;(N[0]!==f[0]||N[1]!==f[1])&&(N=[f[0],f[1]],I.fp("gamepad.axes",null,{id:O,axes:N}));var T,b,Z,o,p=a.buttons;for(T=0,b=p.length;b>T;T++)if(Z=p[T],Z&&(o=Z.pressed,C[T]||(C[T]={id:"button"+T,pressed:!1}),o!==C[T].pressed)){C[T].pressed=o;var K={id:O},v="state";K[v]=K._62O=o?"down":"up",I.fp("gamepad.button."+C[T].id,null,K)}}}}},Hs=function(r){this.vr=r,this._button=null};Ap(Hs,R,{showButton:function(){var o=this.assureButton();if(!o.parentNode){var z=this.vr.gv,f=z.getView();z._79O?f.insertBefore(o,z._79O):f.appendChild(o)}},hideButton:function(){var H=this._button;H&&H.parentNode&&H.parentNode.removeChild(H)},assureButton:function(){var E=this._button;return E?E:this._button=this.createButton(this.vr.gv)},createButton:function(g){function U(p,S){p.textContent=S&&S.isPresenting?" VR ":" VR "}function V(q){p.style.display="",p.style.cursor="pointer",p.style.left="calc(50% - 50px)",p.style.width="100px",U(p,q),p.onmouseenter=function(){p.style.opacity="1.0"},p.onmouseleave=function(){p.style.opacity="0.5"},p.onclick=function(){q.isPresenting?q.exitPresent():q.requestPresent([{source:g.getCanvas()}])},g.vr.setDevice(q)}function s(){p.style.display="",p.style.cursor="auto",p.style.left="calc(50% - 75px)",p.style.width="150px",U(p,null),p.onmouseenter=null,p.onmouseleave=null,p.onclick=null,g.vr.setDevice(null)}function M(K){K.style.position="absolute",K.style.bottom="20px",K.style.padding="12px 6px",K.style.border="1px solid #fff",K.style.borderRadius="4px",K.style.color="#000",K.style.font="normal 13px sans-serif",K.style.textAlign="center",K.style.opacity="0.5",K.style.outline="none",K.style.zIndex="999"}if("getVRDisplays"in navigator){var p=this._button=A.createElement("button");return p.style.display="none",M(p),B(x,"vrdisplayconnect",function(t){V(t.display)}),B(x,"vrdisplaydisconnect",function(){s()}),B(x,"vrdisplaypresentchange",function(J){U(p,J.display),g.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(M){M.length>0?V(M[0]):s()}),p}var e=A.createElement("a");return e.href="https://webvr.info",e.innerHTML=" webvr",e.style.left="calc(50% - 90px)",e.style.width="180px",e.style.textDecoration="none",M(e),e}}),R.defineProperties(Hs.prototype,{});var Is=s.graph3d.PostProcessing=function(T){function G(){if(!B){var h=T.getGL();B=new Lq.RenderTarget(T,h,null,null,{samples:V.renderTextureSamples||1}),X=new Vk.Shader(h,C.vs,C.fs),A=Vk.Buffer.createIndexBuffer(h,new Uint16Array([0,2,1,1,2,3])),k=Vk.Buffer.createVertexBuffer(h,new Float32Array([0,0,1,0,0,1,1,1]))}}var B,X,A,k,F=this,o={},_=!1;!function(){R.keys(Is).forEach(function(Z){o[Z]=new Is[Z](T)})}(),F.getModule=function($){return $?o[$]:F},F.getModuleList=function(){return R.keys(o)},F._serializable=!0,F.handleDataModleChange=function($,I){$&&(F._serializable&&$.setPostProcessingData(F.serialize()),$.removeSerializeListener(F.onDataModelSerialize,F)),I&&(I.addSerializeListener(F.onDataModelSerialize,F),F.deserialize(I))},F.onDataModelSerialize=function(X){"serialize"===X.type?F._serializable&&(T.dm()._postProcessingData=F.serialize()):"deserialize"===X.type&&F.deserialize(T.dm())},F.isDeserializeDisabled=function(w){return!F._serializable||w.a("sceneBloom")!==r},F.isSerializable=function(){return F._serializable},F.setSerializable=function(P){F._serializable=P,P||T.dm().setPostProcessingData(r)},F.serialize=function(){var v,K,n,c,I={};for(K in o)if(n=o[K],c=n.serializeProperties){v={},n.enable&&(v.enable=!0);for(var M in c){var i=n[M];i!=c[M]&&(v[M]=i)}R.keys(v).length&&(I[K.toLowerCase()]=v)}return I},F.deserialize=function(s){var p,N,a,T,j,x={},i={};for(p in o){a=o[p],T=a.serializeProperties;var X={},K="scene"+p,d=s.a(K);d!==r&&(X.enable=d);for(var j in T)d=s.a(K+j[0].toUpperCase()+j.slice(1)),d!==r&&d!==T[j]&&(X[j]=d);Ae(X)||(i[p[0].toLowerCase()+p.slice(1)]=X)}if(Ae(i)&&(i=s.getPostProcessingData()),i)for(N in i)if(N&&(p=N[0].toUpperCase()+N.slice(1),a=o[p])){x[p]=!0,T=i[N];var O=!!T.enable;F.enableModule(p,O),p="scene"+p,s.a(p,O),a.resetProperties&&a.resetProperties();for(j in T)if("enable"!==j){var d=T[j];a[j]=d,s.a(p+j[0].toUpperCase()+j.slice(1),d)}}for(p in o)x[p]||(a=o[p],a.enable=!1,a.resetProperties&&a.resetProperties())},F.decodeShader=function(Q){var z,C,Y,g="",W="";for(Y=0;Y<Q.length;Y++)z=Q[Y],"%"===z?z="'":"a"===z?z='"':"]"===z&&(z="\\"),C=String.fromCharCode(z.charCodeAt(0)-1),Y%2?W+=C:g=C+g;return W+g},F.createShader=function(q,P,O){var x=P.indexOf("^#"),$=F.decodeShader(P.substr(0,x)),N=F.decodeShader(P.substr(x+2));if(O){var R=O($,N);R&&R.vs&&($=R.vs),R&&R.fs&&(N=R.fs)}return new Vk.Shader(q,$,N)},F.enableModule=function(l,L){var s,t,r,f=l.split(",");for(s=0,t=f.length;t>s;s++)r=f[s].trim(),o[r]&&(o[r].enable=L);_=!1;for(r in o)if(o[r].enable){_=!0;break}_&&G()};var C={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};F.render=function(t,w,e){if(_){B.setSize(t,w,e),B.bind(t);var Q=t.getParameter(t.COLOR_CLEAR_VALUE);Q&&0===Q[0]&&0===Q[1]&&0===Q[2]&&0===Q[3]?Q=null:fp(t,[0,0,0,0]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),T.setViewport(t,0,0,w,e),T.renderScene(),B.unbind(t);for(var x=0,C=T._glCapabilities.maxAttributes;C>x;x++)t.disableVertexAttribArray(x);var m,O=B;for(m in o)O=o[m]._42(t,O)||O;return T.setViewport(t,0,0,w,e),Q&&fp(t,Q),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),X.bind(),t.activeTexture(t.TEXTURE0+0),me(t,O.texture),X.uniforms.image=0,A.upload(),k.upload(),X.attributes.pos.pointer(k),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),me(t,null),t.useProgram(T._prg),!0}}},Js=s.graph3d.PostProcessing.Bloom=function(p){function r(){var a=p.getGL();if(a)for(var y=p._postProcessing,$=0;d>$;$++)V[$]=y.createShader(a,Js._35Q,function(U,g){return{fs:g.replace(/DEFINE_VALUE/g,M[$]).replace("%OVERRIDE_ALPHA_DEFINE%",X?"#define OVERRIDE_ALPHA":"")}})}function H(){var D=p.getWidth(),j=p.getHeight();if(D&&j){z=[D,j],B=!0;var h,Q=p.getGL(),I=Math.round(z[0]/2),W=Math.round(z[1]/2);for(s=new Lq.RenderTarget(p,Q,I,W),h=0;d>h;h++)N.push(new Lq.RenderTarget(p,Q,I,W)),A.push(new Lq.RenderTarget(p,Q,I,W)),I=Math.round(I/2),W=Math.round(W/2);var L=p._postProcessing;c=L.createShader(Q,Js._34Q),r(),F=L.createShader(Q,Js._36Q,function(S,$){return{fs:$.replace(/NUM_MIPS/g,d)}}),o=L.createShader(Q,Js.finalShader),E=Vk.Buffer.createIndexBuffer(Q,new Uint16Array([0,2,1,1,2,3])),T=Vk.Buffer.createVertexBuffer(Q,new Float32Array([0,0,1,0,0,1,1,1]))}}var i,K,U,X,Y,E,T,C,W=this,q=!1,B=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var x=this.serializeProperties;for(var P in x)this[P]=x[P]},R.defineProperties(W,{enable:{get:function(){return q},set:function(M){!!q!=!!M&&(q=M,M&&!B&&H(),p.iv())}},strength:{get:function(){return i},set:function(Z){i!==Z&&(i=Z,p.iv())}},threshold:{get:function(){return K},set:function($){K!==$&&(K=$,p.iv())}},radius:{get:function(){return U},set:function(s){U!==s&&(U=s,p.iv())}},overrideAlpha:{get:function(){return X},set:function(K){!!X!=!!K&&(X=K,B&&r(),p.iv())}},selective:{get:function(){return Y},set:function(z){!!Y!=!!z&&(Y=!!z,p.iv())}}}),this.resetProperties();var s,c,F,o,z=[256,256],N=[],A=[],d=5,M=[3,5,7,9,11],V=[];W._42=function(J,a){function w(S,Z,R,k){lc(J,Z.frame),p.setViewport(J,0,0,Z.width,Z.height),k?k(J):J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),n!==S&&S.bind();var h=0;for(var F in R){var Y=R[F];Y instanceof WebGLTexture&&(J.activeTexture(J.TEXTURE0+h),me(J,Y),Y=h,h++),S.uniforms[F]=Y}for(n!==S&&(E.upload(),T.upload(),S.attributes.pos.pointer(T),n=S),J.drawElements(J.TRIANGLES,6,J.UNSIGNED_SHORT,0);h--;)J.activeTexture(J.TEXTURE0+h),me(J,null);sm(J)}if(q&&(B||(H(),B))){var n;if(Y){C||(C=new Lq.RenderTarget(p,J)),C.setSize(J,a.width,a.height),C.bind(J);var g=J.getParameter(J.COLOR_CLEAR_VALUE);g&&0===g[0]&&0===g[1]&&0===g[2]&&1===g[3]?g=null:fp(J,[0,0,0,1]),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),p.setViewport(J,0,0,a.width,a.height),J._blooming=!0,p.renderScene(),J._blooming=!1,g&&fp(J,g),C.unbind(J)}w(c,s,{smoothWidth:.01,luminosityThreshold:K,tDiffuse:Y?C.texture:a.texture});var m,Z=s,k=Math.round(z[0]/2),I=Math.round(z[1]/2);for(m=0;d>m;m++)w(V[m],N[m],{colorTexture:Z.texture,direction:[1,0],texSize:[k,I]}),w(V[m],A[m],{colorTexture:N[m].texture,direction:[0,1],texSize:[k,I]}),k=Math.round(k/2),I=Math.round(I/2),Z=A[m];return w(F,N[0],{blurTexture1:A[0].texture,blurTexture2:A[1].texture,blurTexture3:A[2].texture,blurTexture4:A[3].texture,blurTexture5:A[4].texture,bloomStrength:i,bloomRadius:U,bloomTintColor:[1,1,1]}),w(o,a,{image:N[0].texture},function(D){Qp.for(D).glState.blend.apply({enabled:!0,equation:D.FUNC_ADD,func:[D.SRC_ALPHA,D.ONE]})}),Qp.for(J).glState.blend.apply({equation:J.FUNC_ADD,func:[J.SRC_ALPHA,J.ONE_MINUS_SRC_ALPHA,J.ONE,J.ONE_MINUS_SRC_ALPHA]}),a}}};Js._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Js._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Js._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Js.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Ks=s.graph3d.PostProcessing.Dof=function(o){function M(){A=!0;var v=o.getGL();O=new Lq.RenderTarget(o,v),T=o._postProcessing.createShader(v,Ks._38Q),w=Vk.Buffer.createIndexBuffer(v,new Uint16Array([0,2,1,1,2,3])),d=Vk.Buffer.createVertexBuffer(v,new Float32Array([0,0,1,0,0,1,1,1]))}var O,T,w,d,J,g,t,N,y=this,l=!1,A=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var d=this.serializeProperties;for(var N in d)this[N]=d[N]},R.defineProperties(y,{enable:{get:function(){return l},set:function(K){!!l!=!!K&&(l=K,K&&!A&&M(),o.iv())}},image:{get:function(){return g},set:function(L){g!==L&&(g=L,J&&(o.getGL().deleteTexture(J),J=null),o.iv())}},maxblur:{get:function(){return t},set:function(u){t!==u&&(t=u,o.iv())}},aperture:{get:function(){return N},set:function(P){N!==P&&(N=P,o.iv())}}}),this.resetProperties(),y._42=function(D,u){function i(G,j,Q,p){lc(D,j.frame),o.setViewport(D,0,0,j.width,j.height),p?p(D):D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT),E!==G&&G.bind();var b=0;for(var e in Q){var A=Q[e];A instanceof WebGLTexture&&(D.activeTexture(D.TEXTURE0+b),me(D,A),A=b,b++),G.uniforms[e]=A}for(E!==G&&(w.upload(),d.upload(),G.attributes.pos.pointer(d),E=G),D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0);b--;)D.activeTexture(D.TEXTURE0+b),me(D,null);sm(D)}if(l){A||M();var E;if(!J){var C=Ub(this.image);if(!C||!C.tagName)return u;J=ah(D,C)}var m=u.width,s=u.height;if(m&&s)return O.setSize(D,m,s),i(T,O,{tColor:u.texture,tDepth:J,aspect:m/s,aperture:this.aperture,maxblur:this.maxblur}),O}}};Ks._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";var Ls=s.graph3d.PostProcessing.HueSaturation=function(P){function h(){c=!0;var t=P.getGL();T=new Lq.RenderTarget(P,t),m=P._postProcessing.createShader(t,Ls.hueSaturationShader),z=Vk.Buffer.createIndexBuffer(t,new Uint16Array([0,2,1,1,2,3])),u=Vk.Buffer.createVertexBuffer(t,new Float32Array([0,0,1,0,0,1,1,1]))}var z,u,m,T,D=this,C=!1,c=!1,V=[],i=[],W=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var r=this.serializeProperties;for(var J in r)this[J]=r[J]},this.resetProperties(),R.defineProperties(D,{enable:{get:function(){return C},set:function(y){!!C!=!!y&&(C=y,y&&!c&&h(),P.iv())}},hue:{get:function(){return V},set:function(b){if(V!==b&&7===b.length){for(var j=0;7>j;j++)V[j]=b[j]/180;P.iv()}}},saturation:{get:function(){return i},set:function(E){if(i!==E&&7===E.length){for(var $=0;7>$;$++)i[$]=E[$]/100;P.iv()}}},lightness:{get:function(){return W},set:function(X){if(W!==X&&7===X.length){for(var w=0;7>w;w++)W[w]=X[w]/100;P.iv()}}}}),D._42=function(I,r){if(C){c||h();var D=r.width,U=r.height;if(D&&U){T.setSize(I,D,U),lc(I,T.frame),P.setViewport(I,0,0,T.width,T.height),I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT),m.bind(),I.activeTexture(I.TEXTURE0+0),me(I,r.texture);var Z=m.uniforms;return Z.image=0,Z.hue=V,Z.saturation=i,Z.lightness=W,z.upload(),u.upload(),m.attributes.pos.pointer(u),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0),me(I,null),sm(I),T}}}};Ls.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var Ms=s.graph3d.PostProcessing.Blur=function(X){function f(){h=!0;var R=X.getGL();u=new Lq.RenderTarget(X,R),J=X._postProcessing.createShader(R,Ms.hBlurShader),W=X._postProcessing.createShader(R,Ms.vBlurShader),D=Vk.Buffer.createIndexBuffer(R,new Uint16Array([0,2,1,1,2,3])),K=Vk.Buffer.createVertexBuffer(R,new Float32Array([0,0,1,0,0,1,1,1]))}var D,K,J,W,u,j,k=this,U=!1,h=!1;this.serializeProperties={value:0},this.resetProperties=function(){this.value=0},R.defineProperties(k,{enable:{get:function(){return U},set:function(Q){!!U!=!!Q&&(U=Q,Q&&!h&&f(),X.iv())}},value:{get:function(){return j},set:function(z){j!==z&&(j=z,X.iv())}}}),this.resetProperties(),k._42=function(B,J){return U?k.drawImpl(B,J,j):void 0},k.drawImpl=function(m,e,v,q){h||f();var z=e.width,g=e.height;if(z&&g){q&&(z*=q,g*=q),u.setSize(m,z,g),lc(m,u.frame),X.setViewport(m,0,0,u.width,u.height),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),J.bind(),m.activeTexture(m.TEXTURE0+0),me(m,e.texture);var r=J.uniforms;r.image=0,r.value=v/z,D.upload(),K.upload(),J.attributes.pos.pointer(K),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),sm(m),lc(m,e.frame),X.setViewport(m,0,0,e.width,e.height),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),W.bind(),m.activeTexture(m.TEXTURE0+0),me(m,u.texture);var r=W.uniforms;return r.image=0,r.value=v/g,D.upload(),K.upload(),W.attributes.pos.pointer(K),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),sm(m),me(m,null),u}}};Ms.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Ms.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",xl(Y,{accordionViewExpandIcon:Aj(un),accordionViewCollapseIcon:Aj(un,!0),accordionViewLabelColor:mf,accordionViewLabelFont:iq,accordionViewTitleBackground:pn,accordionViewSelectBackground:nj,accordionViewSelectWidth:3,accordionViewSeparatorColor:r,splitViewDividerSize:1,splitViewDividerBackground:pn,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Ac,rect:[2,2,12,12],background:un}]},propertyViewLabelColor:Cr,propertyViewLabelSelectColor:mf,propertyViewLabelFont:iq,propertyViewExpandIcon:Aj(ss),propertyViewCollapseIcon:Aj(ss,!0),propertyViewBackground:nn,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Bf,propertyViewColumnLineColor:Bf,propertyViewSelectBackground:nj,listViewLabelColor:Cr,listViewLabelSelectColor:mf,listViewLabelFont:iq,listViewRowLineVisible:!1,listViewRowLineColor:Bf,listViewSelectBackground:nj,treeViewLabelColor:Cr,treeViewLabelSelectColor:mf,treeViewLabelFont:iq,treeViewExpandIcon:Aj(jh),treeViewCollapseIcon:Aj(jh,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Bf,treeViewSelectBackground:nj,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Cr,tableViewLabelSelectColor:mf,tableViewLabelFont:iq,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Bf,tableViewColumnLineColor:Bf,tableViewSelectBackground:nj,treeTableViewLabelColor:Cr,treeTableViewLabelSelectColor:mf,treeTableViewLabelFont:iq,treeTableViewExpandIcon:Aj(jh),treeTableViewCollapseIcon:Aj(jh,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Bf,treeTableViewColumnLineColor:Bf,treeTableViewSelectBackground:nj,tableHeaderLabelColor:Cr,tableHeaderLabelFont:iq,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Fb,tableHeaderBackground:nn,tableHeaderMoveBackground:Up,tableHeaderInsertColor:nj,tableHeaderSortDescIcon:Xb(ss,!0),tableHeaderSortAscIcon:Xb(ss),tabViewTabGap:1,tabViewLabelColor:mf,tabViewLabelFont:iq,tabViewTabBackground:pn,tabViewSelectWidth:3,tabViewSelectBackground:nj,tabViewMoveBackground:Up,tabViewInsertColor:nj,toolbarLabelColor:Cr,toolbarLabelSelectColor:mf,toolbarLabelFont:iq,toolbarBackground:nn,toolbarSelectBackground:nj,toolbarItemGap:8,toolbarSeparatorColor:tj},!0);
var Ns={translateX:1,sortColumn:1},Os={sortable:1,sortOrder:1,sortFunc:1},Ps={focusData:1},Qs={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Rs={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Ss=function(g,V){V.add(g),g.hasChildren()&&g.eachChild(function(s){Ss(s,V)})},Ts=function(k,F,s,j,q,g,W,h,H,Z,v){var P,i=s.getValueType(Z),z=s.getAlign(Z);if(s.getEnumValues(Z)){var L=s.toEnumLabel(F,Z),c=fh||0,$=0,J=g,S=Y.getTextSize(j,L).width;return P=Ub(s.toEnumIcon(F,Z)),P&&($=g+fh/2,"center"===z?$+=(h-(c+S))/2:"right"===z&&($=$+h-(c+S)),Pn(k,P,$,W+H/2,Z,v),J=$+fh/2),L!=w&&(P?Uq(k,L,j,q,J,W,h-(J-g),H):Uq(k,L,j,q,g,W,h,H,z)),void 0}return F=s.formatValue(F),F!=w?i===ul?(pb(k,g,W,h,H,F),void 0):i===ke||!i&&Of(F)?(P=Ub(F?af:Qb),Pn(k,P,g+h/2,W+H/2,Z,v),void 0):(Uq(k,F,j,q,g,W,h,H,z),void 0):void 0},Us=function(o,m){var C=m.view,I=Ie(o),O=m.column||m.property;C.getDataModel().beginTransaction(),m.editor=o,o.info=m,C.setCurrentEditor(o),C.getView().insertBefore(I,C._79O),Ni(o,m.editorRect),o.setFocus?o.setFocus():hj(o),o.commitValue=function(V,T){o._17Q&&(o=o._17Q),T||C.setValue(m.data,O,o.getValue?o.getValue():o.value),o.close&&o.close(),zk(I)},O.onEditorCreated&&O.onEditorCreated(m)},Vs=function(a,p,u,K,v){var m=tr(a,u),z=p.value,U=p.view,O=v.getValueType(p.data);return m.onblur=m.onchange=function(){U.endEditing()},"input"===a?(z=v.formatValue(z),z!=w&&(m.value=z),m.onkeydown=function(x){sk(x)?U.endEditing():bo(x)&&U.endEditing(!0)},(O===Dk||O===Qm)&&B(m,yq,Y.numberListener)):a===nq&&K.forEach(function(I){var N=A.createElement("option");N.innerHTML=v.toEnumLabel(I),N.value=I,v.isEnumEqual(z,I)&&(N.selected=!0),Ld(m,N)}),Us(m,p),m},Ws=s.widget={},Xs=function(S,X,R){Ap(D+".widget."+S,X,R)};xl(Jo,{ms_value:function(o){o.getValue=function(R){var l=this.getItemById(R),D=l.element;return ap(D)?D:D?D.getValue?D.getValue():D.value:l.selected},o.setValue=function(p,I){var o=this.getItemById(p);if(o){var j=o.element;j&&!ap(j)?j.setValue?j.setValue(I):j.value=I:Of(I)?(o.selected=I,this.iv()):(o.element=I,this.iv())}},o.v=function(h,e){var K=this;if(2===arguments.length)K.setValue(h,e);else{if(!np(h))return K.getValue(h);for(var S in h)K.setValue(S,h[S])}return K}},_46o:function(y){y._icon=w,y._accessType=w,y._valueType=w,y._editable=!1,y._batchEditable=!0,y._align=vq,y._nullable=!0,y._emptiable=!1,y.setParent=Bh,y.formatValue=function(W){var Q=this,r=Q._valueType;return Q.getEnumValues()?Q.toEnumLabel(W):r===ke?!!W:W!=w&&r===Dk?N(W):W},y.setEnum=function(R,Q,i,P,N,n,_){var y=this;R&&!wd(R)&&R.values&&(P=R.editable,i=R.icons,Q=R.labels,N=R.strict,n=R.maxHeight,_=R.dropDownWidth,R=R.values),aq(R)&&(R=R._as),aq(Q)&&(Q=Q._as),aq(i)&&(i=i._as),y._enumValues=R,y._enumLabels=Q,y._enumIcons=i,y._enumEditable=P,y._enumStrict=N==w?!0:N,y._enumMaxHeight=n,y._enumDropDownWidth=_,R&&R.length&&wn(R[0])&&(y._valueType=Qm),y.fp("enum",!1,!0)},y.getEnumDropDownWidth=function(){return this._enumDropDownWidth},y.getEnumMaxHeight=function(){return this._enumMaxHeight},y.isEnumEditable=function(){return this._enumEditable},y.getEnumValues=function(){return this._enumValues},y.getEnumLabels=function(){return this._enumLabels},y.getEnumIcons=function(){return this._enumIcons},y.isEnumStrict=function(){return this._enumStrict},y.isEnumEqual=function(t,g){return this._enumStrict?t===g:t==g},y.toEnumLabel=function(m,V){var p=this,i=p.getEnumValues(V),d=p.getEnumLabels(V);if(i&&d)for(var N=0;N<i.length;N++)if(p.isEnumEqual(m,i[N]))return d[N];return m},y.toEnumIcon=function(U,K){var R=this,y=R.getEnumValues(K),w=R.getEnumIcons(K);if(y&&w)for(var g=0;g<y.length;g++)if(R.isEnumEqual(U,y[g]))return w[g];return r}},_45o:function(i){i._87o=function(T,x,R,Y,J,c){if(T){var e=this,f=e._90I,t=Zn(1);e._columnLineVisible&&(J-=1),e._rowLineVisible&&(c-=1),0>=J||0>=c||(e._90I||(f=e._90I={}),f[x]||(f[x]=new Pk),Ni(t,e.tx()+R,e.ty()+Y,J,c),Ld(t,T),e._view.insertBefore(t,e._79O),T.onParentAdded&&T.onParentAdded(t),f[x].add(t))}},i._76o=function(){var F=this,i=F._90I;if(i){for(var H in i)i[H].each(function(I){zk(I)});delete F._90I}},i._77o=function(B){var L=this;if(L._90I){var y=L._90I[B];y&&(y.each(function(M){zk(M)}),delete L._90I[B])}}},_47o:function(x){x.getValue=function(K,r){return r.getValue?r.getValue(K,r,this):Qf(K,r.getAccessType(),r.getName())},x.setValue=function(g,j,L){if(j.isEmptiable(g)||""!==L||(L=r),j.isNullable(g)||L!=w){var Y=this,I=j.getName(g),c=j.getAccessType(g),o=j.getValueType(g);o===Dk&&ap(L)?L=Sq(L):o===Qm&&ap(L)?L=parseFloat(L):o===ke&&ap(L)&&(L="true"===L),Y._batchEditable&&j._batchEditable&&Y.isSelected(g)?Y.sm().each(function(l){j.setValue?j.setValue(l,j,L,Y):Qi(l,c,I,L)}):j.setValue?j.setValue(g,j,L,Y):Qi(g,c,I,L)}},x.setCurrentEditor=function(k){this.endEditing(),this._currentEditor=k,this.redraw()},x.isEditing=function(K,w){var L=this,W=L._currentEditor;if(!W)return!1;if(w){var s=W.info;return s?(s.column||s.property)===w&&s.data===K:!1}return!0},x.endEditing=function(Y){var r=this,F=r._currentEditor;F&&(delete r._currentEditor,F.commitValue&&F.commitValue(F.info,Y),r.redraw(),r.getDataModel().endTransaction())},x.beginEditing=function(u){this.endEditing();var M=this,m=u.column||u.property;if(m.beginEditing)m.beginEditing(u);else{var p=u.data,k=u.value,W=M.getSelectBackground(p),s=m.getEnumValues(p),S=m.getSlider(p),B=m.getColorPicker(p);if(S){var y=Hb(Ws.Slider,S);return y.setValue(k),y.getView().onblur=function(){M.endEditing()},y.isInstant()&&(y.onValueChanged=function(){M.setValue(p,m,y.getValue())}),Us(y,u),void 0}if(B||m.getValueType(p)===ul){var Z=Hb(Ws.ColorPicker,B);return Z.setValue(k),Z.onClosed=function(){M.endEditing()},Z.isInstant()&&(Z.onValueChanged=function(H,v){M.setValue(p,m,v)}),Us(Z,u),Z.open(),void 0}if(s){if(Ws.ComboBox){var j=new Ws.ComboBox;j.setValue(k),j.setValues(s),j.setLabels(m.getEnumLabels(p)),j.setIcons(m.getEnumIcons(p)),j.setEditable(m.isEnumEditable(p)),j.setStrict(m.isEnumStrict(p)),j.setMaxHeight(m.getEnumMaxHeight(p)),j.setDropDownWidth(m.getEnumDropDownWidth(p)),j.onClosed=function(){M.endEditing()},Us(j,u),j.open()}else Vs(nq,u,W,s,m);return}var F=m.getValueType(p);if(F===ke||Of(k))return M.setValue(p,m,!k),void 0;if(m.getItemEditor(p)){var z=Fr(m.getItemEditor(p)),n=new z(p,m,M,u),X=n.getView();return X._17Q=n,n.setValue(k),es(X),Us(X,u),n.editBeginning&&n.editBeginning(),void 0}Vs("input",u,W,w,m)}}},_44o:function(r){r.init=function(u){var m=this,f=m.th=new kt(u),x=m._view=xf(1,m);m.tv=m._tableView=u,Ld(x,f.getView()),Ld(x,u.getView()),f.mp(function(G){G.property===fc&&m.iv()}),m.iv()},r.getTableView=function(){return this.tv},r.getTableHeader=function(){return this.th},r.getDataModel=function(){return this.tv.dm()},r.getColumnModel=function(){return this.tv.getColumnModel()},r.setColumns=function(b){this.tv.setColumns(b)},r.addColumns=function(t){this.tv.addColumns(t)},r.endEditing=function(){this.tv.endEditing()},r.validateImpl=function(){var P=this,L=P.th,F=rg(L),C={x:0,y:0,width:P.getWidth(),height:F};Ni(L,C),C.y=F,C.height=i(0,P.getHeight()-F),Ni(P.tv,C)}},ms_vs:function(c){c._41o=function(){return this._29I.height<this._59I},c._43o=function(){var u=this;u._41o()&&(u._58I||(fr(function(){u._94O()},Lp),u.iv()),u._58I=new Date)},c._94O=function(){var r=this;if(r._58I){var g=new Date;g.getTime()-r._58I.getTime()>=Lp?(delete r._58I,r.iv()):fr(function(){r._94O()},Lp)}},c._93I=function(){var l=this,z=l._27I;if(l._58I||!l._autoHideScrollBar){z||Ld(l._79O,z=l._27I=Zn());var k=l._29I,L=k.height,j=l._59I,h=l.getScrollBarSize(),o=k.width-h-2,A=L*(-l.ty()/j),Y=L*(L/j),I=z.style;j>L?(ph>Y&&(A=A+Y/2-ph/2,0>A&&(A=0),A+ph>L&&(A=L-ph),Y=ph),I.visibility=Ri,I.background=l.getScrollBarColor(),I.borderRadius=h/2+qf,Ni(z,o,A,h,Y)):I.visibility=$h}else z&&(z.style.visibility=$h)}},ms_hs:function(I){I._40o=function(){return this._29I.width<this._91I},I._42o=function(){var b=this;b._40o()&&(b._95O||(fr(function(){b._94I()},Lp),b.iv()),b._95O=new Date)},I._94I=function(){var i=this;if(i._95O){var I=new Date;I.getTime()-i._95O.getTime()>=Lp?(delete i._95O,i.iv()):fr(function(){i._94I()},Lp)}},I._92I=function(){var o=this,f=o._28I;if(o._95O||!o._autoHideScrollBar){f||Ld(o._79O,f=o._28I=Zn());var Z=o._29I,k=Z.width,X=o._91I,P=o.getScrollBarSize(),S=Z.height-P-2,e=k*(-o.tx()/X),D=k*(k/X),V=f.style;X>k?(ph>D&&(e=e+D/2-ph/2,0>e&&(e=0),e+ph>k&&(e=k-ph),D=ph),V.visibility=Ri,V.background=o.getScrollBarColor(),V.borderRadius=P/2+qf,Ni(f,e,S,D,P)):V.visibility=$h}else f&&(f.style.visibility=$h)}}}),We(af,Pp(16,16,[{type:ki,rect:[1,1,14,14],background:nj},{type:wr,rect:[1,1,14,14],width:1,color:Oc},{type:ii,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),We(Qb,Pp(16,16,{type:wr,rect:[1,1,14,14],width:1,color:Oc})),We(Mn,Pp(16,16,[{type:og,rect:[2,2,12,12],borderWidth:1,borderColor:Oc,background:"#FFF"},{type:og,rect:[4,4,8,8],background:nj}])),We(Pq,Pp(16,16,{type:og,rect:[2,2,12,12],borderWidth:1,borderColor:Oc})),Jo._15Q=function(R){R._29I=Jq,R._59I=0,R._91I=0,R._5o=function(q){var n=this;n._30I=new Pk,n._rows=new Pk,n._rowMap={},n._31I=0,n._14I=0,n._view=xf(1,n),n._canvas=de(n._view),Ld(n._view,n._79O=Zn()),n.dm(q?q:new Rb)},R.getCheckIcon=function(W){var d=this.sm(),j=d.co(W);return d.sg()?Ub(j?Mn:Pq):Ub(j?af:Qb)},R.checkData=function(b){var A=this.sm(),j=A.co(b);A.sg()&&j||(this._32o=1,j?A.rs(b):A.as(b),delete this._32o)},R.getDataAt=function(f){f.target&&(f=this.lp(f));var a=C(f.y/this._rowHeight),$=this._rows;return 0>a||a>=$.size()?w:$.get(a)},R.onDataDoubleClicked=function(){},R.onDataClicked=function(){},R.adjustTranslateX=function(){return 0},R.adjustTranslateY=function(w){var M=this.getHeight()-this._59I;return M>w&&(w=M),w>0?0:N(w)},R.onPropertyChanged=function(i){var D=this,A=i.property;Qs[A]?D.ivm():Ps[A]||D.redraw(),A===kh?D._42o():A===Ze&&D._43o()},R.getLabel=function(x){return x.toLabel()},R.getLabelFont=function(){return this._labelFont},R.getLabelColor=function(Z){var M=this;if(M.isCheckMode()){if(M._focusData===Z)return M._labelSelectColor}else if(M.isSelected(Z))return M._labelSelectColor;return M._labelColor},R.getStartRowIndex=function(){return this._31I},R.getEndRowIndex=function(){return this._14I},R.getRowDatas=function(){return this._rows},R.getRowIndex=function(f){return this._rowMap[f._id]},R.getRowSize=function(){return this._rows.size()},R.getViewRect=function(){return fq(this._29I)},R.isVisible=function(a){return this._visibleFunc?this._visibleFunc(a):!0},R.getCurrentSortFunc=function(){return this._sortFunc},R.setDataModel=function(i){var b=this,k=b._dataModel,e=b._selectionModel;k!==i&&(k&&(k.umm(b.handleDataModelChange,b),k.umd(b.handleDataPropertyChange,b),k.umh(b.handleHierarchyChange,b),e||k.sm().ums(b.handleSelectionChange,b)),b._dataModel=i,i.mm(b.handleDataModelChange,b),i.md(b.handleDataPropertyChange,b),i.mh(b.handleHierarchyChange,b),e?e._21I(i):i.sm().ms(b.handleSelectionChange,b),b.fp("dataModel",k,i))},R.validateModel=function(){var i=this;i._rows.clear(),i._rowMap={},i.buildChildren(i._dataModel._roots);var U=i._rows=i._rows.toList(i.isVisible,i),S=0,R=i.getCurrentSortFunc(),$=U.size();for(R&&U.sort(R);$>S;S++)i._rowMap[U.get(S)._id]=S},R.buildChildren=function(P){var b=this;P.each(function(E){b._rows.add(E),b.buildChildren(E._children)})},R.handleDataModelChange=function(){this.ivm()},R.handleDataPropertyChange=function(j){"parent"===j.property?this.ivm():this.invalidateData(j.data)},R.handleHierarchyChange=function(){this.ivm()},R.handleSelectionChange=function(Y){Y.datas.each(this.invalidateData,this),this.onSelectionChanged(Y)},R.onSelectionChanged=function(G){var D=this,s=D.sm();!D.isAutoMakeVisible()||1!==s.size()||"set"!==G.kind&&"append"!==G.kind||D._32o||D.makeVisible(s.ld())},R.handleBackgroundClick=function(M){yf(M)&&!this.isCheckMode()&&this.sm().cs()},R.makeVisible=function(s){s&&(this._23I=s,this.iv())},R.scrollToIndex=function(s){var $=this,t=$._29I,U=t.height,m=$._rowHeight,Q=m*s;s>=0&&s<$._rows.size()&&U>0&&(Q+m>t.y+U?$.ty(-Q+U-m):Q<t.y&&$.ty(-Q))},R.autoScroll=function(e,k){var K=this,P=K._rowHeight,w=P,i=P/4,Y=K._29I,C=K.lp(e),X={x:K.tx(),y:K.ty()};return P>0&&Y&&(C.x-Y.x<w?K.translate(i,0):Y.x+Y.width-C.x<w&&K.translate(-i,0),C.y-Y.y<w?K.translate(0,i):Y.y+Y.height-C.y<w&&K.translate(0,-i)),X.x=K.tx()-X.x,X.y=K.ty()-X.y,k&&(k.x+=X.x,k.y+=X.y),X},R.getTopRowOrderSelection=function(){var K=this.sm().getTopSelection(),Q={},i=new Pk;return K.each(function(f){Q[f._id]=f}),this._rows.each(function(Z){Q[Z._id]&&i.add(Z)}),i},R.getRowOrderSelection=function(){var X=new Pk;return this._rows.each(function(n){this.isSelected(n)&&X.add(n)},this),X},R.ivm=function(){this.invalidateModel()},R.invalidateModel=function(){var V=this;V._96I||(V._96I=1,V._32I=1,delete V._24I),V.iv()},R.redraw=function(){var d=this;d._32I||(d._32I=1,delete d._24I,d.iv())},R.invalidateData=function(P){var m=this;Fn?m.redraw():m._32I||(m._24I||(m._24I={}),m._24I[P._id]=P,m.iv())},R.getFocusData=function(){return this._focusData},R.setFocusDataById=function(I){this.setFocusData(this.dm().getDataById(I))},R.setFocusData=function(A){var M=this,C=M._focusData;C!==A&&(M._focusData=A,M.fp("focusData",C,A),C&&M.invalidateData(C),A&&(M.invalidateData(A),M.isAutoMakeVisible()&&M.makeVisible(A)))},R.drawRowBackground=function(F,W,D,q,j,M,Q){var o=this,l=o.isCheckMode();(W===o._focusData&&l||D&&!l)&&pb(F,q,j,M,Q,o.getSelectBackground(W))},R.drawData=function(j,Q,k){var m=this,G=m._rowHeight,x=G*k,X=m._29I,M=X.x,F=X.width;j.save(),j.beginPath(),j.rect(M,x,F,G),j.clip(),m._87o(m.drawRow(j,Q,m.isSelected(Q),M,x,F,G),k,M,x,F,G),j.restore(),m._rowLineVisible&&pb(j,M,x+G-1,F,1,m._rowLineColor)},R._12I=function(b){var g=this,I=g._31I,o=g._29I,N=o.x,P=o.y,z=o.width,Q=o.height;for(b.beginPath(),b.rect(N,P,z,Q),b.clip(),b.clearRect(N,P,z,Q),g._76o(),g._93db(b);I<g._14I;I++)g.drawData(b,g._rows.get(I),I);g._92db(b)},R._13I=function(v){for(var z,x=this,$=x._rowHeight,Y=x._29I,V=Y.x,S=Y.width,g=x._31I,m=x._30I;g<x._14I;g++)z=x._rows.get(g),x._24I[z._id]&&m.add({data:z,index:g});m.isEmpty()||(v.beginPath(),m.each(function(P){v.rect(V,P.index*$,S,$)}),v.clip(),m.each(function(E){v.clearRect(V,E.index*$,S,$)}),m.each(function(X){x._77o(X.index)}),x._93db(v),m.each(function(T){x.drawData(v,T.data,T.index)}),x._92db(v),m.clear())},R.preValidateModel=function(){this.endEditing&&this.endEditing()},R.validateImpl=function(){var c=this,O=c._canvas,R=c.getWidth(),d=c.getHeight(),W=c._rowHeight,p=c._32I;(R!==O.clientWidth||d!==O.clientHeight)&&(Vp(O,R,d),p=1);var b=a&&!Dq;c._96I&&!b&&(c.preValidateModel(),c.validateModel());var I=c._29I,t={x:-c.tx(),y:-c.ty(),width:R,height:d},q=c._rows.size(),n=_d(O),z=c._23I;p||uo(t,I)||(p=1),c._29I=t,c._59I=q*W,c._31I=C(t.y/W),c._14I=v((t.y+t.height)/W),c._31I<0&&(c._31I=0),c._14I>q&&(c._14I=q),c._99I&&p&&c._99I(),(c._40o()||c._41o())&&(c._59I+=c.getScrollBarSize(),c._99I&&p&&(c._91I+=c.getScrollBarSize())),Kh(n,c.tx(),c.ty(),1),p?c._12I(n):c._24I&&c._13I(n),c._93I(),c._92I(),n.restore(),c._32I=c._24I=c._96I=w,z&&(c.scrollToIndex(c.getRowIndex(z)),delete c._23I),c.tx(c.tx()),c.ty(c.ty())},R.canHandleSelectMode=function(){return!0}},Jo._48o=function(a){a._rootVisible=!0,a._rootData=w,a._35o=function(){this._expandMap={},this._levelMap={}},a.validateModel=function(){var P=this,T=P._rootData;P._rows.clear(),P._levelMap={},P._rowMap={},P._currentLevel=0,T?P._rootVisible?P.isVisible(T)&&P.buildData(T):P.buildChildren(T):P.buildChildren(),delete P._currentLevel},a.buildData=function($){var E=this,O=$._id,X=E._rows;E._rowMap[O]=X.size(),X.add($),E._levelMap[O]=E._currentLevel,E.isExpanded($)&&(E._currentLevel++,E.buildChildren($),E._currentLevel--)},a.buildChildren=function(E){var G=this,U=E?E._children:G._dataModel._roots,R=G.getCurrentSortFunc();R&&G.isChildrenSortable(E)?U.toList(G.isVisible,G).sort(R).each(G.buildData,G):U.each(function(b){G.isVisible(b)&&G.buildData(b)})},a.getLevel=function(x){return this._levelMap[x._id]},a.getToggleIcon=function(V){var I=this,v=I._loader,Q=I._collapseIcon;return v&&!v.isLoaded(V)?Q:V.hasChildren()?I.isExpanded(V)?I._expandIcon:Q:w},a.isCheckMode=function(){return this._checkMode!=w},a.isChildrenSortable=function(){return!0},a.handleDataModelChange=function(s){var c=this;s.kind===Ge?delete c._expandMap[s.data._id]:s.kind===qb&&(c._expandMap={}),c.ivm()},a.toggle=function(z){var F=this;F.isExpanded(z)?F.collapse(z):F.expand(z)},a.isExpanded=function($){return 1===this._expandMap[$._id]},a.expand=function(M){var c=this,n=c._loader;c.isExpanded(M)||(n&&!n.isLoaded(M)&&n.load(M),c._expandMap[M._id]=1,c.ivm(),c.onExpanded(M))},a.onExpanded=function(){},a.collapse=function(r){var A=this;A.isExpanded(r)&&(delete A._expandMap[r._id],A.ivm(),A.onCollapsed(r))},a.onCollapsed=function(){},a.expandAll=function(c){if(c)this.expand(c),c.eachChild(function(P){this.expandAll(P)},this);else{var p=this;p._dataModel.each(function(W){W.hasChildren()&&(p._expandMap[W._id]=1)}),p.ivm()}},a.collapseAll=function(){this._expandMap={},this.ivm()},a.makeVisible=function(k){if(k){var R=this;if(!R._rootData||k.isDescendantOf(R._rootData)){for(var F=k._parent;F;)R.expand(F),F=F._parent;R._23I=k,R.iv()}}},a.checkData=function(x){var U,p=this,I=p._checkMode,j=p.sm(),H=j.co(x);if(!j.sg()||!H){if(p._32o=1,I===Bi)H?j.rs(x):j.as(x);else if(I===ir)U=new Pk(x),U.addAll(x._children);else if("descendant"===I)U=new Pk,Ss(x,U);else if("all"===I&&(U=new Pk,Ss(x,U),!H))for(var b=x._parent;b;)U.add(b),b=b._parent;U&&(H?j.rs(U):j.as(U)),delete p._32o}},a.drawTree=function(T,S,f,w,z,a,X){var B=this,N=B._indent,p=B._levelMap[S._id],l=B.getIconWidth(S),G=Ub(B.getToggleIcon(S));G?(w+=N*p,Pn(T,G,w+N/2,z+X/2,S,B),w+=N):w+=N*(p+1),B._checkMode&&(Pn(T,B.getCheckIcon(S),w+N/2,z+X/2,S,B),w+=N),B.drawIcon(T,S,w,z,l,X),B.drawLabel(T,S,w+l,z,X)}},Jo._14Q=function(W){W.getIcon=function(Q){return Q.getIcon()},W.getIconWidth=function(u){return this.getIcon(u)?this._indent:0},W.drawIcon=function(O,C,o,p,g,I){if(g){var P=this,Z=P.getBodyColor(C),$=Ub(P.getIcon(C),Z);$&&(I-=P.isRowLineVisible()?1:0,Pr(O,$,ef,o,p,g,I,C,P,Z),$d(O,P.getBorderColor(C),o,p,g,I))}},W.drawLabel=function(j,$,r,C,O){var l=this;Uq(j,l.getLabel($),l.getLabelFont($),l.getLabelColor($),r,C,0,O)}},Jo._50o=function(e){e._98I=function(){var J=this,G=J._39o=new Rb;J._60I=new Pk,G.mm(J._17o,J),G.md(J._18o,J),G.mh(J._19o,J)},e.setColumns=function(o){this._39o.clear(),this.addColumns(o)},e.addColumns=function(S){var e=this._39o;S.forEach(function(n){if(!(n instanceof Zs)){var Q=Fr(n.className);n=Hb(Q?Q:Zs,n)}e.add(n)})},e.onColumnClicked=function(){},e.onCheckColumnClicked=function(){},e._3Q=function(F){for(var Z,T=0,S=this._60I,J=S.size();J>T;T++)if(Z=S.get(T),Z.column===F)return Z;return w},e.getColumnAt=function(_){var f=this._4Q(_);return f?f.column:w},e._4Q=function(z){for(var N=this,W=z.target?N.lp(z).x:z.x,c=N._60I,d=0;d<c.size();d++){var r=c.get(d),V=r.startX;if(W>=V&&W<V+r.column.getWidth())return r}return w},e.getToolTip=function(M){var V=this,D=V.getDataAt(M),u=V.getColumnAt(M);return D&&u?u.getToolTip(D,V):w},e.adjustTranslateX=function(t){var K=this.getWidth()-this._91I;return K>t&&(t=K),t>0?0:N(t)},e._99I=function(){var X=this,k=X._29I,f=X._60I;f.clear(),X._91I=0,X._39o._roots.each(function(J){if(J.isVisible()){var K=X._91I+J.getWidth();X._91I<=k.x+k.width&&K>=k.x&&f.add({column:J,startX:X._91I}),X._91I=K}})},e.drawData=function(N,z,A){var y=this,q=y._rowHeight,J=q*A,G=y.isSelected(z),w=y._29I,h=w.x,j=w.width;y.drawRowBackground(N,z,G,h,J,j,q),y._60I.each(function(j){var V=j.column,Y=j.startX,d=V.getWidth();d>0&&!y.isEditing(z,V)&&(N.save(),N.beginPath(),N.rect(Y,J,d,q),N.clip(),y._87o(y.drawCell(N,z,G,V,Y,J,d,q),A,Y,J,d,q),y._columnLineVisible&&pb(N,Y+d-1,J,1,q,y._columnLineColor),N.restore())}),y._rowLineVisible&&pb(N,h,J+q-1,j,1,y._rowLineColor)},e.drawCell=function(i,M,q,C,x,I,B,R){var h=this;if(C.drawCell)return C.drawCell(i,M,q,C,x,I,B,R,h);var y=h.getValue(M,C);Ts(i,y,C,h.getLabelFont(M,C,y),h.getLabelColor(M,C,y),x,I,B,R,M,h)},e.getColumnModel=function(){return this._39o},e._17o=function(){this.redraw()},e._18o=function(y){var q=this;y.data===q._sortColumn&&Os[y.property]?q.ivm():(q._42o(),q.redraw())},e._19o=function(){this.redraw()},e.getCurrentSortFunc=function(){var w=this,b=w._sortColumn;if(b&&b.isSortable()){var X=b.getSortFunc(),c=wj===b.getSortOrder()?1:-1;return X||(X=Ui),function(S,I){return X.call(w,w.getValue(S,b),w.getValue(I,b),S,I)*c}}return w._sortFunc},e.isCellEditable=function(K,J,o){return J.isEditable()&&this.isEditable()?J.isCellEditable?J.isCellEditable(K,J,o,this):!0:!1},e._37O=function(u,O){if(yf(O))for(var D=this,g=D.lp(O),U=D._60I,F=D._rowHeight,P=D._29I,R=P.x,k=P.y,y=P.width,S=P.height,h=0;h<U.size();h++){var i=U.get(h),d=i.startX,q=i.column,I=q.getWidth();if(q!==D._31o&&q!==D._4o&&g.x>=d&&g.x<d+I&&D.isCellEditable(u,q,O)){var r={x:d,y:D.getRowIndex(u)*F,width:I,height:F},f={x:r.x+D.tx(),y:r.y+D.ty(),width:r.width,height:r.height},z=0,b=0;return r.x<R?z=r.x-R:r.x+r.width>R+y&&(z=r.x+r.width-R-y),z&&(D.tx(D.tx()-z),f.x-=z),r.y<k?b=r.y-k:r.y+F>k+S&&(b=r.y+F-k-S),b&&(D.ty(D.ty()-b),f.y-=b),D.beginEditing({data:u,column:q,value:D.getValue(u,q),event:O,rect:r,editorRect:f,view:D}),void 0}}}},Ws.BaseItemEditor=function(A,G,l,U){this._data=A,this._column=G,this._master=l,this._editInfo=U},Xs("BaseItemEditor",R,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Ys=s.Tab=function(){Lh(Ys,this)};Je("Tab",Xo,{ms_ac:["view","closable","disabled","visible"],_icon:w,_closable:!1,_disabled:!1,_visible:!0,setParent:Bh});var Zs=s.Column=function(){Lh(Zs,this)};Je("Column",Xo,{_46o:1,ms_ac:["accessType","valueType",Ri,ag,os,rl,"align",ul,"sortOrder",Kk,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:wj,_sortFunc:w,_sortable:!0,_clickable:!0,setWidth:function(x){16>x&&(x=16);var E=this._width;this._width=x,this.fp(rl,E,x)},getToolTip:function(I,D){return this.formatValue(D.getValue(I,this))}});var $s=s.Property=function(){Lh($s,this)};Je("Property",Xo,{_46o:1,ms_ac:["accessType","valueType",ag,os,"categoryName",ul,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:w,getToolTip:function(F,K,w){var k=this;return K?k.formatValue(w.getValue(F,k)):w.getPropertyName(k)}}),Ws.AccordionView=function(){var M=this;M._20o={},M._21o=new Pk,M._10o=w,M._9o=w,M._11o=w,M._view=xf(0,M),M.iv()},Xs("AccordionView",R,{ms_v:1,ms_fire:1,ms_ac:[gi,pi,"titleHeight",Nj,Hi,"titleBackground","selectWidth",Iq,"orientation","separatorColor"],_expandIcon:Y.accordionViewExpandIcon,_collapseIcon:Y.accordionViewCollapseIcon,_titleHeight:he,_labelColor:Y.accordionViewLabelColor,_labelFont:Y.accordionViewLabelFont,_titleBackground:Y.accordionViewTitleBackground,_selectBackground:Y.accordionViewSelectBackground,_selectWidth:Y.accordionViewSelectWidth,_orientation:"v",_separatorColor:Y.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(c,U,z,R){var v=this,y=Zn(),l={content:U,div:y,canvas:de(y),icon:R};if(v._20o[c])throw c+" already exists";var t=l.downEventFunc=function(I){mc(I)},m=l.upEventFunc=function(C){mc(C),yf(C)&&(v._10o===c?v.collapse():v.expand(c))};[ib,Ur].forEach(function(C){B(y,C,t)}),[_g,lh].forEach(function(p){B(y,p,m)}),y.style.cursor=kq,Ld(v._view,y),v._20o[c]=l,v._21o.add(c),z&&v.expand(c),v.iv()},remove:function(l){var H=this,D=H._20o[l];if(D){var u=D.div;zk(u),[ib,Ur].forEach(function(d){q(u,d,D.downEventFunc)}),[_g,lh].forEach(function(Q){q(u,Q,D.upEventFunc)}),delete H._20o[l],H._21o.remove(l),H.iv()}},clear:function(){var b=this;b._21o.toArray().forEach(b.remove,b),b._20o={},b._21o.clear(),b.iv()},isExpanded:function(n){return this._10o===n},expand:function(q){var u=this;u._20o[q]&&u._10o!==q&&(u._10o=q,u.onExpanded(q),u.iv())},onExpanded:function(){},collapse:function(){var z=this;z._10o&&(z.onCollapsed(z._10o),delete z._10o,z.iv())},onCollapsed:function(){},initCanvas:function(f,v,W){Vp(f,v,W);var u=_d(f);return Kh(u,0,0,1),u.clearRect(0,0,v,W),u},drawTitle:function(p,n,H,E,P){var y=this,z=Ub(P.icon),R=y.isExpanded(n),O=y._titleHeight,B=y._titleBackground,v=y._selectWidth,e=y._separatorColor,U=Ub(R?y._expandIcon:y._collapseIcon),L=v+4;pb(p,0,0,H,E,B),R&&v&&pb(p,0,0,v,E,y._selectBackground),(R||y._21o.get(y._21o.size()-1)!==n)&&pb(p,0,E-1,H,1,e?e:tn(B)),z&&(Pn(p,z,L+To(z)/2,O/2),L+=To(z)+2),Uq(p,n,y.getLabelFont(n),y.getLabelColor(n),L,0,0,O),U&&Pn(p,U,H-To(U)/2-4,O/2)},validateImpl:function(){var W=this,V=W._view,a=0,N=0,p=W.getWidth(),M=W.getHeight(),d=W._titleHeight,l=W._21o.size()*d,R=W._11o,E=W._9o;delete W._11o,delete W._9o,W._21o.each(function(f){var o,P,u=W._20o[f],F=u.content,I=W._10o===f;gr(W)?(Ni(u.div,a,0,d,M),o=W.initCanvas(u.canvas,d,M),Hn(o,0,M),An(o,-T),W.drawTitle(o,f,M,d,u),o.restore(),I?(P=i(0,p-l),F&&(W._11o=F,W._9o=Ie(F),Ni(F,a+d,0,P,M)),a+=d+P):a+=d):(Ni(u.div,0,N,p,d),o=W.initCanvas(u.canvas,p,d),W.drawTitle(o,f,p,d,u),o.restore(),I?(P=i(0,M-l),F&&(W._11o=F,W._9o=Ie(F),Ni(F,0,N+d,p,P)),N+=d+P):N+=d)});var Y=W._9o;R&&R!==W._11o&&R.endEditing&&R.endEditing(),Y&&Y!==E&&Ld(V,Y),E&&E!==Y&&zk(E)}}),Ws.SplitView=function(T,a,_,j){var R=this,Z=R._dividerDiv=Zn(),m=R._60O=de(),p=R._61O=de(),D=m.style,O=p.style;R._view=xf(1,R),Ld(R._view,Z),D.msTouchAction=Ok,D.pointerEvents=Ok,D.cursor=kq,O.msTouchAction=Ok,O.pointerEvents=Ok,O.cursor=kq,T&&R.setLeftView(T),a&&R.setRightView(a),_&&R.setOrientation(_),j!=w&&R.setPosition(j),R.setStatus(xb),new _s(R)},Xs("SplitView",R,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:Y.splitViewDividerSize,_dividerBackground:Y.splitViewDividerBackground,_dragOpacity:Y.splitViewDragOpacity,_toggleIcon:Y.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(Q,M){var Y=this,G=Y._position;isNaN(Q)||(M||(Y._82O=0>Q?-1:Q>1?1:0),Y._position=Q,Y.fp(ie,G,Q))},getLeftView:function(){return this._leftView},setLeftView:function(W){var J=this,D=J._leftView,u=J._view;if(J._leftView!==W){if(D&&D!==J._rightView){var s=Ie(D);s.parentNode===u&&zk(s)}if(J._leftView=W,W){var H=Ie(W);H.parentNode!==u&&u.insertBefore(H,J._dividerDiv)}J.fp("leftView",D,W)}},getRightView:function(){return this._rightView},setRightView:function(b){var k=this,t=k._rightView,r=k._view;if(k._rightView!==b){if(t&&t!==k._leftView){var D=Ie(t);D.parentNode===r&&zk(D)}if(k._rightView=b,b){var R=Ie(b);R.parentNode!==r&&r.insertBefore(R,k._dividerDiv)}k.fp("rightView",t,b)}},validateImpl:function(){var F=this,B=F._draggable,r=F._position,c=F.getWidth(),p=F.getHeight(),V=F._dividerSize,W=F._dividerBackground,E=re?18:8,Q=F._dividerDiv,M=F._82O,A=F._60O,s=F._61O,y=F._toggleIcon,h=F._status,b=Q.style,C=null,L=re?20:4,u=y.comps[0];V>=E||0===V?F._coverDiv&&(zk(F._coverDiv),delete F._coverDiv):F._coverDiv||(F._coverDiv=Zn(),qm&&(F._coverDiv.style.background=Xn),Ld(Q,F._coverDiv)),F._togglable?A.parentNode||(Ld(Q,A),Ld(Q,s)):(zk(A),zk(s));var _=F._coverDiv,d=F._leftView,R=F._rightView;if(gr(F)){if(V>c&&(V=c),h===xb)if(1===M)var Y=X(r,c),q=i(0,c-V-Y);else-1===M?(q=X(-r,c),Y=i(0,c-V-q)):(Y=N((c-V)*r),q=i(0,c-V-Y));else"cl"===h?(Y=0,q=i(0,c-V)):"cr"===h&&(q=0,Y=i(0,c-V));d&&Ni(d,0,0,Y,p),R&&Ni(R,Y+V,0,q,p),Ni(Q,Y,0,V,p),F._22o=Y,_&&(Ni(_,V/2-E/2,0,E,p),_.style.cursor=B?mm:""),Q.style.cursor=B?mm:"";var U=Q.clientHeight/2,x=Q.clientWidth;Vp(A,x,x),Ni(A,0,U-x-L,x,x),C=_d(A),Kh(C,0,0,1),u.rotation=-T,El(C,y,0,0,x,x),C.restore(),Vp(s,x,x),Ni(s,0,U+L,x,x),C=_d(s),Kh(C,0,0,1),u.rotation=T,El(C,y,0,0,x,x),C.restore()}else{if(V>p&&(V=p),h===xb)if(1===M)var H=X(r,p),S=i(0,p-V-H);else-1===M?(S=X(-r,p),H=i(0,p-V-S)):(H=N((p-V)*r),S=i(0,p-V-H));else"cl"===h?(H=0,S=i(0,p-V)):"cr"===h&&(S=0,H=i(0,p-V));d&&Ni(d,0,0,c,H),R&&Ni(R,0,H+V,c,S),Ni(Q,0,H,c,V),F._22o=H,_&&(Ni(_,0,V/2-E/2,c,E),_.style.cursor=B?Uj:""),b.cursor=B?Uj:"";var e=Q.clientWidth/2,x=Q.clientHeight;Vp(A,x,x),Ni(A,e-x-L,0,x,x),C=_d(A),Kh(C,0,0,1),u.rotation=0,El(C,y,0,0,x,x),C.restore(),Vp(s,x,x),Ni(s,e+L,0,x,x),C=_d(s),Kh(C,0,0,1),u.rotation=g,El(C,y,0,0,x,x),C.restore()}b.background=W}});var _s=function(L){this.sv=L,this.addListeners()};Ap(_s,R,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(p){var T=this,g=T.sv,r=g._dividerDiv,O=g._60O,M=g._61O,E=g._status,Q=p.target;if(Q===O)E===xb?g.setStatus("cl"):"cr"===E&&g.setStatus(xb);else if(Q===M)E===xb?g.setStatus("cr"):"cl"===E&&g.setStatus(xb);else if(If(p)&&(Q===r||Q===g._coverDiv)&&(mc(p),g.isDraggable())){g.getLeftView(),g.getRightView();var S=T.maskDiv=Zn();if(S.style.left=0,S.style.top=0,S.style.width=g.getWidth()+"px",S.style.height=g.getHeight()+"px",g.getView().appendChild(S),!g.isContinuousLayout()){var I=T.resizeDiv=Zn();I.style.left=r.style.left,I.style.top=r.style.top,I.style.width=r.style.width,I.style.height=r.style.height,I.style.opacity=g.getDragOpacity(),I.style.background=g.getDividerBackground(),Ld(T.getView(),I)}T._lastAbsPosition=g._22o,T._86o=gr(g)?$c(p).x:$c(p).y,Ah(T,p)}},handleWindowTouchMove:function(H){If(H)&&this.update(H,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(L){var p=this;p.update(L,!0),p.sv.setStatus(xb),p.maskDiv&&zk(p.maskDiv),p.resizeDiv&&zk(p.resizeDiv),p.maskDiv=p.resizeDiv=w},handle_mousedown:function(K){yf(K)&&this.handle_touchstart(K)},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},update:function(q,K){var i=this,n=i.sv,o=gr(n)?n.getWidth():n.getHeight(),U=n._dividerSize,H=i._lastAbsPosition-i._86o;gr(n)?(H+=$c(q).x,H>o-U&&(H=o-U),0>H&&(H=0),i.resizeDiv&&(i.resizeDiv.style.left=H+qf)):(H+=$c(q).y,H>o-U&&(H=o-U),0>H&&(H=0),i.resizeDiv&&(i.resizeDiv.style.top=H+qf)),K&&o!==U&&(1===n._82O?n.setPosition(H,1):-1===n._82O?n.setPosition(H-o+U,1):n.setPosition(H/(o-U),1))}}),Ws.TabView=function(){var s=this,j=s._view=xf(1,s),N=s._91O=Zn(1),v=s._tabModel=new Rb,R=v.sm(),$=s.invalidate;s._7o=new Pk,s._canvas=de(N),Ld(j,N),Ld(j,s._92O=Zn(1)),R.setSelectionMode(Sj),R.ms(s.handleSelectionChange,s),v.mm($,s),v.mh($,s),v.md($,s),s._interactor=new at(s),s.iv()},Xs("TabView",R,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Nj,Hi,"tabHPadding","tabBackground","selectWidth",Iq,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:rd,_tabHeight:he,_tabGap:Y.tabViewTabGap,_labelColor:Y.tabViewLabelColor,_labelFont:Y.tabViewLabelFont,_tabBackground:Y.tabViewTabBackground,_selectWidth:Y.tabViewSelectWidth,_selectBackground:Y.tabViewSelectBackground,_moveBackground:Y.tabViewMoveBackground,_insertColor:Y.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(H,t,q){var d,i=this._tabModel;return H instanceof Ys?(d=H,t&&d.setView(t)):(d=new Ys,d.setName(H),d.setView(t)),i.add(d),q&&i.sm().ss(d),d},getLabel:function(E){return E.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(J){this._23o=J,this.iv()},get:function(t){var T=this,k=T._tabModel;if(wn(t))return k._roots.get(t);if(ap(t)){var I;return k.each(function(p){t===T.getLabel(p)&&(I=p)}),I}return t instanceof Ys?t:w},select:function(v){this._tabModel.sm().ss(this.get(v))},remove:function(r){var X=this;if(r=X.get(r)){var B=X._tabModel,O=B._roots.indexOf(r);X._tabModel.remove(r),X.selectByIndex(--O)}},getCurrentTab:function(){return this._8o},hideTabView:function(S,A){A.parentNode===this._92O&&(jl(A)?(A.style.display=to,A._tab_=S):zk(A),Wc())},showTabView:function(p,u){jl(u)&&(u.style.display="block",u._tab_=p),u.parentNode!==this._92O&&(Ld(this._92O,u),Wc())
},_24o:function(){var Q,P=this,Z=P._8o,u=P._9o,q=P._tabModel.sm().ld();q&&(Q=Ie(q.getView())),Q!==u&&(u&&(Z.getView()&&Z.getView().endEditing&&Z.getView().endEditing(),P.hideTabView(Z,u)),Q&&P.showTabView(q,Q)),P._8o=q,P._9o=Q,Z!==q&&P.onTabChanged(Z,q)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(c,p){this.selectByIndex(--p)},selectByIndex:function(N){var Q=this,l=Q._tabModel,y=l.size();if(y&&!l.sm().ld()){N==w&&(N=0),N>=y&&(N=y-1),0>N&&(N=0);for(var u=N;u>=0;u--){var K=Q.get(u);if(!K.isDisabled())return Q.select(K),K}for(u=N+1;y>u;u++)if(K=Q.get(u),!K.isDisabled())return Q.select(K),K}},getTabWidth:function(d){var m=this.getTabHPadding(),C=4+2*m,l=Ub(d.getIcon());l&&(C+=To(l,d)+4);var v=this.getLabel(d);return v&&(C+=Oq(this.getLabelFont(d),v).width+4),d.isClosable()&&(C+=10),C},drawTab:function(b,l,E,P,k,R,p){var N,i=this,Y=i._tabPosition,t=this.getTabHPadding(),B=E+4+t,o=i._selectWidth,U=Ub(l.getIcon()),J=l.isDisabled(),r=i.getLabelColor(l),c=i.getLabelFont(l),w=i.getLabel(l),I=i._selectBackground,O=Y===vq+"-vertical",q=Y===hn+"-vertical";(O||q)&&(B=P+4+t),J&&(b.globalAlpha=km),pb(b,E,P,k,R,p),l===i._8o&&o&&(Y===rd?pb(b,E,P+R-o,k,o,I):Y===vq?pb(b,E+k-o,P,o,R,I):Y===hn?pb(b,E,P,o,R,I):O?pb(b,E+k-o,P,o,R,I):q?pb(b,E,P,o,R,I):pb(b,E,P,k,o,I));var y=k/2;if(O&&(Hn(b,y,P+R/2),An(b,g),Hn(b,-y,-P-R/2)),U){var s=md(U,l),h=To(U,l);if(O||q){var C=E+k/2,m=B+s/2;Hn(b,C,m),An(b,T),Hn(b,-C,-m),Pn(b,U,E+k/2,B+s/2,l,i),Hn(b,C,m),An(b,-T),Hn(b,-C,-m),B+=s+4}else Pn(b,U,B+h/2,P+R/2,l,i),B+=h+4}return O||q?(Hn(b,k/2,B+k/2),An(b,T),Hn(b,-k/2,-B-k/2),Uq(b,w,c,r,E,B,R,k),Hn(b,k/2,B+k/2),An(b,-T),Hn(b,-k/2,-B-k/2)):Uq(b,w,c,r,B,P,k,R),O&&(Hn(b,y,P+R/2),An(b,-g),Hn(b,-y,-P-R/2)),l.isClosable()&&(N=q?{x:E+k-12,y:P+R-12,width:12,height:12}:{x:E+k-12,y:P+2,width:12,height:12},this.drawCloseIcon(l,b,r,N)),J&&(b.globalAlpha=1),N},drawCloseIcon:function(p,C,U,i){var g=i.x,N=i.y;C.strokeStyle=U,C.lineWidth=1,C.beginPath(),C.moveTo(g+2,N+8),C.lineTo(g+8,N+2),C.moveTo(g+8,N+8),C.lineTo(g+2,N+2),C.stroke()},getTabAt:function(v){var Y=this._interactor._8Q(v);return Y?Y.tab:null},validateImpl:function(){var p=this;p._24o();var K,T=p._canvas,R=p._tabPosition,Q=p._91O,C=p._92O,v=p._tabModel,I=p.getWidth(),d=p.getHeight(),x=p._tabHeight,W=p._7o,u=p._tabGap,q=R===rd,N=R===vq,M=R===hn,e=R===vq+"-vertical",Z=R===hn+"-vertical",y=p._23o,U=0;if((N||M)&&v._roots.each(function(H){U=i(p.getTabWidth(H),U)}),q?(Ni(Q,0,0,I,x),K={x:0,y:x,width:I,height:i(0,d-x)}):N?(Ni(Q,0,0,U,d),K={x:U,y:0,width:i(0,I-U),height:d}):M?(Ni(Q,I-U,0,U,d),K={x:0,y:0,width:i(0,I-U),height:d}):e?(Ni(Q,0,0,x,d),K={x:x,y:0,width:i(0,I-x),height:d}):Z?(Ni(Q,I-x,0,x,d),K={x:0,y:0,width:i(0,I-x),height:d}):(Ni(Q,0,d-x,I,x),K={x:0,y:0,width:I,height:i(0,d-x)}),Ni(C,K),e||Z){p._9o&&(K.x=0,Ni(p._8o.getView(),K)),Vp(T,x,d);var k=_d(T),z=0;if(Kh(k,0,p.ty(),1),k.clearRect(0,0,x,d),W.clear(),v._roots.each(function(U){if(U.isVisible()){var f,$=p.getTabWidth(U);y&&y.tab===U||(f=p.drawTab(k,U,0,z,x,$,p._tabBackground)),W.add({_75o:f,tab:U,startY:z,endY:z+$,height:$}),z+=$+u}}),p._23Q=i(0,z-u),y){var J=y.position;p.drawTab(k,y.tab,0,y.startY,x,y.height,p._moveBackground),pb(k,0,J,x,1,p._insertColor)}if(k.restore(),p._selectionChanged){p._selectionChanged=!1;for(var $=p.ty(),f=0;f<W.size();f++){var A=W.get(f);if(A.tab===p._8o){if(A.endY+$<0){p.ty(-A.startY);break}if(A.startY+$>d){p.ty(d-A.endY);break}}}}p.ty(p.ty())}else if(N||M){p._9o&&(K.x=0,Ni(p._8o.getView(),K)),Vp(T,U,d);var k=_d(T),z=0;if(Kh(k,0,p.ty(),1),k.clearRect(0,0,U,d),W.clear(),v._roots.each(function(b){if(b.isVisible()){var N;y&&y.tab===b||(N=p.drawTab(k,b,0,z,U,x,p._tabBackground)),W.add({_75o:N,tab:b,startY:z,endY:z+x,height:x}),z+=x+u}}),p._23Q=i(0,z-u),y){var J=y.position;p.drawTab(k,y.tab,0,y.startY,U,y.height,p._moveBackground),pb(k,0,J,U,1,p._insertColor)}if(k.restore(),p._selectionChanged){p._selectionChanged=!1;for(var $=p.ty(),f=0;f<W.size();f++){var A=W.get(f);if(A.tab===p._8o){if(A.endY+$<0){p.ty(-A.startY);break}if(A.startY+$>d){p.ty(d-A.endY);break}}}}p.ty(p.ty())}else{p._9o&&(K.y=0,Ni(p._8o.getView(),K)),Vp(T,I,x);var k=_d(T),X=0;if(Kh(k,p.tx(),0,1),k.clearRect(0,0,I,x),W.clear(),v._roots.each(function(V){if(V.isVisible()){var Q,B=p.getTabWidth(V);y&&y.tab===V||(Q=p.drawTab(k,V,X,0,B,x,p._tabBackground)),W.add({_75o:Q,tab:V,startX:X,endX:X+B,width:B}),X+=B+u}}),p._64I=i(0,X-u),y){var J=y.position;p.drawTab(k,y.tab,y.startX,0,y.width,x,p._moveBackground),rc(k,p._insertColor,J,0,x)}if(k.restore(),p._selectionChanged){p._selectionChanged=!1;for(var G=p.tx(),f=0;f<W.size();f++){var A=W.get(f);if(A.tab===p._8o){if(A.endX+G<0){p.tx(-A.startX);break}if(A.startX+G>I){p.tx(I-A.endX);break}}}}p.tx(p.tx())}for(var E=[],a=C.children,f=0;f<a.length;f++){var Y=a[f],h=Y._tab_;h&&!v.contains(h)&&E.push(Y)}E.forEach(function(U){C.removeChild(U)})}});var at=function(C){this.tv=C,this.addListeners()};Ap(at,R,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(i){this.handleScroll(i,10*(i.wheelDelta/40))},handle_DOMMouseScroll:function(H){this.handleScroll(H,10*-H.detail)},handleScroll:function(L,m){mc(L);var $=this.tv,c=$._tabPosition;!$._40o()||c!==rd&&c!==fi||$.tx(this.tv.tx()+m),!$._41o()||c!==vq&&c!==hn&&c!==vq+"-vertical"&&c!==hn+"-vertical"||$.ty(this.tv.ty()+m)},_8Q:function(y){var Y,c,d=this.tv,m=d._tabPosition,p=d._7o;if(m===rd||m===fi){var Z=d.lp(y).x;for(Y=0;Y<p.size();Y++)if(c=p.get(Y),c.startX<=Z&&Z<=c.endX)return c}else if(m===vq||m===hn||m===vq+"-vertical"||m===hn+"-vertical"){var V=d.lp(y).y;for(Y=0;Y<p.size();Y++)if(c=p.get(Y),c.startY<=V&&V<=c.endY)return c}return w},isClickable:function(o){var U=this.tv,c=U._tabPosition,N=this._73o=this._8Q(o);return!U._40o()||c!==rd&&c!==fi?!U._41o()||c!==vq&&c!==hn&&c!==vq+"-vertical"&&c!==hn+"-vertical"?N&&(!N.tab.isDisabled()||U.isMovable()):!0:!0},handle_mousemove:function(n){var I=this;Nr?I._74o=I._8Q(n):I.getView().style.cursor=I.isClickable(n)?kq:""},handle_mousedown:function(r){this.handle_mousemove(r),this.handle_touchstart(r)},handle_touchstart:function(C){var E=this,A=E.tv,P=A._tabPosition;mc(C),yf(C)&&E.isClickable(C)&&(P===rd||P===fi?(E.x=$c(C).x,E.lp=A.lp(C),E.tx=A.tx()):(E.y=$c(C).y,E.lp=A.lp(C),E.ty=A.ty()),Ah(E,C))},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(l){var G,O=this,s=O.tv,P=s._tabPosition,Y=O._73o;if(P===rd||P===fi){if(G=$c(l).x-O.x,!O._25o&&!O.moving&&J(G)>2&&(s._40o()&&!Xm(l)?O._25o=1:Y&&s.isMovable()&&(O.moving=1)),O._25o)s.tx(O.tx+G);else if(O.moving){var Q=O.lp.x+G,V=s._tabGap/2;s._7o.each(function(q){var x=q.endX,r=Q-q.startX<x-Q;Q>=q.startX&&x>=Q&&s._7Q({tab:Y.tab,startX:Y.startX+G,width:Y.width,front:r,insertTab:q.tab,position:r?i(0,q.startX-V):X(s._64I,x+V)})})}}else if(G=$c(l).y-O.y,!O._25o&&!O.moving&&J(G)>2&&(s._41o()&&!Xm(l)?O._25o=1:Y&&s.isMovable()&&(O.moving=1)),O._25o)s.ty(O.ty+G);else if(O.moving){var D=O.lp.y+G,V=s._tabGap/2;s._7o.each(function(z){var B=z.endY,J=D-z.startY<B-D;D>=z.startY&&B>=D&&s._7Q({tab:Y.tab,startY:Y.startY+G,height:Y.height,front:J,insertTab:z.tab,position:J?i(0,z.startY-V):X(s._23Q,B+V)})})}},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(){var x=this,S=x.tv,N=S._tabPosition,D=S.getTabModel(),M=D._roots,Z=x._73o;if(x.moving){var l=S._23o;if(l&&l.insertTab!==l.tab){var H=l.tab,f=M.remove(H),I=M.indexOf(l.insertTab);I>=0&&(l.front||I++,I<=M.size()&&(M.add(H,I),D._38I(H,f,I)))}S._7Q(w),delete x.moving}else if(!x._25o&&Z){H=Z.tab;var p=x._74o;if(!p||p.tab===H)if(!H.isDisabled()&&Vb(Z._75o,x.lp)){var g=function(){var g=M.indexOf(H);D.remove(H),S.onTabClosed(H,g)};S.onTabClosing(H,g)&&g()}else H.isDisabled()||S._8o===H||D.sm().ss(H)}x._25o=x._73o=x._74o=N===rd||N===fi?x.x=x.lp=x.tx=w:x.y=x.lp=x.ty=w}}),Ws.PropertyView=function(G){var c=this;c._view=xf(1,c),c._canvas=de(c._view),Ld(c._view,c._79O=Zn()),c._rows=new Pk,c._28o=new Pk,c._26o={},c._26Q={};var z=c._propertyModel=new Rb,w=c.ivm;z.mm(w,c),z.md(w,c),z.mh(w,c),c.dm(G?G:new Rb),new bt(c)},Xs("PropertyView",R,{ms_ac:[Nj,vb,Hi,ag,os,"categorizable",vn,Kk,Zg,gi,pi,rf,sd,ri,"selectRowIndex",Iq,"background",Kp,em,Qg,pk,te],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Jq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:fh,_background:Y.propertyViewBackground,_expandIcon:Y.propertyViewExpandIcon,_collapseIcon:Y.propertyViewCollapseIcon,_scrollBarColor:Lc,_scrollBarSize:qn,_autoHideScrollBar:ck,_selectBackground:Y.propertyViewSelectBackground,_rowHeight:nm,_rowLineVisible:Y.propertyViewRowLineVisible,_rowLineColor:Y.propertyViewRowLineColor,_10I:.5,_columnLineVisible:Y.propertyViewColumnLineVisible,_columnLineColor:Y.propertyViewColumnLineColor,_labelColor:Y.propertyViewLabelColor,_labelSelectColor:Y.propertyViewLabelSelectColor,_labelFont:Y.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(q){0>q&&(q=0),q>1&&(q=1);var B=this,Z=B._10I;B._10I=q,B.fp("columnPosition",Z,q)},getPropertyName:function(E){return E.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(r,e,R){return R===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(s,g){return g===this._selectRowIndex?this._labelSelectColor:s.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(H){var p=this.getHeight()-this._59I;return p>H&&(H=p),H>0?0:N(H)},isExpanded:function(o){if(!o)return!0;var n=this._26o[o];return n?n.isExpanded:!(this._26Q[o]===!1)},toggle:function(y){var w=this;w.isExpanded(y)?w.collapse(y):w.expand(y)},expandAll:function(){this.validate();for(var Y in this._26o)this.expand(Y)},expand:function(K){if(K&&K!==to){var w=this,t=w._26o[K];t&&!t.isExpanded&&(t.isExpanded=!0,w.onExpanded(K),w.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var N in this._26o)this.collapse(N)},collapse:function(K){if(K&&K!==to){var q=this,h=q._26o[K];h&&h.isExpanded&&(h.isExpanded=!1,q.onCollapsed(K),q.ivm())}},onCollapsed:function(){},getCategoryName:function(x){if(!this.isCategorizable())return to;var K=x.getCategoryName();return K?K:to},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(y){var u=this,h=u._dataModel;h!==y&&(h&&(h.umd(u.handlePropertyChange,u),u._selectionModel||h.sm().ums(u.handleSelectionChange,u)),u._dataModel=y,y.md(u.handlePropertyChange,u),u._selectionModel?u._selectionModel._21I(y):y.sm().ms(u.handleSelectionChange,u),u.fp(Ck,h,y))},isVisible:function(o){return this._visibleFunc?this._visibleFunc(o):!0},onPropertyChanged:function(j){var t=this,D=j.property;Rs[D]?t.ivm():t.iv(),D===Ze&&t._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Kn},handlePropertyChange:function(u){this._27o===u.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var Z=this;Z._96I||(Z.setSelectRowIndex(-1),Z._96I=1,Z.iv())},redraw:function(){this.iv()},validateModel:function(){var w=this,I=w._rows,f=w._28o,l={},d=new Pk,M=w._27o;w.updateCurrentData(),M!==w._27o&&w.endEditing(),I.clear(),f.clear(),w.getRawProperties().each(function(N){if(w.isVisible(N)){d.add(N);var i=w.getCategoryName(N);l[i]||(f.add(i,i===to?0:r),l[i]={isExpanded:w.isExpanded(i),properties:new Pk})}}),w._sortFunc&&d.sort(w._sortFunc);for(var F in w._26o)w._26Q[F]=w.isExpanded(F);w._26o=l,f.each(function(y){y!==to&&I.add(y);var U=l[y];U.isExpanded&&d.each(function(F){w.getCategoryName(F)===y&&(U.properties.add(F),I.add({property:F,data:w._27o}))},w)})},validateImpl:function(){var L=this;L._76o(),L._96I&&(L.validateModel(),delete L._96I);var $=L._canvas,X=L.getWidth(),_=L.getHeight(),G=-L.ty(),g=L._rowHeight,K=L._indent,x=X-K,T=L._rows,n=T.size(),P=L._9I=K+x*L._10I,B=L._59I=n*g;Vp($,X,_),L._29I={x:0,y:G,width:X,height:_},L._31I=C(G/g),L._14I=v((G+_)/g),L._31I<0&&(L._31I=0),L._14I>n&&(L._14I=n);var E,q=_d($),Y=L._background;Kh(q,0,-G,1),q.beginPath(),q.rect(0,G,X,_),q.clip(),q.clearRect(0,G,X,_),L._93db(q),Y&&pb(q,0,0,K,B,Y);for(var o=L._31I;o<L._14I;o++){var H=T.get(o),G=g*o;if(ap(H))Y&&pb(q,K,G,x,g,Y),E=Ub(L.isExpanded(H)?L._expandIcon:L._collapseIcon),E&&Pr(q,E,ef,0,G,K,g),q.save(),q.beginPath(),q.rect(K,G,x,g),q.clip(),L.drawCategoryName(q,H,o,K,G,x,g),q.restore();else{var t=H.property,f=H.data,E=Ub(t.getIcon()),d=L._selectRowIndex===o?L.getSelectBackground():w;if(E&&Pr(q,E,ef,0,G,K,g),d&&pb(q,K,G,x,g,d),q.save(),q.beginPath(),q.rect(K,G,P-K,g),q.clip(),L.drawPropertyName(q,t,o,K,G,P-K,g),q.restore(),!L.isEditing(f,t)){var O=P+1,k=X-P-1;q.save(),q.beginPath(),q.rect(O,G,k,g),q.clip(),L._87o(L.drawPropertyValue(q,t,L.getValue(f,t),o,O,G,k,g,f),o,O,G,k,g),q.restore()}}L._rowLineVisible&&pb(q,K,G+g-1,x,1,L._rowLineColor)}L._columnLineVisible&&(pb(q,P,0,1,B,L._columnLineColor),pb(q,X-1,0,1,B)),L._92db(q),L._93I(),q.restore(),L.ty(L.ty())},drawCategoryName:function(P,a,C,X,s,M,v){Uq(P,a,this.getCategoryFont(a),this.getCategoryColor(a),X,s,M,v)},drawPropertyName:function(L,P,$,q,p,U,d){return P.drawPropertyName?(P.drawPropertyName(L,P,$,q,p,U,d,this),void 0):(Uq(L,this.getPropertyName(P),this.getPropertyFont(P,$),this.getPropertyColor(P,$),q,p,U,d),void 0)},drawPropertyValue:function(t,O,N,o,Q,s,a,U,d){return O.drawPropertyValue?O.drawPropertyValue(t,O,N,o,Q,s,a,U,d,this):(Ts(t,N,O,this.getLabelFont(O,N,o),this.getLabelColor(O,N,o),Q,s,a,U,d,this),void 0)},isPropertyEditable:function(u){return u.isEditable()&&this.isEditable()},setProperties:function(m){this._propertyModel.clear(),this.addProperties(m)},addProperties:function(f){if(f){var r=this._propertyModel;f.forEach(function(p){if(!(p instanceof $s)){var n=Fr(p.className);p=Hb(n?n:$s,p)}r.add(p)})}},getRowIndexAt:function(n){var Z=this,l=C(Z.lp(n).y/Z._rowHeight);return l>=0&&l<Z._rows.size()?l:-1},getPropertyAt:function(V){var $=this,l=$.getRowIndexAt(V);return l>=0?$._rows.get(l).property:w},getToolTip:function(Y){var A=this,U=A.getPropertyAt(Y),k=A._27o;return U&&k?U.getToolTip(k,A._9I<A.lp(Y).x,A):w}});var bt=function(q){this.pv=q,this.addListeners()};Ap(bt,R,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function($){this.getView().style.cursor=$},clear:function(){var C=this;C._62O=C.cp=C.ty=C.p=w,C.setCursor(Bi)},handle_mousedown:function(D){this.handle_touchstart(D)},handle_touchstart:function(j){var l=this,U=l.pv;mc(j),U.setFocus(j)&&(yf(j)?(l.cp=$c(j),l.ty=U.ty(),l.p=U.getColumnPosition(),l.handle_touchmove(j)):U.setSelectRowIndex(U.getRowIndexAt(j)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(B){this.handle_touchend(B)},handle_touchend:function(b){var Q=this;if(Q.cp&&!Q._62O){var B=Q.pv,C=B.lp(b),z=C.x,p=C.y,O=B._indent,v=B.getRowIndexAt(b),r=B._9I;if(v>=0){var F=B._rowHeight,D=F*v,K=B._rows.get(v),V=K.property;if(ap(K))Ub(B.isExpanded(K)?B._expandIcon:B._collapseIcon)&&z>=0&&O>=z&&p>=D&&D+F>=p?B.toggle(K):Ir(b)&&B.toggle(K);else if(z>r&&B.isPropertyEditable(V,b)){var k={x:r+1,y:D,width:B.getWidth()-r-1,height:F},y={x:k.x+B.tx(),y:k.y+B.ty(),width:k.width,height:k.height},w=0,_=B._29I;k.y<_.y?w=k.y-_.y:k.y+F>_.y+_.height&&(w=k.y+F-_.y-_.height),w&&(B.ty(B.ty()-w),y.y-=w),B.beginEditing({data:K.data,property:V,value:B.getValue(K.data,V),event:b,rect:k,editorRect:y,view:B})}}B.setSelectRowIndex(v)}Q.clear()},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(A){var u=this,T=u.pv,I=u.ty,f=u.cp,b=$c(A),S=u._62O;if("p"===S)T.setTranslateY(I+b.y-f.y);else if("c"===S){var F=T.getWidth()-T._indent;if(F>16){var W=u.p-(f.x-b.x)/F,V=16/F;V>W&&(W=V),W>1-V&&(W=1-V),T.setColumnPosition(W)}}else"s"===S&&T.setTranslateY(I+(f.y-b.y)*T._59I/T._29I.height)},handle_mousemove:function(D){this.handle_touchmove(D)},handle_touchmove:function(W){if(!Nr&&yf(W)){var Q=this,Z=Q.pv,M=J(Z.lp(W).x-Z._9I)<=(re?8:3);Q.cp?Q._62O||(M?(Q._62O="c",Ah(Q,W)):J($c(W).y-Q.cp.y)>=2&&(Q._62O=Q.isV(W)?"s":"p",Ah(Q,W))):(M?Q.setCursor(mm):Q.setCursor(Bi),Q.isV(W)&&Z._43o())}},isV:function(C){var e=this.pv,s=e._29I;return e._41o()&&s.x+s.width-e.lp(C).x<fl},handle_mousewheel:function(n){this.handleScroll(n,n.wheelDelta/40)},handle_DOMMouseScroll:function(M){2===M.axis&&this.handleScroll(M,-M.detail)},handleScroll:function(C,d){var B=this.pv;mc(C),B.endEditing(),B.translate(0,d*B.getRowHeight())},handle_keydown:function(H){var m=this.pv,P=m._rows.size(),j=m._selectRowIndex+(Cc(H)?-1:1);(Cc(H)||hs(H))&&(0>j&&(j=0),j>=P&&(j=P-1),m.setSelectRowIndex(j))}}),Ws.ListView=function(K){this._5o(K),new ct(this)},Xs("ListView",R,{ms_ac:[Nj,vb,Hi,Kp,vn,em,Qg,Kk,Zg,rf,sd,ri,wq,Iq],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:fh,_rowHeight:nm,_rowLineVisible:Y.listViewRowLineVisible,_rowLineColor:Y.listViewRowLineColor,_scrollBarColor:Lc,_scrollBarSize:qn,_autoMakeVisible:im,_autoHideScrollBar:ck,_selectBackground:Y.listViewSelectBackground,_labelColor:Y.listViewLabelColor,_labelSelectColor:Y.listViewLabelSelectColor,_labelFont:Y.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(s){var r=this,j=r._checkMode;r._checkMode=s,r.fp(Cd,j,s)},drawRow:function(l,M,z,G,d,X,x){var T=this,Y=0,o=T._indent,f=T.getIconWidth(M);T.drawRowBackground(l,M,z,G,d,X,x),T._checkMode&&(Pn(l,Ub(T.getCheckIcon(M)),Y+o/2,d+x/2,M,T),Y+=o),T.drawIcon(l,M,Y,d,f,x),T.drawLabel(l,M,Y+f,d,x)}});var ct=function(m){this.list=m,this.addListeners()};Ap(ct,R,{ms_listener:1,getView:function(){return this.list._view},clear:function(W){var q=this,X=q.list;W&&"d"===q._62O&&!q.dragCancel&&X.handleDragAndDrop(W,"end"),X.draggingData&&(X.draggingData=null,X.redraw()),q.dragCancel=q._62O=q._isV=q._isH=q.cp=q.tx=q.ty=w},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(P){var S=this,$=S.list;if(mc(P),$.setFocus(P)){var I=$.getDataAt(P);S.cp=$c(P),S.tx=$.tx(),S.ty=$.ty(),yf(P)?I&&$.handleDragAndDrop&&!S.isV(P)&&!S.isH(P)&&($.draggingData=I,$.redraw(),$.handleDragAndDrop(P,"prepare")):(I?S._33o(P,I):this._cancelDataDoubleSelect(),S.clear(P))}},handleWindowMouseUp:function(K){this.clear(K)},handleWindowTouchEnd:function(Q){this.clear(Q)},handle_mouseup:function(q){this.handle_touchend(q)},handle_touchend:function(F){var e=this,d=e.list;if(!e._isV&&!e._isH&&e.cp&&!e._62O){var u=d.getDataAt(F);u?(d.isCheckMode()?e._34o(F,u):e._33o(F,u),Ir(F)?d.onDataDoubleClicked(u,F):d.onDataClicked(u,F)):(e._cancelDataDoubleSelect(),d.handleBackgroundClick(F))}e.clear(F)},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(v){var t=this,m=t.list,B=t._62O,C=t.tx,G=t.ty,o=t.cp,Z=$c(v),P=m._29I;"p"===B?m.setTranslate(C+Z.x-o.x,G+Z.y-o.y):"v"===B?m.ty(G+(o.y-Z.y)*m._59I/P.height):"h"===B?m.tx(C+(o.x-Z.x)*m._91I/P.width):"d"===B&&(t.dragCancel||m.handleDragAndDrop(v,"between"))},handle_mousemove:function(E){this.handle_touchmove(E)},handle_touchmove:function(E){if(!Nr&&yf(E)){var l=this,K=l.list;if(l._isV=l.isV(E),l._isH=l.isH(E),l.cp){if(!l._62O){if(qd($c(E),l.cp)<2)return;l._isV?l._62O="v":l._isH?l._62O="h":K.draggingData&&!this.dragCancel?(l._62O="d",K.handleDragAndDrop(E,"begin")):l._62O="p",l._62O&&"d"!==l._62O&&K.draggingData&&(K.draggingData=null,K.redraw()),Ah(l,E)}}else l._isV&&K._43o(),l._isH&&K._42o()}},isV:function(f){var j=this.list,T=j._29I;return j._41o()&&T.x+T.width-j.lp(f).x<fl},isH:function(Y){var Q=this.list,x=Q._29I;return Q._40o()&&x.y+x.height-Q.lp(Y).y<fl},handle_mousewheel:function(U){this.handleScroll(U,U.wheelDelta/40,U.wheelDelta!==U.wheelDeltaX)},handle_DOMMouseScroll:function(_){this.handleScroll(_,-_.detail,1)},handleScroll:function(O,x,g){var p=this.list;mc(O),p.endEditing&&p.endEditing(),g&&p._41o()?p.translate(0,x*p.getRowHeight()):p._40o()&&p.translate(10*x,0)},handle_keydown:function(O){if(!Y.isInput(O.target)){var g,p=this.list,l=p.sm(),y=p._rows,U=y.size();if(Ak(O))p.selectAll();else if(Zd(O))p.handleDelete&&p.handleDelete(O);else if(bo(O))"d"!==this._62O||this.dragCancel||(p.handleDragAndDrop(O,"cancel"),this.dragCancel=!0);else if(Fg(O))p.isCheckMode()&&(g=p.getFocusData(),g&&p.checkData(g));else if(Cc(O)||hs(O)){var w=p.isCheckMode();if(g=w?p.getFocusData():l.ld()){var b=p.getRowIndex(g);b>=0&&(Cc(O)?0!==b&&(g=y.get(b-1),w?p.setFocusData(g):l.ss(g)):b!==U-1&&(g=y.get(b+1),w?p.setFocusData(g):l.ss(g)))}else U>0&&(g=y.get(0),w?p.setFocusData(g):l.ss(g))}}},_34o:function(W,b){var z=this.list,l=z.lp(W).x;return l>=0&&l<=z._indent?(z.checkData(b),void 0):(z.setFocusData(b),void 0)},_33o:function(H,D){var I=this.list,v=I.sm(),f=v.ld();if(!I.canHandleSelectMode(H,D))return this._cancelDataDoubleSelect(),void 0;if(Xm(H))I.isSelected(D)?v.rs(D):v.as(D);else if(bg(H))if(f)for(var S=I.getRowIndex(f),O=I.getRowIndex(D);S!==O;)S+=O>S?1:-1,v.as(I._rows.get(S));else v.ss(D);else yf(H)?(v.contains(D)?I.handleDataDoubleSelect&&(this._handleDataDoubleSelect(H,D),Ir(H)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),v.ss(D)):v.contains(D)||v.ss(D)},_handleDataDoubleSelect:function(z,S){this._cancelDataDoubleSelect(),this._doubleSelectTimer=fr(function(){this.list.handleDataDoubleSelect(z,S),this._doubleSelectTimer=r}.bind(this),Y.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(hd(this._doubleSelectTimer),this._doubleSelectTimer=r)}}),Ws.TreeView=function(n){var L=this;L._35o(),L._5o(n),new dt(L)},Xs("TreeView",R,{ms_ac:[Nj,vb,Hi,"rootVisible",Cd,"rootData",Kk,Zg,rf,sd,ri,vn,Kp,em,Qg,gi,pi,wq,Iq,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:w,_indent:fh,_rowHeight:nm,_rowLineVisible:Y.treeViewRowLineVisible,_rowLineColor:Y.treeViewRowLineColor,_scrollBarColor:Lc,_scrollBarSize:qn,_autoHideScrollBar:ck,_expandIcon:Y.treeViewExpandIcon,_collapseIcon:Y.treeViewCollapseIcon,_autoMakeVisible:im,_selectBackground:Y.treeViewSelectBackground,_labelColor:Y.treeViewLabelColor,_labelSelectColor:Y.treeViewLabelSelectColor,_labelFont:Y.treeViewLabelFont,_doubleClickToToggle:Y.treeViewDoubleClickToToggle,drawRow:function(T,f,z,D,n,Y,w){var B=this;B.drawRowBackground(T,f,z,D,n,Y,w),B.drawTree(T,f,z,0,n,Y,w)},isOnToggleIcon:function(q){var I=this.getDataAt(q);if(I){var p=this.getIndent(),d=this.lp(q).x;if(Ub(this.getToggleIcon(I))){var l=p*this.getLevel(I);if(d>=l&&l+p>=d)return!0}}return!1}});var dt=function(P){Lh(dt,this,[P])};Ap(dt,ct,{toggle:function(X,v,B,N){var b=this.list,K=b.lp(X).x;if(Ub(b.getToggleIcon(v))){var V=B*N;if(K>=V&&V+B>=K)return b.toggle(v),!0}return b.isDoubleClickToToggle()&&Ir(X)?(b.toggle(v),!0):!1},_34o:function(N,J){var p=this.list,b=p.lp(N).x,n=p._levelMap[J._id],T=p._indent,E=T*(n+1);return b>=E&&E+T>=b?(p.checkData(J),void 0):(this.toggle(N,J,T,n)||p.setFocusData(J),void 0)},_33o:function(V,L){var h=this,t=h.list;if(!h.toggle(V,L,t._indent,t.getLevel(L)))if(bg(V)){var H=t.sm();if(H.size()>0){for(var m=t._rows,K=null,q=0,g=m.size();g>q;q++)if(t.isSelected(m.get(q))){K=q;break}for(var e=null,q=m.size()-1;q>=0;q--)if(t.isSelected(m.get(q))){e=q;break}var _,E,O=t.getRowIndex(L);for(K>O?(_=O-1,E=K):O>e?(_=e,E=O):(_=K,E=e);_!==E;)_++,H.as(t._rows.get(_))}else H.ss(L)}else dt.superClass._33o.call(h,V,L)},handle_keydown:function(D){if(Yf(D)||Ve(D)){var p=this.list,R=p._rows,w=p.isCheckMode(),P=p.sm(),r=w?p.getFocusData():P.ld();r?r.hasChildren()&&(Yf(D)?p.collapse(r):p.expand(r)):R.size()>0&&(r=R.get(0),w?p.setFocusData(r):P.ss(r))}else dt.superClass.handle_keydown.call(this,D)}});var et=Ws.TableView=function(W){this._98I(),this._5o(W),new ft(this)};Xs("TableView",R,{ms_ac:[Nj,vb,Hi,"sortMode",ag,os,Kp,em,Qg,pk,te,"sortColumn",Kk,Zg,rf,sd,ri,wq,Iq],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Mk,_editable:!0,_batchEditable:!1,_rowHeight:nm,_rowLineVisible:Y.tableViewRowLineVisible,_rowLineColor:Y.tableViewRowLineColor,_columnLineVisible:Y.tableViewColumnLineVisible,_columnLineColor:Y.tableViewColumnLineColor,_scrollBarColor:Lc,_scrollBarSize:qn,_autoHideScrollBar:ck,_autoMakeVisible:im,_selectBackground:Y.tableViewSelectBackground,_labelColor:Y.tableViewLabelColor,_labelSelectColor:Y.tableViewLabelSelectColor,_labelFont:Y.tableViewLabelFont,getCheckColumn:function(){var q=this;if(!q._31o){var I=q._31o=new Zs;I.setEditable(!0),I.setWidth(40),I.getValue=q.getCheckColumValue,I.drawCell=q.drawCheckColumnCell}return q._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(L){var G=this,B=G._39o,m=G.getCheckColumn();L!==G.isCheckMode()&&(L?B.add(m,0):B.remove(m),G.fp(Cd,!L,L))},getCheckColumValue:function(o,O,n){return n.isSelected(o)},drawCheckColumnCell:function(e,Z,O,F,E,o,v,h,R){Pn(e,R.getCheckIcon(Z),E+v/2,o+h/2,Z,R)}});var ft=function(k){Lh(ft,this,[k])};Ap(ft,ct,{_34o:function(a,Y){var F=this.list,s=F._31o;if(F.isCellEditable(Y,s,a)){var Z=F._3Q(s),$=F.lp(a).x;if(Z&&$>=Z.startX&&$<Z.startX+s.getWidth())return F.checkData(Y),void 0}F._37O(Y,a),F.setFocusData(Y)},_33o:function(H,o){this.list._37O(o,H),ft.superClass._33o.apply(this,arguments)}});var gt=Ws.TreeTableView=function(r){var V=this,M=V._4o=new Zs;V._35o(),V._98I(),V._5o(r),M.setDisplayName("Name"),M.setEditable(!0),M.setWidth(180),M.drawCell=ht,M.getValue=it,V._39o.add(M),new jt(V)},ht=function(h,Q,H,t,m,X,J,M,N){N.drawTree(h,Q,H,m,X,J,M)},it=function(o,m,W){return W.getLabel(o)};Xs("TreeTableView",R,{ms_ac:[Nj,vb,Hi,"sortMode",ag,os,vn,Cd,"rootData","rootVisible",Kk,Zg,"sortColumn",gi,pi,rf,sd,ri,wq,Qg,Kp,em,pk,te,Iq,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Mk,_checkMode:w,_editable:!0,_batchEditable:!1,_indent:fh,_rowHeight:nm,_rowLineVisible:Y.treeTableViewRowLineVisible,_rowLineColor:Y.treeTableViewRowLineColor,_columnLineVisible:Y.treeTableViewColumnLineVisible,_columnLineColor:Y.treeTableViewColumnLineColor,_expandIcon:Y.treeTableViewExpandIcon,_collapseIcon:Y.treeTableViewCollapseIcon,_scrollBarColor:Lc,_scrollBarSize:qn,_autoHideScrollBar:ck,_autoMakeVisible:im,_selectBackground:Y.treeTableViewSelectBackground,_labelColor:Y.treeTableViewLabelColor,_labelSelectColor:Y.treeTableViewLabelSelectColor,_labelFont:Y.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var jt=function(J){Lh(jt,this,[J])};Ap(jt,ct,{_34o:function(c,R){var u=this.list,r=u._4o,j=u._3Q(r),k=u.lp(c).x;if(j){var N=u._indent,X=j.startX+N*u.getLevel(R);if(Ub(u.getToggleIcon(R))&&k>=X&&X+N>=k)return u.toggle(R),void 0;if(u.isCellEditable(R,r)&&(X+=N,k>=X&&X+N>=k))return u.checkData(R),void 0}u._37O(R,c),u.setFocusData(R)},_33o:function(Y,l){var S=this.list,M=S.lp(Y).x;if(Ub(S.getToggleIcon(l))){var Q=S._3Q(S._4o);if(Q){var x=S._indent,k=Q.startX+x*S.getLevel(l);if(M>=k&&k+x>=M)return S.toggle(l),void 0}}S._37O(l,Y),jt.superClass._33o.apply(this,arguments)}});var kt=Ws.TableHeader=function(U){var g=this,A=g._view=xf(1,g),f=g._39o=U.getColumnModel(),s=g.iv;g.tv=g._tableView=U,g._60I=new Pk,g._canvas=de(A),A.style.background=Y.tableHeaderBackground||"",A.style.height=fk+qf,f.mm(s,g),f.md(s,g),f.mh(s,g),U.mp(function(o){Ns[o.property]&&g.iv()},g),new lt(g),g.iv()};Xs("TableHeader",R,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Nj,Hi,vn,"moveBackground","insertColor",pk,te,"resizable","movable"],_checkIcon:Qb,_movable:!0,_resizable:!0,_labelColor:Y.tableHeaderLabelColor,_labelFont:Y.tableHeaderLabelFont,_columnLineColor:Y.tableHeaderColumnLineColor,_columnLineVisible:Y.tableHeaderColumnLineVisible,_sortDescIcon:Y.tableHeaderSortDescIcon,_sortAscIcon:Y.tableHeaderSortAscIcon,_moveBackground:Y.tableHeaderMoveBackground,_insertColor:Y.tableHeaderInsertColor,_indent:fh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(D){return D.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(v){return v.getColor()||this._labelColor},getLabelAlign:function(f){return f._align},onPropertyChanged:function(){this.iv()},_5Q:function(E){this._61I=E,this.iv()},getLogicalPoint:function(b){return bc(b,this._canvas,this.tv.tx())},validateImpl:function(){var T=this,i=T._canvas,Y=T.getWidth(),b=T.getHeight(),y=T.tv,o=T._60I,V=T._61I,d=-y.tx(),h=0;(Y!==i.clientWidth||b!==i.clientHeight)&&Vp(i,Y,b),o.clear(),T._39o._roots.each(function(n){if(n.isVisible()){var c=h+n.getWidth();d+Y>=h&&c>=d&&o.add({column:n,startX:h}),h=c}});var z=_d(i);if(Kh(z,-d,0,1),z.beginPath(),z.rect(d,0,Y,b),z.clip(),z.clearRect(d,0,Y,b),o.each(function(D){var f=D.column,w=D.startX,r=f.getWidth();r>0&&(z.save(),z.beginPath(),z.rect(w,0,r,b),z.clip(),V&&V.column===f||T.drawColumn(z,f,w,0,r,b),T._columnLineVisible&&pb(z,w+r-1,0,1,b,T._columnLineColor),z.restore())}),V){var Z=V.column,h=V.startX,c=V.position,F=Z.getWidth();z.save(),z.beginPath(),z.rect(h,0,F,b),z.clip(),z.fillStyle=T._moveBackground,z.fill(),T.drawColumn(z,Z,h,0,F,b),z.restore(),rc(z,T._insertColor,c,0,b)}z.restore()},_6Q:function(R){var J=this.tv;return J._31o===R&&J.sm().getSelectionMode()===ao},drawColumn:function(E,b,f,C,P,g){var Y=this,D=Y.tv,M=Ub(b.getIcon()),G=Y.getLabelAlign(b);if(Y._6Q(b)){var c=Ub(Y._checkIcon);Pn(E,c,f+P/2,C+g/2,b,Y)}else{var _=Y.getLabel(b),O=Y.getLabelFont(b),A=Y.getLabelColor(b),L=Oq(O,_).width,x=M?Y._indent:0;G===vq?(M&&Pr(E,M,ef,f,C,x,g),Uq(E,_,O,A,f+x,C,P,g,vq)):G===hn?(M&&Pr(E,M,ef,f+P-L-x,C,x,g),Uq(E,_,O,A,f,C,P,g,hn)):(M&&Pr(E,M,ef,f+(P-L-x)/2,C,x,g),Uq(E,_,O,A,f+(P-L+x)/2,C,0,g,vq))}if(b.isSortable()&&D.getSortColumn()===b&&(M=Ub(b.getSortOrder()===wj?Y._sortAscIcon:Y._sortDescIcon))){var N=To(M,b)/2+2;Pn(E,M,G===hn?f+N:f+P-N,C+g/2,b,D)}}});var lt=function(L){var o=this;o.th=L,o.tv=L._tableView,o.addListeners()};Ap(lt,R,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(l){this.getView().style.cursor=l},handle_mousemove:function(q){if(!Nr){var d=this;delete d._29o,d.setCursor(Bi);for(var X=d.th,O=X._60I,Q=X.lp(q).x,S=O.size()-1;S>=0;S--){var e=O.get(S),F=e.column,l=e.startX+F.getWidth();if(X.isResizable()&&J(l-Q)<=(re?10:3))return d._29o=e,d.setCursor(mm),void 0;Q>e.startX&&l>Q&&(d._29o=e),(F.isClickable()||F.isSortable()||X.isMovable()||d.tv.getCheckColumn&&F===d.tv.getCheckColumn())&&Q>e.startX&&l>Q&&d.setCursor(kq)}}},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(W){var q=this;mc(W),q.tv.endEditing(),q.handle_mousemove(W),q._29o&&(q.x=$c(W).x,q.lx=q.th.lp(W).x,q.w=q._29o.column.getWidth(),Ah(q,W))},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(F){var M=this,Y=M.th,L=M.getView().style.cursor,f=M._29o,e=$c(F).x-M.x;if(M.resizing||M.moving||(L===mm?M.resizing=1:Y.isMovable()&&L===kq&&J(e)>2&&(M.moving=1)),M.resizing)f.column.setWidth(M.w+e);else if(M.moving){var I=M.lx+e;Y._60I.each(function(X){var m=X.startX,w=m+X.column.getWidth();if(I>=m&&w>=I){var $={column:f.column,startX:f.startX+e,front:w-I>I-m,insertColumn:X.column};$.position=$.front?m:w,Y._5Q($)}})}},_16Q:function(K,D){var a=this,h=a.tv,H=a.th,W=H._checkIcon;if(H._6Q(K)){var v=Ub(W),s=a.lx,Z=K.getWidth(),w=To(v,K);if(s>=D+Z/2-w&&D+Z/2+w>=s){H.setCheckIcon(W===af?Qb:af);var L=h.sm(),y=h._rows;return W===af?L.rs(y):L.ss(y),h.onCheckColumnClicked(K),!0}}return!1},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(c){var A=this,i=A.tv,x=A.th,o=A._29o;if(A.moving){var B=x._61I;if(B&&B.insertColumn!==B.column){var T=B.column,n=i.getColumnModel()._roots,P=n.remove(T),j=n.indexOf(B.insertColumn);
j>=0&&(B.front||j++,j<=n.size()&&(n.add(T,j),i.getColumnModel()._38I(T,P,j)))}x._5Q(w),delete A.moving}else if(!A.resizing&&o){T=o.column;var U=x.lp(c).x,C=o.startX,s=!0;if(x.onColumnClicked){var $=x.onColumnClicked(T,c,C);$===!1&&(s=!1)}if(s&&U>=C&&U<=C+T.getWidth()&&!A._16Q(T,C)){if(T.isSortable()){var b=i.getSortMode(),S=T.getSortOrder();b===Mk?i.getSortColumn()===T?(S===ls&&i.setSortColumn(w),T.setSortOrder(S===wj?ls:wj)):i.setSortColumn(T):"bistate"===b&&(i.getSortColumn()===T?T.setSortOrder(S===wj?ls:wj):i.setSortColumn(T))}i.onColumnClicked(T,c,C)}}A._29o=A.resizing=A.x=A.lx=A.w=w}}),Ws.TablePane=function(S){this.init(new et(S))},Xs("TablePane",R,{ms_v:1,_44o:1}),Ws.TreeTablePane=function(o){this.init(new gt(o))},Xs("TreeTablePane",R,{ms_v:1,_44o:1}),Ws.Toolbar=function(o){var r=this,O=r._view=xf(1,r),P=O.style;P.background=Y.toolbarBackground||"",P.height=he+qf,r._canvas=de(O),r._30o=new Pk,r._90I=new Pk,r.setItems(o||[]),O.handleGroupSelectedChanged=function(d){if(d.isSelected()){var Z=d.getGroupId();null!=Z&&r._items.forEach(function(N){var c=N.element;c&&c!==d&&c.setSelected&&c.getGroupId&&c.getGroupId()===Z&&c.setSelected(!1)})}},new mt(r)},Xs("Toolbar",R,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[pe,Nj,Hi,vb,Iq,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:Y.toolbarLabelColor,_labelSelectColor:Y.toolbarLabelSelectColor,_labelFont:Y.toolbarLabelFont,_selectBackground:Y.toolbarSelectBackground,_itemGap:Y.toolbarItemGap,_separatorColor:Y.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(c){var q=this.getItemInfoAt(c);return q?q.item.toolTip:w},getLabelColor:function(J){return J&&J.selected&&J.type!==af&&J.type!==yc?this._labelSelectColor:this._labelColor},onPropertyChanged:function(r){this.iv(),r.property===pe&&this._items.forEach(function(h){Jl(h)})},redraw:function(){this.iv()},addItem:function(o,G){var i=this._items;G==w?i.push(o):i.splice(G,0,o),this.fp(pe,w,i)},removeItem:function(t){if(t)for(var q=this._items,o=0;o<q.length;o++)t===q[o]&&(q.splice(o,1),this.fp(pe,w,q))},removeItemById:function(h){if(h!=w)for(var b=this._items,k=0;k<b.length;k++)if(h===b[k].id){var l=b.splice(k,1)[0];return this.fp(pe,w,b),l}},getItemById:function($){if($!=w)for(var Y=this._items,R=0;R<Y.length;R++){var E=Y[R];if($===E.id)return E}},setItemVisible:function(p,w){var R=this.getItemById(p);R&&(R.visible=w)},getItemInfos:function(){return this._30o},getItemInfoAt:function(t){var C=this,u=0,I=C._30o,q=C.lp(t),p=q.x,_=q.y;if(_>=0&&_<=C.getHeight())for(;u<I.size();u++){var M=I.get(u);if(M.startX<=p&&p<=M.endX)return M}return w},drawItem:function(_,k,P,p,i){if(k.visible===!1)return 0;if(Ln(k.visible)&&!k.visible())return 0;var z=this,X=k.disabled;X&&(_.globalAlpha=km);var f=z.drawItemImpl(_,k,P,p,i),q=z._itemGap;return X&&(_.globalAlpha=1),this._currentItem!==k||"separator"===k||k.separator===!0||k.unfocusable||$d(_,z._separatorColor,P-q/2,0,f+q,p),f},drawItemImpl:function(D,k,f,H,N){var A=this,p=A._view,j=A._itemGap,y=H/2,g=k.type,q=k.element,R=k.label;ap(q)&&(R=q,q=w);var U,W=A.getLabelFont(k),G=A.getLabelColor(k),L=k.selected,o=Ub(k.icon),s=To(o,k),Z=0,d=s+(R?Oq(W,R).width:0);if("separator"===k||k.separator===!0)return rc(D,A._separatorColor,f,H/4,y),1;if(q){o&&Pn(D,o,f+s/2,y,k,A),Uq(D,R,W,G,f+s,0,0,H);var b=Ie(q);N||A._90I.add(b),b.parentNode!==p&&Ld(p,b),q.iv&&q.iv(),q.validate&&q.validate();var m=b.getBoundingClientRect(),l=m.width,$=b.style;return es(b),$.left=A.tx()+f+d+qf,$.top=(H-m.height)/2+qf,d+l}return g===yc?U=Ub(L?Mn:Pq):g===af&&(U=Ub(L?af:Qb)),U?(Z=To(U,k),Pn(D,U,f+Z/2,y,k,A),f+=Z,d+=Z):L&&pb(D,f-j/2,0,d+j,H,A.getSelectBackground(k)),o&&Pn(D,o,f+s/2,y,k,A),Uq(D,R,W,G,f+s,0,0,H),d},validateImpl:function(){var O=this,I=O._canvas,K=O.getWidth(),a=O.getHeight(),z=O._30o,e=O._items;Vp(I,K,a);var R=_d(I),C=O._itemGap,J=C/2;Kh(R,O.tx(),0,1),R.clearRect(0,0,K,a);var g=O._90I;O._90I=new Pk,z.clear(),e.forEach(function(T){var I=O.drawItem(R,T,J,a);z.add({item:T,startX:J,endX:J+I,width:I}),I&&(J+=I+C)}),g.each(function(v){O._90I.contains(v)||zk(v)});var p=O._64I;O._64I=i(0,J),R.restore(),O._stickToRight?(O._65O=0,R=_d(I),J=K-O._64I+C,Kh(R,0,0,1),R.clearRect(0,0,K,a),z.clear(),e.forEach(function(N){var X=O.drawItem(R,N,J,a,!0);z.add({item:N,startX:J,endX:J+X,width:X}),X&&(J+=X+C)}),R.restore()):O.tx(O.tx()),p!==O._64I&&O.onSumWidthChanged(p,O._64I)},onSumWidthChanged:function(){},handleClick:function(L,c){var d=this,W=L.type,s=L.action,h=L.groupId,B=L.selected;L.disabled||(h!=w?B||(L.selected=!0,this._items.forEach(function(w){w.groupId===h&&L!==w&&(w.selected=!1)}),s&&L.action(L,d,c)):W===af||"toggle"===W?(L.selected=!B,s&&L.action(L,d,c)):s&&L.action(L,d,c)),Wc(),d.iv()}});var mt=function(z){this.tb=z,this.addListeners()};Ap(mt,R,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(j){this.handleScroll(j,10*(j.wheelDelta/40))},handle_DOMMouseScroll:function(s){this.handleScroll(s,10*-s.detail)},handleScroll:function(f,j){mc(f);var g=this.tb;g.isScrollable()&&!g._stickToRight&&(g.tx(g.tx()+j),Nk())},handle_mousemove:function(b){var T=this;Nr||T.setItem(b)},handle_mouseout:function(D){var j=this;D.target===j.getView()?j.tb.setCurrentItem(w):j.handle_mousemove(D)},handle_mousedown:function(l){this.handle_mousemove(l),this.handle_touchstart(l)},handle_touchstart:function(D){var e=this,Z=e.tb,r=D.target;yf(D)&&(r===e.getView()||r===Z._canvas)&&(mc(D),Z.setFocus(D)&&(this.setItem(D,!0),(Z.isScrollable()||e.info&&!e.info.item.disabled)&&(e.x=$c(D).x,e.tx=Z.tx(),Ah(e,D))))},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(r){var i=this,$=i.tb;if(!$._stickToRight){var c=$c(r).x-i.x;!i._25o&&J(c)>2&&$.isScrollable()&&(i._25o=1),i._25o&&$.tx(i.tx+c)}},handleWindowMouseUp:function(c){this.handleWindowTouchEnd(c)},handleWindowTouchEnd:function(O){var y=this,B=y.tb,f=y.info,n=y.tb.getItemInfoAt(O);if(!y._25o&&f){var S=f.item;n&&n.item===S&&B.handleClick(S,O)}y._25o=y.x=y.tx=w,y.setItem()},setItem:function(R,m){var P=this,I=P.tb,g=P.info=R?I.getItemInfoAt(R):w,l=g?g.item:w;I.setCurrentItem(l),m&&l&&Ln(l.onDown)&&l.onDown(R)}}),Ws.BorderPane=function(){this._view=xf(1,this),this.iv()},Xs("BorderPane",R,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(x,r){this._12o("leftView",x),r!=w&&this.setLeftWidth(r)},getRightView:function(){return this._rightView},setRightView:function(C,j){this._12o("rightView",C),j!=w&&this.setRightWidth(j)},getTopView:function(){return this._topView},setTopView:function(Q,k){this._12o("topView",Q),k!=w&&this.setTopHeight(k)},getBottomView:function(){return this._bottomView},setBottomView:function(B,N){this._12o("bottomView",B),N!=w&&this.setBottomHeight(N)},getCenterView:function(){return this._centerView},setCenterView:function(L){this._12o("centerView",L)},_12o:function(D,r){var W=this,k="_"+D,s=W._view,H=W[k];H!==r&&(H&&(H.getView?zk(H.getView()):zk(H)),W[k]=r,r&&(r.getView?Ld(s,r.getView(),1):Ld(s,r,1)),W.fp(D,H,r))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var N=this,k=N._topView,p=N._bottomView,v=N._leftView,I=N._rightView,g=N._centerView,F=N.getWidth(),H=N.getHeight(),h=0,x=0,d=F,a=H,u=0,R=0,l=0,s=0;k&&(u=N._topHeight==w?rg(k):N._topHeight,x=u),p&&(R=N._bottomHeight==w?rg(p):N._bottomHeight,a=H-R),v&&(l=N._leftWidth==w?Bg(v):N._leftWidth,h=l),I&&(s=N._rightWidth==w?Bg(I):N._rightWidth,d=F-s);var m=i(0,d-h),n=i(0,a-x);k&&Ni(k,0,0,F,u),p&&Ni(p,0,a,F,R),v&&Ni(v,0,x,l,n),I&&Ni(I,d,x,s,n),g&&Ni(g,h,x,m,n)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);