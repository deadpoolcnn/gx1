!function(_,N,e){"use strict";function Q(){this.el=[1,0,0,0,1,0,0,0,1]}function I(v){var H={};return{get:function(m){if(H[m]!==e)return H[m];var j;switch(m){case"WEBGL_depth_texture":j=v.getExtension("WEBGL_depth_texture")||v.getExtension("MOZ_WEBGL_depth_texture")||v.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":j=v.getExtension("EXT_texture_filter_anisotropic")||v.getExtension("MOZ_EXT_texture_filter_anisotropic")||v.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":j=v.getExtension("WEBGL_compressed_texture_s3tc")||v.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||v.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":j=v.getExtension("WEBGL_compressed_texture_pvrtc")||v.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":j=v.getExtension("WEBGL_compressed_texture_etc1");break;default:j=v.getExtension(m)}return H[m]=j,j}}}function l(U,A,l){function M(){if(Q!==e)return Q;var b=A.get("EXT_texture_filter_anisotropic");return Q=null!==b?U.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function w(L){if("highp"===L){if(U.getShaderPrecisionFormat(U.VERTEX_SHADER,U.HIGH_FLOAT).precision>0&&U.getShaderPrecisionFormat(U.FRAGMENT_SHADER,U.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return"mediump"===L&&U.getShaderPrecisionFormat(U.VERTEX_SHADER,U.MEDIUM_FLOAT).precision>0&&U.getShaderPrecisionFormat(U.FRAGMENT_SHADER,U.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var Q;l=l||{};var h="undefined"!=typeof WebGL2RenderingContext&&U instanceof WebGL2RenderingContext,f=l.precision!==e?l.precision:"highp",T=w(f);T!==f&&(console.warn("WebGL:",f,"not supported, using",T,"instead."),f=T);var C=l.logarithmicDepthBuffer===!0,s=U.getParameter(U.MAX_TEXTURE_IMAGE_UNITS),x=U.getParameter(U.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=U.getParameter(U.MAX_TEXTURE_SIZE),j=U.getParameter(U.MAX_CUBE_MAP_TEXTURE_SIZE),p=U.getParameter(U.MAX_VERTEX_ATTRIBS),g=U.getParameter(U.MAX_VERTEX_UNIFORM_VECTORS),k=U.getParameter(U.MAX_VARYING_VECTORS),o=U.getParameter(U.MAX_FRAGMENT_UNIFORM_VECTORS),b=x>0,K=h||!!A.get("OES_texture_float"),z=b&&K,W=h?U.getParameter(U.MAX_SAMPLES):0;return{getMaxAnisotropy:M,getMaxPrecision:w,precision:f,logarithmicDepthBuffer:C,maxTextures:s,maxVertexTextures:x,maxTextureSize:u,maxCubemapSize:j,maxAttributes:p,maxVertexUniforms:g,maxVaryings:k,maxFragmentUniforms:o,vertexTextures:b,floatFragmentTextures:K,floatVertexTextures:z,maxSamples:W}}var h="ht";if(!_[h]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),_.performance&&_.performance.now||function(){var M=Date.now();_.performance||(_.performance={}),_.performance.now=function(){return Date.now()-M}}();for(var y=Date.now(),t=16,K=["ms","moz","webkit","o"],$=0;$<K.length&&!_.requestAnimationFrame;++$)_.requestAnimationFrame=_[K[$]+"RequestAnimationFrame"],_.cancelAnimationFrame=_[K[$]+"CancelAnimationFrame"]||_[K[$]+"CancelRequestAnimationFrame"];_.requestAnimationFrame||(_.requestAnimationFrame=function(C){var b=Date.now(),j=t+y-b;return 0>j&&(j=0),y=b,_.setTimeout(function(){y=Date.now(),C(performance.now())},j)}),_.cancelAnimationFrame||(_.cancelAnimationFrame=function(K){return _.clearTimeout(K)}),N.assign===e&&(N.assign=function(G){if(G===e||null===G)throw new TypeError("Cannot convert undefined or null to object");for(var Q=N(G),T=1;T<arguments.length;T++){var p=arguments[T];if(p!==e&&null!==p)for(var U in p)N.prototype.hasOwnProperty.call(p,U)&&(Q[U]=p[U])}return Q})}();var x=_.document,A=null,P=_[h]={},R=_[h+"config"],b=P.Default=R&&R.Default||{},n=P.Style=R&&R.Style||{},u=P.Attr=R&&R.Attr||{},p=P.Color=R&&R.Color||{},q=P.IsGetter=R&&R.IsGetter||{};!function(){var i=!1;try{var X=N.defineProperty({},"passive",{get:function(){return i=!0,e}});_.addEventListener("test",X,X),_.removeEventListener("test",X,X)}catch(v){i=!1}b.passiveSupported=i}();var f,G,g,L,i=b.passiveSupported,J=b.eventListenerOptionsFalse=i?{passive:!1,capture:!1}:!1,t=b.eventListenerOptionsTrue=i?{passive:!1,capture:!0}:!0,d=function(n,w,M,a){n.addEventListener(w,M,a?t:J)},B=function(z,L,i,H){z.removeEventListener(L,i,H?t:J)},v=Math,W=v.round,z=v.floor,m=v.ceil,D=v.sqrt,a=v.max,C=v.min,T=v.abs,E=v.cos,M=v.acos,j=v.sin,F=v.pow,S=v.asin,Y=v.exp,O=v.PI,U=2*O,Z=O/2,r=v.tan,o=v.atan2,V=v.random,w=v.log,H=!1,s=!1,y=_.parseInt||global.parseInt,K="2021-3-15",c=_.navigator?_.navigator.platform.indexOf("Win")>-1:!1,k=function(C){return C*C},$=_.setTimeout,X=_.clearTimeout,Wk=_.location,nj=_.navigator?_.navigator.userAgent.toLowerCase():"",Ml=function(V){return V.test(nj)},mg=Ml(/msie/),Yi=Ml(/msie/)||Ml(/trident/),Uf=Ml(/msie 10/),Tm=Ml(/edge/),os=Ml(/firefox/),qd=Ml(/mac/),tc=b.isTouchable===e?c?!1:x?"ontouchend"in x:!1:b.isTouchable,Qi="default",Oq="single",Vc="multiple",Kg="front",gl="back",Rc="left",Pc="right",Oe="top",fl="bottom",Le="center",Fe="eye",sg="middle",xe="east",pj="west",Ab="north",ei="none",bl="px",be="absolute",cd="border",jl="triangle",Dl="rect",Kf="circle",gp="cylinder",Mh="shape",Jl="items",Jn="normal",kc="remove",Bj="clear",Cq="width",ll="height",Do="ingroup",Qb="check",ao="uncheck",Vj="radio",gi="radioOn",uf="radioOff",od="points",Oj="values",Ad="series",_o="body",ls="label",kd="label2",Up="note",Ql="note2",jr="icons",Dr="labelFont",df="labelColor",Dp="labelSelectColor",dp="note.expanded",Fh="note2.expanded",Pi="edge.expanded",Ai="edge.points",km="edge.type",oq="rotation",am="hidden",ap="visible",ok="tuv",Yo="no",Tb="draw",tm="select",Dj="currentSubGraph",Rn="selectBackground",Xp="autoMakeVisible",ph="autoHideScrollBar",Lj="scrollBarColor",ho="scrollBarSize",Fj="indent",Zo="rowHeight",xo="columnLineColor",es="rowLineColor",Db="columnLineVisible",fn="rowLineVisible",qp="visibleFunc",Ib="expandIcon",wh="collapseIcon",Rq="checkMode",tj="sortFunc",tr="editable",pg="batchEditable",qe="tristate",Wr="asc",zq="desc",yk="position",er="elevation",Sm="children",mn="translateX",Kr="translateY",Dg="dataModel",Gg="maxSize",pm="state",lc="shape3d",pd="shape3d.resolution",zc="shape3d.visible",Em="shape3d.from.visible",Vb="shape3d.to.visible",Yl="shape3d.top.visible",En="shape3d.bottom.visible",hq="repeat.uv.length",ce="serializeValue",vi="deserializeValue",lm="centerUniform",Ze="uniform",Ph="rgba(255,255,255,0)",Al="style",rs="attr",Wn="field",Cf="string",rc="boolean",jq="color",zb="int",sc="number",bm="ew-resize",rk="ns-resize",ug="pointer",qq="auto",bo="mousedown",xq="mousemove",Sq="mouseup",ln="mouseout",Cb="touchstart",vh="touchmove",is="touchend",cr="keydown",Jc="keyup",Cl=["DOMMouseScroll","mousewheel"],Jm=os?Cl[0]:Cl[1],hc=[Cb,vh,is],ef=[bo,xq,Sq,ln,Jm,"wheel","mouseenter","mouseleave","mouseover"],cp=[cr,Jc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Mq=tc?hc.concat(cp):ef.concat(cp),wk=A,Qk=A,Fg=A,Gh=Sq.length,lp=function(){Fg&&(X(Fg.timeout),Fg=A)},Aj=function(){Fg&&gh(Fg.e,Fg.info)};_.addEventListener&&(tc||(d(_,ln,function(){lp()}),d(_,Jm,function(){lr()})),d(_,Jc,function(H){91===H.keyCode?de={}:delete de[H.keyCode]},!0),d(_,cr,function(f){de[f.keyCode]=!0},!0),d(_,"blur",function(){de={}}));var yg,dc,zl,fq=0,Un=A,lh=function(p,I){var J=$(function(){delete Un[J],Ah(Un)&&(Un=A),p()},I);return J},zn=A,zg=A,Gn={},fg={},fs={},Id={},gq={},de={},Eq={},Xk={},Xc={},kq={},Po=/.json$/,Tf=/^data:image\/svg\+xml/,nd={},ue=[],pk={},af=A,Gi=A,ym=function(){},Od=function(){throw"Oops!"},gm=[0,0,0],on={x:0,y:0,width:0,height:0},wr=A,Fp=A,nb=A,Hd=function(j,x){fg[j]=x,x&&x.comps&&!x.uuid&&(x.uuid=P.Math.generateUUID()),ck[j]&&(x.cacheRule=ck[j],delete ck[j])},mh=function(_){Fp&&!_._72O&&(nb||(nb={}),nb[_._72O=lo()]=_),yg!=A?Bo()<.05&&L&&!dc&&(cm=lp):cm=ql},mj=function(k,K,O,h){Fp||(Fp={});var z=Fp[k];if(z){if(z.url===K)return;z.image?(z.image.onload=ym,z.image.onerror=ym):z.request&&(z.request.onload=ym,z.request.onerror=ym)}if(Po.test(K)){var E=new en;if(Fp[k]={request:E,url:K},K=b.beforeLoadURL(K,k),K.data){var i=b.parse(K.data);eg(k,i),b.handleImageLoaded(k,i)}else{E.onload=function(){if(200===this.status||0===this.status){var V=b.parse(E.getResponseText());eg(k,V),b.handleImageLoaded(k,V)}else eg(k,b.handleUnfoundImage(k,K)||A)},E.onerror=function(){eg(k,b.handleUnfoundImage(k,K)||A)};var t={};t.url=encodeURI(K),t.sync=!1,E.send(t)}}else{var i=new Image;Fp[k]={image:i,url:K},/^data:image/.test(K)||(K=b.beforeLoadURL(K,k),K=b.appendTimeStamp(K),K=encodeURI(K),i.crossOrigin=b.crossOrigin),b.convertImageSrc(K,function(d){Yi&&(K.toLowerCase().indexOf(".svg")>0||Tf.test(K))?(x.body.appendChild(i),i.style.visibility="hidden",i.onload=function(){$(function(){if(O&&(i.width=O),h&&(i.height=h),!i.width||!i.height){var f=i.width||i.clientWidth,$=i.height||i.clientHeight;i.width=f,i.height=$}b.handleImageLoaded(k,i),eg(k,i),x.body.removeChild(i),i.style.visibility=""},180)},i.onerror=function(){eg(k,b.handleUnfoundImage(k,K)||A),x.body.removeChild(i),i.style.visibility=""}):(i.onload=function(){O&&(i.width=O),h&&(i.height=h),b.handleImageLoaded(k,i),eg(k,i)},i.onerror=function(){eg(k,b.handleUnfoundImage(k,K)||A)}),i.src=d})}},eg=function(n,y){if(Hd(n,y),delete Fp[n],Ah(Fp)&&(Fp=A,nb)){for(var u in nb){var L=nb[u];L._2O&&L._2O[n]&&(L.deleteTexture(n),delete L._2O[n]),L.invalidateAll&&L.invalidateAll(e,"imageLoaded",n),L.redraw&&L.redraw(),L.iv(),delete L._72O}nb=A}if(y&&nb)for(var u in nb){var L=nb[u];L.invalidateAll&&L.invalidateAll(e,"imageLoading",n),L.redraw&&L.redraw(),L.iv()}},mr=function(){return w=v&&Date,function(){return _.performance&&_.performance.now?_.performance.now():Date.now()}}(),pn=function(v,P,k){return{width:v,height:P,comps:Fl(k)?k:[k]}},Go=function(o,I){return{type:Kf,rect:[o,I,1.6,1.6],borderWidth:1,borderColor:Cr,gradient:rj,gradientColor:Hp,background:Cr}},Ym=function(Y,A){return pn(16,16,{type:jl,rect:[4,4,10,8],background:Y,rotation:A?1.57:3.14})},Td=function(s,O){return pn(16,16,{type:jl,rect:[4,4,8,7],background:s,rotation:O?3.14:0})},Nc=function(t){var Q=t._orientation;return"horizontal"===Q||"h"===Q},eb=function(K,Q){var u=A||4,L=A||1,M=A||1;0>u?u=0:u>.25&&(u=.25);var R,F,Z,x,l,S,T,k=.5,y=[],i=[],s=[],I=U/M,p=U/L,d=k-u;for(F=0;L>=F;F++)for(x=-O+F*p,S=E(x),l=j(x),R=0;M>=R;R++)Z=R*I,T=d+u*S,y.push(E(Z)*T,l*u,-j(Z)*T),(G=[K,Q])&&i.push(R/M,1-F/L);for(F=0;L>F;F++){var t=F*(M+1),z=(F+1)*(M+1);for(R=0;M>R;R++)s.push(t+R,z+R+1,z+R,t+R,t+R+1,z+R+1),Sf.z=qs.z=[K,Q]}},sb=function(x){var Q=2,m=0;for(var V in x)V.length===Q&&y(V,32)===aj&&(af=Gi=x[V]),m++;return m},fd=function(O,W,d,Y){return d||(d=tc?5:3,d/=Y||1),{x:O-d,y:W-d,width:2*d,height:2*d}},Fi=function(c,q,s,t){var w=this;q||(q=tc?5:3,s=20,t=20);var $={x:c,y:q,width:s,height:t};if(s)for(var C=0;s>C;C++)if(3===s)t=20;else for(var P=0;t>P;P++)w=_?_:s;var d={x:O,y:2*O};if(dg($,d)){var X=ll[0]+Oe[0]+Bj[1]+Wr.length,a=am[0]+qe[0]+Bj[1]+_o.length;vn[Fe]=[w[X],w[a]],w[X]=$h[Fe],w[a]=$h[lc]}},_j=function(S){return(/ble$/.test(S)||/ed$/.test(S)||q[S]?"is":"get")+S.charAt(0).toUpperCase()+S.slice(1)},$h=function(R){return"set"+R.charAt(0).toUpperCase()+R.slice(1)},nf=function(L){return typeof L===Cf||L instanceof String},vp=function(X){return typeof X===sc},ql=function(w){return typeof w===rc},Tp=function(Z){return Z&&"object"==typeof Z},Fd=function(z){return"function"==typeof z},Fl=function(J){return J instanceof Array},mk=function(P){return P instanceof Tr},kf=function(l){return Fl(l)?new Tr(l):l},$o=function(t){return t instanceof Ei},cn=function(S){return S instanceof Fb},gk=function(B){return B instanceof Cs},Ak=function(O,H){if(!(O instanceof P.Group))return!1;if(!H)return O.isExpanded();var $=H.getDataUI(O);return $&&$._88I?!0:!1},_k=function(k){return k instanceof zm},hg=function(i){return i&&"IFRAME"===i.tagName},al=function(r){return r==A||b.numberDigits==A?r:parseFloat(r.toFixed(b.numberDigits))},oj=function(w,K,z){var m,g=K.length;if(z)for(var D=0;z>D;D++)if(3===g)w.push(K[0]),w.push(K[1]),w.push(K[2]);else for(m=0;g>m;m++)w.push(K[m]);else if(3===g)w.push(K[0]),w.push(K[1]),w.push(K[2]);else for(m=0;g>m;m++)w.push(K[m])},Rf=function(P){return P?Tp(P)?P:{}:!1},Ec=function(H,K,w){var Y,Z=Tp(H)?H:H.prototype;for(Y in K)w&&Y in Z?Z[Y]===e&&console.warn("class",Z,"has own undefined property",Y,", keep exist!"):Z[Y]=K[Y];return H},Hr=function(U,t){if(!("wheelDelta"in t)){var H=t.deltaMode;t.wheelDelta=H===t.DOM_DELTA_PIXEL?-t.deltaY:H===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}U.handle_mousewheel(t)},Zf=function(p){return String.fromCharCode(p)},oc=function(W){for(var J,G=0,n="";G<W.length;G++)J=W[W.length-1-G],"%"===J?J="'":"a"===J?J='"':"]"===J&&(J="\\"),n+=Zf(J.charCodeAt(0)-1);return n},yf=function(U,Q,t){U.superClass.constructor.apply(Q,t)},Ah=function(r){for(var z in r)return!1;return!0},ye=function(b){return b?0===b.length:!0},Bh=function(){var s="";return[ao[0],es[0],ls[0]].forEach(function(U){s+=$h(U).slice(3)}),Ze=x&&x[s]||lm,function(W,O){return W===O?!0:W.x===O.x&&W.y===O.y&&W.width===O.width&&W.height===O.height}}(),ii=function(h,k,E){return k>h?k:h>E?E:h},_r=function(X){return 0>X?-1:X>0?1:0},Bo=function(){var N=1e4*j(Gh++);return N-z(N)},Ff=function(N,A,B){return Fc(N.x,N.y,A.x,A.y,B.x,B.y,B.x+B.width,B.y,!0)||Fc(N.x,N.y,A.x,A.y,B.x+B.width,B.y,B.x+B.width,B.y+B.height,!0)||Fc(N.x,N.y,A.x,A.y,B.x+B.width,B.y+B.height,B.x,B.y+B.height,!0)||Fc(N.x,N.y,A.x,A.y,B.x,B.y+B.height,B.x,B.y,!0)},Fc=function(B,p,f,t,q,h,c,u,o){var z=(c-q)*(p-h)-(u-h)*(B-q),e=(u-h)*(f-B)-(c-q)*(t-p);if(0!==e){var F=z/e,v=B+F*(f-B),H=p+F*(t-p);return o&&(v+dd<C(B,f)||v-dd>a(B,f)||v+dd<C(q,c)||v-dd>a(q,c)||H+dd<C(p,t)||H-dd>a(p,t)||H+dd<C(h,u)||H-dd>a(h,u))?A:[v,H]}return A},Li=function(I,x,H){if(I&&H)if(x){if(x===Al)return I.getStyle(H);if(x===rs)return I.getAttr(H);if(x===Wn)return I[H]}else if(H=_j(H),I[H])return I[H]();return e},Qq=function(Z,s,W,R){if(Z&&W)if(s){if(s===Al)Z.s(W,R);else if(s===rs)Z.a(W,R);else if(s===Wn){var $=Z[W];Z[W]=R,Z.fp("f:"+W,$,R)}}else W=$h(W),Z[W]&&Z[W](R)},jo=function(Z,N,E){return N&&"top"!==N?"bottom"===N?{x:Z.x,y:Z.y,width:Z.width,height:Z.height*E}:"right"===N?{x:Z.x,y:Z.y,width:Z.width*E,height:Z.height}:"left"===N?{x:Z.x+Z.width*(1-E),y:Z.y,width:Z.width*E,height:Z.height}:void 0:{x:Z.x,y:Z.y+Z.height*(1-E),width:Z.width,height:Z.height*E}},me=function(B,f,R,G,K){f&&ld(B,R,G,1,K,f)},ub=function(p,n,M,N){var f=1-p;return f*f*n+2*p*f*M+p*p*N},Sf=function(X,x,Q,H,p){var y=1-X;return y*y*y*x+3*y*y*X*Q+3*y*X*X*H+X*X*X*p},jp=function(s){var I,V,P,b,r=0;return s.forEach(function(W){if(I=W.length,I>0)for(V=W[0],b=1;I>b;b++)P=W[b],r+=np(V,P),V=P}),r},Pl=function(h,p,$){var b="__"+h,q=function(l){$.disabled||$["handle_"+h](l)};$[b]||($[b]=q,d(p,h,q))},Wp=function(f,D,M){var E="__"+f,w=M[E];w&&(B(D,f,w),delete M[E])},Ch=function(V,T){var e="_"+T;V[_j(T)]=function(){return this[e]},V[$h(T)]=function(o){var K=this[e];this[e]=o,this.fp(T,K,o)}},le=function(V){return N.create(V)},Vm=function(Q){if(!Q.element){var y,I;(y=Q.textField)?I=Ld(qm.TextField,y):(y=Q.textArea)?I=Ld(qm.TextArea,y):(y=Q.button)?I=Ld(qm.Button,y):(y=Q.comboBox)?I=Ld(qm.ComboBox,y):(y=Q.checkBox)?I=Ld(qm.CheckBox,y):(y=Q.radioButton)?I=Ld(qm.RadioButton,y):(y=Q.slider)?I=Ld(qm.Slider,y):(y=Q.colorPicker)?I=Ld(qm.ColorPicker,y):(y=Q.image)&&(I=Ld(qm.Image,y)),I&&(Q.element=I)}},tf=function(y,H){var R=ob(y);return R._ht=H,R},lb=_.top===_?_.top:_||_.document,ob=function(D,Z){var z=x.createElement("div"),H=z.style;return z.tabIndex=-1,z.onkeydown=Rj,H.msTouchAction=ei,Vd(z,A,0),tc&&H.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",A),D&&(H.overflow=am),Z&&Ho(Z,z),z},sn=function(X,q){var u=x.createElement("canvas"),f=u.style;return f.msTouchAction=ei,q||(f.pointerEvents=ei),Vd(u,A,0),X&&Ho(X,u),u},Vd=function(N,c,Q){var b=N.style;b.border=c?c+" solid 1px":0,b.outline=0,b.padding=Q?"0 "+Q+bl:0,Dm(N)},Dm=function(M){var Q=M.style;Q.position=be,Q.margin=0,Q.setProperty("box-sizing","border-box",A),Q.setProperty("-moz-box-sizing","border-box",A)},jk=function(G,T,x,B){B||(B=Af),T!=A&&(G.width=T*B,G.style.width=T+bl),x!=A&&(G.height=x*B,G.style.height=x+bl)},Ho=function(p,d,R){p.appendChild(d),R&&(d.style.position=be)},an=function(J,S){S.split||(S+="");for(var h,q=S.split("\n"),B=0,s=q.length,Y=0;s>Y;Y++){var v=Io(J.font,q[Y]);v.width>B&&(B=v.width),h||(h=v.height)}return J.ss=q,{width:B,height:h*s}},cs=function(Q,M,i,m,P,I){var H=M.length;if(1===H)bi(Q,M[0],i,m,P);else for(var g=i.height/H,A={x:i.x,y:i.y,width:i.width,height:g},W=0;W<M.length;W++)I?wo(Q,M[W],m,P,A.x,A.y,A.width,A.height,I):bi(Q,M[W],A,m,P),A.y+=g},bi=function(R,P,r,b,L){R.font=b?b:Ek,R.fillStyle=L?L:Rl,R.textAlign=Le,R.textBaseline=sg;var J,t;r?r.width===e?(J=r.x,t=r.y):(J=r.x+r.width/2,t=r.y+r.height/2):(J=0,t=0),R.fillText(P,W(J),W(t))},Ni=function(e){e.getView&&(e=e.getView());var b=e.offsetWidth||e.scrollWidth;return!b&&e.style.width&&(b=y(e.style.width)),b},Ge=function(l){l.getView&&(l=l.getView());var b=l.offsetHeight||l.scrollHeight;return!b&&l.style.height&&(b=y(l.style.height)),b},uq=function(q,m,b){var h=m[0].toUpperCase()+m.substring(1,m.length);q["webkit"+h]=b,q["moz"+h]=b,q["ms"+h]=b,q["o"+h]=b,q[m]=b},db=function(){var j=function(e){Rj(e),e.stopPropagation()},X=function(b){Rj(b)},e=[Cb,cr,bo];return function(W,V){var K=ob(),_=K.style;return _.backgroundColor=b.disabledBackground,W&&(_.backgroundImage="url("+W+")",_.backgroundPosition="50% 50%",_.backgroundRepeat="no-repeat no-repeat"),V===!1?e.forEach(function(v){d(K,v,X)}):e.forEach(function(n){d(K,n,j)}),K}}(),Sl=function(t){var k=t.getContext("2d");return k.save(),k.lineCap=$q,k.lineJoin=We,k},cm=function(R,n,_,M){Xf(R,n*Af,_*Af),M*=Af,1!==M&&R.scale(M,M)},Xf=function(w,r,B){w.translate(r,B)},jb=function(H,Q){Q&&H.rotate(Q)},Jp=function(z,u,M){u===e&&(u=1),M===e&&(M=1),(1!==u||1!==M)&&z.scale(u,M)},ir=!1,Y=lb[Qb[1]+mn[0]],Pg=function(z){var N=x.activeElement;if(x.activeElement!==z){N&&N.forceOnblur&&N.forceOnblur();for(var m=[],v=z.parentNode;v;)m.push([v,v.scrollLeft,v.scrollTop]),v=v.parentNode;if(!ir){var j=[],D=[];try{for(var Z=_.parent,b=_;Z!==b;)j.push([Z,Z.scrollX,Z.scrollY]),b=Z,Z=_.parent;var s=_.frameElement;if(s)for(var $=s.parentNode;$;)D.push([$,$.scrollLeft,$.scrollTop]),$=$.parentNode}catch(n){ir=!0}}if(tc)z.focus();else{var E=fi(),X=E.target;z.focus(),X.scrollLeft=E.left,X.scrollTop=E.top}m.forEach(function(v){v[0].scrollLeft=v[1],v[0].scrollTop=v[2]}),ir||(j.forEach(function(Q){Q[0].scrollTo(Q[1],Q[2])}),D.forEach(function(m){m[0].scrollLeft=m[1],m[0].scrollTop=m[2]}))}},If=function(Z){return Z&&Z.getView?Z.getView():Z},di=function(m,o,A,n,C){if(2===arguments.length&&(A=o.y,n=o.width,C=o.height,o=o.x),m.isSelfViewEvent)m.setX(o),m.setY(A),m.setWidth(n),m.setHeight(C);else{var r=If(m),d=r.style;if((x.fullscreenElement||x.mozFullScreenElement||x.webkitFullscreenElement||x.msFullscreenElement)!==r)o!==e&&(d.left=o+bl),A!==e&&(d.top=A+bl),n!==e&&(d.width=n+bl),C!==e&&(d.height=C+bl);else{var y=b.getWindowInfo();d.left=(o=y.left)+bl,d.top=(A=y.top)+bl,d.width=(n=y.width)+bl,d.height=(C=y.height)+bl}m.endEditing&&!tc&&m.endEditing(),m.redraw&&m.redraw(),m.invalidate&&m.invalidate(),m.onLayouted&&m.onLayouted(o,A,n,C),m.fireViewEvent&&m.fireViewEvent("layout")}},ah=function(J){if(!J.touches)return J;var b=J.touches[0];return b?b:J.changedTouches[0]},Mm=function(n){return Sp(n)?ah(n).target:n.target},Sp=function(f){return"touches"in f},Jb=function(T){b.popup&&b.popup.close(),b.popup=T},si=A,Yg=function(x){si.handleWindowTouchMove(x)},fc=function(U){si.handleWindowTouchEnd(U),B(_,vh,Yg),B(_,is,fc),si=A},ur=function(H){si.handleWindowMouseMove(H)},Me=function(R){si.handleWindowMouseUp(R),B(_,xq,ur),B(_,Sq,Me),si=A},nl=function(s){return 1===xs(s)},Ur=function(r,E){return E?E.keyCode===r:de[r]},wg=function(p){return Kc(p)&&Ur(65,p)},hp=function(x){return Ur(46,x)||Ur(8,x)},yd=function(g){return function(i){return i?i.keyCode===g:de[g]}},aj=573,eh=[65,83,68,87,37,38,39,40,32,13,27],Tk=yd(eh[0]),Pe=yd(eh[1]),Jh=yd(eh[2]),Km=yd(eh[3]),el=yd(eh[4]),Pk=yd(eh[5]),cg=yd(eh[6]),Dd=yd(eh[7]),Kn=yd(eh[8]),rp=yd(eh[9]),dk=yd(eh[10]),im={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},fb=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,28051],Vr=A,$r=A,Zj=function(L,h){Vr||(Vr=sn()),jk(Vr,L,h,1);var m=Sl(Vr);return m.clearRect(0,0,L,h),m},qo=function(){var k,Z={};for(var l in _){var z=Vc.length;if(l.length==z&&l[0]===Vc[2]&&l[1]===ei[1]&&l[4]===Vc[3]&&l[5]===Vc[4]&&l.substr(z-2)===ei[1]+ei[2]){var p=_[l];for(var T in p)T.length===z&&T.substr(0,3)===Pc[3]+kc[3]+tm[0]&&T.substr(z-2)===Vc[0]+Up[3]&&(Cl=p[T])}}return function(E){var T,R=Z[E];return R||(k||(k=sn(),jk(k,1,1,1)),T=k.getContext("2d"),T.clearRect(0,0,1,1),ld(T,0,0,1,1,E),R=T.getImageData(0,0,1,1).data,R=Z[E]=[R[0],R[1],R[2],R[3]]),R}}(),Lc=function(F){if(!nf(F))return F;var f=qo(F);return f.CA||(f.CA=[f[0]/255,f[1]/255,f[2]/255,f[3]/255]),f.CA},jm=function(n,Y,h,v,w){var H=sn();H.width=h,H.height=v;var d=H.getContext("2d");d.drawImage(n,0,0,h,v);try{for(var _=d.getImageData(0,0,h,v),V=_.data,W=0,x=V.length;x>W;W+=4){var u=V[W+0],i=V[W+1],Z=V[W+2],P=V[W+3];"override_a"===w?V[W+3]=255*Y[3]:"override_rgb"===w?(V[W+0]=255*Y[0],V[W+1]=255*Y[1],V[W+2]=255*Y[2]):"override"===w?(V[W+0]=255*Y[0],V[W+1]=255*Y[1],V[W+2]=255*Y[2],V[W+3]=255*Y[3]):(V[W+0]=Y[0]*u,V[W+1]=Y[1]*i,V[W+2]=Y[2]*Z,V[W+3]=Y[3]*P)}d.putImageData(_,0,0)}catch(k){return n}return H},vn=function(R,o,e){return o&&(o="miter"===e?8*o+20:o+1,R&&Qj(R,o)),o},Uh=function(_,p){if(p){var h=new md(p),l=_.width/2,n=_.height/2,Q=mo([h.tf(-l,-n),h.tf(l,-n),h.tf(l,n),h.tf(-l,n)]);return Q.x+=_.x+l,Q.y+=_.y+n,Q}return _},Nn=function(l,U,u,f,h,x,y,g){f*=Math.PI/180;var j={x:Math.cos(f)*(l.x-y.x)/2+Math.sin(f)*(l.y-y.y)/2,y:-Math.sin(f)*(l.x-y.x)/2+Math.cos(f)*(l.y-y.y)/2},A=Math.pow(j.x,2)/Math.pow(U,2)+Math.pow(j.y,2)/Math.pow(u,2);A>1&&(U*=Math.sqrt(A),u*=Math.sqrt(A));var r=(h==x?-1:1)*Math.sqrt((Math.pow(U,2)*Math.pow(u,2)-Math.pow(U,2)*Math.pow(j.y,2)-Math.pow(u,2)*Math.pow(j.x,2))/(Math.pow(U,2)*Math.pow(j.y,2)+Math.pow(u,2)*Math.pow(j.x,2)));isNaN(r)&&(r=0);var V={x:r*U*j.y/u,y:r*-u*j.x/U},m={x:(l.x+y.x)/2+Math.cos(f)*V.x-Math.sin(f)*V.y,y:(l.y+y.y)/2+Math.sin(f)*V.x+Math.cos(f)*V.y},R=function(Z){return Math.sqrt(Math.pow(Z[0],2)+Math.pow(Z[1],2))},J=function(B,c){return(B[0]*c[0]+B[1]*c[1])/(R(B)*R(c))},N=function(l,W){return(l[0]*W[1]<l[1]*W[0]?-1:1)*Math.acos(J(l,W))},s=N([1,0],[(j.x-V.x)/U,(j.y-V.y)/u]),Q=[(j.x-V.x)/U,(j.y-V.y)/u],k=[(-j.x-V.x)/U,(-j.y-V.y)/u],t=N(Q,k);J(Q,k)<=-1&&(t=Math.PI),J(Q,k)>=1&&(t=0);var J=U>u?U:u,_=U>u?1:U/u,n=U>u?u/U:1;if(null==g){var E={x:0,y:0,width:0,height:0};Qj(E,J),E.x*=_,E.width*=_,E.y*=n,E.height*=n;var X=new md(f);return E=mo([X.tf(E.x,E.y),X.tf(E.x+E.width,E.y),X.tf(E.x+E.width,E.y+E.height),X.tf(E.x,E.y+E.height)]),E.x+=m.x,E.y+=m.y,[{x:E.x,y:E.y},{x:E.x+E.width,y:E.y},{x:E.x+E.width,y:E.y+E.height},{x:E.x,y:E.y+E.height}]}g.translate(m.x,m.y),g.rotate(f),g.scale(_,n),g.arc(0,0,J,s,s+t,1-x),g.scale(1/_,1/n),g.rotate(-f),g.translate(-m.x,-m.y)},Ji=function(V,L){V&&V.beginPath();for(var r,D,S,h=[],a=function(q){for(var S,p=/(\-{0,1}[\d\.]+)/gi,w=[];S=p.exec(q);)w.push(parseFloat(S[0]));return w},C=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,X={x:0,y:0};r=C.exec(L);){var j=r[0],Z=j.substr(0,1);if("M"===Z||"m"===Z){for(var H=a(j),R=0;R<H.length;R+=2){var o=H[R],$=H[R+1];"m"===Z&&(o+=X.x,$+=X.y),V&&V.moveTo(o,$),h.push({x:o,y:$}),X.x=o,X.y=$}D=S=null}else if("H"===Z||"h"===Z){for(var H=a(j),R=0;R<H.length;R+=1){var o=H[R];"h"===Z&&(o+=X.x),V&&V.lineTo(o,X.y),h.push({x:o,y:X.y}),X.x=o}D=S=null}else if("C"===Z||"c"===Z){for(var H=a(j),R=0;R<H.length;R+=6){var l=H[R],n=H[R+1],q=H[R+2],d=H[R+3],o=H[R+4],$=H[R+5];"c"===Z&&(l+=X.x,n+=X.y,q+=X.x,d+=X.y,o+=X.x,$+=X.y),V&&V.bezierCurveTo(l,n,q,d,o,$),h.push({x:l,y:n}),h.push({x:q,y:d}),h.push({x:o,y:$}),X.x=o,X.y=$}D=[l,n,q,d,o,$],S=null}else if("S"===Z||"s"===Z){for(var H=a(j),R=0;R<H.length;R+=4){var l,n;D?(l=2*D[4]-D[2],n=2*D[5]-D[3]):(l=X.x,n=X.y);var q=H[R],d=H[R+1],o=H[R+2],$=H[R+3];"s"===Z&&(q+=X.x,d+=X.y,o+=X.x,$+=X.y),V&&V.bezierCurveTo(l,n,q,d,o,$),h.push({x:l,y:n}),h.push({x:q,y:d}),h.push({x:o,y:$}),X.x=o,X.y=$}D=[l,n,q,d,o,$],S=null}else if("Q"===Z||"q"===Z){for(var H=a(j),R=0;R<H.length;R+=4){var l=H[R],n=H[R+1],o=H[R+2],$=H[R+3];"q"===Z&&(l+=X.x,n+=X.y,o+=X.x,$+=X.y),V&&V.quadraticCurveTo(l,n,o,$),h.push({x:l,y:n}),h.push({x:o,y:$}),X.x=o,X.y=$}D=null,S=[l,n,o,$]}else if("T"===Z||"t"===Z){for(var H=a(j),R=0;R<H.length;R+=2){var l,n;S?(l=2*S[2]-S[0],n=2*S[3]-S[1]):(l=X.x,n=X.y);var o=H[R],$=H[R+1];"t"===Z&&(o+=X.x,$+=X.y),V&&V.quadraticCurveTo(l,n,o,$),h.push({x:l,y:n}),h.push({x:o,y:$}),X.x=o,X.y=$}D=null,S=[l,n,o,$]}else if("V"===Z||"v"===Z){for(var H=a(j),R=0;R<H.length;R+=1){var $=H[R];"v"===Z&&($+=X.y),V&&V.lineTo(X.x,$),h.push({x:X.x,y:$}),X.y=$}D=S=null}else if("L"===Z||"l"===Z){for(var H=a(j),R=0;R<H.length;R+=2){var o=H[R],$=H[R+1];"l"===Z&&(o+=X.x,$+=X.y),V&&V.lineTo(o,$),h.push({x:o,y:$}),X.x=o,X.y=$}D=S=null}else if("A"===Z||"a"===Z){for(var H=a(j),R=0;R<H.length;R+=7){var s=H[R],m=H[R+1],b=H[R+2],k=H[R+3],W=H[R+4],o=H[R+5],$=H[R+6];"a"===Z&&(o+=X.x,$+=X.y);var v=Nn(X,s,m,b,k,W,{x:o,y:$},V);v&&(h=h.concat(v)),X.x=o,X.y=$}D=S=null}var c=j.substr(j.length-1);("z"===c||"Z"===c)&&V&&V.closePath()}return h},Tc=function(T,s){var g,R,n="L"===s[0],C=s.length;T.save(),n?(T.transform(s[5],s[6],s[7],s[8],s[9],s[10]),g=T.createLinearGradient(s[1],s[2],s[3],s[4]),R=11):(T.transform(s[7],s[8],s[9],s[10],s[11],s[12]),g=T.createRadialGradient(s[1],s[2],s[3],s[4],s[5],s[6]),R=13);for(var A=T.compGray;C>R;)g.addColorStop(s[R],A?b.toGrayColor(s[R+1]):s[R+1]),R+=2;T.fillStyle=g},qs=function(m,p){var t=m.s("shape.gradient.pack");if(t){for(var R=t.length,i=new Array(R),u=0;R>u;u++)i[u]=t[u];var O,V,Q,T,D,y,w,L,E,I,r,q,c,$="L"===i[0];O=$?5:7,V=i[O],Q=i[O+1],T=i[O+2],D=i[O+3],y=i[O+4],w=i[O+5],L=p[0],E=p[1],I=p[2],r=p[3],q=p[4],c=p[5],i[O]=L*V+I*Q,i[O+1]=E*V+r*Q,i[O+2]=L*T+I*D,i[O+3]=E*T+r*D,i[O+4]=L*y+I*w+q,i[O+5]=E*y+r*w+c,m.s("shape.gradient.pack",i)}},xh=function(s,V,O,q){var B=!1;if(s.beginPath?s.beginPath():B=!0,mk(V)&&(V=V._as),mk(O)&&(O=O._as),O&&O.length){for(var D,F,y,l,K=0,z=0,I=O.length;I>z;z++)D=O[z],1===D?(F=V[K++],s.moveTo(F.x,B?-F.y:F.y)):2===D?(F=V[K++],s.lineTo(F.x,B?-F.y:F.y)):3===D?(F=V[K++],y=V[K++],s.quadraticCurveTo(F.x,B?-F.y:F.y,y.x,B?-y.y:y.y)):4===D?(F=V[K++],y=V[K++],l=V[K++],s.bezierCurveTo(F.x,B?-F.y:F.y,y.x,B?-y.y:y.y,l.x,B?-l.y:l.y)):5===D&&s.closePath();q&&5!==D&&s.closePath()}else{var t,p,P,H=V.length;if(H>0){for(t=V[0],s.moveTo(t.x,B?-t.y:t.y),p=1;H>p;p++)P=V[p],s.lineTo(P.x,B?-P.y:P.y);q&&s.closePath()}}},vm=function(J,I,Y,W){if(mk(J)&&(J=J._as),mk(I)&&(I=I._as),I&&I.length){Y=Y||je;for(var P,o,y,O,w,H,B,n,v=[],h=A,j=0,c=0,M=I.length;M>c;c++)if(P=I[c],1===P)v.push(h=[]),h.push(J[j++]);else if(2===P)h.push(J[j++]);else if(3===P){for(o=h[h.length-1],y=J[j++],O=J[j++],H=1;Y>H;H++)B=ub(H/Y,o.x,y.x,O.x),n=ub(H/Y,o.y,y.y,O.y),h.push({x:B,y:n,b:!0});h.push(O)}else if(4===P){for(o=h[h.length-1],y=J[j++],O=J[j++],w=J[j++],H=1;Y>H;H++)B=Sf(H/Y,o.x,y.x,O.x,w.x),n=Sf(H/Y,o.y,y.y,O.y,w.y),h.push({x:B,y:n,b:!0});h.push(w)}else 5===P&&h.push(h[0]);return W&&5!==P&&h&&h.length>2&&h.push(h[0]),v}return W&&J.length>2&&(J=J.slice(),J.push(J[0])),J?[J]:[]},Bs=function(Y,X,P,s,f,I){var O,e,S,g=qo(X),p=s,b=g[0],F=g[1],T=g[2];if(P){var G=qo(P);O=G[0]-b,e=G[1]-F,S=G[2]-T}else O=255-b,e=255-F,S=255-T;for(I||(I=s>10?1:.5,I=1>f?C(I/f,2):I),Y.save(),Y.shadowOffsetX=0,Y.shadowOffsetY=0,Y.shadowBlur=0,Y.shadowColor=0;(s-=I)>0;){var L=1-s/p,N=b+O*L,n=F+e*L,Q=T+S*L;N=C(m(N),255),n=C(m(n),255),Q=C(m(Q),255),Y.strokeStyle="rgb("+N+","+n+","+Q+")",Y.lineWidth=s,Y.stroke()}Y.restore()},Wh=function(){var L={};return function(Y,T){var l=Y+"-"+T,z=L[l];if(z)return z;var I,i,V,Z=qo(Y);return 0>T?(T=(100+T)/100,I=m(Z[0]*T),i=m(Z[1]*T),V=m(Z[2]*T)):(T/=100,I=Z[0],i=Z[1],V=Z[2],I+=(255-I)*T,i+=(255-i)*T,V+=(255-V)*T,I=C(m(I),255),i=C(m(i),255),V=C(m(V),255)),L[l]="rgb("+I+","+i+","+V+")"}}(),ld=function(k,y,P,Y,p,D){D&&(k.fillStyle=D),k.beginPath(),k.rect(y,P,Y,p),k.fill()},yl=function(M,i,n,O,f,g,I){M.beginPath(),Mf[i](M,n.x,n.y,n.width,n.height,O,f,g,I)},bn=function(S,v,I,d,g){var j=Mf[I];S.fillStyle=j?j(S,v,d?d:Hp,g.x,g.y,g.width,g.height):v},Vp=function(z,J,L,Z,O,p){try{if(!J.tagName&&J.comps){J._cacheImage_||(J._cacheImage_={});var o;o="override"===Z?"colors_override":"override_rgb"===Z?"colors_override_rgb":"override_a"===Z?"colors_override_a":"colors",J._cacheImage_[o]||(J._cacheImage_[o]={__count__:0});var C=J._cacheImage_[o][L];C||(J._cacheImage_[o].__count__>b.imageCacheThreshold&&(J._cacheImage_[o]={__count__:0}),C=P.Default.toCanvas(J,pl(J),Vf(J),null,O,p,L,null,Z),J._cacheImage_[o][L]=C,J._cacheImage_[o].__count__++),J=C}z.fillStyle=z.createPattern(J,"repeat")}catch(T){z.fillStyle="black"}},Ob=function(E,$,P,u,D,m,p){E.save(),E.translate($,P),E.scale(1,p/m),E.arc(0,0,m,u,D),E.restore()},Qr=function(c,B,U,n,v,Y,X,L){var G,J,_,R,M,w,g,q,z,f,t;if(T(v)>2*O&&(v=2*O),M=m(T(v)/(O/4)),G=v/M,J=-G,_=-n,M>0){w=B+E(n)*Y,g=U+j(-n)*X,L?c.lineTo(w,g):c.moveTo(w,g);for(var b=0;M>b;b++)_+=J,R=_-J/2,q=B+E(_)*Y,z=U+j(_)*X,f=B+E(R)*(Y/E(J/2)),t=U+j(R)*(X/E(J/2)),c.quadraticCurveTo(f,t,q,z)}},Cd=function(g,J,e,c,$,C,p,n,d){6===arguments.length&&(p=C,n=C,d=C);var X=J+c,P=e+$,K=$>c?2*c:2*$;C=K>C?C:K,p=K>p?p:K,n=K>n?n:K,d=K>d?d:K;var u=.29*d,l=.58*d;g.moveTo(X,P-d),g.quadraticCurveTo(X,P-l,X-u,P-u),g.quadraticCurveTo(X-l,P,X-d,P),u=.29*n,l=.58*n,g.lineTo(J+n,P),g.quadraticCurveTo(J+l,P,J+u,P-u),g.quadraticCurveTo(J,P-l,J,P-n),u=.29*C,l=.58*C,g.lineTo(J,e+C),g.quadraticCurveTo(J,e+l,J+u,e+u),g.quadraticCurveTo(J+l,e,J+C,e),u=.29*p,l=.58*p,g.lineTo(X-p,e),g.quadraticCurveTo(X-l,e,X-u,e+u),g.quadraticCurveTo(X,e+l,X,e+p),g.lineTo(X,P-d)},Yf=function(n,$,R,Q,y,J,P){$&&(R=W(R),Q=W(Q),P||(P=1),n.fillStyle=$,n.beginPath(),n.rect(R,Q,P,J),n.rect(R,Q,y,P),J-P>0&&n.rect(R,Q+J-P,y,P),y-P>0&&n.rect(R+y-P,Q,P,J),n.fill())},Eg=function(V,i,q,f){var u=f.x,P=f.y,S=f.width,E=f.height;if(!(!i||!q||0>=S||0>=E)){var K,Q=Co(i),H=Pm(i),F=q>0;1===q||-1===q?(V.fillStyle=F?Q:H,V.beginPath(),V.rect(u,P,1,E),V.rect(u,P,S,1),V.fill(),V.fillStyle=F?H:Q,V.beginPath(),V.rect(u,P+E-1,S,1),V.rect(u+S-1,P,1,E),V.fill()):(q=C(T(q),C(S/2,E/2)),K=V.createLinearGradient(u,P,u+q,P),K.addColorStop(0,F?Q:H),K.addColorStop(1,i),V.fillStyle=K,V.beginPath(),V.moveTo(u,P),V.lineTo(u+q,P+q),V.lineTo(u+q,P+E-q),V.lineTo(u,P+E),V.lineTo(u,P),V.fill(),K=V.createLinearGradient(u,P,u,P+q),K.addColorStop(0,F?Q:H),K.addColorStop(1,i),V.fillStyle=K,V.beginPath(),V.moveTo(u,P),V.lineTo(u+q,P+q),V.lineTo(u+S-q,P+q),V.lineTo(u+S,P),V.lineTo(u,P),V.fill(),K=V.createLinearGradient(u,P+E,u,P+E-q),K.addColorStop(0,F?H:Q),K.addColorStop(1,i),V.fillStyle=K,V.beginPath(),V.moveTo(u,P+E),V.lineTo(u+q,P+E-q),V.lineTo(u+S-q,P+E-q),V.lineTo(u+S,P+E),V.lineTo(u,P+E),V.fill(),K=V.createLinearGradient(u+S,P,u+S-q,P),K.addColorStop(0,F?H:Q),K.addColorStop(1,i),V.fillStyle=K,V.beginPath(),V.moveTo(u+S,P),V.lineTo(u+S-q,P+q),V.lineTo(u+S-q,P+E-q),V.lineTo(u+S,P+E),V.lineTo(u+S,P),V.fill())}},vb=function(V,L,M,J,W,a,X){var Z=V.createLinearGradient(J,W,a,X);return Z.addColorStop(0,M),Z.addColorStop(1,L),Z},Ve=function(f,F,r,d,J,g,v){var z=f.createLinearGradient(d,J,g,v);return z.addColorStop(0,F),z.addColorStop(.5,r),z.addColorStop(1,F),z},_g=function(X,m,Z,v,j,$,u){var c=X.createLinearGradient(v,j,$,u);return c.addColorStop(0,m),c.addColorStop(1/3,Z),c.addColorStop(2/3,m),c.addColorStop(1,Z),c},Vi=function(U,t,O,L,V,D,K,d,B){var G=U.createRadialGradient(L+D*d,V+K*B,C(D,K)/24,L+D/2,V+K/2,a(D,K)/2);return G.addColorStop(0,O),G.addColorStop(1,t),G},em=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Mf={polygon:function(d,Q,m,_,g,h){(h==A||3>h)&&(h=6);for(var n,G,V=C(_,g)/2,B=Q+_/2,z=m+g/2,v=0,q=2*O/h,R=0;h>R;R++)n=B+E(v)*V,G=z+j(v)*V,0===R?d.moveTo(n,G):d.lineTo(n,G),v+=q;
d.closePath()},arc:function(n,o,Y,g,Z,F,v,E,k){F==A&&(F=O),v==A&&(v=U),E==A&&(E=!0);var t=o+g/2,h=Y+Z/2;E&&n.moveTo(t,h),k?Ob(n,t,h,F,v,g/2,Z/2):n.arc(t,h,C(g,Z)/2,F,v),E&&n.closePath()},rect:function(a,T,F,t,U){a.rect(T,F,t,U)},circle:function(V,F,r,q,Q){V.arc(F+q/2,r+Q/2,C(q,Q)/2,0,U,!0)},oval:function(w,o,v,x,J){Ob(w,o+x/2,v+J/2,0,U,x/2,J/2)},roundRect:function(c,L,b,H,O,B){B==A&&(B=C(C(H,O)/4,8)),Cd(c,L,b,H,O,B)},star:function(k,A,R,x,G){var Q=2*x,T=2*G,L=A+x/2,V=R+G/2;k.moveTo(L-Q/4,V-T/12),k.lineTo(A+.306*x,R+.579*G),k.lineTo(L-Q/6,V+T/4),k.lineTo(A+x/2,R+.733*G),k.lineTo(L+Q/6,V+T/4),k.lineTo(A+.693*x,R+.579*G),k.lineTo(L+Q/4,V-T/12),k.lineTo(A+.611*x,R+.332*G),k.lineTo(L+0,V-T/4),k.lineTo(A+.388*x,R+.332*G),k.closePath()},pentagram:function(g,L,l,p,P){var s=.5*P,w=L+.5*p,y=l+s,d=.5257311121191336*p;d>s&&(d=s);var a=em,f=0;for(g.moveTo(w+d*a[f++],y+d*a[f++]);20>f;)g.lineTo(w+d*a[f++],y+d*a[f++]);g.closePath()},triangle:function(U,g,G,j,F){U.moveTo(g+j/2,G),U.lineTo(g+j,G+F),U.lineTo(g,G+F),U.closePath()},hexagon:function(c,M,e,t,V){c.moveTo(M,e+V/2),c.lineTo(M+t/4,e+V),c.lineTo(M+3*t/4,+e+V),c.lineTo(M+t,e+V/2),c.lineTo(M+3*t/4,e),c.lineTo(M+t/4,e),c.closePath()},pentagon:function(V,D,X,g,J){var B=2*g,P=2*J,n=D+g/2,Y=X+J/2;V.moveTo(n-B/4,Y-P/12),V.lineTo(n-B/6,Y+P/4),V.lineTo(n+B/6,Y+P/4),V.lineTo(n+B/4,Y-P/12),V.lineTo(n+0,Y-P/4),V.closePath()},diamond:function(B,I,b,l,P){B.moveTo(I+l/2,b),B.lineTo(I,b+P/2),B.lineTo(I+l/2,b+P),B.lineTo(I+l,b+P/2),B.closePath()},rightTriangle:function(j,s,C,S,M){j.moveTo(s,C),j.lineTo(s+S,C+M),j.lineTo(s,C+M),j.closePath()},parallelogram:function(H,a,s,S,z){var B=S/4;H.moveTo(a+B,s),H.lineTo(a+S,s),H.lineTo(a+S-B,s+z),H.lineTo(a,s+z),H.closePath()},trapezoid:function(G,j,Y,C,D){var q=C/4;G.moveTo(j+q,Y),G.lineTo(j+C-q,Y),G.lineTo(j+C,Y+D),G.lineTo(j,Y+D),G.closePath()},"linear.southwest":function(s,o,K,Y,P,$,p){return vb(s,o,K,Y,P+p,Y+$,P)},"linear.southeast":function(q,V,X,c,B,S,Q){return vb(q,V,X,c+S,B+Q,c,B)},"linear.northwest":function(B,G,z,o,t,P,O){return vb(B,G,z,o,t,o+P,t+O)},"linear.northeast":function(n,Y,d,M,D,t,R){return vb(n,Y,d,M+t,D,M,D+R)},"linear.north":function(B,q,w,c,l,$,V){return vb(B,q,w,c,l,c,l+V)},"linear.south":function(B,O,g,F,o,C,X){return vb(B,O,g,F,o+X,F,o)},"linear.west":function(w,y,l,v,Q,g){return vb(w,y,l,v,Q,v+g,Q)},"linear.east":function(U,X,k,T,n,R){return vb(U,X,k,T+R,n,T,n)},"radial.center":function(E,D,J,V,w,R,l){return Vi(E,D,J,V,w,R,l,.5,.5)},"radial.southwest":function(y,N,d,S,P,A,R){return Vi(y,N,d,S,P,A,R,.25,.75)},"radial.southeast":function(r,E,b,I,T,P,Q){return Vi(r,E,b,I,T,P,Q,.75,.75)},"radial.northwest":function(c,G,q,x,e,m,C){return Vi(c,G,q,x,e,m,C,.25,.25)},"radial.northeast":function(K,F,v,g,i,A,m){return Vi(K,F,v,g,i,A,m,.75,.25)},"radial.north":function(x,R,Q,f,v,a,O){return Vi(x,R,Q,f,v,a,O,.5,.25)},"radial.south":function(g,Y,l,k,x,z,W){return Vi(g,Y,l,k,x,z,W,.5,.75)},"radial.west":function(D,C,B,P,y,M,x){return Vi(D,C,B,P,y,M,x,.25,.5)},"radial.east":function(v,x,E,I,i,m,k){return Vi(v,x,E,I,i,m,k,.75,.5)},"spread.horizontal":function(m,Y,t,N,B,y){return Ve(m,Y,t,N,B,N+y,B)},"spread.vertical":function(r,V,N,z,C,o,T){return Ve(r,V,N,z,C,z,C+T)},"spread.diagonal":function(k,d,$,s,o,K,S){return Ve(k,d,$,s+K,o,s,o+S)},"spread.antidiagonal":function(s,Z,B,z,I,X,R){return Ve(s,Z,B,z,I,z+X,I+R)},"spread.north":function(E,I,$,s,h,j,f){return _g(E,I,$,s,h-f/4,s,h+f+f/4)},"spread.south":function(f,O,r,L,b,T,x){return _g(f,r,O,L,b-x/4,L,b+x+x/4)},"spread.west":function(f,p,z,I,Q,l){return _g(f,p,z,I-l/4,Q,I+l+l/4,Q)},"spread.east":function(Z,x,v,h,o,n){return _g(Z,v,x,h-n/4,o,h+n+n/4,o)}},se=function(L,m,e){return new md(L).tf(m,e)},Xl=function(R){var p=R.touches[0],t=R.touches[1],G=p.clientX,O=p.clientY,w=t.clientX,Z=t.clientY;return D((G-w)*(G-w)+(O-Z)*(O-Z))},nn=function(U){var E=U.touches[0],s=U.touches[1],A=E.clientX,g=E.clientY,P=s.clientX,K=s.clientY;return{x:(A+P)/2,y:(g+K)/2}},no=(function(){for(var n=0,t=zq.split(""),$=0;$<t.length;$++)n=10*y(t[$])+n;return eb(_[aj.toString(8*$)+ls.substr($)+3],_[aj.toString(8*$)+ls.substr($)+4]),n}(),function(y,j,s){for(var h=0;h<s.size();h++){var P=s.get(h);y.co(P)&&j.add(P)}for(h=0;h<s.size();h++)P=s.get(h),no(y,j,P._children)}),ds=function(O,m,i){for(var L=0;L<i.size();L++){var s=i.get(i.size()-1-L);O.co(s)&&m.add(s)}for(L=0;L<i.size();L++)s=i.get(L),ds(O,m,s._children)},xp=function(I,j,W){for(var Q=!1,B=0;B<W.size();B++){var o=W.get(B);I.co(o)?Q&&j.add(o):Q=1}for(B=0;B<W.size();B++)o=W.get(B),xp(I,j,o._children)},Um=function(d,H,s){for(var i=!1,O=0;O<s.size();O++){var N=s.get(s.size()-1-O);d.co(N)?i&&H.add(N):i=!0}for(O=0;O<s.size();O++)N=s.get(O),Um(d,H,N._children)},un=b.moveDatas=function(y,n,i,B){var q=B==A;if(0!==n||0!==i||!q&&0!==B){var m=!0,c=[];if(y.forEach(function(l){m&&(l._69O||gk(l)||_k(l))&&(m=!1)}),m)c=y;else{var b={},l={};y.forEach(function(J){b[J._id]=!0});var S={},x=function(X){var p=X._id;return b[p]?(c.push(X),S[p]=!0):S[p]=!1},$=function(n){var i=n._id;if(l[i])return x(n);var V=S[i];if(V!==e)return V;var u=n._parent;if(u&&(_k(u)||gk(u))&&$(u))return S[i]=!0;var H=n._host;return H&&(l[i]=i,V=$(H),l[i]=e,V)?S[i]=!0:x(n)};y.forEach(function(u){$(u)})}c.forEach(function(L){if($o(L))q?L.translate(n,i):L.translate3d(n,i,B);else{var c=L.s(Ai);if(!c||c.isEmpty())return;var I=new Tr;c.each(function(P){P=Cc(P),q?(P.x+=n,P.y+=i):(P.x+=n,P.y+=B,P.e==A?P.e=i:P.e+=i),I.add(P)}),L.s(Ai,I)}})}},fo=function(){function K(n,j){return j===n.substring(0,j.length)?!0:!1}function j(F){return parseFloat(F)||0}function l(X,n){if(n==e&&(n=new Xd),K(X,"matrix3d")){var H=X.substring(9,X.length-1).split(",");H=H.map(j),n.fromArray(H)}else if(K(X,"matrix")){var H=X.substring(7,X.length-1).split(",");H=H.map(j),n.el[0]=H[0],n.el[1]=H[1],n.el[2]=0,n.el[3]=0,n.el[4]=H[2],n.el[5]=H[3],n.el[6]=0,n.el[7]=0,n.el[8]=0,n.el[9]=0,n.el[10]=1,n.el[11]=0,n.el[12]=H[4],n.el[13]=H[5],n.el[14]=0,n.el[15]=1}return n}function g(m,f){f==e&&(f=new ps);var c=m.split(/\s+/);return c=c.map(j),f.set(c[0]||0,c[1]||0,c[2]||0),f}var q,W,T,o,Z,t=function(z,h){q||(q=new Xd,W=new ps,T=new Xd,o=new Xd,Z=new Xd),h==e&&(h=new Xd);var k=getComputedStyle(z);k.transform&&"none"!==k.transform&&(l(k.transform,q),g(k.transformOrigin,W),o.setPosition(W),W.negate(),Z.setPosition(W),(Yi||"preserve-3d"!==k.transformStyle)&&(q.el[8]=0,q.el[9]=0,q.el[10]=1,q.el[11]=0),h.multiplyMatrices(Z,h),h.multiplyMatrices(q,h),h.multiplyMatrices(o,h)),!Yi&&k.perspective&&"none"!==k.perspective&&(T.el[11]=-1/j(k.perspective),g(k.perspectiveOrigin,W),o.setPosition(W),W.negate(),Z.setPosition(W),h.multiplyMatrices(Z,h),h.multiplyMatrices(T,h),h.multiplyMatrices(o,h));for(var Y=z.offsetParent,O=z.offsetLeft,y=z.offsetTop,J=z.parentElement;J&&J!==Y;){var I=getComputedStyle(J);if("none"!==I.transform||"none"!==I.perspective)break;J=J.parentElement}return J==e&&z!==z.ownerDocument.documentElement&&"fixed"!==k.position&&(J=z.ownerDocument.documentElement),Y!=e&&Y!==J&&(O-=J.offsetLeft,y-=J.offsetTop),W.set(O,y,0),o.setPosition(W),h.multiplyMatrices(o,h),J&&t(J,h),h};return function(E,W){var Y=E.parentElement;if(Y){var N=Y.updateAppendMatrix;if(N){delete Y.updateAppendMatrix;var x=new Xd;t(Y,x);var y=new Xd;y.getInverse(x),Y._matrixAppend=y,Y._maxrixPreAppend=x}return W?Y._matrixAppend:Y._maxrixPreAppend}}}(),$d=function(I,B){for(;I&&!I.hasOwnProperty(B);)I=N.getPrototypeOf(I);return I&&N.getOwnPropertyDescriptor(I,B)},gb=N.getPrototypeOf?function(x,G,J){var X=$d(G,J);X&&N.defineProperty(x,J,X)}:function(q,c,Z){q[Z]=c[Z]},sr={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ne=function(){var D={1:function(H,m){return{x:H.x-m.width/2,y:H.y-m.height/2}},2:function(n,g){return{x:n.x+g.width/2,y:n.y-g.height/2}},3:function(w,O){return{x:w.x+w.width/2,y:w.y-O.height/2}},4:function(G,q){return{x:G.x+G.width-q.width/2,y:G.y-q.height/2}},5:function(n,O){return{x:n.x+n.width+O.width/2,y:n.y-O.height/2}},6:function(i){return{x:i.x,y:i.y}},7:function(f){return{x:f.x+f.width/2,y:f.y}},8:function(Y){return{x:Y.x+Y.width,y:Y.y}},9:function(T,z){return{x:T.x-z.width/2,y:T.y+z.height/2}},10:function(n,x){return{x:n.x+x.width/2,y:n.y+x.height/2}},11:function(i,s){return{x:i.x+i.width/2,y:i.y+s.height/2}},12:function(a,y){return{x:a.x-y.width/2+a.width,y:a.y+y.height/2}},13:function(r,z){return{x:r.x+r.width+z.width/2,y:r.y+z.height/2}},14:function(t,Y){return{x:t.x-Y.width/2,y:t.y+t.height/2}},15:function(j){return{x:j.x,y:j.y+j.height/2}},16:function(c,j){return{x:c.x+j.width/2,y:c.y+c.height/2}},17:function(N){return{x:N.x+N.width/2,y:N.y+N.height/2}},18:function(T,_){return{x:T.x+T.width-_.width/2,y:T.y+T.height/2}},19:function(Q){return{x:Q.x+Q.width,y:Q.y+Q.height/2}},20:function(c,X){return{x:c.x+c.width+X.width/2,y:c.y+c.height/2}},21:function(M,b){return{x:M.x-b.width/2,y:M.y+M.height-b.height/2}},22:function(Y,b){return{x:Y.x+b.width/2,y:Y.y+Y.height-b.height/2}},23:function(Z,V){return{x:Z.x+Z.width/2,y:Z.y+Z.height-V.height/2}},24:function(f,F){return{x:f.x+f.width-F.width/2,y:f.y+f.height-F.height/2}},25:function(v,s){return{x:v.x+v.width+s.width/2,y:v.y+v.height-s.height/2}},26:function(B){return{x:B.x,y:B.y+B.height}},27:function(b){return{x:b.x+b.width/2,y:b.y+b.height}},28:function(T){return{x:T.x+T.width,y:T.y+T.height}},29:function(u,m){return{x:u.x-m.width/2,y:u.y+u.height+m.height/2}},30:function(i,d){return{x:i.x+d.width/2,y:i.y+i.height+d.height/2}},31:function(D,J){return{x:D.x+D.width/2,y:D.y+D.height+J.height/2}},32:function(g,U){return{x:g.x+g.width-U.width/2,y:g.y+g.height+U.height/2}},33:function(e,M){return{x:e.x+e.width+M.width/2,y:e.y+e.height+M.height/2}},34:function(B,H){return{x:B.x,y:B.y-H.height/2}},35:function(k,c){return{x:k.x+k.width,y:k.y-c.height/2}},36:function(F,e){return{x:F.x,y:F.y+F.height+e.height/2}},37:function(S,r){return{x:S.x+S.width,y:S.y+S.height+r.height/2}},38:function(q,d){return{x:q.x+q.width/4,y:q.y-d.height/2}},39:function(n,Q){return{x:n.x+3*n.width/4,y:n.y-Q.height/2}},40:function(q){return{x:q.x+q.width/4,y:q.y}},41:function(Q){return{x:Q.x+3*Q.width/4,y:Q.y}},42:function(H,$){return{x:H.x+H.width/4,y:H.y+$.height/2}},43:function(I,u){return{x:I.x+3*I.width/4,y:I.y+u.height/2}},44:function(H,T){return{x:H.x+H.width/2,y:H.y+H.height/2-T.height/2}},45:function(Q){return{x:Q.x+Q.width/4,y:Q.y+Q.height/2}},46:function(V,z){return{x:V.x+V.width/2-z.width/2,y:V.y+V.height/2}},47:function(w,o){return{x:w.x+w.width/2+o.width/2,y:w.y+w.height/2}},48:function(n){return{x:n.x+3*n.width/4,y:n.y+n.height/2}},49:function(w,U){return{x:w.x+w.width/2,y:w.y+w.height/2+U.height/2}},50:function(c,y){return{x:c.x+c.width/4,y:c.y+c.height-y.height/2}},51:function(S,l){return{x:S.x+3*S.width/4,y:S.y+S.height-l.height/2}},52:function($){return{x:$.x+$.width/4,y:$.y+$.height}},53:function(W){return{x:W.x+3*W.width/4,y:W.y+W.height}},54:function(b,Q){return{x:b.x+b.width/4,y:b.y+b.height+Q.height/2}},55:function(K,V){return{x:K.x+3*K.width/4,y:K.y+K.height+V.height/2}}};return sb(_)?function(J,c,$){return D[J](c,$?$:on)}:void 0}();Ec(p,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Mk=p.reverse,ze=p.transparent,Ng=p.rectSelectBackground,xf=p.dash,He=p.titleBackground,br=p.titleIconBackground,In=p.headerBackground,Aq=p.headerIconBackground,Jr=p.headerSeparator,Sn=p.headerLine,ne=p.contentIconBackground,Cn=p.contentLine,uc=(p.widgetIconHighlight,p.widgetIconBorder),Cr=(p.widgetIconGradient,p.imageBackground),Hp=p.imageGradient,Zr=p.highlight,Nd=p.label,Hl=p.labelSelect;if(K&&!_.shutAlert1){var bd=new Date,kg=K.split("-"),fe=new Date(bd.getFullYear(),bd.getMonth(),bd.getDate()),K=new Date(y(kg[0],10),y(kg[1],10)-1,y(kg[2],10)),yr=fe.getTime(),_h=K.getTime(),og=h+"_try",ti=_.alert;try{var _l=_.localStorage;if(_l&&ti)if(_h>yr&&1728e6>_h-yr){var jh=(_h-yr)/864e5;_l&&_l[og]!=jh&&(_l[og]=jh,_.htWillExpire?ti(_.htWillExpire.replace("{{day}}",jh)):ti("HT for Web free trial license will expire in "+jh+" days, please apply for a new license!"))}else yr>=_h&&(_.htExpired?ti(_.htExpired):ti("Your free trial of HT for Web has expired!")),_l&&delete _l[og]}catch(zf){}}Math.sign===e&&(Math.sign=function(j){return 0>j?-1:j>0?1:+j});var jj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ui={encode:function(M,u){var b,F,H,T,o,w,k,e="",S=0;for(M=ui._utf8_encode(M);S<M.length;)b=M.charCodeAt(S++),F=M.charCodeAt(S++),H=M.charCodeAt(S++),T=b>>2,o=(3&b)<<4|F>>4,w=(15&F)<<2|H>>6,k=63&H,isNaN(F)?w=k=64:isNaN(H)&&(k=64),e=e+u.charAt(T)+u.charAt(o)+u.charAt(w)+u.charAt(k);return e},decode:function(Q,K){var P,D,A,T,O,M,b,W="",S=0;for(Q=Q.replace(/[^A-Za-z0-9\+\/\=]/g,"");S<Q.length;)T=K.indexOf(Q.charAt(S++)),O=K.indexOf(Q.charAt(S++)),M=K.indexOf(Q.charAt(S++)),b=K.indexOf(Q.charAt(S++)),P=T<<2|O>>4,D=(15&O)<<4|M>>2,A=(3&M)<<6|b,W+=String.fromCharCode(P),64!=M&&(W+=String.fromCharCode(D)),64!=b&&(W+=String.fromCharCode(A));return W=ui._utf8_decode(W)},_utf8_encode:function(i){i=i.replace(/\r\n/g,"\n");for(var H="",Z=0;Z<i.length;Z++){var m=i.charCodeAt(Z);128>m?H+=String.fromCharCode(m):m>127&&2048>m?(H+=String.fromCharCode(192|m>>6),H+=String.fromCharCode(128|63&m)):(H+=String.fromCharCode(224|m>>12),H+=String.fromCharCode(128|63&m>>6),H+=String.fromCharCode(128|63&m))}return H},_utf8_decode:function(c){for(var t="",W=0,G=0,O=0,s=0;W<c.length;)G=c.charCodeAt(W),128>G?(t+=String.fromCharCode(G),W++):G>191&&224>G?(O=c.charCodeAt(W+1),t+=String.fromCharCode((31&G)<<6|63&O),W+=2):(O=c.charCodeAt(W+1),s=c.charCodeAt(W+2),t+=String.fromCharCode((15&G)<<12|(63&O)<<6|63&s),W+=3);return t}},Gc=[],Ud=[],Lh=P.Math={generateUUID:function(){for(var b=[],K=0;256>K;K++)b[K]=(16>K?"0":"")+K.toString(16).toUpperCase();return function(){var e=0|4294967295*Math.random(),K=0|4294967295*Math.random(),L=0|4294967295*Math.random(),u=0|4294967295*Math.random();return b[255&e]+b[255&e>>8]+b[255&e>>16]+b[255&e>>24]+"-"+b[255&K]+b[255&K>>8]+"-"+b[64|15&K>>16]+b[255&K>>24]+"-"+b[128|63&L]+b[255&L>>8]+"-"+b[255&L>>16]+b[255&L>>24]+b[255&u]+b[255&u>>8]+b[255&u>>16]+b[255&u>>24]}}(),clamp:function(j,p,u){return Math.max(p,Math.min(u,j))},generateIncreasingID:function(){var q=0;return function(){return++q}}(),encodeBase64:function(b,i){return ui.encode(b,i||jj)},decodeBase64:function(T,b){return ui.decode(T,b||jj)},randomArray:function(R,M){M=M||R.length;for(var x=M-1;x>0;x--){var Q=Math.floor(Math.random()*(x+1)),f=R[x];R[x]=R[Q],R[Q]=f}return R},isPOT:function(C){return C>0&&0===(C-1&C)},nearestPOT:function(b){if(!b)return 1;var P=b;P--,P|=P>>1,P|=P>>2,P|=P>>4,P|=P>>8,P|=P>>16,P++;var N=P>>1;return b-N>P-b?P:N},requestMatrix4:function(){return Gc.length>0?Gc.pop():new Lh.Matrix4},releaseMatrix4:function(F){Gc.push(F)},requestVector3:function(){return Ud.length>0?Ud.pop():new Lh.Vector3},releaseVector3:function(y){Ud.push(y)}},Jq=P.Matrix=P.Math.Matrix2d=function(Z,I,G,e,O){this.setFromTransform(Z,I,G,e,O)},md=Jq;Jq.prototype={},Jq.prototype.constructor=Jq,Jq.prototype.set=function(Y,n,J,$,h,W){return this.a=Y,this.b=n,this.c=J,this.d=$,this.tx=h,this.ty=W,this},Jq.prototype.setFromTransform=function(L,g,q,Z,H){var f=this;if(L===e)return f.a=1,f.b=0,f.c=0,f.d=1,f.tx=0,f.ty=0,void 0;L=L||0;var Q=j(L),C=E(L);return Z=Z||1,H=H||1,f.a=C*Z,f.b=Q*Z,f.c=-Q*H,f.d=C*H,f.tx=g||0,f.ty=q||0,f},Jq.prototype.apply=function(h,j){j=j||new $j;var D=h.x,I=h.y;return j.x=this.a*D+this.c*I+this.tx,j.y=this.b*D+this.d*I+this.ty,j},Jq.prototype.applyInverse=function(b,A){A=A||new $j;var Q=1/(this.a*this.d+this.c*-this.b),n=b.x,X=b.y;return A.x=this.d*Q*n+-this.c*Q*X+(this.ty*this.c-this.tx*this.d)*Q,A.y=this.a*Q*X+-this.b*Q*n+(-this.ty*this.a+this.tx*this.b)*Q,A},Jq.prototype.translate=function(f,m){return this.tx+=f,this.ty+=m,this},Jq.prototype.scale=function(O,N){return this.a*=O,this.d*=N,this.c*=O,this.b*=N,this.tx*=O,this.ty*=N,this},Jq.prototype.rotate=function(Y){var E=Math.cos(Y),f=Math.sin(Y),d=this.a,S=this.c,b=this.tx;return this.a=d*E-this.b*f,this.b=d*f+this.b*E,this.c=S*E-this.d*f,this.d=S*f+this.d*E,this.tx=b*E-this.ty*f,this.ty=b*f+this.ty*E,this},Jq.prototype.appendTranslate=function(C,u){return this.tx+=this.a*C+this.c*u,this.ty+=this.b*C+this.d*u,this},Jq.prototype.appendScale=function(U,e){return this.a*=U,this.d*=e,this.c*=e,this.b*=U,this},Jq.prototype.appendRotate=function(H){if(!H)return this;var k=Math.cos(H),x=Math.sin(H),J=this.a,L=this.b;return this.a=J*k+this.c*x,this.b=L*k+this.d*x,this.c=-J*x+this.c*k,this.d=-L*x+this.d*k,this},Jq.prototype.append=function(h){var U=this.a,d=this.b,V=this.c,D=this.d;return this.a=h.a*U+h.b*V,this.b=h.a*d+h.b*D,this.c=h.c*U+h.d*V,this.d=h.c*d+h.d*D,this.tx=h.tx*U+h.ty*V+this.tx,this.ty=h.tx*d+h.ty*D+this.ty,this},Jq.prototype.setTransform=function(d,D,c,T,k,f,R,i,U){var q,G,Y,h,n,x,Q,t,X,O;return n=Math.sin(R),x=Math.cos(R),Q=Math.cos(U),t=Math.sin(U),X=-Math.sin(i),O=Math.cos(i),q=x*k,G=n*k,Y=-n*f,h=x*f,this.a=Q*q+t*Y,this.b=Q*G+t*h,this.c=X*q+O*Y,this.d=X*G+O*h,this.tx=d+(c*q+T*Y),this.ty=D+(c*G+T*h),this},Jq.prototype.prepend=function(T){var P=this.tx;if(1!==T.a||0!==T.b||0!==T.c||1!==T.d){var c=this.a,p=this.c;this.a=c*T.a+this.b*T.c,this.b=c*T.b+this.b*T.d,this.c=p*T.a+this.d*T.c,this.d=p*T.b+this.d*T.d}return this.tx=P*T.a+this.ty*T.c+T.tx,this.ty=P*T.b+this.ty*T.d+T.ty,this},Jq.prototype.transform=Jq.prototype.prepend,Jq.prototype.invert=function(){var A=this.a,e=this.b,d=this.c,F=this.d,v=this.tx,Y=A*F-e*d;return this.a=F/Y,this.b=-e/Y,this.c=-d/Y,this.d=A/Y,this.tx=(d*this.ty-F*v)/Y,this.ty=-(A*this.ty-e*v)/Y,this},Jq.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Jq.prototype.clone=function(){var F=new Jq;return F.a=this.a,F.b=this.b,F.c=this.c,F.d=this.d,F.tx=this.tx,F.ty=this.ty,F},Jq.prototype.copy=function(L){return L.a=this.a,L.b=this.b,L.c=this.c,L.d=this.d,L.tx=this.tx,L.ty=this.ty,L},Jq.prototype.tf=function(p,J){1===arguments.length&&(J=p.y,p=p.x);var L=this;return{x:L.a*p+L.c*J+L.tx,y:L.b*p+L.d*J+L.ty}},Jq.prototype.tfi=function(S,e){1===arguments.length&&(e=S.y,S=S.x);var n=this,f=1/(n.a*n.d+n.c*-n.b);return{x:n.d*f*S+-n.c*f*e+(n.ty*n.c-n.tx*n.d)*f,y:n.a*f*e+-n.b*f*S+(-n.ty*n.a+n.tx*n.b)*f}},Jq.IDENTITY=new Jq,Jq.TEMP_MATRIX=new Jq;var Ep=P.Math.Quaternion=function(_,i,H,K){this.set(_,i,H,K)};N.assign(Ep.prototype,{set:function($,N,j,r){var o=this;return o._x=$||0,o._y=N||0,o._z=j||0,o._w=r!==e?r:1,o},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(K){var m=this;return m._x=K._x,m._y=K._y,m._z=K._z,m._w=K._w,m},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(V){return this._x*V._x+this._y*V._y+this._z*V._z+this._w*V._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var V=this.length();return 0===V?(this._x=0,this._y=0,this._z=0,this._w=1):(V=1/V,this._x=this._x*V,this._y=this._y*V,this._z=this._z*V,this._w=this._w*V),this},fromArray:function(Z,F){F===e&&(F=0);var A=this;return A._x=Z[F],A._y=Z[F+1],A._z=Z[F+2],A._w=Z[F+3],this},slerp:function(E,e){if(0===e)return this;if(1===e)return this.copy(E);var d=this._x,C=this._y,q=this._z,i=this._w,P=i*E._w+d*E._x+C*E._y+q*E._z;if(0>P?(this._w=-E._w,this._x=-E._x,this._y=-E._y,this._z=-E._z,P=-P):this.copy(E),P>=1)return this._w=i,this._x=d,this._y=C,this._z=q,this;var l=Math.sqrt(1-P*P);if(Math.abs(l)<.001)return this._w=.5*(i+this._w),this._x=.5*(d+this._x),this._y=.5*(C+this._y),this._z=.5*(q+this._z),this;var I=Math.atan2(l,P),R=Math.sin((1-e)*I)/l,T=Math.sin(e*I)/l;return this._w=i*R+this._w*T,this._x=d*R+this._x*T,this._y=C*R+this._y*T,this._z=q*R+this._z*T,this},setFromAxisAngle:function(p,e){var v=e/2,h=Math.sin(v);return this._x=p.x*h,this._y=p.y*h,this._z=p.z*h,this._w=Math.cos(v),this},setFromEuler:function(h){var z=h._x,A=h._y,f=h._z,R=h._order,Y=Math.cos,g=Math.sin,t=Y(z/2),Q=Y(A/2),J=Y(f/2),W=g(z/2),l=g(A/2),n=g(f/2);return"XYZ"===R?(this._x=W*Q*J+t*l*n,this._y=t*l*J-W*Q*n,this._z=t*Q*n+W*l*J,this._w=t*Q*J-W*l*n):"YXZ"===R?(this._x=W*Q*J+t*l*n,this._y=t*l*J-W*Q*n,this._z=t*Q*n-W*l*J,this._w=t*Q*J+W*l*n):"ZXY"===R?(this._x=W*Q*J-t*l*n,this._y=t*l*J+W*Q*n,this._z=t*Q*n+W*l*J,this._w=t*Q*J-W*l*n):"ZYX"===R?(this._x=W*Q*J-t*l*n,this._y=t*l*J+W*Q*n,this._z=t*Q*n-W*l*J,this._w=t*Q*J+W*l*n):"YZX"===R?(this._x=W*Q*J+t*l*n,this._y=t*l*J+W*Q*n,this._z=t*Q*n-W*l*J,this._w=t*Q*J-W*l*n):"XZY"===R&&(this._x=W*Q*J-t*l*n,this._y=t*l*J-W*Q*n,this._z=t*Q*n+W*l*J,this._w=t*Q*J+W*l*n),this},setFromRotationMatrix:function(T){var S,$=T.el,m=$[0],h=$[4],a=$[8],o=$[1],P=$[5],z=$[9],i=$[2],l=$[6],x=$[10],A=m+P+x;return A>0?(S=.5/Math.sqrt(A+1),this._w=.25/S,this._x=(l-z)*S,this._y=(a-i)*S,this._z=(o-h)*S):m>P&&m>x?(S=2*Math.sqrt(1+m-P-x),this._w=(l-z)/S,this._x=.25*S,this._y=(h+o)/S,this._z=(a+i)/S):P>x?(S=2*Math.sqrt(1+P-m-x),this._w=(a-i)/S,this._x=(h+o)/S,this._y=.25*S,this._z=(z+l)/S):(S=2*Math.sqrt(1+x-m-P),this._w=(o-h)/S,this._x=(a+i)/S,this._y=(z+l)/S,this._z=.25*S),this},setFromToVectors:function(){var y,_;return function(V,o){return y===e&&(y=new ps),_=V.dot(o)+1,1e-7>_?(_=0,Math.abs(V.x)>Math.abs(V.z)?y.set(-V.y,V.x,0):y.set(0,-V.z,V.y)):y.crossVectors(V,o),this._x=y.x,this._y=y.y,this._z=y.z,this._w=_,this.normalize()}}(),setFromUnitVectors:function(){var i,W,D=1e-6;return function(N,g){return i===e&&(i=new ps),W=N.dot(g)+1,D>W?(W=0,Math.abs(N.x)>Math.abs(N.z)?i.set(-N.y,N.x,0):i.set(0,-N.z,N.y)):i.crossVectors(N,g),this._x=i.x,this._y=i.y,this._z=i.z,this._w=W,this.normalize()}}(),multiply:function(w){return this.multiplyQuaternions(this,w)},premultiply:function(Q){return this.multiplyQuaternions(Q,this)},multiplyQuaternions:function(f,O){var E=f._x,s=f._y,V=f._z,e=f._w,G=O._x,w=O._y,I=O._z,L=O._w;return this._x=E*L+e*G+s*I-V*w,this._y=s*L+e*w+V*G-E*I,this._z=V*L+e*I+E*w-s*G,this._w=e*L-E*G-s*w-V*I,this}});var cq=P.Math.Vector4=function(b,R,i,S){this.x=b||0,this.y=R||0,this.z=i||0,this.w=S!==e?S:1};N.assign(cq.prototype,{isVector4:!0,set:function(r,D,E,y){return this.x=r,this.y=D,this.z=E,this.w=y,this},setScalar:function(z){return this.x=z,this.y=z,this.z=z,this.w=z,this},setX:function(b){return this.x=b,this},setY:function(B){return this.y=B,this},setZ:function(r){return this.z=r,this},setW:function(x){return this.w=x,this},setComponent:function(W,X){switch(W){case 0:this.x=X;break;case 1:this.y=X;break;case 2:this.z=X;break;case 3:this.w=X;break;default:throw new Error("index is out of range: "+W)}return this},getComponent:function(x){switch(x){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+x)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w!==e?n.w:1,this},add:function(N,u){return u!==e?this.addVectors(N,u):(this.x+=N.x,this.y+=N.y,this.z+=N.z,this.w+=N.w,this)},addScalar:function(N){return this.x+=N,this.y+=N,this.z+=N,this.w+=N,this},addVectors:function(s,Q){return this.x=s.x+Q.x,this.y=s.y+Q.y,this.z=s.z+Q.z,this.w=s.w+Q.w,this},addScaledVector:function(C,W){return this.x+=C.x*W,this.y+=C.y*W,this.z+=C.z*W,this.w+=C.w*W,this},sub:function(O,U){return U!==e?this.subVectors(O,U):(this.x-=O.x,this.y-=O.y,this.z-=O.z,this.w-=O.w,this)},subScalar:function(Q){return this.x-=Q,this.y-=Q,this.z-=Q,this.w-=Q,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this.z=e.z-o.z,this.w=e.w-o.w,this},multiplyScalar:function(z){return this.x*=z,this.y*=z,this.z*=z,this.w*=z,this},applyMatrix4:function(j){var a=this.x,D=this.y,I=this.z,_=this.w,d=j.el;return this.x=d[0]*a+d[4]*D+d[8]*I+d[12]*_,this.y=d[1]*a+d[5]*D+d[9]*I+d[13]*_,this.z=d[2]*a+d[6]*D+d[10]*I+d[14]*_,this.w=d[3]*a+d[7]*D+d[11]*I+d[15]*_,this},divideScalar:function(P){return this.multiplyScalar(1/P)},setAxisAngleFromQuaternion:function($){this.w=2*Math.acos($.w);var k=Math.sqrt(1-$.w*$.w);return 1e-4>k?(this.x=1,this.y=0,this.z=0):(this.x=$.x/k,this.y=$.y/k,this.z=$.z/k),this},setAxisAngleFromRotationMatrix:function(n){var l,X,W,Z,J=.01,K=.1,C=n.el,t=C[0],A=C[4],D=C[8],p=C[1],O=C[5],c=C[9],B=C[2],m=C[6],i=C[10];if(Math.abs(A-p)<J&&Math.abs(D-B)<J&&Math.abs(c-m)<J){if(Math.abs(A+p)<K&&Math.abs(D+B)<K&&Math.abs(c+m)<K&&Math.abs(t+O+i-3)<K)return this.set(1,0,0,0),this;l=Math.PI;var o=(t+1)/2,b=(O+1)/2,f=(i+1)/2,x=(A+p)/4,U=(D+B)/4,F=(c+m)/4;return o>b&&o>f?J>o?(X=0,W=.707106781,Z=.707106781):(X=Math.sqrt(o),W=x/X,Z=U/X):b>f?J>b?(X=.707106781,W=0,Z=.707106781):(W=Math.sqrt(b),X=x/W,Z=F/W):J>f?(X=.707106781,W=.707106781,Z=0):(Z=Math.sqrt(f),X=U/Z,W=F/Z),this.set(X,W,Z,l),this}var T=Math.sqrt((m-c)*(m-c)+(D-B)*(D-B)+(p-A)*(p-A));return Math.abs(T)<.001&&(T=1),this.x=(m-c)/T,this.y=(D-B)/T,this.z=(p-A)/T,this.w=Math.acos((t+O+i-1)/2),this},min:function(P){return this.x=Math.min(this.x,P.x),this.y=Math.min(this.y,P.y),this.z=Math.min(this.z,P.z),this.w=Math.min(this.w,P.w),this},max:function(b){return this.x=Math.max(this.x,b.x),this.y=Math.max(this.y,b.y),this.z=Math.max(this.z,b.z),this.w=Math.max(this.w,b.w),this},clamp:function(b,e){return this.x=Math.max(b.x,Math.min(e.x,this.x)),this.y=Math.max(b.y,Math.min(e.y,this.y)),this.z=Math.max(b.z,Math.min(e.z,this.z)),this.w=Math.max(b.w,Math.min(e.w,this.w)),this},clampScalar:function(){var N,A;return function(u,C){return N===e&&(N=new cq,A=new cq),N.set(u,u,u,u),A.set(C,C,C,C),this.clamp(N,A)}}(),clampLength:function(z,l){var d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(z,Math.min(l,d)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(y){return this.x*y.x+this.y*y.y+this.z*y.z+this.w*y.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(J){return this.normalize().multiplyScalar(J)},lerp:function(z,y){return this.x+=(z.x-this.x)*y,this.y+=(z.y-this.y)*y,this.z+=(z.z-this.z)*y,this.w+=(z.w-this.w)*y,this},lerpVectors:function(x,Z,G){return this.subVectors(Z,x).multiplyScalar(G).add(x)},equals:function(X){return X.x===this.x&&X.y===this.y&&X.z===this.z&&X.w===this.w},fromArray:function(G,s){return s===e&&(s=0),this.x=G[s],this.y=G[s+1],this.z=G[s+2],this.w=G[s+3],this},toArray:function(a,t){return a===e&&(a=[]),t===e&&(t=0),a[t]=this.x,a[t+1]=this.y,a[t+2]=this.z,a[t+3]=this.w,a},fromBufferAttribute:function(k,W){return this.x=k.getX(W),this.y=k.getY(W),this.z=k.getZ(W),this.w=k.getW(W),this}});var ps=P.Math.Vector3=function(k,L,H){k===e?(this.x=0,this.y=0,this.z=0):"object"==typeof k?this.copy(k):this.set(k,L==e?k:L,H==e?k:H)};N.assign(ps.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(u,F,o){return this.x=u,this.y=F,this.z=o,this},equals:function(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z},setScalar:function(I){return this.x=I,this.y=I,this.z=I,this},setX:function(A){return this.x=A,this},setY:function(j){return this.y=j,this},setZ:function(t){return this.z=t,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(l){return l.x===e?(this.x=l[0],this.y=l[1],this.z=l[2]):(this.x=l.x,this.y=l.y,this.z=l.z||0),this},add:function(V){return this.x+=V.x,this.y+=V.y,this.z+=V.z,this},addScalar:function(L){return this.x+=L,this.y+=L,this.z+=L,this},addVectors:function(u,s){return this.x=u.x+s.x,this.y=u.y+s.y,this.z=u.z+s.z,this},addScaledVector:function(z,R){return this.x+=z.x*R,this.y+=z.y*R,this.z+=z.z*R,this},sub:function(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this},subScalar:function(Y){return this.x-=Y,this.y-=Y,this.z-=Y,this},subVectors:function(j,v){return this.x=j.x-v.x,this.y=j.y-v.y,this.z=j.z-v.z,this},divide:function(x){return this.x/=x.x,this.y/=x.y,this.z/=x.z,this},multiply:function(S){return this.x*=S.x,this.y*=S.y,this.z*=S.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(v){var H=this.x-v.x,W=this.y-v.y,Y=this.z-v.z;return H*H+W*W+Y*Y},distanceToSquared2:function(E){var g=this.x-E[0],p=this.y-E[1],l=this.z-E[2];return g*g+p*p+l*l},divideVectors:function(u,s){return this.x=u.x/s.x,this.y=u.y/s.y,this.z=u.z/s.z,this},multiplyVectors:function(n,f){return this.x=n.x*f.x,this.y=n.y*f.y,this.z=n.z*f.z,this},transformDirection:function(N){var T=this.x,y=this.y,I=this.z,a=N.el;return this.x=a[0]*T+a[4]*y+a[8]*I,this.y=a[1]*T+a[5]*y+a[9]*I,this.z=a[2]*T+a[6]*y+a[10]*I,this.normalize()},applyAxisAngle:function(){var F=new Ep;return function($,N){return this.applyQuaternion(F.setFromAxisAngle($,N))}}(),applyEuler:function(){var q=new Ep;return function(y){return this.applyQuaternion(q.setFromEuler(y))}}(),applyQuaternion:function(l){var D=this.x,u=this.y,Z=this.z,N=l._x,c=l._y,m=l._z,W=l._w,R=W*D+c*Z-m*u,k=W*u+m*D-N*Z,T=W*Z+N*u-c*D,v=-N*D-c*u-m*Z;return this.x=R*W+v*-N+k*-m-T*-c,this.y=k*W+v*-c+T*-N-R*-m,this.z=T*W+v*-m+R*-c-k*-N,this},applyMatrix4:function(Y){var i=this.x,t=this.y,q=this.z,Z=Y.el,j=1/(Z[3]*i+Z[7]*t+Z[11]*q+Z[15]);return this.x=(Z[0]*i+Z[4]*t+Z[8]*q+Z[12])*j,this.y=(Z[1]*i+Z[5]*t+Z[9]*q+Z[13])*j,this.z=(Z[2]*i+Z[6]*t+Z[10]*q+Z[14])*j,this},applyMatrix3:function(a){var e=this.x,K=this.y,g=this.z,A=a.el;return this.x=A[0]*e+A[3]*K+A[6]*g,this.y=A[1]*e+A[4]*K+A[7]*g,this.z=A[2]*e+A[5]*K+A[8]*g,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var X=new ps;return function(x){return this.sub(X.copy(x).multiplyScalar(2*this.dot(x)))}}(),dot:function(M){return this.x*M.x+this.y*M.y+this.z*M.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var t=this.length();
return t?this.multiplyScalar(1/t):this},setLength:function(U){return this.normalize().multiplyScalar(U)},fromArray:function(M,y){return y===e&&(y=0),this.x=M[y],this.y=M[y+1],this.z=M[y+2],this},toArray:function(q,N){return q===e&&(q=[0,0,0]),N===e&&(N=0),q[N]=this.x,q[N+1]=this.y,q[N+2]=this.z,q},cross:function(F){return this.crossVectors(this,F)},angleTo:function(i){var z=this.dot(i)/Math.sqrt(this.lengthSq()*i.lengthSq());return z>1||-1>z?0:Math.acos(z)},lerp:function(N,H){return this.x+=(N.x-this.x)*H,this.y+=(N.y-this.y)*H,this.z+=(N.z-this.z)*H,this},lerpVectors:function(g,V,r){return this.subVectors(V,g).multiplyScalar(r).add(g)},crossVectors:function(z,A){var m=z.x,H=z.y,T=z.z,M=A.x,w=A.y,b=A.z;return this.x=H*b-T*w,this.y=T*M-m*b,this.z=m*w-H*M,this},min:function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this},max:function(m){return this.x=Math.max(this.x,m.x),this.y=Math.max(this.y,m.y),this.z=Math.max(this.z,m.z),this},setFromMatrixPosition:function(d){return this.setFromMatrixColumn(d,3)},setFromMatrixScale:function(t){var G=this.setFromMatrixColumn(t,0).length(),m=this.setFromMatrixColumn(t,1).length(),Z=this.setFromMatrixColumn(t,2).length();return this.x=G,this.y=m,this.z=Z,this},setFromMatrixColumn:function(P,e){return this.fromArray(P.el,4*e)}});var $j=P.Math.Vector2=function(r,R,d){"object"==typeof r&&(r.x!=e?(R=r.y,r=r.x,d=r.e):(d=r[2],R=r[1],r=r[0])),this.set(r||0,R||0,d)};$j.prototype={},$j.prototype.constructor=$j,N.defineProperties($j.prototype,{width:{get:function(){return this.x},set:function(Y){this.x=Y}},height:{get:function(){return this.y},set:function(H){this.y=H}}}),$j.prototype.clone=function(){return new $j(this.x,this.y,this.e)},$j.prototype.copy=function(b){return this.set(b.x,b.y,b.e),this},$j.prototype.equals=function(x){return x.x===this.x&&x.y===this.y},$j.prototype.set=function(J,K,_){return this.x=J||0,this.y=K||(0!==K?this.x:0),_!=e&&(this.e=_),this},$j.prototype.setScalar=function(l){return this.x=l,this.y=l,this},$j.prototype.setX=function(Y){return this.x=Y||0,this},$j.prototype.setY=function(y){return this.y=y||0,this},$j.prototype.add=function(q){return this.x+=q.x,this.y+=q.y,this},$j.prototype.addVectors=function(E,i){return this.x=E.x+i.x,this.y=E.y+i.y,this},$j.prototype.addScalar=function(n){return this.x+=n,this.y+=n,this},$j.prototype.addScaledVector=function(z,r){return this.x+=z.x*r,this.y+=z.y*r,this},$j.prototype.sub=function(U){return this.x-=U.x,this.y-=U.y,this},$j.prototype.subScalar=function(Y){return this.x-=Y,this.y-=Y,this},$j.prototype.subVectors=function(R,T){return this.x=R.x-T.x,this.y=R.y-T.y,this},$j.prototype.multiply=function(G){return this.x*=G.x,this.y*=G.y,this},$j.prototype.multiplyScalar=function(U){return this.x*=U,this.y*=U,this},$j.prototype.divide=function(n){return this.x/=n.x,this.y/=n.y,this},$j.prototype.divideScalar=function(F){return this.multiplyScalar(1/F)},$j.prototype.min=function(Y){return this.x=Math.min(this.x,Y.x),this.y=Math.min(this.y,Y.y),this},$j.prototype.max=function(z){return this.x=Math.max(this.x,z.x),this.y=Math.max(this.y,z.y),this},$j.prototype.fromArray=function(n,$){return $===e&&($=0),this.x=n[$],this.y=n[$+1],this},$j.prototype.clamp=function(c,K){return this.x=Math.max(c.x,Math.min(K.x,this.x)),this.y=Math.max(c.y,Math.min(K.y,this.y)),this},$j.prototype.clampScalar=function(){var U,q;return function(H,L){return U===e&&(U=new $j,q=new $j),U.set(H,H),q.set(L,L),this.clamp(U,q)}}(),$j.prototype.clampLength=function(r,Y){var x=this.length();return this.multiplyScalar(Math.max(r,Math.min(Y,x))/x)},$j.prototype.dot=function(R){return this.x*R.x+this.y*R.y},$j.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},$j.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},$j.prototype.normalize=function(){return this.divideScalar(this.length())},$j.prototype.angle=function(){var J=Math.atan2(this.y,this.x);return 0>J&&(J+=2*Math.PI),J},$j.prototype.distanceTo=function(n){return Math.sqrt(this.distanceToSquared(n))},$j.prototype.distanceToSquared=function(G){var U=this.x-G.x,D=this.y-G.y;return U*U+D*D},$j.prototype.isNearEnough=function(J){return this.distanceToSquared(J)<1e-8},$j.prototype.setLength=function(q){var E=this.length();return E?this.multiplyScalar(q/E):this},$j.prototype.lerp=function(X,T){return this.x+=(X.x-this.x)*T,this.y+=(X.y-this.y)*T,this},$j.prototype.lerpVectors=function(g,D,l){return this.subVectors(D,g).multiplyScalar(l).add(g)},$j.prototype.rotateAround=function(w,d){var N=w?w.x:0,o=w?w.y:0,Q=Math.cos(d),F=Math.sin(d),Z=this.x-N,b=this.y-o;return this.x=Z*Q-b*F+N,this.y=Z*F+b*Q+o,this},N.assign(Q.prototype,{isMatrix3:!0,set:function(I,H,L,n,P,g,e,U,z){var r=this.el;return r[0]=I,r[1]=n,r[2]=e,r[3]=H,r[4]=P,r[5]=U,r[6]=L,r[7]=g,r[8]=z,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(z){var h=this.el,x=z.el;return h[0]=x[0],h[1]=x[1],h[2]=x[2],h[3]=x[3],h[4]=x[4],h[5]=x[5],h[6]=x[6],h[7]=x[7],h[8]=x[8],this},setFromMatrix4:function(o){var f=o.el;return this.set(f[0],f[4],f[8],f[1],f[5],f[9],f[2],f[6],f[10]),this},applyToBufferAttribute:function(){var a=new ps;return function(n){for(var K=0,W=n.count;W>K;K++)a.x=n.getX(K),a.y=n.getY(K),a.z=n.getZ(K),a.applyMatrix3(this),n.setXYZ(K,a.x,a.y,a.z);return n}}(),multiply:function(N){return this.multiplyMatrices(this,N)},premultiply:function(S){return this.multiplyMatrices(S,this)},multiplyMatrices:function(U,V){var x=U.el,N=V.el,E=this.el,b=x[0],$=x[3],e=x[6],w=x[1],f=x[4],L=x[7],c=x[2],h=x[5],K=x[8],d=N[0],z=N[3],i=N[6],Y=N[1],g=N[4],X=N[7],A=N[2],n=N[5],s=N[8];return E[0]=b*d+$*Y+e*A,E[3]=b*z+$*g+e*n,E[6]=b*i+$*X+e*s,E[1]=w*d+f*Y+L*A,E[4]=w*z+f*g+L*n,E[7]=w*i+f*X+L*s,E[2]=c*d+h*Y+K*A,E[5]=c*z+h*g+K*n,E[8]=c*i+h*X+K*s,this},multiplyScalar:function(q){var T=this.el;return T[0]*=q,T[3]*=q,T[6]*=q,T[1]*=q,T[4]*=q,T[7]*=q,T[2]*=q,T[5]*=q,T[8]*=q,this},determinant:function(){var o=this.el,W=o[0],m=o[1],P=o[2],F=o[3],V=o[4],S=o[5],y=o[6],f=o[7],B=o[8];return W*V*B-W*S*f-m*F*B+m*S*y+P*F*f-P*V*y},getInverse:function(S){var _=S.el,x=this.el,O=_[0],z=_[1],h=_[2],T=_[3],U=_[4],X=_[5],K=_[6],e=_[7],F=_[8],s=F*U-X*e,V=X*K-F*T,Q=e*T-U*K,w=O*s+z*V+h*Q;if(0===w)return this.identity();var W=1/w;return x[0]=s*W,x[1]=(h*e-F*z)*W,x[2]=(X*z-h*U)*W,x[3]=V*W,x[4]=(F*O-h*K)*W,x[5]=(h*T-X*O)*W,x[6]=Q*W,x[7]=(z*K-e*O)*W,x[8]=(U*O-z*T)*W,this},transpose:function(){var a,z=this.el;return a=z[1],z[1]=z[3],z[3]=a,a=z[2],z[2]=z[6],z[6]=a,a=z[5],z[5]=z[7],z[7]=a,this},getNormalMatrix:function(c){return this.setFromMatrix4(c).getInverse(this).transpose()},transposeIntoArray:function(f){var L=this.el;return f[0]=L[0],f[1]=L[3],f[2]=L[6],f[3]=L[1],f[4]=L[4],f[5]=L[7],f[6]=L[2],f[7]=L[5],f[8]=L[8],this},setUvTransform:function(Y,H,e,N,G,s,D){var t=Math.cos(G),z=Math.sin(G);this.set(e*t,e*z,-e*(t*s+z*D)+s+Y,-N*z,N*t,-N*(-z*s+t*D)+D+H,0,0,1)},scale:function(U,K){var N=this.el;return N[0]*=U,N[3]*=U,N[6]*=U,N[1]*=K,N[4]*=K,N[7]*=K,this},rotate:function(g){var O=Math.cos(g),k=Math.sin(g),f=this.el,N=f[0],o=f[3],T=f[6],Y=f[1],u=f[4],R=f[7];return f[0]=O*N+k*Y,f[3]=O*o+k*u,f[6]=O*T+k*R,f[1]=-k*N+O*Y,f[4]=-k*o+O*u,f[7]=-k*T+O*R,this},translate:function(L,_){var k=this.el;return k[0]+=L*k[2],k[3]+=L*k[5],k[6]+=L*k[8],k[1]+=_*k[2],k[4]+=_*k[5],k[7]+=_*k[8],this},equals:function(Z){for(var U=this.el,P=Z.el,h=0;9>h;h++)if(U[h]!==P[h])return!1;return!0},fromArray:function(v,L){L===e&&(L=0);for(var O=0;9>O;O++)this.el[O]=v[O+L];return this},toArray:function(V,W){V===e&&(V=[]),W===e&&(W=0);var y=this.el;return V[W]=y[0],V[W+1]=y[1],V[W+2]=y[2],V[W+3]=y[3],V[W+4]=y[4],V[W+5]=y[5],V[W+6]=y[6],V[W+7]=y[7],V[W+8]=y[8],V}});var ji=P.Math.Plane=function(B,P){this.normal=B!==e?B:new ps(1,0,0),this.constant=P!==e?P:0};N.assign(ji.prototype,{set:function(k,j){return this.normal.copy(k),this.constant=j,this},setComponents:function(N,t,p,O){return this.normal.set(N,t,p),this.constant=O,this},setFromNormalAndCoplanarPoint:function(A,v){return this.normal.copy(A),this.constant=-v.dot(this.normal),this},setFromCoplanarPoints:function(){var d=new ps,A=new ps;return function(r,D,n){var j=d.subVectors(n,D).cross(A.subVectors(r,D)).normalize();return this.setFromNormalAndCoplanarPoint(j,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(R){return this.normal.copy(R.normal),this.constant=R.constant,this},normalize:function(){var U=1/this.normal.length();return this.normal.multiplyScalar(U),this.constant*=U,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(Y){return this.normal.dot(Y)+this.constant},distanceToSphere:function(N){return this.distanceToPoint(N.center)-N.radius},projectPoint:function($,Y){return Y===e&&(Y=new ps),Y.copy(this.normal).multiplyScalar(-this.distanceToPoint($)).add($)},intersectLine:function(){var p=new ps;return function(k,O){O===e&&(O=new ps);var U=k.delta(p),r=this.normal.dot(U);if(0===r)return 0===this.distanceToPoint(k.start)?O.copy(k.start):e;var S=-(k.start.dot(this.normal)+this.constant)/r;return 0>S||S>1?e:O.copy(U).multiplyScalar(S).add(k.start)}}(),intersectsLine:function(a){var e=this.distanceToPoint(a.start),S=this.distanceToPoint(a.end);return 0>e&&S>0||0>S&&e>0},intersectsBox:function(X){return X.intersectsPlane(this)},intersectsSphere:function(k){return k.intersectsPlane(this)},coplanarPoint:function(G){return G===e&&(G=new ps),G.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var r=new ps,k=new Q;return function(h,Z){var P=Z||k.getNormalMatrix(h),G=this.coplanarPoint(r).applyMatrix4(h),C=this.normal.applyMatrix3(P).normalize();return this.constant=-G.dot(C),this}}(),translate:function(l){return this.constant-=l.dot(this.normal),this},equals:function(B){return B.normal.equals(this.normal)&&B.constant===this.constant}});var fr=P.Math.Ray=function(r,L){this.origin=r!==e?r.clone():new ps,this.direction=L!==e?L.clone():new ps};N.assign(fr.prototype,{set:function(R,F){return this.origin.copy(R),this.direction.copy(F),this},clone:function(){return(new this.constructor).copy(this)},copy:function(w){return this.origin.copy(w.origin),this.direction.copy(w.direction),this.maxHitLen=w.maxHitLen,this},at:function(j,N){var u=N||new ps;return u.copy(this.direction).multiplyScalar(j).add(this.origin)},setMaxHitLength:function(H){this.maxHitLen=H},lookAt:function(z){return this.direction.copy(z).sub(this.origin).normalize(),this},applyMatrix4:function(h){var O=this.maxHitLen;if(O){var u=this.direction.clone().multiplyScalar(O).add(this.origin);u.applyMatrix4(h)}return this.origin.applyMatrix4(h),this.direction.transformDirection(h),O&&(this.maxHitLen=this.origin.distanceTo(u)),this},intersectSphere:function(){var w=new ps;return function(Q,I){w.subVectors(Q.center,this.origin);var x=w.dot(this.direction),o=w.dot(w)-x*x,X=Q.radius*Q.radius;if(o>X)return null;var V=Math.sqrt(X-o),Z=x-V,e=x+V;return 0>Z&&0>e?null:0>Z?this.at(e,I):this.at(Z,I)}}(),intersectEllipsoid:function(){var i=new ps,q=new ps;return function(d,A){i.subVectors(d.center,this.origin),i.divide(d.radius),q.divideVectors(this.direction,d.radius);var C=q.lengthSq(),r=i.dot(q),Z=i.dot(i)*C-r*r;if(Z>C)return null;var F=Math.sqrt(C-Z),k=(r-F)/C,J=(r+F)/C;return 0>k&&0>J?null:0>k?this.at(J,A):this.at(k,A)}}(),intersectBox:function(e,N){var y,D,T,w,E,P,B=1/this.direction.x,G=1/this.direction.y,c=1/this.direction.z,x=this.origin;if(B>=0?(y=(e.min.x-x.x)*B,D=(e.max.x-x.x)*B):(y=(e.max.x-x.x)*B,D=(e.min.x-x.x)*B),G>=0?(T=(e.min.y-x.y)*G,w=(e.max.y-x.y)*G):(T=(e.max.y-x.y)*G,w=(e.min.y-x.y)*G),y>w||T>D)return null;if((T>y||y!==y)&&(y=T),(D>w||D!==D)&&(D=w),c>=0?(E=(e.min.z-x.z)*c,P=(e.max.z-x.z)*c):(E=(e.max.z-x.z)*c,P=(e.min.z-x.z)*c),y>P||E>D)return null;if((E>y||y!==y)&&(y=E),(D>P||D!==D)&&(D=P),0>D)return null;var f=y>=0?y:D,X=this.maxHitLen;return X&&f>X?null:this.at(f,N)},intersectTriangle:function(){var I=new ps,i=new ps,z=new ps,V=new ps;return function(y,k,K,j,C){i.subVectors(k,y),z.subVectors(K,y),V.crossVectors(i,z);var q,R=this.direction.dot(V);if(R>0){if(j)return null;q=1}else{if(!(0>R))return null;q=-1,R=-R}I.subVectors(this.origin,y);var M=q*this.direction.dot(z.crossVectors(I,z));if(0>M)return null;var e=q*this.direction.dot(i.cross(I));if(0>e||M+e>R)return null;var t=-q*I.dot(V);if(0>t)return null;var w=t/R,Y=this.maxHitLen;return Y&&w>Y?null:this.at(w,C)}}()});var Jo=P.Math.Box3=function(d,V){this.min=d!==e?d:new ps(1/0,1/0,1/0),this.max=V!==e?V:new ps(-1/0,-1/0,-1/0)};N.assign(Jo.prototype,{set:function($,D){return this.min.copy($),this.max.copy(D),this},setFromArray:function(c){for(var C=1/0,H=1/0,N=1/0,b=-1/0,S=-1/0,x=-1/0,M=0,n=c.length;n>M;M+=3){var p=c[M],O=c[M+1],e=c[M+2];C>p&&(C=p),H>O&&(H=O),N>e&&(N=e),p>b&&(b=p),O>S&&(S=O),e>x&&(x=e)}return this.min.set(C,H,N),this.max.set(b,S,x),this},setFromPoints:function(X){this.makeEmpty();for(var F=0,S=X.length;S>F;F++)this.expandByPoint(X[F]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(P){return P.max.x<this.min.x||P.min.x>this.max.x||P.max.y<this.min.y||P.min.y>this.max.y||P.max.z<this.min.z||P.min.z>this.max.z?!1:!0},copy:function(y){return this.min.copy(y.min),this.max.copy(y.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(N){return this.min.min(N),this.max.max(N),this},expandByBox:function(Z){return this.min.min(Z.min),this.max.max(Z.max),this},applyMatrix4:function(){var L=[new ps,new ps,new ps,new ps,new ps,new ps,new ps,new ps];return function(g){return this.isEmpty()?this:(L[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(g),L[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(g),L[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(g),L[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(g),L[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(g),L[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(g),L[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(g),L[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(g),this.setFromPoints(L),this)}}()});var Eb=P.Math.Sphere=function(I,i){this.center=I!==e?I:new ps,this.radius=i!==e?i:0};N.assign(Eb.prototype,{set:function(Q,K){return this.center.copy(Q),this.radius=K,this},setFromPoints:function(){var F=new Jo;return function(n,S){var P=this.center;S!==e?P.copy(S):F.setFromPoints(n).getCenter(P);for(var T=0,q=0,V=n.length;V>q;q++)T=Math.max(T,P.distanceToSquared(n[q]));return this.radius=Math.sqrt(T),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(U){return this.center.copy(U.center),this.radius=U.radius,this},empty:function(){return this.radius<=0},containsPoint:function(Z){return Z.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(r){return r.distanceTo(this.center)-this.radius},intersectsSphere:function(u){var w=this.radius+u.radius;return u.center.distanceToSquared(this.center)<=w*w},intersectsBox:function(q){return q.intersectsSphere(this)},intersectsPlane:function(U){return Math.abs(U.distanceToPoint(this.center))<=this.radius},clampPoint:function(j,F){var z=this.center.distanceToSquared(j);return F===e&&(F=new ps),F.copy(j),z>this.radius*this.radius&&(F.sub(this.center).normalize(),F.multiplyScalar(this.radius).add(this.center)),F},getBoundingBox:function(P){return P===e&&(P=new Jo),P.set(this.center,this.center),P.expandByScalar(this.radius),P},applyMatrix4:function(k){return this.center.applyMatrix4(k),this.radius=this.radius*k.getMaxScaleOnAxis(),this},translate:function(D){return this.center.add(D),this},equals:function(z){return z.center.equals(this.center)&&z.radius===this.radius}});var mp=P.Math.Frustum=function(C,O,X,r,M,R){this.planes=[C!==e?C:new ji,O!==e?O:new ji,X!==e?X:new ji,r!==e?r:new ji,M!==e?M:new ji,R!==e?R:new ji]};N.assign(mp.prototype,{set:function(Z,f,g,J,Y,e){var P=this.planes;return P[0].copy(Z),P[1].copy(f),P[2].copy(g),P[3].copy(J),P[4].copy(Y),P[5].copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(b){for(var k=this.planes,e=0;6>e;e++)k[e].copy(b.planes[e]);return this},setFromMatrix:function(O){var U=this.planes,o=O.el,s=o[0],E=o[1],t=o[2],v=o[3],l=o[4],X=o[5],Z=o[6],G=o[7],J=o[8],w=o[9],N=o[10],F=o[11],m=o[12],C=o[13],Y=o[14],V=o[15];return U[0].setComponents(v-s,G-l,F-J,V-m).normalize(),U[1].setComponents(v+s,G+l,F+J,V+m).normalize(),U[2].setComponents(v+E,G+X,F+w,V+C).normalize(),U[3].setComponents(v-E,G-X,F-w,V-C).normalize(),U[4].setComponents(v-t,G-Z,F-N,V-Y).normalize(),U[5].setComponents(v+t,G+Z,F+N,V+Y).normalize(),this},intersectsObject:function(){var K=new Eb;return function(L){var d=L.geometry;return null===d.boundingSphere&&d.computeBoundingSphere(),K.copy(d.boundingSphere).applyMatrix4(L.matrixWorld),this.intersectsSphere(K)}}(),intersectsSprite:function(){var o=new Eb;return function(h){return o.center.set(0,0,0),o.radius=.7071067811865476,o.applyMatrix4(h.matrixWorld),this.intersectsSphere(o)}}(),intersectsSphere:function($){for(var w=this.planes,s=$.center,R=-$.radius,x=0;6>x;x++){var v=w[x].distanceToPoint(s);if(R>v)return!1}return!0},intersectsBox:function(){var D=new ps;return function(T){for(var O=this.planes,j=0;6>j;j++){var V=O[j];if(D.x=V.normal.x>0?T.max.x:T.min.x,D.y=V.normal.y>0?T.max.y:T.min.y,D.z=V.normal.z>0?T.max.z:T.min.z,V.distanceToPoint(D)<0)return!1}return!0}}(),containsPoint:function(I){for(var Q=this.planes,O=0;6>O;O++)if(Q[O].distanceToPoint(I)<0)return!1;return!0}});var Xd=P.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};N.assign(Xd.prototype,{set:function(D,a,x,_,z,u,r,F,p,C,w,h,V,U,k,j){var O=this.el;return O[0]=D,O[4]=a,O[8]=x,O[12]=_,O[1]=z,O[5]=u,O[9]=r,O[13]=F,O[2]=p,O[6]=C,O[10]=w,O[14]=h,O[3]=V,O[7]=U,O[11]=k,O[15]=j,this},clone:function(){return(new Xd).fromArray(this.el)},fromArray:function(C,Y){Y===e&&(Y=0);for(var B=this.el,g=0;16>g;g++)B[g]=C[g+Y];return this},getElements:function(){return this.el},scale:function(z){var G=this.el,s=z.x,l=z.y,Z=z.z;return G[0]*=s,G[4]*=l,G[8]*=Z,G[1]*=s,G[5]*=l,G[9]*=Z,G[2]*=s,G[6]*=l,G[10]*=Z,G[3]*=s,G[7]*=l,G[11]*=Z,this},makeRotationFromEuler:function(a){var L=this.el,p=a._x,v=a._y,T=a._z,Q=a._order,N=Math.cos(p),M=Math.sin(p),F=Math.cos(v),O=Math.sin(v),s=Math.cos(T),e=Math.sin(T);if("XYZ"===Q){var t=N*s,B=N*e,x=M*s,m=M*e;L[0]=F*s,L[4]=-F*e,L[8]=O,L[1]=B+x*O,L[5]=t-m*O,L[9]=-M*F,L[2]=m-t*O,L[6]=x+B*O,L[10]=N*F}else if("YXZ"===Q){var J=F*s,h=F*e,k=O*s,l=O*e;L[0]=J+l*M,L[4]=k*M-h,L[8]=N*O,L[1]=N*e,L[5]=N*s,L[9]=-M,L[2]=h*M-k,L[6]=l+J*M,L[10]=N*F}else if("ZXY"===Q){var J=F*s,h=F*e,k=O*s,l=O*e;L[0]=J-l*M,L[4]=-N*e,L[8]=k+h*M,L[1]=h+k*M,L[5]=N*s,L[9]=l-J*M,L[2]=-N*O,L[6]=M,L[10]=N*F}else if("ZYX"===Q){var t=N*s,B=N*e,x=M*s,m=M*e;L[0]=F*s,L[4]=x*O-B,L[8]=t*O+m,L[1]=F*e,L[5]=m*O+t,L[9]=B*O-x,L[2]=-O,L[6]=M*F,L[10]=N*F}else if("YZX"===Q){var H=N*F,r=N*O,$=M*F,c=M*O;L[0]=F*s,L[4]=c-H*e,L[8]=$*e+r,L[1]=e,L[5]=N*s,L[9]=-M*s,L[2]=-O*s,L[6]=r*e+$,L[10]=H-c*e}else if("XZY"===Q){var H=N*F,r=N*O,$=M*F,c=M*O;L[0]=F*s,L[4]=-e,L[8]=O*s,L[1]=H*e+c,L[5]=N*s,L[9]=r*e-$,L[2]=$*e-r,L[6]=M*s,L[10]=c*e+H}return L[3]=0,L[7]=0,L[11]=0,L[12]=0,L[13]=0,L[14]=0,L[15]=1,this},makeRotationFromQuaternion:function(G){var m=this.el,c=G._x,$=G._y,C=G._z,i=G._w,B=c+c,g=$+$,v=C+C,M=c*B,E=c*g,a=c*v,J=$*g,A=$*v,I=C*v,w=i*B,d=i*g,b=i*v;return m[0]=1-(J+I),m[4]=E-b,m[8]=a+d,m[1]=E+b,m[5]=1-(M+I),m[9]=A-w,m[2]=a-d,m[6]=A+w,m[10]=1-(M+J),m[3]=0,m[7]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(V){var S=this.el,i=V.el,N=i[0],d=i[1],k=i[2],v=i[3],D=i[4],r=i[5],t=i[6],j=i[7],K=i[8],C=i[9],A=i[10],T=i[11],h=i[12],E=i[13],P=i[14],f=i[15],o=C*P*j-E*A*j+E*t*T-r*P*T-C*t*f+r*A*f,$=h*A*j-K*P*j-h*t*T+D*P*T+K*t*f-D*A*f,J=K*E*j-h*C*j+h*r*T-D*E*T-K*r*f+D*C*f,I=h*C*t-K*E*t-h*r*A+D*E*A+K*r*P-D*C*P,e=N*o+d*$+k*J+v*I;if(0===e)return this.identity();var U=1/e;return S[0]=o*U,S[1]=(E*A*v-C*P*v-E*k*T+d*P*T+C*k*f-d*A*f)*U,S[2]=(r*P*v-E*t*v+E*k*j-d*P*j-r*k*f+d*t*f)*U,S[3]=(C*t*v-r*A*v-C*k*j+d*A*j+r*k*T-d*t*T)*U,S[4]=$*U,S[5]=(K*P*v-h*A*v+h*k*T-N*P*T-K*k*f+N*A*f)*U,S[6]=(h*t*v-D*P*v-h*k*j+N*P*j+D*k*f-N*t*f)*U,S[7]=(D*A*v-K*t*v+K*k*j-N*A*j-D*k*T+N*t*T)*U,S[8]=J*U,S[9]=(h*C*v-K*E*v-h*d*T+N*E*T+K*d*f-N*C*f)*U,S[10]=(D*E*v-h*r*v+h*d*j-N*E*j-D*d*f+N*r*f)*U,S[11]=(K*r*v-D*C*v-K*d*j+N*C*j+D*d*T-N*r*T)*U,S[12]=I*U,S[13]=(K*E*k-h*C*k+h*d*A-N*E*A-K*d*P+N*C*P)*U,S[14]=(h*r*k-D*E*k-h*d*t+N*E*t+D*d*P-N*r*P)*U,S[15]=(D*C*k-K*r*k+K*d*t-N*C*t-D*d*A+N*r*A)*U,this},makeRotationAxis:function(r,u){var g=Math.cos(u),i=Math.sin(u),f=1-g,s=r.x,I=r.y,y=r.z,z=f*s,U=f*I;return this.set(z*s+g,z*I-i*y,z*y+i*I,0,z*I+i*y,U*I+g,U*y-i*s,0,z*y-i*I,U*y+i*s,f*y*y+g,0,0,0,0,1),this},multiply:function(D){return this.multiplyMatrices(this,D)},premultiply:function(Z){return this.multiplyMatrices(Z,this)},multiplyMatrices:function(l,a){var x=l.el,Y=a.el,f=this.el,o=x[0],S=x[4],U=x[8],M=x[12],N=x[1],g=x[5],j=x[9],t=x[13],q=x[2],v=x[6],i=x[10],C=x[14],c=x[3],d=x[7],w=x[11],J=x[15],z=Y[0],G=Y[4],P=Y[8],T=Y[12],k=Y[1],p=Y[5],y=Y[9],m=Y[13],h=Y[2],s=Y[6],u=Y[10],X=Y[14],A=Y[3],H=Y[7],F=Y[11],$=Y[15];return f[0]=o*z+S*k+U*h+M*A,f[4]=o*G+S*p+U*s+M*H,f[8]=o*P+S*y+U*u+M*F,f[12]=o*T+S*m+U*X+M*$,f[1]=N*z+g*k+j*h+t*A,f[5]=N*G+g*p+j*s+t*H,f[9]=N*P+g*y+j*u+t*F,f[13]=N*T+g*m+j*X+t*$,f[2]=q*z+v*k+i*h+C*A,f[6]=q*G+v*p+i*s+C*H,f[10]=q*P+v*y+i*u+C*F,f[14]=q*T+v*m+i*X+C*$,f[3]=c*z+d*k+w*h+J*A,f[7]=c*G+d*p+w*s+J*H,f[11]=c*P+d*y+w*u+J*F,f[15]=c*T+d*m+w*X+J*$,this},lookAt:function(){var n=new ps,q=new ps,l=new ps;return function(F,_,G){var Q=this.el;return l.subVectors(F,_),0===l.lengthSq()&&(l.z=1),l.normalize(),n.crossVectors(G,l),0===n.lengthSq()&&(1===Math.abs(G.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),n.crossVectors(G,l)),n.normalize(),q.crossVectors(l,n),Q[0]=n.x,Q[4]=q.x,Q[8]=l.x,Q[1]=n.y,Q[5]=q.y,Q[9]=l.y,Q[2]=n.z,Q[6]=q.z,Q[10]=l.z,this}}(),extractScale:function(){var B;return function(E){B===e&&(B=new ps),E===e&&(E=new ps);var Z=B.setFromMatrixColumn(this,0).length(),Q=B.setFromMatrixColumn(this,1).length(),d=B.setFromMatrixColumn(this,2).length();return E.set(Z,Q,d),E}}(),extractRotation:function(){var H;return function(A){H===e&&(H=new ps),A===e&&(A=new Xd);var k=this.el,b=A.el,i=1/H.setFromMatrixColumn(A,0).length(),J=1/H.setFromMatrixColumn(A,1).length(),T=1/H.setFromMatrixColumn(A,2).length();return k[0]=b[0]*i,k[1]=b[1]*i,k[2]=b[2]*i,k[4]=b[4]*J,k[5]=b[5]*J,k[6]=b[6]*J,k[8]=b[8]*T,k[9]=b[9]*T,k[10]=b[10]*T,this}}(),multiplyScalar:function(Y){var Z=this.el;return Z[0]*=Y,Z[4]*=Y,Z[8]*=Y,Z[12]*=Y,Z[1]*=Y,Z[5]*=Y,Z[9]*=Y,Z[13]*=Y,Z[2]*=Y,Z[6]*=Y,Z[10]*=Y,Z[14]*=Y,Z[3]*=Y,Z[7]*=Y,Z[11]*=Y,Z[15]*=Y,this},getPosition:function($){return $===e&&($=new ps),$.setFromMatrixColumn(this,3)},setPosition:function(V){var O=this.el;return O[12]=V.x,O[13]=V.y,O[14]=V.z,this},toArray:function(Q,W){Q===e&&(Q=[]),W===e&&(W=0);var g=this.el;return Q[W]=g[0],Q[W+1]=g[1],Q[W+2]=g[2],Q[W+3]=g[3],Q[W+4]=g[4],Q[W+5]=g[5],Q[W+6]=g[6],Q[W+7]=g[7],Q[W+8]=g[8],Q[W+9]=g[9],Q[W+10]=g[10],Q[W+11]=g[11],Q[W+12]=g[12],Q[W+13]=g[13],Q[W+14]=g[14],Q[W+15]=g[15],Q},determinant:function(){var E=this.el,D=E[0],Q=E[4],$=E[8],M=E[12],x=E[1],H=E[5],m=E[9],q=E[13],L=E[2],b=E[6],j=E[10],g=E[14],X=E[3],y=E[7],O=E[11],p=E[15];return X*(+M*m*b-$*q*b-M*H*j+Q*q*j+$*H*g-Q*m*g)+y*(+D*m*g-D*q*j+M*x*j-$*x*g+$*q*L-M*m*L)+O*(+D*q*b-D*H*g-M*x*b+Q*x*g+M*H*L-Q*q*L)+p*(-$*H*L-D*m*b+D*H*j+$*x*b-Q*x*j+Q*m*L)},copy:function(d){var h=this.el,R=d.el;return h[0]=R[0],h[1]=R[1],h[2]=R[2],h[3]=R[3],h[4]=R[4],h[5]=R[5],h[6]=R[6],h[7]=R[7],h[8]=R[8],h[9]=R[9],h[10]=R[10],h[11]=R[11],h[12]=R[12],h[13]=R[13],h[14]=R[14],h[15]=R[15],this},compose:function(J,X,m){var A=this.el,n=X._x,Q=X._y,B=X._z,U=X._w,v=n+n,P=Q+Q,Y=B+B,R=n*v,y=n*P,I=n*Y,u=Q*P,r=Q*Y,w=B*Y,b=U*v,G=U*P,g=U*Y,N=m.x,Z=m.y,h=m.z;return A[0]=(1-(u+w))*N,A[1]=(y+g)*N,A[2]=(I-G)*N,A[3]=0,A[4]=(y-g)*Z,A[5]=(1-(R+w))*Z,A[6]=(r+b)*Z,A[7]=0,A[8]=(I+G)*h,A[9]=(r-b)*h,A[10]=(1-(R+u))*h,A[11]=0,A[12]=J.x,A[13]=J.y,A[14]=J.z,A[15]=1,this},decompose:function(){var J=new ps,A=new Xd;return function(W,O,Q){var n=this.el,x=J.set(n[0],n[1],n[2]).length(),F=J.set(n[4],n[5],n[6]).length(),H=J.set(n[8],n[9],n[10]).length(),E=this.determinant();0>E&&(x=-x),W.x=n[12],W.y=n[13],W.z=n[14],A.copy(this);var l=1/x,T=1/F,q=1/H;return A.el[0]*=l,A.el[1]*=l,A.el[2]*=l,A.el[4]*=T,A.el[5]*=T,A.el[6]*=T,A.el[8]*=q,A.el[9]*=q,A.el[10]*=q,O.setFromRotationMatrix(A),Q.x=x,Q.y=F,Q.z=H,this}}()});var ms=P.Math.Triangle=function($,S,D){this.a=$!==e?$:new ps,this.b=S!==e?S:new ps,this.c=D!==e?D:new ps};N.assign(ms,{barycoordFromPoint:function(){var t=new ps,V=new ps,P=new ps;return function(c,o,R,Q,J){t.subVectors(Q,o),V.subVectors(R,o),P.subVectors(c,o);var y=t.dot(t),E=t.dot(V),Y=t.dot(P),D=V.dot(V),W=V.dot(P),Z=y*D-E*E,$=J||new ps;if(0===Z)return $.set(-2,-1,-1);var L=1/Z,C=(D*Y-E*W)*L,k=(y*W-E*Y)*L;return $.set(1-C-k,k,C)}}()});var ai=P.Math.Euler=function(H,B,w,s,i){this.set(H,B,w,s,i)};ai.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ai.DefaultOrder="XYZ",ai.ReverseOrder=function(D){return D=D[2]+D[1]+D[0],D.toUpperCase()},N.defineProperties(ai.prototype,{x:{get:function(){return this._x},set:function(h){this._x=h,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(p){this._y=p,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(p){this._z=p,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(s){this._order=s,this.onChangeCallback()}}}),N.assign(ai.prototype,{set:function(s,m,y,G,t){return Fl(s)&&(t=y,G=m,y=s[2],m=s[1],s=s[0]),G?t&&(G=ai.ReverseOrder(G)):G="ZYX",this._x=s||0,this._y=m||0,this._z=y||0,this._order=G||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(f){return this._x=f._x,this._y=f._y,this._z=f._z,this._order=f._order,this.onChangeCallback(),this},setFromRotationMatrix:function(c,X,J){var A=P.Math.clamp,K=c.el||c,u=K[0],D=K[4],k=K[8],$=K[1],x=K[5],_=K[9],U=K[2],M=K[6],B=K[10];return X=X||this._order,"XYZ"===X?(this._y=Math.asin(A(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(-_,B),this._z=Math.atan2(-D,u)):(this._x=Math.atan2(M,x),this._z=0)):"YXZ"===X?(this._x=Math.asin(-A(_,-1,1)),Math.abs(_)<.99999?(this._y=Math.atan2(k,B),this._z=Math.atan2($,x)):(this._y=Math.atan2(-U,u),this._z=0)):"ZXY"===X?(this._x=Math.asin(A(M,-1,1)),Math.abs(M)<.99999?(this._y=Math.atan2(-U,B),this._z=Math.atan2(-D,x)):(this._y=0,this._z=Math.atan2($,u))):"ZYX"===X?(this._y=Math.asin(-A(U,-1,1)),Math.abs(U)<.99999?(this._x=Math.atan2(M,B),this._z=Math.atan2($,u)):(this._x=0,this._z=Math.atan2(-D,x))):"YZX"===X?(this._z=Math.asin(A($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(-_,x),this._y=Math.atan2(-U,u)):(this._x=0,this._y=Math.atan2(k,B))):"XZY"===X?(this._z=Math.asin(-A(D,-1,1)),Math.abs(D)<.99999?(this._x=Math.atan2(M,x),this._y=Math.atan2(k,u)):(this._x=Math.atan2(-_,B),this._y=0)):console.warn("unsupported order: "+X),this._order=X,J!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var v=new Xd;return function(p,i,d){return v.makeRotationFromQuaternion(p),this.setFromRotationMatrix(v,i,d)}}(),setFromVector3:function(m,r){return this.set(m.x,m.y,m.z,r||this._order)},reorder:function(){var p=new Ep;return function(b){return p.setFromEuler(this),this.setFromQuaternion(p,b)}}(),equals:function(X){return X._x===this._x&&X._y===this._y&&X._z===this._z&&X._order===this._order},fromArray:function(q){return this._x=q[0],this._y=q[1],this._z=q[2],q[3]!==e&&(this._order=q[3]),this.onChangeCallback(),this},toArray:function(s,R){return s===e&&(s=[]),R===e&&(R=0),s[R]=this._x,s[R+1]=this._y,s[R+2]=this._z,s[R+3]=this._order,s},toVector3:function(J){return J?J.set(this._x,this._y,this._z):new ps(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}});var Uq={ms_ac:function(x,W){for(var d=W.ms_ac,P=0;P<d.length;P++)Ch(x,d[P])},ms_listener:function(G){G.addListeners=function(){var B=this,G=0,v=Mq;for(b.mockTouch&&(v=hc.concat(ef).concat(cp));G<v.length;G++){var f=v[G];"wheel"===f&&!B.handle_wheel&&B.handle_mousewheel&&(B.handle_wheel=function(M){Hr(B,M)}),B["handle_"+f]&&Pl(f,B.getView(),B)}},G.removeListeners=function(){for(var o=this,V=0;V<Mq.length;V++)o["handle_"+Mq[V]]&&Wp(Mq[V],o.getView(),o)}},ms_fire:function(E){E.mp=function(P,a,Y){this.addPropertyChangeListener(P,a,Y)},E.ump=function(H,v){this.removePropertyChangeListener(H,v)},E.fp=function(K,X,O,F,D){return this.firePropertyChange(K,X,O,F,D)},E.addPropertyChangeListener=function(M,w,G){var J=this;J._62I||(J._62I=new yj),J._62I.add(M,w,G)},E.removePropertyChangeListener=function(y,D){this._62I&&this._62I.remove(y,D)},E.firePropertyChange=function(Q,w,k,x,W){if(x){if(x(w,k))return!1}else if(w===k)return!1;var t=this,b=W||{};return b.property=Q,b.oldValue=w,b.newValue=k,b.source=t,b.data=t,t._62I&&t._62I.fire(b),t.onPropertyChanged&&t.onPropertyChanged(b),!0}},ms_attr:function(j){j.a=function(y,j){var X=this;if(2===arguments.length)X.setAttr(y,j);else{if(!Tp(y))return X.getAttr(y);for(var D in y)X.setAttr(D,y[D])}return X},j.getAttr=function(v,B){if(B===e&&(B=1),this._attrObject&&v in this._attrObject)return this._attrObject[v];if(this.getImage){var z=this.getImage();if(nf(z)&&(z=fg[z]),Tp(z)&&"dataBindings"in z)for(var r=z.dataBindings,a=r.length-1;a>=0;a--){var s=r[a];if(s.attr===v){if("defaultValue"in s)return s.defaultValue;break}}}return B?u[v]:e},j.setAttr=function(b,V){var X=this;X._attrObject||(X._attrObject={});var r=X._attrObject[b];V===e?delete X._attrObject[b]:X._attrObject[b]=V,X.fp&&X.fp("a:"+b,r,V)&&X.onAttrChanged&&X.onAttrChanged(b,r,V)},j.getSerializableAttrs=function(){var $,H={};for($ in this._attrObject)H[$]=1;return H}},ms_bnb:function(L){L.getBodyColor=function(t){return t.s("body.color")},L.getBorderColor=function(Q){return Q.s("border.color")}},_51o:function(U){U.mi=function(E,M,g){this.addInteractorListener(E,M,g)},U.umi=function(K,b){this.removeInteractorListener(K,b)},U.fi=function(o){this.fireInteractorEvent(o)},U.addInteractorListener=function(R,g,Z){var s=this;s._63I||(s._63I=new yj),s._63I.add(R,g,Z)},U.removeInteractorListener=function(b,i){this._63I&&this._63I.remove(b,i)},U.fireInteractorEvent=function(H){this._63I&&this._63I.fire(H)},U.setInteractors=function(P){var S=this,r=S._interactors;r&&r.each(function(S){S.tearDown()}),Fl(P)&&(P=new Tr(P)),S._interactors=P,P&&P.each(function(c){c.setUp()}),S.fp("interactors",r,P),S.invalidateSelection()},U.getInteractors=function(){return this._interactors}},_49o:function(l){l._44O=A,l._45O=A,l.getTopPainters=function(){return this._44O},l.getBottomPainters=function(){return this._45O},l.addTopPainter=function(d){var V=this;V._44O||(V._44O=new Tr),V._44O.contains(d)||(V._44O.add(d),V.redraw&&V.redraw())},l.removeTopPainter=function(Y){var V=this;V._44O&&(V._44O.remove(Y),V.redraw&&V.redraw())},l.addBottomPainter=function(G){var V=this;V._45O||(V._45O=new Tr),V._45O.contains(G)||(V._45O.add(G),V.redraw&&V.redraw())},l.removeBottomPainter=function(c){var D=this;D._45O&&(D._45O.remove(c),D.redraw&&D.redraw())},l._93db=function(V,f){var v=this;v._45O&&v._45O.each(function(M){M.draw?M.draw(V,f):M.call(v,V,f)})},l._92db=function(i,j){var I=this;I._44O&&I._44O.each(function(Q){Q.draw?Q.draw(i,j):Q.call(I,i,j)})}},ms_sm:function(K){K.sm=function(){return this.getSelectionModel()},K.setSelectableFunc=function(x){this.sm().setFilterFunc(x)},K.getSelectableFunc=function(){return this.sm().getFilterFunc()},K.getSelectionModel=function(){var p=this;return p._selectionModel?p._selectionModel:p.dm().sm()},K.isSelectionModelShared=function(){return!this._selectionModel},K.setSelectionModelShared=function(E){var b=this,m=!b._selectionModel,o=b.handleSelectionChange,X=b.dm();
m!==E&&(b.invalidateSelection&&b.invalidateSelection(),E?(X.sm().ms(o,b),b._selectionModel.ums(o,b),b._selectionModel.dispose(),b._selectionModel=A):(X.sm().ums(o,b),b._selectionModel=new Gl(X),b._selectionModel.ms(o,b)),b.onSelectionModelSharedChanged(),b.fp("selectionModelShared",m,E))},K.onSelectionModelSharedChanged=function(){var U=this;U.redraw(),U.invalidateSelection&&U.invalidateSelection()},K.removeSelection=function(){var O=this.dm();O.beginTransaction(),this.sm().toSelection().each(O.remove,O),O.endTransaction()},K.selectAll=function(){var m=this;m.sm().ss(m.dm().toDatas(function(J){return m.isVisible(J)&&m.isSelectable(J)}))},K.isSelected=function(F){return this.sm().co(F)},K.isSelectedById=function(i){var j=this.dm().getDataById(i);return j?this.isSelected(j):!1},K.isSelectable=function(e){return this.sm().isSelectable(e)}},ms_tx:function(N){N._64I=0,N._65O=0,N.isScrollable=function(){return this.getWidth()<this._64I},N._40o=function(){return this.isScrollable()},N.getLogicalPoint=function(e){return Uc(e,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},N.tx=function(Q){return Q===e?this.getTranslateX():(this.setTranslateX(Q),void 0)},N.getTranslateX=function(){return this._65O},N.setTranslateX=function(v){var u=this,e=u.getWidth()-u._64I;e>v&&(v=e),v>0&&(v=0),v=W(v);var i=u._65O;u._65O=v,u.fp(mn,i,v)}},ms_ty:function(Q){Q._23Q=0,Q._66O=0,Q._41o=function(){return this.getHeight()<this._23Q},Q.getLogicalPoint=function(f){return Uc(f,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Q.ty=function(N){return N===e?this.getTranslateY():(this.setTranslateY(N),void 0)},Q.getTranslateY=function(){return this._66O},Q.setTranslateY=function(B){var K=this,q=K.getHeight()-K._23Q;q>B&&(B=q),B>0&&(B=0),B=W(B);var X=K._66O;K._66O=B,K.fp(Kr,X,B)}},ms_txy:function(r){r._65O=0,r._66O=0,r.tx=function(v){return v===e?this.getTranslateX():(this.setTranslateX(v),void 0)},r.ty=function(M){return M===e?this.getTranslateY():(this.setTranslateY(M),void 0)},r.onTranslateEnded=function(){},r.setTranslate=function(v,d,C){var m=this;if(C=Rf(C)){m._65I&&m._65I.stop(!0);var Q=m.tx(),j=m.ty();C.action=function(A){m.setTranslate(Q+(v-Q)*A,j+(d-j)*A)},C._37o=function(){delete m._66I,delete m._65I,m.onTranslateEnded()},m._66I=1,m._65I=_c(C)}else m.tx(v),m.ty(d)},r.getTranslateX=function(){return this._65O},r.setTranslateX=function(l){var h=this;l=h.adjustTranslateX(l);var e=h._65O;h._65O=l,h.fp(mn,e,l)},r.getTranslateY=function(){return this._66O},r.setTranslateY=function(i){var r=this;i=r.adjustTranslateY(i);var t=r._66O;r._66O=i,r.fp(Kr,t,i)},r.adjustTranslateX=function(V){return W(V)},r.adjustTranslateY=function(e){return W(e)},r.translate=function(p,M,o){this.setTranslate(this.tx()+p,this.ty()+M,o)},r.getLogicalPoint=function(M){var P=this;return Uc(M,this._canvas||P._view,P.tx(),P.ty())}},ms_dm:function(c){c.dm=function(w){return w?(this.setDataModel(w),void 0):this.getDataModel()},c.getDataModel=function(){return this._dataModel}},ms_lp:function(g){g.lp=function(X){return this.getLogicalPoint(X)}},ms_v:function(N){N._disabled=!1,N.setDisabled=function(n,d){var q=this,p=q._disabled;p!==n&&(p&&(Sc(q._63O),delete q._63O),n&&(Ho(q._view,q._63O=db(d)),q.iv()),q._disabled=n,q.fp("disabled",p,n))},N.isDisabled=function(){return this._disabled},N.getDisabledDiv=function(){return this._63O},N.getView=function(){return this._view},N.addToDOM=function(M){var k=this,I=k.getView(),a=I.style;M=M||x.body,M.appendChild(I),a.left="0",a.right="0",a.top="0",a.bottom="0",d(_,"resize",function(){k.iv()}),k.iv()},N.getWidth=function(){return this._view.clientWidth},N.getHeight=function(){return this._view.clientHeight},N.setWidth=function(o){var j=this;j._view.style.width=o+bl,j.iv(),j.fp&&j.fp(Cq,A,o)},N.setHeight=function(c){var h=this;h._view.style.height=c+bl,h.iv(),h.fp&&h.fp(ll,A,c)},N.setFocus=function(m){var M=this,U=M._currentEditor;return m&&U&&(U.getView&&(U=U.getView()),U.contains(m.target))?!1:(Pg(M._view),M.endEditing&&M.endEditing(),M.fireViewEvent("focus"),!0)},N.iv=function(C){this.invalidate(C)},N.invalidate=function(Y){var l=this;l._68I||(l._68I=1,Wg(l.validate,l,A,Y),l.onInvalidated&&l.onInvalidated(),l.fireViewEvent("invalidate"))},N.validate=function(){var x=this,E=x._view;if(x._68I&&(delete x._68I,E.parentNode))if(0===E.offsetWidth&&0===E.offsetHeight&&x._67I!==A)x._67I===e&&(x._67I=b.reinvalidateCount),x._67I>0?x._67I--:x._67I=A,x.iv();else{x.fireViewEvent("beginValidate"),x.validateImpl(),x.onValidated&&x.onValidated(),x.fireViewEvent("validate");var m=x._63O;m&&(E.lastChild!==m&&(Sc(m),Ho(E,m)),di(m,0,0,x.getWidth(),x.getHeight())),mh(x),Ii(x),ih(x)}},N.layout=function(g,Q,P,I){1===arguments.length?di(this,g):di(this,g,Q,P,I)},N.addViewListener=function(K,m,S){var Y=this;Y._67O||(Y._67O=new yj),Y._67O.add(K,m,S)},N.removeViewListener=function(q,W){this._67O.remove(q,W)},N.fireViewEvent=function(Z){var C=this;C._67O&&(nf(Z)&&(Z={kind:Z}),C._67O.fire(Z)),b.viewListener&&b.viewListener(C,Z)}},ms_tip:function(_){_.setToolTipEnabled=function(n){var O=this;n?tc||O._13o||(O.enableToolTip(),O.fp("toolTipEnabled",!1,!0)):O._13o&&(O.disableToolTip(),O.fp("toolTipEnabled",!0,!1))},_.isToolTipEnabled=function(){return!!this._13o},_.enableToolTip=function(){var f=this;if(!tc&&!f._13o){f._13o=function(d){var q=f.getToolTip(d);q!=A?b.toolTipContinual&&b.isToolTipShowing()?gh(d,q):(lr(),Fg={timeout:$(Aj,ik),e:d,info:q}):lr()};var j=f.getView();d(j,xq,f._13o),d(j,"mouseleave",b.hideToolTip)}},_.disableToolTip=function(){var v=this;if(v._13o){var D=v.getView();B(D,xq,v._13o),B(D,"mouseleave",b.hideToolTip),delete v._13o}},_.getToolTip=function(x){var r=this;if(r.getDataAt){var e=r.getDataAt(x);return e?e.getToolTip():A}return r.getValue?r.getValue():void 0}},_52o:function(W){W._zoom=1,W._29I=on,W.zoomIn=function(E,j){this.setZoom(this._zoom*bh,E,j)},W.zoomOut=function(b,j){this.setZoom(this._zoom/bh,b,j)},W.zoomReset=function(F,U){this.setZoom(1,F,U)},W.scrollZoomIn=function(z){this.setZoom(this._zoom*Ic,A,z)},W.scrollZoomOut=function(n){this.setZoom(this._zoom/Ic,A,n)},W.pinchZoomIn=function(v){this.setZoom(this._zoom*zi,A,v)},W.pinchZoomOut=function(u){this.setZoom(this._zoom/zi,A,u)},W.adjustZoom=function(V){return _p>V?_p:V>Ki?Ki:V},W.getZoom=function(){return this._zoom},W.setZoom=function(G,b,L){var g=this;if(b=Rf(b)){g._14o&&g._14o.stop(!0);var z=g._zoom;b.action=function(n){g._96O(z+(G-z)*n,L)},b._37o=function(){delete g._zooming,delete g._14o,g.onZoomEnded()},g._zooming=1,g._14o=_c(b)}else g._96O(G,L)},W._96O=function(X,x){var r=this;if(X=r.adjustZoom(X),X!==r._zoom){r.validate();var l=r._29I,v=r._zoom;0!==l.width&&0!==l.height&&(x=x?x:{x:l.x+l.width/2,y:l.y+l.height/2},r.tx((x.x-l.x)*v-x.x*X),r.ty((x.y-l.y)*v-x.y*X)),r._zoom=X,r.fp("zoom",v,X)}}},ms_edge:function(N){N._2I=function(r){var l=this;l._44I||(l._44I=new Tr),l._42I||(l._42I=new Tr),l._44I.add(r),l._42I.add(r),l._20I()},N._4I=function(R){var a=this;a._44I||(a._44I=new Tr),a._43I||(a._43I=new Tr),a._44I.add(R),a._43I.add(R),a._20I()},N._16I=function(q){var Q=this;Q._44I.remove(q),Q._42I.remove(q),Q._44I.isEmpty()&&delete Q._44I,Q._42I.isEmpty()&&delete Q._42I,Q._20I()},N._18I=function(Y){var N=this;N._44I.remove(Y),N._43I.remove(Y),N._44I.isEmpty()&&delete N._44I,N._43I.isEmpty()&&delete N._43I,N._20I()},N._20I=function(){var G=this;if(delete G._45I,!G._44I||G._44I.isEmpty())return delete G._70O,void 0;var f;G._44I.each(function(V){V.isLooped()&&(f||(f={}),f[V._id]||(G._45I||(G._45I=new Tr),G._45I.add(V),f[V._id]=V))}),f?(G._70O=new Tr,G._44I.each(function(g){f[g._id]?"A"===f[g._id]||(f[g._id]="A",G._70O.add(g)):G._70O.add(g)})):G._70O=G._44I},N.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},N.getSourceAgentEdges=function(){return this._46I},N.getTargetAgentEdges=function(){return this._47I},N._1I=function(B){var O=this;O._46I||(O._46I=new Tr),O._48I||(O._48I=new Tr),O._46I.add(B),O._48I.add(B),O._19I()},N._3I=function(G){var H=this;H._47I||(H._47I=new Tr),H._48I||(H._48I=new Tr),H._47I.add(G),H._48I.add(G),H._19I()},N._15I=function(D){var P=this;P._46I.remove(D),P._48I.remove(D),P._46I.isEmpty()&&delete P._46I,P._48I.isEmpty()&&delete P._48I,P._19I()},N._17I=function($){var c=this;c._47I.remove($),c._48I.remove($),c._47I.isEmpty()&&delete c._47I,c._48I.isEmpty()&&delete c._48I,c._19I()},N._19I=function(){var f=this;delete f._49I;var $=f._48I;if($&&!$.isEmpty()){var E={};$.each(function(M){E[M._id]?f._49I||(f._49I=new Tr):E[M._id]=M}),f._49I?$.each(function(x){E[x._id]&&(f._49I.add(x),delete E[x._id])}):f._49I=$}},N.getLoopedEdges=function(){return this._45I},N.getEdges=function(){return this._70O},N.getAgentEdges=function(){return this._49I},N.getSourceEdges=function(){return this._42I},N.getTargetEdges=function(){return this._43I},N._8I=function(){this._70O&&this._70O.each(function(Z){Z._7I()})}}};Ec(b,{getVersion:function(){return"7.0.9"}},!0),Ec(b,{numberDigits:5,crossOrigin:"",baseZIndex:e,isTouchable:tc,devicePixelRatio:_.devicePixelRatio?_.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:p.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return si},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,encodeStringKey:null,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(Y){return Y*Y},labelColor:Nd,labelSelectColor:Hl,labelFont:"12px arial, sans-serif",widgetIndent:tc?30:20,widgetRowHeight:tc?30:20,widgetHeaderHeight:tc?32:22,widgetTitleHeight:tc?34:24,scrollBarColor:ze,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:tc?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Ff,intersectionLineLine:Fc,isEnter:rp,isEsc:dk,isDelete:hp,isSpace:Kn,isLeft:el,isUp:Pk,isRight:cg,isDown:Dd,isTouchEvent:Sp,getTarget:Mm,isString:nf,isNumber:vp,isBoolean:ql,isArray:Fl,isSelectAll:wg,isFunction:Fd,isObject:Tp,getPropertyValue:Li,setPropertyValue:Qq,addMethod:Ec,isMobile:function(){var c;return function(){return c!==e?c:(c=!1,function(z){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(z)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(z.substr(0,4)))&&(c=!0)}(navigator.userAgent||navigator.vendor||_.opera),c)}}(),createGradient:function(o,t,S,J,I,G,c,j){var O=Mf[t];return O(o,S,J,I,G,c,j)},appendToScreen:function(b){b=b.getView?b.getView():b,(x.fullscreenElement||x.mozFullScreenElement||x.webkitFullscreenElement||x.msFullscreenElement||x.body).appendChild(b)},encodeString:function(R){return P.Math.encodeBase64(R,b.encodeStringKey)},decodeString:function(w){return P.Math.decodeBase64(w,b.encodeStringKey)},findView:function(k){var v=function(m,_){var n=_._ht;n&&m.push(n);var w=_.children,U=w.length;if(U)for(var V=0;U>V;V++)v(m,w[V])},F=[];v(F,x.body);var O=function(_,B){for(var n="2d"===B?Nl.GraphView:Kk.Graph3dView,G=0,e=_.length;e>G;G++)if(_[G]instanceof n)return F[G];return null};return"all"===k?F:"2d"===k?O(F,"2d"):"3d"===k?O(F,"3d"):O(F,"3d")||O(F,"2d")},toggleFullscreen:function(R){var O=R.getView();if(x.fullscreenElement||x.mozFullScreenElement||x.webkitFullscreenElement||x.msFullscreenElement)x.exitFullscreen?x.exitFullscreen():x.msExitFullscreen?x.msExitFullscreen():x.mozCancelFullScreen?x.mozCancelFullScreen():x.webkitExitFullscreen&&x.webkitExitFullscreen();else{var y=!0;if(R.isSelfViewEvent){var v=R.getX(),Y=R.getY(),p=R.getWidth(),C=R.getHeight(),k=O.style.background,L=O.style.backgroundColor;k||L||(O.style.backgroundColor="white"),O.requestFullscreen?O.requestFullscreen():O.msRequestFullscreen?O.msRequestFullscreen():O.mozRequestFullScreen?O.mozRequestFullScreen():O.webkitRequestFullscreen&&O.webkitRequestFullscreen();var D=setInterval(function(){if(O!==(x.fullscreenElement||x.mozFullScreenElement||x.webkitFullscreenElement||x.msFullscreenElement))clearInterval(D),R.setX(v),R.setY(Y),R.setWidth(p),R.setHeight(C),R._fullscreen=!1,O.style.oldBackgroundColor=L,R.iv();else{var f=P.Default.getWindowInfo();(y||f.width!==R.getWidth()||f.height!==R.getHeight())&&(R.setX(f.left),R.setY(f.top),R.setWidth(f.width),R.setHeight(f.height),R._fullscreen=!0,R.iv(),y=!1)}},500)}else{var E=O.style.left,U=O.style.top,p=O.style.width,C=O.style.height,k=O.style.background,L=O.style.backgroundColor;k||L||(O.style.backgroundColor="white"),O.requestFullscreen?O.requestFullscreen():O.msRequestFullscreen?O.msRequestFullscreen():O.mozRequestFullScreen?O.mozRequestFullScreen():O.webkitRequestFullscreen&&O.webkitRequestFullscreen();var D=setInterval(function(){if(O!==(x.fullscreenElement||x.mozFullScreenElement||x.webkitFullscreenElement||x.msFullscreenElement))clearInterval(D),O.style.left=E,O.style.top=U,O.style.width=p,O.style.height=C,O.style.oldBackgroundColor=L,R.iv();else{var e=P.Default.getWindowInfo();(y||e.width!==R.getWidth()||e.height!==R.getHeight())&&(di(R),y=!1)}},500)}}},appendTimeStamp:function(u){return u},setCompType:function(P,U){Fd(U)||Tp(U)?Eq[P]=U:Qo(P)},getCompType:function(C){var j=Eq[C];return j===e&&Po.test(C)&&Qo(C),j},getCompTypeMap:function(){return Eq},drawCompType:function(N,H,o,u,C,v){N(H,o,u,C,v)},numberListener:function(){var Q={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(P){var V=P.keyCode;Q[V]||65===V&&b.isCtrlDown(P)||86===V&&b.isCtrlDown(P)||67===V&&b.isCtrlDown(P)||88===V&&b.isCtrlDown(P)||V>=35&&40>=V||(P.shiftKey||48>V||V>57)&&(96>V||V>105)&&P.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(G){var w=G.target.tagName;("DIV"===w||"CANVAS"===w)&&!(b.ignoreKeyCodes.indexOf(G.keyCode)>=0)&&("keydown"!==G.type||el(G)||cg(G)||Pk(G)||Dd(G)||hp(G)||65===G.keyCode&&(G.metaKey||G.ctrlKey))&&(G.preventDefault(),G.preventManipulation&&G.preventManipulation())},getWindowInfo:function(){var T=x.documentElement,z=T&&(T.scrollLeft||T.scrollTop)?T:x.body;return{target:z,left:z.scrollLeft,top:z.scrollTop,width:_.innerWidth||z.clientWidth,height:_.innerHeight||z.clientHeight}},isDragging:function(){return!!si},isLeftButton:function(O){return Sp(O)?!0:0===O.button},isMiddleButton:function(s){return Sp(s)?!1:s&&(1===s.button||4&(s.buttons||0))},isRightButton:function(i){return Sp(i)?!1:i&&(2===i.button||2&(i.buttons||0))},isInput:function(X){if(!X)return!1;var j=X.tagName;return"INPUT"===j||"TEXTAREA"===j||"SELECT"===j},getTouchCount:function(M){return Sp(M)?M.touches.length:1},isDoubleClick:function(){function P(r){r.details=0,r.timeout=null,r.lastPoint=null}var L={};return zn=new w,zg=zn.getTime(),function(G){if(xs(G)>1)return!1;var O=G.button==A?"":G.button,M=G.type+O,n=M+"_isDoubleClick",q=L[M];if(q||(q=L[M]={details:0,timeout:null,lastPoint:null}),G[n]===e){G[n]=!0;var r=nq(G);q.timeout&&(X(q.timeout),q.timeout=null);var v=Sp(G)?b.doubleTouchRange:b.doubleClickRange;q.lastPoint&&np(q.lastPoint,r)>v&&P(q),q.lastPoint=r,q.details++,q.timeout=$(function(){P(this)}.bind(q),500)}return 2===q.details}}(),isShiftDown:function(x){return x?x.shiftKey:de["16"]},isCtrlDown:function(q){return q?qd?q.metaKey:q.ctrlKey:qd?de["91"]:de["17"]},getClientPoint:function(q){return Sp(q)&&(q=ah(q)),{x:q.clientX,y:q.clientY}},isMouseEvent:function(B){return B instanceof MouseEvent||0===B.type.indexOf("mouse")},getTargetElement:function(d){if(b.isMouseEvent(d)||!x.elementFromPoint)return d.target;var S=ch(d);return x.elementFromPoint(S.x,S.y)},getPagePoint:function(z){return Sp(z)&&(z=ah(z)),{x:z.pageX,y:z.pageY}},createObject:function(g,$){var v=new g;for(var X in $){var r=$[X];if(Fd(r))v[X]=r;else if(0===X.indexOf("s:"))v.s(X.substr(2),$[X]);else if(0===X.indexOf("a:"))v.a(X.substr(2),$[X]);else{var b=$h(X),r=$[X];v[b]?(v[b](r),"setToolTip"===b&&v.enableToolTip&&v.enableToolTip()):v[X]=r}}return v},setImage:function(k,c,L,G){var d=arguments.length;4===d?mj(k,G,c,L):2===d?nf(c)?mj(k,c):Hd(k,c):1===d&&mj(k,k)},getImage:function(M,y,j){var d;if(M==A)return A;if(Tp(M)?d=M:(d=fg[M],M&&d===e&&(Fp&&Fp[M]||mj(M,M))),y&&d&&d.tagName){var f;f="override"===j?"colors_override":"override_rgb"===j?"colors_override_rgb":"override_a"===j?"colors_override_a":"colors",d[f]||(d[f]={__count__:0});var K=d[f][y];return K||(d[f].__count__>b.imageCacheThreshold&&(d[f]={__count__:0}),K=jm(d,Lc(y),d.width,d.height,j),d[f][y]=K,d[f].__count__++),K}return d},isImageComplete:function(h,P,A){var d=Ef(h);if(!d)return!1;if(d.tagName)return d.complete;for(var w,h,x,R=d.comps,v=!0,T=0,m=R.length;m>T;T++)if(w=R[T],x=w.type,"image"===w.type){h=w.name,h&&h.func&&(h=_d(h,P));var S=Xg(h,P,A);if(!S){v=!1;break}}else if(Po.test(x)&&b.getCompType(x)===e){v=!1,Qo(x);break}return v},getId:function(){var I=1;return function(){return++I}}(),callLater:function(H,m,B,s){var C=function(){H.apply(m,B)};return s?$(C,s):_.requestAnimationFrame(C)},cancelLater:function(V,k){k?X(V):_.cancelAnimationFrame(V)},clone:function(x){if(null==x||"object"!=typeof x)return x;if(x instanceof Date){var D=new Date;return D.setTime(x.getTime()),D}if(x instanceof Array){for(var D=[],i=0,k=x.length;k>i;i++)D[i]=Cc(x[i]);return D}if(x instanceof Tr){for(var D=new Tr,i=0,k=x.length;k>i;i++)D.set(i,Cc(x.get(i)));return D}if(x instanceof ej)return x;if(x instanceof N){var D={};for(var m in x)x.hasOwnProperty(m)&&(D[m]=Cc(x[m]));return D}return x},callWhenLoaded:function(n,f){f=f||100;var y=lh(n,f);Un||(Un={}),Un[y]={tick:y,cb:n,delay:f}},beforeLoadURL:function(w,F){if(Un){var B={};for(var F in Un){var R=Un[F];X(R.tick);var t=lh(R.cb,R.delay);B[t]={tick:t,delay:R.delay,cb:R.cb}}Un=B}return b.convertURL?b.convertURL(w,F):w},convertURL:function(L){return L},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return b.getImage("default_blank")},resizeImagePOT:function(x,M){if(!x||!x.tagName)return x;var m=x.width,C=x.height;if(!m||!C)return x;if(Lh.isPOT(m)&&Lh.isPOT(C)&&(!M||m===C))return x;var T,K;M?K=T=Lh.nearestPOT(Math.min(m,C)):(T=Lh.nearestPOT(m),K=Lh.nearestPOT(C));var W=sn(),E=W.getContext("2d");return jk(W,T,K,1),E.drawImage(x,0,0,m,C,0,0,T,K),W},sortFunc:function(J,u){if(J===u)return 0;if(J==A&&u!=A)return 1;if(J!=A&&u==A)return-1;if(J==A&&u==A)return 0;var F,O=typeof J,x=typeof u;return O===Cf&&x===Cf?F=J.localeCompare(u):O===sc&&x===sc&&(F=J-u),F===e&&(F=(""+J).localeCompare(""+u)),F>0?1:0>F?-1:0},getClassMap:function(){return Gn},getClass:function(w){if(nf(w)){var m,L=Gn[w];if(!L){m=w.split("."),L=_;for(var b=0;b<m.length;b++)L=L[m[b]];Gn[w]=L}return L}return w},def:function(o,m,F){var H,c,q,_=function(){};if(_.prototype=m.prototype,H=new _,nf(o)){if(Gn[o])throw"'"+o+"' already defined";q=us(o),H.getClassName=function(){return o}}else q=o;if(H.constructor=q,H.getClass=function(){return q},H.getSuperClass=function(){return m},F)for(c in F)Uq[c]&&Uq.hasOwnProperty(c)?Uq[c](H,F):gb(H,F,c);q.prototype=H,q.superClass=m.prototype},startAnim:function(){var K=function(g){g.duration&&(g.startTime=mr()),g.timeId=Wg(g.tick,A,A,g.interval)};return function(i){return i=Cc(i),i.easing=i.easing||b.animEasing,i.duration||i.frames||(i.duration=b.animDuration),i.t=0,i.duration?i.interval=0:(i.frame=0,i.interval=i.interval||10),i.tick=function(){if(i.duration){var $=(mr()-i.startTime)/i.duration;if($>1&&($=1),i.t=$,i.action(i.easing($),$),!i.isRunning())return;1===$?i.stop():i._isPaused||(i.timeId=Wg(i.tick))}else{if(i.frame++,$=i.t=i.frame/i.frames,i.action(i.easing($),$),!i.isRunning())return;i.frame<i.frames?i._isPaused||(i.timeId=Wg(i.tick,A,A,i.interval)):i.stop()}},i.resume=function(){i._isPaused&&(delete i._isPaused,i.duration?i.t<1&&(i.startTime=mr()-i.duration*i.t,i.timeId=Wg(i.tick)):i.frame<i.frames&&(i.timeId=Wg(i.tick,A,A,i.interval)))},i.pause=function(){$p(i.timeId,!i.duration),i._isPaused=!0},i.isPaused=function(){return this._isPaused},i.stop=function(A){i.isRunning()&&($p(i.timeId,!i.duration),delete i.timeId,i.duration?i.t<1&&A&&(i.t=1,i.action(i.easing(1),1)):i.frame<i.frames&&A&&(i.frame=i.frames,i.action(i.easing(1),1)),i._37o&&i._37o(),i.finishFunc&&i.finishFunc())},i.isRunning=function(){return i.timeId!=A},i.delay?Wg(K,A,[i],i.delay):K(i),i}}(),getTextSize:function(){var T={},l=x?sn().getContext("2d"):A;return function(V,_){l.font=V?V:Ek;var N=T[l.font];return N||(N=2*l.measureText("e").width+4,T[l.font]=N),{width:l.measureText(_).width+4,height:N}}}(),drawText:function(j,V,T,Z,h,Q,U,q,v,W){if(V!=A){var c=Io(T,V),l={};l.y=W&&W!==sg?W===Oe?Q+c.height/2:Q+q-c.height/2:Q+q/2,l.x=v&&v!==Rc?v===Pc?h+U-c.width/2:h+U/2:h+c.width/2,bi(j,V,l,T,Z)}},getDistance:function(L,q){var c=L.length;return q?3===c?D(k(L[0]-q[0])+k(L[1]-q[1])+k(L[2]-q[2])):2===c?D(k(L[0]-q[0])+k(L[1]-q[1])):L.z===e?D(k(q.x-L.x)+k(q.y-L.y)):D(k(q.x-L.x)+k(q.y-L.y)+k(q.z-L.z)):3===c?D(k(L[0])+k(L[1])+k(L[2])):2===c?D(k(L[0])+k(L[1])):void 0},brighter:function(e,D){return 0>D&&(D=-D),Wh(e,D?D:40)},darker:function(W,p){return p>0&&(p=-p),Wh(W,p?p:-40)},unionPoint:function(o,c){if(!o)return A;if(2===arguments.length)return o&&c?{x:C(o.x,c.x),y:C(o.y,c.y),width:T(o.x-c.x),height:T(o.y-c.y)}:A;var S=o;if(S._as&&(S=S._as),S.length===e)return A;var u=S.length;if(0>=u)return A;for(var V=1,j=S[0],O={x:j.x,y:j.y,width:0,height:0};u>V;V++){j=S[V];var d=C(O.x,j.x),M=a(O.x+O.width,j.x),m=C(O.y,j.y),E=a(O.y+O.height,j.y);O.x=d,O.y=m,O.width=M-d,O.height=E-m}return O},unionRect:function(H,U){if(H&&!U)return Cc(H);if(!H&&U)return Cc(U);if(H&&U){var c={x:C(H.x,U.x),y:C(H.y,U.y)};return c.width=a(H.x+H.width,U.x+U.width)-c.x,c.height=a(H.y+H.height,U.y+U.height)-c.y,c}return A},containsPoint:function(o,w,Y,H){if(H!=A&&1!==H){var Q=o.x+o.width/2,X=o.y+o.height/2;o={x:Q-o.width/2*H,y:X-o.height/2*H,width:o.width*H,height:o.height*H}}if(Y){var p=o.width/2,q=o.height/2,f=j(-Y),e=E(-Y),u=w.x-o.x-p,z=w.y-o.y-q;return w={x:e*u-f*z,y:f*u+e*z},dg({x:-p,y:-q,width:o.width,height:o.height},w)}return!(!o||w.x<o.x||w.y<o.y||w.x>o.x+o.width||w.y>o.y+o.height)},containsRect:function(J,n){if(!J||!n)return!1;var L=n.x,m=n.y,x=n.width,Q=n.height,z=J.width,X=J.height;if(0>(z|X|x|Q))return!1;var b=J.x,q=J.y;if(b>L||q>m)return!1;if(z+=b,x+=L,L>=x){if(z>=b||x>z)return!1}else if(z>=b&&x>z)return!1;if(X+=q,Q+=m,m>=Q){if(X>=q||Q>X)return!1}else if(X>=q&&Q>X)return!1;return!0},intersectsRect:function(R,Z){if(!R||!Z)return!1;var S=Z.width,z=Z.height,G=R.width,E=R.height;if(0>=G||0>=E||0>=S||0>=z)return!1;var I=Z.x,w=Z.y,j=R.x,y=R.y;return G+=j,E+=y,S+=I,z+=w,G>I&&E>w&&S>j&&z>y},intersection:function(u,o){if(!u||!o)return A;var O=o.x,v=o.y,r=u.x,m=u.y,N=O,G=v,E=r,S=m;return N+=o.width,G+=o.height,E+=u.width,S+=u.height,r>O&&(O=r),m>v&&(v=m),N>E&&(N=E),G>S&&(G=S),N-=O,G-=v,0>=N||0>=G?A:{x:O,y:v,width:N,height:G}},grow:function(n,h,o){o===e&&(o=h),n.x-=h,n.y-=o,n.width=n.width+2*h,n.height=n.height+2*o},getScreenPoint:function(H,Q,K,b,i,v,e){var z=K.getBoundingClientRect(),r=H*(v||1)-K.scrollLeft+(b||0),L=Q*(e||1)-K.scrollTop+(i||0),X=fo(K,!1);if(X){var $=new ps(r,L,0);return $.applyMatrix4(X),console.log($),{x:$.x,y:$.y}}return{x:r+z.left,y:L+z.top}},getLogicalPoint:function(y,H,j,a,M,N){var d,o,m=H.getBoundingClientRect();y.target?(Kc(y)?qd?de["91"]=!0:de["17"]=!0:qd?de["91"]=!1:de["17"]=!1,de["16"]=kj(y)?!0:!1,y=Sp(y)?ah(y):y,d=y.clientX,o=y.clientY):(d=y.x,o=y.y);var R=fo(H,!0);if(R){var g=new ps(d,o,0);g.applyMatrix4(R);do{if(Math.abs(g.z)<=1e-6)break;var c=new ps(d,o,1);if(c.applyMatrix4(matrix),Math.abs(c.z)<=1e-6){g=c;break}if(c.sub(g),Math.abs(c.z)<=1e-6)break;g.addScaledVector(c,-g.z/c.z)}while(!1);return{x:(g.x+H.scrollLeft-(j||0))/(M||1),y:(g.y+H.scrollTop-(a||0))/(N||1)}}return{x:(d-m.left+H.scrollLeft-(j||0))/(M||1),y:(o-m.top+H.scrollTop-(a||0))/(N||1)}},removeHTML:function(){var J;return function(k){return k&&k.getView&&(k=k.getView()),k&&k.parentNode?J===k?!0:(J=k,k.parentNode.removeChild(k),J=A,!0):!1}}(),getToolTipDiv:function(){if(!wk){wk=ob(),Qk=ob();var Q=wk.style;b.baseZIndex!=A&&(Q.zIndex=y(b.baseZIndex)+3+""),Q.whiteSpace="nowrap",Q.color=b.toolTipLabelColor,Q.background=b.toolTipBackground,Q.font=b.toolTipLabelFont,Q.padding="5px",Q.boxShadow="0px 0px 3px "+b.toolTipShadowColor}return wk},isToolTipShowing:function(){return wk&&wk.parentNode?!0:Qk&&Qk.parentNode?!0:!1},hideToolTip:function(){Sc(wk),Sc(Qk),lp()},showToolTip:function(k,x){if(!k||x==A)return lr(),void 0;b.getToolTipDiv();var d,o;if(x.html?(x=x.html,d=Qk,Sc(wk)):(d=wk,Sc(Qk)),o=d.style,d.innerHTML=x,d.parentNode||P.Default.appendToScreen(d),k.target){k=ch(k);var c=fi(),v=k.x,w=k.y,F=tc?60:12;if(tc){var V=d.getBoundingClientRect();o.left=v-V.width/2+bl,o.top=w-V.height-F<c.top?w+F+bl:w-V.height-F+bl}else{o.left=v+F+bl,o.top=w+F+bl;var V=d.getBoundingClientRect();V.left+V.width>c.width&&(o.left=v-F-V.width+bl),V.top+V.height>c.height&&(o.top=w-F-V.height+bl),V.left<0&&(o.left=v+F+bl),V.top<0&&(o.top=w+F+bl)}}else o.left=k.x+bl,o.top=k.y+bl;lp()},startDragging:function(m,c,k){k==e&&(k=!0),m!==si&&(si?k&&(Sp(c)?si.handleWindowTouchEnd(c):si.handleWindowMouseUp(c)):Sp(c)?(d(_,vh,Yg),d(_,is,fc)):(d(_,xq,ur),d(_,Sq,Me)),si=m)},getImageMap:function(){return fg},toBoundaries:function(P,Y,V,y){var D=[];return vm(P,Y,V,y).forEach(function(Y){var n=[];Y.forEach(function($){n.push($.x,$.y)}),D.push(n)}),D},getCurrentKeyCodeMap:function(){return de},drawCenterImage:function(n,u,D,Q,d,Y,_,B){!d&&Y&&Y.isSelfViewEvent&&(d=Y);var b=pl(u,d,Y),P=Vf(u,d,Y);Vh(n,u,W(D-b/2),W(Q-P/2),b,P,d,Y,_,B)},drawStretchImage:function(X,P,f,l,H,N,p,Q,d,I,a,A){!Q&&d&&d.isSelfViewEvent&&(Q=d);var Z,J=pl(P,Q,d,N),G=Vf(P,Q,d,p);"uniform"===f?(Z=C(N/J,p/G),J*=Z,G*=Z,l+=W((N-J)/2),H+=W((p-G)/2),N=J,p=G):"centerUniform"===f&&((J>N||G>p)&&(Z=C(N/J,p/G),J*=Z,G*=Z),l+=W((N-J)/2),H+=W((p-G)/2),N=J,p=G);var g=X.interactiveInfo;if(g){var e;if(e="center"===f?{x:l+N/2-J/2,y:H+p/2-G/2,width:J,height:G}:{x:l,y:H,width:N,height:p},g.rect){var b=g.compInfos,r=b.length;r&&(b[r-1].rect.image=P)}else g.rect=e}if("center"===f){var n=a!==!1&&(J>N||G>p);n&&(X.save(),X.beginPath(),X.rect(l,H,N,p),X.clip()),Vh(X,P,l+N/2-J/2,H+p/2-G/2,J,G,Q,d,I,A),n&&X.restore()}else Vh(X,P,l,H,N,p,Q,d,I,A)},toCanvas:function(A,G,o,P,y,b,I,c,V){A=Ef(A,I),G=G||pl(A,y),o=o||Vf(A,y);var L=sn(),D=Sl(L);return c?(jk(L,G,o,c),D.scale(c,c)):jk(L,G,o,1),Pf(D,A,P,0,0,G,o,y,b,I,V),A&&A.clampToEdge&&(L.clampToEdge=A.clampToEdge),D.restore(),L},toGrayColor:function(r){if(!r)return r;var y=qo(r),Z=W(.299*y[0]+.587*y[1]+.114*y[2]);return"rgba("+Z+","+Z+","+Z+","+y[3]/255+")"},createGradientImage:function(H,$,F,d){for(var Z=["L",0,0,H,0,1,0,0,1,0,0],_=0,C=Math.min($.length,F.length);C>_;_++)Z.push(F[_],$[_]);var g=P.Default.toCanvas({width:H,height:H,clampToEdge:!0,comps:[{type:"shape",rotation:d||0,points:[0,0,H,0,H,H,0,H],background:"#ffffff",gradientPack:Z}]});return g},createElement:function(k,u,Y,r){var N=x.createElement(k);return Vd(N,u||p.widgetBorder,2),N.style.font=Y?Y:Ek,r!=A&&(N.value=r),b.onElementCreated&&b.onElementCreated(N),N},containedInView:function(e,G){var J=If(G).getBoundingClientRect();return dg({x:J.left,y:J.top,width:J.width,height:J.height},nq(e))},isIsolating:function(){return fq>0},setIsolating:function(I){I?fq++:fq--},getMSMap:function(){return Uq},stringify:function(V,q,K){var t=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var w=JSON.stringify(V,function(M,r){return"function"==typeof r?"__ht__"+(r.__ht__||r.toString()):vp(r)?al(r):r instanceof P.List?"__ht__list"+(r.__ht__list||b.stringify(r._as)):r},q==A?2:q);return Date.prototype.toJSON=t,K&&(w="__ht__encode"+b.encodeString(w)),w},parse:function(W){return nf(W)?"__ht__encode"!=W.substr(0,12)||(W=b.decodeString(W.substr(12)),nf(W))?JSON.parse(W,function(v,Z){if(nf(Z))if("__ht__function"==Z.substr(0,14)){var k=Z.indexOf("{")+1,H=Z.lastIndexOf("}"),D=Z.indexOf("(")+1,w=Z.indexOf(")");if(k&&H&&D&&w){var Q=new Function(Z.substring(D,w),Z.substring(k,H));return Q.__ht__=Z.substr(6),Q}}else{if("__ht__date"==Z.substr(0,10))return new Date(y(Z.substr(10)));if("__ht__list"===Z.substr(0,10))return new Tr(b.parse(Z.substr(10)))}return Z}):W:W},loadJS:function(n,v){v&&n.push(v);var k=n.shift();if(Fl(k))n=k.contact(n),b.loadJS(n);else if(Fd(k))k(),b.loadJS(n);else if(nf(k)){var U=x.createElement("script");U.onload=function(){b.loadJS(n)},U.setAttribute("src",k),x.getElementsByTagName("head")[0].appendChild(U)}else n.length&&b.loadJS(n)},extendClass:function(y,e){var f=y.prototype;for(var j in e)Uq[j]&&Uq.hasOwnProperty(j)?Uq[j](f,e):f[j]=e[j]},toRoundedCorner:function(){function p(t,z,r){t.x=z.x,t.y=z.e||r,t.z=z.y}var z=new ps,P=new ps,N=new ps,L=new ps;return function(U,j){var Y,q=0;U.getPoints&&(q=U.getElevation(),U=U.getPoints()),Y=U instanceof Tr?U:new Tr(U);var f=Y.size();if(0>=j)return{points:Y};var i=new Tr,D=new Tr,J=Y.get(0);p(z,J,q),i.add(J),D.add(1);for(var Q=1;f>Q;Q++)if(f>Q+1){var C=Y.get(Q),A=Y.get(Q+1);p(P,C,q),p(N,A,q),L.subVectors(z,P).setLength(Math.min(.99*L.length(),j)).add(P),C.e!==e||J.e!==e?i.add({x:L.x,y:L.z,e:L.y}):i.add({x:L.x,y:L.z}),i.add(C),L.subVectors(N,P).setLength(Math.min(.99*L.length(),j)).add(P),C.e!==e||A.e!==e?i.add(J={x:L.x,y:L.z,e:L.y}):i.add(J={x:L.x,y:L.z}),z.copy(L),D.addAll([2,3])}else i.add(Y.get(Q)),D.add(2);return{points:i,segments:D}}}(),toColorData:qo,setCanvas:jk,createDiv:ob,createDisabledDiv:db,createView:tf,createCanvas:sn,appendChild:Ho,initContext:Sl,checkLoadingImage:mh,translateAndScale:cm,layout:di,getPosition:Ne,drawPoints:xh,drawRoundRect:Cd,drawBorder:Yf,setFocus:Pg,getter:_j,setter:$h,isEmptyObject:Ah,cameraPriority:function(){var K={skybox:0,main:1e4,top:1e7};return N.seal(N.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return K.skybox},set:function(J){if(J>=K.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");K.skybox=Number(J)}},main:{configurable:!1,enumerable:!1,get:function(){return K.main},set:function(G){if(G<=K.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(G>=K.top)throw new RangeError("Main camera must have lower priority than the top camera.");
K.main=Number(G)}},top:{configurable:!1,enumerable:!1,get:function(){return K.top},set:function(H){if(H<=K.main)throw new RangeError("Top camera must have higher priority than the main camera.");K.top=Number(H)}}}))}()},!0),Ec(q,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Sb=b.disabledOpacity,ik=b.toolTipDelay,Af=b.devicePixelRatio,mm=b.autoMakeVisible,hd=b.autoHideScrollBar,rj=b.imageGradient,gh=b.showToolTip,lr=b.hideToolTip,Ac=b.dashPattern,$q=b.lineCap,We=b.lineJoin,Rl=b.labelColor,uk=b.labelSelectColor,Ek=b.labelFont,cj=b.widgetIndent,$l=b.widgetRowHeight,ag=b.widgetHeaderHeight,qk=b.widgetTitleHeight,xm=b.scrollBarColor,gg=b.scrollBarSize,ke=b.scrollBarTimeout,ng=b.scrollBarMinLength,Pj=b.scrollBarInteractiveSize,bh=b.zoomIncrement,Ic=b.scrollZoomIncrement,zi=b.pinchZoomIncrement,Ki=b.zoomMax,_p=b.zoomMin,Ld=b.createObject,Rj=b.preventDefault,nk=b.setImage,Ef=b.getImage,Xg=b.isImageComplete,te=b.drawCenterImage,Pf=b.drawStretchImage,lo=b.getId,Wg=b.callLater,$p=b.cancelLater,wb=b.sortFunc,Cc=b.clone,us=b.getClass,_c=b.startAnim,Co=b.brighter,Pm=b.darker,wo=b.drawText,Io=b.getTextSize,Qf=b.isLeftButton,vk=b.isMiddleButton,ws=b.isRightButton,xs=b.getTouchCount,or=b.isDoubleClick,kj=b.isShiftDown,Kc=b.isCtrlDown,nq=b.getClientPoint,ch=b.getPagePoint,np=b.getDistance,mo=b.unionPoint,qh=b.unionRect,dg=b.containsPoint,hn=b.containsRect,Ub=b.intersectsRect,kn=b.intersection,fi=b.getWindowInfo,Qj=b.grow,Uc=b.getLogicalPoint,yh=b.getScreenPoint,qf=b.startDragging,Sc=b.removeHTML,oo=b.createElement,je=b.segmentResolution,Yh=b.shapeResolution,tk=b.shapeSide,$g=b.def,hh=function(Q,X,L){$g(h+"."+Q,X,L)},vf=function(G,i){G.childNodes.forEach(function(u){i(u),vf(u,i)})};Ec(b,{toolTipLabelColor:Rl,toolTipLabelFont:Ek,toolTipBackground:p.toolTipBackground,toolTipShadowColor:ze,debugTipLabelFont:Ek,debugTipLabelColor:Rl,debugTipBackground:p.toolTipBackground,drawBreakableText:cs,setDevicePixelRatio:function(o){Af=b.devicePixelRatio="number"==typeof o?o:_.devicePixelRatio,vf(x.body,function(M){var F=M._ht;F&&F._canvas&&(jk(F._canvas,F.getWidth(),F.getHeight()),F.redraw?F.redraw():F.iv())})}},!0);var dd=1e-6,Bk="undefined"!=typeof Uint16Array?Uint16Array:Array,On="undefined"!=typeof Float32Array?Float32Array:Array,Nm=function(X,S,W){var O=[X[0]-S[0],X[1]-S[1],X[2]-S[2]];if(W){var i=np(O);i>0&&(O[0]/=i,O[1]/=i,O[2]/=i)}return O},Lq=function(){var e="charCodeAt",c=2*(2*be.length+1);for(var w in _)if(w===h+Rc[0]+(bl.length+2)){var o=_[w];if(!o)break;for(var i=o.length,Q=0;i>Q;Q++)if(o[Q][e](0)===c&&o[Q+1]!=A&&o[Q+1]===bl[0]&&o[Q+2]!=A&&o[Q+2][e](0)===c){for(var F=Q+3;i>F;F++)if(o[F][e](0)===c){if(0==o[F+1])for(var s,p=F+2;i>p;p++){if(o[p][e](0)===c){0==o[p-1]&&s&&(mg=s.substr(0,s.length-1));break}s==A?s=o[p]:s+=o[p]}break}break}break}return function(P){return[-P[0],-P[1],-P[2]]}}(),Hi=function(O,U){return 3===O.length?O[0]*U[0]+O[1]*U[1]+O[2]*U[2]:O[0]*U[0]+O[1]*U[1]},om=function(){var c=new On(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},ts=om(),Md=function(h){var n=new On(16);return n[0]=h[0],n[1]=h[1],n[2]=h[2],n[3]=h[3],n[4]=h[4],n[5]=h[5],n[6]=h[6],n[7]=h[7],n[8]=h[8],n[9]=h[9],n[10]=h[10],n[11]=h[11],n[12]=h[12],n[13]=h[13],n[14]=h[14],n[15]=h[15],n},hs=function(r,w){return r[0]=w[0],r[1]=w[1],r[2]=w[2],r[3]=w[3],r[4]=w[4],r[5]=w[5],r[6]=w[6],r[7]=w[7],r[8]=w[8],r[9]=w[9],r[10]=w[10],r[11]=w[11],r[12]=w[12],r[13]=w[13],r[14]=w[14],r[15]=w[15],r},Qe=function(N){return N[0]=1,N[1]=0,N[2]=0,N[3]=0,N[4]=0,N[5]=1,N[6]=0,N[7]=0,N[8]=0,N[9]=0,N[10]=1,N[11]=0,N[12]=0,N[13]=0,N[14]=0,N[15]=1,N},rm=function(W,D){var V=W[0],r=W[1],t=W[2];return W[0]=D[0]*V+D[4]*r+D[8]*t+D[12],W[1]=D[1]*V+D[5]*r+D[9]*t+D[13],W[2]=D[2]*V+D[6]*r+D[10]*t+D[14],W},Nr=function(O,R){var W=O[0],C=O[1],x=O[2],L=O[3];return O[0]=R[0]*W+R[4]*C+R[8]*x+R[12]*L,O[1]=R[1]*W+R[5]*C+R[9]*x+R[13]*L,O[2]=R[2]*W+R[6]*C+R[10]*x+R[14]*L,O[3]=R[3]*W+R[7]*C+R[11]*x+R[15]*L,O},rf=function(){var W,z,C,v,M=Zf(eh[1]+eh[7]),f=Zf(eh[0]+eh[3]-eh[10]),l=Zf(eh[8]+2),q=function(){return z=C.charAt(W),W+=1,z},x=function(){var O="";if(z===l)for(;q();){if(z===l)return q(),O;O+=z}else q()},u=function(){for(;z&&" ">=z;)q()},B=function(){var B,c={};if(z===M){if(q(),u(),z===f)return q(),c;for(;z;){if(B=x(),u(),q(),c[B]=v(),u(),z===f)return q(),c;q(),u()}}};return v=function(){switch(u(),z){case M:return B();default:return x()}},function(p){if(L={},p){var Z;if(C=p,W=0,z=" ",Z=v(),u(),!z)return Z}}}(),ed=function(g,Z){if(Z){var p=j(Z),C=E(Z),v=g[4],F=g[5],u=g[6],_=g[7],h=g[8],I=g[9],G=g[10],e=g[11];g[4]=v*C+h*p,g[5]=F*C+I*p,g[6]=u*C+G*p,g[7]=_*C+e*p,g[8]=h*C-v*p,g[9]=I*C-F*p,g[10]=G*C-u*p,g[11]=e*C-_*p}},Gr=function(D,m){if(m){var W=j(m),q=E(m),I=D[0],f=D[1],$=D[2],H=D[3],K=D[8],x=D[9],O=D[10],s=D[11];D[0]=I*q-K*W,D[1]=f*q-x*W,D[2]=$*q-O*W,D[3]=H*q-s*W,D[8]=I*W+K*q,D[9]=f*W+x*q,D[10]=$*W+O*q,D[11]=H*W+s*q}},lq=function(t,v){if(v){var b=j(v),a=E(v),R=t[0],l=t[1],g=t[2],I=t[3],$=t[4],T=t[5],k=t[6],N=t[7];t[0]=R*a+$*b,t[1]=l*a+T*b,t[2]=g*a+k*b,t[3]=I*a+N*b,t[4]=$*a-R*b,t[5]=T*a-l*b,t[6]=k*a-g*b,t[7]=N*a-I*b}},ro=function(w,p,K){return mq(A,K===!1?A:w.getFinalScale3d(),w.getFinalRotation3d(),w.getRotationMode(),w.p3(),A,p)},mq=function(n,q,s,h,T,X,g){return X||(X=om()),T&&ac(X,T),No(X,s,h),g&&Vg(X,X,g),q&&Zg(X,q),n&&Vg(X,X,n),X},Lf=function(D,c,z){c=y(c),z=y(z);var i=this;i.g=D,i._84O=c,i._85O=z,i._70I=!0,i.F=0,i._83O=c+z,i.pen={x:0,y:0}},sk="lineDashOffset",Rk="setLineDash",An=function(l){for(var X in l)1===X.length&&(sk=l[X]);return X?1:0},Zd=function(x,E,y){return ye(E)?x:x[Rk]?(x[Rk](E),y&&(x.lineDashOffset=y),x):new Lf(x,E[0],E.length>1?E[1]:E[0])},Yd=function(h,m){!ye(m)&&h[Rk]&&(h[Rk](ue),h.lineDashOffset=0)};if($g(Lf,N,{_69I:6,moveTo:function(y,T){var p=this,k=p.pen;k.x=y,k.y=T,p.g.moveTo(y,T),p.start||(p.start={x:y,y:T})},lineTo:function(d,y){var w=this,f=w.pen,F=d-f.x,I=y-f.y,r=o(I,F),q=E(r),B=j(r),p=w._23O(f.x,f.y,d,y),m=w._85O,G=w._84O,X=w._83O;if(w.F){if(w.F>p)return w._70I?w._72I(d,y):w.moveTo(d,y),w.F-=p,void 0;if(w._70I?w._72I(f.x+q*w.F,f.y+B*w.F):w.moveTo(f.x+q*w.F,f.y+B*w.F),p-=w.F,w.F=0,w._70I=!w._70I,!p)return}var l=z(p/X);if(l){for(var $=q*G,Y=B*G,V=q*m,M=B*m,c=0;l>c;c++)w._70I?(w._72I(f.x+$,f.y+Y),w.moveTo(f.x+V,f.y+M)):(w.moveTo(f.x+V,f.y+M),w._72I(f.x+$,f.y+Y));p-=X*l}w._70I?p>G?(w._72I(f.x+q*G,f.y+B*G),w.moveTo(d,y),w.F=m-(p-G),w._70I=!1):(w._72I(d,y),p===G?(w.F=0,w._70I=!w._70I):(w.F=G-p,w.moveTo(d,y))):p>m?(w.moveTo(f.x+q*m,f.y+B*m),w._72I(d,y),w.F=G-(p-m),w._70I=!0):(w.moveTo(d,y),p===m?(w.F=0,w._70I=!w._70I):w.F=m-p)},quadraticCurveTo:function(o,j,m,k){var x,s=this,r=s.pen,W=r.x,V=r.y,y=s._22O(W,V,o,j,m,k),t=0,D=0,e=s._85O,$=s._84O;if(s.F){if(s.F>y)return s._70I?s._71I(o,j,m,k):s.moveTo(m,k),s.F-=y,void 0;if(t=s.F/y,x=s._20O(W,V,o,j,m,k,t),s._70I?s._71I(x[2],x[3],x[4],x[5]):s.moveTo(x[4],x[5]),s.F=0,s._70I=!s._70I,!y)return}var w=y-y*t,i=z(w/s._83O),O=$/y,v=e/y;if(i)for(var g=0;i>g;g++)s._70I?(D=t+O,x=s._21O(W,V,o,j,m,k,t,D),s._71I(x[2],x[3],x[4],x[5]),t=D,D=t+v,x=s._21O(W,V,o,j,m,k,t,D),s.moveTo(x[4],x[5])):(D=t+v,x=s._21O(W,V,o,j,m,k,t,D),s.moveTo(x[4],x[5]),t=D,D=t+O,x=s._21O(W,V,o,j,m,k,t,D),s._71I(x[2],x[3],x[4],x[5])),t=D;w=y-y*t,s._70I?w>$?(D=t+O,x=s._21O(W,V,o,j,m,k,t,D),s._71I(x[2],x[3],x[4],x[5]),s.moveTo(m,k),s.F=e-(w-$),s._70I=!1):(x=s._19O(W,V,o,j,m,k,t),s._71I(x[2],x[3],x[4],x[5]),y===$?(s.F=0,s._70I=!s._70I):(s.F=$-w,s.moveTo(m,k))):w>e?(D=t+v,x=s._21O(W,V,o,j,m,k,t,D),s.moveTo(x[4],x[5]),x=s._19O(W,V,o,j,m,k,D),s._71I(x[2],x[3],x[4],x[5]),s.F=$-(w-e),s._70I=!0):(s.moveTo(m,k),w===e?(s.F=0,s._70I=!s._70I):s.F=e-w)},bezierCurveTo:function(){var B=arguments;this.pen={x:B[4],y:B[5]},this.g.bezierCurveTo(B[0],B[1],B[2],B[3],B[4],B[5])},arc:function(Z,J,Q,N,D,L){L||(N=-N,D=-D),Qr(this,Z,J,N,D-N,Q,Q,!1)},rect:function(J,I,G,p){var A=this;A.pen={x:J,y:I},A.moveTo(J,I),A.lineTo(J,I+p),A.lineTo(J+G,I+p),A.lineTo(J+G,I),A.lineTo(J,I)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(O,b,o,B){var d=o-O,p=B-b;return D(d*d+p*p)},_22O:function(V,x,L,n,l,B,O){for(var e,Y,k,G,R,M,b,s=0,I=V,N=x,p=O>0?O:this._69I,r=1;p>=r;r++)k=r/p,G=1-k,R=G*G,M=2*k*G,b=k*k,e=R*V+M*L+b*l,Y=R*x+M*n+b*B,s+=this._23O(I,N,e,Y),I=e,N=Y;return s},_21O:function(W,f,G,n,z,v,p,H){var Z=this;if(0===p)return Z._20O(W,f,G,n,z,v,H);if(1===H)return Z._19O(W,f,G,n,z,v,p);var h=Z._20O(W,f,G,n,z,v,H);return h.push(p/H),Z._19O.apply(Z,h)},_20O:function(J,_,e,O,q,w,W){if(1!==W){var f=e+(q-e)*W,H=O+(w-O)*W;e=J+(e-J)*W,O=_+(O-_)*W,q=e+(f-e)*W,w=O+(H-O)*W}return[J,_,e,O,q,w]},_19O:function(Y,k,C,T,l,b,O){if(1!==O){var x=Y+(C-Y)*O,v=k+(T-k)*O;C+=(l-C)*O,T+=(b-T)*O,Y=x+(C-x)*O,k=v+(T-v)*O}return[Y,k,C,T,l,b]},_72I:function(L,d){var q=this.pen;(L!==q.x||d!==q.y)&&(q.x=L,q.y=d,this.g.lineTo(L,d))},_71I:function(Q,U,E,s){var h=this.pen;(Q!==E||U!==s||E!==h.x||s!==h.y)&&(h.x=E,h.y=s,this.g.quadraticCurveTo(Q,U,E,s))}}),H&&Wk){var yc=Wk.toString();s=yc.indexOf(am.substr(0,2))>0&&yc.indexOf(Oe+Oe.substr(1,1))>1||yc.indexOf(Wn.substr(0,2)+am.substr(2,2)+Rc[0]+am[4])>1?!0:!1}var Fm=A,De=A,Ii=b.checkLoadingCompType=function(f){Fm&&!f._72O&&(De||(De={}),De[f._72O=lo()]=f)},Qo=function(m,O){if(O||(O=m),O&&(Fm||(Fm={}),!Fm[m])){var F=new en;if(Fm[O]={request:F,url:O},O=b.beforeLoadURL(O,m),O.data){var J=b.parse(O.data);$e(m,J),b.handleCompTypeLoaded(m,J)}else{F.onload=function(){if(200===this.status||0===this.status){var J=b.parse(F.getResponseText());$e(m,J),b.handleCompTypeLoaded(m,J)}else $e(m,A)},F.onerror=function(){$e(m,A)};var G={};G.url=encodeURI(O),G.sync=!1,F.send(G)}}},$e=function(B,q){if(Eq[B]=q,delete Fm[B],Ah(Fm)&&(Fm=A,De)){for(var m in De){var U=De[m];U.invalidateAll&&U.invalidateAll(e,"compTypeLoaded",B),U.redraw&&U.redraw(),U.iv(),delete U._72O}De=A}if(q&&De)for(var m in De){var U=De[m];U.invalidateAll&&U.invalidateAll(e,"compTypeLoading",B),U.redraw&&U.redraw(),U.iv()}},Ik=p.chart,uo="",Vn=!0,Cj=b.compStack=[],Lk=/^style@/,Dc=/^attr@/,qb=/^field@/,kp={x:.5,y:.5},Pn=function(){Vn=!0},Ih=function(){return Vn},pl=function(Q,$,q,V){if(!Q)return 0;if(_d(Q.fitSize,$,q)&&V)return V;var m=_d(Q.width,$,q);return null==m?20:m},Vf=function(D,k,r,n){if(!D)return 0;if(_d(D.fitSize,k,r)&&n)return n;var J=_d(D.height,k,r);return null==J?20:J},_d=function(F,H,B){if(!F||!F.func)return F;var u,h=F.func,i=F.value;return u=Fd(h)?B&&B.vectorDataBindingDisabled&&!F.isSafeFunc?i:h(H,B):H instanceof ej||(P.ui?H instanceof P.ui.View:0)?Dc.test(h)?H.a(uo+h.slice(5)):Lk.test(h)?H.s(uo+h.slice(6)):qb.test(h)?H[h.slice(6)]:H[h]?H[h](B):i:i,i!==e&&u==A?i:u},Vh=b.drawImage=function(){var Q,m,q,M,k,P,c=function(n,u){n.getValue&&n.getValue.compType===u||(n.getValue=function(Q){var H=Z(n,Q);if(H===e&&u.properties){var $=u.properties[Q];$&&(H=$.defaultValue)}return H},n.getColor=function(d){return i(n.getValue(d))},n.getValue.compType=u)},Z=function(A,X,J){var l,Q=!1;if(A.prefix&&m instanceof ej){var u=m.a(uo+X);u!==e&&(Q=!0,l=u)}return l===e&&(l=A[X]),l&&l.func&&(Q=!0,l=_d(l,m,q)),J&&(l=J(l),Q||(A[X]=l)),l},i=function(f,M){var r;if(r=M?Z(f,M):f,Q&&Q.compGray&&r)return b.toGrayColor(r);if(k&&r){if("override"===P)return k;if("override_rgb"===P){var i=Lc(k);return r=qo(r),"rgba("+W(255*i[0])+","+W(255*i[1])+","+W(255*i[2])+","+r[3]/255+")"}if("override_a"===P){var i=Lc(k);return r=qo(r),"rgba("+r[0]+","+r[1]+","+r[2]+","+i[3]+")"}var i=Lc(k);return r=qo(r),"rgba("+W(r[0]*i[0])+","+W(r[1]*i[1])+","+W(r[2]*i[2])+","+r[3]/255*i[3]+")"}return r},G=function(F){if(Fl(F)){for(var M=new Tr,e=F.length,W=0;e>W;W+=2)M.add({x:F[W],y:F[W+1]});F=M}return F},Y=function(S){var M=Z(S,"anchorX"),c=Z(S,"anchorY");if(M!==e||c!==e)return{x:M===e?kp.x:M,y:c===e?kp.y:c};var q=Z(S,"type"),O=Z(S,"name");if("image"!==q||!O)return kp;var A=Ef(O);return A&&A.anchorX!==e&&A.anchorY!==e?{x:A.anchorX,y:A.anchorY}:kp},X=function(z,$){var b=Z(z,Dl),S=Y(z);if(Fl(b)){var K=b.length,_=Z(z,"relative"),t=$.width,f=$.height;if(4===K)b={x:b[0],y:b[1],width:b[2],height:b[3]},_&&(b.x*=t,b.y*=f,b.width*=t,b.height*=f);else if(3===K){var i=b[0];b={width:b[1],height:b[2]},_&&(b.width*=t,b.height*=f),"object"==typeof i?i.length&&(i={x:i[0],y:i[1]}):i=Ne(i,$,b),b.x=i.x-b.width*S.x,b.y=i.y-b.height*S.y}b.x+=Z(z,"offsetX")||0,b.y+=Z(z,"offsetY")||0,!_&&$.fitSize&&(b=h(z,b,$))}return b},h=function(o,D,b){if(D){var r,_,w,g={x:D.x,y:D.y,width:D.width,height:D.height},a=Y(o),n=Z(o,"layoutH"),L=Z(o,"layoutV"),u=1,S=1,y=0,d=0,c=1,K=1;switch(n){case"left":break;case"right":g.x+=b.width-b.rw;break;case"center":g.x+=.5*(b.width-b.rw);break;case"scale":case"leftright":default:r=Z(o,oq)||0,r&&(y=Math.abs(d=Math.sin(r)),c=Math.abs(K=Math.cos(r))),"leftright"!==n?(u+=c*(b.widthScale-1),S+=y*(b.widthScale-1)):(u+=g.width?c*(b.width-b.rw)/g.width:0,S+=g.height?y*(b.width-b.rw)/g.height:0,_=-Math.min(-a.x*K+a.y*d,-a.x*K-(1-a.y)*d,(1-a.x)*K+a.y*d,(1-a.x)*K-(1-a.y)*d))}switch(L){case"top":break;case"bottom":g.y+=b.height-b.rh;break;case"center":g.y+=.5*(b.height-b.rh);break;case"scale":case"topbottom":default:r==A&&(r=Z(o,oq),r&&(y=Math.abs(d=Math.sin(r)),c=Math.abs(K=Math.cos(r)))),"topbottom"!==L?(u+=y*(b.heightScale-1),S+=c*(b.heightScale-1)):(u+=g.width?y*(b.height-b.rh)/g.width:0,S+=g.height?c*(b.height-b.rh)/g.height:0,w=-Math.min(-a.x*d-a.y*K,-a.x*d+(1-a.y)*K,(1-a.x)*d-a.y*K,(1-a.x)*d+(1-a.y)*K))}return(1!==u||1!==S)&&("scale"!==n&&n?"leftright"===n&&(g.x+=g.width*(1-u)*a.x+_*(b.width-b.rw)):g.x+=g.x*(b.widthScale-1)+a.x*g.width*(b.widthScale-u),"scale"!==L&&L?"topbottom"===L&&(g.y+=g.height*(1-S)*a.y+w*(b.height-b.rh)):g.y+=g.y*(b.heightScale-1)+a.y*g.height*(b.heightScale-S),g.width*=u,g.height*=S),g.width<0&&(g.width=0),g.height<0&&(g.height=0),g}},z=function(o){return Fl(o)?new Tr(o):o},t=function(g,A,F,w,K,M,p){var L=Q.interactiveInfo,j=g.transform;if(j)return Q.save(),Q.setTransform(j.a,j.b,j.c,j.d,j.tx,j.ty),L&&L.compInfos.push({comp:g,rect:A,matrix:j.clone(),prefix:uo,refRect:L.refRect}),!0;K===e&&(K=1),M===e&&(M=1);var N=Z(g,"clipPercentage"),B=Bh(F,A);if(B&&!w&&1===K&&1===M&&!(1>N))return L&&L.compInfos.push({comp:g,rect:A,matrix:L.matrix.clone(),prefix:uo,refRect:L.refRect}),!1;p=p||kp;var z=A.x+A.width*p.x,c=A.y+A.height*p.y,n=F.x+F.width*p.x,H=F.y+F.height*p.y,f=F.width?K*(A.width/F.width):1,V=F.height?M*(A.height/F.height):1;if(Q.save(),L&&(L.matrix.appendTranslate(z,c).appendRotate(w).appendScale(f,V).appendTranslate(-n,-H),L.compInfos.push({comp:g,rect:A,matrix:L.matrix.clone(),prefix:uo,refRect:L.refRect})),Xf(Q,z,c),jb(Q,w||0),Jp(Q,f,V),Xf(Q,-n,-H),1>N){0>N&&(N=0);var u=jo(F,Z(g,"clipDirection"),N);return Q.beginPath(),Q.rect(u.x,u.y,u.width,u.height),Q.clip(),u}return!0},J=function(i,y){if(!(i instanceof Boolean)){var s=Z(y,"clipGradient");if(s!=A&&s>0){Q.globalCompositeOperation="destination-out";var K=getClipGradientAndRect(Q,i,Z(y,"clipDirection"),s);Q.fillStyle=K.gradient;var u=K.rect;Q.fillRect(u.x,u.y,u.width,u.height)}}Q.restore()},s=function(B,k,E){var X=Z(B,"path"),C=Z(B,oq),g=Z(B,"scaleX"),R=Z(B,"scaleY"),m=Y(B),h=A,f=Ji(null,X);if(E||(E=B.unionRect,E||(E=mo(f),B.path.func||(B.unionRect=E)),h=E),E){h||(h=B.unionRect,h||(h=mo(f),B.path.func||(B.unionRect=h)));var S=t(B,E,h,C,g,R,m),K=Z(B,"borderPattern"),D=Zd(Q,K),T=i(B,"background"),x=i(B,"borderColor"),w=Z(B,"borderWidth"),V=Z(B,"gradient"),v=i(B,"gradientColor"),l=Z(B,"border3d"),G=i(B,"border3dColor"),b=Z(B,"border3dAccuracy"),o=Q.lineJoin,r=Q.lineCap;Q.lineJoin=Z(B,"borderJoin")||We,Q.lineCap=Z(B,"borderCap")||$q,T?(bn(Q,T,V,v,h),Ji(Q,X),Q.fill(),D!==Q&&Ji(Q,X)):Ji(Q,X);var W=Z(B,"borderWidthAbsolute");if(W&&(Q.save(),Q.setTransform(1,0,0,1,0,0)),w&&x&&(Q.lineWidth=w,Q.strokeStyle=x,Q.stroke(),l&&Bs(Q,x,G,w,M,b)),Yd(Q,K),Z(B,"dash")){var e=Z(B,"dashWidth")||w;if(e>0){K=Z(B,"dashPattern")||Ac;var D=Zd(Q,K,Z(B,"dashOffset")),j=i(B,"dashColor")||i(xf);D!==Q&&Ji(Q,X),Q.strokeStyle=j,Q.lineWidth=e,Q.stroke(),Z(B,"dash3d")&&Bs(Q,j,i(B,"dash3dColor"),e,M,Z(B,"dash3dAccuracy")),Yd(Q,K)}}W&&Q.restore(),k===Dl&&Eg(Q,T,Z(B,"depth"),h),Q.lineJoin=o,Q.lineCap=r,S&&J(S,B)}},u=function(g,o,p,B){var R=Z(g,od,G),N=Z(g,oq),v=Y(g);if(R&&B.fitSize){var c=new Tr,X=mo(R),H=h(g,X,B),W=X.x+v.x*X.width,O=X.y+v.y*X.height,e=H.x+v.x*H.width,F=H.y+v.y*H.height,f=X.width?H.width/X.width:1,l=X.height?H.height/X.height:1;R.each(function(I){c.add({x:e+(I.x-W)*f,y:F+(I.y-O)*l})}),R=c,g.unionRect=null}var $=Z(g,"scaleX"),x=Z(g,"scaleY"),d=o===Mh,U=A;if(!p&&d&&(p=g.unionRect,p||(p=mo(R),g.points.func||(g.unionRect=p)),U=p),p){d?U||(U=g.unionRect,U||(U=mo(R),g.points.func||(g.unionRect=U))):U=p;var C,j,S,D,y=t(g,p,U,N,$,x,v),a=Z(g,"borderPattern"),L=Zd(Q,a),T=i(g,"background"),b=Ef(Z(g,"repeatImage"),k,P),u=Z(g,"gradientPack"),s=i(g,"borderColor"),r=Z(g,"borderWidth"),n=Z(g,"segments",z),w=Z(g,"gradient"),V=i(g,"gradientColor"),E=Z(g,"border3d"),I=i(g,"border3dColor"),_=Z(g,"border3dAccuracy"),K=Z(g,"closePath"),le=Z(g,"fillRule")||"nonzero",zr=Q.lineJoin,Em=Q.lineCap;if(Q.lineJoin=Z(g,"borderJoin")||We,Q.lineCap=Z(g,"borderCap")||$q,d)if(T||b||u){var Xi,Bn=Z(g,"fillClipPercentage");if(1>Bn&&(0>Bn&&(Bn=0),Xi=jo(U,Z(g,"fillClipDirection"),Bn),Q.save(),Q.beginPath(),Q.rect(Xi.x,Xi.y,Xi.width,Xi.height),Q.clip()),xh(Q,R,n,K),u?Tc(Q,u):b?Vp(Q,b,k,P,m,q):bn(Q,T,w,V,U),Q.fill(le),1>Bn){var Hq=Z(g,"fillClipGradient");if(Hq!=A&&Hq>0){Q.globalCompositeOperation="destination-out";var oj=getClipGradientAndRect(Q,Xi,Z(g,"fillClipDirection"),Hq);Q.fillStyle=oj.gradient;var ls=oj.rect;Q.fillRect(ls.x,ls.y,ls.width,ls.height)}Q.restore()}u&&Q.restore(),L!==Q&&xh(L,R,n,K)}else xh(L,R,n,K);else if("roundRect"===o?C=Z(g,"cornerRadius"):"polygon"===o?C=Z(g,"polygonSide"):"arc"===o&&(C=Z(g,"arcFrom"),j=Z(g,"arcTo"),S=Z(g,"arcClose"),D=Z(g,"arcOval")),T||b||u){var Xi,Bn=Z(g,"fillClipPercentage");if(1>Bn&&(0>Bn&&(Bn=0),Xi=jo(U,Z(g,"fillClipDirection"),Bn),Q.save(),Q.beginPath(),Q.rect(Xi.x,Xi.y,Xi.width,Xi.height),Q.clip()),yl(Q,o,U,C,j,S,D),u?Tc(Q,u):b?Vp(Q,b,k,P,m,q):bn(Q,T,w,V,U),Q.fill(le),1>Bn){var Hq=Z(g,"fillClipGradient");if(Hq!=A&&Hq>0){Q.globalCompositeOperation="destination-out";var oj=getClipGradientAndRect(Q,Xi,Z(g,"fillClipDirection"),Hq);Q.fillStyle=oj.gradient;var ls=oj.rect;Q.fillRect(ls.x,ls.y,ls.width,ls.height)}Q.restore()}u&&Q.restore(),Q!==L&&yl(L,o,U,C,j,S,D)}else yl(L,o,U,C,j,S,D);var sn=Z(g,"borderWidthAbsolute");if(sn&&(Q.save(),Q.setTransform(1,0,0,1,0,0)),r&&s&&(Q.lineWidth=r,Q.strokeStyle=s,Q.stroke(),E&&Bs(Q,s,I,r,M,_)),Yd(Q,a),Z(g,"dash")){var yc=Z(g,"dashWidth")||r;if(yc>0){a=Z(g,"dashPattern")||Ac;var L=Zd(Q,a,Z(g,"dashOffset")),pj=i(g,"dashColor")||i(xf);L!==Q&&(d?xh(L,R,n,K):yl(L,o,U,C,j,S,D)),Q.strokeStyle=pj,Q.lineWidth=yc,Q.stroke(),Z(g,"dash3d")&&Bs(Q,pj,i(g,"dash3dColor"),yc,M,Z(g,"dash3dAccuracy")),Yd(Q,a)}}sn&&Q.restore(),o===Dl&&Eg(Q,T,Z(g,"depth"),U),Q.lineJoin=zr,Q.lineCap=Em,y&&J(y,g)}},o=function(W,b){var K=k||Z(W,jq),L=P||Z(W,"blendMode"),w=Z(W,"name"),y=Ef(w,K,L);y?Pf(Q,y,Z(W,"stretch"),b.x,b.y,b.width,b.height,m,q,K,null,L):Vn=!1},I=function(L,p){var g=Z(L,"text");g!=A&&wo(Q,g,Z(L,"font"),i(L,jq),p.x,p.y,p.width,p.height,Z(L,"align"),Z(L,"vAlign"))},B=function(E,t){Yf(Q,i(E,jq),t.x,t.y,t.width,t.height,Z(E,"width"))},n=function(X,p){var h=Z(X,Oj),H=0;if(h&&(h.forEach(function(f){H+=f}),H>0)){for(var J=Z(X,"colors")||Ik,F=Z(X,"startAngle")||0,o=Z(X,"hollow"),B=Z(X,ls),n=Z(X,Dr),r=Z(X,df),y=B?new Tr:A,f=p.x,Y=p.y,D=p.width,e=p.height,V=f+D/2,u=Y+e/2,P=C(D,e)/2,S=0,t=0;t<h.length;t++){var T=h[t],b=U*T/H,l=F+b;if(Q.fillStyle=J[S++],S===J.length&&(S=0),Q.beginPath(),o){var I=V+E(F)*P/2,v=u+j(F)*P/2,k=V+E(l)*P,i=u+j(l)*P;Q.moveTo(I,v),Q.arc(V,u,P/2,F,l,!1),Q.lineTo(k,i),Q.arc(V,u,P,l,F,!0)}else Q.moveTo(V,u),Q.arc(V,u,P,l,F,!0);y&&(b=(F+l)/2,y.add({text:Fd(B)?B(T,t,H,m):T,x:V+.75*E(b)*P,y:u+.75*j(b)*P})),Q.closePath(),Q.fill(),F=l}y&&y.each(function(C){wo(Q,C.text,n,r,C.x,C.y,0,0,Le)})}},l=function(s,v){var Y=Z(s,Ad);if(Y&&Y.length>0){var O=Y.length,d=Z(s,ls),z=Z(s,Dr),F=Z(s,df),D=d?new Tr:A,f=Z(s,"minValue")||0,N=Z(s,"maxValue");if(N==A&&(N=0,Y.forEach(function(I){Z(I,Oj).forEach(function($){N=a(N,$)})})),f===N)return;for(var M=v.height/(N-f),K=v.y+N*M,C=Z(Y[0],Oj).length,i=v.width/(3*C+1),w=2*i/O,E=0,j=0;O>j;j++)for(var l=Y[j],h=Z(l,jq),r=Z(l,"colors"),o=Z(l,Oj),k=0;C>k;k++){r?Q.fillStyle=r[k]:h?Q.fillStyle=h:(Q.fillStyle=Ik[E++],E===Ik.length&&(E=0));var q=o[k],$=q*M,W=v.x+(1+3*k)*i+j*w;if(ld(Q,W,K-$,w,$),D){var y=Fd(d)?d(q,k,l,m):q,g=Io(z,y).height;D.add({x:W,y:K-$-g,width:w,height:g,text:y})}}D&&D.each(function(o){wo(Q,o.text,z,F,o.x,o.y,o.width,o.height,Le)})}},f=function(y,g){var v=Z(y,Ad);if(v&&v.length>0){var X=v.length,U=Z(v[0],Oj).length,N=g.width/(3*U+1),C=0,J=Z(y,"maxValue"),l=Z(y,ls),x=Z(y,Dr),L=Z(y,df),R=l?new Tr:A;if(J==A){J=0;for(var M=0;U>M;M++){for(var k=0,K=0;X>K;K++)k+=Z(v[K],Oj)[M];J=a(J,k)}}if(J>0){for(var M=0;U>M;M++)for(var b=g.y+g.height,K=0;X>K;K++){var i=v[K],h=Z(i,jq),B=Z(i,Oj)[M],o=B/J*g.height;h?Q.fillStyle=h:(Q.fillStyle=Ik[C++],C===Ik.length&&(C=0)),b-=o;var r={x:g.x+(1+3*M)*N,y:b,width:2*N,height:o};ld(Q,r.x,r.y,r.width,r.height),R&&(r.text=Fd(l)?l(B,M,i,m):B,R.add(r))}R&&R.each(function(j){wo(Q,j.text,x,L,j.x,j.y,j.width,j.height,Le)})}}},r=function(O,s){var $=Z(O,Ad);if($&&$.length>0){for(var q=$.length,k=Z($[0],Oj).length,G=s.width/(3*k+1),v=0,e=Z(O,ls),R=Z(O,Dr),x=Z(O,df),Y=e?new Tr:A,P=0;k>P;P++){for(var C=0,X=0;q>X;X++)C+=Z($[X],Oj)[P];if(C>0){var i=s.y+s.height;for(X=0;q>X;X++){var p=$[X],l=Z(p,jq),W=Z(p,Oj)[P],M=W/C*s.height;l?Q.fillStyle=l:(Q.fillStyle=Ik[v++],v===Ik.length&&(v=0)),i-=M;var B={x:s.x+(1+3*P)*G,y:i,width:2*G,height:M};ld(Q,B.x,B.y,B.width,B.height),Y&&(B.text=Fd(e)?e(W,P,p,m):W,Y.add(B))}}}Y&&Y.each(function(u){wo(Q,u.text,R,x,u.x,u.y,u.width,u.height,Le)})}},R=function(i,z){var b=Z(i,Ad);if(b&&b.length>0){var q=b.length,T=Z(i,"minValue")||0,x=Z(i,"maxValue");if(x==A&&(x=0,b.forEach(function(u){Z(u,Oj).forEach(function(G){x=a(x,G)})})),T===x)return;for(var u=z.height/(x-T),o=z.y+x*u,k=Z(b[0],Oj).length,d=z.width/(3*k+1),e=0,$=Z(i,"lineWidth")||2,I=Z(i,"line3d"),p=Z(i,"linePoint"),j=Z(i,ls),P=Z(i,Dr),X=Z(i,df),l=0;q>l;l++){var f=b[l],C=Z(f,jq),E=Z(f,Oj);C?Q.strokeStyle=C:(C=Q.strokeStyle=Ik[e++],e===Ik.length&&(e=0)),Q.beginPath();for(var h=0;k>h;h++){var H=z.x+(2+3*h)*d,w=o-E[h]*u;0===h?Q.moveTo(H,w):Q.lineTo(H,w)}if(Q.lineWidth=$,Q.stroke(),I&&Bs(Q,C,A,$,M),p||j){var O,n=$/2+2;for(h=0;k>h;h++){var Y=E[h];if(H=z.x+(2+3*h)*d,w=o-Y*u,Fd(p)?p(Q,H,w,C,h,f,m):p&&(Q.fillStyle=C,Q.beginPath(),Q.arc(H,w,n,0,U,!0),Q.fill()),Fd(j)?O=j(Y,h,f,m):j&&(O=Y),O){var D=Io(P,O).height,g=Q.shadowBlur;if(g){var N=Q.shadowOffsetX,B=Q.shadowOffsetY,R=Q.shadowColor;Q.shadowOffsetX=0,Q.shadowOffsetY=0,Q.shadowBlur=0,Q.shadowColor=A}wo(Q,O,P,X,H,w-D-n+2,0,D,Le),g&&(Q.shadowOffsetX=N,Q.shadowOffsetY=B,Q.shadowBlur=g,Q.shadowColor=R)}}}}}},D=function(e){Q=e[0],m=e[1],q=e[2],M=e[3],k=e[4],P=e[5]},K=function(){return[Q,m,q,M,k,P]},v=function(C,c){var Y;q&&q.getDrawableState?Y=q.getDrawableState(m):q&&q.getState?Y=q.getState(m):(Y=m instanceof ej?m.s(pm):null,(Y===e||null===Y)&&(Y=Z(C,pm)));var J=Z(c,pm);return J!==e&&null!==J&&J!==Y?!1:Z(c,ap)},x={border:B,image:o,text:I,pieChart:n,columnChart:l,stackedColumnChart:f,percentageColumnChart:r,lineChart:R};return function(r,l,F,g,W,f,N,C,I,$){if(l&&W&&f){var T=K();Q=r,m=N,q=C,!m&&q&&q.isSelfViewEvent&&(m=q),M=q?q._zoom?q._zoom:1:1,k=I,P=$;var j=W,y=f;if(vd()){var d,w,L,R,B;0===Q[Gg]?vd[0]&&(d=!0):d=!0,Q.texureImage2D?vd[1]&&(w=!0):w=!0,Q.texureImage3D?vd[2]&&(L=!0):L=!0,Q.drawDNDState?vd[3]&&(B=!0):B=!0,Gi.widget[0]?vd[4]&&(R=!0):R=!0,d&&w&&L&&R&&B&&(j=F,y=g)}if(l.tagName)return nf(mg)&&!_[mg]||Q.drawImage(l,j,y,W,f),D(T),void 0;if(Z(l,"visible")===!1)return D(T),void 0;k||(k=_d(l.color,m,q)),$||(P=_d(l.blendMode,m,q)),nf(mg)&&!_[mg]&&(W=j,f=y);var H=pl(l,m,q,W),V=Vf(l,m,q,f),p={x:0,y:0,width:H,height:V,fitSize:Z(l,"fitSize")},S=Z(l,"clip"),h=Z(l,"opacity");if(p.fitSize){var E=p.rw=_d(l.width,m,q)||20;p.widthScale=H/E;var O=p.rh=_d(l.height,m,q)||20;p.heightScale=V/O}if(Q.save(),Q.interactiveInfo){var U=Q.interactiveInfo.matrix,o=U.clone();U.appendTranslate(j,y).appendScale(W/H,f/V),Q.interactiveInfo.refRect=p}Xf(Q,j,y),(H!==W||V!==f)&&Q.scale(W/H,f/V),S&&(Fd(S)?S(Q,H,V,m,q,l):(Q.beginPath(),Q.rect(0,0,H,V),Q.clip())),h!=A&&(Q.globalAlpha*=h),Z(l,"comps").forEach(function(d){if(d.prefix){var P=uo,h=_d(d.prefix,m,q);h&&(uo=uo+h+".")}if(v(l,d)===!1)return d.prefix&&(uo=P),void 0;if(Cj.splice(0,0,d),Q.interactiveInfo)var j=Q.interactiveInfo.matrix.clone();var D=Z(d,"opacity"),S=Z(d,"shadow"),R=Z(d,"type"),T=Z(d,"refRect")||p,V=X(d,T);if(D!=A){var W=Q.globalAlpha;Q.globalAlpha*=D}if(S){var y=Q.shadowOffsetX,O=Q.shadowOffsetY,C=Q.shadowBlur,I=Q.shadowColor,r=Z(d,"shadowOffsetX"),U=Z(d,"shadowOffsetY"),E=Z(d,"shadowBlur"),B=i(d,"shadowColor");Q.shadowOffsetX=(r==A?3:r)*M,Q.shadowOffsetY=(U==A?3:U)*M,Q.shadowBlur=(E==A?6:E)*M,Q.shadowColor=B||i(Zr)}if("save"===R)Q.save();else if("endClip"===R||"restore"===R)Q.restore();else if("clip"===R)Q.save(),xh(Q,Z(d,"points",G),Z(d,"segments",z),!0),Q.clip();else if(Mf[R])V=V||{x:0,y:0,width:T.width,height:T.height},u(d,R,V,T);else if(R===Mh)u(d,R,V,T);else if("SVGPath"===R)s(d,R,V);else{V=V||{x:0,y:0,width:T.width,height:T.height};var H=Z(d,oq),K=Z(d,"scaleX"),f=Z(d,"scaleY"),k=Y(d),n=t(d,V,V,H,K,f,k);if(Fd(R))c(d,R),b.drawCompType(R,Q,V,d,m,q);else if(b.getCompType(R)){var g=b.getCompType(R),N=g.func||g;c(d,g),b.drawCompType(N,Q,V,d,m,q)}else x[R]?x[R](d,V):b.getCompType(R)===e&&Po.test(R)&&Qo(R);n&&J(n,d)}S&&(Q.shadowOffsetX=y,Q.shadowOffsetY=O,Q.shadowBlur=C,Q.shadowColor=I),D!=A&&(Q.globalAlpha=W),Q.interactiveInfo&&(Q.interactiveInfo.matrix=j),d.prefix&&(uo=P),Cj.splice(0,1)}),Q.interactiveInfo&&(Q.interactiveInfo.matrix=o),Q.restore(),D(T)}}}();b.getCurrentComp=function(){return Cj[0]},b.getParentComp=function(){return Cj[1]},b.getInternal=function(){return{isEnter:rp,isEsc:dk,isSpace:Kn,isLeft:el,isUp:Pk,isRight:cg,isDown:Dd,addMethod:Ec,superCall:yf,toPointsArray:vm,translateAndScale:cm,appendArray:oj,createWorldMatrix:mq,vec3TransformMat4:rm,setCanvas:jk,createDiv:ob,createView:tf,createCanvas:sn,createImage:pn,initContext:Sl,layout:di,fillRect:ld,Mat:md,drawBorder:Yf,isString:nf,setBorder:Vd,getPropertyValue:Li,setPropertyValue:Qq,drawVerticalLine:me,draw3DRect:Eg,getPinchDist:Xl,isSameRect:Bh,getPosition:Ne,intersectionLineRect:Ff,getNodeRect:kb,getEdgeAgentPosition:Rb,getEdgeHostPosition:gd,getImageWidth:pl,getImageHeight:Vf,initItemElement:Vm,drawPoints:xh,createG2:Zd,closePopup:Jb,isH:Nc,createAnim:Rf,createNormalMatrix:Mc,toColorArray:Lc,createNormals:Dn,toFloatArray:zr,glMV:Ae,glPop:gs,batchShape:Bn,createNodeMatrix:ro,getShapeModel:Ri,getFaceInfo:xc,transformAppend:Jg,drawFaceInfo:rr,to3dPointsArray:wf,setGLDebugMode:function(R){zo=R},cube:function(){return{vs:dl,is:Wd,uv:_i}},ui:function(){return{DataUI:Ej,NodeUI:op,EdgeUI:wc,GroupUI:Dq,ShapeUI:vq,GridUI:Vl,Data3dUI:wj,Node3dUI:Fr,Shape3dUI:qj}},getInternalVersion:function(){return"U2FsdGVkX183Gio8RPBTpvpkbMVt+uPetug9gnLj8NA="},getDragger:function(){return si},addMSMap:function(k){Ec(Uq,k)},k:f,addEventListener:d,removeEventListener:B}},function($){function O(O,X){O!=A&&(X==A&&Cf!=typeof O?this._54O(O,256):this._54O(O,X))}function N(){return new O(A)}function b(B,k,P,h,d,D){for(;--D>=0;){var T=k*this[B++]+P[h]+d;d=z(T/67108864),P[h++]=67108863&T}return d}function r(n,p,j,c,e,b){for(var I=32767&p,O=p>>15;--b>=0;){var v=32767&this[n],L=this[n++]>>15,q=O*v+L*I;v=I*v+((32767&q)<<15)+j[c]+(1073741823&e),e=(v>>>30)+(q>>>15)+O*L+(e>>>30),j[c++]=1073741823&v}return e}function Q(J,i,I,P,e,F){for(var K=16383&i,H=i>>14;--F>=0;){var G=16383&this[J],p=this[J++]>>14,C=H*G+p*K;G=K*G+((16383&C)<<14)+I[P]+e,e=(G>>28)+(C>>14)+H*p,I[P++]=268435455&G}return e}function T(y){return Wr.charAt(y)}function H(Q,r){var W=hs[Q.charCodeAt(r)];return W==A?-1:W}function e(Q){for(var r=this.t-1;r>=0;--r)Q[r]=this[r];Q.t=this.t,Q.s=this.s}function _(m){this.t=1,this.s=0>m?-1:0,m>0?this[0]=m:-1>m?this[0]=m+this.DV:this.t=0}function M(D){var S=N();return S._58O(D),S}function v(K,d){var L,Y=this;if(16==d)L=4;else if(8==d)L=3;else if(256==d)L=8;else if(2==d)L=1;else if(32==d)L=5;else{if(4!=d)return Y.fromRadix(K,d),void 0;L=2}Y.t=0,Y.s=0;for(var S=K.length,f=!1,Q=0;--S>=0;){var c=8==L?255&K[S]:H(K,S);0>c?"-"==K.charAt(S)&&(f=!0):(f=!1,0==Q?Y[Y.t++]=c:Q+L>Y.DB?(Y[Y.t-1]|=(c&(1<<Y.DB-Q)-1)<<Q,Y[Y.t++]=c>>Y.DB-Q):Y[Y.t-1]|=c<<Q,Q+=L,Q>=Y.DB&&(Q-=Y.DB))}8==L&&0!=(128&K[0])&&(Y.s=-1,Q>0&&(Y[Y.t-1]|=(1<<Y.DB-Q)-1<<Q)),Y._57O(),f&&O.ZERO._78O(Y,Y)}function L(){for(var w=this,R=w.s&w.DM;w.t>0&&w[w.t-1]==R;)--w.t}function q(s){var r=this;if(r.s<0)return"-"+r._85O()[gf](s);var Z;if(16==s)Z=4;else if(8==s)Z=3;else if(2==s)Z=1;else if(32==s)Z=5;else{if(4!=s)return r.toRadix(s);Z=2}var I,q=(1<<Z)-1,d=!1,u="",Y=r.t,J=r.DB-Y*r.DB%Z;if(Y-->0)for(J<r.DB&&(I=r[Y]>>J)>0&&(d=!0,u=T(I));Y>=0;)Z>J?(I=(r[Y]&(1<<J)-1)<<Z-J,I|=r[--Y]>>(J+=r.DB-Z)):(I=r[Y]>>(J-=Z)&q,0>=J&&(J+=r.DB,--Y)),I>0&&(d=!0),d&&(u+=T(I));return d?u:"0"}function p(){var E=N();return O.ZERO._78O(this,E),E}function k(){return this.s<0?this._85O():this}function S(U){var G=this,O=G.s-U.s;if(0!=O)return O;var Z=G.t;if(O=Z-U.t,0!=O)return G.s<0?-O:O;for(;--Z>=0;)if(0!=(O=G[Z]-U[Z]))return O;return 0}function x(z){var n,L=1;return 0!=(n=z>>>16)&&(z=n,L+=16),0!=(n=z>>8)&&(z=n,L+=8),0!=(n=z>>4)&&(z=n,L+=4),0!=(n=z>>2)&&(z=n,L+=2),0!=(n=z>>1)&&(z=n,L+=1),L}function R(){var o=this;return o.t<=0?0:o.DB*(o.t-1)+x(o[o.t-1]^o.s&o.DM)}function t(X,I){var s;for(s=this.t-1;s>=0;--s)I[s+X]=this[s];for(s=X-1;s>=0;--s)I[s]=0;I.t=this.t+X,I.s=this.s}function P(d,W){for(var n=d;n<this.t;++n)W[n-d]=this[n];W.t=a(this.t-d,0),W.s=this.s}function Z(E,S){var G,m=this,g=E%m.DB,e=m.DB-g,Z=(1<<e)-1,n=z(E/m.DB),W=m.s<<g&m.DM;for(G=m.t-1;G>=0;--G)S[G+n+1]=m[G]>>e|W,W=(m[G]&Z)<<g;for(G=n-1;G>=0;--G)S[G]=0;S[n]=W,S.t=m.t+n+1,S.s=m.s,S._57O()}function d(g,I){var U=this;I.s=U.s;var o=z(g/U.DB);if(o>=U.t)return I.t=0,void 0;var X=g%U.DB,u=U.DB-X,v=(1<<X)-1;I[0]=U[o]>>X;for(var p=o+1;p<U.t;++p)I[p-o-1]|=(U[p]&v)<<u,I[p-o]=U[p]>>X;X>0&&(I[U.t-o-1]|=(U.s&v)<<u),I.t=U.t-o,I._57O()}function X(O,d){for(var A=this,T=0,q=0,W=C(O.t,A.t);W>T;)q+=A[T]-O[T],d[T++]=q&A.DM,q>>=A.DB;if(O.t<A.t){for(q-=O.s;T<A.t;)q+=A[T],d[T++]=q&A.DM,q>>=A.DB;q+=A.s}else{for(q+=A.s;T<O.t;)q-=O[T],d[T++]=q&A.DM,q>>=A.DB;q-=O.s}d.s=0>q?-1:0,-1>q?d[T++]=A.DV+q:q>0&&(d[T++]=q),d.t=T,d._57O()}function c(A,N){var b=this.abs(),C=A.abs(),R=b.t;for(N.t=R+C.t;--R>=0;)N[R]=0;for(R=0;R<C.t;++R)N[R+b.t]=b.am(0,C[R],N,R,0,b.t);N.s=0,N._57O(),this.s!=A.s&&O.ZERO._78O(N,N)}function I(I){for(var Q=this.abs(),M=I.t=2*Q.t;--M>=0;)I[M]=0;for(M=0;M<Q.t-1;++M){var $=Q.am(M,Q[M],I,2*M,0,1);(I[M+Q.t]+=Q.am(M+1,2*Q[M],I,2*M+1,$,Q.t-M-1))>=Q.DV&&(I[M+Q.t]-=Q.DV,I[M+Q.t+1]=1)}I.t>0&&(I[I.t-1]+=Q.am(M,Q[M],I,2*M,0,1)),I.s=0,I._57O()}function Y(p,t,n){var h=p.abs(),I=this;if(!(h.t<=0)){var Q=I.abs();if(Q.t<h.t)return t!=A&&t._58O(0),n!=A&&I._77O(n),void 0;n==A&&(n=N());var r=N(),B=I.s,Y=p.s,C=I.DB-x(h[h.t-1]);C>0?(h._44O(C,r),Q._44O(C,n)):(h._77O(r),Q._77O(n));var y=r.t,P=r[y-1];if(0!=P){var u=P*(1<<I.F1)+(y>1?r[y-2]>>I.F2:0),R=I.FV/u,v=(1<<I.F1)/u,W=1<<I.F2,E=n.t,Z=E-y,f=t==A?N():t;for(r._59O(Z,f),n._52O(f)>=0&&(n[n.t++]=1,n._78O(f,n)),O.ONE._59O(y,f),f._78O(r,r);r.t<y;)r[r.t++]=0;for(;--Z>=0;){var $=n[--E]==P?I.DM:z(n[E]*R+(n[E-1]+W)*v);if((n[E]+=r.am(0,$,n,Z,0,y))<$)for(r._59O(Z,f),n._78O(f,n);n[E]<--$;)n._78O(f,n)}t!=A&&(n._45O(y,t),B!=Y&&O.ZERO._78O(t,t)),n.t=y,n._57O(),C>0&&n._46O(C,n),0>B&&O.ZERO._78O(n,n)}}}function B(B){var q=N();return this.abs()._49O(B,A,q),this.s<0&&q._52O(O.ZERO)>0&&B._78O(q,q),q}function n(y){this.m=y}function u(r){return r.s<0||r._52O(this.m)>=0?r.mod(this.m):r}function w(Z){return Z}function l(c){c._49O(this.m,A,c)}function i(i,A,F){i._47O(A,F),this._74O(F)}function o(d,L){d._48O(L),this._74O(L)}function G(){if(this.t<1)return 0;
var R=this[0];if(0==(1&R))return 0;var W=3&R;return W=15&W*(2-(15&R)*W),W=255&W*(2-(255&R)*W),W=65535&W*(2-(65535&(65535&R)*W)),W=W*(2-R*W%this.DV)%this.DV,W>0?this.DV-W:-W}function s(V){var u=this;u.m=V,u.mp=V._50O(),u.mpl=32767&u.mp,u.mph=u.mp>>15,u.um=(1<<V.DB-15)-1,u.mt2=2*V.t}function K(P){var a=N();return P.abs()._59O(this.m.t,a),a._49O(this.m,A,a),P.s<0&&a._52O(O.ZERO)>0&&this.m._78O(a,a),a}function J(m){var T=N();return m._77O(T),this._74O(T),T}function W(V){for(var B=this;V.t<=B.mt2;)V[V.t++]=0;for(var d=0;d<B.m.t;++d){var A=32767&V[d],Y=A*B.mpl+((A*B.mph+(V[d]>>15)*B.mpl&B.um)<<15)&V.DM;for(A=d+B.m.t,V[A]+=B.m.am(0,Y,V,d,0,B.m.t);V[A]>=V.DV;)V[A]-=V.DV,V[++A]++}V._57O(),V._45O(B.m.t,V),V._52O(B.m)>=0&&V._78O(B.m,V)}function Db(G,t){G._48O(t),this._74O(t)}function ar(w,J,c){w._47O(J,c),this._74O(c)}function tr(){return 0==(this.t>0?1&this[0]:this.s)}function Rh(e,L){if(e>4294967295||1>e)return O.ONE;var K=N(),z=N(),d=L._73O(this),P=x(e)-1;for(d._77O(K);--P>=0;)if(L._76O(K,z),(e&1<<P)>0)L._75O(z,d,K);else{var l=K;K=z,z=l}return L.revert(K)}function dm(f,S){var x;return x=256>f||S._51O()?new n(S):new s(S),this.exp(f,x)}function Np(){var i=this;if(i.s<0){if(1==i.t)return i[0]-i.DV;if(0==i.t)return-1}else{if(1==i.t)return i[0];if(0==i.t)return 0}return(i[1]&(1<<32-i.DB)-1)<<i.DB|i[0]}function ug(q,c){return new O(q,c)}function Lo(){var c=this;c.n=A,c.e=0,c.d=A,c.p=A,c.q=A,c.dmp1=A,c.dmq1=A,c._10A=A}function ve(c){return c._53O(this.e,this.n)}function qg(k){var J,i,q,X="",u=0;for(J=0;J<k.length&&k.charAt(J)!=ec;++J)q=Nh.indexOf(k.charAt(J)),0>q||(0==u?(X+=T(q>>2),i=3&q,u=1):1==u?(X+=T(i<<2|q>>4),i=15&q,u=2):2==u?(X+=T(i),X+=T(q>>2),i=3&q,u=3):(X+=T(i<<2|q>>4),X+=T(15&q),u=0));return 1==u&&(X+=T(i<<2)),X}function gq(x){var z=x.split(""),n=qg(x);return z.forEach(function(J){var N=J.length;N>0&&n&&(yg+=y(J))}),n}function Kb(C,T){var w=Ef._4O.Util._56O(C,"ss"),q={},X=0;return q.v=w==T,q.t=1,q.s=0>X?-1:0,dc=q.v,X>0?q[0]=X:-1>X?q[0]=X+q.DV:q.t=0,[w,q]}function Wd(m){var H=38,y=m.substring(0,H);if(y&&30==y.indexOf("05000420")){var W=["ss",m.substring(H)];return W}return[]}function Hg(Y,w){w=w.replace(vc,""),w=w.replace(/[ \n]+/g,"");var e=ug(w,16);if(e._55O()>this.n._55O())return 0;var O=this._37O(e),n=O[gf](16).replace(/^1f+00/,""),R=Wd(n);if(0==R.length)return!1;for(var p,t,u,b=.5,Z=tk,T=[0,.5,.75,.875,.9375],d=[],q=[],z=[],Q=U/Z,i=R[1],g=Kb(Y,i)[0],N=0,M=0;N<T.length;N++){var o=0===N%2?0:.5;for(p=0;Z>=p;p++)t=(p+o)*Q,u=1-T[N],d.push(E(t)*b*u,-b+2*T[N]*b,-j(t)*b*u),q.push((p+o)/Z,u)}for(N=0;N<T.length-1;N++){var k=N*(Z+1),c=(N+1)*(Z+1);for(p=0;Z>p;p++)z.push(k+p,c+p+1,c+p,k+p,k+p+1,c+p+1)}return z.forEach(function(x){M+=x}),i==g&&M>10}var $j,Hf=0xdeadbeefcafe,id=15715070==(16777215&Hf),gf="toString",$d="",bs="nat",zr=function(){};g=$["D"+11182[gf](F(2,5))];var Rd=O.prototype;Yo+=pj.substr(0,1);var di=$.navigator?$.navigator.appName:"";id&&"Microsoft Internet Explorer"==di?(Rd.am=r,$j=30):id&&"Netscape"!=di?(Rd.am=b,$j=26):(Rd.am=Q,$j=28),Rd.DB=$j,Rd.DM=(1<<$j)-1,Rd.DV=1<<$j;var tm=52;Rd.FV=F(2,tm),Rd.F1=tm-$j,Rd.F2=2*$j-tm;var cb,nk,Wr="0123456789abcdefghijklmnopqrstuvwxyz",hs=[],$o=function(k){return String.fromCharCode(k)};for(cb="0".charCodeAt(0),nk=0;9>=nk;++nk)hs[cb++]=nk;for(cb="a".charCodeAt(0),nk=10;36>nk;++nk)hs[cb++]=nk;for(cb="A".charCodeAt(0),nk=10;36>nk;++nk)hs[cb++]=nk;var Vb=n.prototype;Vb._73O=u,Vb.revert=w,Vb._74O=l,Vb._75O=i,Vb._76O=o;var Nc=s.prototype;Nc._73O=K,Nc.revert=J,Nc._74O=W,Nc._75O=ar,Nc._76O=Db,Rd._77O=e,Rd._58O=_,Rd._54O=v,Rd._57O=L,Rd._59O=t,Rd._45O=P,Rd._44O=Z,Rd._46O=d,Rd._78O=X,Rd._47O=c,Rd._48O=I,Rd._49O=Y,Rd._50O=G,Rd._51O=tr,Rd.exp=Rh,Rd.toString=q,Rd._85O=p,Rd.abs=k,Rd._52O=S,Rd._55O=R,Rd.mod=B,Rd._53O=dm,O.ZERO=M(0),O.ONE=M(1),Rd._86O=Np;var Tf=function(p,V){var Z=this;Z.isPublic=!0,typeof p!==Cf?(Z.n=p,Z.e=V):p!=A&&V!=A&&p.length>0&&V.length>0&&(Z.n=ug(p,16),Z.e=y(V,16))};$r=function(){var y,r,U=gq(Uh),t=U.substr(0,4),$=U.substr(4,2),h=U.substr(6,2),p=1,E=!p,W=f,L=[],v=rk.charAt(7);if(g&&(g[gf]().indexOf(bs)<0||g[Yo][gf]().indexOf(bs)<0||!U?y=A:(U=new g(t-0,$-p,h-0),r=U.setHours(9),g[Yo]()>r?y=qs[v]:E=!0)),U&&y&&y[0]&&y[m(.5)]&&W){var X=rf(y[0]),e=rf(y[1]);for(var B in e)L.push(B);var G,Y=0,n=X[L[Y]],I=e[L[Y++]],j=e[L[Y++]],k=e[L[Y++]],V=e[L[Y++]],D=e[L[Y++]],S=e[L[Y++]],d=X[L[Y]],o=e[L[Y++]],w=Hb._27O(W);if(n===I&&w&&o){G=I+j+k+V+D+S;var i=!S||S===Cl;if(!i&&S)for(var c,M=0,T=S.length;T>M;M++)S[M]===qp[Y]?c===Cl?i=!0:c[0]===Dp[5]&&Cl&&Cl.indexOf(c.substr(1))>=0?i=!0:c=A:(c==A?c=S[M]:c+=S[M],M===T-1&&(c===Cl?i=!0:c[0]===Dp[5]&&Cl&&Cl.indexOf(c.substr(1))>=0&&(i=!0)));G&&w._31O(G,o)&&w._31O(n,d)&&i&&(!D||g[Yo]()<D)&&(E=!0)}}return E||(yl=ye),v};var Dr=Lo.prototype;Dr._37O=ve,Dr._38O=Tf;var Nh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ec="=",hg=25,Lg=10,Uh="ICExU===",Cp=Cp||function(j,B){var R={},N=R._7A={},Z=N._6A=function(){function U(){}return{_80O:function(e){U.prototype=this;var $=new U;return e&&$._5A(e),$.hasOwnProperty("_82O")||($._82O=function(){$.$super._82O.apply(this,arguments)}),$._82O.prototype=$,$.$super=this,$},_3A:function(){var m=this._80O();return m._82O.apply(m,arguments),m},_82O:function(){},_5A:function(Z){for(var i in Z)Z.hasOwnProperty(i)&&(this[i]=Z[i]);Z.hasOwnProperty(gf)&&(this.toString=Z.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),s=N._39O=Z._80O({_82O:function(h,T){h=this._84O=h||[],this._65O=T!=B?T:4*h.length},toString:function(Z){return(Z||K).stringify(this)},_89O:function(j){var $=this._84O,Y=j._84O,x=this._65O,f=j._65O;if(this._57O(),x%4)for(var z=0;f>z;z++){var H=255&Y[z>>>2]>>>24-8*(z%4);$[x+z>>>2]|=H<<24-8*((x+z)%4)}else if(Y.length>65535)for(var z=0;f>z;z+=4)$[x+z>>>2]=Y[z>>>2];else $.push.apply($,Y);return this._65O+=f,this},_57O:function(){var q=this._84O,j=this._65O;q[j>>>2]&=4294967295<<32-8*(j%4),q.length=m(j/4)},_88O:function(){var O=Z._88O.call(this);return O._84O=this._84O.slice(0),O},_87O:function(n){for(var I=[],o=0;n>o;o+=4)I.push(0|4294967296*V);return new s._82O(I,n)}}),U=R._2A={},K=U._69O={stringify:function(n){var D,G=n._84O,V=n._65O,r=[];for(D=0;V>D;D++){var f=255&G[D>>>2]>>>24-8*(D%4);r.push((f>>>4).toString(16)),r.push((15&f).toString(16))}return r.join("")},_68O:function(E){for(var I=E.length,f=[],h=0;I>h;h+=2)f[h>>>3]|=y(E.substr(h,2),16)<<24-4*(h%8);return new s._82O(f,I/2)}},o=U._8A={stringify:function(I){var q,i=I._84O,L=I._65O,k=[];for(q=0;L>q;q++){var C=255&i[q>>>2]>>>24-8*(q%4);k.push($o(C))}return k.join("")},_68O:function(g){var A,W=g.length,I=[];for(A=0;W>A;A++)I[A>>>2]|=(255&g.charCodeAt(A))<<24-8*(A%4);return new s._82O(I,W)}},q=U._9A={stringify:function(M){try{return decodeURIComponent(escape(o.stringify(M)))}catch(w){throw new Error("")}},_68O:function($){return o._68O(unescape(encodeURIComponent($)))}},b=N._32O=Z._80O({_1A:function(){this._83O=new s._82O,this._23O=0},_33O:function(d){typeof d==Cf&&(d=q._68O(d)),this._83O._89O(d),this._23O+=d._65O},_25O:function(I){var D=this._83O,Q=D._84O,T=D._65O,E=this._79O,L=4*E,Z=T/L;Z=I?m(Z):a((0|Z)-this._22O,0);var p=Z*E,j=C(4*p,T);if(p){for(var U=0;p>U;U+=E)this._20O(Q,U);var u=Q.splice(0,p);D._65O-=j}return new s._82O(u,j)},_88O:function(){var y=Z._88O.call(this);return y._83O=this._83O._88O(),y},_22O:0});N._66O=b._80O({cfg:Z._80O(),_82O:function(M){this.cfg=this.cfg._80O(M),this._1A()},_1A:function(){b._1A.call(this),this._34O()},_81O:function(w){return this._33O(w),this._25O(),this},_72O:function(R){R&&this._33O(R);var h=this._21O();return h},_79O:16,_26O:function(w){return function(o,G){return new w._82O(G)._72O(o)}},_19O:function(O){return function(n,e){return new x._71O._82O(O,e)._72O(n)}}});var x=R._67O={};return R}();!function(){var _=Cp,e=_._7A,q=e._39O,p=e._66O,O=_._67O,T=[],H=[];!function(){function o(S){for(var L=D(S),l=2;L>=l;l++)if(!(S%l))return!1;return!0}function J(o){return 0|4294967296*(o-(0|o))}for(var W=2,A=0;64>A;)o(W)&&(8>A&&(T[A]=J(F(W,.5))),H[A]=J(F(W,1/3)),A++),W++}();var g=[],n=O._41O=p._80O({_34O:function(){this._64O=new q._82O(T.slice(0))},_20O:function(f,t){for(var $=this._64O._84O,I=$[0],V=$[1],E=$[2],B=$[3],J=$[4],G=$[5],S=$[6],M=$[7],v=0;64>v;v++){if(16>v)g[v]=0|f[t+v];else{var P=g[v-15],l=(P<<25|P>>>7)^(P<<14|P>>>18)^P>>>3,X=g[v-2],p=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;g[v]=l+g[v-7]+p+g[v-16]}var q=J&G^~J&S,z=I&V^I&E^V&E,u=(I<<30|I>>>2)^(I<<19|I>>>13)^(I<<10|I>>>22),K=(J<<26|J>>>6)^(J<<21|J>>>11)^(J<<7|J>>>25),n=M+K+q+H[v]+g[v],F=u+z;M=S,S=G,G=J,J=0|B+n,B=E,E=V,V=I,I=0|n+F}$[0]=0|$[0]+I,$[1]=0|$[1]+V,$[2]=0|$[2]+E,$[3]=0|$[3]+B,$[4]=0|$[4]+J,$[5]=0|$[5]+G,$[6]=0|$[6]+S,$[7]=0|$[7]+M},_21O:function(){var p=this._83O,V=p._84O,E=8*this._23O,g=8*p._65O;return V[g>>>5]|=128<<24-g%32,V[(g+64>>>9<<4)+14]=z(E/4294967296),V[(g+64>>>9<<4)+15]=E,p._65O=4*V.length,this._25O(),this._64O},_88O:function(){var O=p._88O.call(this);return O._64O=this._64O._88O(),O}});_._41O=p._26O(n),_._42O=p._19O(n)}();var vc=new RegExp("");vc.compile("[^0-9a-f]","gi"),Lo._28O=-1,Lo._29O=-2,Dr._31O=Hg,Dr._63O=Hg,Lo._43O=-2;var $e=new function(){var U=this;U._5O=function(R,V){if("8"!=R.substring(V+2,V+3))return 1;var S=y(R.substring(V+3,V+4));return 0==S?-1:S>0&&10>S?S+1:-2},U._13O=function(h,H){var b=U._5O(h,H);return 1>b?"":h.substring(H+2,H+2+2*b)},U._12O=function(V,L){var C=U._13O(V,L);if(""==C)return-1;var e;return e=y(C.substring(0,1))<8?new O(C,16):new O(C.substring(2),16),e._86O()},U._6O=function(t,S){var N=U._5O(t,S);return 0>N?N:S+2*(N+1)},U._11O=function(W,D){var p=U._6O(W,D),u=U._12O(W,D);return W.substring(p,p+2*u)},U._10O=function(G,Z){var w=U._6O(G,Z),a=U._12O(G,Z);return w+2*a},U._7O=function(Q,j){var C=[],p=U._6O(Q,j);C.push(p);for(var o=U._12O(Q,j),k=p,X=0;;){var u=U._10O(Q,k);if(u==A||u-p>=2*o)break;if(X>=200)break;C.push(u),k=u,X++}return C}};if($e._90O=$o(Lg+24),$e._91O=h+$o(Lg*Lg+8),Ef==A||!Ef)var Ef={};Ef._4O!=A&&Ef._4O||(Ef._4O={});var eh=Ef._4O;Ef._4O.Util=new function(){var Z=this;Z._56O=function(D){var g=new Ef._4O._3O;return g._30O(D)},Z._4A=function(f){var j=new Ef._4O._3O;return j._36O(f)},Z._11A=function(i){var m=new eh._3O;return m._30O(i)}},Ef._4O._3O=function(){var Y=this;Y._8O=function(e,K){if("ss"==e&&"cj"==K){try{Y.md=Cp._67O._41O._3A()}catch(m){zr($d)}Y._24O=function(u){Y.md._81O(u)},Y._35O=function(A){var n=Cp._2A._69O._68O(A);Y.md._81O(n)},Y._60O=function(){var u=Y.md._72O();return u[gf](Cp._2A._69O)},Y._30O=function(q){return Y._24O(q),Y._60O()},Y._36O=function(h){return Y._35O(h),Y._60O()}}},Y._24O=function(){zr($d)},Y._35O=function(){zr($d)},Y._60O=function(){zr($d)},Y._30O=function(){zr($d)},Y._36O=function(){zr($d)},Y._8O("ss","cj")},zl=function(E){var l=Sf[ce[7]],j=1,I=!1;if(fb.a!=Sf[sc])return fb.a;if(fb.forEach(function(v){j*=v}),E>j){if(l&&l[1]&&l[0]){var P=l[0],k=l[1];k=k.split($e._90O),P=P.split($e._90O);var S=k[3],$=P[3],q=k[7],H=k[11],u=k[15],A=k[19],f=k[23],d=k[27],w=P[7],b=S+q+H+u+A+f,T=f?!1:!0,o=$===S;if(f){var r=f&&f.split($h("firefox")[3]);if(r)for(var L=0;L<r.length;L++){var Z=r[L];if(Z[0]===ph[8]&&(Z=Z.substring(1)),Ze.indexOf(Z)>=0){T=!0;break}}}I=o&&wr()($,w)&&wr()(b,d)&&T&&(!A||A>E),I&&H.indexOf(Ab.length)>=0&&(zl[Ab.length]=Ab),I&&H.indexOf(Ab.length+1)>=0&&(zl[Ab.length+1]=Ab),I&&H.indexOf(Ab.length+3)>=0&&(zl[Ab.length+3]=Ab)}I||(Ej.prototype._42=Aj)}else I=!0,zl[Ab.length]=zl[Ab.length+1]=zl[Ab.length+3]=Ab;return fb.a=I,I},hg=String.fromCharCode(hg+20);var Ml=function(b){return b=b.replace(vc,$d),b=b.replace(/[ \n]+/g,$d)},vm="30",Lc="06",Sd="02",Qi="03",Xm=ug,xr=/^1f+00/,Hb=function(){var Y;return Y={_18O:function(C){var y=C,H=y.replace(/\s+/g,""),B=qg(H);return B},_14O:function(_){var O=this._18O(_),z=this._15O(O);return z},_15O:function(N){var I=this._17O(N);if("2a864886f70d010101"==I._61O){var M=this._16O(I.key),A=new Lo;return A._38O(M.n,M.e),A}zr($d)},_16O:function(R){var W={};R.substr(0,2)!=vm&&zr($d);var Z=$e._7O(R,0);return 2!=Z.length&&zr($d),R.substr(Z[0],2)!=Sd&&zr($d),W.n=$e._11O(R,Z[0]),R.substr(Z[1],2)!=Sd&&zr($d),W.e=$e._11O(R,Z[1]),W},_17O:function(M){var r={};r._40O=A;var G=$e._7O(M,0);2!=G.length&&zr($d);var b=G[0];M.substr(b,2)!=vm&&zr($d);var v=$e._7O(M,b);return 2!=v.length&&zr($d),M.substr(v[0],2)!=Lc&&zr($d),r._61O=$e._11O(M,v[0]),M.substr(v[1],2)==Lc?r._40O=$e._11O(M,v[1]):M.substr(v[1],2)==vm&&(r._40O={},r._40O.p=$e._70O(M,v[1],[0],Sd),r._40O.q=$e._70O(M,v[1],[1],Sd),r._40O.g=$e._70O(M,v[1],[2],Sd)),M.substr(G[1],2)!=Qi&&zr($d),r.key=$e._11O(M,G[1]).substr(2),r}},Y._17O?Y:A}(),Gn=Hb._27O=function(n){return Hb._14O(n)};wr=function(){return function(D,b){if(D&&b){b=Ml(b);var R=Xm(b,F(2,4)),w=this;if(!w||!w.n||R._55O()>w.n._55O())return 0;var f=w._37O(R),U=f[gf](F(2,4)).replace(xr,""),o=Wd(U);if(0==o.length)return!1;var L=o[0],M=o[1],c=function(p){return Ef._4O.Util._56O(p,L)},X=c(D);return M==X}}.bind(Gn(f))};var Iq,Xr;return function(){var u=wh.length-Ib.length;if(u>0)for(var g=0;u>g;g++)Iq=eh.Util,Xr=Ml}(),nd=function(M,l){l=Xr(l);var B=Gn(sk),z=bl.length,v=2*z,t=Xm(l,F(z,v)),T=B,L=!0;if(T){var j=T[ei[0]];j&&t._55O()<=j._55O()&&(L=!1)}if(L)return 0;var Z=T._37O(t),p=Z[gf](F(z,v)).replace(xr,""),k=Wd(p);if(0==k.length)return!1;var b=k[0],w=k[1],S=Iq._11A(M,b);return w==S},Hb}(_,N),Ec(b,{load:function(){var j={},d=function(q){return q?"c_"+(q.sync?"1":"0")+"_"+(q.post?"1":"0")+"_"+(q.responseType||"H")+"_"+(q.mimeType||"H")+"_"+(q.data?JSON.stringify(q.data):"H"):""};return function(T,z,L){var W,I=j[T],o=d(L);return I&&(W=I[o])?(W.push(z),void 0):(j[T]||(I=j[T]={count:0}),W=I[o]=[z],I.count++,b.xhrLoad(T,function(l){delete I[o],I.count--,I.count||delete j[T],W.forEach(function(k){k(l)})},L),void 0)}}(),asyncEach:function(i,B,c){"function"!=typeof c&&(c=Function.prototype);var w=new Array(i.length),R=0,J=!1;i.forEach(function(N,v){B(N,function(x,N){return J?void 0:x?(J=!0,c(null)):(w[v]=N,R++,R===i.length?c(w):void 0)})})},xhrLoad:function(t,H,$){var m=!1;Fl(t)||(m=!0,t=[t]),$=$||{};var A=$.sync,D=null,Z=$.method||"GET";return $.post&&(Z="POST"),$.method=Z,b.asyncEach(t,function(y,Y){var D=new en;y=b.beforeLoadURL(y),y.data?Y(null,y.data):($.url=encodeURI(y),$.responseType?D.setResponseType($.responseType):D.setOverrideMimeType($.mimeType||"text/plain"),D.onload=function(){200===this.status||0===this.status?Y(null,D.getResponseText()):Y(!0)},D.onerror=function(){Y(!0)},D.send($))},function(N){var Y="function"==typeof H;(Y||A)&&(D=m&&N?N[0]:N,Y&&H(D))}),A?D:void 0}});var Tr=P.List=function(){this._as=[];var a,D,P=arguments.length;if(1===P){var H=arguments[0];if(mk(H)&&(H=H._as),Fl(H))for(D=H.length,a=0;D>a;a++)this._as.push(H[a]);else H!=A&&this._as.push(H)}else if(P>1)for(a=0;P>a;a++)this._as.push(arguments[a])};hh("List",N,{forEach:function(v,A){this.each(v,A)},push:function(){for(var L=0;L<arguments.length;L++)this.add(arguments[L])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(J,r){return r===e?this._as.push(J):this._as.splice(r,0,J)},addAll:function(w){mk(w)&&(w=w._as),Fl(w)?oj(this._as,w):this._as.push(w)},get:function(A){return this._as[A]},slice:function(F,b){return new Tr(this._as.slice(F,b))},remove:function(U){var Q=this._as.indexOf(U);return Q>=0&&Q<this._as.length&&this.removeAt(Q),Q},removeAt:function(R){return this._as.splice(R,1)[0]},set:function(o,r){return this._as[o]=r},clear:function(){return this._as.splice(0,this._as.length)},contains:function(V){return this._as.indexOf(V)>=0},indexOf:function(j){return this._as.indexOf(j)},each:function(Q,E){for(var n=0,C=this._as.length;C>n;n++){var p=this._as[n];E?Q.call(E,p,n,this):Q(p,n,this)}},reverseEach:function(t,M){for(var u=this._as.length-1;u>=0;u--){var I=this._as[u];M?t.call(M,I):t(I)}},getArray:function(){return this._as},toArray:function(m,r){if(m){for(var S,o=[],j=0,T=this._as.length;T>j;j++)S=this._as[j],r?m.call(r,S)&&o.push(S):m(S)&&o.push(S);return o}return this._as.concat()},toList:function(w,y){if(w){for(var h,Q=new Tr,W=0,p=this._as.length;p>W;W++)h=this._as[W],y?w.call(y,h)&&Q.add(h):w(h)&&Q.add(h);return Q}return new Tr(this)},reverse:function(){this._as.reverse()},sort:function(I){return this._as.sort(I?I:wb),this},toString:function(){return this._as.toString()}}),N.defineProperties(Tr.prototype,{length:{get:function(){return this._as.length},set:function(s){this._as.length=s}}});var $n=new Tr;Ec($n,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ym,each:ym,reverseEach:ym,toArray:function(){return[]},toList:function(){return new Tr},add:Od,addAll:Od,set:Od,remove:Od,removeAt:Od,clear:Od});var yj=P.Notifier=function(){this._f=0};hh("Notifier",N,{contains:function(E,j){if(this._ls)for(var l,V=0,C=this._ls.size();C>V;V++)if(l=this._ls.get(V),E===l.l&&j===l.s)return!0;return!1},add:function(R,W,K){var D=this,j={l:R,s:W,a:K};D._ls||(D._ls=new Tr),D._f?(D._as||(D._as=new Tr),D._as.add(j)):j.a?D._ls.add(j,0):D._ls.add(j)},remove:function(o,y){var u=this;u._ls&&(u._f?(u._rs||(u._rs=new Tr),u._rs.add({l:o,s:y})):u._remove(o,y))},_remove:function(C,E){for(var G,v=this._ls,Y=0,N=v.size();N>Y;Y++)if(G=v.get(Y),G.l===C&&G.s===E)return v.removeAt(Y),void 0},fire:function(q){var h=this,P=h._ls;if(h._b=1e4,P){++h._f;try{for(var i,J=0,a=P.size();a>J;J++)i=P.get(J),i.s?i.l.call(i.s,q):i.l(q)}catch(q){$(function(){throw q})}finally{if(--h._f)return;if(h._rs){for(a=h._rs.size(),J=0;a>J;J++)i=h._rs.get(J),h._remove(i.l,i.s);delete h._rs}if(h._as){for(a=h._as.size(),J=0;a>J;J++)i=h._as.get(J),i.a?P.add(i,0):P.add(i);delete h._as}}}}});var ej=P.Data=function(){this._id=lo()};hh("Data",N,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:A,_parent:A,_children:$n,_childMap:A,_styleMap:A,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return A},_22Q:function(){return A},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(X,h){var H=this;if(2===arguments.length)H.setStyle(X,h);else{if(!Tp(X))return H.getStyle(X);for(var Z in X)H.setStyle(Z,X[Z])}return H},setRenderLayer:function(Y){this.s("alwaysOnTop","top"===Y)},fp:function(P,m,x,y,S){return this.firePropertyChange(P,m,x,y,S)},firePropertyChange:function(g,w,r,U,s){if(U){if(U(w,r))return!1}else if(w===r)return!1;var t=this,B=s||{};return B.property=g,B.oldValue=w,B.newValue=r,B.data=t,t._dataModel&&t._dataModel.handleDataPropertyChange(B),t.onPropertyChanged(B),!0},onPropertyChanged:function(X){var L=this,n=L._parent,Q=X.property;if(gk(n)){var R=L.s(Do),t="s:ingroup"===Q;(R&&Fk[Q]||Q===t)&&n._81I(),(R||t)&&n.fp("childChange",!0,!1)}_k(n)&&Fk[Q]&&n.updateFromChildren()},_21I:function(L){var N=this;if(L&&N._dataModel)throw"Remove data from dataModel before adding";N._dataModel=L},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var p=0,Y=this._children.toArray(),M=Y.length;M>p;p++)Y[p].removeFromDataModel()},getId:function(){return this._id},setId:function(Z){this._id=Z},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(b,c){return this._children.toList(b,c)},eachChild:function(M,e){this._children.each(M,e)},addChild:function(x,b){var t=this;x!==t&&(t._children===$n&&(t._children=new Tr,t._childMap={}),b>=0||(b=t._children.size()),t._childMap[x._id]||t.isDescendantOf(x)||(x._parent&&x._parent.removeChild(x),(0>b||b>t._children.size())&&(b=t._children.size()),t._children.add(x,b),t._childMap[x._id]=x,x.setParent(t),t.onChildAdded(x,b),t.fp(Sm,A,x)))},onChildAdded:function(){},removeChild:function(g){var y=this;if(y._childMap&&y._childMap[g._id]){var n=y._children.remove(g);delete y._childMap[g._id],y.fp(Sm,g,A),g.setParent(A,n),y.onChildRemoved(g,n)}},onChildRemoved:function(){},getChildAt:function(y){return this._children.get(y)},clearChildren:function(){var Z=this;if(!Z._children.isEmpty())for(var H=0,r=Z._children.toArray(),g=r.length;g>H;H++)Z.removeChild(r[H])},getParent:function(){return this._parent},setParent:function(U,d){var M=this;if(!(M._73I||M._parent===U||M===U||U&&U.isDescendantOf(M))){var x,y=M._parent;M._parent=U,M._73I=1,y?(d==A&&(d=y.getChildren().indexOf(M)),y.removeChild(M)):M._dataModel&&d==A&&(d=M._dataModel.getRoots().indexOf(M)),U&&(U.addChild(M),x=U.getChildren().indexOf(M)),delete M._73I,M.fp("parent",y,U,e,{oldIndex:d,newIndex:x}),M.onParentChanged(y,U)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(k){return k?this.isDescendantOf(k)||k.isDescendantOf(this):!1},isParentOf:function(J){return J&&this._childMap?!!this._childMap[J._id]:!1},isDescendantOf:function(N){if(!N||N.isEmpty())return!1;for(var T=this._parent;T;){if(N===T)return!0;T=T._parent}return!1},getStyle:function(q,Z){Z===e&&(Z=1);var R=this._styleMap?this._styleMap[q]:e;return R===e&&Z?n[q]:R},setStyle:function(Y,p){var y=this;y._styleMap||(y._styleMap={});var u=y._styleMap[Y];p===e?delete y._styleMap[Y]:y._styleMap[Y]=p,y.fp("s:"+Y,u,p)&&y.onStyleChanged(Y,u,p)},onStyleChanged:function(){},iv:function(l){this.invalidate(l)},invalidate:function(C){this.fp(C||"*",!1,!0)},toString:function(){var T=this;return T._displayName||T._name||T._tag||T._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(J,e){var B=this,H=B.s(jr);B.beginTransaction(),H||B.s(jr,H={}),e?H[J]=e:delete H[J],B.fp(jr,A,H),B.endTransaction()},removeStyleIcon:function(Q){var s=this.s(jr);if(s){var L=s[Q];delete s[Q],this.fp(jr,A,s)}return L},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(P){var l=this;if(l.hasOwnProperty("_anchor")||l.hasOwnProperty("_anchorElevation")){var J=l.getAnchor3d(),O={x:J.x-.5,y:J.y-.5,z:J.z-.5};ac(P,[-O.x,-O.y,-O.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var H,E={};for(H in this._styleMap)E[H]=1;return E},getCurrentPrefix:function(){return this._interactPrefix||uo},ca:function(g,t){var i=this.getCurrentPrefix();return g=i+g,2===arguments.length?this.a(g,t):this.a(g)}});var Er=P.DataModel=function(){var E=this;E._isDeserializing=0,E._datas=new Tr,E._dataMap={},E._roots=new Tr,E._rootMap={},E._fsDataMap={},E._78O={},E._reflectorMap={},E._36I=new yj,E._35I=new yj,E._serializeNotifier=new yj,E._selectionModel=new Gl(E);var R=E._29Q=[],X=E._scheduleCallback=function(){for(var Z=Date.now(),z=0;z<R.length;z++){var J=R[z];J.enabled&&Z-J.lastTime>J.interval&&(J.beforeAction&&J.beforeAction(),J.action&&E.each(function(B){J.action(B)}),J.afterAction&&J.afterAction(),J.lastTime=Z)}R.length&&(E._30Q=_.requestAnimationFrame(X))}};hh("DataModel",N,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:e,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:e,_init:e,_envmap:e,_postProcessingData:e,sm:function(){return this.getSelectionModel()},mm:function(K,j,Q){this.addDataModelChangeListener(K,j,Q)},umm:function(b,m){this.removeDataModelChangeListener(b,m)},md:function(Y,Q,J){this.addDataPropertyChangeListener(Y,Q,J)},umd:function(M,Z){this.removeDataPropertyChangeListener(M,Z)},mh:function(T,c,B){this.addHierarchyChangeListener(T,c,B)},umh:function(c,V){this.removeHierarchyChangeListener(c,V)},getAttrObject:function(){return this._attrObject},setAttrObject:function(c){return this._attrObject=c},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(Y){return this._dataMap[Y]},removeDataById:function(c){this.remove(this.getDataById(c))},toDatas:function($,G){return this._datas.toList($,G)},each:function(d,Q){this._datas.each(d,Q)},getDataByTag:function(v){return this._78O[v]},getTagMap:function(){return this._78O},removeDataByTag:function(e){this.remove(this.getDataByTag(e))},add:function(z,m,T){var X=this,u=z._id,a=z._tag,W=X._roots;if(X._dataMap[u])throw"'"+u+"' already exists";a!=A&&(X._78O[a]=z),X._dataMap[u]=z,T>=0?X._datas.add(z,T):X._datas.add(z),z._parent||(X._rootMap[u]=z,m>=0?W.add(z,m):W.add(z)),z.s("fullscreen")!==e&&(X._fsDataMap[u]=z),z.s("shape3d.reflector")&&(X._reflectorMap[u]=z),z._21I(X),X.onAdded(z),X._36I.fire({kind:"add",data:z,rootsIndex:m,datasIndex:T})},onAdded:function(){},remove:function(I,s){if(I){var l=this,O=I._id,n=s&&s.keepStructure,h=s&&s.keepChildren,r=I.getTag();if(I._dataModel===l){this.beginTransaction(),n?l._removingData||(l._removingData=I):l.prepareRemove(I),h||I.toChildren().each(function(A){l.remove(A,s)},l),n?l._removingData===I&&(I._parent&&I._parent.removeChild(I),delete l._removingData):I._parent&&I._parent.removeChild(I);var Z=l._datas.remove(I);delete l._dataMap[O],r!=A&&delete l._78O[r];var w;l._rootMap[O]&&(delete l._rootMap[O],w=l._roots.remove(I)),l._fsDataMap[O]&&delete l._fsDataMap[O],l._reflectorMap[O]&&delete l._reflectorMap[O],I._21I(A),l.onRemoved(I),l._36I.fire({kind:kc,data:I,rootsIndex:w,datasIndex:Z}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var X=this;if(X._datas.size()){var F=X._historyManager?this.toJSON():e;X._datas.toArray().forEach(function(c){c._21I(A)}),X._datas.clear(),X._dataMap={},X._roots.clear(),X._rootMap={},X._fsDataMap={},X._reflectorMap={},X._78O={},X._36I.fire({kind:Bj,json:F})}},contains:function(l){return l&&l._dataModel===this},handleDataPropertyChange:function(K){var J=this,h=K.data,z=K.property;if("parent"===z){var L=h._id,P=J._rootMap,v=J._roots;h._parent?P[L]&&(delete P[L],v.remove(h)):P[L]||(P[L]=h,v.add(h))}else if("tag"===z){var x=K.oldValue,E=K.newValue,l=J._78O;x!=A&&delete l[x],E!=A&&(l[E]=h)}else if("s:fullscreen"===z){var L=h._id,s=J._fsDataMap;K.oldValue!=A&&delete s[L],K.newValue!=A&&(s[L]=h)}else if("s:shape3d.reflector"===z){var L=h._id,C=J._reflectorMap;K.oldValue&&delete C[L],K.newValue&&(C[L]=h)}this.onDataPropertyChanged(h,K),this._35I.fire(K)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(f,z,d){this._36I.add(f,z,d)},removeDataModelChangeListener:function(x,m){this._36I.remove(x,m)},addSerializeListener:function(f,H,b){this._serializeNotifier.add(f,H,b)},removeSerializeListener:function(w,q){this._serializeNotifier.remove(w,q)},fireSerializeEvent:function(v){this._serializeNotifier.fire(v)},addDataPropertyChangeListener:function(r,A,s){this._35I.add(r,A,s)},removeDataPropertyChangeListener:function(x,s){this._35I.remove(x,s)},_38I:function(Z,O,Y){this._37I&&this._37I.fire({data:Z,oldIndex:O,newIndex:Y})},addHierarchyChangeListener:function(r,k,P){this._37I||(this._37I=new yj),this._37I.add(r,k,P)},removeHierarchyChangeListener:function(f,x){this._37I.remove(f,x)},getSiblings:function(E){var $=E._parent;return $?$._children:this._roots},eachByHierarchical:function(L,C,t){if(C)return this._eachByHierarchical(L,C,t);for(var W=0,m=this._roots,R=m.size();R>W;W++)if(this._eachByHierarchical(L,m.get(W),t)===!1)return!1;return!0},_eachByHierarchical:function(b,o,h){if(h){if(b.call(h,o)===!1)return!1}else if(b(o)===!1)return!1;for(var j=o.size(),F=0;j>F;F++)if(this._eachByHierarchical(b,o.getChildAt(F),h)===!1)return!1;return!0},reverseEachByHierarchical:function(F,x,b){if(x)return this._reverseEachByHierarchical(F,x,b);for(var i=this._roots,E=i.size(),f=E-1;f>=0;f--)if(this._reverseEachByHierarchical(F,i.get(f),b)===!1)return!1;return!0},_reverseEachByHierarchical:function(B,H,$){for(var F=H.size(),v=F-1;v>=0;v--)if(this._reverseEachByHierarchical(B,H.getChildAt(v),$)===!1)return!1;if($){if(B.call($,H)===!1)return!1}else if(B(H)===!1)return!1;return!0},eachByDepthFirst:function(p,I,V){if(I)return this._11I(p,I,V);for(var O=0,L=this._roots,c=L.size();c>O;O++)if(this._11I(p,L.get(O),V)===!1)return!1;return!0},_11I:function(U,j,_){for(var G=j.size(),B=0;G>B;B++)if(this._11I(U,j.getChildAt(B),_)===!1)return!1;if(_){if(U.call(_,j)===!1)return!1}else if(U(j)===!1)return!1;return!0},eachByBreadthFirst:function(x,i,b){var O=new Tr;for(i?O.add(i):this._roots.each(O.add,O);O.size()>0;)if(i=O.removeAt(0),i.eachChild(O.add,O),b){if(x.call(b,i)===!1)return!1}else if(x(i)===!1)return!1;return!0},moveTo:function(C,k){var O=this.getSiblings(C),r=O.indexOf(C);r===k||0>r||k>=0&&k<=O.size()&&(O.remove(C),k>O.size()&&k--,O.add(C,k),this._38I(C,r,k))},moveUp:function(C){this.moveTo(C,this.getSiblings(C).indexOf(C)-1)},moveDown:function(w){this.moveTo(w,this.getSiblings(w).indexOf(w)+1)},moveToTop:function(C){this.moveTo(C,0)},moveToBottom:function(O){this.moveTo(O,this.getSiblings(O).size())},moveSelectionUp:function(p){this.beginTransaction(),p||(p=this.sm());var V=new Tr;xp(p,V,this._roots),V.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(o){this.beginTransaction(),o||(o=this.sm());var b=new Tr;Um(o,b,this._roots),b.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(U){this.beginTransaction(),U||(U=this.sm());var w=new Tr;ds(U,w,this._roots),w.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(Q){this.beginTransaction(),Q||(Q=this.sm());var s=new Tr;no(Q,s,this._roots),s.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(m,x,e){var c=this.getDatas();null==e&&(e=c.indexOf(m)),e===x||0>e||x>=0&&x<=c.size()&&(c.remove(m),x>c.size()&&x--,c.add(m,x),this._76I(m,e,x))},bringForward:function(c){this.moveToIndex(c,this.getDatas().indexOf(c)+1)},bringToFront:function(C){this.moveToIndex(C,this.size())},sendBackward:function(T){this.moveToIndex(T,this.getDatas().indexOf(T)-1)},sendToBack:function(k){this.moveToIndex(k,0)},bringSelectionForward:function(f){this.beginTransaction(),f||(f=this.sm());for(var T=new Tr,N=this.getDatas(),b=!1,p=0;p<N.size();p++){var i=N.get(N.size()-1-p);f.contains(i)?b&&T.add(i):b=!0}T.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(q){this.beginTransaction(),q||(q=this.sm());for(var W=new Tr,h=this.getDatas(),Y=0;Y<h.size();Y++){var f=h.get(Y);q.contains(f)&&W.add(f)}W.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(K){this.beginTransaction(),K||(K=this.sm());for(var f=new Tr,m=this.getDatas(),S=!1,N=0;N<m.size();N++){var M=m.get(N);K.contains(M)?S&&f.add(M):S=!0}f.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(M){this.beginTransaction(),M||(M=this.sm());for(var n=new Tr,j=this.getDatas(),e=0;e<j.size();e++){var $=j.get(j.size()-1-e);M.contains($)&&n.add($)}n.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(c){var K=this;K.removeScheduleTask(c),c.enabled==A&&(c.enabled=!0),c.interval==A&&(c.interval=10),c.lastTime=Date.now(),K._29Q.push(c),K._30Q==A&&(K._30Q=_.requestAnimationFrame(K._scheduleCallback))},removeScheduleTask:function(X){var Z=this,m=Z._29Q,q=m.indexOf(X);q>=0&&m.splice(q,1),m.length||Z._30Q==A||(_.cancelAnimationFrame(Z._30Q),delete Z._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(F){this._historyManager||new P.HistoryManager(this),null!=F&&this._historyManager.setMaxHistoryCount(F),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(r){this._historyManager&&this._historyManager.undo(r)},redo:function(S){this._historyManager&&this._historyManager.redo(S)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()
},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(k){this._historyManager&&this._historyManager.addHistory(k)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(t){t?this._isDeserializing++:this._isDeserializing--}});var Gl=P.SelectionModel=function(K){var O=this;O._68O=Vc,O._map={},O._73O=new Tr,O._74I=new yj,O._21I(K)};hh("SelectionModel",N,{ms_fire:1,ms_dm:1,ms:function(t,v,M){this.addSelectionChangeListener(t,v,M)},ums:function(Q,d){this.removeSelectionChangeListener(Q,d)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Oq},co:function(q){return this._map[q._id]!=A},ss:function(w){this.setSelection(w)},as:function(z){this.appendSelection(z)},rs:function(d){this.removeSelection(d)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(X){var j=this;if(j._68O!==X&&(X===ei||X===Oq||X===Vc)){j.cs();var Q=j._68O;j._68O=X,j.fp("selectionMode",Q,X)}},_21I:function(h){var b=this,X=b._dataModel;X!==h&&(X&&(b.cs(),X.umm(b.handleDataModelChange,b)),b._dataModel=h,h.mm(b.handleDataModelChange,b,!0),b.fp(Dg,X,h))},dispose:function(){var a=this;a.cs(),a._dataModel.umm(a.handleDataModelChange,a)},handleDataModelChange:function(o){var e=this;if(o.kind===kc){var Q=o.data;e.co(Q)&&(e._73O.remove(Q),delete e._map[Q._id],e._75I(kc,new Tr(Q)))}else o.kind===Bj&&e.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(t){var S=this;if(S._filterFunc!==t){S.cs();var $=S._filterFunc;S._filterFunc=t,S.fp("filterFunc",$,S._filterFunc)}},_75I:function(t,a,o,W){o&&(this._73O.each(function(T){W[T._id]?o.remove(T):o.add(T)}),a=o.toList()),this._74I.fire({kind:t,datas:new Tr(a)})},addSelectionChangeListener:function(x,A,Q){this._74I.add(x,A,Q)},removeSelectionChangeListener:function(m,U){this._74I.remove(m,U)},_97O:function(Z,b){for(var u,L=this,f=0,N=new Tr(Z);f<N.size();f++)u=N.get(f),(L._filterFunc&&!L._filterFunc(u)||b&&L.co(u)||!b&&!L.co(u)||!L._dataModel.contains(u))&&(N.removeAt(f),f--);return N},appendSelection:function(I){var w=this;if(w._68O!==ei){var n,v,k=w._73O,r=w._97O(I,!0);r.isEmpty()||(w.sg()&&(n=new Tr(k),v=w._map,k.clear(),w._map={},r=new Tr(r.get(r.size()-1))),r.each(function(V){k.add(V),w._map[V._id]=V}),w._75I("append",r,n,v))}},removeSelection:function(l){var E=this,v=E._97O(l),e=0,Z=v.size();if(0!==Z){for(;Z>e;e++){var S=v.get(e);E._73O.remove(S),delete E._map[S._id]}E._75I(kc,v)}},toSelection:function(x,f){return this._73O.toList(x,f)},getSelection:function(){return this._73O},each:function(W,p){this._73O.each(W,p)},setSelection:function(k){var m=this,Q=m._73O;if(m._68O!==ei&&!(Q.isEmpty()&&!k||1===Q.size()&&m.ld()===k)){var T=new Tr(Q),U=m._map;Q.clear(),m._map={};var z=m._97O(k,!0);m.sg()&&z.size()>1&&(z=new Tr(z.get(z.size()-1))),z.each(function(c){Q.add(c),m._map[c._id]=c}),m._75I("set",A,T,U)}},clearSelection:function(){var S=this,I=S._73O;if(I.size()>0){var M=I.toList();I.clear(),S._map={},S._75I(Bj,M)}},selectAll:function(){var E=this;if(E._68O!==ei){var J,p,D=E._dataModel.toDatas();if(E._filterFunc)for(J=0;J<D.size();J++)p=D.get(J),E._filterFunc(p)||(D.removeAt(J),J--);var G=E._73O,h=new Tr(G),P=E._map;G.clear(),E._map={},E.sg()&&D.size()>1&&(D=new Tr(D.get(D.size()-1)));var W=D.size();for(J=0;W>J;J++)p=D.get(J),G.add(p),E._map[p._id]=p;E._75I("all",A,h,P)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(Q){return this._map[Q._id]!=A},getLastData:function(){var m=this._73O;return m.size()>0?m.get(m.size()-1):A},getFirstData:function(){var Q=this._73O;return Q.size()>0?Q.get(0):A},isSelectable:function(P){var B=this;return P&&B._68O!==ei?B._filterFunc?B._filterFunc(P):!0:!1},getTopSelection:function(){var f=this,L=new Tr;return f._73O.each(function(V){for(var Y=V.getParent();Y;){if(f.contains(Y)){V=A;break}Y=Y.parent}V&&L.add(V)}),L}});var kb=function(){return Fi(0),function(f,P){var J;if(Ak(P)){var m=f.getDataUI(P);m&&m._88I&&(J=m._88I.rect)}return J?J:P.getRect()}}();Ec(b,{edgeGroupAgentFunc:A,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:p.rectSelectBorder,graphViewRectSelectBackground:Ng,graphViewEditPointSize:tc?17:7,graphViewEditPointBorderColor:p.editPointBorder,graphViewEditPointBackground:p.editPointBackground,setEdgeType:function(F,P,n){Xk[F]=P,kq[F]=n},getEdgeType:function(U){return Xk[U]},getEdgeTypeMap:function(){return Xk},getNodeRect:kb},!0),Ec(n,{"layout.h":e,"layout.v":e,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":e,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:e,ingroup:!0,"body.color":e,"2d.gray":!1,fullscreen:e,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:e,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Zr,"select.width":1,"select.padding":2,"select.type":Dl,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Zr,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":e,"border.width":2,"border.padding":2,"border.type":Dl,label:e,"label.font":e,"label.color":Rl,"label.background":e,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":e,"label.max":e,"label.opacity":e,"label.scale":1,"label.align":e,"label.selectable":!0,label2:e,"label2.font":e,"label2.color":Rl,"label2.background":e,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":e,"label2.max":e,"label2.opacity":e,"label2.scale":1,"label2.align":e,"label2.selectable":!0,note:e,"note.expanded":!0,"note.font":e,"note.color":uk,"note.background":Zr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":e,"note.toggleable":!0,"note.border.width":1,"note.border.color":e,"note.opacity":e,"note.scale":1,"note.align":e,note2:e,"note2.expanded":!0,"note2.font":e,"note2.color":uk,"note2.background":Zr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":e,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":e,"note2.opacity":e,"note2.scale":1,"note2.align":e,"group.type":e,"group.image":e,"group.image.stretch":"fill","group.repeat.image":e,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":e,"group.title.color":uk,"group.title.background":p.groupTitleBackground,"group.title.align":Rc,"group.title.orientation":Oe,"group.background":p.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":e,"group.border.color":Cr,"group.border.radius":e,"group.border.cap":$q,"group.border.join":We,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":A,"group.gradient.color":"#FFF",shape:e,"shape.background":Cr,"shape.repeat.image":e,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Cr,"shape.border.3d":!1,"shape.border.3d.color":e,"shape.border.3d.accuracy":e,"shape.border.cap":$q,"shape.border.join":We,"shape.border.pattern":e,"shape.gradient":A,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Ac,"shape.dash.offset":0,"shape.dash.color":xf,"shape.dash.width":e,"shape.dash.3d":!1,"shape.dash.3d.color":e,"shape.dash.3d.accuracy":e,"shape.polygon.side":6,"shape.arc.from":O,"shape.arc.to":U,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":e,"shape.gradient.pack":e,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":e,"shape.foreground.gradient":A,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":e,"autolayout.hgap":e,"autolayout.vgap":e,"edge.type":e,"edge.points":e,"edge.segments":e,"edge.color":Cr,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":e,"edge.3d.accuracy":e,"edge.cap":$q,"edge.join":We,"edge.source.position":17,"edge.source.anchor.x":e,"edge.source.anchor.y":e,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":e,"edge.target.anchor.y":e,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":e,"edge.dash":!1,"edge.dash.pattern":Ac,"edge.dash.offset":0,"edge.dash.color":xf,"edge.dash.width":e,"edge.dash.3d":!1,"edge.dash.3d.color":e,"edge.dash.3d.accuracy":e,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":e,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":e,"grid.column.percents":e,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":p.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":p.gridCellBorderColor,"grid.block":e,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":p.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Rl,"text.font":Ek,"text.shadow":!1,"text.shadow.color":Zr,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Ec(Er,{_76I:function(C,X,z){this._39I&&this._39I.fire({data:C,oldIndex:X,newIndex:z})},addIndexChangeListener:function(Z,H,Y){var v=this;v._39I||(v._39I=new yj),v._39I.add(Z,H,Y)},removeIndexChangeListener:function(G,T){this._39I.remove(G,T)},prepareRemove:function(O){cn(O)&&(O.setSource(A),O.setTarget(A)),O._70O&&O._70O.toList().each(this.remove,this),O._69O&&O._69O.toList().each(function(B){B.setHost(A)}),O._host&&O.setHost(A)},onAdded:function(p){this.isAutoAdjustIndex()&&this.adjustIndex(p)},onDataPropertyChanged:function(z,g){Rr[g.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(z)},isAdjustable:function(V){return $o(V)||cn(V)},isAdjustedToBottom:function(S){return gk(S)?S.isExpanded()&&Mn(S):!1},adjustIndex:function(p){var t=this;this.isHierarchicalRendering()||(t.isAdjustedToBottom(p)?(t.sendToBottom(p),p.eachChild(t.adjustIndex,t)):t.sendToTop(p))},sendToTop:function(m){var F=this;if(F.contains(m)&&F.isAdjustable(m)){var i=F._datas;if(m!==i.get(F.size()-1)){var C=i.indexOf(m);i.removeAt(C),i.add(m),F._76I(m,C,F.size()-1)}if(cn(m)){var x=m._40I;x&&!F.isAdjustedToBottom(x)&&F.sendToTop(x),x=m._41I,x&&!F.isAdjustedToBottom(x)&&F.sendToTop(x)}m._69O&&m._69O.each(function(H){H.isRelatedTo(m)||$o(m)&&H.isLoopedHostOn(m)||F.sendToTop(H)}),m.ISubGraph||(!gk(m)||m.isExpanded())&&m._adjustChildrenToTop&&m.eachChild(function(B){cn(B)||F.sendToTop(B)})}},sendToBottom:function(n,m){var B=this;if(n!==m&&B.contains(n)&&B.isAdjustable(n)&&(!m||B.contains(m))){var s=B._datas,v=s.remove(n),b=m?B._datas.indexOf(m):0;if(s.add(n,b),v!==b){B._76I(n,v,b);var T=n._parent;!T||T.ISubGraph||cn(T)||B.sendToBottom(n._parent,n)}}}}),Ec(Uq,{ms_edit:function(w){w._46O=function(Q){var E=this,R=E.gv.dm(),I=E._index,T=E._89I,D=E._node,$=E._shape,m=E._edge,l=E._77I;D&&T?(this.fi({kind:"endEditRect",event:Q,data:D,direction:T}),R.endTransaction()):$&&I>=0?(E.fi({kind:"endEditPoint",event:Q,data:$,index:I}),R.endTransaction()):m&&I>=0?(E.fi({kind:"endEditPoint",event:Q,data:m,index:I}),R.endTransaction()):l&&(E.fi({kind:"endEditRotation",event:Q,data:l}),R.endTransaction())},w._78I=function(W){var N=this;N.autoScroll(W);var D=N.gv.lp(W),b=N._index,X=N._89I,z=N._node,q=N._shape,c=N._edge,r=N._77I;if(z&&X)N._80O(D),N.fi({kind:"betweenEditRect",event:W,data:z,direction:X});else if(q&&b>=0)D.e=q.getPoints().get(b).e,q.setPoint(b,D),N.fi({kind:"betweenEditPoint",event:W,data:q,index:b});else if(c&&b>=0){var l=c.s(Ai);D.e=l.get(b).e,l.set(b,D),c.fp(Ai,A,l),N.fi({kind:"betweenEditPoint",event:W,data:c,index:b})}else if(r){var K=r.p(),B=r.getScale(),J=Z+o(D.y-K.y,D.x-K.x);B.y<0&&(J+=O),T(J)<.04&&(J=0),r.setRotation(J),N.fi({kind:"betweenEditRotation",event:W,data:r})}},w._80O=function(S){var L=this,G=L._node,J=L._rect,C=J.x,B=J.y,l=J.width,A=J.height,o=L._89I,r=L._anchor,E=L._matrix,S=E.tfi(S);"northwest"===o?J=mo(S,{x:C+l,y:B+A}):o===Ab?J=mo({x:C,y:S.y},{x:C+l,y:B+A}):"northeast"===o?J=mo({x:C,y:S.y},{x:S.x,y:B+A}):o===pj?J=mo({x:S.x,y:B},{x:C+l,y:B+A}):o===xe?J=mo({x:C,y:B},{x:S.x,y:B+A}):"southwest"===o?J=mo({x:S.x,y:B},{x:C+l,y:S.y}):"south"===o?J=mo({x:C,y:B},{x:C+l,y:S.y}):"southeast"===o&&(J=mo({x:C,y:B},S)),G.setPosition(E.tf(J.x+J.width*r.x,J.y+J.height*r.y)),G.setWidth(J.width),G.setHeight(J.height)},w._80I=function(U,$,z,l){var w=this,E=w.gv._zoom,d=(w.gv.getEditPointSize()+2)/E;return dg({x:$-d/2,y:z-d/2,width:d,height:d},U)?(w._89I!==l&&(w._89I=l),!0):!1},w._79I=function(k,D,y){var L=this,N=L.gv,C=D?N.getDataUI(D):A,G=C?C._55O:A;if(G){var z,T,x,K,O=N._zoom,J=(N.getEditPointSize()+2)/O,i=N.lp(k);if($o(D)){if(G._56O&&$o(D)&&(T=G._98o,dg({x:T.x-J/2,y:T.y-J/2,width:J,height:J},i)))return L._77I=D,y&&L.fi({kind:"beginEditRotation",event:k,data:D}),L.setCursor("crosshair"),!0;if(G._43O&&D instanceof xn)for(x=D.getPoints(),z=x.size()-1;z>=0;z--)if(T=x.get(z),dg({x:T.x-J/2,y:T.y-J/2,width:J,height:J},i))return L._index=z,L._shape=D,y&&L.fi({kind:"beginEditPoint",event:k,data:D,index:z}),L.setCursor("crosshair"),!0;if(G._42O)for(var Q=D.getEditControlPoints(),v=["northwest",-1,-1,pj,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,xe,1,0,"northeast",1,-1,Ab,0,-1],z=0,K=Q.length;K>z;z++){var W=v[3*z],t=Q[z];if(L._80I(i,t.x,t.y,W)){L._node=D;var q=D.getWidth(),u=D.getHeight(),S=D.getAnchor();L._rect={x:-q*S.x,y:-u*S.y,width:q,height:u},L._anchor=S,L._matrix=D.getMatrix();var B=D.getRotation(),R=E(B),Z=j(B),U=v[3*z+1]*_r(D.getScale().x),s=v[3*z+2]*_r(D.getScale().y),X=Math.atan2(-Z*U-R*s,R*U-Z*s),e=(Math.round(X/(Math.PI/4))+8)%8,o=[bm,"nesw-resize",rk,"nwse-resize",bm,"nesw-resize",rk,"nwse-resize"][e];return L.setCursor(o),y&&L.fi({kind:"beginEditRect",event:k,data:D,direction:L._89I}),!0}}}if(G._43O&&cn(D)&&D.s(km)===od&&(x=D.s(Ai)))for(z=x.size()-1;z>=0;z--)if(T=x.get(z),dg({x:T.x-J/2,y:T.y-J/2,width:J,height:J},i))return L._index=z,L._edge=D,y&&L.fi({kind:"beginEditPoint",event:k,data:D,index:z}),L.setCursor("crosshair"),!0}return!1}},ms_gv:function(M){M._currentSubGraph=A,M._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},M.upSubGraph=function(){this.setCurrentSubGraph(Pq(this._currentSubGraph))},M.isVisible=function(I){var O=this;if(Pq(I)!==O._currentSubGraph)return!1;if(cn(I)){var y=I._40I,z=I._41I;if(!y||!z)return!1;if(!(I.s("edge.independent")||O.isVisible(y)&&O.isVisible(z)))return!1;if(I.isEdgeGroupHidden())return!1}else for(var E=I._parent;E&&!E.ISubGraph;){if(gk(E)&&(!E.isExpanded()||!O.isVisible(E)))return!1;E=E._parent}if(I._parent instanceof zm&&!O.isVisible(I._parent))return!1;if(I._refGraph instanceof Ro&&!O.isVisible(I._refGraph))return!1;if(O instanceof Ko){if(!I.s("3d.visible"))return!1}else{var p=O.getLayersInfo();if(p){var P=p[I._layer];if(P&&P.visible===!1)return!1}if(!I.s("2d.visible"))return!1}return O._visibleFunc?O._visibleFunc(I):!0},M.handleSelectionChange=function(c){var a=this;c.datas.each(function(D){a.invalidateData(D);var S=D._parent;gk(S)&&$o(D)&&D.s(Do)&&(a.invalidateData(S),S._49I&&S._49I.each(function(d){a.invalidateData(d)}))}),a.onSelectionChanged(c)},M.onSelectionChanged=function(H){var y=this,f=y.sm();if(1===f.size()&&("set"===H.kind||"append"===H.kind)){var K=f.ld();y.isAutoMakeVisible()&&y.makeVisible(K),y.adjustIndex&&y._dataModel.isAutoAdjustIndex()&&y.adjustIndex(K)}},M.makeVisible=function(V){if(V){var S=this,F=S.getDataUI?S.getDataUI(V):S.getData3dUI(V);if(F){var f=V,u=Pq(V);for(u!==S._currentSubGraph&&S.setCurrentSubGraph(u);(f=f._parent)&&f!==u;)gk(f)&&f.setExpanded(!0);S._23I=V,S.iv()}}},M.getLabel=function(Y){var w=Y.getStyle(ls);return w===e?Y.getName():w},M.getLabelBackground=function(j){return j.getStyle("label.background")},M.getLabelColor=function(L){return L.getStyle("label.color")},M.getLabel2=function(Q){return Q.getStyle("label2")},M.getLabel2Background=function(Z){return Z.getStyle("label2.background")},M.getLabel2Color=function(B){return B.getStyle("label2.color")},M.getNote=function(X){return X.getStyle(Up)},M.getNoteBackground=function(U){return U.getStyle("note.background")},M.getNote2=function(a){return a.getStyle(Ql)},M.getNote2Background=function(D){return D.getStyle("note2.background")},M.handleClick=function(p,v,e){var J=this;v?(J.fi({kind:"clickData",event:p,data:v,part:e}),J.onDataClicked(v,p)):(J.fi({kind:"clickBackground",event:p}),J.onBackgroundClicked(p))},M.handleDoubleClick=function(O,G,T){var d=this;Qf(O)&&(G?(d.fi({kind:"doubleClickData",event:O,data:G,part:T}),d.onDataDoubleClicked(G,O,T),d.checkDoubleClickOnNote(O,G,T)||d.checkDoubleClickOnRotation&&d.checkDoubleClickOnRotation(O,G,T)||(cn(G)?d.onEdgeDoubleClicked(G,O,T):G.ISubGraph?d.onSubGraphDoubleClicked(G,O,T):gk(G)?d.onGroupDoubleClicked(G,O,T):G.IDoorWindow?d.onDoorWindowDoubleClicked(G,O,T):G.ICSGBox&&d.onCSGBoxDoubleClicked(G,O,T))):(d.fi({kind:"doubleClickBackground",event:O}),d.onBackgroundDoubleClicked(O)))},M.onSubGraphDoubleClicked=function(E){this.setCurrentSubGraph(E)},M.onEdgeDoubleClicked=function(e,k){this.isEditable(e)||(e.ISubGraph&&!Kc(k)?this.setCurrentSubGraph(e):e.s("edge.toggleable")&&e.toggle())},M._39Q=function(w){return this.isInteractive(w)?this.preventDefaultWhenInteractive(w):!1},M.preventDefaultWhenInteractive=function(q){return q.s("preventDefaultWhenInteractive")},M.onGroupDoubleClicked=function(A){A.s("group.toggleable")&&A.toggle()},M.onDoorWindowDoubleClicked=function(h){h.s("dw.toggleable")&&h.toggle(!0)},M.onCSGBoxDoubleClicked=function(p,V){var X=this;if(X instanceof Ko){var N=X.getHitFaceInfo(V);N&&N.face&&p.s(N.face+".toggleable")&&p.toggleFace(N.face,!0)}},M.onBackgroundClicked=function(){},M.onBackgroundDoubleClicked=function(){this.upSubGraph()},M.onDataClicked=function(){},M.onDataDoubleClicked=function(){},M.onAutoLayoutEnded=function(){},M.onMoveEnded=function(){},M.onPanEnded=function(){},M.onPinchEnded=function(){},M.onRectSelectEnded=function(){},M.onZoomEnded=function(){},M.serialize=function(O){return this.dm().serialize(O)},M.toJSON=function(){return this.dm().toJSON()},M.deserialize=function(O,_){var x=this;_=_ instanceof ej?{rootParent:_}:ql(_)?{setId:_}:Fd(_)?{finishFunc:_}:_||{},_.view=x;var Q=x.dm();return _.__innerHandler__=function(j){if(ql(Q.a("toolTipEnable"))&&(Q.a("toolTipEnable")?x.enableToolTip():x.disableToolTip()),x instanceof P.graph.GraphView&&(ql(Q.a("zoomable"))&&x.setZoomable&&x.setZoomable(Q.a("zoomable")),ql(Q.a("pannable"))&&x.setPannable&&x.setPannable(Q.a("pannable")),ql(Q.a("rectSelectable"))&&x.setRectSelectable&&x.setRectSelectable(Q.a("rectSelectable")),Q.a("fitContent")===!0&&x.fitContent&&x.fitContent(!0,0)),x instanceof P.graph3d.Graph3dView){var H=j.scene;H&&(H.eye&&x.setEye(H.eye),H.center&&x.setCenter(H.center),H.batchInfoMap&&b.setBatchInfoMap(H.batchInfoMap)),vp(Q.a("sceneNear"))&&x.setNear(Q.a("sceneNear")),vp(Q.a("sceneFar"))&&x.setFar(Q.a("sceneFar")),ql(Q.a("sceneDashEnable"))&&x.setDashDisabled(!Q.a("sceneDashEnable")),nf(Q.a("sceneHighlightMode"))&&x.setHighlightMode(Q.a("sceneHighlightMode")),vp(Q.a("sceneHighlightWidth"))&&x.setHighlightWidth(Q.a("sceneHighlightWidth")),Q.a("sceneHighlightColor")&&x.setHighlightColor(Q.a("sceneHighlightColor")),ql(Q.a("sceneHeadlightEnable"))&&x.setHeadlightDisabled(!Q.a("sceneHeadlightEnable")),vp(Q.a("sceneHeadlightRange"))&&x.setHeadlightRange(Q.a("sceneHeadlightRange")),Q.a("sceneHeadlightColor")&&x.setHeadlightColor(Q.a("sceneHeadlightColor")),vp(Q.a("sceneHeadlightIntensity"))&&x.setHeadlightIntensity(Q.a("sceneHeadlightIntensity")),vp(Q.a("sceneHeadlightAmbientIntensity"))&&x.setHeadlightAmbientIntensity(Q.a("sceneHeadlightAmbientIntensity")),ql(Q.a("sceneFogEnable"))&&x.setFogDisabled(!Q.a("sceneFogEnable")),Q.a("sceneFogColor")&&x.setFogColor(Q.a("sceneFogColor")),vp(Q.a("sceneFogNear"))&&x.setFogNear(Q.a("sceneFogNear")),vp(Q.a("sceneFogFar"))&&x.setFogFar(Q.a("sceneFogFar")),ql(Q.a("sceneBatchBrightnessDisabled"))&&x.setBatchBrightnessDisabled(Q.a("sceneBatchBrightnessDisabled")),ql(Q.a("sceneBatchBlendDisabled"))&&x.setBatchBlendDisabled(Q.a("sceneBatchBlendDisabled")),ql(Q.a("sceneBatchColorDisabled"))&&x.setBatchColorDisabled(Q.a("sceneBatchColorDisabled"))}},Q.deserialize(O,_.rootParent,_)},M.isDebugTipShowing=function(){return!!this._debugDiv},M.showDebugTip=function(){var n=this,E=n._debugDiv;if(!E){E=n._debugDiv=x.createElement("div"),E.style.position="absolute",E.style.overflow="hidden",E.style.font=b.debugTipLabelFont,E.style.padding="6px",E.style.backgroundColor=b.debugTipBackground,E.style.color=b.debugTipLabelColor;var K=n.getView();n._79O?K.insertBefore(E,n._79O):K.appendChild(E);var R=function(){n.redraw();var h=n._canvas,g="FPS: "+n._fpsInfo.fps+"<br/>"+"Datas: "+n.dm().getDatas().length+(h?"<br/>Size: "+h.width+" * "+h.height:""),J=n.dm()._historyManager;J&&(g+="<br/>Undoes: "+J.getHistories().length+" index: "+J.getHistoryIndex());var c=n.getDebugTip();c&&(g+="<hr>"+c),E.innerHTML=g,n._isDebugging&&requestAnimationFrame(R)};requestAnimationFrame(R),n._isDebugging=!0}},M.hideDebugTip=function(){var P=this,H=P._debugDiv;H&&(delete P._debugDiv,P.getView().removeChild(H),P._isDebugging=!1)},M.updateDOMAppendMatrix=function(){var h=this.getView();h&&(h.updateAppendMatrix=!0)},M.countFrame=function(){if(this._isDebugging){var P=Date.now(),Z=this._fpsInfo;P-Z.time>1e3?(Z.fps=Math.round(1e5*(Z.frames+1)/(P-Z.time))/100,Z.time=P,Z.frames=0):Z.frames++}}},ms_icons:function(L){L.getRotation=function(K){return K==A?0:K},L._15O=function(){var G=this,M=G.s(jr);if(M){var k=G,X=G.data||G._data,l=G._38o={icons:M,rects:{}};for(var E in M){var f=M[E],Z=_d(f.shape3d,X,k);if(!(_d(f.visible,X,k)===!1||_d(f.for3d,X,k)&&!G.I3d||Z&&!G.I3d)){var Y=Z?[Z]:_d(f.names,X,k),L=Y?Y.length:0,e=_d(f.position,X,k)||3,K=_d(f.offsetX,X,k)||0,V=_d(f.offsetY,X,k)||0,N=_d(f.direction,X,k)||xe,W=_d(f.gap,X,k),u=W!=A?W:1,D=_d(f.rotation,X,k),x=_d(f.keepOrien,X,k),q=_d(f.rotationFixed,X,k)?D:G.getRotation(D,x,e),g=A,$=l.rects[E]=new Array(L);$.rotation=q;for(var c=0;L>c;c++){var F,d,t,m,n=Y[c];if(Z)t=0,m=0;else{var O=Ef(n);t=_d(f.width,X,k),m=_d(f.height,X,k),t==A&&(t=pl(O,X)),m==A&&(m=Vf(O,X))}if(g?N===xe?K+=t/2:N===pj?K-=t/2:N===Ab?V-=m/2:V+=m/2:g={width:t,height:m},G.I3d){var i=-t/2,U=-m/2;d={width:t,height:m,mat:G._16O(_d(f.autorotate,X,k),e,g,_d(f.face,X,k)||Kg,_d(f.t3,X,k),_d(f.r3,X,k),_d(f.rotationMode,X,k),K,V),vs:new On([i,-U,0,i,-U-m,0,i+t,-U-m,0,i+t,-U,0])}}else F=G.getPosition(e,K,V,g,_d(f.positionFixed,X,k)),d={x:F.x-t/2,y:F.y-m/2,width:t,height:m},G._68o(d,q);$[c]=d,N===xe?K+=t/2+u:N===pj?K-=t/2+u:N===Ab?V-=m/2+u:V+=m/2+u}}}}}}});var sd={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},go={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},fj={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Rr={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Fk={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Bg={"edge.type":1,"edge.group":1},Lb={rotation:1,rotationX:1,rotationZ:1},Gq={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},Iq={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},vj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Xi={shape:1,thickness:1,position:1,anchor:1,scale:1},Pq=function(_){if(!_)return A;if(cn(_)){var S=_._40I,Z=_._41I;if(!S||!Z)return A;var g=Pq(S),z=Pq(Z);return g===z?g:A}for(var n=_._parent;cn(n)&&!n.ISubGraph;)n=n._parent;return n?n.ISubGraph?n:Pq(n):A},gr=function(C,i,V,p){var d=i.getStyle(V)*p;d&&Qj(C,d),d=i.getStyle(V+".left")*p,d&&(C.x-=d,C.width+=d),d=i.getStyle(V+".right")*p,d&&(C.width+=d),d=i.getStyle(V+".top")*p,d&&(C.y-=d,C.height+=d),d=i.getStyle(V+".bottom")*p,d&&(C.height+=d),C.width<0&&(C.width=-C.width,C.x-=C.width),C.height<0&&(C.height=-C.height,C.y-=C.height)},Mn=function(y){for(var Q,x=0,t=y.size();t>x;x++)if(Q=y.getChildAt(x),$o(Q)&&Mn(Q))return!0;return y.hasAgentEdges()},Tg=function(G){if(!G)return A;for(var Y=G._parent;gk(Y);){if(!gk(Y._parent))return Y.isExpanded()?G:Y;Y.isExpanded()||(G=Y),Y=Y._parent}return G},dh=function(K,C){if(!K||!C)return A;var m,i,e,T=Pq(K),P=Pq(C);if(T!==P){for(;P&&T!==P;)P=Pq(P);if(T===P)return K;m=new Tr,m.add(K,0);for(var g=K._parent;$o(g)&&!C.isDescendantOf(g);)m.add(g,0),g=g._parent;for(e=m.size(),i=0;e>i;i++){var u=m.get(i);if(gk(u)&&!u.isExpanded())return u;if(u.ISubGraph)return u}return K}return K},Mb=function(K){if(K.isLooped())return K._source;var q=Tg(K._source),O=Tg(K._target);return q===O?K._source:dh(q,O)},lk=function(n){if(n.isLooped())return n._target;var O=Tg(n._source),r=Tg(n._target);return O===r?n._target:dh(r,O)},gd=function(X,C,G){"target"!==G&&(G="source");var F="target"===G?C.getTargetAgent():C.getSourceAgent(),g="edge."+G+".";if(cn(F)){var c=X.getDataUI(F);c._79o();var e=C.s(g+"index");if(e>=0){var n=Ol(c);return n[Math.max(0,Math.min(e,n.length-1))]}var d=C.s(g+"percent")||0;d=Math.max(0,Math.min(d,1));var f=wp(c);return jf(f,100*d)}return Rb(X,F,C.s(g+"position"),C.s(g+"offset.x"),C.s(g+"offset.y"),C.s(g+"anchor.x"),C.s(g+"anchor.y"))},Rb=function(c,g,K,i,r,T,$){if(!g)return A;var U,Y=g.getRotation?g.getRotation():0;if(T!==e||$!==e){T=T===e?.5:T,$=$===e?.5:$;var H=g.getScale();if(Y&&!Ak(g,c)||H.x<0||H.y<0){var b=g.getPosition(),M=g.getWidth(),G=g.getHeight(),v=g.getAnchor(),Z=new md(Y,b.x,b.y,H.x,H.y);K=Z.tf((T-v.x)*M,($-v.y)*G)}else U=kb(c,g),K={x:U.x+T*U.width,y:U.y+$*U.height}}else K=Ne(K,kb(c,g));if(Y){var s=E(Y),V=j(Y),f=i*s-r*V;r=i*V+r*s,i=f}return K.x+=i,K.y+=r,K},Nq=function(F,h){if(!F||!h)return A;var w,o,k,E,I,J;if(F===h){if(E=F.getLoopedEdges(),!E)return A;E=new Tr(E)}else{if(I=F.getAgentEdges(),J=h.getAgentEdges(),!I||!J)return A;for(o=I.size(),w=0;o>w;w++)k=I.get(w),J.contains(k)&&(E||(E=new Tr),E.add(k))}if(E)for(w=0;w<E.size();w++)k=E.get(w),k.getStyle(km)===od&&(k._22I(A),E.removeAt(w),w--);return E},Zp=function(V,t){var f=Nq(V,t);if(f&&!f.isEmpty()){if(1===f.size())return f.get(0)._22I(A),void 0;var F=new Tr,O=new Tr;f.each(function(G){var $=G.s("edge.group");F.contains($)||F.add($)}),F.sort(),F.each(function(K){O.add(new P.EdgeGroup(f.toList(function(A){return K===A.s("edge.group")}),O))}),O.each(function(D){D.each(function(M){M._22I(D)})})}},tg=function(A,p,o){var a=A._canvas;A._zoom;var _=Uc(p,a),l=Uc(o,a);return{x:_.x-l.x,y:_.y-l.y}},Hb=function(a,w){if(w){var x=w.rect,R=w.color,p=w.rotation,M=w.labelWidth,X=w.background,y=w.opacity,Z=w.scale,$=Z!=A&&1!==Z;if(y!=A){var g=a.globalAlpha;a.globalAlpha*=y}if(p||$){a.save();var E=x.x+x.width/2,V=x.y+x.height/2;Xf(a,E,V),p&&jb(a,p),$&&a.scale(Z,Z),Xf(a,-E,-V)}if(X&&ld(a,x.x,x.y,x.width,x.height,X),M){var h=x.width,U=a.createLinearGradient(x.x,x.y,x.x+h,x.y);U.addColorStop(0,R),U.addColorStop(.9,R),U.addColorStop(1,Ph),R=U,x.width=M}cs(a,w.ss,x,w.font,R,w.align),M&&(x.width=h),(p||$)&&a.restore(),y!=A&&(a.globalAlpha=g)}},Wm=function(D,d){if(d){var w=d.rect,r=w.x,$=w.y,o=w.width,I=w.height,h=d.background,p=d.backgroundImage,S=d.borderWidth,i=d.borderColor,y=d.labelWidth,L=d.opacity,X=d.scale,Y=X!=A&&1!==X;if(L!=A){var t=D.globalAlpha;D.globalAlpha*=L}if(Y){D.save();var j=w.x+w.width/2,s=w.y+w.height/2;Xf(D,j,s),D.scale(X,X),Xf(D,-j,-s)}if(d.expanded){var K=C(8,o/4),M=$+I-8;if(D.fillStyle=h,D.beginPath(),D.moveTo(r,$),D.lineTo(r,M),D.lineTo(r+o/2,M),D.lineTo(r+o/2,$+I),D.lineTo(r+o/2+K,M),D.lineTo(r+o,M),D.lineTo(r+o,$),D.closePath(),D.fill(),S&&(D.lineWidth=S,D.lineJoin="round",D.lineCap="round",i?(D.strokeStyle=i,D.stroke()):(D.strokeStyle=Pm(h),D.beginPath(),D.moveTo(r+o,$),D.lineTo(r+o,M),D.lineTo(r+o/2+K,M),D.lineTo(r+o/2,$+I),D.stroke(),D.strokeStyle=Co(h),D.beginPath(),D.moveTo(r+o,$),D.lineTo(r,$),D.lineTo(r,M),D.lineTo(r+o/2,M),D.lineTo(r+o/2,$+I),D.stroke())),p)Pf(D,Ef(p),lm,w.x,w.y,w.width,w.height-8,d.data,d.view);else{if(w.height-=8,h=d.color,y){var F=o,J=D.createLinearGradient(r,$,r+F,$);J.addColorStop(0,h),J.addColorStop(.9,h),J.addColorStop(1,Ph),h=J,w.width=y}cs(D,d.ss,w,d.font,h,d.align),y&&(w.width=F),w.height+=8}}else if(d.icon)Vh(D,Ef(d.icon),r,$,o,I,d.data,d.view);else{var B=o/2;S&&(D.lineWidth=S,D.lineJoin="round",D.lineCap="round",D.strokeStyle=i?i:Pm(h),D.beginPath(),D.arc(r+B,$+B,B,Z,1.6*O,!0),D.moveTo(r+B,$+I),D.lineTo(r+o-B/5,$+B),D.stroke(),D.strokeStyle=i?i:Co(h),D.beginPath(),D.arc(r+B,$+B,B,1.6*O,Z,!0),D.moveTo(r+B,$+I),D.lineTo(r+B/5,$+B),D.stroke()),D.fillStyle=h,D.beginPath(),D.arc(r+B,$+B,B,0,U,!0),D.moveTo(r+B,$+I),D.lineTo(r+o-B/5,$+B),D.lineTo(r+B/5,$+B),D.closePath(),D.fill(),D.fillStyle=d.color,D.beginPath(),D.arc(r+B,$+B,B/3,0,U,!0),D.fill()}Y&&D.restore(),L!=A&&(D.globalAlpha=t)}},Qh=function(E,N){return N>2*E?E:N/2},ff=function($,d,h,k){if(!$||!d)return 0;var C=o(d.y-$.y,d.x-$.x);return h||(C=d.x<$.x?C+O:C),C+k},Yn=function(T,S,R,H,F,P,y){y&&(T.x>S.x||T.x===S.x&&T.y>S.y)&&(R=sr[R],F=-F);var e=Ne(R,{x:0,y:0,width:np(T,S),height:0},P);return e.x+=H,e.y+=F,e=new md(o(S.y-T.y,S.x-T.x)).tf(e),e.x+=T.x,e.y+=T.y,e},nm=function(X,E,u,P,T){if(X._19Q=!0,!u.getEdgeGroup())return P?u.s("edge.gap"):0;if(cn(u.getSourceAgent())||cn(u.getTargetAgent()))return 0;var H,U=0,D=0,W=0;if(u.getEdgeGroup().getSiblings().each(function(L){L.each(function(M){if(E.isVisible(M)&&M.s(km)==T){var Y=M.s("edge.gap");H?(D+=W/2+Y/2,W=Y):(H=M,W=Y),M===u&&(U=D)}})}),P)return D-U+W;var M=U-D/2;return H&&u._40I!==H._40I&&(X._19Q=!1),M},hk=function(){var L=function(d){var X=[];return d.forEach(function(y){X.push({x:y.x,y:y.y}),X.push({x:y.x+y.width,y:y.y+y.height}),X.push({x:y.x+y.width,y:y.y}),X.push({x:y.x,y:y.y+y.height})}),X};return function(E,e,s){if("oval"===E){var x=0,M=s.height/s.width,T=M*M,N=s.x+s.width/2,U=s.y+s.height/2,P=L(e);P.forEach(function(Y){var v=Y.x-N,h=Y.y-U,E=v*v+h*h/T;E>x&&(x=E)}),x=D(x);var v=M*x;return{x:N-x,y:U-v,width:2*x,height:2*v}}if("circle"===E){var q=0,N=s.x+s.width/2,U=s.y+s.height/2,P=L(e);return P.forEach(function(L){var V=L.x-N,t=L.y-U,l=V*V+t*t;l>q&&(q=l)}),q=D(q),{x:N-q,y:U-q,width:2*q,height:2*q}}return"roundRect"===E?(Qj(s,C(s.width,s.height)/16),s):s}}(),Nl=P.graph={},Of=function(d,e,Q){$g(h+".graph."+d,e,Q)};P.layout={};var ck={},to=function(W,b,y,n,l,F,C,J){var Q=[b.uuid,Math.round(n),Math.round(l),y].join("_");b.cacheRule&&(Q+=_d(b.cacheRule,F,C));var X=C._zoom;X!==C._cacheZoom&&(C._cacheZoom=X,C._cacheImage={}),X*=Af;var k=C._cacheImage[Q];return k||(Pn(),k=P.Default.toCanvas(b,Math.ceil(n*X),Math.ceil(l*X),y,F,C,J),Ih()&&(C._cacheImage[Q]=k)),k};Ec(b,{setImageCacheRule:function(g,$){var F;$||"object"!=typeof g?(F={},F[g]=$):F=g;for(var E in F){var J=F[E];nf(E)?($g=Ef(E),$g?$g.cacheRule=J:ck[E]=J):E.cacheRule=J
}}});var Ag={comps:[{type:Mh,points:[85,50,70,115,100,71,86,107,88,49,43,48,68,101,106,77,79,122,47,70,74,109,56,104,102,90,43,71,104,100,81,47,99,106,77,107,119,77,111,98,107,107,52,61],borderWidth:1,borderColor:A}]};if(Ag[Cq]=Ag[ll]=160,_.Image){var Jk=new _.Image;Jk.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",nk("default_blank",Jk)}nk("node_image",pn(30,30,[{type:Dl,rect:[4,5,22,16],gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[2,3,26,20],borderWidth:1,borderColor:Cr},{type:Dl,rect:[11,23,8,4],background:Cr},{type:Dl,rect:[6,27,18,2],background:Cr}])),nk("node_icon",pn(16,16,[{type:Dl,rect:[2,2,12,10],gradient:rj,gradientColor:Hp,background:Cr},{type:cd,rect:[2,2,12,10],width:1,color:Cr},{type:Dl,rect:[6,12,4,2],background:Cr},{type:Dl,rect:[4,14,8,1],background:Cr}])),nk("block_icon",pn(16,16,[{type:cd,rect:[1,1,14,14],width:1,color:Cr}])),nk("group_image",pn(66,39,[{type:Dl,rect:[44.3,18,18.1,12.8],gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[3.3,17.8,18.1,12.8],gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Cr,gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[26.2,29.4,12.8,4.2],background:Cr},{type:Dl,rect:[21.3,33.5,22.5,2.3],background:Cr},{type:Dl,rect:[5.3,32.7,14.1,2.1],background:Cr},{type:Dl,rect:[9,30.4,6.7,2.4],background:Cr},{type:Dl,rect:[50,30.7,6.7,2.4],background:Cr},{type:Dl,rect:[46.3,33,14.1,2.1],background:Cr}])),nk("group_icon",pn(16,16,[{type:Dl,rect:[4,12,4,2],background:Cr},{type:Dl,rect:[2,13,8,1],background:Cr},{type:Dl,rect:[12,12,2,1],background:Cr},{type:Dl,rect:[11,13,4,1],background:Cr},{type:Dl,rect:[10,7,6,5],gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[1,2,10,10],gradient:rj,gradientColor:Hp,background:Cr},{type:cd,rect:[1,2,10,10],width:1,color:Cr}])),nk("refGraph_icon",pn(16,16,[{type:"shape",borderWidth:1,borderColor:Cr,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Cr,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),nk("edge_icon",pn(16,16,[{type:Dl,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[10.8,1,4,4],background:Cr},{type:Dl,rect:[1,11,4,4],background:Cr}])),nk("subGraph_image",pn(72,45,[{type:Mh,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[29.6,30.7,3.6,1.8],background:Cr},{type:Dl,rect:[28.4,32.3,6,1.2],background:Cr},{type:Dl,rect:[37.3,32,10.8,1.8],background:Cr},{type:Dl,rect:[39.1,29.9,7.2,2.3],background:Cr},{type:Dl,rect:[26.6,23.7,9.6,7.2],gradient:rj,gradientColor:Hp,background:Cr},{type:Dl,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Cr,gradient:rj,gradientColor:Hp,background:Cr}])),nk("subGraph_icon",pn(17,17,[{type:Mh,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:rj,gradientColor:Hp,background:Cr}])),nk("shape_icon",pn(16,16,[{type:Mh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Cr}])),nk("polyline_icon",pn(16,16,[{type:Mh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Cr},Go(7.5,.4),Go(7.5,6.3),Go(13.6,6.3),Go(13.6,14),Go(.7,13.9),Go(.7,.3)])),nk("grid_icon",pn(16,16,[{type:Dl,rect:[1,1,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[6,1,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[11,1,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[11,6,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[6,6,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[1,6,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[11,11,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[6,11,4,4],background:Cr,gradient:rj,gradientColor:Hp},{type:Dl,rect:[1,11,4,4],background:Cr,gradient:rj,gradientColor:Hp}])),nk("light_icon",pn(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Cr},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Cr,gradient:rj,gradientColor:Hp,background:{func:function(J){var S=J?J.s(pq):A;return Fl(S)?"rgb("+y(255*S[0])+","+y(255*S[1])+","+y(255*S[2])+")":S||Cr}}}])),nk("text_icon",pn(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Cr}])),nk("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),nk("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),nk("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),nk("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Te=function(A,s,S,Z,O,n){var o,g,R,K,G,V,B,y,e,F,c,E=[];if(Math.abs(Z)>2*Math.PI&&(Z=2*Math.PI),G=Math.ceil(Math.abs(Z)/(Math.PI/4)),o=Z/G,g=-o,R=-S,G>0){V=A+Math.cos(S)*O,B=s+Math.sin(-S)*n,E.push({x:V,y:B});for(var Y=0;G>Y;Y++)R+=g,K=R-g/2,y=A+Math.cos(R)*O,e=s+Math.sin(R)*n,F=A+Math.cos(K)*(O/Math.cos(g/2)),c=s+Math.sin(K)*(n/Math.cos(g/2)),E.push({x:F,y:c}),E.push({x:y,y:e})}return E},Cp=function(v){if(v){var L=v._data;if(L instanceof P.Shape)return{points:L.getPoints(),segments:L.getSegments()};var X;if(L instanceof P.Edge&&(X=v._78o)){var o,u,r=X.type,x=X.points,s=X.segments,E=X.edgeTypeInfo;if(!r||x){var l=X.sourcePoint,g=l.x,N=l.y,c=X.targetPoint,T=c.x,h=c.y;if(r)s?(o=new Tr({x:g,y:N}),o.addAll(x),o.add({x:T,y:h}),u=new Tr(s._as)):(o=new Tr({x:g,y:N}),x.each(function(z){o.add(z)}),o.add({x:T,y:h}));else if(X.looped){o=new Tr(Te(g,N,0,2*Math.PI,X.radius,X.radius)),u=new Tr([1]);for(var I=0;I<(o.size()-1)/2;I++)u.add(3)}else o=new Tr,X.center?(o.add({x:X.c1.x,y:X.c1.y}),o.add({x:g,y:N}),o.add({x:T,y:h}),o.add({x:X.c2.x,y:X.c2.y})):(o.add({x:g,y:N}),o.add({x:T,y:h}))}else E&&(o=new Tr(E.points._as),E.segments&&(u=new Tr(E.segments._as)));return{points:o,segments:u}}}},wp=function(e,F,S){if(null==F){var j=Cp(e);if(!j)return;F=j.points,S=j.segments}if(F){if(Array.isArray(F)&&(F=new Tr(F)),"number"==typeof F.get(0)){for(var w=new P.List,v=0;v<F.size();v+=2)w.add({x:F.get(v),y:F.get(v+1)});F=w}if(!S){S=[1];for(var B=F.length-1;B>0;B--)S.push(2)}Array.isArray(S)&&(S=new Tr(S));for(var A=vm(F._as,S._as,50),y=A.length,Z=[],v=0;y>v;v++){var J=A[v];J.length>1&&Z.push(J)}return Z}},Yj=function(u){for(var x=0,d=u.length-1,b=0;d>b;b++){var f=u[b],$=u[b+1],Z=$.x-f.x,p=$.y-f.y;x+=Math.sqrt(Z*Z+p*p)}return x},Nf=function(r,j){for(var B=0,V=j.length,G=0;V>G;G++){var q=j[G];if(B+=q,B>r)return G}return Math.min(G,V-1)},ib=function(F,p){for(var d=0,V=0,M=0,P=F.length-1,_=0;P>_;_++){var q=F[_],D=F[_+1],C=D.x-q.x,H=D.y-q.y;if(M=Math.sqrt(C*C+H*H),d+=M,d>p){d-=M,V=_;break}}var J=F[V],U=F[V+1],g=Math.atan2(U.y-J.y,U.x-J.x),y=p-d,H=Math.sin(g)*y,C=Math.cos(g)*y;return{x:J.x+C,y:J.y+H}},jf=function(R,t){if(R){var C;if(0===t)C=R[0][0];else if(100===t)R=R[R.length-1],C=R[R.length-1];else{for(var H=0,T=[],g=R.length,U=0;g>U;U++){var l=R[U],V=Yj(l);H+=V,T.push(V)}for(var f=H*t/100,u=Nf(f,T),X=0,K=0;u>K;K++)X+=T[K];f-=X,C=ib(R[u],f)}return C}},Ol=function(B){var x,_,R,Q,F=Cp(B),l=[],U=F.points,w=F.segments,J=-1;for(_=0,R=w?w.length:U.length;R>_;_++){if(x=w?w.get(_):1,3===x)Q=2;else if(4===x)Q=3;else{if(5===x)continue;Q=1}J+=Q,l.push(U.get(J))}return l},id=function($,I,E,a){function N(D){if(D>=0&&1>=D){x=I(D);var M=($.x-x.x)*($.x-x.x)+($.y-x.y)*($.y-x.y);return Z>M?(Z=M,P=D,!0):!1}}E=E||100,a=a||1e-5;for(var Z=1/0,P=0,x=new $j,u=0;E>u;++u)N(u/E);for(var j=1/(2*E);j>a;)N(P-j)||N(P+j)||(j/=2);return P};Ec(b,{_edgeProtectMethod:{getStraightLinePoints:wp,calculateLineLength:Yj,calcSegmentIndexByDistance:Nf,calculatePointAlongLine:ib,getPercentPosition:jf,getRealPointsFromDataUI:Ol}});var rl=function(V,M){for(var j=V.vertices,r=0;r<j.length;r++){var b=j[r],u=b.y;b.y=b.z,b.z=-u,M&&(b.y+=M)}},Nj=function(W){for(var m,N,O,M,s,k,p=[],R=[],T=[],t=W.faces,y=0,D=0,b=0,i=t.length;i>y;y++,D+=6,b+=9){var z=t[y];1===z.i?(m||(m=[],N=[],O=[]),Tn(z,y,D,b,W,m,O,N)):2===z.i?(M||(M=[],s=[],k=[]),Tn(z,y,D,b,W,M,k,s)):Tn(z,y,D,b,W,p,T,R)}return{vs:p,uv:R,ns:T,top_vs:m,top_uv:N,top_ns:O,bottom_vs:M,bottom_uv:s,bottom_ns:k}},Tn=function(d,c,T,a,B,S,i,Y){var v=B.vertices,F=B.faceVertexUvs,D=v[d.a],P=v[d.b],o=v[d.c];S[a]=D.x,S[a+1]=D.y,S[a+2]=D.z,S[a+3]=P.x,S[a+4]=P.y,S[a+5]=P.z,S[a+6]=o.x,S[a+7]=o.y,S[a+8]=o.z;var s=d.vertexNormals;if(3===s.length){var e=s[0],$=s[1],n=s[2];i[a]=e.x,i[a+1]=e.y,i[a+2]=e.z,i[a+3]=$.x,i[a+4]=$.y,i[a+5]=$.z,i[a+6]=n.x,i[a+7]=n.y,i[a+8]=n.z}else{var q=d.normal;i[a]=q.x,i[a+1]=q.y,i[a+2]=q.z,i[a+3]=q.x,i[a+4]=q.y,i[a+5]=q.z,i[a+6]=q.x,i[a+7]=q.y,i[a+8]=q.z}var R=F[0][c][0],Q=F[0][c][1],M=F[0][c][2];Y[T]=R.x,Y[T+1]=R.y,Y[T+2]=Q.x,Y[T+3]=Q.y,Y[T+4]=M.x,Y[T+5]=M.y},Pp=function(){function $($,o){return $.dot(o)>0}function k(h,O,q,v,U,u,_){for(var P,s,x=[O,q,v],C=[U,u,_],a=[],d=x.length,Q=!0;d--&&Q;){for(var o=x[d],B=C.length,p=!1;B--;)if(o.equals(C[B])){C.splice(B,1),a.push(o),p=!0;break}if(!p){if(P){Q=!1;break}P=o}}return Q&&2===a.length&&(s=C[0],Y.subVectors(P,a[0]),r.subVectors(s,a[0]),E.subVectors(P,a[1]),Y.x*E.y*r.z+E.x*r.y*Y.z+r.x*Y.y*E.z-r.x*E.y*Y.z-r.y*E.z*Y.x-r.z*E.x*Y.y<1e-6&&(z.subVectors(s,a[1]),D.subVectors(a[1],a[0]),$(D,Y)&&$(D,r)&&(D.negate(),$(D,E)&&$(D,z))))?(h.push(a[1].x,a[1].y,a[1].z),h.push(P.x,P.y,P.z),h.push(P.x,P.y,P.z),h.push(a[0].x,a[0].y,a[0].z),h.push(a[0].x,a[0].y,a[0].z),h.push(s.x,s.y,s.z),h.push(s.x,s.y,s.z),h.push(a[1].x,a[1].y,a[1].z),2):(h.push(O.x,O.y,O.z),h.push(q.x,q.y,q.z),h.push(q.x,q.y,q.z),h.push(v.x,v.y,v.z),h.push(v.x,v.y,v.z),h.push(O.x,O.y,O.z),1)}function I(){this._vertexMap={},this._lineMap={},this._lineList=[]}function W(M,S,p,H,y,R,x){var c=[p,y];M[0]===H&&c.reverse();var n=[c[0]._key,c[1]._key].join("|"),J=M._triangles[n];J||(M._triangles[n]=J={});var V=[R._key,x._key].join("|");J[V]||(J[V]=[R,x])}function M(H,Z,Y){var T=H._planes[Y._key];if(!T)for(var W in H._planes){var x=H._planes[W];if(x._normal.angleTo(Y)<.001){T=x;break}}return T?(T._vertices.indexOf(Z)<0&&T._vertices.push(Z),void 0):(H._planes[Y.key]={_normal:Y,_vertices:[Z]},void 0)}function J(R){var z=R._ctlineModel;if(z||(R._ctlineModel=z=[]),z[0])return z[0];var w;w=Fl(R)?R:[R];var L,u,p,Z,D,$,J,B,O,m,U,y,K,c,G,T,b,M,r,W=["","top_","bottom_"];for(z=[],L=0,u=w.length;u>L;L++)if(m=w[L])for(Bm(m),p=0,Z=W.length;Z>p;p++)if(O=m[W[p]+"lvs"])for(b=z.length,M=O.length,z.length=b+M,r=0;M>r;++r,++b)z[b]=O[r];else if(J=m[W[p]+"vs"]){B=m[W[p]+"is"],$=B?B.length:J.length/3;for(var D=0;$-1>D;)B?(U=B[D],y=B[D+1],K=B[D+2],c=B[D+3],G=B[D+4],T=B[D+5]):(U=D,y=D+1,K=D+2,c=D+3,G=D+4,T=D+5),A.fromArray(J,3*U),h.fromArray(J,3*y),P.fromArray(J,3*K),S.fromArray(J,3*c),F.fromArray(J,3*G),_.fromArray(J,3*T),D+=3*k(z,A,h,P,S,F,_);$>D&&(B?(U=B[D],y=B[D+1],K=B[D+2]):(U=D,y=D+1,K=D+2),A.fromArray(J,3*U),h.fromArray(J,3*y),P.fromArray(J,3*K),z.push(A.x,A.y,A.z),z.push(h.x,h.y,h.z),z.push(h.x,h.y,h.z),z.push(P.x,P.y,P.z),z.push(P.x,P.y,P.z),z.push(A.x,A.y,A.z))}return R._ctlineModel[0]=z,z}function X(G){var f=G._ctlineModel;if(f||(G._ctlineModel=f=[]),f[1])return f[1];var L;L=Fl(G)?G:[G];var s,C,S,M,T,q,j,V,U,$,h,D,x=["","top_","bottom_"],N=new I;for(f=[],s=0,C=L.length;C>s;s++)if(U=L[s])for(Bm(U),S=0,M=x.length;M>S;S++)if(j=U[x[S]+"vs"]){V=U[x[S]+"is"],q=V?V.length:j.length/3;for(var T=0,T=0;q>T;T+=3)V?($=V[T],h=V[T+1],D=V[T+2]):($=T,h=T+1,D=T+2),N._addTriangle(j,e,$,h,D)}return N._toLineVS(f),G._ctlineModel[1]=f,f}function t(q){var j=q._ctlineModel;if(j||(q._ctlineModel=j=[]),j[2])return j[2];var s;s=Fl(q)?q:[q];var G,J,o,g,W,w,z,K,b,_,B,D,N,C=["","top_","bottom_"],x=new I;for(j=[],G=0,J=s.length;J>G;G++)if(_=s[G])for(Bm(_),o=0,g=C.length;g>o;o++)if(z=_[C[o]+"vs"]){K=_[C[o]+"is"],b=_[C[o]+"ns"],w=K?K.length:z.length/3;for(var W=0,W=0;w>W;W+=3)K?(B=K[W],D=K[W+1],N=K[W+2]):(B=W,D=W+1,N=W+2),x._addTriangle(z,b,B,D,N)}return x._toLineVS(j),q._ctlineModel[2]=j,j}var A=new ps,h=new ps,P=new ps,S=new ps,F=new ps,_=new ps,Y=new ps,E=new ps,r=new ps,z=new ps,D=new ps,p=new ps;I.prototype._findVertex=function(w,I){p.fromArray(w,3*I);var H=[p.x,p.y,p.z].join(","),n=this._vertexMap[H];if(!n){var B=p.clone();B._key=H,this._vertexMap[H]=n=B}return n},I.prototype._findLine=function(h,U){var v=[h,U];h._key>U._key&&v.reverse(),v._key=[v[0]._key,v[1]._key].join("|");var X=this._lineMap[v._key];return X||(this._lineMap[v._key]=X=v,v._triangles={},v._planes={},this._lineList.push(v)),X};var H=new ps,m=new ps;return I.prototype._addTriangle=function(f,Z,Y,e,v){var P,F,$,n=this._findVertex(f,Y),G=this._findVertex(f,e),h=this._findVertex(f,v),K=this._findLine(n,G),q=this._findLine(G,h),I=this._findLine(h,n);Z?(P=(new ps).fromArray(Z,3*Y),P._key=[P.x,P.y,P.z].join("|"),F=(new ps).fromArray(Z,3*e),F._key=[F.x,F.y,F.z].join("|"),$=(new ps).fromArray(Z,3*v),$._key=[$.x,$.y,$.z].join("|"),W(K,n,P,G,F,h,$),W(q,G,F,h,$,n,P),W(I,h,$,n,P,G,F)):(m.subVectors(h,G),H.subVectors(G,n),P=(new ps).crossVectors(H,m),P._key=[P.x,P.y,P.z].join("|"),M(K,h,P),M(q,n,P),M(I,G,P))},I.prototype._toLineVS=function(c){for(var H=this._lineList,W=0,p=H.length;p>W;++W){var I=H[W],s=!1;for(var Y in I._triangles)if(1==N.keys(I._triangles[Y]).length){c.push(I[0].x,I[0].y,I[0].z,I[1].x,I[1].y,I[1].z),s=!0;break}if(!s)for(var i in I._planes)if(1==I._planes[i]._vertices.length){c.push(I[0].x,I[0].y,I[0].z,I[1].x,I[1].y,I[1].z),s=!0;break}}},[J,X,t]}(),Wj=function(R){var h=R._lineModel;if(h)return h;var s;s=Fl(R)?R:[R];var G,J,W,f,Y,T,w,N,n,p,V,m,y=["","top_","bottom_"];for(h=[],G=0,J=s.length;J>G;G++)if(n=s[G])for(W=0,f=y.length;f>W;W++)if(w=n[y[W]+"vs"]){N=n[y[W]+"is"],T=N?N.length:w.length/3;for(var Y=0;T>Y;Y+=3)N?(p=N[Y],V=N[Y+1],m=N[Y+2]):(p=Y,V=Y+1,m=Y+2),p*=3,V*=3,m*=3,h.push(w[p],w[p+1],w[p+2],w[V],w[V+1],w[V+2],w[V],w[V+1],w[V+2],w[m],w[m+1],w[m+2],w[m],w[m+1],w[m+2],w[p],w[p+1],w[p+2])}return R._lineModel=h,h},yn=function(M,i,R,v,n,u,D,s,C){R==A&&(R=!0),v==A&&(v=!0),D==A&&(D=1),s==A&&(s=0);var w=new cl;return xh(w,M,i,C),w=w.toShapes(),Nj(new ul(w,{top:R,bottom:v,curveSegments:n,amount:D,repeatUVLength:u},-D/2+s))},Ln=function(N,O){this.x=N||0,this.y=O||0};Ln.prototype={constructor:Ln,add:function(P){return this.x+=P.x,this.y+=P.y,this},sub:function(E){return this.x-=E.x,this.y-=E.y,this},equals:function(L){return L.x===this.x&&L.y===this.y},multiplyScalar:function(o){return this.x*=o,this.y*=o,this},distanceTo:function(A){return D(this.distanceToSquared(A))},distanceToSquared:function(R){var t=this.x-R.x,d=this.y-R.y;return t*t+d*d},clone:function(){return new Ln(this.x,this.y)}};var Op=function(q,i,a){this.x=q||0,this.y=i||0,this.z=a||0};Op.prototype={constructor:Op,set:function(H,f,t){return this.x=H,this.y=f,this.z=t,this},setY:function(V){return this.y=V,this},copy:function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this},add:function(y){return this.x+=y.x,this.y+=y.y,this.z+=y.z,this},addVectors:function(W,N){return this.x=W.x+N.x,this.y=W.y+N.y,this.z=W.z+N.z,this},sub:function(K){return this.x-=K.x,this.y-=K.y,this.z-=K.z,this},subVectors:function(Z,X){return this.x=Z.x-X.x,this.y=Z.y-X.y,this.z=Z.z-X.z,this},multiplyScalar:function(m){return this.x*=m,this.y*=m,this.z*=m,this},applyMatrix4:function(C){var f=this.x,k=this.y,z=this.z,K=C.elements;return this.x=K[0]*f+K[4]*k+K[8]*z+K[12],this.y=K[1]*f+K[5]*k+K[9]*z+K[13],this.z=K[2]*f+K[6]*k+K[10]*z+K[14],this},divideScalar:function(J){if(0!==J){var o=1/J;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return this},dot:function(P){return this.x*P.x+this.y*P.y+this.z*P.z},length:function(){return D(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(p){var D=this.x,S=this.y,X=this.z;return this.x=S*p.z-X*p.y,this.y=X*p.x-D*p.z,this.z=D*p.y-S*p.x,this},crossVectors:function(I,l){var V=I.x,v=I.y,F=I.z,$=l.x,N=l.y,J=l.z;return this.x=v*J-F*N,this.y=F*$-V*J,this.z=V*N-v*$,this},distanceTo:function(O){return D(this.distanceToSquared(O))},distanceToSquared:function(J){var o=this.x-J.x,B=this.y-J.y,Q=this.z-J.z;return o*o+B*B+Q*Q},clone:function(){return new Op(this.x,this.y,this.z)}};var Mo=function(){this.elements=new Float32Array(16)};Mo.prototype={constructor:Mo,set:function(u,q,A,h,z,l,t,c,Y,V,G,g,i,$,X,j){var x=this.elements;return x[0]=u,x[4]=q,x[8]=A,x[12]=h,x[1]=z,x[5]=l,x[9]=t,x[13]=c,x[2]=Y,x[6]=V,x[10]=G,x[14]=g,x[3]=i,x[7]=$,x[11]=X,x[15]=j,this},makeRotationAxis:function(D,k){var S=E(k),Q=j(k),p=1-S,h=D.x,G=D.y,F=D.z,t=p*h,L=p*G;return this.set(t*h+S,t*G-Q*F,t*F+Q*G,0,t*G+Q*F,L*G+S,L*F-Q*h,0,t*F-Q*G,L*F+Q*h,p*F*F+S,0,0,0,0,1),this}};var $m=function(f){this.repeatUVLength=f};$m.prototype={generateTopUV:function(c,h,v,k,A,p,d){var u,Y,N,j,a=c.vertices,o=a[k].x,K=a[k].y,g=a[A].x,D=a[A].y,H=a[p].x,Z=a[p].y,V=this.repeatUVLength;if(V)u=0,Y=0,N=V,j=V;else{this._bb||(this._bb=h.getBoundingBox());var O=this._bb;u=O.minX,Y=O.minY,N=O.maxX-u,j=O.maxY-Y}return d?[new Ln((o-u)/N,(K-Y)/j),new Ln((g-u)/N,(D-Y)/j),new Ln((H-u)/N,(Z-Y)/j)]:[new Ln((o-u)/N,1-(K-Y)/j),new Ln((g-u)/N,1-(D-Y)/j),new Ln((H-u)/N,1-(Z-Y)/j)]},generateBottomUV:function(f,h,H,b,e,x){return this.generateTopUV(f,h,H,b,e,x,!0)},generateSideWallUV:function(X,F,n,f,K,U,_,C,Y,o,c,I){if(!this._cl){for(var W,k,t=[],l=0,v=n.length,M=0;v>M;M++){W=n[M],k=n[(M+1)%v];var Z=W.x-k.x,d=W.y-k.y,q=D(Z*Z+d*d);t.push(l),l+=q}for(var M=0;v>M;M++)t[M]/=l;this._cl=t}var t=this._cl,u=1-Y/o,A=1-(Y+1)/o,x=t[c],z=t[I];return z>x&&(x+=1),[new Ln(x,u),new Ln(z,u),new Ln(z,A),new Ln(x,A)]}};var hm=function(m,G,i,Y,V,u){this.a=m,this.b=G,this.c=i,this.i=u,this.normal=Y instanceof Op?Y:new Op,this.vertexNormals=Y instanceof Array?Y:[]};hm.prototype={constructor:hm};var sh=[-8,14,-6,11,2,7,4,8,-1],vd=function(){if(vd[Fe]!=A)return vd[Fe];for(var k=vn[Fe],N=sh,u=ej.prototype.getClassName(),H='"',p=0,Q="",h=!1,O=+new(_[u.substr(3,3)+bm[p]]),C=p;C<N.length;C++){var g=N.length-C;Q+=C%2===p?N[C]+g+"":N[C]-g+""}for(var C=p;4>C;C++)Q+=p;if(Q=Q*Q.length/Q.length,O>Q){if(k&&k[p]&&k[4/Dl.length]){for(var S,n,J,Z,I,X,q,l,G=k[0],f=k[1],W="",s=0,C=0;C<f.length;C++)f[C]===H?l?(l=!1,0!==s%2&&(S==A?S=W:n==A?n=W:J==A?J=W:Z==A?Z=W:I==A?I=W:X==A?X=W:q==A&&(q=W)),s++,W=""):l=!0:l&&(W+=f[C]);for(var b,T,a,j="",U=0,C=0;C<G.length;C++)G[C]===H?b?(b=!1,0!==U%2&&(T==A?T=j:a==A&&(a=j)),U++,j=""):b=!0:b&&(j+=G[C]);var v=S+n+J+Z+I+X,$=!X||X===Cl;if(!$&&X)for(var i,C=0,w=X.length;w>C;C++)X[C]===tj[4]?i===Cl?$=Zo:i[0]===Dj[7]&&Cl&&Cl.indexOf(i.substr(1))>=0?$=es:i=A:(i==A?i=X[C]:i+=X[C],C===w-1&&(i===Cl?$=Zo:i[0]===Dj[7]&&Cl&&Cl.indexOf(i.substr(1))>=0&&($=es)));(h=nd(v,q)&&nd(T,a)&&T===S&&$&&(!I||I>O))&&J.indexOf(gm[0])>=0&&(vd[gm[0]]=1),h&&J.indexOf(1)>=0&&(vd[1]=1),h&&J.indexOf(3)>=0&&(vd[2]=1),h&&J.indexOf(4)>=0&&(vd[3]=1),h&&J.indexOf(7)>=0&&(vd[4]=1)}}else h=!0,vd[gm[0]]=vd[1]=vd[2]=vd[3]=vd[4]=1;return vd[Fe]=h,h},th=function(){},Kl=th.prototype;Kl.getPointAt=function(j){var Q=this.getUtoTmapping(j);return this.getPoint(Q)},Kl.getPoints=function(Q){Q||(Q=5);var I,H=[];for(I=0;Q>=I;I++)H.push(this.getPoint(I/Q));return H},Kl.getSpacedPoints=function(V){V||(V=5);var T,d=[];for(T=0;V>=T;T++)d.push(this.getPointAt(T/V));return d},Kl.getLength=function(){var g=this.getLengths();return g[g.length-1]},Kl.getLengths=function(y){if(y||(y=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==y+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var W,e,w=[],A=this.getPoint(0),s=0;for(w.push(0),e=1;y>=e;e++)W=this.getPoint(e/y),s+=W.distanceTo(A),w.push(s),A=W;return this.cacheArcLengths=w,w},Kl.getUtoTmapping=function(D,I){var Z,k=this.getLengths(),r=0,M=k.length;Z=I?I:D*k[M-1];for(var U,n=0,b=M-1;b>=n;)if(r=z(n+(b-n)/2),U=k[r]-Z,0>U)n=r+1;else{if(!(U>0)){b=r;break}b=r-1}if(r=b,k[r]==Z){var P=r/(M-1);return P}var E=k[r],v=k[r+1],a=v-E,s=(Z-E)/a,P=(r+s)/(M-1);return P},Kl.getTangent=function(r){var j=1e-4,N=r-j,b=r+j;0>N&&(N=0),b>1&&(b=1);var g=this.getPoint(N),T=this.getPoint(b),L=T.clone().sub(g);return L.normalize()},Kl.getTangentAt=function(m){var C=this.getUtoTmapping(m);return this.getTangent(C)},th.create=function(H,J){return H.prototype=le(th.prototype),H.prototype.getPoint=J,H};var Sj=function(){this.curves=[],this.autoClose=!1},tq=Sj.prototype=le(Kl);tq.add=function(p){this.curves.push(p)},tq.closePath=function(){var k=this.curves[0].getPoint(0),d=this.curves[this.curves.length-1].getPoint(1);k.equals(d)||this.curves.push(new Be(d,k))},tq.getPoint=function(n){for(var s,Z,m=n*this.getLength(),d=this.getCurveLengths(),X=0;X<d.length;){if(d[X]>=m){s=d[X]-m,Z=this.curves[X];var h=1-s/Z.getLength();return Z.getPointAt(h)}X++}return null},tq.getLength=function(){var Q=this.getCurveLengths();return Q[Q.length-1]},tq.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var c,A=[],f=0,D=this.curves.length;for(c=0;D>c;c++)f+=this.curves[c].getLength(),A.push(f);return this.cacheLengths=A,A},tq.getTransformedPoints=function(O){return this.getPoints(O)},tq.getBoundingBox=function(){var L,h,t,Q,C,s,P=this.getPoints();L=h=Number.NEGATIVE_INFINITY,Q=C=Number.POSITIVE_INFINITY;var k,R,u,W,l=P[0]instanceof Op;for(W=l?new Op:new Ln,R=0,u=P.length;u>R;R++)k=P[R],k.x>L&&(L=k.x),k.x<Q&&(Q=k.x),k.y>h&&(h=k.y),k.y<C&&(C=k.y),l&&(k.z>t&&(t=k.z),k.z<s&&(s=k.z)),W.add(k);var b={minX:Q,minY:C,maxX:L,maxY:h};return l&&(b.maxZ=t,b.minZ=s),b};var Oh=function(w){Sj.call(this),this.actions=[],w&&this.fromPoints(w)},Qg=Oh.prototype=le(Sj.prototype),Si="moveTo",mb="lineTo",Ll="quadraticCurveTo",Oi="bezierCurveTo",ni="arc",Hf="ellipse";Qg.fromPoints=function(N){this.moveTo(N[0].x,N[0].y);for(var p=1,o=N.length;o>p;p++)this.lineTo(N[p].x,N[p].y)},Qg.moveTo=function(){var o=Array.prototype.slice.call(arguments);this.actions.push({action:Si,args:o})},Qg.lineTo=function(A,r){var K=Array.prototype.slice.call(arguments),T=this.actions[this.actions.length-1].args,$=T[T.length-2],g=T[T.length-1],B=new Be(new Ln($,g),new Ln(A,r));this.curves.push(B),this.actions.push({action:mb,args:K})},Qg.quadraticCurveTo=function(w,D,F,Q){var O=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,x=c[c.length-2],t=c[c.length-1],S=new yo(new Ln(x,t),new Ln(w,D),new Ln(F,Q));this.curves.push(S),this.actions.push({action:Ll,args:O})},Qg.bezierCurveTo=function(i,Y,g,_,C,P){var h=Array.prototype.slice.call(arguments),I=this.actions[this.actions.length-1].args,V=I[I.length-2],m=I[I.length-1],y=new Jd(new Ln(V,m),new Ln(i,Y),new Ln(g,_),new Ln(C,P));this.curves.push(y),this.actions.push({action:Oi,args:h})},Qg.arc=function(k,d,Y,c,p,e){var m=this.actions[this.actions.length-1].args,X=m[m.length-2],M=m[m.length-1];this.absarc(k+X,d+M,Y,c,p,e)},Qg.absarc=function(D,U,Y,q,O,d){this.absellipse(D,U,Y,Y,q,O,d)},Qg.ellipse=function(v,M,R,b,T,$,e){var A=this.actions[this.actions.length-1].args,h=A[A.length-2],S=A[A.length-1];this.absellipse(v+h,M+S,R,b,T,$,e)},Qg.absellipse=function(v,g,J,Q,M,H,q){var T=Array.prototype.slice.call(arguments),b=new zj(v,g,J,Q,M,H,q);this.curves.push(b);var t=b.getPoint(1);T.push(t.x),T.push(t.y),this.actions.push({action:Hf,args:T})},Qg.getSpacedPoints=function(u){u||(u=40);for(var g=[],i=0;u>i;i++)g.push(this.getPoint(i/u));return g},Qg.getPoints=function(r,v){r=r||12;var R,h,Y,s,P,O,b,g,i,G,m,F,o,a,u,x,A,V,S=[];for(R=0,h=this.actions.length;h>R;R++)switch(Y=this.actions[R],s=Y.action,P=Y.args,s){case Si:S.push(new Ln(P[0],P[1]));break;case mb:S.push(new Ln(P[0],P[1]));break;case Ll:for(O=P[2],b=P[3],G=P[0],m=P[1],S.length>0?(a=S[S.length-1],F=a.x,o=a.y):(a=this.actions[R-1].args,F=a[a.length-2],o=a[a.length-1]),u=1;r>=u;u++)x=u/r,A=pc.b2(x,F,G,O),V=pc.b2(x,o,m,b),S.push(new Ln(A,V));break;case Oi:for(O=P[4],b=P[5],G=P[0],m=P[1],g=P[2],i=P[3],S.length>0?(a=S[S.length-1],F=a.x,o=a.y):(a=this.actions[R-1].args,F=a[a.length-2],o=a[a.length-1]),u=1;r>=u;u++)x=u/r,A=pc.b3(x,F,G,g,O),V=pc.b3(x,o,m,i,b),S.push(new Ln(A,V));break;case ni:var l,q=P[0],C=P[1],H=P[2],W=P[3],f=P[4],D=!!P[5],e=f-W,p=2*r;for(u=1;p>=u;u++)x=u/p,D||(x=1-x),l=W+x*e,A=q+H*E(l),V=C+H*j(l),S.push(new Ln(A,V));break;case Hf:var l,q=P[0],C=P[1],L=P[2],y=P[3],W=P[4],f=P[5],D=!!P[6],e=f-W,p=2*r;for(u=1;p>=u;u++)x=u/p,D||(x=1-x),l=W+x*e,A=q+L*E(l),V=C+y*j(l),S.push(new Ln(A,V))}var N,z,k=n["shape3d.point.epsilon"],t=!1;for(h=S.length,R=0,h=S.length;h>R;R++)N=S[R],z=R===h-1?S[0]:S[R+1],N&&z&&T(N.x-z.x)<k&&T(N.y-z.y)<k&&(t=!0,S[R]=null);if(t){var d=[];for(R=0;h>R;R++)S[R]&&d.push(S[R]);S=d}return v&&S.push(S[0]),S},Qg.toShapes=function(O,l){function G(Q){var F,r,V,P,K,$=[],B=new Oh;for(F=0,r=Q.length;r>F;F++)V=Q[F],K=V.args,P=V.action,P==Si&&0!=B.actions.length&&($.push(B),B=new Oh),B[P].apply(B,K);return 0!=B.actions.length&&$.push(B),$}function F(Q){for(var C=[],V=0,J=Q.length;J>V;V++){var G=Q[V],t=new cl;t.actions=G.actions,t.curves=G.curves,C.push(t)}return C}function j(N,p){for(var S=1e-10,Y=p.length,j=!1,z=Y-1,c=0;Y>c;z=c++){var r=p[z],M=p[c],F=M.x-r.x,b=M.y-r.y;if(T(b)>S){if(0>b&&(r=p[c],F=-F,M=p[z],b=-b),N.y<r.y||N.y>M.y)continue;if(N.y==r.y){if(N.x==r.x)return!0}else{var a=b*(N.x-r.x)-F*(N.y-r.y);if(0==a)return!0;if(0>a)continue;j=!j}}else{if(N.y!=r.y)continue;if(M.x<=N.x&&N.x<=r.x||r.x<=N.x&&N.x<=M.x)return!0}}return j}var D=G(this.actions);if(0==D.length)return[];if(l===!0)return F(D);var I,L,E,U=[];if(1==D.length)return L=D[0],E=new cl,E.actions=L.actions,E.curves=L.curves,U.push(E),U;var b=!pc.isClockWise(D[0].getPoints());b=O?!b:b;var X,_=[],p=[],Q=[],J=0;p[J]=e,Q[J]=[];var R,N;for(R=0,N=D.length;N>R;R++)L=D[R],X=L.getPoints(),I=pc.isClockWise(X),I=O?!I:I,I?(!b&&p[J]&&J++,p[J]={s:new cl,p:X},p[J].s.actions=L.actions,p[J].s.curves=L.curves,b&&J++,Q[J]=[]):Q[J].push({h:L,p:X[0]});if(!p[0])return F(D);if(p.length>1){for(var x=!1,y=[],n=0,w=p.length;w>n;n++)_[n]=[];for(var n=0,w=p.length;w>n;n++){p[n];for(var W=Q[n],C=0;C<W.length;C++){for(var q=W[C],g=!0,Z=0;Z<p.length;Z++)j(q.p,p[Z].p)&&(n!=Z&&y.push({froms:n,tos:Z,hole:C}),g?(g=!1,_[Z].push(q)):x=!0);g&&_[n].push(q)}}y.length>0&&(x||(Q=_))}var d,z,K;for(R=0,N=p.length;N>R;R++)for(E=p[R].s,U.push(E),d=Q[R],z=0,K=d.length;K>z;z++)E.holes.push(d[z].h);return U};var cl=function(){Oh.apply(this,arguments),this.holes=[]},rg=cl.prototype=le(Qg);rg.getPointsHoles=function(S){var j,f=this.holes.length,P=[];for(j=0;f>j;j++)P[j]=this.holes[j].getTransformedPoints(S);return P},rg.extractAllPoints=function(m){return{shape:this.getTransformedPoints(m),holes:this.getPointsHoles(m)}},rg.extractPoints=function(j){return this.extractAllPoints(j)};var pc={triangulateShape:function(R,A){function H(Y,y,w){return Y.x!=y.x?Y.x<y.x?Y.x<=w.x&&w.x<=y.x:y.x<=w.x&&w.x<=Y.x:Y.y<y.y?Y.y<=w.y&&w.y<=y.y:y.y<=w.y&&w.y<=Y.y}function s(o,y,i,Z,I){var F=1e-10,Q=y.x-o.x,G=y.y-o.y,A=Z.x-i.x,d=Z.y-i.y,D=o.x-i.x,j=o.y-i.y,l=G*A-Q*d,C=G*D-Q*j;if(T(l)>F){var n;if(l>0){if(0>C||C>l)return[];if(n=d*D-A*j,0>n||n>l)return[]}else{if(C>0||l>C)return[];if(n=d*D-A*j,n>0||l>n)return[]}if(0==n)return!I||0!=C&&C!=l?[o]:[];if(n==l)return!I||0!=C&&C!=l?[y]:[];if(0==C)return[i];if(C==l)return[Z];var X=n/l;return[{x:o.x+X*Q,y:o.y+X*G}]}if(0!=C||d*D!=A*j)return[];var K=0==Q&&0==G,k=0==A&&0==d;if(K&&k)return o.x!=i.x||o.y!=i.y?[]:[o];if(K)return H(i,Z,o)?[o]:[];if(k)return H(o,y,i)?[i]:[];var U,W,a,w,f,s,_,x;return 0!=Q?(o.x<y.x?(U=o,a=o.x,W=y,w=y.x):(U=y,a=y.x,W=o,w=o.x),i.x<Z.x?(f=i,_=i.x,s=Z,x=Z.x):(f=Z,_=Z.x,s=i,x=i.x)):(o.y<y.y?(U=o,a=o.y,W=y,w=y.y):(U=y,a=y.y,W=o,w=o.y),i.y<Z.y?(f=i,_=i.y,s=Z,x=Z.y):(f=Z,_=Z.y,s=i,x=i.y)),_>=a?_>w?[]:w==_?I?[]:[f]:x>=w?[f,W]:[f,s]:a>x?[]:a==x?I?[]:[U]:x>=w?[U,W]:[U,s]}function Q(C,P,k,x){var U=1e-10,$=P.x-C.x,N=P.y-C.y,e=k.x-C.x,K=k.y-C.y,t=x.x-C.x,S=x.y-C.y,J=$*K-N*e,Z=$*S-N*t;if(T(J)>U){var j=t*K-S*e;return J>0?Z>=0&&j>=0:Z>=0||j>=0}return Z>0}function C(z,i){function Y(r,w){var i=t.length-1,M=r-1;0>M&&(M=i);var Y=r+1;Y>i&&(Y=0);var q=Q(t[r],t[M],t[Y],C[w]);if(!q)return!1;var e=C.length-1,W=w-1;0>W&&(W=e);var X=w+1;return X>e&&(X=0),q=Q(C[w],C[W],C[X],t[r]),q?!0:!1}function H(h,$){var i,P,J;for(i=0;i<t.length;i++)if(P=i+1,P%=t.length,J=s(h,$,t[i],t[P],!0),J.length>0)return!0;return!1}function k(G,z){var O,D,e,B,j;for(O=0;O<V.length;O++)for(D=i[V[O]],e=0;e<D.length;e++)if(B=e+1,B%=D.length,j=s(G,z,D[e],D[B],!0),j.length>0)return!0;return!1}for(var C,R,l,r,K,X,I,o,d,M,B,t=z.concat(),V=[],P=[],u=0,S=i.length;S>u;u++)V.push(u);for(var N=0,p=2*V.length;V.length>0&&(p--,!(0>p));)for(l=N;l<t.length;l++){r=t[l],R=-1;for(var u=0;u<V.length;u++)if(X=V[u],I=r.x+":"+r.y+":"+X,P[I]===e){C=i[X];for(var G=0;G<C.length;G++)if(K=C[G],Y(l,G)&&!H(r,K)&&!k(r,K)){R=G,V.splice(u,1),o=t.slice(0,l+1),d=t.slice(l),M=C.slice(R),B=C.slice(0,R+1),t=o.concat(M).concat(B).concat(d),N=l;break}if(R>=0)break;P[I]=!0}if(R>=0)break}return t}for(var M,L,$,O,B,N,t={},P=R.concat(),v=0,E=A.length;E>v;v++)Array.prototype.push.apply(P,A[v]);for(M=0,L=P.length;L>M;M++)B=P[M].x+":"+P[M].y,t[B]!==e,t[B]=M;var I=C(R,A),r=ki.Triangulate(I,!1);for(M=0,L=r.length;L>M;M++)for(O=r[M],$=0;3>$;$++)B=O[$].x+":"+O[$].y,N=t[B],N!==e&&(O[$]=N);return r.concat()},isClockWise:function(n){return ki.Triangulate.area(n)<0},b2p0:function(t,h){var i=1-t;return i*i*h},b2p1:function(t,k){return 2*(1-t)*t*k},b2p2:function(v,R){return v*v*R},b2:function(x,u,P,H){return this.b2p0(x,u)+this.b2p1(x,P)+this.b2p2(x,H)},b3p0:function(S,O){var D=1-S;return D*D*D*O},b3p1:function(u,m){var x=1-u;return 3*x*x*u*m},b3p2:function(a,J){var T=1-a;return 3*T*a*a*J},b3p3:function(D,R){return D*D*D*R},b3:function(U,N,L,r,A){return this.b3p0(U,N)+this.b3p1(U,L)+this.b3p2(U,r)+this.b3p3(U,A)}},ki={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var s=N.keys(this.faces);return s.length?s[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(F){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(p){var U=p.familyName.toLowerCase(),a=this;return a.faces[U]=a.faces[U]||{},a.faces[U][p.cssFontWeight]=a.faces[U][p.cssFontWeight]||{},a.faces[U][p.cssFontWeight][p.cssFontStyle]=p,p},drawText:function(O){var r,v=this.getFace(),h=this.size/v.resolution,c=0,U=String(O).split(""),S=U.length,l=[];for(r=0;S>r;r++){var e=new Oh,i=this.extractGlyphPoints(U[r],v,h,c,e);i&&(c+=i.offset*this.spacing,l.push(i.path))}var w=c/2;
return{paths:l,offset:w}},extractGlyphPoints:function(H,S,c,T,O){var Z,y,B,w,v,$,j,F,u,t,Y,n,l,s,R,C,m,Q,L,h=[],a=S.glyphs[H]||S.glyphs["?"];if(a){if(a.o)for(w=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),$=w.length,j=c,F=c,Z=0;$>Z;)switch(v=w[Z++]){case"m":u=w[Z++]*j+T,t=w[Z++]*F,O.moveTo(u,t);break;case"l":u=w[Z++]*j+T,t=w[Z++]*F,O.lineTo(u,t);break;case"q":if(Y=w[Z++]*j+T,n=w[Z++]*F,R=w[Z++]*j+T,C=w[Z++]*F,O.quadraticCurveTo(R,C,Y,n),L=h[h.length-1])for(l=L.x,s=L.y,y=1,B=this.divisions;B>=y;y++){var N=y/B;pc.b2(N,l,R,Y),pc.b2(N,s,C,n)}break;case"b":if(Y=w[Z++]*j+T,n=w[Z++]*F,R=w[Z++]*j+T,C=w[Z++]*F,m=w[Z++]*j+T,Q=w[Z++]*F,O.bezierCurveTo(R,C,m,Q,Y,n),L=h[h.length-1])for(l=L.x,s=L.y,y=1,B=this.divisions;B>=y;y++){var N=y/B;pc.b3(N,l,R,m,Y),pc.b3(N,s,C,Q,n)}}return{offset:a.ha*c,path:O}}}};ki.generateShapes=function(V,A){A=A||{};var D=A.font;if(D===e&&(D=ki.getDefaultFont(),!D))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var R=A.size!==e?A.size:1,Y=A.curveSegments!==e?A.curveSegments:4,N=A.spacing!==e?A.spacing:1,G=A.weight!==e?A.weight:"normal",U=A.style!==e?A.style:"normal";ki.size=R,ki.divisions=Y,ki.face=D,ki.weight=G,ki.style=U,ki.spacing=N;for(var Q=ki.drawText(V),l=Q.paths,z=[],X=0,p=l.length;p>X;X++)Array.prototype.push.apply(z,l[X].toShapes());return z},function(y){var _=1e-10,H=function(l,f){var e=l.length;if(3>e)return null;var M,r,Y,C=[],z=[],d=[];if(P(l)>0)for(r=0;e>r;r++)z[r]=r;else for(r=0;e>r;r++)z[r]=e-1-r;var G=e,k=2*G;for(r=G-1;G>2;){if(k--<=0)return f?d:C;if(M=r,M>=G&&(M=0),r=M+1,r>=G&&(r=0),Y=r+1,Y>=G&&(Y=0),g(l,M,r,Y,G,z)){var i,c,H,s,U;for(i=z[M],c=z[r],H=z[Y],C.push([l[i],l[c],l[H]]),d.push([z[M],z[r],z[Y]]),s=r,U=r+1;G>U;s++,U++)z[s]=z[U];G--,k=2*G}}return f?d:C},P=function(A){for(var r=A.length,w=0,f=r-1,D=0;r>D;f=D++)w+=A[f].x*A[D].y-A[D].x*A[f].y;return.5*w},g=function(d,e,u,h,S,H){var r,a,K,Z,T,F,t,m,c;if(a=d[H[e]].x,K=d[H[e]].y,Z=d[H[u]].x,T=d[H[u]].y,F=d[H[h]].x,t=d[H[h]].y,_>(Z-a)*(t-K)-(T-K)*(F-a))return!1;var W,D,i,N,g,G,L,A,B,n,R,j,y,l,U;for(W=F-Z,D=t-T,i=a-F,N=K-t,g=Z-a,G=T-K,r=0;S>r;r++)if(m=d[H[r]].x,c=d[H[r]].y,!(m===a&&c===K||m===Z&&c===T||m===F&&c===t)&&(L=m-a,A=c-K,B=m-Z,n=c-T,R=m-F,j=c-t,U=W*n-D*B,y=g*A-G*L,l=i*j-N*R,U>=-_&&l>=-_&&y>=-_))return!1;return!0};return y.Triangulate=H,y.Triangulate.area=P,y}(ki),_._typeface_js={faces:ki.faces,loadFace:ki.loadFace};var ol=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},he=ol.prototype={constructor:ol,computeFaceNormals:function(){for(var y=new Op,w=new Op,l=0,V=this.faces.length;V>l;l++){var R=this.faces[l],Y=this.vertices[R.a],S=this.vertices[R.b],J=this.vertices[R.c];y.subVectors(J,S),w.subVectors(Y,S),y.cross(w),y.normalize(),R.normal.copy(y)}},computeVertexNormals:function(x){var u,F,m,i,I,C;for(C=new Array(this.vertices.length),u=0,F=this.vertices.length;F>u;u++)C[u]=new Op;if(x){var z,n,e,B=new Op,W=new Op;for(m=0,i=this.faces.length;i>m;m++)I=this.faces[m],z=this.vertices[I.a],n=this.vertices[I.b],e=this.vertices[I.c],B.subVectors(e,n),W.subVectors(z,n),B.cross(W),C[I.a].add(B),C[I.b].add(B),C[I.c].add(B)}else for(m=0,i=this.faces.length;i>m;m++)I=this.faces[m],C[I.a].add(I.normal),C[I.b].add(I.normal),C[I.c].add(I.normal);for(u=0,F=this.vertices.length;F>u;u++)C[u].normalize();for(m=0,i=this.faces.length;i>m;m++)I=this.faces[m],I.vertexNormals[0]=C[I.a].clone(),I.vertexNormals[1]=C[I.b].clone(),I.vertexNormals[2]=C[I.c].clone()},mergeVertices:function(){var M,z,m,B,k,r,o,Y,C={},P=[],y=[],T=4,c=F(10,T);for(m=0,B=this.vertices.length;B>m;m++)M=this.vertices[m],z=W(M.x*c)+"_"+W(M.y*c)+"_"+W(M.z*c),C[z]===e?(C[z]=m,P.push(this.vertices[m]),y[m]=P.length-1):y[m]=y[C[z]];var J=[];for(m=0,B=this.faces.length;B>m;m++){k=this.faces[m],k.a=y[k.a],k.b=y[k.b],k.c=y[k.c],r=[k.a,k.b,k.c];for(var s=0;3>s;s++)if(r[s]==r[(s+1)%3]){J.push(m);break}}for(m=J.length-1;m>=0;m--){var p=J[m];for(this.faces.splice(p,1),o=0,Y=this.faceVertexUvs.length;Y>o;o++)this.faceVertexUvs[o].splice(p,1)}var R=this.vertices.length-P.length;return this.vertices=P,R}},zj=function(m,B,i,N,C,x,q){this.aX=m,this.aY=B,this.xRadius=i,this.yRadius=N,this.aStartAngle=C,this.aEndAngle=x,this.aClockwise=q};zj.prototype=le(Kl),zj.prototype.getPoint=function(F){var g,X=this.aEndAngle-this.aStartAngle;0>X&&(X+=U),X>U&&(X-=U),g=this.aClockwise===!0?this.aEndAngle+(1-F)*(U-X):this.aStartAngle+F*X;var w=this.aX+this.xRadius*E(g),S=this.aY+this.yRadius*j(g);return new Ln(w,S)};var Be=function(d,s){this.v1=d,this.v2=s},co=Be.prototype=le(Kl);co.getPoint=function(x){var V=this.v2.clone().sub(this.v1);return V.multiplyScalar(x).add(this.v1),V},co.getPointAt=function(K){return this.getPoint(K)},co.getTangent=function(){var H=this.v2.clone().sub(this.v1);return H.normalize()};var yo=function($,Z,l){this.v0=$,this.v1=Z,this.v2=l};yo.prototype=le(Kl),yo.prototype.getPoint=function(h){var p,m;return p=pc.b2(h,this.v0.x,this.v1.x,this.v2.x),m=pc.b2(h,this.v0.y,this.v1.y,this.v2.y),new Ln(p,m)};var Jd=function(m,N,s,b){this.v0=m,this.v1=N,this.v2=s,this.v3=b};Jd.prototype=le(Kl),Jd.prototype.getPoint=function(R){var X,j;return X=pc.b3(R,this.v0.x,this.v1.x,this.v2.x,this.v3.x),j=pc.b3(R,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ln(X,j)},th.create(function(r,L){this.v1=r,this.v2=L},function(S){var E=new Op;return E.subVectors(this.v2,this.v1),E.multiplyScalar(S),E.add(this.v1),E});var fm=th.create(function(H,F,T){this.v0=H,this.v1=F,this.v2=T},function(g){var f,B,l;return f=pc.b2(g,this.v0.x,this.v1.x,this.v2.x),B=pc.b2(g,this.v0.y,this.v1.y,this.v2.y),l=pc.b2(g,this.v0.z,this.v1.z,this.v2.z),new Op(f,B,l)}),Yk=th.create(function(H,n,h,w){this.v0=H,this.v1=n,this.v2=h,this.v3=w},function(l){var g,k,K;return g=pc.b3(l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),k=pc.b3(l,this.v0.y,this.v1.y,this.v2.y,this.v3.y),K=pc.b3(l,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Op(g,k,K)}),Qm=function(f,K,q,L,g,B,c,l){ol.call(this),L=L!==e?L:.5,g=g!==e?g:.5,l=l!==e?l:1,f=f||8,B=B||0,c=c||U;var d,a,t=1,z=l/2,x=[],M=[],n=this.vertices,A=this.faces,J=this.faceVertexUvs;for(a=0;t>=a;a++){var F=[],v=[],p=a/t,k=p*(g-L)+L;for(d=0;f>=d;d++){var S=d/f,Z=new Op,R=-(S*c+B);Z.z=k*j(R),Z.y=-p*l+z,Z.x=k*E(R),n.push(Z),F.push(n.length-1),v.push(new Ln(S,p))}x.push(F),M.push(v)}var H,X,I=(g-L)/l;for(d=0;f>d;d++)for(0!==L?(H=n[x[0][d]].clone(),X=n[x[0][d+1]].clone()):(H=n[x[1][d]].clone(),X=n[x[1][d+1]].clone()),H.setY(D(H.x*H.x+H.z*H.z)*I).normalize(),X.setY(D(X.x*X.x+X.z*X.z)*I).normalize(),a=0;t>a;a++){var y=x[a][d],w=x[a+1][d],i=x[a+1][d+1],W=x[a][d+1],C=H.clone(),P=H.clone(),h=X.clone(),Q=X.clone(),N=M[a][d].clone(),T=M[a+1][d].clone(),r=M[a+1][d+1].clone(),m=M[a][d+1].clone();A.push(new hm(y,w,W,[C,P,Q])),J[0].push([N,T,m]),A.push(new hm(w,i,W,[P.clone(),h,Q.clone()])),J[0].push([T.clone(),r,m.clone()])}if(K&&L>0)for(this.vertices.push(new Op(0,z,0)),d=0;f>d;d++){var y=x[0][d],w=x[0][d+1],i=this.vertices.length-1,C=new Op(0,1,0),P=new Op(0,1,0),h=new Op(0,1,0),N=M[0][d].clone(),T=M[0][d+1].clone(),r=new Ln(T.x,0);A.push(new hm(y,w,i,[C,P,h],null,1));var O=d/f*U,o=E(O),G=j(O),Y=(d+1)/f*U,V=E(Y),b=j(Y);J[0].push([new Ln(.5+.5*o,.5+.5*G),new Ln(.5+.5*V,.5+.5*b),new Ln(.5,.5)])}if(q&&g>0)for(this.vertices.push(new Op(0,-z,0)),d=0;f>d;d++){var y=x[a][d+1],w=x[a][d],i=n.length-1,C=new Op(0,-1,0),P=new Op(0,-1,0),h=new Op(0,-1,0),N=M[a][d+1].clone(),T=M[a][d].clone();A.push(new hm(y,w,i,[C,P,h],null,2));var O=d/f*U,o=E(O),G=j(O),Y=(d+1)/f*U,V=E(Y),b=j(Y);J[0].push([new Ln(.5+.5*V,.5-.5*b),new Ln(.5+.5*o,.5-.5*G),new Ln(.5,.5)])}};Qm.prototype=le(he);var gj=function(g,K,N,s,Z,a,u){ol.call(this),u=u||.5,g=g||16,K=K||16,N=(N!==e?N:0)-O,s=s!==e?s:U,Z=Z!==e?Z:0,a=a!==e?a:O;var $,M,n=[],k=[],Y=this.vertices,w=this.faces,J=this.faceVertexUvs;for(M=0;K>=M;M++){var l=[],L=[];for($=0;g>=$;$++){var d=$/g,x=M/K,q=new Op;q.x=-u*E(N+d*s)*j(Z+x*a),q.y=u*E(Z+x*a),q.z=u*j(N+d*s)*j(Z+x*a),Y.push(q),l.push(Y.length-1),L.push(new Ln(d,x))}n.push(l),k.push(L)}for(M=0;K>M;M++)for($=0;g>$;$++){var P=n[M][$+1],y=n[M][$],t=n[M+1][$],h=n[M+1][$+1],A=Y[P].clone().normalize(),m=Y[y].clone().normalize(),R=Y[t].clone().normalize(),I=Y[h].clone().normalize(),Q=k[M][$+1].clone(),F=k[M][$].clone(),r=k[M+1][$].clone(),v=k[M+1][$+1].clone();T(Y[P].y)===u?(Q.x=(Q.x+F.x)/2,w.push(new hm(P,t,h,[A,R,I])),J[0].push([Q,r,v])):T(Y[t].y)===u?(r.x=(r.x+v.x)/2,w.push(new hm(P,y,t,[A,m,R])),J[0].push([Q,F,r])):(w.push(new hm(P,y,h,[A,m,I])),J[0].push([Q,F,v]),w.push(new hm(y,t,h,[m.clone(),R,I.clone()])),J[0].push([F.clone(),r,v.clone()]))}};gj.prototype=le(he);var lg=function(t,v,u,s,p,T){ol.call(this),t=t||.33,v=v||.17,s=s||8,u=u||6,p=p||0,T=T||U;for(var S=new Op,Z=[],J=[],I=0;s>=I;I++)for(var z=I/s*U+O,m=0;u>=m;m++){var d=m/u*T+p;S.x=t*E(d),S.z=-t*j(d);var r=new Op,x=t+v*E(z);r.x=x*E(d),r.z=-x*j(d),r.y=v*j(z),this.vertices.push(r),Z.push(new Ln(m/u,1-I/s)),J.push(r.clone().sub(S).normalize())}for(var I=1;s>=I;I++)for(var m=1;u>=m;m++){var g=(u+1)*I+m-1,y=(u+1)*(I-1)+m-1,c=(u+1)*(I-1)+m,l=(u+1)*I+m,Y=new hm(g,y,l,[J[g].clone(),J[y].clone(),J[l].clone()]);this.faces.push(Y),this.faceVertexUvs[0].push([Z[g].clone(),Z[y].clone(),Z[l].clone()]),Y=new hm(y,c,l,[J[y].clone(),J[c].clone(),J[l].clone()]),this.faces.push(Y),this.faceVertexUvs[0].push([Z[y].clone(),Z[c].clone(),Z[l].clone()])}this.computeFaceNormals()};lg.prototype=le(he);var ul=function(G,q,U){return G?(ol.call(this),G=G instanceof Array?G:[G],this.addShapeList(G,q),q.convertYZ!==!1&&rl(this,U),this.computeFaceNormals(),void 0):(G=[],void 0)},ec=ul.prototype=le(ol.prototype);ec.addShapeList=function(w,W){for(var e=w.length,s=0;e>s;s++){var z=w[s];this.addShape(z,W)}},ec.addShape=function(R,J){function H(){if(J.bottom)for(var H=0;k>H;H++)Y=n[H],u(Y[2],Y[1],Y[0],!0);if(J.top)for(H=0;k>H;H++)Y=n[H],u(Y[0]+m*F,Y[1]+m*F,Y[2]+m*F,!1)}function U(){var V=0;for(E(P,V),V+=P.length,B=0,O=j.length;O>B;B++)f=j[B],E(f,V),V+=f.length}function E(c,s){for(var A,V,r=c.length;--r>=0;){A=r,V=r-1,0>V&&(V=c.length-1);var Y=0,K=F;for(Y=0;K>Y;Y++){var Z=m*Y,O=m*(Y+1),C=s+A+Z,t=s+V+Z,u=s+V+O,q=s+A+O;S(C,t,u,q,c,Y,K,A,V)}}}function X(L,_,a){T.vertices.push(new Op(L,_,a))}function u(O,C,i,n){O+=_,C+=_,i+=_,T.faces.push(new hm(O,C,i,null,null,n?2:1));var E=n?y.generateBottomUV(T,R,J,O,C,i):y.generateTopUV(T,R,J,O,C,i);T.faceVertexUvs[0].push(E)}function S(p,c,b,k,F,Y,i,W,L){p+=_,c+=_,b+=_,k+=_,T.faces.push(new hm(p,c,k)),T.faces.push(new hm(c,b,k));var U=y.generateSideWallUV(T,R,F,J,p,c,b,k,Y,i,W,L);T.faceVertexUvs[0].push([U[0],U[1],U[3]]),T.faceVertexUvs[0].push([U[1],U[2],U[3]])}var I,h,W,t,p,w=J.amount,a=J.curveSegments||Yh,F=J.steps||1,d=J.extrudePath,x=!1,y=new $m(J.repeatUVLength);d&&(I=d.getSpacedPoints(F),x=!0,h=J.frames!==e?J.frames:new Zk.FrenetFrames(d,F,!1),W=new Op,t=new Op,p=new Op);var f,B,O,T=this,_=this.vertices.length,V=R.extractPoints(a),D=V.shape,j=V.holes,z=!pc.isClockWise(D);if(z){for(D=D.reverse(),B=0,O=j.length;O>B;B++)f=j[B],pc.isClockWise(f)&&(j[B]=f.reverse());z=!1}var n=pc.triangulateShape(D,j),P=D;for(B=0,O=j.length;O>B;B++)f=j[B],D=D.concat(f);for(var q,Y,m=D.length,k=n.length,M=0;m>M;M++)q=D[M],x?(t.copy(h.normals[0]).multiplyScalar(q.x),W.copy(h.binormals[0]).multiplyScalar(q.y),p.copy(I[0]).add(t).add(W),X(p.x,p.y,p.z)):X(q.x,q.y,0);var Z;for(Z=1;F>=Z;Z++)for(M=0;m>M;M++)q=D[M],x?(t.copy(h.normals[Z]).multiplyScalar(q.x),W.copy(h.binormals[Z]).multiplyScalar(q.y),p.copy(I[Z]).add(t).add(W),X(p.x,p.y,p.z)):X(q.x,q.y,w/F*Z);H(),U()};var Zk=function(o,N,Q,d,y){function r(C,X,V){return g.vertices.push(new Op(C,X,V))-1}ol.call(this),N=N||64,Q=Q||1,d=d||8,y=y||!1;var k,P,m,q,S,e,G,i,O,I,h,w,p,J,K,M,Y,C,A,s,H=[],g=this,z=N+1,Z=new Op,T=new Zk.FrenetFrames(o,N,y),f=T.tangents,W=T.normals,D=T.binormals;for(this.tangents=f,this.normals=W,this.binormals=D,O=0;z>O;O++)for(H[O]=[],q=O/(z-1),i=o.getPointAt(q),k=f[O],P=W[O],m=D[O],I=0;d>I;I++)S=I/d*U,e=-Q*E(S),G=Q*j(S),Z.copy(i),Z.x+=e*P.x+G*m.x,Z.y+=e*P.y+G*m.y,Z.z+=e*P.z+G*m.z,H[O][I]=r(Z.x,Z.y,Z.z);for(O=0;N>O;O++)for(I=0;d>I;I++)h=y?(O+1)%N:O+1,w=(I+1)%d,p=H[O][I],J=H[h][I],K=H[h][w],M=H[O][w],Y=new Ln(O/N,I/d),C=new Ln((O+1)/N,I/d),A=new Ln((O+1)/N,(I+1)/d),s=new Ln(O/N,(I+1)/d),this.faces.push(new hm(p,J,M)),this.faceVertexUvs[0].push([Y,C,s]),this.faces.push(new hm(J,K,M)),this.faceVertexUvs[0].push([C.clone(),A,s.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Zk.prototype=le(he),Zk.FrenetFrames=function(u,s,X){function i(){p[0]=new Op,q[0]=new Op,n=Number.MAX_VALUE,l=T(d[0].x),A=T(d[0].y),c=T(d[0].z),n>=l&&(n=l,x.set(1,0,0)),n>=A&&(n=A,x.set(0,1,0)),n>=c&&x.set(0,0,1),J.crossVectors(d[0],x).normalize(),p[0].crossVectors(d[0],J),q[0].crossVectors(d[0],p[0])}var C,n,l,A,c,V,e,x=new Op,d=[],p=[],q=[],J=new Op,W=new Mo,b=s+1,F=1e-4;for(this.tangents=d,this.normals=p,this.binormals=q,V=0;b>V;V++)e=V/(b-1),d[V]=u.getTangentAt(e),d[V].normalize();for(i(),V=1;b>V;V++)p[V]=p[V-1].clone(),q[V]=q[V-1].clone(),J.crossVectors(d[V-1],d[V]),J.length()>F&&(J.normalize(),C=M(ii(d[V-1].dot(d[V]),-1,1)),p[V].applyMatrix4(W.makeRotationAxis(J,C))),q[V].crossVectors(d[V],p[V]);if(X)for(C=M(ii(p[0].dot(p[b-1]),-1,1)),C/=b-1,d[0].dot(J.crossVectors(p[0],p[b-1]))>0&&(C=-C),V=1;b>V;V++)p[V].applyMatrix4(W.makeRotationAxis(d[V],C*V)),q[V].crossVectors(d[V],p[V])};var Bd=function(P,b,p,B){ol.call(this),b=b||18,p=p||0,B=B==A?U:B;for(var o=1/(P.length-1),F=1/b,e=0,q=b;q>=e;e++)for(var R=p+e*F*B,v=E(R),Z=j(R),X=0,h=P.length;h>X;X++){var V=P[X],m=new Op;m.x=v*V.x-Z*V.y,m.y=Z*V.x+v*V.y,m.z=V.z,this.vertices.push(m)}for(var C=P.length,e=0,q=b;q>e;e++)for(var X=0,h=P.length-1;h>X;X++){var u=X+C*e,H=u,c=u+C,v=u+1+C,L=u+1,a=e*F,S=X*o,Y=a+F,i=S+o;this.faces.push(new hm(H,L,c)),this.faceVertexUvs[0].push([new Ln(a,S),new Ln(a,i),new Ln(Y,S)]),this.faces.push(new hm(c,L,v)),this.faceVertexUvs[0].push([new Ln(Y,S),new Ln(a,i),new Ln(Y,i)])}this.mergeVertices(),rl(this),this.computeFaceNormals(),this.computeVertexNormals()};Bd.prototype=le(he);var ml=function(J,T){T=T||{};var _=ki.generateShapes(J,T);T.amount=T.amount!==e?T.amount:.5,T.convertYZ=!1,T.fill!==!1&&(T.bottom=!0,T.top=!0),ul.call(this,_,T)};ml.prototype=le(ec);var Ei=P.Node=function(){yf(Ei,this)},ae={X:ed,Y:Gr,Z:lq},Og={X:0,Y:1,Z:2},dn={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},bg="xzy",No=function(Z,q,h){if(q){var l=q[0],H=q[1],S=q[2];"xzy"===h?(Gr(Z,H),lq(Z,S),ed(Z,l)):"xyz"===h?(lq(Z,S),Gr(Z,H),ed(Z,l)):"yxz"===h?(lq(Z,S),ed(Z,l),Gr(Z,H)):"yzx"===h?(ed(Z,l),lq(Z,S),Gr(Z,H)):"zxy"===h?(Gr(Z,H),ed(Z,l),lq(Z,S)):"zyx"===h?(ed(Z,l),Gr(Z,H),lq(Z,S)):(Gr(Z,H),lq(Z,S),ed(Z,l))}};hh("Node",ej,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:bg,_64O:0,_rotationX:0,_53O:0,_host:A,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return op},_22Q:function(){return Fr},getX:function(){return this.p().x},setX:function(q){this.p(q,this.p().y)},getY:function(){return this.p().y},setY:function(Y){this.p(this.p().x,Y)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(U){this.setAnchor(U,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(d){this.setAnchor(this.getAnchor().x,d)},getScaleX:function(){return this.getScale().x},setScaleX:function(F){this.setScale(F,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(I){this.setScale(this.getScale().x,I)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(y,f){rm(y,mq(A,A,this.r3(),this.getRotationMode())),this.translate3d(y[0]*f,y[1]*f,y[2]*f)},translateFront:function(Q){this.translate3dBy([0,0,1],Q)},translateBack:function(q){this.translate3dBy([0,0,-1],q)},translateLeft:function(t){this.translate3dBy([-1,0,0],t)},translateRight:function(L){this.translate3dBy([1,0,0],L)},translateTop:function(R){this.translate3dBy([0,1,0],R)},translateBottom:function(s){this.translate3dBy([0,-1,0],s)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(S,r,w){1===arguments.length&&(r=S[1],w=S[2],S=S[0]),this.p(S,w),this.setElevation(r)},translate3d:function(E,N,q){1===arguments.length&&(N=E[1],q=E[2],E=E[0]),this.translate(E,q),this.setElevation(this._54O+N)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(R,P,E){1===arguments.length&&(P=R[1],E=R[2],R=R[0]),this.setSize(R,E),this.setTall(P)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(n,M,T){1===arguments.length&&(M=n[1],T=n[2],n=n[0]),this.setRotationX(n),this.setRotation(-M),this.setRotationZ(T)},setRotationY:function(R){this.setRotation(-R)},getRotationY:function(){return-this._64O},lookAtDirection:function(h,I){I=I||Kg;var z=this,r=np(h);I===Kg?(z.r3([-S(h[1]/r),-o(h[2],h[0])+Z,0]),z.setRotationMode("xzy")):I===Pc?(z.r3(0,-o(h[2],h[0]),S(h[1]/r)),z.setRotationMode("zyx")):I===Rc?(z.r3(0,-o(h[2],h[0])+O,-S(h[1]/r)),z.setRotationMode("zyx")):I===Oe?(z.r3([-S(h[1]/r)+Z,-o(h[2],h[0])+Z,0]),z.setRotationMode("xzy")):I===fl&&(z.r3([-S(h[1]/r)-Z,-o(h[2],h[0])+Z,0]),z.setRotationMode("xzy")),I===gl&&(z.r3([-S(h[1]/r)+O,-o(h[2],h[0])+Z,O]),z.setRotationMode("zxy"))},lookAt:function(S,e){return this.lookAtDirection(Nm(S,this.p3()),e)},lookAtX:function(){var r=new ps,J=new ps,I=new ps,c=new Xd,S=new Xd,v=new ai;return function(O,t){var N=ro(this);if(c.fromArray(N),I.copy(this.p3()),r.copy(O).sub(I),!(r.lengthSq()<1e-6)){r.normalize(),t===Kg?J.set(0,0,1):t===gl?J.set(0,0,-1):t===Rc?J.set(-1,0,0):t===Pc?J.set(1,0,0):t===Oe?J.set(0,1,0):t===fl&&J.set(0,-1,0),J.applyMatrix4(c).sub(I).normalize();var g=Math.acos(r.dot(J));if(g){var p=r.clone().cross(J);p.lengthSq()<1e-6&&(t===Oe||t===fl?p.set(0,0,1).applyMatrix4(c).sub(I):p.set(0,1,0).applyMatrix4(c).sub(I)),p.normalize(),v.set(this.r3(),this.getRotationMode(),!0),c.makeRotationFromEuler(v),S.makeRotationAxis(p,-g),v.setFromRotationMatrix(S.multiply(c)),this.r3([v.x,v.y,v.z])}}}}(),getHost:function(){return this._host},setHost:function(D){var z=this;if(z!==D&&z._host!==D){var E=z._host;E&&E._removeAttach(z),z._host=D,z._host&&z._host._addAttach(z),z.fp("host",E,D),z.onHostChanged(E,D)}},getAttaches:function(){return this._69O},_addAttach:function(b){var K=this;K._69O||(K._69O=new Tr),K._69O.add(b),K.fp("attaches",A,b)},_removeAttach:function(t){var Q=this;Q._69O.remove(t),Q._69O.isEmpty()&&delete Q._69O,Q.fp("attaches",t,A)},getImage:function(){if(this._pendingCheckImageJSON){var u=b.getImage(this._image);u&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Ro&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(F){var n=this,c=n._image,j=n.getWidth(),B=n.getHeight();n._image=F,n.fp("image",c,F)&&(null!=F&&(Tp(F)||nf(F)&&/\.json$/i.test(F))&&(this._pendingCheckImageJSON=!0),n.fp(Cq,j,n.getWidth()),n.fp(ll,B,n.getHeight()))},getElevation:function(){return this._54O},setElevation:function(L){var $=this;if(!$._50O){$._50O=1;var v=$._54O;$._54O=L,$.fp(er,v,L),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(y){var e=this;if(!e._49O){e._49O=1;var N=e._64O;e._64O=y,e.fp(oq,N,y),delete e._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(C){var J=this;if(!J._51O){J._51O=1;var B=J._rotationX;J._rotationX=C,J.fp("rotationX",B,C),delete J._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(H){var N=this;if(!N._52O){N._52O=1;var r=N._53O;N._53O=H,N.fp("rotationZ",r,H),delete N._52O}},getPosition:function(){return this._position},setPosition:function(W,K){var Z=this;if(!Z._50I){Z._50I=1;var c;if(c=2===arguments.length?{x:W,y:K}:W,c.x!==Z._position.x||c.y!==Z._position.y){var L=Z._position;Z._position=c,Z.fp(yk,L,c)}delete Z._50I}},translate:function(f,j){var A=this._position;this.p(A.x+f,A.y+j)},getWidth:function(){var D=this;if(D._width>=0)return D._width;var g=D.getStyle("shape3d");if(g){var V=ns(g);if(V&&V.rawS3)return V.rawS3[0];if("billboard"===g||"plane"===g){var e=Ef(D.getStyle("shape3d.image"));return e?pl(e,D):20}}var e=Ef(D._image);return e?pl(e,D):20},setWidth:function(p){var D=this,k=D._width;D._width=p,D.fp(Cq,k,p)},getHeight:function(){var X=this;if(X._height>=0)return X._height;var G=X.getStyle("shape3d");if(G){var i=ns(G);if(i&&i.rawS3)return i.rawS3[2];if("plane"===G){var e=Ef(X.getStyle("shape3d.image"));return e?Vf(e,X):20}if("billboard"===G)return 2}var e=Ef(X._image);return e?Vf(e,X):20},setHeight:function(M){var Z=this,n=Z._height;Z._height=M,Z.fp(ll,n,M)},getTall:function(){var x=this;if(x._tall>=0)return x._tall;var t=x.getStyle("shape3d");if(t){var G=ns(t);if(G&&G.rawS3)return G.rawS3[1];if("billboard"===t){var y=Ef(x.getStyle("shape3d.image"));return y?Vf(y,x):20}if("plane"===t)return 2}return 20},setTall:function(g){var $=this,K=$._tall;$._tall=g,$.fp("tall",K,g)},setSize:function(g,i){var t=this;2===arguments.length?(t.setWidth(g),t.setHeight(i)):(t.setWidth(g.width),t.setHeight(g.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(o,B,f,n,g){var d=this,l=d.getAnchor(),m=d.getScale();arguments.length<=2&&(g=B,B=o.y,f=o.width,n=o.height,o=o.x);var R=g&&m.x<0?1-l.x:l.x,I=g&&m.y<0?1-l.y:l.y;d.p(o+f*R,B+n*I),g&&(f/=Math.abs(m.x),n/=Math.abs(m.y)),d.setWidth(f),d.setHeight(n)},getMatrix:function(){var b=this,C=b._64O,W=b._position,H=b.getScale();return new md(C,W.x,W.y,H.x,H.y)},getAnchorRect:function(){var S=this,J=S.getWidth(),A=S.getHeight(),Q=S.getAnchor();return{x:-J*Q.x,y:-A*Q.y,width:J,height:A}},toLocal:function(n){return this.getMatrix().tfi(n)},toGlobal:function(N){return this.getMatrix().tf(N)},getAttachPosition:function(){var p=new md;return function(E,H,b,h){b=b||0,h=h||0;var N=this,Z=N.getAnchor(),X=N._64O,s=N._position,Q=N.getScale();return p.setFromTransform(X,s.x,s.y).tf({x:b+Q.x*N.getWidth()*(E-Z.x),y:h+Q.y*N.getHeight()*(H-Z.y)})}}(),isInRect:function(F){F=this.toLocal(F);var m=this.getWidth(),g=this.getHeight();return F.x+=m*this.getAnchorX(),F.y+=g*this.getAnchorY(),!(F.x<0||F.y<0||F.x>m||F.y>g)},getRect:function(){var K=this,b=K.getWidth(),r=K.getHeight(),P=K.getAnchor(),H={x:-b*P.x,y:-r*P.y,width:b,height:r},S=K.getMatrix();return H=mo([S.tf(H.x,H.y),S.tf(H.x+H.width,H.y),S.tf(H.x+H.width,H.y+H.height),S.tf(H.x,H.y+H.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var x=this,k=x.getAnchor(),V=x._anchorElevation;return{x:k.x,y:V,z:k.y}},setAnchorElevation:function(A){var K=this,C=K._anchorElevation;return C!==A?(K._anchorElevation=A,K.fp("anchorElevation",C,A),!0):!1},setAnchor3d:function(g,o,S,k){var r,d=this;"number"==typeof g?r={x:g,y:o,z:S}:(r=g.length?{x:g[0],y:g[1],z:g[2]}:g,k=o);var e=d.getDataModel();e&&e.beginTransaction();var V=d.getAnchor3d(),l=d.setAnchor(r.x,r.z);if(d.setAnchorElevation(r.y)&&(l=!0),l&&k&&!fq){d.getAnchor3d();var v=ro(d),t=rm([r.x-V.x,r.y-V.y,r.z-V.z],v);d.p3(t)}return e&&e.endTransaction(),l},getAnchor:function(){var x=this;if(x.hasOwnProperty("_anchor"))return x._anchor;var X=Ef(x._image);return X&&X.anchorX!==e?{x:X.anchorX,y:X.anchorY}:x._anchor},setAnchor:function(P,T,z){var L,X=this;"number"==typeof P?L={x:P,y:T}:(L=P.length?{x:P[0],y:P[1]}:P,z=T);var G=X.getAnchor();if(G.x!==L.x||G.y!==L.y){var J=X.getDataModel();if(J&&J.beginTransaction(),X._anchor=L,X.fp("anchor",G,L),z&&!fq){var r=X.getPosition(),k=X.getSize(),c=X.getRotation(),W=X.getScale(),u=-k.width*(G.x-L.x)*W.x,b=-k.height*(G.y-L.y)*W.y,m=j(c),v=E(c);X.setPosition(r.x+v*u-m*b,r.y+m*u+v*b)}return J&&J.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(w,j){var v,K=this;v=2===arguments.length?{x:w,y:j}:w;var y=K.getScale();(y.x!==v.x||y.y!==v.y)&&(K._scale=v,K.fp("scale",y,v))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var u=this,x=u._scaleTall,a=u.getScale();return[a.x,x,a.y]},getFinalScale3d:function(){var t=this,G=t.s3(),R=t._dynamicScale3d,Z=t.getScale3d();return G&&(Z[0]*=G[0],Z[1]*=G[1],Z[2]*=G[2]),R&&(Z[0]*=R[0],Z[1]*=R[1],Z[2]*=R[2]),Z},getFinalRotation3d:function(){var L=this;return L._dynamicRotation||L.r3()},setScaleTall:function(w){var d=this,J=d._scaleTall;J!==w&&(d._scaleTall=w,d.fp("scaleTall",J,w))},setScale3d:function(c,h,p){var b,j=this;b="number"==typeof c?{x:c,y:h,z:p}:c.length?{x:c[0],y:c[1],z:c[2]}:c,j.setScaleTall(b.y),j.setScale(b.x,b.z)},getCorners:function(h,S){h==A&&(h=0),S==A&&(S=h);var l=this,j=l.getAnchor(),O=l.getWidth(),X=l.getHeight(),Q=-O*j.x-h,r=-X*j.y-S,G=O+2*h,f=X+2*S,t=l.getMatrix();return[t.tf(Q,r),t.tf(Q,r+f),t.tf(Q+G,r+f),t.tf(Q+G,r)]},getEditControlPoints:function(L,j,b){j==A&&(j=0),b==A&&(b=j);var q=this,u=q.getAnchor(),$=q.getWidth(),V=q.getHeight(),T=-$*u.x-j,F=-V*u.y-b,N=$+2*j,g=V+2*b;if(L)return[{x:T,y:F},{x:T,y:0},{x:T,y:F+g},{x:0,y:F+g},{x:T+N,y:F+g},{x:T+N,y:0},{x:T+N,y:F},{x:0,y:F}];var s=q.getMatrix();return[s.tf(T,F),s.tf(T,0),s.tf(T,F+g),s.tf(0,F+g),s.tf(T+N,F+g),s.tf(T+N,0),s.tf(T+N,F),s.tf(0,F)]},rotateAt:function(Q,m,K){var F=this,X=F._position,T=F._64O,O=new md(T,X.x,X.y).tf(Q,m),U=D(Q*Q+m*m),i=o(X.y-O.y,X.x-O.x)+K;F.setRotation(T+K),F.p(O.x+U*E(i),O.y+U*j(i))},onParentChanged:function(){Ei.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var T={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(Y){T[Y]=!0}),function(p){var g=this;Ei.superClass.onPropertyChanged.call(g,p),T[p.property]&&!g._layoutUpdating&&g.updateLayoutParameters(null,p.property),g._69O&&g._69O.each(function(Y){Y.handleHostPropertyChange(p)}),g._49I&&g._49I.each(function(H){H.fp("agentChange",!0,!1)}),"a:layout"===p.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(W){this.updateAttach(W)},onStyleChanged:function(T){Ei.superClass.onStyleChanged.apply(this,arguments),vj[T]&&this.updateAttach()},updateAttach:function(X){var U=this;return fq?(U.updateLayoutParameters(),void 0):(U._51I||(U._51I=1,U._71O(X),delete U._51I),void 0)},_71O:function(f){var y,$,T,q,z,d,K,J,h=this,r=h._host,v=f?f.property:A,V=f?f.oldValue:A,j=f?f.newValue:A;if(r instanceof Ei&&(K=Ef(r.getImage()),K&&K.layoutAttach&&(J=K.layoutAttach)),f&&!Gq[v]&&"a:layout"!==v.substring(0,8)||!J||J(r,this))if(r instanceof P.Grid){if(v===er)h.setElevation(h._54O+j-V);else if(!f||Iq[v]){if(y=h.s("attach.row.index"),$=h.s("attach.column.index"),T=r.getCellRect(y,$),!T)return;q=h.s("attach.row.span"),z=h.s("attach.column.span"),(1!==q||1!==z)&&(T=qh(T,r.getCellRect(y+q-1,$+z-1))),gr(T,h,"attach.padding",1),h.setRect(T)}}else if(r instanceof xn&&(d=h.s("attach.index"))>=0&&(!f||Xi[v])){var n=h.s("attach.thickness"),e=r.getScale(),u=Math.max(e.x,e.y);n>0&&h.setHeight(r.getThickness()*n*u);var B=h.s("attach.offset"),Y=r.getPoints(),G=Y.size();if(G>d){var k=r.getPointsMatrix2d(),t=Y.get(d),_=G===d+1?Y.get(0):Y.get(d+1);t=k.apply(t),_=k.apply(_);var I=[_.x-t.x,_.y-t.y],g=np(I);if(g){h.s("attach.offset.relative")&&(B*=g),h.s("attach.offset.opposite")&&(B=g-B);var Q={x:t.x+I[0]/g*B,y:t.y+I[1]/g*B},s=h.s("attach.gap");s&&(h.s("attach.gap.relative")&&(s*=r.getThickness()*u),Q=Or(A,Q,_,s)),h.p(Q),h.setRotation(o(I[1],I[0]))}}}else f&&(v===yk?h.translate(j.x-V.x,j.y-V.y):v===er?h.setElevation(h._54O+j-V):Lb[v]?h._11Q(r,v,j-V):("anchor"===v||"width"===v||"height"===v||"scale"===v)&&h.layout(r))},_11Q:function(){var E=new P.Math.Euler,g=P.Math.Euler.ReverseOrder,Q=new P.Math.Vector2,N=new P.Math.Vector2;return function(j,H,U){var T=this,k=j.p3(),L=j.r3(),A=T.p3(),m=T.r3();if(H===oq&&(H="rotationY",U=-U),(H===oq||"rotationY"===H)&&0===m[0]&&0===m[2]&&0===L[0]&&0===L[2]&&0===A[1]&&0===k[1])return T.setRotation(-m[1]-U),Q.set(A[0],A[2]).rotateAround(N.set(k[0],k[2]),-U),T.p(Q.x,Q.y),void 0;var h=dn[j.getRotationMode()],n=h[0],b=h[1],x=h[2],Z=ae[n],y=ae[b],D=ae[x],C=om();H===oq+n?(D(C,L[Og[x]]),y(C,L[Og[b]]),Z(C,U),y(C,-L[Og[b]]),D(C,-L[Og[x]])):H===oq+b?(D(C,L[Og[x]]),y(C,U),D(C,-L[Og[x]])):H===oq+x&&D(C,U);var V=Nm(A,k);rm(V,C),T.p3(k[0]+V[0],k[1]+V[1],k[2]+V[2]);var t=T.getRotationMode();No(C,T.r3(),t),E.setFromRotationMatrix(C,g(t)),T.r3([E.x,E.y,E.z])}}(),isHostOn:function(e){var z=this;if(z._host&&e&&e._69O)for(var J={},n=z._host;n&&n!==z&&!J[n._id];){if(n===e)return!0;J[n._id]=n,n=n._host}return!1},isLoopedHostOn:function(e){return this.isHostOn(e)&&e.isHostOn(this)},getScaledSize:function(){var G=this.getSize(),L=this.getScale();return G.width*=Math.abs(L.x),G.height*=Math.abs(L.y),G},layout:function(q){if(q=q||this.getHost()){var Q=this,X=Q.s("layout.h")||"center",L=Q.s("layout.v")||"center";if("center"!==X||"center"!==L){var E=new P.Math.Vector2,v=q.getPosition(),A=q.getAnchor(),c=q.getScaledSize();Q.getPosition();var G,O,S,n,s,h=1,w=1;switch(Q._layoutUpdating=!0,X){case"left":E.setX(Q._layoutHValue-A.x*c.width);break;case"right":E.setX((1-A.x)*c.width-Q._layoutHValue);break;case"leftright":G=c.width-Q._layoutHValue[2],S=Q.getRotation()-q.getRotation(),n=Math.abs(Math.sin(S)),s=Math.abs(Math.cos(S)),h+=s*G/Q._layoutHValue[3],w+=n*G/Q._layoutHValue[4],E.setX(Q._layoutHValue[1]+(Q._layoutHValue[5]-A.x)*c.width);break;case"center":E.setX((.5-A.x)*c.width-Q._layoutHValue);break;case"scale":S=Q.getRotation()-q.getRotation(),n=Math.abs(Math.sin(S)),s=Math.abs(Math.cos(S)),E.setX((.5-A.x)*c.width-Q._layoutHValue[1]*c.width/Q._layoutHValue[0]),O=c.width/Q._layoutHValue[2]-1,h+=s*O,w+=n*O}switch(L){case"top":E.setY(Q._layoutVValue-A.y*c.height);break;case"bottom":E.setY((1-A.y)*c.height-Q._layoutVValue);break;case"topbottom":S||(S=Q.getRotation()-q.getRotation(),n=Math.abs(Math.sin(S)),s=Math.abs(Math.cos(S))),G=c.height-Q._layoutVValue[2],h+=n*G/Q._layoutVValue[3],w+=s*G/Q._layoutVValue[4],E.setY(Q._layoutVValue[1]+(Q._layoutVValue[5]-A.y)*c.height);break;case"center":E.setY((.5-A.y)*c.height-Q._layoutVValue);break;case"scale":S||(S=Q.getRotation()-q.getRotation(),n=Math.abs(Math.sin(S)),s=Math.abs(Math.cos(S))),E.setY((.5-A.y)*c.height-Q._layoutVValue[1]*c.height/Q._layoutVValue[0]),O=c.height/Q._layoutVValue[2]-1,h+=n*O,w+=s*O}if("leftright"===X||"scale"===X||"topbottom"===L||"scale"===L){var k=this.getScale(),F=Math.abs(k.x),i=Math.abs(k.y);"leftright"===X||"scale"===X?Q.setSize(Q._layoutHValue[3]*h/F,Q._layoutHValue[4]*w/i):Q.setSize(Q._layoutVValue[3]*h/F,Q._layoutVValue[4]*w/i)}E.rotateAround(null,q.getRotation()),this.setPosition(E.x+v.x,E.y+v.y),Q._layoutUpdating=e}}},updateLayoutParameters:function(Z,Y){if(Z=Z||this.getHost()){var d=this,v=d.s("layout.h"),q=d.s("layout.v");if(v||q){var x,n,I,Q,e,S,h=new P.Math.Vector2,U=Z.getPosition(),o=Z.getAnchor(),T=Z.getScaledSize(),t=d.getPosition(),R=d.getScaledSize();switch(h.set(t.x-U.x,t.y-U.y),h.rotateAround(null,-Z.getRotation()),v){case"left":d._layoutHValue=h.x+o.x*T.width;break;case"right":d._layoutHValue=-h.x+(1-o.x)*T.width;break;case"center":d._layoutHValue=-h.x+(.5-o.x)*T.width;break;case"leftright":case"scale":"scale"===v?x=-h.x+(.5-o.x)*T.width:(n=d.getAnchor(),I=d.getRotation()-Z.getRotation(),Q=Math.cos(I),e=Math.sin(I),S=-Math.min(-n.x*Q+n.y*e,-n.x*Q-(1-n.y)*e,(1-n.x)*Q+n.y*e,(1-n.x)*Q-(1-n.y)*e),x=h.x-(S-o.x)*T.width),"position"===Y&&"object"==typeof d._layoutHValue?(d._layoutHValue[0]=T.width,d._layoutHValue[1]=x):d._layoutHValue=[T.width,x,T.width,R.width,R.height,S]}switch(q){case"top":d._layoutVValue=h.y+o.y*T.height;break;case"bottom":d._layoutVValue=-h.y+(1-o.y)*T.height;break;case"center":d._layoutVValue=-h.y+(.5-o.y)*T.height;
break;case"topbottom":case"scale":"scale"===q?x=-h.y+(.5-o.y)*T.height:(I||(n=d.getAnchor(),I=d.getRotation()-Z.getRotation(),Q=Math.cos(I),e=Math.sin(I)),S=-Math.min(-n.x*e-n.y*Q,-n.x*e+(1-n.y)*Q,(1-n.x)*e-n.y*Q,(1-n.x)*e+(1-n.y)*Q),x=h.y-(S-o.y)*T.height),"position"===Y&&"object"==typeof d._layoutVValue?(d._layoutVValue[0]=T.height,d._layoutVValue[1]=x):d._layoutVValue=[T.height,x,T.height,R.width,R.height,S]}}}},getSerializableProperties:function(){var O=Ei.superClass.getSerializableProperties.call(this);return Ec(O,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),O}});var Fb=P.Edge=function(w,Y){var K=this;yf(Fb,K),K.setSource(w),K.setTarget(Y)};hh("Edge",ej,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return wc},_22Q:function(){return bk},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(B){if(B===this)return!1;if($o(B))return!0;for(var M,Y,d,v,g,G=[this],c=-1,U=0;U>c;)if(c++,M=G[c],Y=M._44I)for(Y=Y.getArray(),v=0,g=Y.length;g>v;v++)if(d=Y[v],cn(d)&&!(G.indexOf(d)>=0)){if(d===B)return!1;G.push(d),U++}return!0},setSource:function(L){var i=this;if(i._source!==L&&i.canSetSourceTarget(L)){var l=i._source;i._source=L,l&&l._16I(i),L&&L._2I(i),i._7I(),i.fp("source",l,L)}},setTarget:function(t){var F=this;if(F._target!==t&&F.canSetSourceTarget(t)){var j=F._target;F._target=t,j&&j._18I(F),t&&t._4I(F),F._7I(),F.fp("target",j,t)}},isLooped:function(){var n=this;return n._source===n._target&&$o(n._source)&&$o(n._target)},onPropertyChanged:function(){var z=this;z._49I&&z._49I.each(function(O){O.fp("agentChange",!0,!1)})},_7I:function(){var N,X=this,t=Mb(X);X._40I!==t&&(N=this._40I,N&&N._15I(X),X._40I=t,t&&t._1I(X),X.fp("sourceAgent",N,t),Zp(N,X._41I),Zp(t,X._41I));var J=lk(X);X._41I!==J&&(N=X._41I,N&&N._17I(X),X._41I=J,J&&J._3I(X),X.fp("targetAgent",N,J),Zp(N,X._40I),Zp(J,X._40I))},_22I:function(N){this._52I=N,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var k=this;return k._52I&&k._52I.get(0)!==k&&!k.getStyle(Pi)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var e=this,C=e._52I;return C&&!e.getStyle(Pi)&&C.size()>1&&e===C.get(0)},toggle:function(){this.beginTransaction();var T=this._52I,k=!this.s(Pi);T&&T.size()>1&&(T.each(function(e){e.s(Pi,k)}),T.getSiblings().each(function(t){t!==T&&t.each(function(p){p.fp("edgeGroup",A,t)})})),this.endTransaction()},setStyle:function(t,i){(t===Ai||"edge.segments"===t)&&(i=kf(i)),Fb.superClass.setStyle.call(this,t,i)},onStyleChanged:function(a){Fb.superClass.onStyleChanged.apply(this,arguments),Bg[a]&&Zp(this._41I,this._40I)},getSerializableProperties:function(){var C=Fb.superClass.getSerializableProperties.call(this);return Ec(C,{source:1,target:1}),C}});var Cs=P.Group=function(){yf(Cs,this)};hh("Group",Ei,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Dq},onChildAdded:function(){Cs.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Cs.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var m=this;if(!m._54I&&!fq){var B=m.getChildrenRect();B&&(m._53I=1,m.p(Ne(m.s("group.position"),B,m.getSize())),delete m._53I)}},getChildrenRect:function(){var o,n=this;return n.eachChild(function(x){$o(x)&&(o=qh(o,n.getChildRect(x)))}),o},getChildRect:function(R){var B;return $o(R)&&R.s(Do)&&(gk(R)&&R.isExpanded()&&R.eachChild(function(u){B=qh(B,R.getChildRect(u))}),!B&&R.getRect&&(B=R.getRect())),B},setPosition:function(l,Z){var A=this;if(!A._54I){var _;_=2===arguments.length?{x:l,y:Z}:l,fq||A._53I||(A._54I=1,un(A._children,_.x-A._position.x,_.y-A._position.y),delete A._54I),Cs.superClass.setPosition.call(this,_)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(N){var V=this;if(V._57O!==N){var i=V._57O;V._57O=N,V.fp("expanded",i,V._57O),V._fireInvalidateDeep(),V._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(r){gk(r)?r._fireInvalidateDeep():r.iv()})},_8I:function(){Cs.superClass._8I.call(this),this.eachChild(function(i){$o(i)&&i._8I()})},onStyleChanged:function(Q){Cs.superClass.onStyleChanged.apply(this,arguments),"group.position"===Q&&this._81I()},getSerializableProperties:function(){var B=Cs.superClass.getSerializableProperties.call(this);return B.expanded=1,B}});var zm=P.Block=function(){yf(zm,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};hh("Block",Ei,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return sq},_22Q:function(){return Eo},onChildAdded:function(){zm.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){zm.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function Y(i,Y,K){Q.fromArray(ro(Y));var w=Y.getAnchor3d();i.push((new ps).set(0-w.x,0-w.y,0-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(0-w.x,0-w.y,1-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(0-w.x,1-w.y,0-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(0-w.x,1-w.y,1-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(1-w.x,0-w.y,0-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(1-w.x,0-w.y,1-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(1-w.x,1-w.y,0-w.z).applyMatrix4(Q).applyMatrix4(K)),i.push((new ps).set(1-w.x,1-w.y,1-w.z).applyMatrix4(Q).applyMatrix4(K))}function T(z,a){var q=this.p3(),p=this.r3(),S=om();ac(S,[-q[0],-q[1],-q[2]]),No(S,[-p[0],-p[1],-p[2]],this.getRotationMode()),S=(new Xd).fromArray(S),z.forEach(function(x){$o(x)&&Y(a,x,S)})}var Q=new Xd;return function(r,K){if(r instanceof P.Node&&(r=[r]),!r||0===r.length)return A;var K=[];T.call(this,r,K);var E=[1/0,1/0,1/0],I=[-1/0,-1/0,-1/0];return K.forEach(function(F){E[0]=Math.min(F.x,E[0]),E[1]=Math.min(F.y,E[1]),E[2]=Math.min(F.z,E[2]),I[0]=Math.max(F.x,I[0]),I[1]=Math.max(F.y,I[1]),I[2]=Math.max(F.z,I[2])}),{min:E,max:I}}}(),updateFromChildren:function(){var k=this;if(!fq&&!k._updatingToChildren&&k._syncSize&&0!==k.size()&&!k._freezeSyncFromChildren){var j=this._getBoundingBox(k.toChildren().toArray());if(j){k._updatingFromChildren=1;var V=j.min,c=j.max,C=c[0]-V[0],t=c[2]-V[2],A=c[1]-V[1],g=new ps(C,A,t),K=new ps(1,1,1).divide((new ps).fromArray(this.getScale3d())).multiply(g);this.s3(Math.abs(K.x),Math.abs(K.y),Math.abs(K.z));var L=this.p3(),a=this.r3(),Y=om();No(Y,a,this.getRotationMode()),ac(Y,L),Y=(new Xd).fromArray(Y);var $=this.getAnchor3d();return L=new ps($).multiply(g).add((new ps).fromArray(V)).applyMatrix4(Y),this.p3([L.x,L.y,L.z]),delete k._updatingFromChildren,void 0;var k}}},setPosition:function(G,P){var Q=this;if(!Q._updatingToChildren){var M;M=2===arguments.length?{x:G,y:P}:G,fq||Q._updatingFromChildren||(Q._updatingToChildren=1,un(Q._children,M.x-Q._position.x,M.y-Q._position.y),delete Q._updatingToChildren),zm.superClass.setPosition.call(this,M)}},setWidth:function(L){return this.setSize(L,this.getHeight())},setHeight:function(W){return this.setSize(this.getWidth(),W)},setSize:function(f,L){var j=b.blockMinSize;f=a(f,j),L=a(L,j);var h=this;if(!h._updatingToChildren){2!==arguments.length&&(L=f.height,f=f.width);var G=h.getWidth(),Q=h.getHeight();if(f!==G&&zm.superClass.setWidth.call(h,f),L!==Q&&zm.superClass.setHeight.call(h,L),!fq&&!h._updatingFromChildren){h._updatingToChildren=1;var N=f/G,l=L/Q;h._adjustChildScaleOrSize(N,l,"size"),delete h._updatingToChildren,h.updateFromChildren()}}},_adjustChildScaleOrSize:function(Q,e,X){var p=this;if(p._syncSize){var $=p.getPosition(),s=p.getRotation();p.getScale(),p.eachChild(function(F){if($o(F)){var C=F.getPosition(),G=F.getRotation(),U=F.getWidth(),v=F.getHeight(),g=F.getScale(),z=g.x*U,S=g.y*v,L=new md(G,C.x,C.y,z,S);L.translate(-$.x,-$.y),L.rotate(-s),G=o(L.b*Math.sign(z),L.a*Math.sign(z)),L.scale(Q,e);var Z,l,m,M=E(G);if(Math.abs(M)<.001?(Z=j(G),l=L.b/Z,m=-L.c/Z):(l=L.a/M,m=L.d/M),"scale"===X)F.setScale(l/U,m/v);else if("size"===X){var c=l/g.x,w=m/g.y;F.setScale(_r(l)*Math.abs(g.x),_r(m)*Math.abs(g.y)),F instanceof P.Shape?(F.setWidthForce(Math.max(Math.abs(c),1e-5)),F.setHeightForce(Math.max(Math.abs(w),1e-5))):F.setSize(Math.max(.01,Math.abs(c)),Math.max(.01,Math.abs(w)))}L.rotate(s),L.translate($.x,$.y),F.setPosition(L.tx,L.ty)}})}},_calcChangeFactor:function(v,E,l,u){var B,O,h,W;return B=T(v),O=T(l),h=B>O?B/O:O/B,B=T(E),O=T(u),W=B>O?B/O:O/B,a(h,W)},setElevation:function(a){var P=this;if(!P._updatingToChildren){var _=P.getElevation(),w=a-_;0!==w&&(fq||P._updatingFromChildren||(P._updatingToChildren=1,un(P._children,0,w,0),delete P._updatingToChildren),zm.superClass.setElevation.apply(P,arguments))}},setTall:function(A){var L=this;if(!L._updatingToChildren){A=a(A,b.blockMinSize);var D=L.getTall();if(A!==D&&zm.superClass.setTall.call(L,A),!fq&&!L._updatingFromChildren){L._updatingToChildren=1;var e=A/D;L._adjustChildTallOrScale(e,"size"),delete L._updatingToChildren,this.updateFromChildren()}}},setScaleTall:function(e){var E=this;if(!E._updatingToChildren){var R=E.getScaleTall();if(T(e)<.01&&(e=.01*(_r(e)||_r(R))),zm.superClass.setScaleTall.call(E,e),!fq&&!E._updatingFromChildren){E._updatingToChildren=1;var c=e/R;E._adjustChildTallOrScale(c,"size"),delete E._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(Z,s){var F=this;if(F._syncSize){var A=F.getElevation();F.eachChild(function(c){if($o(c))if("size"===s){var n=c.getTall();0>Z&&c.setScaleTall(-1*c.getScaleTall()),c.setTall(Math.max(.01,Math.abs(n*Z))),c.setElevation(A+(c.getElevation()-A)*Z)}else{var i=c.getScaleTall();c.setScaleTall(i*Z)}})}},setAnchor:function(){var L=this;if(!L._updatingToChildren){var Y=L.getAnchor();if(zm.superClass.setAnchor.apply(L,arguments),!fq&&!L._updatingFromChildren&&L._syncSize){L._updatingToChildren=1;var f=L.getAnchor();L.getPosition();var k=L.getSize(),i=L.getScale(),l=L.getRotation(),m=-k.width*i.x*(Y.x-f.x),o=-k.height*i.y*(Y.y-f.y),B=j(l),p=E(l),M=p*m-B*o,t=B*m+p*o;L.eachChild(function(w){if($o(w)){var p=w.getPosition();w.setPosition(p.x-M,p.y-t)}}),delete L._updatingToChildren}}},setAnchorElevation:function(){var m=this;if(!m._updatingToChildren){var B=m.getAnchorElevation();if(zm.superClass.setAnchorElevation.apply(m,arguments),!fq&&!m._updatingFromChildren&&m._syncSize){m._updatingToChildren=1;var w=m.getAnchorElevation(),C=m.getTall(),z=m.getScaleTall(),S=-C*z*(B-w);m.eachChild(function(R){if($o(R)){var M=R.getElevation();R.setElevation(M-S)}}),delete m._updatingToChildren}}},setRotation:function(L){this._updateChildrenRotation3d("rotation",L)},setRotationX:function(R){this._updateChildrenRotation3d("rotationX",R)},setRotationZ:function(k){this._updateChildrenRotation3d("rotationZ",k)},_updateChildrenRotation3d:function(E,G){var L=this;if(!L._updatingToChildren){var Q=L[_j(E)]();if(zm.superClass[$h(E)].call(L,G),!fq&&!L._updatingFromChildren){L._updatingToChildren=1;var D=G-Q;L.eachChild(function(a){$o(a)&&a._11Q(L,E,D)}),delete L._updatingToChildren}}},setScale:function(Y,G){var A=this;if(!A._updatingToChildren){null==G&&(G=Y.y,Y=Y.x);var e=A.getScale();if(T(Y)<.01&&(Y=.01*(_r(Y)||_r(e.x))),T(G)<.01&&(G=.01*(_r(G)||_r(e.y))),zm.superClass.setScale.call(A,Y,G),!fq&&!A._updatingFromChildren){A._updatingToChildren=1;var x=Y/e.x,H=G/e.y;A._adjustChildScaleOrSize(x,H,"size"),delete A._updatingToChildren,A.updateFromChildren()}}},getSerializableProperties:function(){var M=zm.superClass.getSerializableProperties.call(this);return M.clickThroughEnabled=1,M.syncSize=1,M}});var Jf=P.Grid=function(){yf(P.Grid,this)};hh("Grid",Ei,{IRotatable:!1,_icon:"grid_icon",_image:A,getUIClass:function(){return Vl},setRotation:function(){},getCellRect:function(Y,T){var r=this,c=r.s("grid.row.count"),q=r.s("grid.column.count");if(0>=c||0>=q||0>Y||Y>=c||0>T||T>=q)return A;var e,Q,x,N=r.getRect(),M=r.s("grid.row.percents"),U=r.s("grid.column.percents");if(gr(N,r,"grid.border",-1),M&&M._as&&(M=M._as),U&&U._as&&(U=U._as),M&&M.length===c){for(x=0,e=0;Y>e;e++)x+=N.height*M[e];N.y+=x,N.height=N.height*M[Y]}else N.height=N.height/c,N.y+=N.height*Y;if(U&&U.length===q){for(Q=0,e=0;T>e;e++)Q+=N.width*U[e];N.x+=Q,N.width=N.width*U[T]}else N.width=N.width/q,N.x+=N.width*T;return Qj(N,-r.s("grid.gap")),N}});var Nk=P.Text=function(){yf(Nk,this),this.setSize(100,50),this.s("text","TEXT")};hh("Text",Ei,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Zl},setWidth:function(q){q||(q=.001),Nk.superClass.setWidth.call(this,q)},setHeight:function(P){P||(P=.001),Nk.superClass.setHeight.call(this,P)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),nk("__text__",{width:{value:100,isSafeFunc:!0,func:function(r){return r?r._width:100}},height:{value:50,isSafeFunc:!0,func:function(S){return S?S._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var xn=P.Shape=function(){yf(xn,this),this._59O=new Tr};xn.__de__=Ag,hh("Shape",Ei,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return vq},_22Q:function(){return qj},getLength:function(l){return jp(vm(this._59O,this._58O,l,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var W=this._58O;return W?new Tr(W._as.slice(0)):W},setSegments:function(_){var g=this._58O;_=_?Fl(_)?new Tr(_.slice(0)):new Tr(_._as.slice(0)):null,(g&&_&&g._as.join(",")!==_._as.join(",")||g!==_)&&(this._58O=_,this.fp("segments",g,_))},getPoints:function(){return this._59O},toPoints:function(){var p=this._59O;return new Tr(p._as.slice(0))},getPointsMatrix2d:function(){var T=this,o=new Lh.Matrix2d,m=T.getPosition(),x=T.getScale(),O=T.getRotation();return o.translate(-m.x,-m.y).scale(x.x,x.y).rotate(O).translate(m.x,m.y),o},getPointsMatrix3d:function(){return function(){var i=this,j=new Lh.Matrix4,B=j.getElements(),f=i.p3();ac(B,f),No(B,i.getFinalRotation3d(),i.getRotationMode());var F=i.getScale3d(),Y=i._dynamicScale3d;return Y&&(F[0]*=Y[0],F[1]*=Y[1],F[2]*=Y[2]),Zg(B,F),ac(B,Lq(f)),j}}(),setPoints:function(e,w){var Y=this,E=Y._59O;e=e?Fl(e)?new Tr(e.slice(0)):new Tr(e._as.slice(0)):new Tr;var W,j,Z,s,L,l;w&&(W=Y.getPosition(),l=new md(Y.getRotation(),0,0,Y.getScale().x,Y.getScale().y)),(E&&e&&E._as.join(",")!==e._as.join(",")||E!==e)&&(Y._59O=e,Y.fs(),Y.fp("points",E,e)),w&&(j=Y.getPosition(),Z=j.x-W.x,s=j.y-W.y,L=l.tf(Z,s),Y.setPosition(j.x-Z+L.x,j.y-s+L.y))},addPoint:function(K,e,A){var t=this.toPoints();t.add(K,e),this.setPoints(t,A)},setPoint:function(X,S,g){var W=this.toPoints();W.set(X,S),this.setPoints(W,g)},removePointAt:function(L){var F=this.toPoints();F.removeAt(L),this.setPoints(F)},setWidthForce:function(p){var H=this;if(!H._55I&&!fq&&H.getWidth()){H._55I=1;var u=H._position.x,K=p/H.getWidth(),O=H.toPoints(),M=new Tr;1!==K&&(O.each(function(o){M.add({x:(o.x-u)*K+u,y:o.y,e:o.e})}),H.setPoints(M),qs(H,[K,0,0,1,u*(1-K),0]),H.fs()),delete H._55I}xn.superClass.setWidth.call(H,p)},setWidth:function(I){return this.setWidthForce(dd>I?dd:I)},setHeightForce:function(A){var g=this;if(!g._55I&&!fq&&g.getHeight()){g._55I=1;var u=g._position.y,Q=A/g.getHeight(),t=g.toPoints(),H=new Tr;1!==Q&&(t.each(function(L){H.add({x:L.x,y:(L.y-u)*Q+u,e:L.e})}),g.setPoints(H),qs(g,[1,0,0,Q,0,u*(1-Q)]),g.fs()),delete g._55I}xn.superClass.setHeight.call(g,A)},setHeight:function(i){return this.setHeightForce(dd>i?dd:i)},setAnchorElevation:function($){var a=this;a._55I=!0;var H=a._updatingAnchor3d,R=!fq&&!H;if(R){var t,I=$,b=a.getAnchorElevation(),X=a.getTall();t=X*(b-I),0!==t&&a.shiftPointsElevation(t)}var P=xn.superClass.setAnchorElevation.apply(a,arguments);return H||delete a._55I,P},getShapeElevation:function(){var C=this,K=C._54O;return K-(C.getTall()||0)*(C._anchorElevation-.5)},setAnchor3d:function(y,k,$,C){var m,D=this;"number"==typeof y?m={x:y,y:k,z:$}:(m=y.length?{x:y[0],y:y[1],z:y[2]}:y,C=k),D._55I=!0,D._updatingAnchor3d=!0;var F=D.getDataModel();if(F&&F.beginTransaction(),!fq){var w=D.getAnchor3d(),p=D.getSize(),K=D.getTall(),U=p.width*(w.x-m.x),g=p.height*(w.z-m.z),Q=K*(w.y-m.y);C||D.shiftPoints(U,g,Q);var E=D.p3()}var x=xn.superClass.setAnchor3d.apply(D,arguments);if(!fq&&C){var r=D.p3();D.shiftPoints(r[0]-E[0]+U,r[2]-E[2]+g,r[1]-E[1]+Q)}return F&&F.endTransaction(),delete D._updatingAnchor3d,delete D._55I,x},setAnchor:function(b,e,a){var u=this;u._55I=!0;var $=u._updatingAnchor3d,K=!fq&&!$;if(K){var v,n,y;"number"==typeof b?y={x:b,y:e}:(y=b.length?{x:b[0],y:b[1]}:b,a=e);var t=u.getAnchor(),h=u.getSize();v=h.width*(t.x-y.x),n=h.height*(t.y-y.y),a||u.shiftPoints(v,n);var j=u.getPosition()}var P=xn.superClass.setAnchor.apply(u,arguments);if(K){var D=u.getPosition();a&&u.shiftPoints(D.x-j.x+v,D.y-j.y+n)}return $||delete u._55I,P},shiftPoints:function(p,X,S){if(p||X||S){var W=this,D=W.getElevation()||0,U=W.toPoints(),_=new Tr;U.each(function(l){var z=l.e;S&&(z=(z==A?D:z)+S),_.add({x:l.x+p,y:l.y+X,e:z})}),W.setPoints(_),W.fs()}},shiftPointsElevation:function(p){return this.shiftPoints(0,0,p)},setPosition:function(o,d){var P,v=this;if(!v._28Q){if(v._28Q=1,!v._55I&&!fq){P=2===arguments.length?{x:o,y:d}:o;var L=P.x-v._position.x,z=P.y-v._position.y;if(0===L&&0===z)return delete v._28Q,void 0;v._55I=1,v.shiftPoints(L,z),qs(v,[1,0,0,1,L,z]),delete v._55I}xn.superClass.setPosition.apply(v,arguments),delete v._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var e=this;if(2!==e._59O.size())return!1;var Q=e._58O;return Q?2===Q.size()&&1===Q.get(0)&&2===Q.get(1)?!0:!1:!0},fireShapeChange:function(){var W=this;if(!W._55I&&!fq){var H=mo(W._59O);H&&(W._55I=1,W.setRect(H),delete W._55I)}W.fp(Mh,!1,!0)},getSerializableProperties:function(){var W=xn.superClass.getSerializableProperties.call(this);return W.segments=1,W.points=1,W.thickness=1,W.closePath=1,W}});var Wf=P.Polyline=function(){yf(Wf,this),this.s({"shape.background":null,"shape.border.width":2})};hh("Polyline",xn,{_icon:"polyline_icon",_22Q:function(){return Ip},getUIClass:function(){return nh},setClosePath:function(){},setTall:function(i){var r=this,u=r.getDataModel();if(u&&u.beginTransaction(),!r._55I&&!r._24Q&&!fq&&r.getTall()){r._24Q=1;var p=r._54O,D=i/r.getTall();if(1!==D){var $=r.toPoints(),G=new Tr;$.each(function(i){G.add({x:i.x,y:i.y,e:i.e==A?i.e:(i.e-p)*D+p})}),r.setPoints(G),r.fs()}delete r._24Q}Wf.superClass.setTall.call(r,i),u&&u.endTransaction()},setElevation:function(i){var N=this,C=N.getDataModel();if(C&&C.beginTransaction(),!N._55I&&!N._24Q&&!fq){N._24Q=1;var l=i-N._54O;0!==l&&N.shiftPointsElevation(l),delete N._24Q}Wf.superClass.setElevation.apply(N,arguments),C&&C.endTransaction()},fireShapeChange:function(){var m=this,K=m._59O;if(!m._55I&&!m._24Q&&!fq){var U=K.size();if(U){var i=1,t=K.get(0),b=m._54O;t.e==A&&(t.e=b);for(var o=t.e,D=0;U>i;i++){t=K.get(i),t.e==A&&(t.e=b);var H=C(o,t.e),V=a(o+D,t.e);o=H,D=V-H}m._24Q=1,m.setTall(D),m.setElevation(o+D*m._anchorElevation),delete m._24Q}}Wf.superClass.fireShapeChange.apply(m,arguments)}});var Qp=P.SubGraph=function(){yf(Qp,this)};hh("SubGraph",Ei,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Qp.superClass._8I.call(this),this.eachChild(function(e){$o(e)&&e._8I()})}}),b.loadingRefGraph=0;var Ro=P.RefGraph=function(){yf(Ro,this)};hh("RefGraph",zm,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(k){var D=this._ref;this._ref=k,this.fp("ref",D,k),this.updateRef()},_21I:function(){Ro.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var w=this;if(b.loadingRefGraph++,w.clearChildrenFromDataModel(),b.loadingRefGraph--,w._ref&&w._dataModel){w._xhrLoadHandler&&(w._xhrLoadHandler.cancel=!0);var G=fq,t=w._xhrLoadHandler=function(g){if(g&&w._dataModel){b.loadingRefGraph++;var J=w._pendingUpdateInfo={needToRestore:G};G&&(J.p3=w.p3(),J.s3=w.s3(),J.r3=w.r3(),J.anchor3d=w.getAnchor3d(),J.scale3d=w.getScale3d()),w.r3(0,0,0),w.setScale3d(1,1,1),w.setAnchor3d(.5,.5,.5),w.p3(0,0,0);var I=b.parse(g),s=w._dataModel.deserialize(I,w,{justDatas:!0});s.each(function(k){k._refGraph=w}),w.checkPendingUpdateInfo(),b.loadingRefGraph--,b.handleRefGraphLoaded(w,s,I)}};t.xhrLoadCalled=!1,b.load(w._ref,function(P){t.cancel||(t.xhrLoadCalled?t(P):Wg(function(){t(P)}))}),t.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var s=this,L=s._pendingUpdateInfo;if(!L)return s.onPendingUpdated&&(b.loadingRefGraph++,s.onPendingUpdated(),b.loadingRefGraph--),void 0;var V=!0;this.eachChild(function(U){(U._pendingCheckImageJSON||U._pendingUpdateInfo)&&(V=!1)}),V&&(b.loadingRefGraph++,s._pendingUpdateInfo=null,s.updateFromChildren(),L.needToRestore&&(s.setAnchor3d(L.anchor3d),s.setScale3d(L.scale3d),s.r3(L.r3),s.p3(L.p3)),this.getParent()instanceof Ro&&this.getParent().checkPendingUpdateInfo(),s.onPendingUpdated&&s.onPendingUpdated(),b.loadingRefGraph--)},getSerializableProperties:function(){var $=Ro.superClass.getSerializableProperties.call(this);return $.ref=1,$}}),P.EdgeGroup=function(C,y){this._70O=C,this._siblings=y;for(var l,t,X=0,R=C.size(),M=n[Pi];R>X;X++)if(l=C.get(X).getStyle(Pi,!1),l!=A){M=l;break}M==A&&(M=!0);var B=b.edgeGroupAgentFunc;for(B&&(t=B(C),t&&t!==C.get(0)&&(C.remove(t),C.add(t,0))),X=0;R>X;X++)C.get(X).s(Pi,M)},hh("EdgeGroup",N,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(E){return this._70O.get(E)},indexOf:function(P){return this._70O.indexOf(P)},each:function(p,S){this._70O.each(p,S)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(d,J){this._siblings.each(function(a){a._70O.each(d,J)})}});var Se=function(n,Y,J){var F=Xc[n]={type:n,action:Y};if(J)for(var K in J)F[K]=J[K]};Ec(b,{setConnectAction:Se,getConnectAction:function(g,F){if(!F){if(!g)return null;F=g.getCurrentConnectActionType()}return Xc[F]},doConnectAction:function(H,M,$,G){G=G||H.getCurrentConnectActionType();var u=Xc[G];if(!u)return!1;var A=u.action;return A?(M instanceof Vq.Group?H.sm().getSelection().each(function(I){A.call(null,H,I,$)}):A.call(null,H,M,$),!0):!1},doDeleteConnectionAction:function(Z,j,S){S=S||Z.getCurrentConnectActionType();var E=Xc[S];if(!E||!E.delete)return!1;var B=E.delete.action;return B?(j instanceof Vq.Group?Z.sm().getSelection().each(function(e){B.call(null,Z,e)}):B.call(null,Z,j),!0):!1}});var ie=P.JSONSerializer=function(Z,e){this.dm=this._dataModel=Z,this._hierarchical=b.forceHierarchicalSerialization?!0:e==A?Z.isHierarchicalRendering():e};hh("JSONSerializer",N,{ms_ac:["hierarchical"],serialize:function(Q){return b.stringify(this.toJSON(),Q)},toJSON:function(){var x=this,X=x.dm,d=X.getRoots(),J=x.json={v:b.getVersion(),p:{},a:{},d:[]},Z=X.getSerializableAttrs();X.getInit()&&(J.init=X.getInit()),X.getName()&&(J.p.name=X.getName()),X.getBackground()&&(J.p.background=X.getBackground()),X.getLayers()&&(J.p.layers=X.getLayers()),X.getEnvmap()&&(J.p.envmap=X.getEnvmap()),J.p.autoAdjustIndex=X.isAutoAdjustIndex(),J.p.hierarchicalRendering=X.isHierarchicalRendering();for(var l in Z){var $=X.a(l);$!==e&&x[ce](l,$,J.a)}return Ah(J.a)&&delete J.a,x._hierarchical?d.each(x.serializeData,this):X.each(function(z){x.serializeData(z)}),X.fireSerializeEvent({type:"serialize",json:J}),X.getPostProcessingData()&&(J.p.postProcessingData=X.getPostProcessingData()),J},isSerializable:function(){return!0},getProperties:function(u){return u.getSerializableProperties()},getStyles:function(x){return x.getSerializableStyles()},getAttrs:function(L){return L.getSerializableAttrs()},serializeData:function(V){var U=this;if(U.isSerializable(V)&&!V._refGraph){var H,Z,u,t,m=us(V.getClassName())||V.getClass(),p=new m,Q={c:V.getClassName(),i:V.getId(),p:{},s:{},a:{}};U.json.d.push(Q),H=U.getProperties(V);for(Z in H)if(/^_/.test(Z)){if(u=V[Z],!("_width"!==Z&&"_height"!==Z||u!=A&&-1!==u)){var F;((V.s("layout.h")||V.s("layout.v"))&&V.getHost()||V instanceof P.Node&&(F=V.getParent())&&F instanceof P.Block||V.s("fullscreen"))&&(u=V[Z]="_width"===Z?V.getWidth():V.getHeight())}u!==p[Z]&&U[ce](Z.substr(1),u,Q.p)}else t=_j(Z),V[t]&&(u=V[t](),u!==p[t]()&&U[ce](Z,u,Q.p));H=U.getStyles(V);for(Z in H)u=V.s(Z),u!==p.s(Z)&&U[ce](Z,u,Q.s);H=U.getAttrs(V);for(Z in H)u=V.a(Z),u!==p.a(Z)&&U[ce](Z,u,Q.a);Ah(Q.p)&&delete Q.p,Ah(Q.s)&&delete Q.s,Ah(Q.a)&&delete Q.a}U._hierarchical&&V.getChildren().each(U.serializeData,U)},serializeValue:function(d,K,G){mk(K)?K={__a:K._as}:K instanceof ej&&(K={__i:K.getId()}),G[d]=K},deserialize:function(l,h,I){var J=this;return nf(l)&&/.json$/.test(l)?(b.xhrLoad(l,function(W){J.deserializeImpl(W,h,I)}),void 0):J.deserializeImpl(l,h,I)},deserializeImpl:function(_,I,s){var Z=this,l=Z.dm;l.setDeserializing(!0),s=ql(s)?{setId:s}:Fd(s)?{finishFunc:s}:s||{},_=Z.json=nf(_)?b.parse(_):_,!s.justDatas&&_.a&&_.a.onPreDeserialize&&!s.disableOnPreDeserialize&&_.a.onPreDeserialize(_,l,s.view),l.beginTransaction(),fq++,Z._82I={};var O=new Tr,U=new Tr,i=0,C=_.d.length;if(s.justDatas||(!s.disableInit&&Fd(_.init)&&_.init(l),l.setInit(_.init)),!s.justDatas){for(var c in _.a)l.a(c,Z[vi](_.a[c]));for(var X in _.p)l[$h(X)](_.p[X])}for(;C>i;i++){var F=_.d[i],f=us(F.c),e=new f,$=F.i;s.setId&&$!=A&&(e._id=$),Z._82I[$]=e,O.add(e),U.add(F)}for(i=0;C>i;i++)Z.deserializeData(O.get(i),U.get(i));return O.each(function(P){I&&!P.getParent()&&P.setParent(I),l.add(P)}),s.__innerHandler__&&s.__innerHandler__(_,l,s.view,O),l.fireSerializeEvent({type:"deserialize",json:_}),fq--,l.endTransaction(),!s.justDatas&&_.a&&_.a.onPostDeserialize&&!s.disableOnPostDeserialize&&_.a.onPostDeserialize(_,l,s.view,O),s.finishFunc&&s.finishFunc(_,l,s.view,O),l.setDeserializing(!1),O},deserializeData:function(h,P){for(var T in P.p)h[$h(T)](this[vi](P.p[T]));for(T in P.s)h.s(T,this[vi](P.s[T]));for(T in P.a)h.a(T,this[vi](P.a[T]))},deserializeValue:function(p){if(Tp(p)){var j=p.__i;if(j!=A)return this._82I[j];if(j=p.__a,Fl(j))return new Tr(j)}return p}}),Ec(Er,{serialize:function(M,d){return new ie(this,d).serialize(M)},toJSON:function(k){return new ie(this,k).toJSON()},deserialize:function(t,b,c){return new ie(this).deserialize(t,b,c)}});var Zi=P.OverlappingBox=function(d){this.gv=d,this.boxes={}};hh("OverlappingBox",N,{clear:function(){var D,b,A=this.boxes;for(D in A)b=A[D],b.length=0},isOverlapping:function(n,z){var i,x,B=this,Y=B.boxes,p=Y[n];p?(i=p.rects,x=p.length):p=Y[n]={rects:i=[],length:x=0};var Q,A,z;for(Q=0;x>Q;Q++)if(A=i[Q],A.x<z.x+z.w&&A.x+A.w>z.x&&A.y<z.y+z.h&&A.h+A.y>z.y)return!0;return i.length<=x?(i.push(z),p.length++):i[p.length++]=z,!1}}),Ec(b,{fetch:function(Z,b){var E="GET",V=!1,z=null,s="";b&&(E=b.method||"GET",V=b.sync,s=b.url,z=b.data||null),Z.open(E,s,!V),b.responseType?Z.responseType=b.responseType:b.overrideMimeType&&Z.overrideMimeType&&Z.overrideMimeType(b.overrideMimeType),Z.send(z)},convertImageSrc:function(p,L){L&&"function"==typeof L||(L=function(){}),L(p)}});var en=P.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};hh("Request",N,{_responseType:null,_overrideMimeType:"text/plain",send:function(P){var w=this._xhr,T=this.onload,d=this.onerror;this.getResponseType()?P.responseType=this.getResponseType():this.getOverrideMimeType()&&(P.overrideMimeType=this.getOverrideMimeType()),w.onload=T,w.onerror=d,b.fetch(w,P)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(o){this._responseType=o},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(F){this._overrideMimeType=F},getResponseText:function(){var a=this._xhr;return a.response||a.responseText}}),Nl.GraphView=function(v){var F=this;F._24I={},F._34I=new Tr,F._25I={},F._56I={},F._view=tf(1,F),F._canvas=sn(F._view),F.dm(v?v:new Er),this._coreInteractor=new ge(this),F.setEditable(!1),F.setScrollBarVisible(b.graphViewScrollBarVisible),F._initView()},Of("GraphView",N,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Lj,ho,Xp,ph,"resettable","editInteractor",Dj,"zoomable","pannable","rectSelectable","autoScrollZone",qp,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:b.graphViewZoomable,_resettable:b.graphViewResettable,_pannable:b.graphViewPannable,_rectSelectable:b.graphViewRectSelectable,_autoScrollZone:b.graphViewAutoScrollZone,_rectSelectBackground:b.graphViewRectSelectBackground,_rectSelectBorderColor:b.graphViewRectSelectBorderColor,_editPointSize:b.graphViewEditPointSize,_editPointBorderColor:b.graphViewEditPointBorderColor,_editPointBackground:b.graphViewEditPointBackground,_scrollBarColor:xm,_scrollBarSize:gg,_autoHideScrollBar:hd,_autoMakeVisible:mm,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(R){this._dataModel.setLayers(R)},setEditable:function(D){var n=this,G=n.__interactorMap__;if(!G){var R=Nl.XEditInteractor;G=n.__interactorMap__={scrollBar:new Eh(n),select:new $f(n),edit:R?new R(n):new pr(n),text:new rq(n),move:new _e(n),"default":new eq(n),touch:new pp(n,{editable:!1})}}D?(n._uieditable=!0,n.setInteractors([G.scrollBar,G.select,G.edit,G.text,G.move,G.default,G.touch])):(n._uieditable=!1,n.setInteractors([G.scrollBar,G.select,G.move,G.default,G.touch]))},getCanvas:function(){return this._canvas},_33I:function(Q){var T=Q.getUIClass();return T?new T(this,Q):A},getDataUI:function(q){var s=this,h=s._25I[q._id];return h===e&&(h=s._33I(q),s._25I[q._id]=h),h},getNodeRect:function(_){return b.getNodeRect(this,_)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(N){var a=this.getDataUI(N);return a?(a._79o(),a._78o):null},getEdgeSourcePosition:function(p){var r=this,N=r.getDataUI(p),Z=N.s,m=N._data._40I;return Rb(r,m,Z("edge.source.position"),Z("edge.source.offset.x"),Z("edge.source.offset.y"),Z("edge.source.anchor.x"),Z("edge.source.anchor.y"))},getEdgeTargetPosition:function(I){var R=this,c=R.getDataUI(I),y=c.s,G=c._data._41I;return Rb(R,G,y("edge.target.position"),y("edge.target.offset.x"),y("edge.target.offset.y"),y("edge.target.anchor.x"),y("edge.target.anchor.y"))},invalidateAll:function(y){var B=this;if(y){for(var $ in B._25I){var I=B._25I[$];I&&I.dispose()}B._25I={},B._56I={},B._24I={},B._34I.clear(),B.redraw()}else B.dm().each(function(w){B.invalidateData(w)})},invalidateSelection:function(){var k=this;k.sm().each(function(x){k.invalidateData(x)})},invalidateData:function(h){var W=this;W._24I[h._id]=h,W._21Q(h),W.iv()},_21Q:function(L){var v=this,J=v._24I;if(cn(L)&&kq[L.s(km)]){var N=L.getSourceAgent();N&&N.getAgentEdges().each(function(M){J[M._id]=M}),N=L.getTargetAgent(),N&&N.getAgentEdges().each(function(P){J[P._id]=P}),v.iv()}},redraw:function(t){var r=this;r._32I||(t?r._34I.add(t):(r._32I=1,r._34I.clear()),r.iv())},each:function(S,G){var J,B,A,D=0,k=this.getLayers(),j=this._dataModel,y=j._datas._as,R=y.length;if(k){for(var L=k.length;L>D;D++)if(A=k[D],Tp(A)&&(A=A.name),j.isHierarchicalRendering()){var O=function(a){return a._layer===A?G?S.call(G,a):S(a):void 0};if(this._dataModel.eachByHierarchical(O)===!1)return}else for(var u=0;R>u;u++)if(J=y[u],J._layer===A&&(B=G?S.call(G,J):S(J),B===!1))return
}else if(j.isHierarchicalRendering())this._dataModel.eachByHierarchical(S,null,G);else for(;R>D;D++)if(J=y[D],B=G?S.call(G,J):S(J),B===!1)return},reverseEach:function(n,c){var U,Q,m,K,j=this._dataModel,E=j._layers,h=j._datas._as,z=h.length;if(E){for(U=E.length-1;U>=0;U--)if(K=E[U],Tp(K)&&(K=K.name),j.isHierarchicalRendering()){var Y=function(e){return e._layer===K?c?n.call(c,e):n(e):void 0};if(j.reverseEachByHierarchical(Y)===!1)return}else for(var G=z-1;G>=0;G--)if(Q=h[G],Q._layer===K&&(m=c?n.call(c,Q):n(Q),m===!1))return}else if(j.isHierarchicalRendering())j.reverseEachByHierarchical(n,null,c);else for(U=z-1;U>=0;U--)if(Q=h[U],m=c?n.call(c,Q):n(Q),m===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var $=this,j=$._84I;if(!j){var z=this.dm().a("width"),l=this.dm().a("height");z>0&&l>0?$._84I={x:0,y:0,width:z,height:l}:($.each(function(D){$.isVisible(D)&&(j=qh(j,$.getDataUIBounds(D)))}),$._84I=j?j:on)}return $._84I},getScrollRect:function(){return qh(this.getContentRect(),this._29I)},makeCenter:function(V,U,w){var C=this;if(!C.getWidth()||!C.getHeight())return w||Wg(C.makeCenter,C,[V,U,!0],500),void 0;C.makeVisible(V),C.validate();var $=C.getDataUIBounds(V);if($){var R=C.getWidth(),Y=C.getHeight(),S=$.x+$.width/2,e=$.y+$.height/2,s=-S*C._zoom+R/2,W=-e*C._zoom+Y/2;C.setTranslate(s,W,U)}},fitData:function(F,k,Z,j,T){var v=this;if(!v.getWidth()||!v.getHeight())return T||Wg(v.fitData,v,[F,k,Z,j,!0],500),void 0;var h=function(){v.makeVisible(F),v.validate();var t=v.getDataUIBounds(F);t&&(t=Cc(t),Qj(t,Z==A?20:Z),v.fitRect(t,k,j))};k?b.callWhenLoaded(h):h()},fitContent:function(W,Q,U,S){var h=this;if(!h.getWidth()||!h.getHeight())return S||Wg(h.fitContent,h,[W,Q,U,!0],500),void 0;var X=function(){h.validate();var v=Cc(h.getContentRect());Qj(v,Q==A?20:Q),h.fitRect(v,W,U)};W?b.callWhenLoaded(X):X()},fitRect:function(B,E,l){var i=this,I=i.getWidth(),s=i.getHeight(),Q=B.x+B.width/2,R=B.y+B.height/2,c=C(I/B.width,s/B.height),b=i._zoom,r=-Q*b+I/2,T=-R*b+s/2;0===c||isNaN(c)||(l&&(c=C(1,c)),E?(i._65I&&(delete i._65I.finishFunc,i._65I.stop(!0)),i._14o&&i._14o.stop(!0),i.setTranslate(r,T,{finishFunc:function(){i.setZoom(c,E)}})):(i.setTranslate(r,T),i.setZoom(c)))},fitSelection:function(f,l,Z){var h=this,P=h.sm(),N=null;P.size()&&(P.each(function(F){var i=h.getDataUIBounds(F);N=N?qh(i,N):i}),f&&Qj(N,f),h.fitRect(N,l,Z))},toCanvas:function(m,c,z){c=c||this._zoom,this.validateImpl();var S=this,T=S.getContentRect();z&&Qj(T,z),T.width||(T.width=10),T.height||(T.height=10);var E=sn(),t=T.x*c,D=T.y*c,N=Math.ceil(T.width*c),O=Math.ceil(T.height*c);jk(E,N,O,1);var o=Sl(E);return m=m||this._dataModel.getBackground(),m&&ld(o,0,0,N,O,m),Xf(o,-t,-D),o.scale(c,c),S._42(o),o.restore(),E},toDataURL:function(p,d,G,u){return this.toCanvas(p,G,u).toDataURL(d||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(b,$){var Z=this,U=Z.dm().getBackground();if(U){var C=Z.dm().a("width"),E=Z.dm().a("height");C>0&&E>0&&ld(b,0,0,C,E,U)}var V=Z.__htmlOrderList,X=[];if(Z._93db(b,$),Z.each(function(h){var D=Z.getDataUI(h);if(D){var w=Z._56I[h._id],E=D._htmlView;if(w){var H=D._79o();if(E=D._htmlView,P.HtmlNode&&h instanceof P.HtmlNode)D._42(b);else{var Q=Z.getViewRect(),z=E&&E.layoutHTML;!$||Ub($,H)?(z&&(E.layoutHTML(),D.__outerLayout&&delete D.__outerLayout),D._42(b)):Ub(Q,H)||!z||D.__outerLayout||(E.layoutHTML(),D.__outerLayout=!0)}}E&&(X.push(E),E.getView&&(E=E.getView()),E.style.display=w?"block":ei)}}),V&&X.length>0){var s=!1;if(V.length!==X.length)s=!0;else for(var K=0;K<X.length;K++)if(X[K]!==V[K]){s=!0;break}s&&(X.forEach(function(u){u.autoAdjustIndex!==!1&&Z.appendHTML(u,!0)}),this.__htmlOrderList=X)}else this.__htmlOrderList=X;Z._92db(b,$)},validateImpl:function(){this.tryUpdateRootData();var I,H,c,O,L,t=this,n=t.tx(),G=t.ty(),M=t._zoom,N=t._canvas,x=this.getWidth(),u=this.getHeight(),F=t._29I,v={x:-n/M,y:-G/M,width:x/M,height:u/M},f={},p=t._34I,y=t._24I,D=t._32I,T=t._23I;t._24I={},(x!==N.clientWidth||u!==N.clientHeight)&&(jk(N,x,u),D=1),D||Bh(v,F)||(D=1),t._29I=v,t.each(function(M){H=M._id;var o=f[H]=t.isVisible(M);o!==t._56I[H]&&(y[H]=M,c=t.getDataUI(y[H]),c&&c._84o(o),t._84o(M,o))},t);for(H in y)c=t.getDataUI(y[H]),c&&(!D&&t._56I[H]&&(L=c._79o(),L&&p.add(L)),c.invalidate()),t._83I=1;if(t._56I=f,!D)for(H in y)f[H]&&(c=t.getDataUI(y[H]),c&&(L=c._79o(),L&&p.add(L)));if(D?O=v:(p.each(function(H){Ub(v,H)&&(O=qh(O,H))}),O&&(Qj(O,a(1,1/M)),O.x=z(O.x*M)/M,O.y=z(O.y*M)/M,O.width=m(O.width*M)/M,O.height=m(O.height*M)/M,O=kn(v,O))),t._74O=O,O){I=Sl(N);var V=O.x,R=O.y,b=O.width,d=O.height;V=Math.floor((V*M+n)*Af),R=Math.floor((R*M+G)*Af),b=Math.ceil(b*M*Af)+1,d=Math.ceil(d*M*Af)+1,D||(O.x=(V/Af-n)/M,O.y=(R/Af-G)/M,O.width=b/Af/M,O.height=d/Af/M),I.beginPath(),I.rect(V,R,b,d),I.clip(),I.clearRect(V,R,b,d),cm(I,n,G,M),t._42(I,O),I.restore(),delete t._74O}if(p.clear(),delete t._32I,T&&x>0&&u>0){var c=t.getDataUI(T);if(c){var L=c._79o(),h=t._29I,K=h.x,A=h.y,k=h.width,B=h.height,M=t._zoom;L&&!Ub(L,h)&&(L.x+L.width<K&&t.tx(-L.x*M),L.x>K+k&&t.tx(-(L.x+L.width-k)*M),L.y+L.height<A&&t.ty(-L.y*M),L.y>A+B&&t.ty(-(L.y+L.height-B)*M))}delete t._23I}t._83I&&(delete t._83I,delete t._84I),t._98O(),t.countFrame(),Ah(t._24I)||Wg(t.iv,t)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var E,G=this.getFullscreenDatas();for(var Z in G)E=G[Z],this.scaleRootData(E);this._rootDataUpdating=!1}},scaleRootData:function(h){var C=h.s("fullscreen");if("uniform"===C||"fill"===C){h.getRotation()&&h.setRotation(0);var B=h.s("fullscreen.gap")||0,e=this.getWidth(),K=this.getHeight();if(e&&K){var O,p,g,j=e-2*B,J=K-2*B,k=h.getAnchor(),N=h.getScaledSize(),Q=N.width,w=N.height,a=h.s("fullscreen.lock");if(a)return"uniform"===C?j/J>Q/w?(O=J/w,Q=w*j/J):(O=j/Q,w=Q*J/j):"v"===a?(O=J/w,Q=j/O,h.getWidth()!==Q&&h.setWidth(Q)):(O=j/Q,w=J/O,h.getHeight()!==w&&h.setHeight(w)),this.setZoom(O),p=B-(h.getX()-k.x*Q)*O,g=B-(h.getY()-k.y*w)*O,p!==this.tx()&&this.tx(p),g!==this.ty()&&this.ty(g),void 0;p=this.tx(),g=this.ty(),O=this._zoom;var M={x:(-p+B)/O,y:(-g+B)/O,width:j/O,height:J/O};if("uniform"===C){var s=Q/w,n=Math.min(M.width,M.height*s),E=n/s;M.x+=.5*(M.width-n),M.y+=.5*(M.height-E),M.width=n,M.height=E}j=M.width/h.getScaleX(),J=M.height/h.getScaleY(),(h.getWidth()!=j||h.getHeight()!==J)&&h.setSize(j,J);var F=M.x+k.x*M.width,V=M.y+k.y*M.height,f=h.getPosition();(F!==f.x||V!==f.y)&&h.setPosition(F,V)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(y){var v=this;y!==v.isScrollBarVisible()&&(y?(Ho(v._view,v._79O=ob()),Ho(v._79O,v._27I=ob()),Ho(v._79O,v._28I=ob())):(Sc(v._79O),delete v._79O,delete v._27I,delete v._28I),v.fp("scrollBarVisible",!y,y))},getDebugTip:function(){return""},showScrollBar:function(){var N=this;N._79O&&(N._85I||($(function(){N._86I()},ke),N.iv()),N._85I=new Date)},_86I:function(){var N=this;if(N._85I){var i=new Date,d=i.getTime();d-N._85I.getTime()>=ke?(delete N._85I,N.iv()):$(function(){N._86I()},ke)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var o=this,p=this._27I,c=this._28I;if(o._79O){if(o._autoHideScrollBar&&!o._85I)return p.style.visibility=am,c.style.visibility=am,void 0;var P=o.getScrollBarColor(),h=o._zoom,S=o.getScrollBarSize(),B=o.getViewRect(),R=o.getScrollRect(),X=B.height*h,E=R.height*h,v=B.width*h-S-2,Y=X*((B.y-R.y)*h/E),z=X*(X/E),H=p.style;E-.5>X?(ng>z&&(Y=Y+z/2-ng/2,0>Y&&(Y=0),Y+ng>X&&(Y=X-ng),z=ng),di(p,v,Y,S,z),H.visibility=ap,H.background=P,H.borderRadius=S/2+bl):H.visibility=am;var l=B.width*h,m=R.width*h,Y=B.height*h-S-2,v=l*((B.x-R.x)*h/m),e=l*(l/m),H=c.style;m-.5>l?(ng>e&&(v=v+e/2-ng/2,0>v&&(v=0),v+ng>l&&(v=l-ng),e=ng),di(c,v,Y,e,S),H.visibility=ap,H.background=P,H.borderRadius=S/2+bl):H.visibility=am}},setDataModel:function(v){var m=this,c=m._dataModel,u=m._selectionModel;c!==v&&(c&&(c.ump(m.handleDataModelPropertyChange,m),c.umm(m.handleDataModelChange,m),c.umd(m.handleDataPropertyChange,m),c.removeIndexChangeListener(m._75O,m),c.removeHierarchyChangeListener(m.handleHierarchyChange,m),u||c.sm().ums(m.handleSelectionChange,m)),m._dataModel=v,v.mp(m.handleDataModelPropertyChange,m),v.mm(m.handleDataModelChange,m),v.md(m.handleDataPropertyChange,m),v.addIndexChangeListener(m._75O,m),v.addHierarchyChangeListener(m.handleHierarchyChange,m),u?u._21I(v):v.sm().ms(m.handleSelectionChange,m),m.invalidateAll(!0),m.fp(Dg,c,v),m.updateBackground())},getLayersInfo:function(){if(this._layersInfo===e){var f=this.getLayers();f?(this._layersInfo={},f.forEach(function(e){var d=Tp(e)?e.name:e;this._layersInfo[d]=e},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(b,y,W){var n,V,G=this,x=G.getDataUI(b),g=wp(x),$=id(y,function(b){return jf(g,100*b)},100,.001),e=jf(g,100*$);if(!W){var t=Ol(x),s=new $j(e.x,e.y),k=49/(G._zoom*G._zoom);for(n=0,V=t.length;V>n;n++)if(s.distanceToSquared(t[n])<k)return{index:n,point:t[n],distance:Math.sqrt((t[n].x-y.x)*(t[n].x-y.x)+(t[n].y-y.y)*(t[n].y-y.y))}}return{percent:$,point:e,distance:Math.sqrt((e.x-y.x)*(e.x-y.x)+(e.y-y.y)*(e.y-y.y))}},calculateAttachPoint:function(){var b=new $j,l=new $j,s=new $j;return function(e,N){var h=this.getAttachPoints(e);if(!h||!h.length)return null;s.set(N.x,N.y);for(var n,J,v,X,w,$=1/0,i=0,d=h.length;d>i;i++)v=h[i],l.x=v.x,l.y=v.y,b.x=v.offsetX||0,b.y=v.offsetY||0,X=Rb(this,e,0,b.x,b.y,l.x,l.y),J=s.distanceToSquared(X),$>J&&(n=i,$=J,w=X);$=Math.sqrt($);var S=this.getAttachStyle(e);if("close"===S){var D=e.s("attach.close.threshold")/this._zoom;if($>D)return null}return{index:n,distance:$,info:h[n],point:w}}}(),getAttachPoints:function(o){var C=o.s("attach.points");if(C)return C;var G=Ef(o._image);return G?_d(G.attachPoints,o,this)||null:void 0},getAttachStyle:function(e){var i=e.s("attach.style");if(i)return i;var U=Ef(e._image);return U?_d(U.attachStyle,e,this)||"close":void 0},updateLayers:function(){this._layersInfo=e,this.invalidateSelection(),this.redraw()},updateBackground:function(){var y=this.dm().a("width"),q=this.dm().a("height");this._canvas.style.background=y>0&&q>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(q){if("background"===q.property){var O=this._canvas.style.background,o=q.newValue||"";this.updateBackground(),this.fp("canvasBackground",O,o),this.redraw()}else"a:width"===q.property||"a:height"===q.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===q.property?this.updateLayers():"hierarchicalRendering"===q.property&&this.redraw()},handleDataPropertyChange:function(m){this.dm().isHierarchicalRendering()&&"parent"===m.property&&m.data.hasChildren()&&this.redraw(),this.invalidateData(m.data)},onPropertyChanged:function(p){var o=this,I=p.property;if(o.redraw(),"zoom"===I){var d=o.sm().getSelection();d.size()&&d.each(function(J){J.invalidate()})}else"dataModel"===I&&(o._83I=1);fj[I]?o.showScrollBar():I===Dj&&o.onCurrentSubGraphChanged(p)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(J){var S=this,T=J.kind,K=J.data;if(S._83I=1,"add"===T)S.invalidateData(K),cn(K)&&K.getEdgeGroup()&&K.getEdgeGroup().eachSiblingEdge(S.invalidateData,S);else if(T===kc){S._21Q(K);var I=K._id,L=S._25I[I];if(L){if(S._56I[I]){var W=L._79o();W&&S.redraw(W)}L.dispose(),delete S._25I[I],delete S._24I[I],delete S._56I[I]}K===S._currentSubGraph&&S.setCurrentSubGraph(A)}else T===Bj&&(S.invalidateAll(!0),S.setCurrentSubGraph(A))},_75O:function(W){this.invalidateData(W.data)},handleHierarchyChange:function(N){this.dm().isHierarchicalRendering()&&N.data.hasChildren()&&this.redraw(),this.invalidateData(N.data)},adjustIndex:function(i){var N=this;if(N.isVisible(i)){N.dm().beginTransaction();for(var D=i;D._parent&&N.isVisible(D._parent);)D=D._parent;D&&D!==i&&N._dataModel.adjustIndex(D),N._dataModel.adjustIndex(i),N.dm().endTransaction()}},getImage:function(G){return G.getImage?G.getImage():e},getSelectWidth:function(b){var H=Ef(this.getImage(b));return H&&_d(H.disableSelectedBorder,b,this)?0:b.s("select.width")},getSelectColor:function(b){return b.s("select.color")},isSelectable:function(R,v){if(this.isSelected(R))return!0;if(!v&&R.getParent()instanceof zm&&this.isSelectable(R.getParent(),!0)&&R.getParent().isSyncSize())return!1;var j=this.getLayersInfo();if(j){var D=j[R._layer];if(D&&D.selectable===!1)return!1}return R.s("2d.selectable")&&this.sm().isSelectable(R)},isMovable:function(C){var H=this;if(cn(C)&&C.getStyle(km)!==od)return!1;var A=this.getLayersInfo();if(A){var q=A[C._layer];if(q&&q.movable===!1)return!1}return C.s("2d.movable")?H._movableFunc?H._movableFunc(C):!0:!1},isEditable:function(k){var i=this;if(P._uiSerializing)return i._uieditable;if(!i._editInteractor||!i.isSelected(k))return!1;if(gk(k)){var S=i.getDataUI(k);if(!S||S._88I)return!1}if(cn(k)&&k.getStyle(km)!==od)return!1;var r=this.getLayersInfo();if(r){var c=r[k._layer];if(c&&c.editable===!1)return!1}return k.s("2d.editable")?i._editableFunc?i._editableFunc(k):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(p){return $o(p)&&0!==p.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(p):!0},isRectEditable:function(S){return this._rectEditableFunc?this._rectEditableFunc(S):!0},isAnchorEditable:function(Y){return this._anchorEditableFunc?this._anchorEditableFunc(Y):!0},isRotationEditable:function(A){return A.setRotation&&A.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(A):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(e){var Z=e.getAnchor(),J=e.getScale(),s=this._zoom,F=se(e.getRotation(),0,-e.getHeight()*J.y*Z.y-(J.y<0?-1:1)*(tc?32:16)/s),A=e.p();return F.x+=A.x,F.y+=A.y,F},getLogicalPoint:function(W){var $=this;return Uc(W,$._canvas,$.tx(),$.ty(),$._zoom,$._zoom)},getScreenPoint:function(V,z){var p,h=this;return"object"==typeof V?V.x!==e?(p=V.x,z=V.y):(p=V[0],z=V[1]):p=V,yh(p,z,h._canvas,h.tx(),h.ty(),h._zoom,h._zoom)},getSelectedDataAt:function(w){var K=this;return this.getDataAt(w,function(a){return K.isSelected(a)})},getDataInfoAt:function(p,z,Z){var $,L=this.lp(p),w=this.getDataAt(L,z,Z);if(w){var q=this.getDataUI(w);$={data:w,ui:q,point:L};var E=q._38o;if(E){var P=E.icons;for(var R in P){var Y=P[R],_=E.rects[R];if(_)for(var B=_d(Y.names,w,this),i=B?B.length:0,x=_.rotation,Q=i-1;Q>=0;Q--){var H=B[Q],y=_[Q];if(dg(y,L,x))return $.part="icons",$.name=R,$.icon=H,$.rect=y,$.index=Q,$.rotation=x,$}}}if(this.isNoteVisible(w)){if(q.note2Info&&dg(q.note2Info.clickRect,L,A,q.note2Info.scale))return $.part="note2",$;if(q.noteInfo&&dg(q.noteInfo.clickRect,L,A,q.noteInfo.scale))return $.part="note",$}if(this.isLabelVisible(w)){if(q.label2Info&&dg(q.label2Info.rect,L,q.label2Info.rotation,q.label2Info.scale))return $.part="label2",$;if(q.labelInfo&&dg(q.labelInfo.rect,L,q.labelInfo.rotation,q.labelInfo.scale))return $.part="label",$}if(w.isInRect&&w.isInRect(L))return $.part="body",$}return $},getDataAt:function(W,i,G){W.target&&(W=this.lp(W));var $,U=this._zoom;return this.reverseEach(function(A){return(i?i(A):this.isSelectable(A))&&this.rectIntersects(A,fd(W.x,W.y,G,U))?($=A,!1):void 0},this),$},getIconInfoAt:function(q,s){var h=this;if(q.target&&(q=h.lp(q)),s||(s=h.getDataAt(q)),s){var I=h.getDataUI(s);if(I&&I._38o){var z,n=I._38o,P=new Tr;for(z in n.icons)P.add(z);for(var U=P.size()-1;U>=0;U--){z=P.get(U);for(var G=n.rects[z],t=G.rotation,T=G.length-1;T>=0;T--){var r=G[T],N=r.width,O=r.height,y={x:q.x-r.x-N/2,y:q.y-r.y-O/2};t!=A&&(y=se(-t,y.x,y.y));var r={x:-N/2,y:-O/2,width:N,height:O};if(dg(r,y))return{key:z,index:T,name:n.icons[z].names[T],rect:G[T],point:q,rotation:t,relativeRect:r,relativePoint:y,data:s}}}}}return A},getDatasInRect:function(G,F,m){m===e&&(m=1);var p=this,h=new Tr;return p.reverseEach(function(i){m&&!p.isSelectable(i)||(F?p.rectIntersects(i,G):p.rectContains(i,G))&&h.add(i)}),h},moveSelection:function(o,L){var d=this;d.dm().beginTransaction(),un(d.sm().toSelection(d.isMovable,d),o,L),d.dm().endTransaction()},moveDatas:function(y,U,u){var o=this;o.dm().beginTransaction(),y instanceof Tr||(y=new Tr(y)),un(y,U,u),o.dm().endTransaction()},getDataUIBounds:function(W){var Z=this.getDataUI(W);return Z?Z._79o():A},drawData:function(b,N,j){var T=this.getDataUI(N);if(T){var S=T._79o();(!j||Ub(j,S))&&(T._42(b),N instanceof P.Block&&N.eachChild(function(Z){this.isVisible(Z)&&this.drawData(b,Z,j)},this))}},getBoundsForGroup:function(d){return d.s(Do)?this.getDataUIBounds(d):A},isPixelPerfect:function(c){return c.s("pixelPerfect")},rectIntersects:function(q,Q){this.validate();var M=A;if(this._56I[q._id]){var k=this._25I[q._id];if(k){var i=k._79o();if(hn(Q,i))M=!0;else if((Q=kn(Q,i))&&(k.rectIntersects&&(M=k.rectIntersects(Q)),M==A)){if(!this.isPixelPerfect(q))return!0;var s=Q.x,G=Q.y,J=Q.width,R=Q.height,E=this._zoom,U=b.hitMaxArea,r=J*R*E*E;if(r>U){var _=Math.sqrt(U/r);E*=_}J*=E,R*=E,2>J&&(J=2),2>R&&(R=2),s*=E,G*=E;var z=Zj(J,R);Xf(z,-s,-G),z.scale(E,E),this._drawForChecking=!0,this.drawData(z,q,Q),this._drawForChecking=!1;try{for(var $=0,O=z.getImageData(0,0,J,R).data;$<O.length;$+=4)if(0!==O[$+3]){M=!0;break}z.restore()}catch(t){Vr=A,M=!1}}}}return M?!0:!1},rectContains:function(y,X){if(this._56I[y._id]){var D=this._25I[y._id];if(D)return hn(X,D._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(Z){if(!b.isInput(Z.target)){var d=this,k=d._focusData,w=k&&d._25I[k._id],B=0,o=d._dataModel._datas;if(!(k&&k._enabled&&k._editable&&w&&w.onKeyDown&&w.onKeyDown(Z)===!0))if(9===Z.keyCode&&(k&&(B=o.indexOf(k),kj(Z)?-1===--B&&(B=0):++B===o.size()&&(B=0)),d._focusData=k=o.get(B),d.sm().setSelection(k)),wg(Z)?d.selectAll():Kn(Z)&&d.isResettable()&&d.reset(),d.sm().isEmpty()){if(d._editing)return;var j=d.tx(),W=d.ty(),$=!1,I=kj()?100:10;el(Z)&&(j-=I,$=!0),Pk(Z)&&(W-=I,$=!0),cg(Z)&&(j+=I,$=!0),Dd(Z)&&(W+=I,$=!0),$&&d.setTranslate(j,W)}else{hp(Z)&&d.handleDelete(Z);var c=kj()?10:1;el(Z)&&(d.moveSelection(-c,0),d.fi({kind:"moveLeft"})),Pk(Z)&&(d.moveSelection(0,-c),d.fi({kind:"moveUp"})),cg(Z)&&(d.moveSelection(c,0),d.fi({kind:"moveRight"})),Dd(Z)&&(d.moveSelection(0,c),d.fi({kind:"moveDown"}))}}},handleScroll:function(g,Y){if(Rj(g),this.isZoomable()){if(!this.getEditInteractor()){var D=this.getDataAt(g);if(D){var c=Ef(this.getImage(D));if(c&&_d(c.scrollable,D,this))return}}var n=this.lp(g);Y>0?this.scrollZoomIn(n):0>Y&&this.scrollZoomOut(n)}},handlePinch:function(h,T,q){this.isZoomable()&&(Math.abs(T-q)<b.pinchZoomThreshold||(T>q?this.pinchZoomIn(h):this.pinchZoomOut(h)))},checkDoubleClickOnNote:function(D,N){var q=this,L=q.lp(D),F=q.getDataUI(N),u=F.note2Info;return u&&N.s("note2.toggleable")&&dg(u.clickRect,L)?(N.s(Fh,!N.s(Fh)),q.fi({kind:"toggleNote2",event:D,data:N}),!0):(u=F.noteInfo,u&&N.s("note.toggleable")&&dg(u.clickRect,L)?(N.s(dp,!N.s(dp)),q.fi({kind:"toggleNote",event:D,data:N}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(k,G){var j=this,X=j.getAutoScrollZone(),w=X/j.getZoom(),K=X/4,H=j._29I,U=j.lp(k),I={x:j.tx(),y:j.ty()};return U&&X>0&&H&&(U.x-H.x<w?j.translate(K,0):H.x+H.width-U.x<w&&j.translate(-K,0),U.y-H.y<w?j.translate(0,K):H.y+H.height-U.y<w&&j.translate(0,-K)),I.x=j.tx()-I.x,I.y=j.ty()-I.y,G&&(G.x+=I.x,G.y+=I.y),I},getMoveMode:function(e,f){var w=f.s("2d.move.mode");return w?w:de["88"]?"x":de["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(X,i,I){var c=this;return"currentSubGraph"===i?{__i:X.getId()}:I.serializeProperty(X,i,c)},deserializeProperty:function(L,d,l){var h=this;if("currentSubGraph"===d){var Z=h.dm(),k=Z.__idMap;return k[L.__i]}return l.deserializeProperty(L,d,h)},setDefaultCursor:function(T,D){this._defaultCursor=T,D!==!1&&this.setCursor(T)},setCursor:function(U){"default"===U&&(U=this._defaultCursor||U);var W=this.getView().style;W.cursor=U,W.cursor="-webkit-"+U,W.cursor="-moz-"+U},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(F){return F===A||b.getConnectAction(null,F)?(this._currentActionType=F,this.redraw(),!0):!1},getEditStyle:function(G){var V=this.getEditInteractor();return V?V.getStyle(G):e},setEditStyle:function(U,H,h){var T=this.getEditInteractor();return T?(T.setStyle(U,H,h),!0):!1},isConnectActionVisible:function(m){var R=b.getConnectAction(this);if(!R)return!1;var $=R.visible;return Fd($)&&($=$(this,m)),$},isInteractive:function(n){if(this._drawForChecking)return!1;var j=Ef(this.getImage(n));return j&&_d(j.interactive,n,this)?!0:n.s("interactive")},appendHTML:function(H,Y){var j=this.getView();if(!(Y||H&&H.parentNode!==j))return!1;var m=H.getView&&H.getView();if(!Y&&m&&m.parentNode===j)return!1;(H.getView||H.isSelfViewEvent)&&(H=H.getView());var G=this.getEditInteractor();return G&&G._canvas?j.insertBefore(H,G._canvas):this.isScrollBarVisible()?j.insertBefore(H,this.getView().lastChild):Ho(j,H),!0},_layoutHTMLImpl:function(F,w,q){if(arguments.length>1){var Z,a=this,B=a._zoom;if(w.getView&&(Z=w,w=w.getView()),w.style.position="absolute",q){var z=F.getRect();di(Z||w,a.tx()+z.x*B,a.ty()+z.y*B,z.width*B,z.height*B)}else{var O=new Jq,z=F.getAnchorRect(),U=F.getPosition(),E=F.getScale(),n=w.style;di(Z||w,z),O.appendTranslate(a.tx(),a.ty()),O.appendScale(B,B),O.append(new Jq(F.getRotation(),U.x,U.y,E.x,E.y)),uq(n,"transform","matrix("+O.a.toFixed(5)+", "+O.b.toFixed(5)+", "+O.c.toFixed(5)+",\n    "+O.d.toFixed(5)+", "+O.tx.toFixed(5)+", "+O.ty.toFixed(5)+")"),uq(n,"transformOrigin",(-z.x).toFixed(5)+"px "+(-z.y).toFixed(5)+"px"),w.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(U){return U instanceof Nk?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(A){var G="state",H=A.s(G);if(H)return H;var I=Ef(A._image);return I?_d(I[G],A,this)||null:void 0},getShape:function(i){return i.getStyle(Mh)}}),N.defineProperties(Nl.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function($){this._layoutHTML=$}}});var Ej=function(G,i){var h=this;h.gv=G,h.s=function(e){return i.getStyle(e)},h._data=i,h._87I=new Tr};$g(Ej,N,{_6I:A,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var o=this,q=o.gv.isSelected(o._data);return!q||o.isShadowed()?0:o.gv.getSelectWidth(o._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(N){var l=this._data,i=this.gv.getBodyColor(l);return i?i:N?l.getStyle(N):A},_2Q:function($){return this.s($)},_1Q:function(m,N,K,g){var i=this.s,r=i("2d.gray"),E=i(N+".dash.color");if(r&&(E=b.toGrayColor(E)),m.strokeStyle=E,m.lineWidth=K,m.stroke(),i(N+".dash.3d")){var H=i(N+".dash.3d.color");Bs(m,E,r?b.toGrayColor(H):H,K,this.gv._zoom,i(N+".dash.3d.accuracy"))}Yd(m,g)},invalidate:function(){this._6I=A},_79o:function(){var J=this;if(!J._6I){var e=J._data,r=J.gv;J.labelInfo=J.label2Info=J.noteInfo=J.note2Info=J._38o=A,J._87I.clear(),J.interactiveInfo=r.isInteractive(e)?{}:A,J._3O(),J._55O=r.isEditable(e)?{_42O:r.isRectEditable(e),_43O:r.isPointEditable(e),_56O:r.isRotationEditable(e)}:A,J._6I=J._81o()}return J._6I},_3O:function(){},getPosition:function(){return on},_68o:function(l,J){l&&this._87I.add(Uh(l,J))},_81o:function(){var K=this,S=K.s;K._24O(ls,"getLabel"),K._24O(kd,"getLabel2"),K._26O(Up,"getNote"),K._26O(Ql,"getNote2"),K._15O(),K._55O&&K._48O();var t;if(K._87I.each(function(n){t=qh(t,n)}),t){var l=K.isShadowed(),q=S("shadow2"),I=Cc(t);q?(I.x+=S("shadow2.offset.x"),I.y+=S("shadow2.offset.y"),Qj(I,S("shadow2.blur"))):l&&(I.x+=S("shadow.offset.x"),I.y+=S("shadow.offset.y"),Qj(I,S("shadow.blur"))),t=qh(t,I)}return K._87I.clear(),t},_42:function(r){var R=this,y=R._data,u=R.gv,z=R.s,G=z("opacity"),C=this.isShadowed(),X=z("shadow2");if(C||X){var k=r.shadowOffsetX,J=r.shadowOffsetY,c=r.shadowBlur,S=r.shadowColor,E=u.getZoom(),x=C?"shadow":"shadow2";r.shadowOffsetX=z(x+".offset.x")*E,r.shadowOffsetY=z(x+".offset.y")*E,r.shadowBlur=z(x+".blur")*E,r.shadowColor=C?R.getSelectColor():z(x+".color")}if(G!=A){var o=r.globalAlpha;r.globalAlpha=G}R._80o(r),u.isLabelVisible(y)&&((!u._drawForChecking||z("label.selectable"))&&Hb(r,R.labelInfo),(!u._drawForChecking||z("label2.selectable"))&&Hb(r,R.label2Info)),u.isNoteVisible(y)&&(Wm(r,R.noteInfo),Wm(r,R.note2Info)),R._99O(r),G!=A&&(r.globalAlpha=o),(C||X)&&(r.shadowOffsetX=k,r.shadowOffsetY=J,r.shadowBlur=c,r.shadowColor=S)},_80o:function(){},_47O:function(){},_24O:function(j,N){var z=this,V=z._data,F=z.gv,T=z.s,Z=F[N](V);if(Z!=A){var I=T(j+".scale"),t=T(j+".max"),E=T(j+".position"),p=z[j+"Info"]={label:Z,scale:I,color:F[N+"Color"](V),font:T(j+".font"),opacity:T(j+".opacity"),align:T(j+".align"),rotation:z.getRotation(T(j+".rotation"),!1,E),background:F[N+"Background"](V)},D=an(p,Z);t>0&&t<D.width&&(p.labelWidth=D.width,D.width=t),1!==I&&(D.width*=I,D.height*=I);var c=z.getPosition(E,T(j+".offset.x"),T(j+".offset.y"),D,T(j+".position.fixed"));if(D.x=c.x-D.width/2,D.y=c.y-D.height/2,z._68o(p.rect=D,p.rotation),1!==I){var H=D.width/I,m=D.height/I;p.rect={x:c.x-H/2,y:c.y-m/2,width:H,height:m}}}},_26O:function(U,j){var R=this,p=R.gv,b=R._data,$=R.s,T=p[j](b);if(T!=A){var W,h,v=$(U+".scale"),N=R[U+"Info"]={note:T,scale:v,data:b,view:p,expanded:$(U+".expanded"),font:$(U+".font"),color:$(U+".color"),opacity:$(U+".opacity"),align:$(U+".align"),icon:$(U+".icon"),backgroundImage:$(U+".backgroundImage"),borderWidth:$(U+".border.width"),borderColor:$(U+".border.color"),background:p[j+"Background"](b)},l=R.getPosition($(U+".position"),$(U+".offset.x"),$(U+".offset.y")),L=l.x,Y=l.y;if(N.expanded){var I,q=$(U+".max"),z=$(U+".backgroundImage");z?(z=Ef(z),I={width:pl(z,b),height:Vf(z,b)}):I=an(N,T),I.width+=6,I.height+=2,q>0&&q<I.width&&(N.labelWidth=I.width,I.width=q),W=I.width,h=I.height+8,N.clickRect={x:L-W*v/2,y:Y-h*v,width:W*v,height:h*v*I.height/h}}else{var w=$(U+".icon");w?(w=Ef(w),W=pl(w,b),h=Vf(w,b)):(W=12,h=18),N.clickRect={x:L-W*v/2,y:Y-h*v,width:W*v,height:h*v}}N.rect={x:L-W/2,y:Y-h*v/2-h/2,width:W,height:h};var s=m(N.borderWidth/2)*v;R._68o({x:L-W*v/2-s,y:Y-h*v-s,width:W*v+2*s,height:h*v+2*s})}},_48O:function(){},_99O:function(b){var i=this,j=i._38o;if(j){var L=i.gv,N=i._data,v=j.icons,f=i.interactiveInfo;f&&(f._38o={});for(var S in v){var B=v[S],I=j.rects[S];if(I){f&&(f._38o[S]=[]);var V=_d(B.opacity,N,L),x=_d(B.names,N,L),X=x?x.length:0,t=I.rotation;if(V!=A){var r=b.globalAlpha;b.globalAlpha*=V}for(var Y=0;X>Y;Y++){var M=x[Y],y=Ef(M),o=I[Y];if(t){var _=o.x+o.width/2,W=o.y+o.height/2;b.save(),Xf(b,_,W),jb(b,t),Xf(b,-_,-W)}f&&f._38o[S].push(b.interactiveInfo={compInfos:[],matrix:t?new Jq(t,_,W).appendTranslate(-_,-W):new Jq}),Pf(b,y,_d(B.stretch,N,L),o.x,o.y,o.width,o.height,i._data,i.gv),b.interactiveInfo=A,t&&b.restore()}V!=A&&(b.globalAlpha=r)}}}}});var op=function(d,D){yf(op,this,[d,D])};$g(op,Ej,{_checkEmptyRect:!0,_40O:function(V,Y){var G=this,l=G.s,x=V.rect;(V.borderColor=G.gv.getBorderColor(G._data))&&(V.borderType=l("border.type"),V.borderWidth=l("border.width"),V.borderPadding=l("border.padding"),Y=a(Y,V.borderPadding+V.borderWidth/2));var R=G._data.getScale(),b=a(1,a(T(R.x),T(R.y)));if(V.selectWidth=G.getSelectWidth()){var J=G.gv._zoom;V.selectType=l("select.type"),V._97o=G.getSelectColor(),V.selectPadding=l("select.padding"),Y=a(Y,(V.selectPadding+V.selectWidth/2/J)/b)}Y>0&&(Y*=b,x=Cc(x),Qj(x,Y)),G._68o(x)},_39O:function(F,E){var w,r=this,p=E.rect;if(E.borderWidth>0&&(w=E.borderPadding,F.strokeStyle=E.borderColor,F.lineWidth=E.borderWidth,yl(F,E.borderType,{x:p.x-w,y:p.y-w,width:p.width+2*w,height:p.height+2*w}),F.stroke()),E.selectWidth>0){var y=r.gv._zoom;if(w=E.selectPadding,F.strokeStyle=E._97o,F.lineWidth=E.selectWidth/y,E.rotation!=A){F.save(),F.translate(E.position.x,E.position.y),F.rotate(E.rotation);var J=r._data,h=J.getWidth(),N=J.getHeight(),d=E.scale,D=E.anchor;p={x:d.x*-h*D.x,y:d.y*-N*D.y,width:d.x*h,height:d.y*N}}yl(F,E.selectType,{x:p.x-w,y:p.y-w,width:p.width+2*w,height:p.height+2*w}),E.rotation!=A&&F.restore(),F.stroke()}},dispose:function(){var V=this,_=V._htmlView;op.superClass._3O.call(V),_&&(_.onHTMLRemoved&&_.onHTMLRemoved(),Sc(_))},_3O:function(){var J=this,o=J.s,Y=J._data,D=J.gv,y=D.getShape(Y),c=J.getBodyColor(),l=J._83o=y?{shape:y,_53o:J.getBodyColor("shape.background"),_27Q:Ef(o("shape.repeat.image"),c),shapeGradientPack:o("shape.gradient.pack"),_54o:o("shape.border.width"),_55o:o("shape.border.color"),_56o:o("shape.border.3d"),_57o:o("shape.border.3d.color"),_58o:o("shape.border.3d.accuracy"),shapeGradient:o("shape.gradient"),_59o:o("shape.gradient.color"),_60o:o("shape.border.pattern"),_61o:o("shape.border.cap"),_62o:o("shape.border.join"),shapeForeground:o("shape.foreground"),bodyColor:c,gray:o("2d.gray")}:{img:Ef(D.getImage(Y),c),bodyColor:c,gray:o("2d.gray"),stretch:o("image.stretch")};if(H&&!s);else{var U,g=l.img;g&&g.renderHTML?(J._htmlInfo&&J._htmlInfo.img!==g&&(J._htmlInfo=A),J._htmlInfo||(J._htmlInfo={img:g,cache:{}}),U=g.renderHTML(Y,D,J._htmlInfo.cache)):J._htmlInfo=A,J._htmlView&&J._htmlView!==U&&(J._htmlView.onHTMLRemoved&&J._htmlView.onHTMLRemoved(),Sc(J._htmlView.getView?J._htmlView.getView():J._htmlView)),(J._htmlView=U)&&D.appendHTML(U)&&(U.onHTMLAddedSync&&U.onHTMLAddedSync(),U.onHTMLAdded&&Wg(U.onHTMLAdded)),l.rect=Y.getRect(),l.position=Y.p(),l.scale=Y.getScale(),l.anchor=Y.getAnchor(),l.rotation=Y.getRotation(),y===Dl&&(l._63o=o("shape.depth"));var p=0;if(y)p=vn(A,l._54o/2,l._62o),J.s("shape.dash")&&(p=a(p,(J.s("shape.dash.width")||l._54o)/2));else if(g&&g.boundExtend)if(p=_d(g.boundExtend,Y,D),g.boundExtendAbsolute){var N=Y.getScale();p/=D._zoom*a(1,a(T(N.x),T(N.y)))}else if(!_d(g.fitSize,Y,D)){var V=_d(g.width,Y,D),d=_d(g.height,Y,D);p*=a(Y.getWidth()/V,Y.getHeight()/d)}J._40O(l,p);var P=o("clip.percentage");if(1>P&&(0>P&&(P=0),l.clipRect=jo(Y.getAnchorRect(),o("clip.direction"),P)),y){var j=o("shape.fill.clip.percentage");1>j&&(0>j&&(j=0),l.shapeClipRect=jo(Y.getAnchorRect(),o("shape.fill.clip.direction"),j));var S=o("shape.foreground.clip.percentage");1>S&&(0>S&&(S=0),l.shapeForegroundClipRect=jo(Y.getAnchorRect(),o("shape.foreground.clip.direction"),S))}}},getPosition:function(j,a,Z,P){var W=Ne(j,this._83o.rect,P);return W.x+=a,W.y+=Z,W},_80o:function(T){var p=this,U=p.s,g=p.gv,z=p._data,u=p._83o,y=u.rect,R=u.position,l=u.rotation,k=u.anchor,S=u.scale,s=u.shape,H=u.clipRect;if(!p._checkEmptyRect||y.width>0&&y.height>0){var K=z.getSize();if(K.x=-K.width*k.x,K.y=-K.height*k.y,T.save(),Xf(T,R.x,R.y),jb(T,l),Jp(T,S.x,S.y),H&&(T.beginPath(),T.rect(H.x,H.y,H.width,H.height),T.clip()),g._drawForChecking&&u.img&&_d(u.img.pixelPerfect,z,g)===!1)ld(T,K.x,K.y,K.width,K.height,"#888888");else if(p.freeDraw)p.freeDraw(T,K,u);else if(s){var f,Q,G,_,L=u._60o,I=Zd(T,L),i=u._27Q,c=u._54o,W=u.shapeGradientPack,B=u.gray,n=T.lineJoin,V=T.lineCap,o=function(A){return B?b.toGrayColor(A):A};"roundRect"===s?f=U("shape.corner.radius"):"polygon"===s?f=U("shape.polygon.side"):"arc"===s&&(f=U("shape.arc.from"),Q=U("shape.arc.to"),G=U("shape.arc.close"),_=U("shape.arc.oval")),T.lineJoin=u._62o,T.lineCap=u._61o;var J=o(u._53o);if(J||i||W){var x=u.shapeClipRect;x&&(T.save(),T.beginPath(),T.rect(x.x,x.y,x.width,x.height),T.clip()),yl(T,s,K,f,Q,G,_),W?Tc(T,W):i?Vp(T,i,o(u.bodyColor),null,z,g):bn(T,J,u.shapeGradient,o(u._59o),K),T.fill(),x&&T.restore(),W&&T.restore(),T!==I&&yl(I,s,K,f,Q,G,_)
}else yl(I,s,K,f,Q,G,_);var Y=u.shapeForeground;if(Y){T.save();var e=u.shapeForegroundClipRect;e&&(T.beginPath(),T.rect(e.x,e.y,e.width,e.height),T.clip()),yl(T,s,K,f,Q,G,_),bn(T,Y,U("shape.foreground.gradient"),o(U("shape.foreground.gradient.color")),K),T.fill(),T.restore()}if(c>0){var h=U("shape.border.width.absolute");h&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=c;var E=o(u._55o);T.strokeStyle=E,T.stroke(),h&&T.restore(),u._56o&&Bs(T,E,o(u._57o),c,g._zoom,u._58o)}if(Yd(T,L),U("shape.dash")){var Z=U("shape.dash.width")||c;if(Z>0){L=U("shape.dash.pattern");var I=Zd(T,L,p._2Q("shape.dash.offset"));I!==T&&yl(I,s,K,f,Q,G,_),p._1Q(T,"shape",Z,L)}}Eg(T,J,u._63o,K),T.lineJoin=n,T.lineCap=V}else{var F=p.interactiveInfo;F&&(T.interactiveInfo=F.bodyInfo={compInfos:[],matrix:new Jq(l,R.x,R.y,S.x,S.y)}),u.gray&&(T.compGray=!0);var D=u.img;D&&D.cacheRule!=A&&(D=to(T,D,u.stretch,K.width,K.height,z,g,u.bodyColor)),Pf(T,D,u.stretch,K.x,K.y,K.width,K.height,z,g,u.bodyColor),T.compGray=!1,T.interactiveInfo=A}T.restore()}p._39O(T,u)},_48O:function(){},_47O:function(){}});var wc=function(n,g){yf(wc,this,[n,g])},Lp=function(x,l,n,r){var o=np(x,l);return n=r?C(n,o):Qh(n,o),o?n/=o:n=0,{x:x.x+(l.x-x.x)*n,y:x.y+(l.y-x.y)*n}};$g(wc,Ej,{_3O:function(){var L,E=this,x=E._data,P=E.gv,h=E.s,t=h(km),G=x.isLooped(),D=h("edge.width"),j=h("edge.center"),I=h("edge.offset"),R=P.getBorderColor(x),u=R?h("border.width"):0,v=E.getSelectWidth(),V=x._40I,k=x._41I,C=E._78o=V&&k?{looped:G,type:t,width:D,center:j,color:E.getBodyColor("edge.color"),borderColor:R,borderWidth:u,_97o:v?E.getSelectColor():A,selectWidth:v,pattern:h("edge.pattern"),cap:h("edge.cap"),join:h("edge.join"),is3d:h("edge.3d"),_67o:h("edge.3d.color"),_66o:h("edge.3d.accuracy"),gray:h("2d.gray")}:A;if(C){var X=b.getEdgeType(t);if(X){var Z=X(x,nm(E,P,x,G,t),P,E._19Q);Z.points&&Z.points.size()>1?(C.edgeTypeInfo=Z,L=mo(C.edgeTypeInfo.points)):Z[Tb]&&Z.rect&&(C.edgeTypeInfo=Z,L=Z.rect)}else{var T=h("edge.source.anchor.x"),c=h("edge.source.anchor.y"),i=h("edge.target.anchor.x"),U=h("edge.target.anchor.y"),y=gd(P,x,"source"),B=gd(P,x,"target");if(t===od){var d=C.points=h(Ai)||$n,f=d.size();C.segments=h("edge.segments");var N=T!==e||c!==e||cn(V),g=i!==e||U!==e||cn(k);if(!j)if(I)N||(y=Lp(y,f?d.get(0):B,I,f)),g||(B=Lp(B,f?d.get(f-1):y,I,f));else{var W;N||(W=Ff(y,f?d.get(0):B,kb(P,V)),W&&(y={x:W[0],y:W[1]})),g||(W=Ff(f?d.get(f-1):y,B,kb(P,k)),W&&(B={x:W[0],y:W[1]}))}L=qh(mo(C.points),mo(y,B))}else{var H=nm(E,P,x,G,t);if(E._19Q||(H=-H),G)y=Cc(y),y.x=P.getNodeRect(V).x,C.radius=H,L={x:y.x-H,y:y.y-H,width:2*H,height:2*H};else{var Q=np(y,B),l=Qh(I,Q),$={x:l,y:H},Y={x:Q-l,y:H},p=o(B.y-y.y,B.x-y.x),s=C.mat=new md(p);if(C.orienAngle=p,C.angle=B.x<y.x?p+O:p,C.rect={x:$.x,y:$.y,width:Y.x-$.x,height:0},C.origin=y,$=s.tf($),$.x+=y.x,$.y+=y.y,Y=s.tf(Y),Y.x+=y.x,Y.y+=y.y,j){var q={x:Q,y:0};q=s.tf(q),q.x+=y.x,q.y+=y.y,L=mo([y,$,Y,q]),C.c1=y,C.c2=q}else L=mo($,Y);y=$,B=Y}}C.sourcePoint=y,C.targetPoint=B,x._lastSourcePoint=y,x._lastTargetPoint=B}var J=0;h("edge.dash")&&(J=h("edge.dash.width")||D);var z="square"===C.cap?.71:.5;vn(L,a(J*z,D*z+u+v),C.join),E._68o(L)}},getRotation:function(u,b,t){u=u||0;var C=this._78o;if(C){var B,E=C.angle,N=C.points,D=C.edgeTypeInfo;if(E!=A)return b?C.orienAngle+u:E+u;if(D&&D[Tb])return D.getRotation?D.getRotation(this,u,b,t):0;if(D&&D.points){var G=D.points;return B=G.size(),go[t]?B&&0===B%2?ff(G.get(B/2-1),G.get(B/2),b,u):u:sd[t]?ff(G.get(0),G.get(1),b,u):ff(G.get(B-2),G.get(B-1),b,u)}if(N)return B=N.size(),go[t]?B&&0===B%2?ff(N.get(B/2-1),N.get(B/2),b,u):u:sd[t]?ff(C.sourcePoint,B?N.get(0):C.targetPoint,b,u):ff(B?N.get(B-1):C.sourcePoint,C.targetPoint,b,u)}return u},getPosition:function(j,z,M,o,f){var s=this._78o;if(s){var O,q=s.type,y=s.points,u=s.edgeTypeInfo,E=s.sourcePoint,K=s.targetPoint;if(!q)return s.looped?{x:E.x-s.radius+z,y:E.y+M}:(f&&E&&K&&(E.x>K.x||E.x===K.x&&E.y>K.y)&&(j=sr[j],M=-M),O=Ne(j,s.rect,o),O.x+=z,O.y+=M,O=s.mat.tf(O),O.x+=s.origin.x,O.y+=s.origin.y,O);if(u&&u[Tb])return u.getPosition?u.getPosition(this,j,z,M,o,f):{x:(E.x+K.x)/2,y:(E.y+K.y)/2};if(y){var O,c=y.size();if(go[j]){if(c){var e=c%2;if(0===e)return Yn(y.get(c/2-1),y.get(c/2),j,z,M,o,f);O=y.get((c-e)/2)}else O={x:(E.x+K.x)/2,y:(E.y+K.y)/2};return O=Ne(j,{x:O.x,y:O.y,width:0,height:0},o),O.x+=z,O.y+=M,O}return sd[j]?Yn(E,c?y.get(0):K,j,z,M,o,f):Yn(c?y.get(c-1):E,K,j,z,M,o,f)}if(u){var g=u.points,c=g.size();if(go[j]){var e=c%2;return 0===e?Yn(g.get(c/2-1),g.get(c/2),j,z,M,o,f):(O=g.get((c-e)/2),O=Ne(j,{x:O.x,y:O.y,width:0,height:0},o),O.x+=z,O.y+=M,O)}return sd[j]?Yn(g.get(0),g.get(1),j,z,M,o,f):Yn(g.get(c-2),g.get(c-1),j,z,M,o,f)}}return on},_42:function(P){this._78o&&wc.superClass._42.call(this,P)},drawPath:function(C,K){C.beginPath();var F=K.type,J=K.points,Z=K.segments,d=K.edgeTypeInfo;if(!F||J){var L=K.sourcePoint,c=L.x,I=L.y,$=K.targetPoint,R=$.x,i=$.y;if(F)if(Z){var u=new Tr({x:c,y:I});u.addAll(J),u.add({x:R,y:i}),xh(C,u,Z)}else C.moveTo(c,I),J.each(function(M){C.lineTo(M.x,M.y)}),C.lineTo(R,i);else K.looped?C.arc(c,I,K.radius,0,U,!0):K.center?(C.moveTo(K.c1.x,K.c1.y),C.lineTo(c,I),C.lineTo(R,i),C.lineTo(K.c2.x,K.c2.y)):(C.moveTo(c,I),C.lineTo(R,i))}else d&&(d.points?xh(C,d.points,d.segments):d[Tb]&&d[Tb](C,d))},_80o:function(N){var a=this,i=a.s,B=a._78o,S=B.width,j=B.selectWidth,D=B.borderWidth,q=N.lineJoin,l=N.lineCap,P=B.gray,Z=B.pattern;N.lineJoin=B.join,N.lineCap=B.cap,a.drawPath(Zd(N,Z),B);var n=i("edge.width.absolute");n&&(N.save(),N.setTransform(1,0,0,1,0,0)),j&&(N.strokeStyle=B._97o,N.lineWidth=S+2*(D+j),N.stroke()),D&&(N.strokeStyle=P?b.toGrayColor(B.borderColor):B.borderColor,N.lineWidth=S+2*D,N.stroke());var t=P?b.toGrayColor(B.color):B.color,F=P?b.toGrayColor(B._67o):B._67o;if(N.strokeStyle=t,N.lineWidth=S,N.stroke(),B.is3d&&Bs(N,t,F,S,a.gv._zoom,B._66o),Yd(N,Z),i("edge.dash")){Z=i("edge.dash.pattern");var w=Zd(N,Z,a._2Q("edge.dash.offset"));w!==N&&a.drawPath(w,B),a._1Q(N,"edge",i("edge.dash.width")||S,Z)}n&&N.restore(),N.lineJoin=q,N.lineCap=l},_48O:function(){},_47O:function(){}});var Dq=function(V,j){yf(Dq,this,[V,j])};$g(Dq,op,{_3O:function(){var D,N,E=this,T=E.s,B=E._data,f=E.gv;if(E._88I=A,B.isExpanded()&&B.eachChild(function(q){if($o(q)){var x=f.getBoundsForGroup(q);x&&(N||(N=[]),N.push(x),D=qh(D,x))}}),D){var e=f.getLabel(B),r=T("group.type"),Q=T("group.border.width")||0,x=T("group.border.width.absolute"),v=Q/2;x&&(Q/=f._zoom),D=hk(r,N,D),gr(D,B,"group.padding",1),Qj(D,Q);var u=E._88I={type:r,rect:D,_64o:D};if(!r&&e!=A){var I,X=E.labelInfo={label:e,color:T("group.title.color"),font:T("group.title.font"),align:T("group.title.align")},d=an(X,e),o=d.width+Q,P=d.height+Q,C=T("group.title.align"),M=T("group.title.orientation");if(M===Oe||M===fl?(D.height+=Q,o>D.width&&(D.width=o)):(M===Rc||M===Pc)&&(D.width+=Q,o>D.height&&(D.height=o)),I=C===Rc?D.x:C===Pc?D.x+D.width-o:D.x+D.width/2-o/2,M===fl)u.titleRect={x:D.x,y:D.y+D.height,width:D.width,height:P},u.rect={x:D.x,y:D.y,width:D.width,height:D.height+P},X.rect={x:I,y:D.y+D.height,width:o,height:P};else if(M===Rc){var Y=u.titleRect={x:D.x-P,y:D.y,width:P,height:D.height};u.rect={x:D.x-P,y:D.y,width:D.width+P,height:D.height},X.rect={x:Y.x+P/2-D.height/2,y:Y.y+D.height/2-P/2,width:D.height,height:P},X.rotation=-Math.PI/2}else if(M===Pc){var Y=u.titleRect={x:D.x+D.width,y:D.y,width:P,height:D.height};u.rect={x:D.x,y:D.y,width:D.width+P,height:D.height},X.rect={x:Y.x+P/2-D.height/2,y:Y.y+D.height/2-P/2,width:D.height,height:P},X.rotation=Math.PI/2}else u.titleRect={x:D.x,y:D.y-P,width:D.width,height:P},u.rect={x:D.x,y:D.y-P,width:D.width,height:D.height+P},X.rect={x:I,y:D.y-P-v,width:o,height:P+Q}}E._40O(u,T("group.border.width")/2)}else Dq.superClass._3O.call(E)},getPosition:function(U,S,D,E){var P=this._88I;if(P){var x=Ne(U,P.rect,E);return x.x+=S,x.y+=D,x}return Dq.superClass.getPosition.apply(this,arguments)},_24O:function(u,$){var t=this._88I;(!t||t.type||"label2"===u)&&Dq.superClass._24O.call(this,u,$)},_80o:function(A){var M=this,u=M._88I;if(u){var g=M._data,c=M.s,o=M.gv,K=u.type,f=u.rect,O=u._64o,y=u.titleRect,R=M.getBodyColor(),$=Ef(c("group.image"),R),B=c("group.image.stretch"),d=M.getBodyColor("group.background"),q=Ef(c("group.repeat.image"),R),v=c("group.gradient.pack"),z=c("group.gradient"),V=c("group.gradient.color"),J=c("group.border.width"),H=c("group.border.color"),T=c("group.border.pattern"),L=c("group.title.orientation"),C=c("group.depth"),l=c("group.border.radius"),s=c("group.border.join"),N=c("group.border.cap"),n=c("group.border.width.absolute");if(n&&(J/=o._zoom),K){var r=A.lineJoin,i=A.lineCap;if(A.lineJoin=s,A.lineCap=N,$){if(A.save(),yl(A,K,f,l),A.clip(),Pf(A,$,B,f.x,f.y,f.width,f.height,g,o,R),A.restore(),J>0){var U=Zd(A,T);yl(U,K,f,l),A.lineWidth=J,A.strokeStyle=H,A.stroke(),Yd(A,T)}}else{var U=Zd(A,T);d||q||v?(yl(A,K,f,l),v?Tc(A,v):q?Vp(A,q,R,null,g,o):bn(A,d,z,V,f),A.fill(),v&&A.restore(),A!==U&&yl(U,K,f,l)):yl(U,K,f,l),J>0&&(A.lineWidth=J,A.strokeStyle=c("group.border.color"),A.stroke()),Yd(A,T),K===Dl&&Eg(A,d,C,f)}A.lineJoin=r,A.lineCap=i}else{var j=c("group.title.background");if((!l||0>l)&&(l=0),$)Pf(A,$,B,O.x,O.y,O.width,O.height,g,o,M.getBodyColor());else if(d||q)if(q?Vp(A,q,R,null,g,o):bn(A,d,z,V,O),0===J)yl(A,Dl,O),A.fill(),Eg(A,d,C,O);else{switch(A.beginPath(),L){case fl:Cd(A,O.x,O.y,O.width,O.height,l,l,0,0);break;case Rc:Cd(A,O.x,O.y,O.width,O.height,0,l,0,l);break;case Pc:Cd(A,O.x,O.y,O.width,O.height,l,0,l,0);break;case Oe:Cd(A,O.x,O.y,O.width,O.height,0,0,l,l)}A.fill()}if(y&&j)if(0===J)ld(A,y.x,y.y,y.width,y.height,j),Eg(A,j,C,y);else{switch(A.beginPath(),A.fillStyle=j,L){case fl:Cd(A,y.x,y.y,y.width,y.height,0,0,l,l);break;case Rc:Cd(A,y.x,y.y,y.width,y.height,l,0,l,0);break;case Pc:Cd(A,y.x,y.y,y.width,y.height,0,l,0,l);break;case Oe:Cd(A,y.x,y.y,y.width,y.height,l,l,0,0)}A.fill()}if(J>0){var U=Zd(A,T);if(yl(U,"roundRect",f,l),A.save(),A.lineWidth=J,A.strokeStyle=H,A.lineJoin=s,A.lineCap=N,A.closePath(),A.stroke(),y&&c("group.splitLine")){var I=y.x,Q=y.y,t=y.width,W=y.height;A.beginPath(),L===fl?(A.moveTo(I,Q),A.lineTo(I+t,Q)):L===Rc?(A.moveTo(I+t,Q),A.lineTo(I+t,Q+W)):L===Pc?(A.moveTo(I,Q),A.lineTo(I,Q+W)):(A.moveTo(I,Q+W),A.lineTo(I+t,Q+W))}A.stroke(),A.restore(),Yd(U,T)}}M._39O(A,u)}else Dq.superClass._80o.call(M,A)}});var sq=function(g,L){yf(sq,this,[g,L])};$g(sq,op,{_80o:function(D){this._39O(D,this._83o)}});var vq=function(L,f){yf(vq,this,[L,f])};$g(vq,op,{_3O:function(){var f=this,D=f._data,H=f.s,v=f.gv,r=D.getPoints(),o=v.getBorderColor(D),m=o?H("border.width"):0,F=f.getSelectWidth(),O=H("shape.border.width"),N=D.getRect(),z=D.getAnchorRect(),E=v.getBodyColor(D),t=f._99o=r.isEmpty()?A:{rect:N,rotation:D.getRotation(),fillRule:H("shape.fill.rule"),scale:D.getScale(),position:D.p(),points:r,segments:D.getSegments(),bodyColor:E,borderColor:o,borderWidth:m,_94o:H("shape.border.3d"),_95o:H("shape.border.3d.color"),_96o:H("shape.border.3d.accuracy"),_97o:F?f.getSelectColor():A,selectWidth:F,_53o:H("shape.background"),_27Q:Ef(H("shape.repeat.image"),E),shapeGradientPack:H("shape.gradient.pack"),_54o:O,_55o:H("shape.border.color"),shapeGradient:H("shape.gradient"),_59o:H("shape.gradient.color"),_60o:H("shape.border.pattern"),_61o:H("shape.border.cap"),_62o:H("shape.border.join"),shapeForeground:H("shape.foreground"),gray:H("2d.gray")};if(t){z.x+=t.position.x,z.y+=t.position.y,t.gradientRect=z;var e=D.getScale(),Y=a(1,a(T(e.x),T(e.y)));H("shape.dash")&&H("shape.dash.width")>O&&(O=H("shape.dash.width"));var p,n=H("shape.border.width.absolute");p=n?(O+m+F)/f.gv._zoom/Y:O*("square"===t._61o?.71:.5)+m+F/f.gv._zoom/Y,p&&(p*=Y,N=Cc(N),vn(N,p,t._62o)),f._68o(N);var W=H("clip.percentage");1>W&&(0>W&&(W=0),t.clipRect=jo(D.getAnchorRect(),H("clip.direction"),W));var x=H("shape.fill.clip.percentage");1>x&&(0>x&&(x=0),t.shapeClipRect=jo(D.getAnchorRect(),H("shape.fill.clip.direction"),x));var V=H("shape.foreground.clip.percentage");1>V&&(0>V&&(V=0),t.shapeForegroundClipRect=jo(D.getAnchorRect(),H("shape.foreground.clip.direction"),V))}},getPosition:function(o,t,A,Y){var L=this._99o;if(L){var B=Ne(o,L.rect,Y);return B.x+=t,B.y+=A,B}return on},_42:function(W){this._99o&&vq.superClass._42.call(this,W)},_80o:function(W){var L,p=this,B=p.s,h=p._99o,F=h.position,s=h.scale,e=h.rotation,x=h.borderWidth,g=h.selectWidth/p.gv._zoom,P=h._27Q,q=h.shapeGradientPack,Z=h._54o,o=h.clipRect,H=h.shapeClipRect,r=h.points,d=h.segments,m=p._data.isClosePath(),I=h.fillRule,Y=h.gray,v=function(N){return Y?b.toGrayColor(N):N},u=v(h._53o),K=u||P||q;W.save(),Xf(W,F.x,F.y),jb(W,e),Jp(W,s.x,s.y),o&&(W.beginPath(),W.rect(o.x,o.y,o.width,o.height),W.clip()),K&&H&&(W.save(),W.beginPath(),W.rect(H.x,H.y,H.width,H.height),W.clip()),Xf(W,-F.x,-F.y);var S=h._60o,i=Zd(W,S),C=W.lineJoin,E=W.lineCap;W.lineJoin=h._62o,W.lineCap=h._61o;var D=v(h.bodyColor);K?(xh(W,r,d,m),q?Tc(W,q):P?Vp(W,P,D,null,p._data,p.gv):(L=D?D:u,bn(W,L,h.shapeGradient,v(h._59o),h.gradientRect)),W.fill(I),H&&(W.restore(),Xf(W,-F.x,-F.y)),q&&W.restore(),i!==W&&xh(i,r,d,m)):xh(i,r,d,m);var $=h.shapeForeground;if($){W.save();var U=h.shapeForegroundClipRect;U&&(Xf(W,F.x,F.y),W.beginPath(),W.rect(U.x,U.y,U.width,U.height),W.clip(),Xf(W,-F.x,-F.y)),xh(W,r,d,m),bn(W,$,B("shape.foreground.gradient"),v(B("shape.foreground.gradient.color")),h.gradientRect),W.fill(I),W.restore()}var n=B("shape.border.width.absolute");if(n&&(W.save(),W.setTransform(1,0,0,1,0,0)),g&&(W.strokeStyle=h._97o,W.lineWidth=Z+2*(x+g),W.stroke()),x&&(W.strokeStyle=v(h.borderColor),W.lineWidth=Z+2*x,W.stroke()),Z&&(L=v(h._55o),!u&&D&&(L=D),W.strokeStyle=L,W.lineWidth=Z,W.stroke(),h._94o&&Bs(W,L,v(h._95o),Z,p.gv._zoom,h._96o)),Yd(W,S),B("shape.dash")){var j=B("shape.dash.width")||Z;if(j>0){S=B("shape.dash.pattern");var i=Zd(W,S,p._2Q("shape.dash.offset"));i!==W&&xh(i,r,d,m),p._1Q(W,"shape",j,S)}}n&&W.restore(),W.lineJoin=C,W.lineCap=E,W.restore()},_48O:function(){},_47O:function(){}});var nh=function(G,e){yf(nh,this,[G,e])};$g(nh,vq,{getRotation:function(y,n,$){y=y||0;var X=this._data.getPoints(),g=X.size();return g>1?go[$]?g&&0===g%2?ff(X.get(g/2-1),X.get(g/2),n,y):y:sd[$]?ff(X.get(0),X.get(1),n,y):ff(X.get(g-2),X.get(g-1),n,y):y},getPosition:function(S,W,v,w,q){var a=this._data.getPoints(),t=a.size();if(t>1){if(go[S]){var C=t%2;if(0===C)return Yn(a.get(t/2-1),a.get(t/2),S,W,v,w,q);var R=a.get((t-C)/2),$={x:R.x,y:R.y,width:0,height:0};return R=Ne(S,$,w),R.x+=W,R.y+=v,R}return sd[S]?Yn(a.get(0),a.get(1),S,W,v,w,q):Yn(a.get(t-2),a.get(t-1),S,W,v,w,q)}return on}});var Vl=function(N,w){yf(Vl,this,[N,w])};$g(Vl,op,{_3O:function(){var D=this;Vl.superClass._3O.call(D);var p=D.s,T=D._83o;D._82o=T.img||T.shape?A:{background:D.getBodyColor("grid.background"),depth:p("grid.depth"),rect:T.rect,_88o:p("grid.cell.depth"),cellBorderColor:p("grid.cell.border.color"),_89o:p("grid.row.count"),_90o:p("grid.column.count"),block:p("grid.block"),_91o:p("grid.block.color"),_92o:p("grid.block.padding"),_93o:p("grid.block.width")}},_80o:function(h){var z=this,q=z._82o;if(!q)return Vl.superClass._80o.call(z,h),void 0;var L,n,A=z._data,v=q.background,F=q.rect,x=q.block,D=q._91o,y=q._92o,M=q._93o,K=q._88o,t=q.cellBorderColor,g=q._89o,J=q._90o;if(v)if(ld(h,F.x,F.y,F.width,F.height,v),Eg(h,v,q.depth,F),K)for(L=0;g>L;L++)for(n=0;J>n;n++)F=A.getCellRect(L,n),F&&Eg(h,v,K,F);else if(t){for(h.beginPath(),L=0;g>L;L++)for(n=0;J>n;n++)F=A.getCellRect(L,n),F&&h.rect(F.x,F.y,F.width,F.height);h.strokeStyle=t,h.lineWidth=1,h.stroke()}if("h"===x)for(L=0;g>L;L++)F=qh(A.getCellRect(L,0),A.getCellRect(L,J-1)),Qj(F,y),Yf(h,D,F.x,F.y,F.width,F.height,M);else if("v"===x)for(n=0;J>n;n++)F=qh(A.getCellRect(0,n),A.getCellRect(g-1,n)),Qj(F,y),Yf(h,D,F.x,F.y,F.width,F.height,M);z._39O(h,z._83o)}});var Zl=function(u,B){yf(Zl,this,[u,B])};$g(Zl,op,{_checkEmptyRect:!1,_81o:function(){var G=this._data,t=Zl.superClass._81o.call(this),e=G.s("text");if(e!=A){var M,W,B=G.s("text.font"),w=G.s("text.align"),n=G.s("text.vAlign"),L=Io(B,e),l=L.width,$=L.height,f=G.getAnchor(),v=G.getWidth(),u=G.getHeight();"left"===w?M=-v*f.x:"center"===w?M=-v*f.x+(v-l)/2:"right"===w&&(M=v*(1-f.x)-L.width),"top"===n?W=-u*f.y:"middle"===n?W=-u*f.y+(u-$)/2:"bottom"===n&&(W=u*(1-f.y)-L.height);var i,d=G.getMatrix();if(i=mo([d.tf(M,W),d.tf(M+l,W),d.tf(M+l,W+$),d.tf(M,W+$)]),t=qh(t,i),t&&G.s("text.shadow")){var N=Cc(t);N.x+=G.s("text.shadow.offset.x"),N.y+=G.s("text.shadow.offset.y"),Qj(N,G.s("text.shadow.blur")),t=qh(t,N)}}return t}});var Il=Nl.Interactor=function(n){this.gv=this._graphView=n};Of("Interactor",N,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(y){this.gv.fi(y)},setCursor:function(B){tc||this.gv.setCursor(B)},startDragging:function(Q){var K=this;K._lastClientPoint=nq(Q),K._lastLogicalPoint=K.gv.lp(Q),qf(K,Q)},clearDragging:function(){var E=this;E._lastClientPoint=E._lastLogicalPoint=E._logicalPoint=A},autoScroll:function(u){return this.gv.autoScroll(u,this._lastClientPoint)}});var Ig=A,Fn=function(E){Ig.handleWindowTouchMove(E)},Yc=function(m){Ig.handleWindowTouchEnd(m),B(_,vh,Fn),B(_,is,Yc),Ig=A},Hc=function(X){Ig.handleWindowMouseMove(X)},of=function(H){Ig.handleWindowMouseUp(H),B(_,xq,Hc),B(_,Sq,of),Ig=A},qc=function(Q,F){if(Q!==Ig){var D=Sp(F);Ig?D?Ig.handleWindowTouchEnd(F):Ig.handleWindowMouseUp(F):D?(d(_,vh,Fn),d(_,is,Yc)):(d(_,xq,Hc),d(_,Sq,of)),Ig=Q}},ge=function(O){var F=this;F.gv=O,F._is2d=O instanceof Nl.GraphView,F._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Jm,"wheel"].forEach(function(P){F.addListener(P)}),F.initImageResource()};$g(ge,Il,{enableVR:function(K){var Z=this;if(!!Z._vrEnable!==K)if(Z._vrEnable=K,K)Z.gv.vr.mp(Z.onVRControllerChange,Z);else if(Z.gv.vr.ump(Z.onVRControllerChange,Z),Z._vrRayPolyline){var p=Z.gv.dm();p.remove(Z._vrRayPolyline),p.remove(Z._vrRayHitPoint),Z._vrRayPolyline=e,Z._vrRayHitPoint=e}},onVRControllerChange:function(Q){var o=this,m=Q.property,A=Q.newValue,v=o.gv.vr.getController(A.id),J=v.getRay();J&&("gamepad.button.trigger"===m?"down"===A._62O?o.handle_mousedown(J):o.handleWindowMouseUp(J):"gamepad.pose"===m&&(o.handle_mousemove(J),o.handleWindowMouseMove(J)))},drawVRRay:function(r,$,V){var D,e=this,B=e.gv,K=e._vrRayPolyline,k=!1;if(K)D=e._vrRayHitPoint;else{var i=B.dm();e._vrRayPolyline=K=new P.Polyline,e._vrRayHitPoint=D=new P.Node,D.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),D.setAnchor3d(.5,.5,.499);var z=.2/B.vr.measureOflength;D.s3(z,z,z),K.s("intersect",!1),D.s("intersect",!1),i.add(K),i.add(D),k=!0}if($){var H=V.world,S=V.worldNormal,b=H.x,m=H.y,R=H.z;K.s("shape.border.color","red"),K.setPoints([{x:r.origin.x,y:r.origin.z,e:r.origin.y},{x:b,y:R,e:m}]),D.s("3d.visible",!0),D.p3(b,m,R),D.lookAtDirection([S.x,S.y,S.z],"front")}else{K.s("shape.border.color","blue");var l=new P.Math.Vector3;l.copy(r.direction).setLength(1e3/e.gv.vr.measureOflength).add(r.origin),K.setPoints([{x:r.origin.x,y:r.origin.z,e:r.origin.y},{x:l.x,y:l.z,e:l.y}]),D.s("3d.visible",!1)}B.fi({kind:"vrRayIntersect",ray:r,data:$,intersect:V,polyline:K,hitNode:D,begin:k})},setPreventEventDefault:function(x,G){var B=this,X=B._eventListeners[x];X?X._prevent=G:B._eventListeners[x]=X={_removal:e,_prevent:G}},removeListener:function(D){var p=this,C=p._eventListeners[D];C&&C._removal&&(C._removal(),C._removal=e)},addListener:function(u){var n=this,t=n._eventListeners[u];if(t||(n._eventListeners[u]=t={_removal:e,_prevent:!0}),!t||!t._removal){var N=function(z){t._prevent&&b.preventDefault(z),n.disabled||("wheel"===u?Hr(n,z):n["handle_"+u](z))};d(n.gv.getView(),u,N),t._removal=function(){B(n.gv.getView(),u,N)}}},handleWindowTouchMove:function(N){this.handleWindowMouseMove(N)},handleWindowMouseMove:function(N){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",N):(this.handleDownInfo("onBeginDrag",N),this.isDragging=!0))},handleWindowTouchEnd:function(s){this.handleWindowMouseUp(s)},handleWindowMouseUp:function(m){if(this.isDragging&&(this.handleDownInfo("onEndDrag",m),this.isDragging=!1),this.downInfo){var d=this.handle("onUp",m);if(d&&d.data===this.downInfo.data){this.handleMissingUp(m);var E=this,w=2===m.button?"onContextMenu":"onClick";if(!E._dbclickTimer)return E._dbclickTimer=$(function(){delete E._dbclickTimer,E.handleClick(m,w,d),this.downInfo=A},b.clickDelay),void 0;X(E._dbclickTimer),delete E._dbclickTimer,w="onDoubleClick",E.handleClick(m,w,d)}else this.handleDownInfo("onUp",m);this.downInfo=A}},handle_mouseleave:function(i){var M=this,q=M.gv,V=M.currentInfo?M.currentInfo.data:A;if(V){V.s("onLeave")&&V.s("onLeave")(i,V,q),M.fire("data","onLeave",i,V);var u=M.currentInfo?M.currentInfo.hits:A;if(u)for(var s in u)M.handleLeave(i,s);M.currentInfo=A}},handle_mousewheel:function(c){c.scrollDelta=c.wheelDelta/40,this.handle("onScroll",c)},handle_DOMMouseScroll:function(F){F.scrollDelta=2===F.axis?-F.detail:0,this.handle("onScroll",F)},handle_touchstart:function(k){this.handle_mousedown(k)},handle_touchmove:function(A){this.handle("onMove",A)},handle_mousedown:function(x){this.isDragging&&(this.handleDownInfo("onEndDrag",x),this.isDragging=!1),this.downInfo=this.handle("onDown",x),this.downInfo&&qc(this,x)},handle_mousemove:function(C){var R=this,x=R.gv;R._hoverTimer&&(X(R._hoverTimer),delete R._hoverTimer);var Z,W,E,p=R.handle("onMove",C),g=this.currentInfo?this.currentInfo.data:A,j=this.currentInfo?this.currentInfo.hits:A;if(p&&(W=p.data,E=p.hits,R._hoverTimer=$(function(){X(R._hoverTimer),delete R._hoverTimer,R.handle("onHover",C,p)},x.getHoverDelay()||b.hoverDelay)),W!==g){if(g&&(g.s("onLeave")&&g.s("onLeave")(C,g,x),this.fire("data","onLeave",C,g)),W&&(W.s("onEnter")&&W.s("onEnter")(C,W,x),this.fire("data","onEnter",C,W)),j)for(Z in j)this.handleLeave(C,Z);if(E)for(Z in E){var B=E[Z],H=W._interactPrefix=B.prefix,Y=H&&W.a(H+"onEnter")||B.target.onEnter;Y&&Y.call(B.target,C,W,x,B.point,B.width,B.height),this.fire(B.type,"onEnter",B.event,B.data,B.image,B.comp,B.point,B),W._interactPrefix=null}}else{if(j)for(Z in j)E&&E[Z]||this.handleLeave(C,Z);if(E)for(Z in E)if(!j||!j[Z]){var B=E[Z],H=W._interactPrefix=B.prefix,Y=H&&W.a(H+"onEnter")||B.target.onEnter;Y&&Y.call(B.target,C,W,x,B.point,B.width,B.height),this.fire(B.type,"onEnter",B.event,B.data,B.image,B.comp,B.point,B),W._interactPrefix=null}}this.currentInfo=p},handle:function(D,M,Y){var g,F=this,y=F.gv;if(F._is2d){if(Y=Y||y.getDataInfoAt(M),!Y||!y.isInteractive(Y.data))return;if(g=Y.ui.interactiveInfo){var V,I=Y.data;if(I.s(D)&&I.s(D)(M,I,y),this.fire("data",D,M,I),"body"===Y.part&&g.bodyInfo)V="body",Y.hits=this.handleImage(V,y.getImage(I),D,M,I,Y.point,g.bodyInfo);else if("icons"===Y.part&&g._38o){var N=g._38o[Y.name];N&&N[Y.index]&&(V="icons|"+Y.name+"|"+Y.index,Y.hits=this.handleImage(V,Y.icon,D,M,I,Y.point,N[Y.index]))}}return Y}var I,Q;if(!Y)if(M&&M instanceof P.Math.Ray){var q=y.vr.intersectWorld(M);if(I=q.data,Q=q.intersect,F.drawVRRay(M,I,Q),!I)return;var t=y.getData3dUI(I);if(g=t.interactiveInfo,!g)return;Y={data:I,part:Q.part,ui:t}}else{if(Y=y.getDataInfoAt(M),!Y)return;Y&&(Y={data:Y.data,part:Y.part})}if(y.isInteractive(Y.data)){if(!Q){I=Y.data;var t=y.getData3dUI(I);if(Y.ui=t,g=t.interactiveInfo,!g)return Y;if(Q=y.intersectObject(M,I),!Q)return}I.s(D)&&I.s(D)(M,I,y),this.fire("data",D,M,I);var X,n=Q.part;return"body"!==n&&(X=I.s(n+".image")||I.s("shape3d."+n+".image")),X||(X=I.s("all.image")||I.s("shape3d.image")),g="object"==typeof X?g[X.uuid]:g[X],g&&g.bodyInfo?(Y.part="body",Y.interactiveInfo=g,Y.point=this._convertUVToPoint(Q.uv,g),Y.image=X,Y.hits=this.handleImage("body",X,D,M,I,Y.point,g.bodyInfo),Y):Y}},_handleLeaveOrMissing:function(v,U,R){var p="leave"===v?this.currentInfo:this.downInfo;if(p){var J=p.interactiveInfo||p.ui.interactiveInfo;if(J){var Y,E,g=p.data;if(this._is2d){if(E=this.gv.lp(U),"body"===p.part&&J.bodyInfo)Y="body","leave"===v?this.handleLeaveImage(R,Y,this.gv.getImage(g),U,g,E,J.bodyInfo):this.handleMissingUpImage(Y,this.gv.getImage(g),U,g,E,J.bodyInfo);else if("icons"===p.part&&J._38o){var S=J._38o[p.name];S&&S[p.index]&&(Y="icons|"+p.name+"|"+p.index,"leave"===v?this.handleLeaveImage(R,Y,p.icon,U,g,E,S[p.index]):this.handleMissingUpImage(Y,p.icon,U,g,E,S[p.index]))}}else{if(!J.bodyInfo)return;var x=this.gv.intersectObject(U,g);E=x&&x.uv?this._convertUVToPoint(x.uv,J):{x:1/0,y:1/0},"leave"===v?this.handleLeaveImage(R,"body",p.image,U,g,E,J.bodyInfo):this.handleMissingUpImage("body",p.image,U,g,E,J.bodyInfo)}}}},handleClick:function(s,L,V){var U=this,F=this.downInfo;if(F&&V){var z,K=V.interactiveInfo||V.ui.interactiveInfo,Y=V.data,R=this.gv;if(Y.s(L)&&Y.s(L)(s,Y,R),U.fire("data",L,s,Y),K)if(this._is2d){if(F.part===V.part){var C=R.lp(s);"body"===V.part&&K.bodyInfo&&(z="body",this.handleClickImage(z,R.getImage(Y),L,s,Y,C,K.bodyInfo,V))}}else{if(!K.bodyInfo)return;var p=R.intersectObject(s,Y);if(!p)return;C=this._convertUVToPoint(p.uv,K),this.handleClickImage("body",F.image,L,s,Y,C,K.bodyInfo,V)}}},handleDownInfo:function(o,e){if(this.downInfo){var b=this.downInfo,I=this.gv,Q=b.interactiveInfo||b.ui.interactiveInfo;if(Q){var O,B=b.data;if(B.s(o)&&B.s(o)(e,B,I),this.fire("data",o,e,B),this._is2d){var k=I.lp(e);if("body"===b.part&&Q.bodyInfo)O="body",this.handleDownInfoImage(O,I.getImage(B),o,e,B,k,Q.bodyInfo);else if("icons"===b.part&&Q._38o){var K=Q._38o[b.name];K&&K[b.index]&&(O="icons|"+b.name+"|"+b.index,this.handleDownInfoImage(O,b.icon,o,e,B,k,K[b.index]))}}else{if(!Q.bodyInfo)return;var n=I.intersectObject(e,B);if(!n)return;k=this._convertUVToPoint(n.uv,Q),this.handleDownInfoImage("body",b.image,o,e,B,k,Q.bodyInfo)}}}},fire:function(S,l,x,o,n,V,A,s){this.gv.fi({kind:l,type:S,event:x,data:o,image:n,comp:V,view:this.gv,point:A,width:s?s.width:e,height:s?s.height:e})},handleImage:function(K,w,P,b,f,O,x){var D={};if(w&&(w=Ef(w))){var $=this.gv,g=x.rect,N=this.convertPoint(O,x);N.inRect&&(w[P]&&w[P](b,f,$,N,g.width,g.height),this.fire("image",P,b,f,w,e,N,g),D[K+"|image"]={target:w,type:"image",image:w,data:f,event:b,point:N,width:g.width,height:g.height});for(var W=x.compInfos,i=w,U=W.length-1;U>=0;U--){var J=W[U],c=J.comp;if(N=this.convertPoint(O,J,i,c,$,f),N.inRect){g=J.rect;var z=f._interactPrefix=J.prefix,q=z&&f.a(z+P)||c[P];q&&q.call(c,b,f,$,N,g.width,g.height),this.fire("comp",P,b,f,w,c,N,g),(w=g.image)&&(w[P]&&w[P](b,f,$,N,g.width,g.height),this.fire("image",P,b,f,w,e,N,g)),f._interactPrefix=null,D[K+"|"+U]={target:c,type:"comp",comp:c,image:w,data:f,event:b,point:N,width:g.width,height:g.height,prefix:z},w&&(D[K+"|"+U+"|image"]={target:w,type:"image",image:w,data:f,event:b,point:N,width:g.width,height:g.height,prefix:z})}}}return D},handleLeave:function(y,P){return this._handleLeaveOrMissing("leave",y,P)},handleMissingUp:function(o){return this._handleLeaveOrMissing("missing",o)},handleLeaveImage:function(q,O,f,I,x,o,K){if(f&&(f=Ef(f))){var N=this.gv,z=K.rect,c=this.convertPoint(o,K);q===O+"|image"&&(f.onLeave&&f.onLeave(I,x,N,c,z.width,z.height),this.fire("image","onLeave",I,x,f,e,c,z));for(var A=K.compInfos,T=f,J=A.length-1;J>=0;J--){var Y=A[J],R=Y.comp;c=this.convertPoint(o,Y,T,R,N,x),z=Y.rect;var W=x._interactPrefix=Y.prefix;if(q===O+"|"+J){var C=W&&x.a(W+"onLeave")||R.onLeave;C&&C.call(R,I,x,N,c,z.width,z.height),this.fire("comp","onLeave",I,x,f,R,c,z)}(f=z.image)&&q===O+"|"+J+"|image"&&(f.onLeave&&f.onLeave(I,x,N,c,z.width,z.height),this.fire("image","onLeave",I,x,f,e,c,z)),x._interactPrefix=null}}},handleMissingUpImage:function(z,B,$,s,l,d){var w="onUp",R=this.downInfo.hits;if(R&&B&&(B=Ef(B))){var q=this.gv,F=d.rect,Z=this.convertPoint(l,d);!Z.inRect&&R[z+"|image"]&&(B[w]&&B[w]($,s,q,Z,F.width,F.height),this.fire("image",w,$,s,B,e,Z,F));for(var m=d.compInfos,A=B,n=m.length-1;n>=0;n--){var i=m[n],a=i.comp;if(Z=this.convertPoint(l,i,A,a,q,s),!Z.inRect){F=i.rect;var K=s._interactPrefix=i.prefix;if(R[z+"|"+n]){var M=K&&s.a(K+w)||a[w];M&&M.call(a,$,s,q,Z,F.width,F.height),this.fire("comp",w,$,s,B,a,Z,F)}(B=F.image)&&R[z+"|"+n+"|image"]&&(B[w]&&B[w]($,s,q,Z,F.width,F.height),this.fire("image",w,$,s,B,e,Z,F)),s._interactPrefix=null}}}},handleDownInfoImage:function(r,B,f,d,Z,z,o){var n=this.downInfo.hits;if(n&&B&&(B=Ef(B))){var l=this.gv,b=o.rect,$=this.convertPoint(z,o);n[r+"|image"]&&(B[f]&&B[f](d,Z,l,$,b.width,b.height),this.fire("image",f,d,Z,B,e,$,b));for(var W=o.compInfos,N=B,H=W.length-1;H>=0;H--){var s=W[H],M=s.comp;$=this.convertPoint(z,s,N,M,l,Z),b=s.rect;var L=Z._interactPrefix=s.prefix;if(n[r+"|"+H]){var P=L&&Z.a(L+f)||M[f];P&&P.call(M,d,Z,l,$,b.width,b.height),this.fire("comp",f,d,Z,B,M,$,b)}(B=b.image)&&n[r+"|"+H+"|image"]&&(B[f]&&B[f](d,Z,l,$,b.width,b.height),this.fire("image",f,d,Z,B,e,$,b)),Z._interactPrefix=null}}},handleClickImage:function(t,y,j,L,k,c,D,x){var B=this.downInfo.hits,i=x.hits;if(B&&y&&(y=Ef(y))){var U=this.gv,J=D.rect,l=this.convertPoint(c,D);B[t+"|image"]&&(y[j]&&y[j](L,k,U,l,J.width,J.height),this.fire("image",j,L,k,y,e,l,J));for(var K=D.compInfos,S=y,P=K.length-1;P>=0;P--){var M=K[P],w=M.comp;l=this.convertPoint(c,M,S,w,U,k),J=M.rect;var n=k._interactPrefix=M.prefix;if(B[t+"|"+P]&&i[t+"|"+P]){var v=n&&k.a(n+j)||w[j];v&&v.call(w,L,k,U,l,J.width,J.height),this.fire("comp",j,L,k,y,w,l,J)}(y=J.image)&&B[t+"|"+P+"|image"]&&(y[j]&&y[j](L,k,U,l,J.width,J.height),this.fire("image",j,L,k,y,e,l,J)),k._interactPrefix=null}}},initImageResource:function(){b.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(s,I){if(!s)return{x:1/0,y:1/0};var i=I.bodyInfo.rect,G=s.clone(),C=s.multiply({x:i.width,y:i.height});return C.local=G,C},convertPoint:function(c,O,K,U,X,W){var Y=O.rect,T=O.matrix.applyInverse(c).sub(Y),x=T.x>=0&&T.y>=0&&T.x<=Y.width&&T.y<=Y.height;if(!x)return T;if(U&&_d(U.pixelPerfect,W,X)){var Y,u=1;this._is2d?(u=X.getZoom(),Y=fd(c.x,c.y,e,u)):Y=fd(c.x,c.y);var l=!1,d=Y.x,y=Y.y,Q=Y.width,h=Y.height,f=b.hitMaxArea,p=Q*h*u*u;if(p>f){var R=Math.sqrt(f/p);u*=R}Q*=u,h*=u,2>Q&&(Q=2),2>h&&(h=2),d*=u,y*=u;var i=Zj(Q,h),S=new Jq(0,-d,-y,u,u);S.append(O.matrix),X._drawForChecking=!0,U.transform=S,O.refRect&&O.refRect.fitSize&&(U.refRect=O.refRect);var k=K.comps;K.comps=[U],Vh(i,K,0,0,Q,h,W,self),K.comps=k,delete U.refRect,delete U.transform,X._drawForChecking=!1;try{for(var z=0,G=i.getImageData(0,0,Q,h).data;z<G.length;z+=4)if(0!==G[z+3]){l=!0;break}i.restore()}catch(s){Vr=A,l=!1}T.inRect=l}else T.inRect=!0;return T}});var eq=Nl.DefaultInteractor=function(B){yf(eq,this,[B])};Of("DefaultInteractor",Il,{handle_mousedown:function(G){Rj(G);var L=this,C=L.gv,y=C.getDataAt(G);if(C.setFocus(G)&&!C._editing&&!C._scrolling){or(G)?C.handleDoubleClick(G,y):C.handleClick(G,y);var r=vk(G);!Kn()&&!r&&y&&(C.isMovable(y)||C._39Q(y))||!C.isPannable()||!Qf(G)&&!r||Kc(G)||(L._tx=C.tx(),L._ty=C.ty(),L.startDragging(G))}},handleWindowMouseUp:function(W){var K=this,C=K.gv;C._panning&&(delete C._panning,C.onPanEnded(),K.fi({kind:"endPan",event:W})),delete K._tx,delete K._ty,K.clearDragging()},handle_mousemove:function(e){var K=this,m=K.gv;K._hoverTimer&&(X(K._hoverTimer),delete K._hoverTimer),K._hoverTimer=$(function(){K.fi({kind:"hover",event:e}),X(K._hoverTimer),delete K._hoverTimer},m.getHoverDelay()||b.hoverDelay)},handle_touchmove:function($){this.handle_mousemove($)},handleWindowMouseMove:function(z){var H=this,B=H.gv;H.fi({kind:B._panning?"betweenPan":"beginPan",event:z}),B._panning=1;var Z=tg(B,z,H._lastClientPoint);B.setTranslate(H._tx+Z.x,H._ty+Z.y)},handle_mousewheel:function(n){this.gv.handleScroll(n,n.wheelDelta)},handle_DOMMouseScroll:function(P){2===P.axis&&this.gv.handleScroll(P,-P.detail)},handle_keydown:function(X){this.gv.handleKeyDown(X)}});var $f=Nl.SelectInteractor=function(D){yf($f,this,[D])};Of("SelectInteractor",Il,{_42:function(){var z=this,N=z.gv,X=N.getZoom(),$=z.mark,x=z.div;
x||(x=z.div=ob(),Ho(z.getView(),x));var F={};F.x=$.x*X+N.tx(),F.y=$.y*X+N.ty(),F.width=$.width*X,F.height=$.height*X,di(x,F),this.intersects()?(x.style.border="",x.style.background=N.getRectSelectBackground()):(x.style.background="",x.style.border="1px solid "+N.getRectSelectBorderColor())},handle_mousedown:function(T){var Q=this,n=Q.gv;if(Q._57I=A,Q.pendingClickThrough=A,!(n._editing||n._scrolling||Kn()||vk(T))){var w=n.getDataAt(T),G=n.sm();w?Kc(T)?G.co(w)?G.rs(w):G.as(w):G.co(w)?w instanceof zm&&w.isClickThroughEnabled()&&Qf(T)&&(Q.pendingClickThrough=nq(T)):G.ss(w):Kc(T)||!n.isPannable()?Qf(T)&&(Kc(T)||G.cs(),n.isRectSelectable()&&(Q.startDragging(T),n._77O=1)):Qf(T)&&(Q._57I=nq(T))}},handle_mouseup:function(T){var E=this,Y=E.gv,_=E._57I;if(_&&(np(_,nq(T))<=1&&Y.sm().cs(),E._57I=A),E.pendingClickThrough){if(np(E.pendingClickThrough,nq(T))<=1){var z=Y.getDataAt(T);if(z instanceof zm&&z.isClickThroughEnabled()){var O=Y.getDataAt(T,function(V){var h=V.getParent()===z&&Y.isSelectable(V,!0);return h});O&&(T.clickThrough=!0,Y.sm().ss(O))}}E.pendingClickThrough=A}},handleWindowMouseUp:function(q){this.clear(q)},handleWindowMouseMove:function(t){var $=this,w=$.gv;$._logicalPoint=w.lp(t),$.mark?($.fi({kind:"betweenRectSelect",event:t}),w.isPannable()&&$.autoScroll(t),$.redraw()):$.fi({kind:"beginRectSelect",event:t}),$.mark=mo($._lastLogicalPoint,$._logicalPoint),$.redraw()},intersects:function(){var x=this,s=x._lastLogicalPoint,c=x._logicalPoint;return s.x>c.x||s.y>c.y},clear:function(g){var u=this,D=u.gv,_=u.mark;if(u._57I=A,u.pendingClickThrough=A,u._lastLogicalPoint){if(_){if(0!==_.width&&0!==_.height){var q=D.getDatasInRect(_,u.intersects());if(!q.isEmpty()){var x=D.sm(),w=x.toSelection();q.each(function(n){x.co(n)?w.remove(n):w.add(n)}),x.ss(w)}}Sc(u.div),delete u.div,delete u.mark,u.redraw(),u.fi({kind:"endRectSelect",event:g}),D.onRectSelectEnded()}u.clearDragging(),delete D._77O}},redraw:function(){var E=this;E._draw||(E._draw=1,$(function(){E.mark&&E._42(),delete E._draw},16))}});var _e=Nl.MoveInteractor=function(O){yf(_e,this,[O])};Of("MoveInteractor",Il,{handle_mousedown:function(Z){var G=this,h=G.gv;if(Qf(Z)&&!h._editing&&!h._scrolling&&!Kn()){var D=h.getSelectedDataAt(Z);!D||h._39Q(D)&&!h.isMovable(D)?h._focusData=A:(G._data=D,h.handleMouseDown&&h.handleMouseDown(Z,D),G.startDragging(Z),h.isMovable(D)&&(h._moving=1))}},handleWindowMouseUp:function(H){var k=this,R=k.gv;R.handleMouseUp&&R.handleMouseUp(H,k._data),k.clear(H)},handleWindowMouseMove:function(F){var h=this,P=h._data,M=h.gv;if((!M._93O||!M._93O(F,P))&&M._moving){h._logicalPoint||h.fi({kind:"prepareMove",event:F});var U=h._logicalPoint?"betweenMove":"beginMove",T={kind:U,event:F},$=h._logicalPoint=M.lp(F);"beginMove"!==U||h._alreadyBeginTransaction||(h._alreadyBeginTransaction=!0,M.getDataModel().beginTransaction());var r=h._calcShift(U,F),b=r.x,B=r.y,W=h.gv.getMoveMode(F,P);W&&("x"===W?B=0:"y"===W?b=0:"xy"!==W&&(b=B=0)),M.moveSelection(b,B),h._lastLogicalPoint=$,h.autoScroll(F),h.fi(T)}},_calcShift:function(){var R=this,k=R._logicalPoint,$=R._lastLogicalPoint,A=k.x-$.x,U=k.y-$.y;return{x:A,y:U}},clear:function(H){var j=this,S=j.gv;j._lastLogicalPoint&&(j._lastLogicalPoint=j._data=S._moving=A,j._logicalPoint&&(j.fi({kind:"endMove",event:H}),S.onMoveEnded()),j.clearDragging()),j._alreadyBeginTransaction&&(j._alreadyBeginTransaction=!1,S.getDataModel().endTransaction())}});var rq=Nl.TextEditInteractor=function(P){yf(rq,this,[P]),this.init()};Of("TextEditInteractor",Il,{init:function(){var o=this,N=this.input=x.createElement("input"),t=N.style;N.text="text",t.border="1px solid #d8d8d8",t.position="absolute",t.padding="2px 3px",t.outline="none",t.marginLeft="-90px",t.marginTop="-16px",t.backgroundColor="rgba(255,255,255, 0.9)",t.fontSize="14px",t.width="180px",t.height="32px",t.boxShadow="0 0 13px rgba(16,142,233, 0.5)",t.textAlign="center",t.boxSizing="border-box",d(N,"keyup",function(Z){rp(Z)&&o.endTextEdit()}),d(N,"focus",function(){N.select()});var l=this.textarea=x.createElement("textarea"),k=this.wrap=x.createElement("div");k.appendChild(l),t=l.style,t.margin=0,t.padding="4px",t.overflow="hidden",t.boxSizing="border-box",t.position="absolute",t.outline="none",t.backgroundColor="transparent",t.resize="none",t.textAlign="center",t.fontSize="14px",t.border="none",t.borderWidth=0,t.width="100%",t.top="50%",t=k.style,t.boxSizing="border-box",t.margin=0,t.padding=0,t.position="absolute",t.boxShadow="0 0 13px rgba(16,142,233, 0.5)",t.border="1px solid #d8d8d8",t.backgroundColor="rgba(255,255,255, 0.9)",t.width="180px",t.marginLeft="-90px",d(l,"keydown",function(N){return(kj()||Kc())&&rp(N)?(o.endTextEdit(),void 0):(o.calculateTextareaHeight(String.fromCharCode(N.keyCode)),void 0)}),d(l,"focus",function(){l.select()});var c=function(c){c.stopPropagation()};d(N,"mousedown",c),d(N,"touchstart",c),d(l,"mousedown",c),d(l,"touchstart",c),o.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],o.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",o.handleWindowClick=function(F){var j=o._editingDOM;if(j){var r=j.getBoundingClientRect(),e=nq(F);dg(r,e)||o.endTextEdit()}}},handle_mousedown:function(D){var u=this,z=u.gv;if(or(D)&&!z._editing){var C=z.getDataAt(D);if(C){var P=z.getTextEditInfo(C);P&&(this._editInfo=P,this._editTarget=C,z._editing=!0,P.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var c=this,K=c.gv,D=c._editTarget,j=c.getTargetValue(),y=c.textarea,f=c.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===j||j===e)&&(j=""),y.value=j,c._editingDOM=y,K.getView().appendChild(f),this.layoutHTML(f,D),this.calculateTextareaHeight(),$(function(){y.focus(),d(_,"mousedown",c.handleWindowClick),d(_,"touchstart",c.handleWindowClick)},10)},handleTextEdit:function(){var M=this,l=M.gv,Y=M._editTarget,U=M.getTargetValue(),T=M.input;(null===U||U===e)&&(U=""),T.value=U,M._editingDOM=T,l.getView().appendChild(T),this.layoutHTML(T,Y),$(function(){T.focus(),d(_,"mousedown",M.handleWindowClick),d(_,"touchstart",M.handleWindowClick)},10)},layoutHTML:function(p,q){var o=this.gv,v=o.getZoom();if(q instanceof P.Node){var N=q.getRect();p.style.left=(N.x+N.width/2)*v+o.tx()+"px",p.style.top=(N.y+N.height/2)*v+o.ty()+"px"}else if(q instanceof P.Edge){var A=o.getDataUI(q),N=A._6I;p.style.left=(N.x+N.width/2)*v+o.tx()+"px",p.style.top=(N.y+N.height/2)*v+o.ty()+"px"}},endTextEdit:function(){var b=this,n=b._editInfo.isMultiline?b.wrap:b.input,q=b._editInfo.isMultiline?b.textarea:b.input;b.setTargetValue(q.value),b.gv.getView().removeChild(n),b.gv._editing=!1,delete b._editingDOM,B(_,"mousedown",b.handlelick),B(_,"touchstart",b.handleWindowClick)},setTargetValue:function(a){var g=this,V=g._editTarget,F=g._editInfo,D=F.accessType,A=F.name;if(A&&D||(D="p",A="name"),"p"===D){var M=P.Default.setter(A);V[M](a)}else"a"===D?V.a(A,a):V.s(A,a)},getTargetValue:function(){var E=this,p=E._editTarget,r=E._editInfo,Y=r.accessType,L=r.name;if(L&&Y||(Y="p",L="name"),"p"===Y){var I=P.Default.getter(L);return p[I]()}return"a"===Y?p.a(L):p.s(L)},createHiddenTextarea:function(){this.hiddenTextarea=x.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(T,V){if(V&&this.computedStyleCache)return this.computedStyleCache;var f=this,P=_.getComputedStyle(T),z=P.getPropertyValue("box-sizing")||P.getPropertyValue("-moz-box-sizing")||P.getPropertyValue("-webkit-box-sizing"),S=parseFloat(P.getPropertyValue("padding-bottom"))+parseFloat(P.getPropertyValue("padding-top")),w=parseFloat(P.getPropertyValue("border-bottom-width"))+parseFloat(P.getPropertyValue("border-top-width")),a=f.SIZING_STYLE.map(function(t){return t+":"+P.getPropertyValue(t)}).join(";"),L={sizingStyle:a,paddingSize:S,borderSize:w,boxSizing:z};return V&&(this.computedStyleCache=L),L},calculateTextareaHeight:function(e){e=e||"";var R=this,S=R.textarea,w=R.hiddenTextarea,o=R.wrap,L=32,H=R.calculateHTMLStyle(S,!1),I=H.paddingSize,M=H.borderSize,O=H.boxSizing,u=H.sizingStyle;w.setAttribute("style",u+";"+R.HIDDEN_TEXTAREA_STYLE),w.value=S.value+e;var r=w.scrollHeight;"border-box"===O?r+=M:"content-box"===O&&(r-=I),S.style.height=r+"px",S.style.marginTop=0-.5*r+"px",o.style.height=Math.max(r,L)+"px",o.style.marginTop=r*-.5+"px"}});var Eh=Nl.ScrollBarInteractor=function(b){yf(Eh,this,[b])};Of("ScrollBarInteractor",Il,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(b){var e=this.gv.getViewRect();return this._41o()&&(e.x+e.width-this.gv.lp(b).x)*this.gv.getZoom()<Pj},isH:function(y){var b=this.gv.getViewRect();return this._40o()&&(b.y+b.height-this.gv.lp(y).y)*this.gv.getZoom()<Pj},handle_mousemove:function(D){this.handle_touchmove(D)},handle_touchmove:function(n){if(!si&&Qf(n)&&this.gv.isScrollBarVisible()){var L=this,R=L.isV(n),B=L.isH(n);(R||B)&&L.gv.showScrollBar(),L.gv._scrolling=R||B}},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(O){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=A,this.fi({kind:"endScroll",event:O})},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(L){var j=this;if(j.gv.setFocus(L),Rj(L),j.handle_touchmove(L),!(xs(L)>1)&&j.gv._scrolling&&j.gv.isScrollBarVisible()){j._cp=nq(L),j._tx=j.gv.tx(),j._ty=j.gv.ty();var G=j.isV(L);j._state=G?"vScroll":"hScroll",qf(j,L),j.fi({kind:"beginScroll",event:L})}},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(R){var f=nq(R),Q=this.gv.getViewRect(),A=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-f.y)*A.height/Q.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-f.x)*A.width/Q.width),this.fi({kind:"betweenScroll",event:R})}});var pp=Nl.TouchInteractor=function(W,s){s=s||{},s.selectable===e&&(s.selectable=!0),s.movable===e&&(s.movable=!0),s.pannable===e&&(s.pannable=!0),s.pinchable===e&&(s.pinchable=!0),s.editable===e&&(s.editable=!0),this.params=s,yf(pp,this,[W])};Of("TouchInteractor",Il,{ms_edit:1,setUp:function(){var S=this;pp.superClass.setUp.call(S),tc&&S.params.editable&&S.gv.setEditInteractor(S)},tearDown:function(){var d=this;pp.superClass.tearDown.call(d),tc&&d.params.editable&&d.gv.setEditInteractor(A)},clear:function(m){var J=this,t=J.gv;t._moving&&(J.fi({kind:"endMove",event:m}),delete t._moving,t.onMoveEnded(),t.dm().endTransaction()),t._panning&&(J.fi({kind:"endPan",event:m}),delete t._panning,t.onPanEnded()),t._pinching&&(J.fi({kind:"endPinch",event:m}),delete t._pinching,t.onPinchEnded()),t._editing&&(J._46O(m),J._77I=J._node=J._edge=J._shape=J._rect=J._89I=J._index=t._editing=A),J.pendingClickThrough=J._moving=J._panning=J._pinching=J._editing=J._57I=J._data=J._beginHistory=A,J.clearDragging()},handle_touchstart:function(y){var v=this;if(!v.gv._editing){Rj(y),v._57I=A,v.pendingClickThrough=A;var e=v.params,d=v.gv,G=d.sm(),Q=d.getDataAt(y),k=xs(y);if(1===k){if(or(y))return d.handleDoubleClick(y,Q),void 0;d.handleClick(y,Q),Q&&(d.handleMouseDown&&d.handleMouseDown(y,Q),v._data=Q),e.selectable||(Q=A),Q&&(G.co(Q)?Q instanceof zm&&Q.isClickThroughEnabled()&&(v.pendingClickThrough=nq(y)):G.ss(Q),e.editable&&d.isEditable(Q)&&v._79I(y,Q,!0)?(v._editing=1,v.startDragging(y)):e.movable&&d.isMovable(Q)&&(v._moving=1,v.startDragging(y))),Q&&d.isMovable(Q)||(v._57I=nq(y),e.pannable&&d.isPannable()&&(v._panning=1,v.startDragging(y),v._translate={x:d.tx(),y:d.ty()}))}else if(e.pinchable&&2===k){if(Q&&d._39Q(Q))return;v._pinching=1,v.startDragging(y);var o=d.getView(),H=d.getZoom(),B=o.getBoundingClientRect(),w=y.touches[0],q=y.touches[1],W={x:(w.clientX+q.clientX)/2-B.left,y:(w.clientY+q.clientY)/2-B.top};W.x-=d.tx(),W.y-=d.ty(),W.x/=H,W.y/=H,v._p=W,v._d=Xl(y)}}},handle_touchend:function(v){var K=this,S=K.gv,B=K._57I,M=K._data;if(B&&(np(B,nq(v))<=1&&!S.getDataAt(v)&&S.sm().cs(),K._57I=A),M&&S.handleMouseUp&&S.handleMouseUp(v,M),K.pendingClickThrough){if(np(K.pendingClickThrough,nq(v))<=1){var M=S.getDataAt(v);if(M instanceof zm&&M.isClickThroughEnabled()){var Q=S.getDataAt(v,function(J){var h=J.getParent()===M&&S.isSelectable(J,!0);return h});Q&&(v.clickThrough=!0,S.sm().ss(Q))}}K.pendingClickThrough=A}},handleWindowTouchEnd:function(Y){this.clear(Y)},handleWindowTouchMove:function(x){var Y=this,F=Y.gv,O=xs(x);if(1===O){var X=nq(x),f=tg(F,X,Y._lastClientPoint),g=np({x:0,y:0},f);if(Y._editing&&(Y._beginHistory||(Y._beginHistory=1,F.dm().beginTransaction()),F._editing=1,Y._78I(x)),Y._moving){if(!F._moving&&g<b.touchMoveThreshold)return;Y._beginHistory||(Y._beginHistory=1,F.dm().beginTransaction()),Y.handleMove(x)}else if(Y._panning){if(!F._panning&&g<b.touchMoveThreshold)return;F.setTranslate(Y._translate.x+f.x,Y._translate.y+f.y),Y.fi({kind:F._panning?"betweenPan":"beginPan",event:x}),F._panning=1}}else if(2===O&&Y._pinching){var $=Xl(x);F.handlePinch(Y._p,$,Y._d),Y._d=$,Y.fi({kind:F._pinching?"betweenPinch":"beginPinch",event:x}),F._pinching=1}},handleMove:function(e){var Y=this,o=Y.gv,E=o.lp(e);o._93O&&o._93O(e,Y._data)||(o.moveSelection(E.x-Y._lastLogicalPoint.x,E.y-Y._lastLogicalPoint.y),Y._lastLogicalPoint=E,Y.autoScroll(e),Y.fi({kind:o._moving?"betweenMove":"beginMove",event:e}),o._moving=1)}});var P=_.ht,Vq=P.graph._editor={Math:P.Math,Guide:{}};Vq.getStyle=function(R){var u,c=Vq.StyleMap;return c&&(u=c[R],u!==e)?u:Vq.DefaultStyleMap[R]},Vq.setStyle=function(X,P){var K=Vq.StyleMap;K||(K=Vq.StyleMap={}),K[X]=P},Vq.inEdit=function(y){return y._inXEdit===!0},Vq.startEdit=function(I){I._inXEdit=!0,Vq.Inject.doInject(I)},Vq._46O=function(K){K._inXEdit=!1,Vq.Inject.undoInject(K)},Vq.toScreenPosition=function(G,n){var q=G.tx(),F=G.ty(),_=G._zoom;return new Vq.Math.Vector2(n.x*_+q,n.y*_+F)},Vq.checkHit=function(q,M,m){return q.distanceTo(M)<m?!0:!1},Vq.toWorldPosition=function(t,H){var K=t.tx(),G=t.ty(),d=t._zoom;return{x:(H.x-K)/d,y:(H.y-G)/d}},Vq.setAntialias=function(x,e){for(var u,J=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],G=0,Q=J.length;Q>G&&(u=J[G],!(u in x));G++);x[u],x[u]=e},Vq.getTargetCornersOnScreen=function(L,n){if(!n)return null;var U,B=[];if(Ak(n,L)){var w=kb(L,n);U=[{x:w.x,y:w.y},{x:w.x+w.width,y:w.y},{x:w.x+w.width,y:w.y+w.height},{x:w.x,y:w.y+w.height}]}else{if(!n.getCorners)return null;U=n.getCorners()}return U.forEach(function(U){var l=Vq.toScreenPosition(L,U);B.push(l.x,l.y)}),B},Vq.log=function(){};var ud=Vq.Inject={_modules:[]};ud.registAsModule=function(z,d){var c={},K={};for(var T in z){var G=d.prototype[T];c[T]=G}z.getBackup=function(Q){return c[Q]},z.getBackups=function(){return c},K.doInject=function(){for(var l in z)"getBackup"!==l&&(d.prototype[l]=z[l])},K.undoInject=function(){for(var G in z)"getBackup"!==G&&(d.prototype[G]=c[G])},ud._modules.push(K)},ud.doInject=function(y){for(var S,Y=ud._modules,v=0,P=Y.length;P>v;v++)S=Y[v],S.doInject(y)},ud.undoInject=function(Z){for(var v,x=ud._modules,F=0,q=x.length;q>F;F++)v=x[F],v.undoInject(Z)};var Il=P.graph.EditInteractor=function(d){var y=this,t=x.createElement("canvas");t.className="editCanvas",t.style.position="absolute",y._styleMap={},y._canvas=t,y._context=t.getContext("2d"),Il.superClass.constructor.call(y,d),this._editDetail=!1,Vq.setAntialias(y._context,!1),y._subModules=[new Vq.Anchor(y),new Vq.RotateX(y),new Vq.MoveDummy(y),new Vq.Rect(y),new Vq.Curve(y),new Vq.MoveHelper(y)],y._gridGuide=new Vq.Guide.Grid(y),y._rectGuide=new Vq.Guide.Rect(y),y._hoverGuide=new Vq.Guide.Hover(y)},pr=Il;P.Default.def(Il,P.graph.Interactor,{ms_edit:1,ms_fire:1}),N.defineProperties(Il.prototype,{editDetail:{get:function(){var V=!!this._editDetail;return V},set:function($){var h=this,A=h._editDetail;A!==$&&(h._editDetail=$,h.gv._editing=$,h.fp("editDetail",A,$),h.fp("pointsEditingMode",A,$),h.fi({kind:$?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(O){(!this._editDetail||O)&&(this.gv._editing=O,O||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(j){this._editing=j,this.gvEditing=j}},pointsEditingMode:{get:function(){return this.editDetail},set:function(y){var g=this;g.editDetail!==y&&(y?g._tryEnterEditDetailMode():g._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var d=this._gridEnabled;if(!d)return!1;var E=this.gv;return E?!0:!0},set:function(S){S!==this._gridEnabled&&(this._gridEnabled=S,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(O){O!==this._agEnabled&&(this._agEnabled=O,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Il.prototype.getSubModule=function(h){var m,w,Z,I=this._subModules;for(w=0,Z=I.length;Z>w;w++)if(m=I[w],m.catalog===h)return m},Il.prototype.invokeSubModule=function(y,_){var t=this,b=t._subModules;if(b)for(var m,P,N,g=Array.prototype.slice.call(arguments,2),o=0,H=b.length;H>o;o++)if(m=b[o],P=m[y],P&&(N=P.apply(m,g),N!=e&&_))return m},Il.prototype.invokeSubModuleInverse=function(t,n){var V=this,F=V._subModules;if(F)for(var b,Q,O,B=Array.prototype.slice.call(arguments,2),i=F.length-1;i>=0;i--)if(b=F[i],Q=b[t],Q&&(O=Q.apply(b,B),O!=e&&n))return b},Il.prototype.setUp=function(){Vq.log("setUp");var i=this,x=i.gv,G=x.getView(),X=i._canvas;Il.superClass.setUp.call(i),x.setEditInteractor(i),x._79O?G.insertBefore(X,x._79O):G.appendChild(X),Vq.startEdit(x),i.invokeSubModule("setUp"),x.dm().mm(i._onDataModelChanged,i),x.dm().md(i._onDataPropertyChanged,i)},Il.prototype.tearDown=function(){Vq.log("tearDown");var K=this,I=K.gv,i=I.getView();K._resetCustomCursorStyle(),Il.superClass.tearDown.call(K),I.dm().umm(K._onDataModelChanged,K),I.dm().umd(K._onDataPropertyChanged,K),I.setEditInteractor(null),i.removeChild(K._canvas),K._drawTimer&&(X(K._drawTimer),K._drawTimer=null),Vq._46O(I),K.invokeSubModule("tearDown")},Il.prototype._onDataModelChanged=function(f){var L=this;("clear"===f.kind||"remove"===f.kind&&L.editDetail&&f.data===L.getSubModule("Curve").target)&&(L.editDetail=!1,L._42())},Il.prototype._onDataPropertyChanged=function(Z){var j=this;if(j.editDetail){var F=j.getSubModule("Curve"),S=Z.data;S===F.target&&(S._writing||F._handleDataChanged(Z))}},Il.prototype.clear=function(){Vq.log("clear")},Il.prototype.redraw=function(){this._42()},Il.prototype._42=function(){var O=this;O._drawTimer||(O._drawTimer=$(function(){O._drawTimer=null,O.drawImpl()},0))},Il.prototype.drawImpl=function(){var m;for(m in{_42:!0})break;return function(){var D=this,R=D._canvas,l=D.gv,$=l.getWidth(),g=l.getHeight(),T=D._context,I=P.Default.getInternal(),w=_.devicePixelRatio;(R.width!==$||R.height!==g)&&I.setCanvas(R,$,g,w),T.clearRect(0,0,R.width,R.height);var q=D._getValidSelection();T.save(),T.scale(w,w),D._gridGuide._42(),D.invokeSubModuleInverse(m,!1,T,l,q),D._rectGuide._42(),D._hoverGuide._42(),T.restore()}}(),Il.prototype._getValidSelection=function(){var _=this,p=_.gv,c=p.sm().getSelection(),V=[];return c.each(function(J){p.isVisible(J)&&p.isEditable(J)&&V.push(J)}),V},Il.prototype.handle_touchmove=function(U){return this.handle_mousemove(U)},Il.prototype.handle_mousemove=function(v){if(!P.Default.isDragging()){var E=this;if((E.editDetail||!Kn()&&!vk(v))&&!E.gv._externalEditing)if(E.gvEditing=!1,E._checkEdit(v))E.gvEditing=!0;else{if(!E.getStyle("hoverGuideVisible"))return;E.hoverData=E.gv.getDataAt(v),E._42()}}},Il.prototype.handle_touchstart=function(E){return this.handle_mousedown(E)},Il.prototype.handle_mousedown=function(h){Rj(h);var q=this;if((q.editDetail||!Kn()&&!vk(h))&&!q.gv._externalEditing){if(or(h)&&!h.clickThrough){if(q.editDetail){if(q._tryQuitEditDetailMode(h))return}else if(q._tryEnterEditDetailMode())return;q.gv.dm().beginTransaction();var f=q.invokeSubModule("handleDoubleClick",!0,h);if(q.gv.dm().endTransaction(),f)return}var O=q._checkEdit(h);O&&(q._downPosition=q._getLogicalPoint(h),q.gv.dm().beginTransaction(),O.startEdit(q,h),q.editing=!0)}},Il.prototype._checkEdit=function(I){var o=this,v=o.gv,B=o._getLogicalPoint(I),s=o.invokeSubModule("check",!0,v,I,B)||null;return o._editMod=s,s},Il.prototype.handleWindowTouchMove=function(J){return this.handleWindowMouseMove(J)},Il.prototype.handleWindowMouseMove=function(l){var z=this,b=z._downPosition;if(b){var G=z._getLogicalPoint(l);if(G.distanceTo(b)<z.getStyle("moveSensitivity"))return;delete z._downPosition}var u=z._editMod;u&&u.handleEdit(z.gv,l)},Il.prototype._getLogicalPoint=function(K){var Y=this,s=P.Default.getLogicalPoint(K,Y._canvas);return new Vq.Math.Vector2(s)},Il.prototype.handleWindowTouchEnd=function(S){return this.handleWindowMouseUp(S)},Il.prototype.handleWindowMouseUp=function(){var N;for(N in{_46O:!0})break;return function(d){var Z=this;Z.editing=!1,Z.setCursor("default"),Z.invokeSubModule(N,!1,d),Z._42(),Z.gv.dm().endTransaction()}}(),Il.prototype.handle_mousewheel=function(u){var c=this;Rj(u),c.invokeSubModule("preHandleScroll",!0)||c.gv.handleScroll(u,u.wheelDelta)},Il.prototype.handleDelete=function(){var w=this;if(!w.editDetail){w.gv.dm().beginTransaction();var j=w.invokeSubModule("handleNormalStateDelete",!0);return w.gv.dm().endTransaction(),j||w.gv.removeSelection(),void 0}w.gv.dm().beginTransaction(),w.invokeSubModule("handleDelete",!0),w.gv.dm().endTransaction(),w._42()},Il.prototype.handle_keydown=function(y){var w=this;if((y.metaKey||y.ctrlKey)&&w._42(),Kn(y)&&!w.editing)return w.gvEditing=!1,w.setCursor("default"),w._42(),void 0;var g=rp(y);return w.editDetail?((g||dk(y))&&(w.editDetail=!1,w._42()),w.gv.dm().beginTransaction(),w.invokeSubModule("handle_keydown",!0,y),w.gv.dm().endTransaction(),void 0):(w.gv.dm().beginTransaction(),w.invokeSubModule("handleNormalStateKeyDown",!0,y),w.gv.dm().endTransaction(),g&&w._tryEnterEditDetailMode(),void 0)},Il.prototype.handle_keyup=function(T){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,T),this.gv.dm().endTransaction()},Il.prototype._tryEnterEditDetailMode=function(){var b=this;return!b.editDetail&&b.invokeSubModule("canEnterEditDetailMode",!0)&&1===b._getValidSelection().length?(b.editDetail=!0,b._42(),!0):void 0},Il.prototype._tryQuitEditDetailMode=function(n){var l=this;return l.editDetail?!n||l.invokeSubModule("canQuitEditDetailMode",!0,n)?(l.editDetail=!1,l._42(),!0):!1:!1},Il.prototype.setStyle=function(t,e,_){var N=this;_?Vq.setStyle(t,e):N._styleMap[t]=e,"baseColor"===t&&(hf=e),N.fp("styleChanged",null,{key:t,value:e,base:_}),N._42()},Il.prototype.getStyle=function(Q){var C=this,T=C._styleMap[Q];return T!==e?T:Vq.getStyle(Q)},Il.prototype.setCursor=function(r){this._resetCustomCursorStyle(),P.graph.EditInteractor.superClass.setCursor.call(this,r)},Il.prototype._drawHostGuide=function(I){var u=this,K=u._context,Z=u.gv;Vq.Icons.DrawIcon(u,K,Vq.Icons.NodeHoverGuide,I.corners);var l=I.host;if(l){var n=Z.getAttachPoints(l);if(n&&n.length)for(var O=0,G=n.length;G>O;O++){var Q=n[O],V=Rb(Z,l,0,Q.offsetX||0,Q.offsetY||0,Q.x,Q.y);V=Vq.toScreenPosition(Z,V),V.isAttach=I.attach===O,Vq.Icons.DrawIcon(u,K,Vq.Icons.AttachPoint,V)}}},Il.prototype._resetCustomCursorStyle=function(){var q=this;if(q._customStyle){var F=this.gv.getView();F.classList&&F.classList.remove&&F.classList.remove(q._customStyle),q._customStyle=null}},Il.prototype._setRotateCursor=function(O){var l=this,R=l._cursorFactory;R||(R=l._cursorFactory=new Vq.CursorFactory(l));var X=R.getRotateCursor(O),j=l.gv.getView();l._resetCustomCursorStyle(),l._customStyle=X,j.classList&&j.classList.add&&j.classList.add(X)};var Vk=Vq.Group=function(e){var c=this;c._entities=e,c._64O=0,c._position={x:0,y:0},c._scale={x:1,y:1},c._anchor={x:.5,y:.5},c._anchor2={x:.5,y:.5}};Vk.prototype={},Vk.prototype.constructor=Vk;var Ke=null;Vk.findOrCreateGroup=function(g){if(Ke&&Ke.checkIsMe(g))return Ke;var K=new Vq.Group(g);return K.getKeyOb()?(Ke=K,K):void 0},Vk.prototype.checkIsMe=function(o){var i=this._entities;if(i.length!==o.length)return!1;var E,d={},v=o.length;for(E=0;v>E;E++)d[o[E]._id]=!0;for(E=0;v>E;E++)if(!d[i[E]._id])return!1;return!0},Vk.prototype.getRotation=function(){return this._64O},Vk.prototype.getPosition=function(){return this._position},Vk.prototype.getAnchor=function(){return this._anchor},Vk.prototype.getWidth=function(){return this._width},Vk.prototype.getScale=function(){return this._scale},Vk.prototype.getSize=function(){return{width:this._width,height:this._height}},Vk.prototype.getHeight=function(){return this._height},Vk.prototype.getKeyOb=function(){for(var F=this._entities,$=F.length-1;$>=0;$--){var K=F[$];if(this.isNode(K))return K}},Vk.prototype.getAnchor2=function(){var O=this,J=O.rotateCenter;if(J)return J;var M=O.getKeyOb();if(!M)return O._anchor;var z=O._anchor2,c=M.getMatrix();return c.tf({x:M.getWidth()*(z.x-M.getAnchor().x),y:M.getHeight()*(z.y-M.getAnchor().y)})},Vk.prototype.setAnchor2=function(f,u){var K=this,h=K.getKeyOb();if(h){var z,e=h.getMatrix();z="number"==typeof f?{x:f,y:u}:f;var J=e.tfi(z);K._anchor2={x:h.getAnchor().x+J.x/h.getWidth(),y:h.getAnchor().y+J.y/h.getHeight()}}},Vk.prototype.setRotation=function(){},Vk.prototype.beginRotate=function(L){this.rotateCenter=L.pos,this.rotateMode=L.groupRotateMode},Vk.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Vk.prototype.addRotation=function(I,Q,D){return"batch"===Q?this._addRotationInBatchMode(I,D):"block"===Q?this._addRotationInBlockMode(I,D):void 0},Vk.prototype._addRotationInBlockMode=function(G,$){var I=this,X=I.rotateCenter||I.getPosition();I._entities.forEach(function(m){if(I.isNode(m)&&(!$||$(m))){var H=m.getMatrix();H.translate(-X.x,-X.y),H.rotate(G),H.translate(X.x,X.y);var l=Math.sign(m.getScale().x);m.setRotation(o(H.b*l,H.a*l)),m.setPosition(H.tx,H.ty)}})},Vk.prototype._addRotationInBatchMode=function(h,m){var U=this,a=U._anchor2;U._entities.forEach(function(s){if(U.isNode(s)&&(!m||m(s))){var e=s.getAnchor(),H=s.getMatrix(),N=H.tf({x:s.getWidth()*(a.x-e.x),y:s.getHeight()*(a.y-e.y)}),S=new Vq.Math.Matrix2d;S.set(H.a,H.b,H.c,H.d,H.tx,H.ty),S.translate(-N.x,-N.y),S.rotate(h),S.translate(N.x,N.y);var f=Math.sign(s.getScale().x);s.setRotation(o(S.b*f,S.a*f)),s.setPosition(S.tx,S.ty)}})},Vk.prototype.setPosition=function(_){var V,R,A,Z,C=this,a=C._position,G=_.x-a.x,y=_.y-a.y,k=C._entities;for(R=0,A=k.length;A>R;R++)V=k[R],$o(V)&&(Z=V.getPosition(),V.setPosition(Z.x+G,Z.y+y));C._position=_},Vk.prototype.setScale=function(R,v){var q=this,J=R/q._scale.x,H=v/q._scale.y;q._adjustChildScaleOrSize(J,H,"size"),q._scale={x:R,y:v}},Vk.prototype.getRect=function(){var $=this,N=$._position,W=$._width,x=$._height;return{x:N.x-W/2,y:N.y-x/2,width:W,height:x}},Vk.prototype.setSize=function(H,Q){var I=this,H=Math.max(1,H),Q=Math.max(1,Q),L=H/I._width,R=Q/I._height;I._adjustChildScaleOrSize(L,R,"size"),I._width=H,I._height=Q},Vk.prototype._adjustChildScaleOrSize=function(u,A,l){var L,d,k,F,n,W,e,E,h,s,i,x,b,$,t=this,K=t._position,M=t._entities,Z=new Vq.Math.Matrix2d;for(d=0,k=M.length;k>d;d++)if(L=M[d],t.isNode(L)){if(F=L.getPosition(),n=L.getRotation(),W=L.getWidth(),e=L.getHeight(),E=L.getScale(),i=E.x*W,x=E.y*e,Z.identity().scale(i,x).rotate(n).translate(F.x,F.y).translate(-K.x,-K.y).rotate(-t._64O),n=o(Z.b*Math.sign(i),Z.a*Math.sign(i)),Z.scale(u,A),h=Math.cos(n),s=Math.sin(n),Math.abs(h)<.001?(b=Z.b/s,$=-Z.c/s):(b=Z.a/h,$=Z.d/h),"scale"===l)L.setScale(b/W,$/e);else if("size"===l){var c=b/E.x,H=$/E.y;L.setScale(_r(b)*Math.abs(E.x),_r($)*Math.abs(E.y)),L.setSize(Math.max(.1,Math.abs(c)),Math.max(.1,Math.abs(H)))}Z.rotate(t._64O).translate(K.x,K.y),L.setPosition(Z.tx,Z.ty)}},Vk.prototype.getMatrix=function(){var u=this,D=u._position,k=P.Default.getInternal(),i=u._scale;return new k.Mat(u._64O,D.x,D.y,i.x,i.y)},Vk.prototype.toGlobal=function(V){return this.getMatrix().tf(V)},Vk.prototype.getCorners=function(){var Q=this,b=Q._width,j=Q._height,O=Q._anchor,D=-b*O.x,B=-j*O.y,l=Q.getMatrix();return[l.tf(D,B),l.tf(D,B+j),l.tf(D+b,B+j),l.tf(D+b,B)]},Vk.prototype.calcInfo=function(){var L,$,e,v,Y,Z,O=this,I=[],Q=O._entities,K=O._64O;for(v=0,Y=Q.length;Y>v;v++)Z=Q[v],O.isNode(Z)&&Z.getCorners&&I.push.apply(I,Z.getCorners());if(I.length){var C=Math.cos(-K),T=Math.sin(-K),D=1/0,j=-1/0,l=1/0,H=-1/0;for(v=0,Y=I.length;Y>v;v++)e=I[v],L=e.x,$=e.y,e.x=C*L-T*$,e.y=T*L+C*$,D=Math.min(D,e.x),j=Math.max(j,e.x),l=Math.min(l,e.y),H=Math.max(H,e.y);O._width=(j-D)/O._scale.x,O._height=(H-l)/O._scale.y,C=Math.cos(K),T=Math.sin(K);var n=O._anchor;L=D+(j-D)*n.x,$=l+(H-l)*n.y,O._position={x:C*L-T*$,y:T*L+C*$}}},Vk.prototype.isNode=function(W){return $o(W)?Ak(W)?W.size()?!1:!0:!0:!1},Vk.prototype._42=function(Y,A,e){var B,E,k,N,W,o,D,$,w=this,T=w._entities,z=w.rotateMode;for("batch"===z&&($=w.getKeyOb()),B=0,E=T.length;E>B;B++)k=T[B],w.isNode(k)&&(o=k.getRect(),N=Vq.toScreenPosition(e,{x:o.x,y:o.y}),W=Vq.toScreenPosition(e,{x:o.x+o.width,y:o.y+o.height}),D={min:N,max:W},k===$&&(D.isKeyOb=!0),Vq.Icons.DrawIcon(Y,A,Vq.Icons.GroupSubEntityRect,D))};var ci=Vq.CurveActiving=function(E,l){this._curve=E,this._interactor=E._interactor,this.silent=!0;for(var T in l)this[T]=l[T];delete this.silent};ci.prototype={},ci.prototype.constructor=ci,N.defineProperties(ci.prototype,{point:{get:function(){return this._point},set:function(U){var t=this;t._point=U,t.editingCtrl||t.silent||t._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(T){var G=this;G._pairs=T,G.editingCtrl&&!G.silent&&G._firePointChange()}}}),ci.prototype._firePointChange=function(){var x=this,G=x.getCurrentEditingPoint(),v=x._interactor;if(!G)return v.fi({kind:"selectPoint"}),void 0;var $=this._curve.target;if($){var _=Vq.getDataMatrix($).invert(),h=G.e;G=_.apply(Vq.toWorldPosition(v.gv,G)),G.e=h;var C=x._lastFirePoint;C&&Math.abs(G.x-C.x)<1e-5&&Math.abs(G.y-C.y)<1e-5&&(G.e==e&&C.e==e||Math.abs(G.e-C.e)<1e-5)||(x._lastFirePoint=G,v.fi({kind:"selectPoint",x:G.x,y:G.y,e:G.e}))}},ci.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ci.prototype.getCurrentEditingPoint=function(){var M=this,C=M.editingCtrl;if(C){var e=M.pairs;if(e){var K=e[C.pairId];if(K){var i=K[C.type];if(i)return i}}}return M._point};var il=Vq.CursorFactory=function(T){var j=this;j._interactor=T,j._rotateCursorStyles={}};il.prototype={},il.prototype.constructor=il,il.prototype.getRotateCursor=function(z){var b=this;0>z&&(z+=2*Math.PI);var S=b._interactor,O=S.getStyle("rotateCursorSize"),C=S.getStyle("rotateCursorRound"),V=Math.round(180*(z/Math.PI)/C);V*C>=360&&(V=0);var I=b._rotateCursorStyles,g="htCustomRotateStyle_"+O+"_"+C+"_"+V;return I[g]||(b._produceRotateCursor(g,O,C,V),I[g]=!0),g},il.prototype._produceRotateCursor=function(N,a,u,h){var c=this;c._interactor;var F=c._canvas;F||(F=c._canvas=x.createElement("canvas")),F.width=F.height=a*devicePixelRatio,F.style.width=F.style.height=a+" px";var d=F.getContext("2d");Vq.setAntialias(d,!1),d.scale(devicePixelRatio,devicePixelRatio);var j,A,l,D,s,L=Math.round(a/2),V=""+L+" "+L+",auto !important;",m=4;j=Math.PI/180*h*u,d.clearRect(0,0,a,a),d.save(),d.scale(a/32,a/32),d.translate(16,15),d.rotate(j+Math.PI/2),d.beginPath(),d.moveTo(-8,0),d.lineTo(-8,m),d.lineTo(-8+m,m),d.moveTo(8,0),d.lineTo(8,m),d.lineTo(8-m,m),d.moveTo(-8,m),d.quadraticCurveTo(0,-6,8,m),d.restore(),d.lineCap="round",d.lineJoin="miter",d.strokeStyle="white",d.lineWidth=4,d.stroke(),d.strokeStyle="black",d.lineWidth=2,d.stroke(),A=JSON.stringify(F.toDataURL()),D="cursor:url("+A+")"+V,1!==devicePixelRatio&&(l='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+a+'px" height="'+a+'px"><image xlink:href='+A+' width="'+a+'" height="'+a+'"/></svg>',D+="cursor:url(data:image/svg+xml;base64,"+btoa(l)+")"+V,D+="cursor:-webkit-image-set(url("+A+")"+devicePixelRatio+"x,url("+A+")1x)"+V),s=x.createElement("style"),s.textContent="body."+N+" *, ."+N+"{"+D+"}",x.head.appendChild(s)
};var Jf=Vq.Guide.Grid=function(S){var n=this;n._interactor=S,n._alignmentGuideId=0,n._xAlignmentGuide=[],n._yAlignmentGuide=[]};Jf.prototype={},Jf.prototype.constructor=Jf,N.defineProperties(Jf.prototype,{gridBlockSize:{get:function(){var p=this;return p._gridBlockSize||p._interactor.getStyle("gridBlockSize")},set:function(R){this._gridBlockSize=R,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Z=this;return Z._gridThickLinesEvery||Z._interactor.getStyle("gridThickLinesEvery")},set:function(w){this._gridThickLinesEvery=w,this._interactor._42()}},gridEnabled:{get:function(){var j=this,k=j._interactor;return k.gridEnabled&&j.isValidGrid()}}}),Jf.prototype._42=function(){var Y=this,y=Y._interactor;Y.gridEnabled&&Y.drawGrid(),y.alignmentGuideEnabled&&Y.drawAlignmentGuide()},Jf.prototype.makeMatrix=function(){var M=this,t=M._interactor.getStyle("gridAngle"),V=M._interactor.getStyle("gridRotation"),o=new Vq.Math.Matrix2d,b=Math.sin(t),q=Math.cos(t);return o.set(1,0,q,b,0,0),o.rotate(V),o},Jf.prototype.isValidGrid=function(){var w=this,I=Math.PI,A=w._interactor,i=A.gv;if(i._zoom<A.getStyle("gridZoomThreshold"))return!1;var e=A.getStyle("gridAngle"),o=Math.abs(180*(e%I/I)),U=1-1e-8;return U>o||o>180-U?!1:!0},Jf.prototype.drawAlignmentGuide=function(){var V=this,R=V._interactor,D=R.gv,k=R._canvas,y=R._context,M=k.width,g=k.height,t=D.tx(),m=D.ty(),b=D._zoom;y.beginPath(),y.strokeStyle=R.getStyle("gridAlignmentGuideColor"),y.lineWidth=1,V._xAlignmentGuide.forEach(function(n){var L=n.p*b+t;y.moveTo(L,0),y.lineTo(L,g)}),V._yAlignmentGuide.forEach(function(J){var p=J.p*b+m;y.moveTo(0,p),y.lineTo(M,p)}),y.stroke()},Jf.prototype.drawGrid=function(){function F(w,h,G,p){var z=Vq.toScreenPosition(d,T.apply({x:w,y:h})),f=Vq.toScreenPosition(d,T.apply({x:G,y:p}));q.moveTo(z.x,z.y),q.lineTo(f.x,f.y)}var v=this,B=v._interactor,g=v.gridBlockSize,w=v.gridThickLinesEvery,U=B.getStyle("gridThickColor"),P=B.getStyle("gridLightColor"),d=B.gv,n=B._canvas,q=B._context,x=n.width,D=n.height,T=v.makeMatrix(),C=T.applyInverse(Vq.toWorldPosition(d,{x:0,y:0})),H=T.applyInverse(Vq.toWorldPosition(d,{x:x,y:0})),c=T.applyInverse(Vq.toWorldPosition(d,{x:0,y:D})),i=T.applyInverse(Vq.toWorldPosition(d,{x:x,y:D})),J=Math.min(C.x,H.x,c.x,i.x),Y=Math.max(C.x,H.x,c.x,i.x),V=Math.min(C.y,H.y,c.y,i.y),Z=Math.max(C.y,H.y,c.y,i.y);x=Y-J,D=Z-V;var p=Math.ceil(J/g),l=Math.floor(Y/g),o=Math.ceil(V/g),W=Math.floor(Z/g);d.tx(),d.ty(),d._zoom;var N,s,I;for(q.save(),q.lineWidth=1,q.beginPath(),q.strokeStyle=U,I=Math.ceil(p/w)*w;l>=I;I+=w)N=I*g,F(N,V,N,Z);for(I=Math.ceil(o/w)*w;W>=I;I+=w)s=I*g,F(J,s,Y,s);for(q.stroke(),q.beginPath(),q.strokeStyle=P,I=p;l>=I;I++)0!==I%w&&(N=I*g,F(N,V,N,Z));for(I=o;W>=I;I++)0!==I%w&&(s=I*g,F(J,s,Y,s));q.stroke(),q.restore()},Jf.prototype.getAlignmentGuides=function(){var J=this;return{x:J._xAlignmentGuide,y:J._yAlignmentGuide}},Jf.prototype.addAlignmentGuide=function($,z,A){var p=this,i="x"===$?p._xAlignmentGuide:p._yAlignmentGuide,A=A?A:++p._alignmentGuideId,F={p:z,id:A};if(i.length){var a=p._findClosestAlignmentGuide(F.p,i);a.dis<0?i.splice(a.index+1,0,F):i.splice(a.index,0,F)}else i.push(F);return p._interactor._42(),A},Jf.prototype.findClosest=function(H,q,$){var m=this,X=m._interactor,b=X.gv;$&&(H=Vq.toWorldPosition(b,H));var J,B,E,w=1/0,a=1/0,f=H.x,u=H.y;if(m.gridEnabled){var O=m.gridBlockSize,R=m.makeMatrix(),i=R.applyInverse(H);i=R.apply({x:Math.round(i.x/O)*O,y:Math.round(i.y/O)*O}),w=i.x-f,a=i.y-u,E=!0}if(X.alignmentGuideEnabled&&(J=m._findClosestAlignmentGuide(f,m._xAlignmentGuide).dis,B=m._findClosestAlignmentGuide(u,m._yAlignmentGuide).dis,Math.abs(J)<Math.abs(w)&&(w=J,E=!0),Math.abs(B)<Math.abs(a)&&(a=B,E=!0)),E){E=!1;var N=b._zoom,j=X.getStyle("smartGuideThreshold")/N,v={};if(Math.abs(w)<j&&"y"!==q&&(v.x=$?w*N:w,E=!0),Math.abs(a)<j&&"x"!==q&&(v.y=$?a*N:a,E=!0),E)return v}},Jf.prototype._findClosestAlignmentGuide=function(a,K){if(!K.length)return{dis:1/0};for(var r,N=0,v=K.length-1;v-N>1;)r=Math.floor((N+v)/2),K[r].p<a?N=r:v=r;var A=K[N].p-a,$=K[v].p-a;return Math.abs(A)<=Math.abs($)?{line:K[N],dis:A,index:N}:{line:K[v],dis:$,index:v}},Jf.prototype.removeAllAlignmentGuide=function(C){var p=this;"y"!==C&&(p._xAlignmentGuide=[]),"x"!==C&&(p._yAlignmentGuide=[]),p._interactor._42()},Jf.prototype.removeAlignmentGuide=function(X){for(var G,D,f,s=this,I=s._xAlignmentGuide,Q=0;2>Q;Q++)for(I=0===Q?s._xAlignmentGuide:s._yAlignmentGuide,G=0,D=I.length;D>G;G++)if(f=I[G],f.id===X)return I.splice(G,1),s._interactor._42(),{axis:0===Q?"x":"y",position:f.p};return!1},Jf.prototype.adjustAlignmentGuide=function(T,u){var J=this,b=J.removeAlignmentGuide(T);return b?(J.addAlignmentGuide(b.axis,u,T),!0):!1};var Qd=Vq.Guide.Rect=function(x){var z=this;z._interactor=x};Qd.prototype={},Qd.prototype.constructor=Qd,Qd.prototype.gatherRects=function(){var u,N,I,R,B=this,M=B._interactor.gv,Z=[],A=[],L={x:Z,y:A},p={},K=M.getDataModel(),e=K.a("width"),H=K.a("height");e&&H&&(u=0,N=0,I=e,R=H,Z.push({node:K,type:0,p:u},{node:K,type:1,p:u+I/2},{node:K,type:2,p:u+I}),A.push({node:K,type:0,p:N},{node:K,type:1,p:N+R/2},{node:K,type:2,p:N+R}),p[K._id||0]={x:u,y:N,width:I,height:R}),K.each(function(h){if($o(h)&&!M.isSelected(h)&&M.isVisible(h)&&M.isValidGuideLineSource(h)){var d=!1;if(M.sm().getSelection().each(function(m){d||(h.isHostOn(m)?d=!0:h.isDescendantOf(m)&&(d=!0))}),!d){var l=h.getRect();u=l.x,N=l.y,I=l.width,R=l.height,Z.push({node:h,type:0,p:u},{node:h,type:1,p:u+I/2},{node:h,type:2,p:u+I}),A.push({node:h,type:0,p:N},{node:h,type:1,p:N+R/2},{node:h,type:2,p:N+R}),p[h._id]=l}}}),Z.sort(function(c,m){return c.p-m.p}),A.sort(function(h,y){return h.p-y.p}),B._grid=L,B._87I=p},Qd.prototype.gatherLines=function(z,D,o){var N,Y,K,L,m,u,M,b,v,e,j,$,d=this,c=[d.findClosest({x:z.x,y:z.y},D),d.findClosest({x:z.x+z.w/2,y:z.y+z.h/2},D),d.findClosest({x:z.x+z.w,y:z.y+z.h},D)],A={},k=d._87I;o=o||255;var X,t;for(d._guideLine=[],N=0;2>N;N++)for(A={},0===N?(L="y",b=z.x,v=b+z.w):(L="x",b=z.y,v=b+z.h),Y=0;3>Y;Y++)m=c[Y],m&&isFinite(m[L])&&(X=1<<3*N+Y,o&X&&(u=m[L+"Line"],M=u.node,t=M._id||0,A[t]||(A[t]=!0,$=k[t],"y"===L?(e=$.x,j=$.x+$.width):(e=$.y,j=$.y+$.height),K=u.p,d._guideLine.push({type:L,a:b,b:v,c:e,d:j,p:K,center:1===u.type}))))},Qd.prototype._binarySearchClosest=function(G,K){if(!K.length)return{dis:1/0};for(var e,W=0,a=K.length-1;a-W>1;)e=Math.floor((W+a)/2),K[e].p<G?W=e:a=e;var E=K[W].p-G,J=K[a].p-G;return Math.abs(E)<=Math.abs(J)?{line:K[W],dis:E}:{line:K[a],dis:J}},Qd.prototype.findClosest=function(k,o,A){var r=this,B=r._interactor,b=B.gv,$=r._grid;A&&(k=Vq.toWorldPosition(b,k));var e,E=r._binarySearchClosest(k.x,$.x),m=r._binarySearchClosest(k.y,$.y),C=E.dis,P=m.dis,V=b._zoom,x=B.getStyle("smartGuideThreshold")/V,l={};return Math.abs(C)<x&&"y"!==o&&(l.x=A?C*V:C,l.xLine=E.line,e=!0),Math.abs(P)<x&&"x"!==o&&(l.y=A?P*V:P,l.yLine=m.line,e=!0),e?l:void 0},Qd.prototype._42=function(){var w=this,D=w._guideLine;if(D&&!P.Default.isCtrlDown()){var $=w._interactor;if($.getStyle("guideLineVisible")){var z,v,G,X,y,W,M,F,m,A,l,S,s,E,k,e,o,Q=$.gv,u=$._context,J=Q.tx(),i=Q.ty(),V=Q._zoom,L=$.getStyle("guideLineTextSpacing");for(z=0,v=D.length;v>z;z++)G=D[z],F=G.type,m=G.p,A=G.a,l=G.b,S=G.c,s=G.d,E=Math.min(A,S),k=Math.max(l,s),"x"===F?(X=m*V+J,y=E*V+i,W=X,M=k*V+i):(X=E*V+J,y=m*V+i,W=k*V+J,M=y),Vq.Icons.DrawIcon($,u,Vq.Icons.MoveLineGuide,{rect:[X,y,W,M],center:G.center}),s>=A&&l>=S||(E=A>s?s:l,k=A>s?A:S,o=k-E,"x"===F?(G.center2center||(X-=L,W=X),y=E*V+i,M=k*V+i,e=Vq.Icons.MoveLineGuideDistanceV):"y"===F&&(G.center2center||(y-=L,M=y),X=E*V+J,W=k*V+J,e=Vq.Icons.MoveLineGuideDistanceH),Vq.Icons.DrawIcon($,u,e,{x0:X,y0:y,x1:W,y1:M,dis:o}))}}},Qd.prototype.clear=function(){this._guideLine=null};var bs=Vq.Guide.Hover=function(m){var i=this;i._interactor=m};bs.prototype={},bs.prototype.constructor=bs,N.defineProperties(bs.prototype,{}),bs.prototype._42=function(){var M=this._interactor;if(M.getStyle("hoverGuideVisible")&&!M.gvEditing){var v=M.hoverData,w=M.gv;if(!$o(v)||w.isSelected(v))return M.hoverData=null,void 0;var j=kb(w,v),Y=Vq.toScreenPosition(w,{x:j.x,y:j.y}),f=Vq.toScreenPosition(w,{x:j.x+j.width,y:j.y+j.height});Vq.Icons.DrawIcon(M,M._context,Vq.Icons.HoverDataRect,{min:Y,max:f,color:M.getStyle("hoverGuideColor")||M.getStyle("baseColor")})}},Vq.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Fq=Vq.Icons={},sl=1e4,pf=null,hf=Vq.DefaultStyleMap.baseColor,re="rgb(183,232,135)",Xm="rgb(255,204,153)",Sk=6;P.Default.setImage("Icons.RectPoint",{width:Sk,height:Sk,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return hf}},rect:[0,0,Sk,Sk]}]}),Fq.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var M=Fq.GroupSubEntityRect.data;if(!M)return[];var K=M.min,h=M.max;return[K.x,K.y,K.x,h.y,h.x,h.y,h.x,K.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Fq.GroupSubEntityRect.data.isKeyOb?hf:hf}}}]};var Mg=4;Fq.HoverDataRect={comps:[{type:"shape",points:{func:function(){var G=Fq.HoverDataRect.data;if(!G)return[];var Y=G.min,y=G.max,M=Mg;return Y.x-=M,Y.y-=M,y.x+=M,y.y+=M,[Y.x,Y.y,Y.x,y.y,y.x,y.y,y.x,Y.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Fq.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Fq.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Fq.Line.data.P1.x,Fq.Line.data.P1.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Fq.Line.data.P2.x,Fq.Line.data.P2.y],Sk,Sk]}}}]},Fq.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Fq.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Fq.Rect={comps:[{type:"shape",points:{func:function(){var r=Fq.Rect.data;if(!r)return[];var _=r.LT,h=r.LB,z=r.RB,m=r.RT;return[_.x,_.y,h.x,h.y,z.x,z.y,m.x,m.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return hf}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},rect:{func:function(){return[[Fq.Rect.data.LT.x,Fq.Rect.data.LT.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},rect:{func:function(){return[[Fq.Rect.data.LB.x,Fq.Rect.data.LB.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},rect:{func:function(){return[[Fq.Rect.data.RB.x,Fq.Rect.data.RB.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},rect:{func:function(){return[[Fq.Rect.data.RT.x,Fq.Rect.data.RT.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},visible:{func:function(){return Fq.Rect.data.L?!0:!1}},rect:{func:function(){return[[Fq.Rect.data.L.x,Fq.Rect.data.L.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},visible:{func:function(){return Fq.Rect.data.R?!0:!1}},rect:{func:function(){return[[Fq.Rect.data.R.x,Fq.Rect.data.R.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},visible:{func:function(){return Fq.Rect.data.T?!0:!1}},rect:{func:function(){return[[Fq.Rect.data.T.x,Fq.Rect.data.T.y],Sk,Sk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fq.Rect.data.rotation}},visible:{func:function(){return Fq.Rect.data.B?!0:!1}},rect:{func:function(){return[[Fq.Rect.data.B.x,Fq.Rect.data.B.y],Sk,Sk]}}}]};var Hn=16;P.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return hf}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return hf}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Fq.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Fq.Anchor.data.POS.x,Fq.Anchor.data.POS.y],Hn,Hn]}}}]},Fq.TipShiftX=12,Fq.TipShiftY=12;var Xr=[8,28];Fq.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Fq.TipHelper.data.helperPos.x,Fq.TipHelper.data.helperPos.y,Xr[0]*Fq.TipHelper.data.size,Xr[1]]}},background:{func:function(){return pf.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Fq.TipHelper.data.text}},rect:{func:function(){return[Fq.TipHelper.data.helperPos.x,Fq.TipHelper.data.helperPos.y,Xr[0]*Fq.TipHelper.data.size,Xr[1]]}},color:{func:function(){return pf.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var hj=7;Fq.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Fq.ShapePoint.data.dynamicVisible}},rect:{func:function(){var e=Fq.ShapePoint.data.point,I=Fq.ShapePoint.data.size||hj;return[e,I+10,I+10]}},background:{func:function(){var F=Date.now(),w=Fq.ShapePoint.data.dynamicPeriod||1500,H=Math.sin(F%w/w*Math.PI);return"rgba(27,124,22,"+.5*H+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var d=Fq.ShapePoint.data.point,O=Fq.ShapePoint.data.size||hj;return[d,O,O]}},background:{func:function(){var t=Fq.ShapePoint.data.isEnd;return t?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Fq.ShapePoint.data.color||hf}}},{type:"rect",visible:{func:function(){return!!Fq.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return hf}},rect:{func:function(){var w=5;return[Fq.ShapePoint.data.point,w,w]}}}]},Fq.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Fq.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Fq.ShapeBgCurve.data.P}},segments:{func:function(){return Fq.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var _=Date.now(),E=Fq.ShapeBgCurve.data.dynamicPeriod||1500,x=Math.sin(_%E/E*Math.PI);return"rgba(27,124,22,"+.3*x+")"}}},{type:"shape",points:{func:function(){return Fq.ShapeBgCurve.data.P}},segments:{func:function(){return Fq.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Fq.ShapeBgCurve.data.color||hf}}}]};var vr=8;Fq.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var Q=Fq.ShapeHighlighPoint.data;return[[Q.x,Q.y],vr,vr]}},background:{func:function(){return pf.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var yq=10;Fq.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var r=Fq.ShapeHighlighRealPoint.data;return[[r.x,r.y],yq,yq]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return hf}}}]};var $b=8;Fq.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var B=Fq.ShapeHighlighCtrlPoint.data,p=B.x,T=B.y,P=$b/2;return[p-P,T-P,p-P,T+P,p+P,T+P,p+P,T-P]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return pf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return pf.getStyle("shapeCtrlPointBorderColor")||hf}}}]};var Wb=3;Fq.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Fq.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Wb,borderColor:{func:function(){return pf.getStyle("curveHighlightColor")}}}]},Fq.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Fq.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Fq.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Fq.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Fq.MoveLineGuide.data.center?re:Xm}}}]};var dq=5;Fq.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var $=Fq.MoveLineGuideDistanceH.data,Q=$.x0,r=$.y0;return[Q,r-dq,Q,r+dq]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Xm},{type:"shape",points:{func:function(){var m=Fq.MoveLineGuideDistanceH.data,D=m.x1,t=m.y1;return[D,t-dq,D,t+dq]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Xm},{type:"text",text:{func:function(){return Math.round(Fq.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var k=Fq.MoveLineGuideDistanceH.data;return[[(k.x0+k.x1)/2,k.y0-10],20,20]}},color:Xm,font:"12px Arial",align:"center"}]},Fq.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var g=Fq.MoveLineGuideDistanceV.data,H=g.x0,d=g.y0;return[H-dq,d,H+dq,d]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Xm},{type:"shape",points:{func:function(){var K=Fq.MoveLineGuideDistanceV.data,f=K.x1,V=K.y1;return[f-dq,V,f+dq,V]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Xm},{type:"text",text:{func:function(){return Math.round(Fq.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var b=Fq.MoveLineGuideDistanceV.data;return[[b.x0-10,(b.y0+b.y1)/2],20,20]}},color:Xm,font:"12px Arial",align:"center"}]},P.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Fq.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var t=Fq.EdgeElevationGuide.data,Q=t.x,$=t.y,E=pf.getStyle("curveElevationIntersectSize"),N=pf.getStyle("curveElevationGuideShift");return Q+=N[0],$+=N[1],[Q-E,$-E,2*E,2*E]}}}]},P.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),P.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Fq.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Fq.ConnectGuide.data.rotation}},rect:{func:function(){var r=Fq.ConnectGuide.data.connect;r.x,r.y;var V=pf.getStyle("connectGuideIntersectSize");return[[r.x,r.y],2*V,2*V]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var Q=Fq.ConnectGuide.data.cursorPos||Fq.ConnectGuide.data.connect,f=pf.getStyle("connectGuideIntersectSize");return[[Q.x,Q.y],2*f-2,2*f-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var W=Fq.ConnectGuide.data.connect,D=Fq.ConnectGuide.data.cursorPos||W;return[W.x,W.y,W.x+.5*(D.x-W.x),W.y,D.x+.5*(W.x-D.x),D.y,D.x,D.y]}}}]},P.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),P.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Fq.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var E=Fq.ConnectGuideGarbage.data.hover;return E?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var d=Fq.ConnectGuideGarbage.data,F=pf.getStyle("connectGuideGarbageIntersectsize");return d.hover&&(F+=5),[[d.x,d.y],2*F,2*F]}}}]};var To=6;Fq.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Fq.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var I=Fq.ShapeActivingCtrl.data;return[I.point.x,I.point.y,I.c1.x,I.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return hf}}},{type:"shape",visible:{func:function(){return Fq.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var f=Fq.ShapeActivingCtrl.data;return[f.point.x,f.point.y,f.c2.x,f.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return hf}}},{type:"shape",visible:{func:function(){return Fq.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var F=Fq.ShapeActivingCtrl.data.c1,o=F.x,L=F.y,w=To/2;return"c1"===Fq.ShapeActivingCtrl.data.hl&&(w+=.5),[o-w,L-w,o-w,L+w,o+w,L+w,o+w,L-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return pf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Fq.ShapeActivingCtrl.data.hl?pf.getStyle("shapeCtrlPointHighlightBorder")||hf:pf.getStyle("shapeCtrlPointBorderColor")||hf}}},{type:"shape",visible:{func:function(){return Fq.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var E=Fq.ShapeActivingCtrl.data.c2,$=E.x,e=E.y,q=To/2;return"c2"===Fq.ShapeActivingCtrl.data.hl&&(q+=.5),[$-q,e-q,$-q,e+q,$+q,e+q,$+q,e-q]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return pf.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Fq.ShapeActivingCtrl.data.hl?pf.getStyle("shapeCtrlPointHighlightBorder")||hf:pf.getStyle("shapeCtrlPointBorderColor")||hf}}}]},Fq.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return hf}},rect:{func:function(){return[[Fq.RoundPoint.data.x,Fq.RoundPoint.data.y],Sk,Sk]}}}]},Fq.AttachPoint={comps:[{type:"rect",background:{func:function(){return Fq.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return hf}},rect:{func:function(){var K=Fq.AttachPoint.data.isAttach?Sk+4:Sk;return[[Fq.AttachPoint.data.x,Fq.AttachPoint.data.y],K,K]}}}]},Fq.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Fq.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Fq.SimpleRect.data.color||hf}},rect:{func:function(){var W=Fq.SimpleRect.data;return[W.x,W.y,W.width,W.height]}}}]},P.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Fq.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var K=Fq.MoveDummy.data;return[[K.pos.x,K.pos.y],2*K.size,2*K.size]}}}]},Vq.Icons.DrawIcon=function(u,v,S,x){S.width=S.height=sl,S.data=x,pf=u,P.Default.drawImage(v,S,0,0,sl,sl)},Vq.Icons.MapPoints=function(t,P){for(var e=0,i=t.length;i>e;e++)t[e]/=P},Vq.roundTo=function(j,J,G){var X=Math.abs(j%J);return G>X||G>J-X?J*Math.round(j/J):j},Vq.toFixed=function(q){return Math.round(100*q)/100},Vq.getDataMatrix=function(U){if(U instanceof P.Shape){var L=new P.Math.Matrix2d,n=U.getPosition();return L.translate(-n.x,-n.y).scale(U.getScale().x,U.getScale().y).rotate(U.getRotation()).translate(n.x,n.y),L}return U.getMatrix?U.getMatrix():new P.Math.Matrix2d};var po=Vq.Math.Curve=function(){this._curves=[]};po.prototype={},po.prototype.constructor=po,po.prototype.createFromHtShape=function(E,j,x){j instanceof P.List&&(j=j.toArray());var C,p,w,B,X,M,s,N=this,S=null,f=null,Z=0,g=Vq.Math.Vector2,D=Vq.Math.CubicBezier,O=function(V){return new g(E[V],E[V+1],x?x[V/2]:e)};for(p=0,w=j.length;w>p;p++){switch(B=j[p],X=null,B){case 1:f=O(Z),S=f,Z+=2;break;case 2:C=O(Z),Z+=2,X=new D(f,f.clone(),C.clone(),C),f=C;break;case 3:M=O(Z),C=O(Z+2),Z+=4,X=new D(f,M.clone().sub(f).multiplyScalar(2/3).add(f),M.clone().sub(C).multiplyScalar(2/3).add(C),C),f=C;break;case 4:M=O(Z),s=O(Z+2),C=O(Z+4),Z+=6,X=new D(f,M,s,C),f=C;break;case 5:if(!S)break;X=new D(f,f.clone(),S.clone(),S),f=null,S=null}X&&(X._index=N._curves.length,N._curves.push(X))}},po.prototype.checkPoint=function(T,C){var b,x,E,Y,L,i=this,l=i._curves;for(b=0,x=l.length;x>b;b++)if(Y=l[b],L=Y.intersectRect(T,C,C),L.length)return E=0,L.forEach(function(S){E+=S.t}),E/=L.length,T=Y.getPointAt(E),T.t=E,{bezier:Y,intersection:T}},po.prototype.insertKnot=function(q,M){var z=q.insertKnot(M),e=this,y=e._curves;y.splice(q._index,1,z[0],z[1])},po.prototype._isCloseEnough=function(O,N){return Math.abs(O.x-N.x)<1e-6&&Math.abs(O.y-N.y)<1e-6},po.prototype._isSamePoint=function(x,Y){return x===Y},po.prototype.moveRealPoint=function(K,l){var $=this,c=$._curves,A=l.clone().sub(K);c.forEach(function(r){var Q=r._p1;r._p2,r._p3;var y=r._p4;$._isSamePoint(Q,K)&&(r._p2.add(A),r._p1=l),$._isSamePoint(y,K)&&(r._p3.add(A),r._p4=l)})},po.prototype.moveCtrlDueToRealPointMovement=function(S,d){var s=this,u=s._curves,G=function(n){n.add(d),n.e&&d.e&&(n.e+=d.e)};u.forEach(function(x){var H=x._p1;x._p2,x._p3;var z=x._p4;s._isSamePoint(H,S)&&G(x._p2),s._isSamePoint(z,S)&&G(x._p3)})},po.prototype.moveCtrlPoint=function(s,h,E){var t=s[E];if(t){t.e!==e&&(h.e=t.e);var M=this,w=M._curves;h.clone().sub(t),w.forEach(function(U){var R;"c2"===E?R="_p2":"c1"===E&&(R="_p3"),M._isSamePoint(U[R],t)&&(U[R]=h)}),s[E]=h}},po.prototype.deleteRealPoint=function(m,E){var j,r,X,d,y,p,b,Z=this,t=Z._curves,h={},W=[],e=Vq.Math.CubicBezier;for(r=0,X=t.length;X>r;r++)j=t[r],d=j._p1,y=j._p2,p=j._p3,b=j._p4,(h[r]||!Z._isSamePoint(d,m))&&(Z._isSamePoint(b,m)?X>r+1&&Z._isSamePoint(t[r+1]._p1,m)&&(E||W.push(new e(d,y,t[r+1]._p3,t[r+1]._p4))):W.push(j));Z._curves=W},po.prototype.findPairs=function(T,$){var l,u,E,D,j,G,F,L,s=this,B=s._curves,Q={},Y=[];for(u=0,E=B.length;E>u;u++)l=B[u],D=l._p1,j=l._p2,G=l._p3,F=l._p4,!Q[u]&&s._isSamePoint(D,T)&&($?Y.push({point:D,r2:F}):Y.push({point:D,c2:j})),s._isSamePoint(F,T)&&(L=$?{point:F,r1:D}:{point:F,c1:G},E>u+1&&s._isSamePoint(B[u+1]._p1,T)&&($?L.r2=B[u+1]._p4:L.c2=B[u+1]._p2,Q[u+1]=!0),Y.push(L));return Y},po.prototype.toHtShape=function(){var D=this,e=D._curves,P=[],s=[],d={x:1/0,y:1/0};return e.forEach(function(W){var x=W._p1,M=W._p2,C=W._p3,$=W._p4;return D._isCloseEnough(x,d)||(P.push(1),s.push(x.clone())),d=$,D._isCloseEnough(x,M)&&D._isCloseEnough(C,$)?(P.push(2),s.push($.clone()),void 0):(P.push(4),s.push(M.clone(),C.clone(),$.clone()),void 0)}),{segments:P,points:s}};var Lr=Vq.Math.CubicBezier=function(q,n,j,B){var W=this;W._id=Vq.Math.CubicBezier._globalId++,W._p1=q,W._p2=n,W._p3=j,W._p4=B
};Lr._globalId=1,Lr.prototype={},Lr.prototype.constructor=Lr,Lr.prototype.toString=function(){return this._id},Lr.prototype.intersectRect=function(S,U,e){var u=U/2,O=e/2,q=S.x,E=S.y,M=Vq.Math.Vector2,D=new M(-u+q,-O+E),B=new M(u+q,O+E),Q=new M(B.x,D.y),w=new M(D.x,B.y),g=this,p=g.intersectLine(D,Q),C=g.intersectLine(Q,B),R=g.intersectLine(B,w),G=g.intersectLine(w,D),J=p.concat(C).concat(R).concat(G);return J},Lr.prototype.intersectLine=function(Z,F){var I,R,e,T,m,K,H,b,Y,O,Q,d,_,D=this,f=Z.clone().min(F),$=Z.clone().max(F);T=D._p1,m=D._p2,K=D._p3,H=D._p4,I=T.clone().multiplyScalar(-1),R=m.clone().multiplyScalar(3),e=K.clone().multiplyScalar(-3),Q=I.add(R).add(e).add(H),I=T.clone().multiplyScalar(3),R=m.clone().multiplyScalar(-6),e=K.clone().multiplyScalar(3),O=I.add(R).add(e),I=T.clone().multiplyScalar(-3),R=m.clone().multiplyScalar(3),Y=I.add(R),b=T.clone(),_=new Vq.Math.Vector2(Z.y-F.y,F.x-Z.x),d=Z.x*F.y-F.x*Z.y;for(var S=D.getRoots(_.dot(Q),_.dot(O),_.dot(Y),_.dot(b)+d),E=new Array,p=0,c=S.length;c>p;p++){var q=S[p];if(!(0>q||q>1)){var W=T.clone().lerp(m,q),A=m.clone().lerp(K,q),g=K.clone().lerp(H,q),k=W.lerp(A,q),C=A.lerp(g,q),r=k.lerp(C,q);r.t=q,Z.x==F.x?f.y<=r.y&&r.y<=$.y&&E.push(r):Z.y==F.y?f.x<=r.x&&r.x<=$.x&&E.push(r):r.x>=f.x&&r.y>=f.y&&r.x<=$.x&&r.y<=$.y&&E.push(r)}}return E},Lr.prototype.solveTForPoint=function(Y){var X,k,g,u,_=this;X=_._p1.x-Y.x,k=_._p2.x-Y.x,g=_._p3.x-Y.x,u=_._p4.x-Y.x;for(var i=_.getRoots(u-3*g+3*k-X,3*g-6*k+3*X,3*k-3*X,X),L=e,n=1/0,z=0,c=i.length;c>z;z++){var O=i[z];if(!(0>O||O>1)){var T=_._p1.clone().lerp(_._p2,O),F=_._p2.clone().lerp(_._p3,O),x=_._p3.clone().lerp(_._p4,O),v=T.lerp(F,O),w=F.lerp(x,O),A=v.lerp(w,O);A.t=O;var I=Math.abs(A.y-Y.y);n>I&&(n=I,L=A)}}return L},Lr.prototype.getPointAt=function(K){var U=this,f=U._p1,q=U._p2,V=U._p3,H=U._p4,y=f.clone().lerp(q,K),F=q.clone().lerp(V,K),k=V.clone().lerp(H,K),J=y.lerp(F,K),u=F.lerp(k,K);return J.lerp(u,K)},Lr.prototype.getRoots=function(e,h,$,Q){var P,j,Y,L,t,D=new Array;if(Math.abs(e)<1e-6){var P=h,j=$/P,Y=Q/P,L=j*j-4*Y;if(L>0){var t=Math.sqrt(L);D.push(.5*(-j+t)),D.push(.5*(-j-t))}else 0==L&&D.push(.5*-j)}h/=e,$/=e,Q/=e,P=(3*$-h*h)/3,j=(2*h*h*h-9*$*h+27*Q)/27;var o=h/3,x=j*j/4+P*P*P/27,m=j/2;if(Math.abs(x)<=1e-6&&(x=0),x>0){var I,v,t=Math.sqrt(x);I=-m+t,v=I>=0?Math.pow(I,1/3):-Math.pow(-I,1/3),I=-m-t,I>=0?v+=Math.pow(I,1/3):v-=Math.pow(-I,1/3),D.push(v-o)}else if(0>x){var w=Math.sqrt(-P/3),s=Math.atan2(Math.sqrt(-x),-m)/3,O=Math.cos(s),Z=Math.sin(s),J=Math.sqrt(3);D.push(2*w*O-o),D.push(-w*(O+J*Z)-o),D.push(-w*(O-J*Z)-o)}else{var I;I=m>=0?-Math.pow(m,1/3):Math.pow(-m,1/3),D.push(2*I-o),D.push(-I-o)}return D},Lr.prototype._70I=function(){var K=this;return K._p1.distanceToSquared(K._p2)<1e-10&&K._p3.distanceToSquared(K._p4)<1e-10},Lr.prototype.insertKnot=function(c){var N=this,S=N._p1,b=N._p2,v=N._p3,y=N._p4,D=S.clone().lerp(b,c),f=b.clone().lerp(v,c),Q=v.clone().lerp(y,c),h=D.clone().lerp(f,c),w=f.clone().lerp(Q,c),X=h.clone().lerp(w,c);return N._70I()?(S.clone().lerp(y,c),[new Vq.Math.CubicBezier(S,S.clone(),X.clone(),X),new Vq.Math.CubicBezier(X,X.clone(),y.clone(),y)]):[new Vq.Math.CubicBezier(S,D,h,X),new Vq.Math.CubicBezier(X,w,Q,y)]};var wc=P.Default.getInternal().ui().EdgeUI,wm={_47O:function(X){var d=this,V=wm.getBackups()._47O;Vq.inEdit(d.gv)||V.call(d,X)}};Vq.Inject.registAsModule(wm,wc);var op=P.Default.getInternal().ui().NodeUI,Kq={_47O:function(v){var S=this,F=Kq.getBackups()._47O;Vq.inEdit(S.gv)||F.call(S,v)},getSelectWidth:function(){var g=this,W=g.gv,O=g._data;if(W.isEditable(O)&&Vq.inEdit(W))return 0;var j=Kq.getBackup("getSelectWidth");return j.call(g)}};Vq.Inject.registAsModule(Kq,op);var Bb=P.graph.GraphView,hi={_editPointSize:function(){var C=P.Default.isTouchable,q=Vq.getStyle("pointSize");return q[C?0:1]}(),isPointEditable:function(U){var z=this;if(Vq.inEdit(z))return z._pointEditableFunc?z._pointEditableFunc(U):!0;var q=hi.getBackup("isPointEditable");q.call(z,U)},isEditable:function(E){var c,s=this,j=hi.getBackup("isEditable");if(c=E instanceof Vq.Group?!0:j.call(s,E),!Vq.inEdit(s))return c;if(!(E instanceof P.Edge))return c;if(!E.s("2d.editable"))return!1;var k=s.getEditableFunc();return k?k(E):!0},_42:function(L,s){var G=this,r=hi.getBackups()._42;if(r.call(G,L,s),Vq.inEdit(G)){var x=G.getEditInteractor();x.drawImpl()}}};Vq.Inject.registAsModule(hi,Bb);var vq=P.Default.getInternal().ui().ShapeUI,Re={_47O:function(E){var K=this,$=Re.getBackups()._47O;Vq.inEdit(K.gv)||$.call(K,E)}};Vq.Inject.registAsModule(Re,vq);var eq=P.graph.DefaultInteractor,wq={handle_mousewheel:function(R){var I=this,N=wq.getBackup("handle_mousewheel");Vq.inEdit(I.gv)||N.call(I,R)}};Vq.Inject.registAsModule(wq,eq);var _e=P.graph.MoveInteractor,Wo={_calcShift:function(q,g){var O=this,t=Wo.getBackup("_calcShift"),m=O.gv;if(!Vq.inEdit(m))return t.call(O,q,g);var T=m.getEditInteractor(),Q=T.getSubModule("Move").calcShift(q,g,O);return Q||t.call(O,q,g)},clear:function(c){var x=this,q=Wo.getBackup("clear");q.call(x,c);var Q=x.gv;if(Vq.inEdit(Q)){var b=Q.getEditInteractor();b.getSubModule("Move").clear(c)}}};Vq.Inject.registAsModule(Wo,_e);var Qd=Vq.Rect=function(B){this.catalog="Rect",this._interactor=B};Qd.prototype={},Qd.prototype.constructor=Qd,Qd.prototype.gatherInfo=function(p,n){var j=this;if(1===n.length){var w=n[0];return w instanceof P.Shape&&w._70I()?j.gatherLine(p,w):Ak(w,p)?!1:j.gatherSingleTarget(p,w)}return n.length>1?j.gatherMultiTargets(p,n):!1},Qd.prototype.gatherSingleTarget=function(r,f){if(f.getCorners){var W,v=this,F=v.info;v.target=f,W=v.screenInfo={};var c=f.getCorners();F.LT=new Vq.Math.Vector2(c[0]),F.LB=new Vq.Math.Vector2(c[1]),F.RB=new Vq.Math.Vector2(c[2]),F.RT=new Vq.Math.Vector2(c[3]),F.T=F.LT.clone().add(F.RT).divideScalar(2),F.B=F.LB.clone().add(F.RB).divideScalar(2),F.L=F.LT.clone().add(F.LB).divideScalar(2),F.R=F.RT.clone().add(F.RB).divideScalar(2);for(var E in F)W[E]=Vq.toScreenPosition(r,F[E]);var i=v._interactor,Q=i.getStyle("checkSize"),C=function(v,j,g){var p=j.clone().sub(v).setLength(-Q),I=g.clone().sub(v).setLength(-Q),Z=p.add(I).add(v);return Z};return W.rotLT=C(W.LT,W.RT,W.LB),W.rotLB=C(W.LB,W.LT,W.RB),W.rotRB=C(W.RB,W.LB,W.RT),W.rotRT=C(W.RT,W.LT,W.RB),W.rotT=W.rotLT.clone().add(W.rotRT).divideScalar(2),W.rotB=W.rotLB.clone().add(W.rotRB).divideScalar(2),W.rotL=W.rotLT.clone().add(W.rotLB).divideScalar(2),W.rotR=W.rotRT.clone().add(W.rotRB).divideScalar(2),W.rotation=f.getRotation(),v.gatherConnectInfo(),!0}},Qd.prototype.gatherConnectInfo=function(){var F=this,z=F.target,K=F._interactor,f=F.screenInfo,t=K.gv;if(t.isConnectActionVisible(z)&&K.getStyle("connectGuideVisible")){var Y;z.s&&(Y=z.s("connectGuideShift")),Y||(Y=K.getStyle("connectGuideShift"));var E=z.getAnchor(),S=z.getSize(),s=z.toGlobal({x:S.width*(Y[0]-E.x),y:S.height*(Y[1]-E.y)});s=Vq.toScreenPosition(t,s),f.P1?s.add(f.P2.clone().sub(f.P1).setLength(Y[2])):(s.add(f.RT.clone().sub(f.LT).setLength(Y[2])),s.add(f.LB.clone().sub(f.LT).setLength(Y[3]))),f.connect=s}},Qd.prototype.gatherMultiTargets=function(A,u){var B=Vq.Group.findOrCreateGroup(u);if(!B)return!1;var t=this;return t.editing&&"rotate"!==t.editing.mode||B.calcInfo(),t.gatherSingleTarget(A,B)},Qd.prototype.gatherLine=function(Z,L){this.target=L;var d=this.screenInfo={},n=L.getPoints(),O=Vq.getDataMatrix(L);return d.P1=Vq.toScreenPosition(Z,O.apply(n.get(0))),d.P2=Vq.toScreenPosition(Z,O.apply(n.get(1))),this.gatherConnectInfo(),!0},Qd.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Qd.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Qd.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Qd.prototype.check=function(s,p,I){if(P.Default.isLeftButton(p)){var F=this;if(F.editing=null,F.tipInfo=null,F.screenInfo){var Y=F.target,U=s.isEditable(Y),X=F.screenInfo;if(U&&X.connect){var t=F._checkConnect(I);if(t)return t}if(X.P1)return F._checkLine(I);var W,O,Z,y=null,l=F._interactor,b=l.getStyle("checkSize");if(U&&s.isRectEditable(Y))for(O=0;O<Vq.Rect.ResizeKeys.length;O++)if(Z=Vq.Rect.ResizeKeys[O],Vq.checkHit(I,X[Z],b)){y=Z,W="resize";break}if(!y&&U&&s.isRotationEditable(Y)&&!l.getStyle("rotateAsClock")){var w=l.getStyle("rotateCheckSize");for(O=0;O<Vq.Rect.RotateKeys.length;O++)if(Z=Vq.Rect.RotateKeys[O],Vq.checkHit(I,X[Z],w)){y=Z,W="rotate";break}}if(!y)return l.setCursor("default"),void 0;if("rotate"===W){var G,x=s.lp(p);if(Y instanceof Vq.Group){var L=l.getStyle("groupRotateModeKey");"string"==typeof L&&(L=[L]);for(var Q=!1,c=0,C=L.length;C>c;c++)if(p[L[c]]){Q=!0;break}var N=l.getStyle("groupRotateModeDefault");G=Q?"batch"===N?"block":"batch":N}var v="batch"===G?Y.getAnchor2():Y.getPosition(),M=Math.atan2(x.y-v.y,x.x-v.x);l._setRotateCursor(M),F.editing={mode:W,key:y,pos:v,flipY:Y.getScale().y<0,rotation:Y.getRotation(),hitRot:M},G&&(F.editing.groupRotateMode=G)}else{var z=Vq.Rect.ResizeKeys.indexOf(y),H=Vq.Rect.ResizeDirection[z],u=Math.cos(Y.getRotation()),a=Math.sin(Y.getRotation()),j=H.x*Math.sign(Y.getScale().x),K=H.y*Math.sign(Y.getScale().y),m=Math.atan2(-a*j-u*K,u*j-a*K),r=(Math.round(m/(Math.PI/4))+8)%8,h=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][r];this._interactor.setCursor(h);var R=Y.getWidth(),A=Y.getHeight(),e=Y.getAnchor();F.editing={mode:W,key:y,rect:{x:-R*e.x,y:-A*e.y,width:R,height:A},anchor:e,matrix:Y.getMatrix()}}return y}}},Qd.prototype._checkLine=function(Y){var e=this;e.screenInfo;var L,$=e._interactor.getStyle("checkSize");if(Vq.checkHit(Y,e.screenInfo.P1,$))L="P1";else{if(!Vq.checkHit(Y,e.screenInfo.P2,$))return this._interactor.setCursor("default"),void 0;L="P2"}return e.editing={mode:"line",key:L},L},Qd.prototype._checkConnect=function(U){var O=this,R=O.screenInfo,$=O._interactor,r=$.getStyle("connectGuideIntersectSize"),J=R.connect,K=U.x,v=J.x;if(v>K&&r>v-K&&Math.abs(J.y-U.y)<r||K>=v&&Vq.checkHit(U,J,r)){var f="connect",h=b.getConnectAction($.gv);if(O.editing={mode:f},h&&h.delete)if(O.target instanceof Vq.Group){var I=!0;$.gv.sm().getSelection().each(function(o){h.delete.visible.call(null,$.gv,o)||(I=!1)}),O.editing.hasDeleteAction=I}else h.delete.visible.call(null,$.gv,O.target)&&(O.editing.hasDeleteAction=!0);return $.setCursor("default"),f}},Qd.prototype._fireEditEvent=function(V,P){var s=this._interactor,H=this.editing;if(H){var w=H.mode;w="rotate"===w?"Rotation":"connect"===w?"Connection":"resize"===w?"Rect":w[0].toUpperCase()+w.slice(1),s.fi({kind:V+"Edit"+w,event:P})}},Qd.prototype.startEdit=function(m,h){m.startDragging(h);var n=this;n._interactor.fi({kind:"prepareEdit",event:h});var X=n.editing,g=n.target;if(X){if(n._fireEditEvent("begin",h),"rotate"===X.mode)return X.groupRotateMode&&g.beginRotate(X),void 0;if("connect"!==X.mode)("line"===X.mode||g&&0===g.getRotation())&&(n._inSmartGuide=!0,n._interactor.rectGuide.gatherRects());else if(X.hasDeleteAction){var y=m.gv,w=n._interactor.getStyle("connectGuideGarbageShift");X.garbageInfo={x:y.getWidth()*w[0]+w[2],y:y.getHeight()*w[1]+w[3],size:n._interactor.getStyle("connectGuideGarbageIntersectsize")},m._42()}}},Qd.prototype._46O=function(U){var t,v,j=this,J=j.editing,G=j.target;if(J){if("connect"===J.mode&&!J.canceled&&!J.deleted)try{J.garbageInfo&&J.garbageInfo.hover?b.doDeleteConnectionAction(j._interactor.gv,G):b.doConnectAction(j._interactor.gv,G,J.target)}catch(S){console.error(S)}v=J.freezeFlag,t=j.editing.groupRotateMode,j._fireEditEvent("end",U),j.editing=null}j.tipInfo=null,j._inSmartGuide&&(j._interactor.rectGuide.clear(),j._inSmartGuide=!1),t&&G&&G.endRotate(),G instanceof P.Block&&(v===e?delete G._freezeSyncFromChildren:G._freezeSyncFromChildren=v,G.updateFromChildren())},Qd.prototype.handleNormalStateDelete=function(){var R=this,H=R.editing;if(H&&"connect"===H.mode&&!H.canceled&&!H.deleted){if(H.garbageInfo){try{b.doDeleteConnectionAction(R._interactor.gv,R.target)}catch(j){console.error(j)}H.garbageInfo=null}return H.cursorPos=null,H.targetCorners=null,H.deleted=!0,R._interactor._42(),!0}},Qd.prototype.handleNormalStateKeyDown=function(Z){var d=this,p=d.editing;return!p||"connect"!==p.mode||p.canceled||p.deleted?void 0:P.Default.isEsc(Z)?(p.cursorPos=null,p.targetCorners=null,p.canceled=!0,d._interactor._42(),!0):void 0},Qd.prototype.handleEdit=function(k,n){var S=this,t=S.editing;if(t){var v,p,e,r,M,Y=S.target,F=t.key,x=t.mode,w=k.lp(n),V=S._interactor;if("connect"===x){if(t.canceled)return;if(t.deleted)return;t.cursorPos=V._getLogicalPoint(n);var L=t.garbageInfo;return L&&Vq.checkHit(t.cursorPos,L,L.size)?(L.hover=!0,t.target=null,t.targetCorners=null):(L&&(L.hover=!1),t.target=k.getDataAt(w,function(_){return k.isSelectable(_)?$o(_)?!0:!1:!1})||null,t.targetCorners=Vq.getTargetCornersOnScreen(k,t.target)),V._42(),void 0}if("rotate"===x){var i,m,l=t.pos,T=Math.atan2(w.y-l.y,w.x-l.x);if(t.groupRotateMode?m=T-t.hitRot:(i=T-t.hitRot,m=t.rotation+i),m%=2*Math.PI,0>m&&(m+=2*Math.PI),!P.Default.isCtrlDown(n)){var O,H;kj(n)?(O=V.getStyle("shiftRotateRound"),H=O/2):(O=V.getStyle("rotateRound"),H=V.getStyle("rotateSensitivity")),m=Vq.roundTo(m,O,H)}t.groupRotateMode?(i=m-(t.lastRotation||0),0!==i&&(Y.addRotation(i,t.groupRotateMode,function(V){return k.isRotationEditable(V)}),t.lastRotation=m)):Y.setRotation(m),V._setRotateCursor(T),m>Math.PI&&(m-=2*Math.PI);var N=180*(m/Math.PI);N=N.toFixed(2),v=""+N+"°"}else if("resize"===x){var h=t.rect;e=h.x,r=h.y;var D,C=h.width,d=h.height,z=t.anchor,s=t.matrix,g=Y.s&&Y.s("keepAspectRatio")||V.getStyle("keepAspectRatio");kj(n)&&(g=!g);var I=S._unionPointMode1,U=S._unionPointMode2;if(S._inSmartGuide&&!P.Default.isCtrlDown(n)&&!g){var G;"L"===F||"R"===F?G="x":("T"===F||"B"===F)&&(G="y"),S._adsorbedToClosest(w,G),M=!0}D=s.tfi(w);var R;"LT"===F?(h=I(D,{x:e+C,y:r+d},C,d,g),R=9):"T"===F?(h=U({x:e,y:D.y},{x:e+C,y:r+d},C,d,g,"v"),R=1):"RT"===F?(h=I(D,{x:e,y:r+d},C,d,g),R=33):"L"===F?(h=U({x:D.x,y:r},{x:e+C,y:r+d},C,d,g,"h"),R=8):"R"===F?(h=U({x:e,y:r},{x:D.x,y:r+d},C,d,g,"h"),R=32):"LB"===F?(h=I(D,{x:e+C,y:r},C,d,g),R=12):"B"===F?(h=U({x:e,y:r},{x:e+C,y:D.y},C,d,g,"v"),R=4):"RB"===F&&(h=I(D,{x:e,y:r},C,d,g),R=36);var A=s.tf(h.x+h.width*z.x,h.y+h.height*z.y);Y instanceof P.Block&&(t.hasOwnProperty("freezeFlag")||(t.freezeFlag=Y._freezeSyncFromChildren,Y._freezeSyncFromChildren=!0)),Y.setPosition(A),Y.setSize(h.width,h.height),M&&(p=Y.getRect(),V.rectGuide.gatherLines({node:Y,x:p.x,y:p.y,w:p.width,h:p.height},G,R)),v=""+Math.round(h.width)+" * "+Math.round(h.height)}else if("line"===x){if(kj(n)){var f=Y.getPoints(),u="P1"===F?f.get(1):f.get(0),Q={x:w.x-u.x,y:w.y-u.y},J=V.getStyle("shiftLineRotateRound"),K=S._shiftDirList;if(!K||S._shiftRotateRound!==J){S._shiftRotateRound=J,S._shiftDirList=K=[];for(var W=0;W<Math.PI;W+=J)K.push({x:j(W),y:E(W)})}for(var y,_=0,a=0,c=K.length;c>a;a++){var Z=K[a],X=Z.x*Q.x+Z.y*Q.y;Math.abs(X)>Math.abs(_)&&(_=X,y=Z)}w={x:u.x+y.x*_,y:u.y+y.y*_},V.rectGuide.clear()}else S._inSmartGuide&&!P.Default.isCtrlDown(n)&&(S._adsorbedToClosest(w),M=!0);var b=Vq.getDataMatrix(Y).applyInverse(w);Y.setPoint("P1"===F?0:1,b,!0);var o=Y.getPoints(),B=o.get(0),$=o.get(1);e=B.x-$.x,r=B.y-$.y,v=" "+Math.round(Math.sqrt(e*e+r*r))+" ",M&&(p=Y.getRect(),V.rectGuide.gatherLines({node:Y,x:p.x,y:p.y,w:p.width,h:p.height}))}if(v){var q=P.Default.getLogicalPoint(n,V._canvas);q.x+=Vq.Icons.TipShiftX,q.y+=Vq.Icons.TipShiftY,S.tipInfo={helperPos:q,text:v,size:v.length}}S._fireEditEvent("between",n)}},Qd.prototype._unionPointMode1=function(f,T,o,d,$){if($&&o&&d){var e=f.x-T.x,B=f.y-T.y;Math.abs(e*d)<Math.abs(B*o)?(B=Math.sign(B)*Math.abs(e*d/o),f.y=T.y+B):(e=Math.sign(e)*Math.abs(B*o/d),f.x=T.x+e)}return P.Default.unionPoint(f,T)},Qd.prototype._unionPointMode2=function(U,E,a,m,p,H){var L=P.Default.unionPoint(U,E);if(p&&a&&m){var I;"v"===H?(I=L.x+L.width/2,L.width=a*L.height/m,L.x=I-L.width/2):(I=L.y+L.height/2,L.height=m*L.width/a,L.y=I-L.height/2)}return L},Qd.prototype._adsorbedToClosest=function(V,j){var l=this,d=l._interactor,C=d.rectGuide.findClosest(V,j),N=d.gridGuide.findClosest(V,j),L=1/0,e=1/0;C&&(isFinite(C.x)&&(L=C.x),isFinite(C.y)&&(e=C.y)),N&&(isFinite(N.x)&&Math.abs(N.x)<Math.abs(L)&&(L=N.x),isFinite(N.y)&&Math.abs(N.y)<Math.abs(e)&&(e=N.y)),isFinite(L)&&(V.x+=L),isFinite(e)&&(V.y+=e)},Qd.prototype._42=function(n,A,W){var j=this;j.info={},j.screenInfo=null;var t=j._interactor;if(!t.editDetail&&j.gatherInfo(A,W)){var y=j.editing,G=y?y.groupRotateMode:null,V=j.screenInfo;if("block"!==G){if(V.P1?Vq.Icons.DrawIcon(t,n,Vq.Icons.Line,V):Vq.Icons.DrawIcon(t,n,Vq.Icons.Rect,V),V.connect&&(Vq.Icons.DrawIcon(t,n,Vq.Icons.ConnectGuide,{rotation:V.rotation,connect:V.connect,cursorPos:y?y.cursorPos:null}),y)){if(y.targetCorners){for(var M={x:1/0,y:1/0},e={x:-1/0,y:-1/0},s=0,v=y.targetCorners.length;v>s;s+=2)M.x=Math.min(M.x,y.targetCorners[s]),e.x=Math.max(e.x,y.targetCorners[s]),M.y=Math.min(M.y,y.targetCorners[s+1]),e.y=Math.max(e.y,y.targetCorners[s+1]);Vq.Icons.DrawIcon(t,n,Vq.Icons.HoverDataRect,{min:M,max:e,color:t.getStyle("hoverGuideColor")||t.getStyle("baseColor")})}y.garbageInfo&&Vq.Icons.DrawIcon(t,n,Vq.Icons.ConnectGuideGarbage,y.garbageInfo)}j.tipInfo&&Vq.Icons.DrawIcon(t,n,Vq.Icons.TipHelper,j.tipInfo)}j.target instanceof Vq.Group&&j.target._42(t,n,A)}};var rh=Vq.Anchor=function(I){this.catalog="Anchor",this._interactor=I};rh.prototype={},rh.prototype.constructor=rh,rh.prototype.gatherInfo=function(A,L){var J=this;if(1===L.length){var Q=L[0];if(!Q.getAnchor)return;if(Q instanceof P.Shape&&Q._70I())return;if(Ak(Q,A))return;return J.gatherSingleTarget(A,L[0])}return L.length>1?J.gatherMultiTargets(A,L):!1},rh.prototype.gatherSingleTarget=function(J,X){var h=this;return h.info.POS=X.getPosition(),h.screenInfo.POS=Vq.toScreenPosition(J,h.info.POS),h.target=X,!0},rh.prototype.gatherMultiTargets=function(A,R){var $=this,D=Vq.Group.findOrCreateGroup(R);return D?($.screenInfo.POS=Vq.toScreenPosition(A,D.getAnchor2()),$.target=D,!0):!1},rh.prototype.isVisible=function(){var y=this,s=y._interactor;if(s.getStyle("anchorVisible")===!1)return!1;var J=y.target;if(J){if(this.editing)return!0;var K=J.getAnchor(),N=s.getStyle("anchorOutsideVisibleThreshold");if(K.x<-N||K.x>1+N||K.y<-N||K.y>1+N)return!0;var b=J.getSize(),$=J.getScale(),l=Math.min(Math.abs(b.width*$.x),Math.abs(b.height*$.y));if(l*s.gv._zoom<s.getStyle("anchorHideThreshold"))return!1}return!0},rh.prototype.check=function(p,C,K){if(P.Default.isLeftButton(C)){var f=this,o=f._interactor;if(f.isVisible()&&o.getStyle("anchorMovable")!==!1){f.editing=null,f.tipInfo=null;var N=f.target;if(N&&p.isAnchorEditable(N)&&p.isEditable(N)){var F;if(f.screenInfo&&(F=f.screenInfo.POS)&&Vq.checkHit(K,new Vq.Math.Vector2(F),o.getStyle("checkSize"))){if(N instanceof Vq.Group)return f.editing={},!0;var Y=N.getWidth(),d=N.getHeight(),i=N.getAnchor();return f.editing={rect:{x:-Y*i.x,y:-d*i.y,width:Y,height:d},anchor:i,matrix:N.getMatrix()},!0}}}}},rh.prototype.startEdit=function(V,p){V.startDragging(p),V.fi({kind:"beginEditAnchor",event:p})},rh.prototype._46O=function(G){var o=this;o.editing&&(o.editing=null,o._interactor.fi({kind:"endEditAnchor",event:G})),o.tipInfo=null},rh.prototype.handleEdit=function(G,u){var s=this,c=s.target;if(c){var h=s.editing;if(h){var T=G.lp(u),K=s._interactor;if(c instanceof Vq.Group)return c.setAnchor2(T),K._42(),void 0;var C=h.matrix,B=C.tfi(T),O=h.rect,x=(B.x-O.x)/O.width,Y=(B.y-O.y)/O.height;if(!P.Default.isCtrlDown(u)){var o=K.getStyle("anchorRound"),t=K.getStyle("anchorSensitivity");x=Vq.roundTo(x,o,t),Y=Vq.roundTo(Y,o,t)}c.setAnchor(x,Y,!0);var M=P.Default.getLogicalPoint(u,K._canvas);M.x+=Vq.Icons.TipShiftX,M.y+=Vq.Icons.TipShiftY;var E=""+x.toFixed(2)+", "+Y.toFixed(2);s.tipInfo={helperPos:M,text:E,size:E.length},K.fi({kind:"betweenEditAnchor",event:u})}}},rh.prototype._42=function(d,M,t){var U=this;U.info={},U.screenInfo={};var N=U._interactor;N.editDetail||U.gatherInfo(M,t)&&U.isVisible()&&(Vq.Icons.DrawIcon(N,d,Vq.Icons.Anchor,U.screenInfo),U.tipInfo&&Vq.Icons.DrawIcon(N,d,Vq.Icons.TipHelper,U.tipInfo))};var Mj=Vq.MoveDummy=function(z){this.catalog="MoveDummy",this._interactor=z};Mj.prototype={},Mj.prototype.constructor=Mj,Mj.prototype.gatherInfo=function(){var w=this,q=this._interactor.getSubModule("Rect");if(q){var U=q.screenInfo;if(U){var v=w._interactor,h=w.getMovableTarget(q.target);if(h){var B=v.getStyle("moveDummyThreshold");if(B!==!1){var J=U.LT||U.P1,K=U.RT||U.P2,N=U.LB||J;if(J){var Q=U.P1,r=Math.min(J.distanceTo(N),J.distanceTo(K));if(!(B!==!0&&r>B)){var j=v.getStyle("moveDummyPosition"),b=K.clone().sub(J),u=N.clone().sub(J),x=j[2],e=j[3];if(Q){var o=v.getStyle("moveDummyLineExtraShift");o&&(x+=o[0],e+=o[1])}var V=J.clone().add(b.clone().multiplyScalar(j[0])).add(b.setLength(x)).add(u.clone().multiplyScalar(j[1])).add(u.setLength(e));return w.screenInfo.pos=V,w.screenInfo.size=v.getStyle("moveDummySensitivity"),!0}}}}}}},Mj.prototype.getMovableTarget=function(p){var H=this._interactor.gv;if($o(p)){if(H.isMovable(p))return p}else if(p instanceof Vq.Group)for(var M=p._entities,c=M.length-1;c>=0;c--){var a=M[c];if($o(a)&&H.isMovable(a))return a}return null},Mj.prototype.getMoveInteractor=function(){for(var M,e,b,p=this._interactor.gv,n=p.getInteractors(),M=0,e=n.length;e>M;M++)if(b=n.get(M),b instanceof _e)return b},Mj.prototype.startEdit=function(s,n){s.startDragging(n);var C=this.getMoveInteractor();if(C){var S=this.selectedTarget,i=s.gv;i._moving=1,C._data=S,i.handleMouseDown&&i.handleMouseDown(n,S)}},Mj.prototype._46O=function(F){var N=this,M=N.getMoveInteractor();M&&(M.handleWindowMouseUp(F),N.selectedTarget=null)},Mj.prototype.handleEdit=function(d,N){var l=this.getMoveInteractor();l&&l.handleWindowMouseMove(N)},Mj.prototype.check=function(T,e,O){if(this.selectedTarget=null,P.Default.isLeftButton(e)&&!T._scrolling&&!Kn()){var z=this;if(z.screenInfo){var f=z.screenInfo.pos;if(f&&!(O.distanceTo(f)>z.screenInfo.size)){var Y=z._interactor;return z.selectedTarget=z.getMovableTarget(Y.getSubModule("Rect").target),Y.setCursor("default"),!0}}}},Mj.prototype._42=function(N,S,P){var D=this;D.screenInfo={};var Y=D._interactor;Y.editDetail||D.gatherInfo(S,P)&&(!Y.editing||D.selectedTarget)&&Vq.Icons.DrawIcon(Y,N,Vq.Icons.MoveDummy,D.screenInfo)};var Pr=Vq.RotateX=function($){this.catalog="RotateX",this._interactor=$};Pr.prototype={},Pr.prototype.constructor=Pr,Pr.prototype.gatherInfo=function(S,d){var u=this;if(1===d.length){var N=d[0];return N instanceof P.Shape&&N._70I()||Ak(N,S)?!1:u.gatherSingleTarget(S,N)}return d.length>1?u.gatherMultiTargets(S,d):!1},Pr.prototype.gatherSingleTarget=function(){var u=new P.Math.Vector2,S=new P.Math.Vector2,r=new P.Math.Vector2,d=new P.Math.Vector2,F=function(N,m){var z=N.x-m.x,j=N.y-m.y;return z*z+j*j};return function(W,M){if(M.getCorners){var a=this,T=M.getCorners(),I=15,O=M.getPosition();u.copy(T[0]),r.copy(T[1]),d.copy(T[3]),S.copy(u).add(d).divideScalar(2).add(u.sub(r).setLength(I/W.getZoom()));var w=Math.max(F(O,T[0]),F(O,T[1]),F(O,T[2]),F(O,T[3]));return a.info.POS=S.clone(),a.screenInfo.POS=Vq.toScreenPosition(W,a.info.POS),a.screenInfo.LEN=Math.sqrt(w)*W.getZoom()+I,a.screenInfo.CENTER=Vq.toScreenPosition(W,O),a.target=M,!0}}}(),Pr.prototype.gatherMultiTargets=function(t,W){var C=this,R=Vq.Group.findOrCreateGroup(W);if(!R)return!1;var C=this;return C.gatherSingleTarget(t,R)},Pr.prototype.isVisible=function(){var P=this._interactor;if(!P.getStyle("rotateAsClock"))return!1;var d=this.target;if(!d)return!0;var B=P.gv;return B.isEditable(d)&&B.isRotationEditable(d)?!0:!1},Pr.prototype.check=function(J,Q,m){var F=this,M=F._checkImpl(J,Q,m);return(M||F._clockPainted)&&F._interactor._42(),M},Pr.prototype._checkImpl=function(X,F,V){if(P.Default.isLeftButton(F)){var U=this;U.editing=null,U.tipInfo=null;var r;if(U.screenInfo&&(r=U.screenInfo.POS)&&U.isVisible()){var x=U._interactor;if(Vq.checkHit(V,r,x.getStyle("checkSize"))){var d=U.target,_=X.lp(F),c=d.getPosition(),Q=Math.atan2(_.y-c.y,_.x-c.x);return x._setRotateCursor(Q),U.editing={pos:c,rotation:d.getRotation(),hitRot:Q,groupRotateMode:"block",screenInfo:{CENTER:U.screenInfo.CENTER,LEN:U.screenInfo.LEN}},!0}}}},Pr.prototype.startEdit=function(w,G){w.startDragging(G),w.fi({kind:"beginEditRotation",event:G}),this.target instanceof Vq.Group&&this.target.beginRotate(this.editing)},Pr.prototype._46O=function(K){var E=this;E.editing&&(E.editing=null,E._interactor.fi({kind:"endEditRotation",event:K})),E.target instanceof Vq.Group&&E.target.endRotate(),E.tipInfo=null},Pr.prototype.handleEdit=function(i,X){var N=this,S=N.editing;if(S){var O,e,Y=N.target,z=i.lp(X),m=N._interactor,d=S.pos,J=Math.atan2(z.y-d.y,z.x-d.x),s=Y instanceof Vq.Group;if(s?e=J-S.hitRot:(O=J-S.hitRot,e=S.rotation+O),e%=2*Math.PI,0>e&&(e+=2*Math.PI),!P.Default.isCtrlDown(X)){var v,l;kj(X)?(v=m.getStyle("shiftRotateRound"),l=v/2):(v=m.getStyle("rotateRound"),l=m.getStyle("rotateSensitivity")),e=Vq.roundTo(e,v,l)}s?(O=e-(S.lastRotation||0),0!==O&&(Y.addRotation(O,S.groupRotateMode,function(Q){return i.isRotationEditable(Q)}),S.lastRotation=e)):Y.setRotation(e),m._setRotateCursor(J),e>Math.PI&&(e-=2*Math.PI);var V=180*(e/Math.PI),E=""+V.toFixed(2)+"°",q=P.Default.getLogicalPoint(X,m._canvas);q.x+=Vq.Icons.TipShiftX,q.y+=Vq.Icons.TipShiftY,N.tipInfo={helperPos:q,text:E,size:E.length},m.fi({kind:"betweenEditRotation",event:X})}},Pr.prototype._42=function(X,e,x){var V=this;V._clockPainted=!1,V.info={},V.screenInfo={};var H=V._interactor;H.editDetail||V.gatherInfo(e,x)&&V.isVisible()&&(Vq.Icons.DrawIcon(H,X,Vq.Icons.RoundPoint,V.screenInfo.POS),V.tipInfo&&Vq.Icons.DrawIcon(H,X,Vq.Icons.TipHelper,V.tipInfo),V.editing&&V.drawClock(X))},Pr.prototype.drawClock=function(_){_.save();var J=this;J._clockPainted=!0;var v=J.editing||{},L=v.screenInfo||J.screenInfo,Y=L.LEN,z=Y+8,k=Y+18;_.save(),_.translate(L.CENTER.x,L.CENTER.y),_.beginPath(),_.strokeStyle="rgb(150, 150, 150)";for(var F,C,A,B,I,p=0;360>p;p++)F=p*Math.PI/180,0===p%5&&(C=E(F)*Y,A=j(F)*Y,B=E(F)*z,I=j(F)*z,_.moveTo(C,A),_.lineTo(B,I)),0===p%45&&(C=E(F)*Y,A=j(F)*Y,B=E(F)*k,I=j(F)*k,_.moveTo(C,A),_.lineTo(B,I));_.stroke(),_.rotate(-Z);var l=v.lastRotation||J.target.getRotation();_.beginPath(),_.fillStyle="rgba(255, 0, 0, 0.1)",_.strokeStyle="rgb(157, 157, 157)",_.moveTo(0,0),_.arc(0,0,k,0,l,!1),_.fill(),_.beginPath(),_.moveTo(0+k,0),_.arc(0,0,k,0,l,!1),_.stroke(),_.restore()};var po=Vq.Curve=function(W){this.catalog="Curve",this._interactor=W};po.prototype={},po.prototype.constructor=po,N.defineProperties(po.prototype,{activing:{get:function(){return this._activing},set:function(j){var B=this;if(j)B._activing=new Vq.CurveActiving(this,j),B._activing._firePointChange();else{var O=B._activing;O&&O.dispose(),B._activing=null}}}}),po.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},po.prototype.setUp=function(){var s=this,j=s._interactor;j&&j.gv.mp(s._onGraphviewPropertyChanged,s)},po.prototype._onGraphviewPropertyChanged=function(H){("zoom"===H.property||"translateX"===H.property||"translateY"===H.property)&&this._handleDataChanged()},po.prototype.tearDown=function(){var j=this,S=j._interactor;S&&S.gv.ump(j._onGraphviewPropertyChanged,j)},po.prototype.canEnterEditDetailMode=function(){var c=this,k=c._interactor,B=k._getValidSelection();if(1===B.length){var d=B[0],n=d instanceof P.Edge;if(d instanceof P.Shape||n){if(n){var q=d.s("edge.type");if(q&&"points"!==q)return}var M=k.gv;if(M.isPointEditable(d)&&M.isEditable(d))return c.target=d,!0}}},po.prototype.canQuitEditDetailMode=function(F){var X=this,g=X._interactor._getLogicalPoint(F);return X._checkEditRealPoint(g)?void 0:X._interactor.gv.getDataAt(F)!==X.target?!0:void 0},po.prototype.preHandleScroll=function(){var G=this.editing;return G&&G.inEdit?!0:void 0},po.prototype.getCurrentSelectintStatus=function(){var n=this;if(n.activing&&!n.activing.selections){if(n.activing.status!=e)return n.activing.status;var m=function(A){var t=n.activing.status;n.activing.status=A,n._interactor.fp("shapePointStatus",t,A)},O=Vq.Curve.PointType,D=n.activing.point,c=n.activing.pairs;if(!c||1!==c.length)return m(O.Mirrored);var R=c[0],U=R.c1&&R.c1.isNearEnough(D),Q=R.c2&&R.c2.isNearEnough(D);if(!R.c1||!R.c2)return U||Q?m(O.Straight):m(O.Disconnected);if(U&&Q)return m(O.Straight);if(U||Q)return m(O.Asymmetric);var h=R.c1.clone().sub(D),X=R.c2.clone().sub(D);return Math.abs(h.x*X.y-h.y*X.x)>1e-5||h.x*X.x>0?m(O.Disconnected):Math.abs(h.length()-X.length())>1e-5?m(O.Asymmetric):m(O.Mirrored)}},po.prototype.handle_keydown=function(P){var s=this;if(s._interactor.editDetail){var u=Vq.Curve.PointType;"1"===P.key?s._setCurrentSelectionStatus(u.Straight):"2"===P.key?s._setCurrentSelectionStatus(u.Mirrored):"3"===P.key?s._setCurrentSelectionStatus(u.Disconnected):"4"===P.key&&s._setCurrentSelectionStatus(u.Asymmetric)}},po.prototype.setCurrentSelectionStatus=function(i){var K=this,S=K._interactor;if(S){var M=S.gv;M.dm().beginTransaction(),this._setCurrentSelectionStatus(i),M.dm().endTransaction()}},po.prototype._setCurrentSelectionStatus=function(b){var f=this,d=f.activing;if(d){var W=f.getCurrentSelectintStatus();if(null!==W&&W!==b){d.status=b;var h=f.activing.point,B=f.activing.pairs;if(B&&1===B.length){var i=B[0],p=f.screenInfo.curve,D=Vq.Curve.PointType,A=f._interactor,y=function(){f._writeToHt(),A.fp("shapePointStatus",W,b),f.check(A.gv,null,new Vq.Math.Vector2(A._lastLogicalPoint))};if(b===D.Straight)return p.moveCtrlPoint(i,h,"c1"),p.moveCtrlPoint(i,h,"c2"),y(),void 0;if(W===D.Straight){var U=p.findPairs(h,!0),C=U[0],x=C.r1||h,e=C.r2||h,n=e.clone().sub(x).multiplyScalar(.25);return p.moveCtrlPoint(i,h.clone().sub(n),"c1"),p.moveCtrlPoint(i,h.clone().add(n),"c2"),y(),void 0}var c=i.c1,F=i.c2;if(c&&F){if(b===D.Mirrored)return p.moveCtrlPoint(i,h.clone().multiplyScalar(2).sub(F),"c1"),y(),void 0;if(b===D.Asymmetric&&W===D.Disconnected){var q=c.clone().sub(h).length(),n=h.clone().sub(F).setLength(q).add(h);return p.moveCtrlPoint(i,n,"c1"),y(),void 0}}d._firePointChange(),A.fp("shapePointStatus",W,b),f.check(A.gv,null,new Vq.Math.Vector2(A._lastLogicalPoint))}}}},po.prototype._handleDataChanged=function(){var m="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(E){var N=this;if(N.screenInfo&&N.target){if(E&&m.indexOf(E.property)<0)return;var M=N._interactor;N.gatherSingleTarget(M.gv,N.target,!0),N.check(M.gv,null,new Vq.Math.Vector2(M._lastLogicalPoint)),M._42()}}}(),po.prototype.gatherSingleTarget=function(x,p,$){var V,S,J=this;J.screenInfo&&J.screenInfo.curve&&(S=J.screenInfo.curve._curves);var G=J.editing;V=G?J.screenInfo:J.screenInfo={};var t,W,v=p instanceof P.Edge;v?(t=p.s("edge.segments"),W=p.s("edge.points")||new P.List):(t=p._58O,W=p._59O),V.S=t;var y,K=V.P=[],s=Vq.getDataMatrix(p);if(p instanceof P.Polyline||p instanceof P.Edge&&J._interactor.getStyle("edgeElevationEditable"))y=p.getElevation&&p.getElevation()||0,V.E=[];else{var N=!1;W.each(function(z){z.e!==e&&(N=!0)}),N&&(V.E=[])}if(W.each(function(R){V.E&&V.E.push(R.e!=e?R.e:y),R=s.apply(R);var h=Vq.toScreenPosition(x,R);K.push(h.x,h.y)}),v){var i=K.length,C=Vq.toScreenPosition(x,p._lastSourcePoint||(i?{x:K[0],y:K[1]}:{x:0,y:0})),B=Vq.toScreenPosition(x,p._lastTargetPoint||(i?{x:K[i-2],y:K[i-1]}:{x:0,y:0}));K.splice(0,0,C.x,C.y),K.push(B.x,B.y),V.E&&(V.E.splice(0,0,"head"),V.E.push("tail"))}if(!V.S||!V.S.size()){V.S=new P.List,V.S.add(1);for(var Y=0;Y<K.length/2-1;Y++)V.S.add(2)}if((!G||$)&&J.convertToCubicBezier(S),J.activing&&($||!J.editing||"realPoint"===J.editing.type)){var j=V.curve.findPairs(J.activing.point);J.activing.pairs=j}},po.prototype._convertToNewPoint=function(f,k,_,d){var w,l,H;for(w=0,l=k.length;l>w;w++){if(H=k[w],H._p1.isNearEnough(f)&&(!d||d.indexOf(H._p1)<0))return H._p1;if(H._p4.isNearEnough(f)&&(!d||d.indexOf(H._p4)<0))return H._p4}if(_)for(w=0,l=Math.min(_.length,l);l>w;w++){if(H=_[w],H._p1===f&&(!d||d.indexOf(k[w]._p1)<0))return k[w]._p1;if(H._p4===f&&(!d||d.indexOf(k[w]._p4)<0))return k[w]._p4}},po.prototype.convertToCubicBezier=function(U){var l,o,A=this,h=new Vq.Math.Curve,B=A.screenInfo;if(h.createFromHtShape(B.P,B.S,B.E),B.curve=h,A.activing){var c=h._curves;
l=A.activing.point,o=A._convertToNewPoint(l,c,U);var t=[];if(o&&(A.activing.point=o,t.push(o)),A.activing.selections){var m=-1,f=A.activing.selections;f.forEach(function(Q){m++,o=A._convertToNewPoint(Q,c,U,t),o&&(f[m]=o,t.push(o))})}}},po.prototype.check=function(M,h,P){if(!h||Qf(h)||vk(h)){var B=this;if(B._interactor.setCursor("default"),B.editing=null,B.highlight=null,B.tipInfo=null,B.edgeEditResult=null,B.screenInfo){if(Kn()||h&&vk(h))return B._interactor._42(),!0;if(B._checkEditCtrlPoint(P))return B._interactor._42(),!0;if(B._checkEditRealPoint(P))return B._interactor._42(),!0;if(B._checkEditElevation(P))return B._interactor._42(),!0;var i=B.screenInfo.curve,e=i.checkPoint(P,B._interactor.getStyle("curveIntersectSize"));if(e){var v=B.highlight={};v.type="insertKnot",v.bezier=e.bezier,v.point=e.intersection}return B._interactor._42(),!0}}},po.prototype._checkEditRealPoint=function(g){var Z,F,I,s,w,X,L=this,J=L.screenInfo.curve._curves,h=L._interactor.getStyle("curvePointIntersectSize"),A=1/0;for(h*=h,I=0,s=J.length;s>I;I++)Z=J[I],w=Z._p1,X=g.distanceToSquared(w),A>X&&(A=X,F=w),w=Z._p4,X=g.distanceToSquared(w),A>X&&(A=X,F=w);if(A>h)return!1;var u=L.highlight={};return u.type="changeRealPoint",u.point=F,L.editing={type:"realPoint",point:F,shiftGuide:{point:F.clone(),dir:"x",limit:0}},L._interactor.setCursor("crosshair"),!0},po.prototype._checkEditElevation=function(n){var _=this;if(!_._interactor.getStyle("curveElevationVisible"))return!1;var E=_.target;if(E instanceof P.Edge&&!_._interactor.getStyle("edgeElevationEditable"))return!1;var e=_.activing;if(!e)return!1;var F=e.getCurrentEditingPoint();if(!F)return!1;var R=_._interactor,J=R.getStyle("curveElevationGuideShift"),s=R.getStyle("curveElevationIntersectSize"),y=n.distanceToSquared({x:F.x+J[0],y:F.y+J[1]});if(!(y>s*s)){var c=_.highlight={};c.type="elevation";var z=new Vq.Math.Vector2(n.x,n.y,F.e);return _.editing={type:"elevation",startPoint:z},_._interactor.setCursor("crosshair"),!0}},po.prototype._checkEditCtrlPoint=function(Z){var S=this;if(S.activing&&!S.activing.selections){var h=S.getCurrentSelectintStatus();if(h!==Vq.Curve.PointType.Straight){var p=S.activing.pairs;if(p){var k=S._interactor.getStyle("curvePointIntersectSize");k*=k;var z,j,T,M,V,A,f,q,U,u=1/0;for(f=0,U=p.length;U>f;f++)for(M=p[f],q=0;2>q;q++)V=0===q?"c1":"c2",M[V]&&(A=Z.distanceToSquared(M[V]),u>A&&(u=A,z=M,j=f,T=V));if(u>k)return!1;S.activing.hlpair=z,S.activing.hltype=T;var n=S.highlight={};return n.type="changeCtrlPoint",n.point=z[T],S.editing={type:"ctrlPoint",pair:z,pairId:j,ctrlType:T,direction:z[T].clone().sub(S.activing.point).normalize()},S._interactor.setCursor("crosshair"),!0}}}},po.prototype.startEdit=function($,a){$.startDragging(a);var S=this;S.highlight&&"insertKnot"===S.highlight.type&&(S.insertKnot(),S.gatherSingleTarget(S._interactor.gv,S.target),S.activing=null,S._checkEditRealPoint(S._interactor._getLogicalPoint(a)));var q=S._activing;if(q){var K=S.editing?S.editing.type:null;"ctrlPoint"===K?q.editingCtrl={pairId:S.editing.pairId,type:q.hltype}:"realPoint"===K&&(q.editingCtrl=!1)}var i=S.highlight,x=P.Default.isCtrlDown(a);if(!i||Kn()||vk(a)){var V=S._interactor.gv;if(!V.setFocus(a)||V._scrolling)return;return x?S._multiSelect={startPoint:V.lp(a)}:V.isPannable()&&(Qf(a)||vk(a))&&(S._pan={tx:V.tx(),ty:V.ty()},$.fi({kind:"beginPan",event:a})),void 0}if("changeRealPoint"===i.type){var d,Q=S.activing?S.activing.point:null,Y=S.activing?S.activing.selections:null;if(x&&S.activing)Q===i.point?(Y?(S.activing={point:Y[0]},Y.length>1&&(Y.splice(0,1),S.activing.selections=Y)):S.activing=null,S.editing=null):Y&&(d=Y.indexOf(i.point))>=0?(Y.length>1?Y.splice(d,1):delete S.activing.selections,S.editing=null):Y?(Y.push(Q),S.activing={point:i.point,selections:Y}):S.activing={point:i.point,selections:[Q]};else if(Y)Q===i.point||((d=Y.indexOf(i.point))>=0?(Y.splice(d,1,Q),S.activing={point:i.point,selections:Y}):S.activing={point:i.point});else{var H;Q===i.point&&(H=S.activing.status),S.activing={point:i.point},H&&(S.activing.status=H)}$.fi({kind:"beginEditPoint",event:a})}},po.prototype.insertKnot=function(){var D=this,Y=D.highlight,z=D.screenInfo.curve;z.insertKnot(Y.bezier,Y.point.t),D._writeToHt()},po.prototype._writeToHt=function(){var T,G,x=this,f=x.screenInfo.curve,M=f.toHtShape(),p=M.points,a=[],C=M.segments,w=x._interactor.gv;w.dm().beginTransaction();var Q,O,z=x.target,e=z instanceof P.Edge,u=Vq.getDataMatrix(z).invert();O=z instanceof P.Polyline||z instanceof P.Edge&&x._interactor.getStyle("edgeElevationEditable"),O&&(Q=z.getElevation&&z.getElevation()||0);for(var o=0,H=p.length;H>o;o++)T=p[o],G=Vq.toWorldPosition(w,T),G=u.apply(G),isFinite(T.e)&&T.e!==Q&&(G.e=T.e),a.push(G);if(z._writing=!0,e){z.s("edge.type","points"),z.setStyle("edge.segments",C),z.setStyle("edge.points",a.slice(1,a.length-1)),z.setStyle("edge.source.offset.x",0),z.setStyle("edge.source.offset.y",0),z.setStyle("edge.target.offset.x",0),z.setStyle("edge.target.offset.y",0);var n=x._nextChangeEdgeHost;delete x._nextChangeEdgeHost,n&&("source"===n.type?z.setSource(n.host):z.setTarget(n.host)),x._writeEdgeHostAnchor("source",a[0]),x._writeEdgeHostAnchor("target",a[a.length-1])}else a.length?(z.setSegments(C),z.setPoints(a,!0)):z.removeFromDataModel();w.dm().endTransaction(),delete z._writing},po.prototype._writeEdgeHostAnchor=function(z,u){var A=this,C=A.target,l=A._calcHostAnchor(C,z,u);l.index!==e?(C.setStyle("edge."+z+".index",l.index),C.setStyle("edge."+z+".percent",e),C.setStyle("edge."+z+".anchor.x",e),C.setStyle("edge."+z+".anchor.y",e)):l.percent!==e?(C.setStyle("edge."+z+".percent",l.percent),C.setStyle("edge."+z+".index",e),C.setStyle("edge."+z+".anchor.x",e),C.setStyle("edge."+z+".anchor.y",e)):(C.s("edge."+z+".anchor.x",l.x),C.s("edge."+z+".anchor.y",l.y),l.offsetX||l.offsetY?(C.s("edge."+z+".offset.x",l.offsetX),C.s("edge."+z+".offset.y",l.offsetY)):(C.s("edge."+z+".offset.x",0),C.s("edge."+z+".offset.y",0)))},po.prototype._calcHostAnchor=function(e,x,m,C){C||(C="source"===x?e.getSource():e.getTarget());var S=this._interactor.gv,z=S.calculateAttachPoint(C,m);if(z)return z.info;if(cn(C)){var M=S.calculateEdgePosition(C,m);return M}var y=C.getRotation(),U=C.getAnchor();Ak(C,S)&&(y=0);var K=C.getScale();if(y||K.x<0||K.y<0){var c=C.getMatrix(),b=c.tfi(m),d=C.getSize();return{x:b.x/d.width+U.x,y:b.y/d.height+U.y}}var A=kb(S,C),H={x:(m.x-A.x)/A.width,y:(m.y-A.y)/A.height};return H},po.prototype._handlePanning=function(q){var B=this,f=B._pan;if(f){f.started=!0;var S=B._interactor,p=S.gv,i=S._lastClientPoint,T=nq(q),A=tg(p,T,i);p.setTranslate(f.tx+A.x,f.ty+A.y),B.gatherSingleTarget(S.gv,B.target),S._42(),S.fi({kind:"betweenPan",event:q})}},po.prototype.handleEdit=function(R,$){var g=this,T=g.editing;if(g._pan)return g._handlePanning($),void 0;if(g._multiSelect)return g._multiSelect.endPoint=R.lp($),g._interactor.redraw(),void 0;if(T){T.inEdit=!0;var v,B,O,G=g._interactor._getLogicalPoint($),X=P.Default.isCtrlDown($),d=P.Default.isShiftDown($),i=T.type,C=g.activing;if(g._guideInfo=null,"ctrlPoint"===i&&d){var k=g.editing.direction.clone();v=C.point;var j=k.dot(G.clone().sub(v));G=k.setLength(j).add(v)}else if("ctrlPoint"===i||"realPoint"===i){var k;if("realPoint"===i&&d){var a=g.editing.shiftGuide;B=a.point;var p=Math.abs(G.x-B.x),h=Math.abs(G.y-B.y);p>h&&p>a.limit&&"y"===a.dir&&(a.dir="x"),h>p&&h>a.limit&&"x"===a.dir&&(a.dir="y"),k=a.dir,"x"===k?(G.y=B.y,a.limit=Math.max(a.limit,p)):"y"===k&&(G.x=B.x,a.limit=Math.max(a.limit,h))}var q=g._isEditEdgeSourceTarget();if(q){var N=g._editEdgeSourceTarget(q,G,X);N&&(g.edgeEditResult=N,O=N.tipText)}else if(!X){var x=g._guidingToEdit(G,k),f="realPoint"===i?g._interactor.gridGuide.findClosest(G,k,!0):null,U=1/0,I=1/0;f&&(f.x&&(U=f.x),f.y&&(I=f.y));var V=!1;x&&(x.xList&&(Math.abs(x.x)<=Math.abs(U)?(V=!0,U=x.x):delete x.xList),x.yList&&(Math.abs(x.y)<=Math.abs(I)?(V=!0,I=x.y):delete x.yList),V&&(g._guideInfo=x)),isFinite(U)&&(G.x+=U),isFinite(I)&&(G.y+=I),V&&(x.v=G)}}var K=g.screenInfo.curve;if("realPoint"===T.type){v=T.point,v.e!==e&&(G.e=v.e),K.moveRealPoint(v,G),T.point=G,g.highlight.point=G;var F=C.status,w=C.selections;if(g.activing={point:G,status:F},w){var y=G.clone().sub(v),Y=0;w.forEach(function(l){var n=l.clone().add(y);K.moveRealPoint(l,n),w[Y++]=n}),g.activing.selections=w}}else if("ctrlPoint"===T.type){var J=C.pairs,_=J[T.pairId];K.moveCtrlPoint(_,G,T.ctrlType);var M=C.status,m=Vq.Curve.PointType;if((M===m.Mirrored||M===m.Asymmetric)&&_.c1&&_.c2){var v=new Vq.Math.Vector2(C.point),u="c1"===T.ctrlType?"c2":"c1";if(M===Vq.Curve.PointType.Mirrored)K.moveCtrlPoint(_,v.clone().multiplyScalar(2).sub(G),u);else if(M===m.Asymmetric){var j=_[u].clone().sub(v).length(),t=v.clone().sub(_[T.ctrlType]).setLength(j).add(v);isNaN(t.x)||K.moveCtrlPoint(_,t,u)}}C._firePointChange()}else if("elevation"===T.type){B=T.startPoint;var n=B.e+(B.y-G.y)/R._zoom;g._setCurrentPointImpl("e",n),C._firePointChange(),O="E: "+Vq.toFixed(n)}var c=P.Default.getLogicalPoint($,g._interactor._canvas);if(c.x+=Vq.Icons.TipShiftX,c.y+=Vq.Icons.TipShiftY,!O){var Z=Vq.toWorldPosition(R,G);O=""+Vq.toFixed(Z.x)+", "+Vq.toFixed(Z.y)}g.tipInfo={helperPos:c,text:O,size:O.length},g._writeToHt(),g._interactor.fi({kind:"betweenEditPoint",event:$})}},po.prototype._setCurrentPointImpl=function(V,c){var p=this,Y=p._activing;if(!Y)return!1;var Q=p.target;if(!Q)return!1;var m=Y.getCurrentEditingPoint();if(!m)return!1;var g=Y.editingCtrl;if(!g)var S=m.clone();if("e"===V)m.e=c;else{var r;if("x"===V||"y"===V){var B=Y._lastFirePoint;r="x"===V?{x:c,y:B?B.y:0}:{x:B?B.x:0,y:c}}else"object"==typeof V?(r=V,V.e!==e&&(m.e=V.e)):(r={x:arguments[0],y:arguments[1]},arguments[2]!==e&&(m.e=arguments[2]));var t=Vq.getDataMatrix(Q);r=Vq.toScreenPosition(p._interactor.gv,t.apply(r)),m.x=r.x,m.y=r.y}if(!g){var W=S.multiplyScalar(-1).add(m);m.e&&S.e&&(W.e=m.e-S.e);var f=p.screenInfo.curve;f.moveCtrlDueToRealPointMovement(m,W);var T=Y.selections;if(T){var d=0;T.forEach(function(R){var L=R.clone().add(W);isFinite(W.e)&&(L.e=(isFinite(R.e)?R.e:Q.getElevation()||0)+W.e),f.moveRealPoint(R,L),T[d++]=L}),Y.selections=T}}return!0},po.prototype.setCurrentPoint=function(d,K){return this._setCurrentPointImpl(d,K)?(this._writeToHt(),!0):!1},po.prototype._isEditEdgeSourceTarget=function(){var v=this,d=v.target;if(!(d instanceof P.Edge))return!1;var f=v.editing.point,H=v.screenInfo.curve._curves;return f===H[0]._p1?"source":f===H[H.length-1]._p4?"target":!1},po.prototype._editEdgeSourceTarget=function(T,w,A){var X,_=this,O=_.target;if(X="source"===T?O.getSource():O.getTarget()){var B,i=_._interactor.gv,c=Vq.toWorldPosition(i,w),r=_._calcHostAnchor(O,T,c,X);if(B=r.index!==e||r.percent!==e?r.distance*i.getZoom()>_._interactor.getStyle("edgeHostEdgeMaxDistance"):_._interactor.getStyle("edgeHostDetectPerFrame")?!0:r.x<0||r.x>1||r.y<0||r.y>1?!0:!1){var k=i.getDataAt(c,function(C){return i.isSelectable(C)?i.isSourceTargetEditable(O,C,T)?O.canSetSourceTarget(C,T)?!0:!1:!1:!1});if(k){var x=_._calcHostAnchor(O,T,c,k);X=k,_._nextChangeEdgeHost={type:T,host:k},r=x}}var a,u,z;if(A||r.x===e)(r.percent!==e||r.index!==e)&&(u=r.point);else{var M=_._interactor.getStyle("anchorRound"),m=_._interactor.getStyle("anchorSensitivity");a=i.calculateAttachPoint(X,c),a?r=a.info:(r.x=Vq.roundTo(r.x,M,m),r.y=Vq.roundTo(r.y,M,m)),u=Rb(i,X,0,r.offsetX||0,r.offsetY||0,r.x,r.y)}u&&(z=Vq.toScreenPosition(i,u),w.x=z.x,w.y=z.y),_._edgeHostGuideInfo={corners:Vq.getTargetCornersOnScreen(i,X),attach:a?a.index:-1,host:X};var y;return r.percent!==e?y="percent: "+r.percent.toFixed(2):r.index!==e?y="index: "+r.index:(y=""+r.x.toFixed(2)+", "+r.y.toFixed(2),(r.offsetX||r.offsetY)&&(y+=" offset: "+r.offsetX.toFixed(2)+", "+r.offsetY.toFixed(2))),{host:X,anchor:r,tipText:y}}},po.prototype._guidingToEdit=function(G,t){var Z,m,R=this;if(Z=R.screenInfo.curve){m=Z._curves;var Q,N,J,L,X,T,j,u,s=1/0,w=1/0,z=[];for(R.editing&&"realPoint"===R.editing.type&&(u=R.editing.point),X=0,T=2*m.length;T>X;X++)j=m[Math.floor(X/2)][X%2?"_p4":"_p1"],z.indexOf(j)>=0||(z.push(j),u&&u===j||(J=j.x-G.x,L=j.y-G.y,Math.abs(J)<Math.abs(s)?(s=J,Q=[j]):J===s&&Q.push(j),Math.abs(L)<Math.abs(w)?(w=L,N=[j]):L===w&&N.push(j)));var E=R._interactor.getStyle("smartGuideThreshold");if((Math.abs(s)>E||"y"===t)&&(Q=null),(Math.abs(w)>E||"x"===t)&&(N=null),Q||N){var g=!1,O={};if(Q&&(g=!0,O.xList=Q,O.x=s),N&&(g=!0,O.yList=N,O.y=w),g)return O}}},po.prototype._46O=function($){var T=this;T.editing&&(T.editing=null,T._interactor.fi({kind:"endEditPoint",event:$})),T._guideInfo=null,T._edgeHostGuideInfo=null,T._pan&&(T._pan=null,T._interactor.fi({kind:"endPan",event:$})),T._multiSelect&&(T._handleMultiSelect(T._multiSelect),T._multiSelect=null),T.tipInfo=null,T.edgeEditResult=null},po.prototype._handleMultiSelect=function(k){if(k.startPoint&&k.endPoint){var m,u,h,q,Z,C=this,D=C._interactor,M=D.gv,f=Vq.toScreenPosition(M,k.startPoint),s=Vq.toScreenPosition(M,k.endPoint),b=P.Default.unionPoint(f,s),z=C.screenInfo.curve._curves,d=[],Y=function(Z){Z.x>=b.x&&Z.y>=b.y&&Z.x<=b.x+b.width&&Z.y<=b.y+b.height&&d.indexOf(Z)<0&&d.push(Z)};for(m=0,u=z.length;u>m;m++)Z=z[m],Y(Z._p1),Y(Z._p4);if(d.length){var n=C.activing||{},U=n.selections||[];for(n.point&&U.push(n.point),m=0,u=U.length;u>m;m++)h=U[m],q=d.indexOf(h),q>=0?d[q]=e:d.push(h);var I=d;for(d=[],m=0,u=I.length;u>m;m++)I[m]&&d.push(I[m]);u=d.length,0===u?C.activing=null:1===u?C.activing={point:d[0]}:(h=d[u-1],C.activing={point:h,selections:d.splice(0,u-1)}),D.redraw()}}},po.prototype._canDeletePoint=function($,q){var G=this.target;if(!(G instanceof P.Edge))return!0;var i=$._curves[0],g=$._curves[$._curves.length-1];return i._p1===q||g._p4===q?!1:!0},po.prototype.handleDelete=function(){var u=this;if(u.activing&&u.screenInfo){var R=P.Default.isShiftDown(),I=u.screenInfo.curve;u._canDeletePoint(I,u.activing.point)&&I.deleteRealPoint(u.activing.point,R),u.activing.selections&&u.activing.selections.forEach(function(E){u._canDeletePoint(I,E)&&I.deleteRealPoint(E,R)}),u.activing=null,delete u.editing,delete u.tipInfo,delete u.edgeEditResult,delete u._pan,delete u._multiSelect,u._writeToHt(),u._interactor.fp("deleteShapePoint",!1,!0)}},po.prototype.handleDoubleClick=function(T){var v=this,S=v._interactor._getLogicalPoint(T);if(v.screenInfo&&v._checkEditRealPoint(S)){var n=v.getCurrentSelectintStatus(),H=Vq.Curve.PointType;return n=n===H.Mirrored?H.Straight:H.Mirrored,v._setCurrentSelectionStatus(n),v._interactor._42(),!0}},po.prototype._drawHighlight=function(s){var T=this,v=T.highlight;if(v){var H=v.bezier,L=T._interactor;H&&Vq.Icons.DrawIcon(L,s,Vq.Icons.ShapeHighlightCurve,[H._p1.x,H._p1.y,H._p2.x,H._p2.y,H._p3.x,H._p3.y,H._p4.x,H._p4.y]);var D=v.point;D&&"insertKnot"===v.type&&Vq.Icons.DrawIcon(L,s,Vq.Icons.ShapeHighlighPoint,D)}},po.prototype._drawGuide=function(x){var Y=this,t=Y._guideInfo;if(t){var f,U,R,o,A=t.v;for(f=0;2>f;f++)if(o=0===f?t.xList:t.yList)for(U=0,R=o.length;R>U;U++)Vq.Icons.DrawIcon(Y._interactor,x,Vq.Icons.ShapeGuideLine,[A.x,A.y,o[U].x,o[U].y])}},po.prototype._drawCurrentPoint=function(Y){var U=this;if(U.activing){var F=U.activing,B=U.getCurrentSelectintStatus(),p=U._interactor;if(B!==Vq.Curve.PointType.Straight){var P=F.pairs;F.hlpair,F.hltype;var v=F.selections,a=F.editingCtrl;if(P&&!v){var g,Z,e;for(Z=0,e=P.length;e>Z;Z++)g=P[Z],a&&Z===a.pairId&&g[a.type]?Vq.Icons.DrawIcon(p,Y,Vq.Icons.ShapeActivingCtrl,{point:g.point,c1:g.c1,c2:g.c2,hl:a.type}):Vq.Icons.DrawIcon(p,Y,Vq.Icons.ShapeActivingCtrl,g)}}Vq.Icons.DrawIcon(p,Y,Vq.Icons.ShapeHighlighRealPoint,U.activing.point),v&&v.forEach(function(l){Vq.Icons.DrawIcon(p,Y,Vq.Icons.ShapeHighlighRealPoint,l)})}},po.prototype.clear=function(){var P=this;P.editing=null,P._guideInfo=null,P.activing=null,P.highlight=null},po.prototype._42=function($){var T=this;T.info={},T.editing||(T.screenInfo=null);var b=T._interactor;if(!b.editDetail)return T.clear(),void 0;var X=b.gv;if(!T.target||!X.isSelected(T.target)||!X.isVisible(T.target))return b.editDetail=!1,T.clear(),void 0;if(T.gatherSingleTarget(X,T.target),Vq.Icons.DrawIcon(b,$,Vq.Icons.ShapeBgCurve,T.screenInfo),T._interactor.getStyle("curveElevationVisible")&&(T.target instanceof P.Polyline||T.target instanceof P.Edge&&T._interactor.getStyle("edgeElevationEditable"))&&T.activing){var y=T.activing.getCurrentEditingPoint();y&&"string"!=typeof y.e&&Vq.Icons.DrawIcon(b,$,Vq.Icons.EdgeElevationGuide,y)}if(T._drawHighlight($),T._drawCurrentPoint($),T._getRealPoint().forEach(function(f){Vq.Icons.DrawIcon(b,$,Vq.Icons.ShapePoint,f)}),T._drawGuide($),T.tipInfo&&T._interactor.getStyle("curveTipVisible")&&Vq.Icons.DrawIcon(b,$,Vq.Icons.TipHelper,T.tipInfo),T._edgeHostGuideInfo&&b._drawHostGuide(T._edgeHostGuideInfo),T.edgeEditResult&&T._drawEdgeHostHighlight($,T.edgeEditResult.host,T.edgeEditResult.anchor),T._multiSelect&&T._multiSelect.endPoint){var k=P.Default.unionPoint(Vq.toScreenPosition(X,T._multiSelect.startPoint),Vq.toScreenPosition(X,T._multiSelect.endPoint));k.color=X.getRectSelectBorderColor(),$.save(),$.setTransform(1,0,0,1,0,0);var J=_.devicePixelRatio,z=k.borderWidth=Math.round(J);z/=2,k.x=Math.round(k.x*J)+z,k.y=Math.round(k.y*J)+z,k.width=Math.round(k.width*J),k.height=Math.round(k.height*J),Vq.Icons.DrawIcon(b,$,Vq.Icons.SimpleRect,k),$.restore()}},po.prototype._drawEdgeHostHighlight=function(z,L,C){this.drawEdgeHostHighlight(z,L,C),this._interactor.redraw()},po.prototype.drawEdgeHostHighlight=function(E,X,G){if(cn(X)){var U,O,H,Y,L=this,i=L._interactor,W=i.gv,m=W.getDataUI(X),K=Cp(m),v=[];for(H=0,Y=K.points.length;Y>H;H++)O=Vq.toScreenPosition(W,K.points.get(H)),v.push(O.x,O.y);K.segments&&(U=K.segments.toArray());var k=i.getStyle("edgeHostHighlighPeriod"),j=i.getStyle("edgeHostEdgeHighlighColor");Vq.Icons.DrawIcon(i,E,Vq.Icons.ShapeBgCurve,{P:v,S:U,color:j,dynamicVisible:G.index===e,dynamicPeriod:k}),j=i.getStyle("edgeHostPointHighlighColor");var t=Ol(m);for(H=0,Y=t.length;Y>H;H++){var x=t[H],c=Vq.toScreenPosition(W,x);Vq.Icons.DrawIcon(i,E,Vq.Icons.ShapePoint,{point:{x:c.x,y:c.y},color:j,size:12,dynamicVisible:H===G.index,dynamicPeriod:k})}}},po.prototype._getRealPoint=function(){var H,J=this.screenInfo,B=J.P,k=J.S,l=-1,Y=[],U=-1,S=k.length;return k.each(function(f){U++;var u=1;if(3===f)u=2;else if(4===f)u=3;else if(5===f)return;l+=u,H=U+1>=S?!0:1===k.get(U+1)?!0:!1,Y.push({point:{x:B[2*l],y:B[2*l+1]},segmentIndex:U,pointIndex:l,isEnd:H})}),Y},po.prototype.getEditingPointsInfo=function(S){var d=this,p=d.activing;if(!p)return!1;var N=p.point;if(!N)return!1;var e=this._getRealPoint(),x=[{screen:N}];p.selections&&p.selections.forEach(function(J){x.push({screen:J})});var n,s,b=e.length;return x.forEach(function(t){for(n=0;b>n;n++)if(s=e[n],t.screen.isNearEnough(s.point)){t.segmentIndex=s.segmentIndex,t.pointIndex=s.pointIndex,t.point=d.target.getPoints().get(s.pointIndex);break}}),S&&x.sort(function(q,e){return q.segmentIndex-e.segmentIndex}),x};var gc=Vq.MoveHelper=function(N){var x=this;x.catalog="Move",x._interactor=N};gc.prototype={},gc.prototype.constructor=gc,gc.prototype.calcShift=function(D,j,G){var X,$,H=this,A=H._interactor.gv,x=A.lp(j);if("beginMove"===D&&H._gatherGridInfo(G._lastLogicalPoint||x),X=H._target){var n=X.downPosition;if(n){var O=H._interactor.getStyle("moveSensitivity")/A._zoom;if(n.distanceTo(x)<O)return{x:0,y:0};delete X.downPosition}var f;$=P.Default.isShiftDown(j),$&&(x=H._dealShiftDown(x),f=X.shiftGuide.dir);var M,Q=X.rawPos={x:X.pos.x+x.x-X.lp.x,y:X.pos.y+x.y-X.lp.y};if(P.Default.isCtrlDown(j)){if(M=H._calcShiftByAddon(),H._target.node instanceof Vq.Group){var T=H._target.node;T._position.x+=M.x,T._position.y+=M.y}return M}var t=H._interactor.rectGuide;if(X.node instanceof P.Data&&X.node.s("2d.attachable")){var C=H._calcAttachNodeShift(X.node,Q);if(t.clear(),C)return C}for(var z,d=X.x+Q.x,h=X.y+Q.y,g={x:d,y:h},L={x:d+X.w/2,y:h+X.h/2},B={x:d+X.w,y:h+X.h},l=H._interactor.gridGuide,Z=[t.findClosest(g,f),t.findClosest(L,f),t.findClosest(B,f),l.findClosest(g,f),l.findClosest(L,f),l.findClosest(B,f)],r=1/0,e=1/0,o=0,v=Z.length;v>o;o++)z=Z[o],z&&(d=z.x,h=z.y,isFinite(d)&&Math.abs(d)<Math.abs(r)&&(r=d),isFinite(h)&&Math.abs(h)<Math.abs(e)&&(e=h));if(isFinite(r)||(r=0),isFinite(e)||(e=0),M=H._calcShiftByAddon(r,e),H._target.node instanceof Vq.Group){var T=H._target.node;T._position.x+=M.x,T._position.y+=M.y}var y=X.node;if(!Ak(y,A)){var q=Q.x+r,K=Q.y+e;H._interactor.rectGuide.gatherLines({node:y,x:X.x+q,y:X.y+K,w:X.w,h:X.h},f)}return M}},gc.prototype._calcShiftByAddon=function(b,g){var i=this._target,S=i.rawPos,m=i.node.getPosition();return b=b||0,g=g||0,{x:S.x-m.x+b,y:S.y-m.y+g}},gc.prototype._dealShiftDown=function(n){var y=this,d=y._target.shiftGuide,e=y._target.lp,R=Math.abs(n.x-e.x),S=Math.abs(n.y-e.y);R>S&&R>d.limit&&"y"===d.dir&&(d.dir="x"),S>R&&S>d.limit&&"x"===d.dir&&(d.dir="y");var I=d.dir;return"x"===I?(n.y=e.y,d.limit=Math.max(d.limit,R)):"y"===I&&(n.x=e.x,d.limit=Math.max(d.limit,S)),n},gc.prototype._isAttachableLineShape=function(x){if(!x.getSegments)return!1;var S=x.getSegments();if(!S)return!0;S instanceof P.List&&(S=S.getArray());for(var j=1,o=S.length;o>j;j++)if(2!==S[j])return!1;return!0},gc.prototype._calcAttachNodeShift=function(){var d=new $j,x=new $j,n=new $j,G=new $j;return function(A,D){var h=this._interactor.gv,q=A.getHost(),V=h.getDataAt(D,function(G){return G.s("2d.hostable")?!0:!1});if(V&&q!==V&&A.setHost(V),!V)return this._edgeHostGuideInfo=null,A.setHost(null);var K=this._edgeHostGuideInfo={corners:Vq.getTargetCornersOnScreen(h,V),host:V,attach:-1};if(this._isAttachableLineShape(V)){for(var X,E,Q,C,B,j,F=V.getPoints(),P=F.size(),w=V.getPointsMatrix2d(),Z=1/0,c=0;P>c&&(c!==P-1||V.isClosePath());c++)0!==c?x.copy(n):w.apply(F.get(c),x),w.apply(c===P-1?F.get(0):F.get(c+1),n),d.copy(D).sub(x),G.copy(n).sub(x),X=G.length(),G.divideScalar(X),E=d.dot(G),0>E?E=0:E>X&&(E=X),G.multiplyScalar(E).add(x),Q=d.copy(D).sub(G).lengthSq(),Z>Q&&(Z=Q,j=c,C=E,B=X);return Math.sqrt(Z)*h.getZoom()>this._interactor.getStyle("attachThreshold")?(A.s({"attach.index":-1}),A.setHost(null),void 0):(A.s("attach.offset.opposite")&&(C=B-C),A.s({"attach.index":j,"attach.offset":A.s("attach.offset.relative")?C/B:C}),{x:0,y:0})}var Y=h.calculateAttachPoint(V,D);if(Y){var N=Y.point;return K.attach=Y.index,this._calcShiftByAddon(N.x-D.x,N.y-D.y)}}}(),gc.prototype._gatherGridInfo=function(I){var J,t=this,n=t._interactor,l=n._getValidSelection();if(l.length){if(1===l.length){if(J=l[0],!J.getRect)return t._target=null,void 0}else if(J=Vq.Group.findOrCreateGroup(l),!J)return t._target=null,void 0}else{var l=n.gv.sm().getSelection();if(l.length&&(J=l.get(0),!J.getRect))return t._target=null,void 0}if(J){var S=J.getPosition(),X=J.getRect();t._target={node:J,x:X.x-S.x,y:X.y-S.y,w:X.width,h:X.height,lp:{x:I.x,y:I.y},pos:{x:S.x,y:S.y},shiftGuide:{dir:"x",limit:0},downPosition:new Vq.Math.Vector2(I)},n.rectGuide.gatherRects()}},gc.prototype.clear=function(){var q=this;q._edgeHostGuideInfo=null,q._interactor.rectGuide.clear(),q._interactor._42()},gc.prototype._42=function(){var H=this._edgeHostGuideInfo;H&&this._interactor._drawHostGuide(H)};var rd="directional",Wc="point",Xj="spot",pq="light.color",qi={},cc=function(z,O){nf(O)&&Po.test(O)?ij(z,O):Tp(O)&&O.modelType?Rg(z,O):O===e?delete Id[z]:Id[z]=O},Bi=function(n){return n},ns=function(x){x=b.convertShape3dModelName(x);var B;if(Tp(x)){if(x.modelType){if(x.uuid){if(B=Id[x.uuid])return B}else x.uuid=P.Math.generateUUID();return B===e&&(vo&&vo[x.uuid]||Rg(x.uuid,x)),e}return x}return B=Id[x],x&&B===e&&Po.test(x)&&(vo&&vo[x]||ij(x,x)),B},Wi=function(e,m){e.frameStack?e.frameStack.push(m):e.frameStack=[m],e.bindFramebuffer(e.FRAMEBUFFER,m)},vs=function(O){var $=O.frameStack;if($){if($.pop(),$.length)return O.bindFramebuffer(O.FRAMEBUFFER,$[$.length-1]),void 0;O.frameStack=null}O.bindFramebuffer(O.FRAMEBUFFER,null)};Ec(b,{graph3dViewAttributes:A,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:O/60,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Ng,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:O,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:O/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:cc,getShape3dModel:ns,convertShape3dModelName:Bi,getShape3dModelMap:function(){return Id},getCachedShape3dModelMap:function(){return gq},createMatrix:function(k,T){Fl(k)||(k=[k]);for(var V=k.length-1;V>=0;V--){var S=k[V];T=mq(S.mat,S.s3,S.r3,S.rotationMode,S.t3,T)}return T},transformVec:function(z,F){return rm(z,F)},glBindFrame:Wi,glUnbindFrame:vs,createBoxModel:function(){return{vs:dl,ns:Uk,uv:_i,is:Wd}},createRoundRectModel:function(G,m){return mf.roundRect(G,m)},createStarModel:function(m,r){return mf.star(m,r)},createRectModel:function(x,E){return mf.rect(x,E)},createTriangleModel:function(c,X){return mf.triangle(c,X)},createRightTriangleModel:function(d,m){return mf.rightTriangle(d,m)},createParallelogramModel:function(d,h){return mf.parallelogram(d,h)},createTrapezoidModel:function(F,e){return mf.trapezoid(F,e)},createSmoothSphereModel:function(s,B,K,C,f,X,r){return Nj(new gj(s,B,K,C,f,X,r))},createSphereModel:function(j,L,u,U,N,S,h){return j?Ug(j,L,u,U,N,S,h):b.createSmoothSphereModel()},createSmoothConeModel:function(i,C,q,F,m){return Xq(i,C,q,F,m)},createConeModel:function(P,b,F,y,g,G){return P?xk(P,b,F,y,g,G):Xq(G)},createSmoothCylinderModel:function(P,H,h,F,k,j,O,w){return Nj(new Qm(P,H,h,F,k,j,O,w))},createCylinderModel:function(s,t,l,z,j,L,T,k){return s?Vo(s,t,l,z,j,L,T,k):Hh(L,T)},createSmoothTorusModel:function(t,I,n,h,s,q){return Nj(new lg(t,I,n,h,s,q))},createTorusModel:function(G,K,_,t,Y,o,Q,i){return G?vl(G,K,_,t,Y,o,Q,i):kk(o,Q)},createExtrusionModel:function(Z,v,S,z,f,h,c,e){return Ij(Z,v,S,z,f,h,c,e)},createSmoothRingModel:function(f,I,H,Z,w,c){for(var Y=[],e=0;e<f.length-1;e+=2)Y.push({x:f[e],y:f[e+1]});for(f=vm(Y,I,H)[0],Y=[],e=0;e<f.length;e++){var F=f[e];Y.push(new Op(F.x,0,F.y))}return Nj(new Bd(Y,c,Z,w))},createTextGeometry:function(O,p){return Nj(new ml(O,p))},loadFontFace:function(_,J){b.xhrLoad(_,function(r){if(!r)return J();var Y;try{Y=JSON.parse(r)}catch(e){Y=JSON.parse(r.substring(65,r.length-2))}ki.loadFace(Y),J&&J(Y.familyName.toLowerCase())},J?null:{sync:!0})},createRingModel:function(h,z,F,U,O,k,P,Y,X,p){for(var n=[],w=0;w<h.length-1;w+=2)n.push({x:h[w],y:h[w+1]});k=k||b.shapeSide,P=P||0,Y=Y||k;var o,W,i,x,m,V,v,y,I,J,w,Q,l,D,Z,C,B,K,g=[],L=[],e=X?[]:A,r=X?[]:A,c=p?[]:A,d=p?[]:A,$=U?[]:A,N=U?[]:A,R=O?[]:A,G=O?[]:A,h=vm(n,z,F),M=jp(h),q=0,_=2*Math.PI/k;return h.forEach(function(f){if(i=f.length,i>1){if(x=f[0],U)for(V=x.x,y=x.y,w=P;Y>w;w++)Q=w+1,l=w*_,D=Q*_,Z=E(l),C=j(l),B=E(D),K=j(D),$.push(Z*V,y,-C*V,B*V,y,-K*V,0,y,0),N.push(.5-.5*Z,.5-.5*C,.5-.5*B,.5-.5*K,.5,.5);for(J=0;i>J;J++){for(m=f[J],V=x.x,v=m.x,y=x.y,I=m.y,o=q/M,q+=np(x,m),W=q/M,w=P;Y>w;w++)Q=w+1,l=w*_,D=Q*_,Z=E(l),C=j(l),B=E(D),K=j(D),g.push(Z*v,I,-C*v,B*v,I,-K*v,Z*V,y,-C*V,B*v,I,-K*v,B*V,y,-K*V,Z*V,y,-C*V),L.push(w/k,W,Q/k,W,w/k,o,Q/k,W,Q/k,o,w/k,o),X&&w===P&&(e.push(0,y,0,0,I,0,Z*v,I,-C*v,Z*v,I,-C*v,Z*V,y,-C*V,0,y,0),r.push(0,.5-y,0,.5-I,2*v,.5-I,2*v,.5-I,2*V,.5-y,0,.5-y)),p&&Q===Y&&(c.push(0,y,0,B*v,I,-K*v,0,I,0,B*v,I,-K*v,0,y,0,B*V,y,-K*V),d.push(1,.5-y,1-2*v,.5-I,1,.5-I,1-2*v,.5-I,1,.5-y,1-2*V,.5-y));x=m}if(O)for(V=x.x,y=x.y,w=P;Y>w;w++)Q=w+1,l=w*_,D=Q*_,Z=E(l),C=j(l),B=E(D),K=j(D),R.push(B*V,y,-K*V,Z*V,y,-C*V,0,y,0),G.push(.5-.5*B,.5+.5*K,.5-.5*Z,.5+.5*C,.5,.5)}}),{vs:g,uv:L,bottom_vs:R,bottom_uv:G,top_vs:$,top_uv:N,from_vs:e,from_uv:r,to_vs:c,to_uv:d}}},!0),Ec(n,{"3d.move.mode":e,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"shape.border.gradient.color":e,"edge.gradient.color":e,"edge.source.t3":e,"edge.target.t3":e,"light.type":Wc,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":O/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Zr,"wf.short":!1,"wf.mat":e,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:e,"transparent.mask":!1,brightness:e,"select.brightness":.7,"repeat.uv.length":e,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":e,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":Kg,"label.t3":e,"label.r3":e,"label.texture.scale":2,"label.rotationMode":bg,"label.light":!1,"label.blend":e,"label.reverse.flip":!1,"label.reverse.color":Mk,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Kg,"label2.t3":e,"label2.r3":e,"label2.texture.scale":2,"label2.rotationMode":bg,"label2.light":!1,"label2.blend":e,"label2.reverse.flip":!1,"label2.reverse.color":Mk,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Kg,"note.t3":e,"note.r3":e,"note.texture.scale":2,"note.rotationMode":bg,"note.light":!1,"note.blend":e,"note.reverse.flip":!1,"note.reverse.color":Mk,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Kg,"note2.t3":e,"note2.r3":e,"note2.texture.scale":2,"note2.rotationMode":bg,"note2.light":!1,"note2.blend":e,"note2.reverse.flip":!1,"note2.reverse.color":Mk,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:e,"shape3d.color":Cr,"shape3d.top.color":e,"shape3d.bottom.color":e,"shape3d.from.color":e,"shape3d.to.color":e,"shape3d.image":e,"shape3d.top.image":e,"shape3d.bottom.image":e,"shape3d.from.image":e,"shape3d.to.image":e,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":e,"shape3d.side.to":e,"shape3d.smooth":e,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":e,"shape3d.opacity":e,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Mk,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":e,"shape3d.uv.scale":e,"shape3d.top.uv.offset":e,"shape3d.top.uv.scale":e,"shape3d.bottom.uv.offset":e,"shape3d.bottom.uv.scale":e,"shape3d.from.uv.offset":e,"shape3d.from.uv.scale":e,"shape3d.to.uv.offset":e,"shape3d.to.uv.scale":e,"shape3d.top.cap":e,"shape3d.bottom.cap":e,"shape3d.start.angle":0,"shape3d.sweep.angle":U,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":e,"texture.filter":e,"texture.filter.min":e,"texture.filter.mag":e,"csg.cull.color":e,"all.light":!0,"all.visible":!0,"all.color":Cr,"all.image":e,"all.blend":e,"all.opacity":e,"all.reverse.flip":!1,"all.reverse.color":Mk,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":e,"all.uv.offset":e,"all.uv.scale":e,"all.discard.selectable":!0,mat:e,"left.mat":e,"right.mat":e,"top.mat":e,"bottom.mat":e,"front.mat":e,"back.mat":e,"edge.source.anchor.elevation":e,"edge.target.anchor.elevation":e},!0);
var zo,fk=!1,uh=[0,0,0,0],qn={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Rc,2:Pc,3:Oe,4:fl,5:Kg,6:gl}},Ed=function(i,I,X,U){if(I.getFaceVisible(i,X)){var x=ro(i,I.getFaceMat(i,X)||I.getMat(i));i.appendAnchorMatrix3d(x),Ae(I,x);var F=I._26I;I.getFaceReverseCull(i,X)?F.enable(F.CULL_FACE):F.disable(F.CULL_FACE),_m(F,I._prg.uFixPickReverseColor,qn[X]),$k(F),fh(F,U,6),Kb(F),gs(I)}},Je=function(B){return B instanceof As},xi=function(L){return[L.x,L.e||0,L.y]},So=function(Z,b,N){for(var b=Lc(b),C=b[0],G=b[1],q=b[2];N--;)Z.push(C,G,q)},Yr=function(W,E,$){for(var E=Lc(E),Y=E[0],f=E[1],k=E[2],C=E[3];$--;)W.push(Y,f,k,C)},Jg=function(j,R,Q){if(R)for(var h,p,t,K=R[0],$=R[1],s=R[2],v=R[4],k=R[5],e=R[6],d=R[8],E=R[9],a=R[10],x=R[12],L=R[13],D=R[14],y=Q.length,f=0,f=0;y>f;f+=3)h=Q[f],p=Q[f+1],t=Q[f+2],j.push(K*h+v*p+d*t+x,$*h+k*p+E*t+L,s*h+e*p+a*t+D);else oj(j,Q)},jn=function(F,W){var G=W.s("light.intensity"),_=Lc(W.s(pq)),t=_[0],S=_[1],d=_[2];1!==G&&(t*=G,S*=G,d*=G),F.push(t,S,d,W.s("light.disabled")?1:0)},yp=function(D,$,l){_m($,l.uHeadlightRange,D._headlightRange),_m($,l.uHeadlightAmbientIntensity,D._headlightAmbientIntensity);var w=D._headlightIntensity,v=Lc(D._headlightColor);1!==w&&(v=[v[0]*w,v[1]*w,v[2]*w]),_m($,l.uHeadlightColor,[v[0],v[1],v[2],D._headlightDisabled?1:0]);var Y=D._59O,F=D._spots,e=D._dirs;if(Y.length){var g=[],q=[],L=[];Y.forEach(function(H){jn(g,H),oj(q,D._transformPointToViewSpace(H.p3())),L.push(H.s("light.range"))}),$.uniform4fv(l.uPointColor,g),$.uniform1fv(l.uPointRange,L),$.uniform3fv(l.uPointPosition,q)}if(F.length){var j=[],Q=[],A=[],U=[],u=[],O=[];F.forEach(function(q){jn(j,q),oj(Q,D._transformPointToViewSpace(q.p3())),oj(u,D._transformDirectionToViewSpace(q.p3(),q.s("light.center"))),A.push(q.s("light.range")),U.push(E(q.s("light.angle")/2)),O.push(q.s("light.exponent"))}),$.uniform4fv(l.uSpotColor,j),$.uniform1fv(l.uSpotRange,A),$.uniform1fv(l.uSpotAngle,U),$.uniform1fv(l.uSpotExponent,O),$.uniform3fv(l.uSpotPosition,Q),$.uniform3fv(l.uSpotDirection,u)}if(e.length){var i=[],W=[];e.forEach(function(w){jn(i,w),oj(W,D._transformDirectionToViewSpace(w.p3()))}),$.uniform4fv(l.uDirColor,i),$.uniform3fv(l.uDirDirection,W)}},Wl=function(S){return Math.max(b.graph3dViewMinPhi+dd,Math.min(b.graph3dViewMaxPhi-dd,S))},xd=function(){return.05+V()/2},li=function(F,Q,_,N){var M,P=F.getEye();return F.isOrtho()?(M=Nm(F.getCenter(),P),M[0]+=N[0],M[1]+=N[1],M[2]+=N[2]):M=P,jd(Q,_,N,M)},jd=function(p,K,I,X){var t=Hi(p,K),l=Nm(X,I,!0),C=Hi(l,K);if(T(C)<dd)return A;var u=(t-Hi(I,K))/C;return[I[0]+l[0]*u,I[1]+l[1]*u,I[2]+l[2]*u]},hb=function(z,M){return{x:2*z.x-M.x,y:2*z.y-M.y}},Or=function(h,q,B,$){var s,e;if(!h)return s=o(q.y-B.y,B.x-q.x),{x:q.x+$*j(s),y:q.y+$*E(s)};if(!B)return s=o(h.y-q.y,q.x-h.x),{x:q.x+$*j(s),y:q.y+$*E(s)};var N=Nm([h.x,h.y,0],[q.x,q.y,0],!0),R=Nm([B.x,B.y,0],[q.x,q.y,0],!0),P=-(N[0]+R[0])/2,F=-(N[1]+R[1])/2,v=D(P*P+F*F);if(dd>v)return s=o(h.y-q.y,q.x-h.x),{x:q.x+$*j(s),y:q.y+$*E(s)};var l=h.x-q.x,n=h.y-q.y,W=B.x-q.x,X=B.y-q.y,Q=D(l*l+n*n),J=D(W*W+X*X);s=M(Hi(N,R))/2,e=N[1]*R[0]-N[0]*R[1]>0?-1:1,P/=v,F/=v;var b=$/j(s),I=a(Q,J)/E(s);v=Math.min(b,I);var c={x:q.x+e*v*P,y:q.y+e*v*F};return B.b&&b>J/E(s)&&(c.adjust=!0),c},Hq=function(m){var P=m[1],B=m[2],A=m[3],E=m[6],q=m[7],S=m[11];m[1]=m[4],m[2]=m[8],m[3]=m[12],m[4]=P,m[6]=m[9],m[7]=m[13],m[8]=B,m[9]=E,m[11]=m[14],m[12]=A,m[13]=q,m[14]=S},nr=function(H){var u=H[0],w=H[1],I=H[2],J=H[3],h=H[4],v=H[5],j=H[6],m=H[7],p=H[8],S=H[9],O=H[10],D=H[11],F=H[12],B=H[13],P=H[14],y=H[15],N=u*v-w*h,L=u*j-I*h,W=u*m-J*h,q=w*j-I*v,X=w*m-J*v,$=I*m-J*j,t=p*B-S*F,i=p*P-O*F,T=p*y-D*F,z=S*P-O*B,G=S*y-D*B,Z=O*y-D*P,f=N*Z-L*G+W*z+q*T-X*i+$*t;return f?(f=1/f,H[0]=(v*Z-j*G+m*z)*f,H[1]=(I*G-w*Z-J*z)*f,H[2]=(B*$-P*X+y*q)*f,H[3]=(O*X-S*$-D*q)*f,H[4]=(j*T-h*Z-m*i)*f,H[5]=(u*Z-I*T+J*i)*f,H[6]=(P*W-F*$-y*L)*f,H[7]=(p*$-O*W+D*L)*f,H[8]=(h*G-v*T+m*t)*f,H[9]=(w*T-u*G-J*t)*f,H[10]=(F*X-B*W+y*N)*f,H[11]=(S*W-p*X-D*N)*f,H[12]=(v*i-h*z-j*t)*f,H[13]=(u*z-w*i+I*t)*f,H[14]=(B*L-F*q-P*N)*f,H[15]=(p*q-S*L+O*N)*f,void 0):A},ac=function(q,T){if(T){var r=T[0],E=T[1],Z=T[2];q[12]=q[0]*r+q[4]*E+q[8]*Z+q[12],q[13]=q[1]*r+q[5]*E+q[9]*Z+q[13],q[14]=q[2]*r+q[6]*E+q[10]*Z+q[14],q[15]=q[3]*r+q[7]*E+q[11]*Z+q[15]}},Zg=function(r,E){if(E){var k=E[0],N=E[1],Q=E[2];r[0]=r[0]*k,r[1]=r[1]*k,r[2]=r[2]*k,r[3]=r[3]*k,r[4]=r[4]*N,r[5]=r[5]*N,r[6]=r[6]*N,r[7]=r[7]*N,r[8]=r[8]*Q,r[9]=r[9]*Q,r[10]=r[10]*Q,r[11]=r[11]*Q}},Vg=function(Y,E,i){var S=E[0],V=E[1],s=E[2],h=E[3],Z=E[4],c=E[5],R=E[6],I=E[7],U=E[8],$=E[9],k=E[10],G=E[11],t=E[12],u=E[13],K=E[14],T=E[15],g=i[0],r=i[1],J=i[2],f=i[3];return Y[0]=g*S+r*Z+J*U+f*t,Y[1]=g*V+r*c+J*$+f*u,Y[2]=g*s+r*R+J*k+f*K,Y[3]=g*h+r*I+J*G+f*T,g=i[4],r=i[5],J=i[6],f=i[7],Y[4]=g*S+r*Z+J*U+f*t,Y[5]=g*V+r*c+J*$+f*u,Y[6]=g*s+r*R+J*k+f*K,Y[7]=g*h+r*I+J*G+f*T,g=i[8],r=i[9],J=i[10],f=i[11],Y[8]=g*S+r*Z+J*U+f*t,Y[9]=g*V+r*c+J*$+f*u,Y[10]=g*s+r*R+J*k+f*K,Y[11]=g*h+r*I+J*G+f*T,g=i[12],r=i[13],J=i[14],f=i[15],Y[12]=g*S+r*Z+J*U+f*t,Y[13]=g*V+r*c+J*$+f*u,Y[14]=g*s+r*R+J*k+f*K,Y[15]=g*h+r*I+J*G+f*T,Y},Cm=function(j,E,P,p){var I,f,R,x,n,J,d,V,Y,e,i=E[0],s=E[1],C=E[2],o=p[0],U=p[1],K=p[2],Q=P[0],M=P[1],u=P[2];return T(i-Q)<dd&&T(s-M)<dd&&T(C-u)<dd?Qe(j):(d=i-Q,V=s-M,Y=C-u,e=1/D(d*d+V*V+Y*Y),d*=e,V*=e,Y*=e,I=U*Y-K*V,f=K*d-o*Y,R=o*V-U*d,e=D(I*I+f*f+R*R),e?(e=1/e,I*=e,f*=e,R*=e):(I=0,f=0,R=0),x=V*R-Y*f,n=Y*I-d*R,J=d*f-V*I,e=D(x*x+n*n+J*J),e?(e=1/e,x*=e,n*=e,J*=e):(x=0,n=0,J=0),j[0]=I,j[1]=x,j[2]=d,j[3]=0,j[4]=f,j[5]=n,j[6]=V,j[7]=0,j[8]=R,j[9]=J,j[10]=Y,j[11]=0,j[12]=-(I*i+f*s+R*C),j[13]=-(x*i+n*s+J*C),j[14]=-(d*i+V*s+Y*C),j[15]=1,j)},Gm=function(s,D,K,p,d){var L=1/r(D/2),X=1/(p-d);return s[0]=L/K,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=L,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=(d+p)*X,s[11]=-1,s[12]=0,s[13]=0,s[14]=2*d*p*X,s[15]=0,s},Ck=function(W,y,E,m,V,c,F){var h=1/(y-E),Y=1/(m-V),g=1/(c-F);return W[0]=-2*h,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=-2*Y,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=2*g,W[11]=0,W[12]=(y+E)*h,W[13]=(V+m)*Y,W[14]=(F+c)*g,W[15]=1,W},Mr=function(d,G){var K=G[0],g=G[1],Y=G[2],e=G[3],r=K*K+g*g+Y*Y+e*e,P=r?1/r:0;return d[0]=-K*P,d[1]=-g*P,d[2]=-Y*P,d[3]=e*P,d},Xn=function(M,e){var I=e[0]+e[5]+e[10],K=0;return I>0?(K=2*Math.sqrt(I+1),M[3]=.25*K,M[0]=(e[6]-e[9])/K,M[1]=(e[8]-e[2])/K,M[2]=(e[1]-e[4])/K):e[0]>e[5]&e[0]>e[10]?(K=2*Math.sqrt(1+e[0]-e[5]-e[10]),M[3]=(e[6]-e[9])/K,M[0]=.25*K,M[1]=(e[1]+e[4])/K,M[2]=(e[8]+e[2])/K):e[5]>e[10]?(K=2*Math.sqrt(1+e[5]-e[0]-e[10]),M[3]=(e[8]-e[2])/K,M[0]=(e[1]+e[4])/K,M[1]=.25*K,M[2]=(e[6]+e[9])/K):(K=2*Math.sqrt(1+e[10]-e[0]-e[5]),M[3]=(e[1]-e[4])/K,M[0]=(e[8]+e[2])/K,M[1]=(e[6]+e[9])/K,M[2]=.25*K),M},ab=function(Q,A,M){var f=A[0],E=A[1],$=A[2],Z=A[3],S=f+f,s=E+E,F=$+$,y=f*S,b=f*s,n=f*F,G=E*s,w=E*F,N=$*F,B=Z*S,X=Z*s,U=Z*F;return Q[0]=1-(G+N),Q[1]=b+U,Q[2]=n-X,Q[3]=0,Q[4]=b-U,Q[5]=1-(y+N),Q[6]=w+B,Q[7]=0,Q[8]=n+X,Q[9]=w-B,Q[10]=1-(y+G),Q[11]=0,Q[12]=M[0],Q[13]=M[1],Q[14]=M[2],Q[15]=1,Q},Tl=function(Z,V){if(Z.vr.enable){var e=Z.vr.getViewMatrix(V);if(e)return e}return Cm(V?V:om(),Z._eye,Z._center,Z._up)},Sh=function(Z,V){if(Z.vr.enable){var f=Z.vr.getProjectMatrix();if(f)return f}if(!V&&Z._computedProjectMatrix)return Md(Z._computedProjectMatrix);var t=Z.getAspect(),d=Z._near,I=Z._far,c=om();if(Z._ortho){var s=Z._orthoWidth/2,h=s/t;Ck(c,-s,s,-h,h,d,I)}else Gm(c,Z._fovy,t,d,I);return c},Dn=function(i,N){if(!i)return A;var x=0,B=1,L=2,S=[],W=0,w=i.length,R=w/3;if(N){for(;w>W;W++)S[W]=0;for(W=0;W<N.length;W+=3){var Z=[],F=[],G=[];Z[x]=i[3*N[W+1]+x]-i[3*N[W]+x],Z[B]=i[3*N[W+1]+B]-i[3*N[W]+B],Z[L]=i[3*N[W+1]+L]-i[3*N[W]+L],F[x]=i[3*N[W+2]+x]-i[3*N[W+1]+x],F[B]=i[3*N[W+2]+B]-i[3*N[W+1]+B],F[L]=i[3*N[W+2]+L]-i[3*N[W+1]+L],G[x]=Z[B]*F[L]-Z[L]*F[B],G[B]=Z[L]*F[x]-Z[x]*F[L],G[L]=Z[x]*F[B]-Z[B]*F[x];for(var s=0;3>s;s++)S[3*N[W+s]+x]+=G[x],S[3*N[W+s]+B]+=G[B],S[3*N[W+s]+L]+=G[L]}}else for(W=0;R>W;W+=3){var Z=[],F=[],G=[];Z[x]=i[3*(W+1)+x]-i[3*W+x],Z[B]=i[3*(W+1)+B]-i[3*W+B],Z[L]=i[3*(W+1)+L]-i[3*W+L],F[x]=i[3*(W+2)+x]-i[3*(W+1)+x],F[B]=i[3*(W+2)+B]-i[3*(W+1)+B],F[L]=i[3*(W+2)+L]-i[3*(W+1)+L],G[x]=Z[B]*F[L]-Z[L]*F[B],G[B]=Z[L]*F[x]-Z[x]*F[L],G[L]=Z[x]*F[B]-Z[B]*F[x];for(var s=0;3>s;s++)S[3*(W+s)+x]=G[x],S[3*(W+s)+B]=G[B],S[3*(W+s)+L]=G[L]}for(W=0;w>W;W+=3){var z=[];z[x]=S[W+x],z[B]=S[W+B],z[L]=S[W+L];var Q=D(z[x]*z[x]+z[B]*z[B]+z[L]*z[L]);0===Q&&(Q=dd),z[x]=z[x]/Q,z[B]=z[B]/Q,z[L]=z[L]/Q,S[W+x]=z[x],S[W+B]=z[B],S[W+L]=z[L]}return new On(S)},Xb=function(D,N,O,S){if(O||(O=D.createTexture()),N){var F=D.TEXTURE_2D,a=D.REPEAT,H=D.CLAMP_TO_EDGE,I=D.TEXTURE_MIN_FILTER;S=S||pk;var t=S.minFilter||S.filter||D.LINEAR,j=S.magFilter||S.filter||D.LINEAR;Th(D,O),D.texImage2D(F,0,D.RGBA,D.RGBA,D.UNSIGNED_BYTE,N),Om(D,D.TEXTURE_MAG_FILTER,j);var f=N.naturalWidth||N.width,m=N.naturalHeight||N.height;Lh.isPOT(f)&&Lh.isPOT(m)&&!N.clampToEdge?(Om(D,D.TEXTURE_WRAP_S,a),Om(D,D.TEXTURE_WRAP_T,a),Om(D,I,t===D.NEAREST?D.NEAREST_MIPMAP_NEAREST:D.LINEAR_MIPMAP_LINEAR),S.mipmapMaxLevel!==e&&Om(D,D.TEXTURE_MAX_LEVEL,S.mipmapMaxLevel),D.generateMipmap(F)):(Om(D,D.TEXTURE_WRAP_S,H),Om(D,D.TEXTURE_WRAP_T,H),Om(D,I,t)),Th(D,A)}return O},lj=function(N,q){var l=new Uint8Array(4);return q=q||N.createTexture(),Th(N,q),Om(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,l),q},Rp=function(V){V._26I&&V._prg&&(V._26I.deleteProgram(V._prg),V._prg=A)},fp=function(O,G,P,k){var F=O.createShader(P);return O.shaderSource(F,k),O.compileShader(F),O.attachShader(G,F),F},Fo=function(I){return I.createBuffer()},Th=function(B,e){B.bindTexture(B.TEXTURE_2D,e)},Om=function(Z,i,O){Z.texParameteri(Z.TEXTURE_2D,i,O)},hl=function(W,$){W.enable(W.POLYGON_OFFSET_FILL),W.polygonOffset($[0],$[1])},dm=function(O){O.disable(O.POLYGON_OFFSET_FILL)},Bp=function(V,R){if(R){var R=Lc(R);V.clearColor(R[0],R[1],R[2],R[3])}},ee=function(S,z){_m(S,z.uFix,!0),ar(S,z.aNormal)},pe=function(j,B){_m(j,B.uFix,!1),Kh(j,B.aNormal)},Zn=function(z,Q,q,l,H,e,N,h){z._picking||(q?(_m(z,Q.uBlend,!0),_m(z,Q.uBlendColor,q)):_m(z,Q.uBlend,!1),_m(z,Q.uLight,l==A?!0:l),vp(H)&&1!==H&&_m(z,Q.uPartOpacity,H),_m(z,Q.uReverseFlip,e==A?!1:e),_m(z,Q.uFixPickReverseColor,N||Mk)),h?z.enable(z.CULL_FACE):z.disable(z.CULL_FACE)},Ti=function(N,b){N._picking||_m(N,b.uPartOpacity,1)},$k=function(){var l=[0,0,1,1];return function(w,T,d,t,I,H,P,o,y){return d?(_m(w,T.uTexture,!0),_m(w,T.uDiscardSelectable,ql(t)?t:!0),Kh(w,T.aUv),kl(w,I,H,T.aUv,2),y?(_m(w,T.uBlendTexture,!0),w.activeTexture(w.TEXTURE1),Th(w,y),w.uniform1i(T.uBlendSampler,1)):(_m(w,T.uBlendTexture,!1),w.activeTexture(w.TEXTURE1),Th(w,w._emptyBlendTexture)),w.activeTexture(w.TEXTURE0),Th(w,d),w.uniform1i(T.uSampler,0),P?(l[0]=P[0],l[1]=P[1]):(l[0]=0,l[1]=0),o?(l[2]=o[0],l[3]=o[1]):(l[2]=1,l[3]=1),_m(w,T.uOffsetScale,l),void 0):(w.activeTexture(w.TEXTURE0),Th(w,w._emptyTexture),w.activeTexture(w.TEXTURE1),Th(w,w._emptyBlendTexture),void 0)}}(),Kb=function(Y,R,o){Y.activeTexture(Y.TEXTURE0),Th(Y,A),Y.activeTexture(Y.TEXTURE1),Th(Y,A),o&&(ar(Y,R.aUv),_m(Y,R.uTexture,!1),_m(Y,R.uBlendTexture,!1))},bp=function(n,w,K,B,m,$){!K||Yi||Tm||n.lineWidth(K),B&&!n._picking&&_m(n,w.uFixPickReverseColor,B),m&&kl(n,m,$,w.aPosition)},Ui=function(c,q,k,l){zo&&(l=c[zo]),c.drawArrays(l==A?c.TRIANGLES:l,q,k);var p=c._renderInfo;p&&(p.calls++,p.vertices+=k,(l==A||l===c.TRIANGLES)&&(p.faces+=k/3),l===c.LINES&&(p.lines+=k/2))},fh=function(W,n,l,u){zo&&(u=W[zo]),W.drawElements(u==A?W.TRIANGLES:u,l,W.UNSIGNED_SHORT,n==A?0:2*n);var j=W._renderInfo;j&&(j.calls++,j.vertices+=l,(u==A||u===W.TRIANGLES)&&(j.faces+=l/3),u===W.LINES&&(j.lines+=l/2))},Xe=function(C,g,r,D,Q){var R=C.ARRAY_BUFFER;C.bindBuffer(R,g),r&&C.bufferData(R,r,C.STATIC_DRAW),D!=A&&C.vertexAttribPointer(D,Q?Q:3,C.FLOAT,!1,0,0)},kl=function(g,O,o,h,s){return o?(ek(g,g.ARRAY_BUFFER,O,o),h!=A&&g.vertexAttribPointer(h,s?s:3,g.FLOAT,!1,0,0),void 0):Xe(g,O,o,h,s)},Rd=function(Q,M,v){var X=Q.ELEMENT_ARRAY_BUFFER;Q.bindBuffer(X,M),v&&Q.bufferData(X,v,Q.STATIC_DRAW)},oe=function(x,Y,f){ek(x,x.ELEMENT_ARRAY_BUFFER,Y,f)},ek=function(X,n,b,D){var i=D._bufId;i||(i=D._bufId=P.Math.generateIncreasingID());var b,F=X._bufPool;(b=F[i])&&b._buf?X.bindBuffer(n,b._buf):(b=F[i]={_buf:Fo(X)},X.bindBuffer(n,b._buf),X.bufferData(n,D,X.STATIC_DRAW)),b._fid=X._renderInfo.frame},_m=function(p,H,a){if(a!=A&&H!=A){a=Lc(a);var K=a.length;3===K?p.uniform3fv(H,a):4===K?p.uniform4fv(H,a):16===K?p.uniformMatrix4fv(H,!1,a):ql(a)?p.uniform1i(H,a?1:0):2===K?p.uniform2fv(H,a):p.uniform1f(H,a)}},Kh=function(Q,N){N!=A&&N>=0&&Q.enableVertexAttribArray(N)},ar=function(S,p){p!=A&&p>=0&&S.disableVertexAttribArray(p)},gs=function(I,q){var W=I.getGL(),Y=I._prg;I._7O=I._8O.pop(),q&&(_m(W,Y.uMVMatrix,I._7O),I._6O=q,_m(W,Y.uNMatrix,q))},Mc=function(X,W){return W||(W=om()),hs(W,X),nr(W),Hq(W),W},Ae=function(n,N){var X=n.getGL(),P=n._prg,M=n._7O;N?(n._8O.push(Md(M)),_m(X,P.uMMatrix,N),Vg(M,M,N),n._7O=M):_m(X,P.uMMatrix,ts),_m(X,P.uMVMatrix,M),_m(X,P.uNMatrix,Mc(M,n._6O))},lf=function(y,N,C,i,o,A){if(C){if(i){var D=C.value++,W=2147483648|D,J=[(255&W>>16)/255,(255&W>>8)/255,(255&W)/255,(255&W>>24)/255];C[D]={data:o,part:A}}else J=uh;return _m(y,N.uFixPickReverseColor,J),J}},as=function(v,X,B){"target"!==B&&(B="source");var I="target"===B?X.getTargetAgent():X.getSourceAgent(),F="edge."+B+".";if($o(I)){var m=X.s(F+"anchor.x"),Y=X.s(F+"anchor.elevation"),u=X.s(F+"anchor.y"),i=ro(I,v.getMat(I)),W=I.getAnchor3d();return rm([(m===e?.5:m)-W.x,(Y===e?.5:Y)-W.y,(u===e?.5:u)-W.z],i)}var P=X.s(F+"index"),O=v.getData3dUI(I);if(!O.info||!O.info.list)return!1;if(P>=0){var J,z,k,h,U,p=O.info._lastPointsSegments,$=p.points,Z=p.segments,w=-1,V=-1;for(k=0,h=Z?Z.length:$.length;h>k;k++){if(z=Z?Z.get(k):1,3===z)U=2;else if(4===z)U=3;else{if(5===z)continue;U=1}if(w+=U,V++,V===P){J=$.get(w);break}}return J||(J=$.get($.length-1)),[J.x,J.e||0,J.y]}var j=X.s(F+"percent")||.5;if(j=Math.max(0,Math.min(j,1)),!O||!O.getCache)return!1;var x=O.getCache(),h=x[x.length-1].length,p=v.getLineOffset(I,j*h),C=p.point;return[C.x,C.y,C.z]},mi=function(){var i={center:function(n,m,T,k,S){var x=-m[1]/2,i={x:-m[0]/2,y:x,width:m[0],height:m[1]},f=Ne(n,i,T);return[f.x+k,-f.y-S,xd()]},front:function(S,B,F,t,r){var C=-B[1]/2,Q={x:-B[0]/2,y:C,width:B[0],height:B[1]},P=Ne(S,Q,F);return[P.x+t,-P.y-r,B[2]/2+xd()]},back:function(R,y,K,s,a){var i=-y[0]/2,O=-y[1]/2,P={x:i,y:O,width:y[0],height:y[1]},W=Ne(R,P,K);return[-W.x-s,-W.y-a,-y[2]/2-xd()]},left:function(k,i,p,I,R){var X=-i[1]/2,$={x:-i[2]/2,y:X,width:i[2],height:i[1]},P=Ne(k,$,p);return[-i[0]/2-xd(),-P.y-R,P.x+I]},right:function(_,X,u,h,J){var s=-X[2]/2,W=-X[1]/2,B={x:s,y:W,width:X[2],height:X[1]},$=Ne(_,B,u);return[X[0]/2+xd(),-$.y-J,-$.x-h]},top:function(c,l,P,L,O){var f={x:-l[0]/2,y:-l[2]/2,width:l[0],height:l[2]},y=Ne(c,f,P);return[y.x+L,l[1]/2+xd(),y.y+O]},bottom:function(c,x,M,H,R){var u=-x[2]/2,w={x:-x[0]/2,y:u,width:x[0],height:x[2]},Z=Ne(c,w,M);return[Z.x+H,-x[1]/2-xd(),-Z.y-R]}};return function(u,F,o,K,s,D){return i[K](u,F,o,s||0,D||0)}}(),pb=function(c,u,y,K,$,N,R,p,U,C){if($&&(u[0]+=$[0],u[1]+=$[1],u[2]+=$[2]),ac(c,y),p){var E=om();if(No(E,U,C),rm(u,E),ac(c,u),c.auto=p,c.pos=rm([0,0,0],c),N){var t=c.mat2=om();No(t,N,R)}}else No(c,U,C),ac(c,u),K===Rc?Gr(c,-Z):K===Pc?Gr(c,Z):K===Oe?ed(c,-Z):K===fl?ed(c,Z):K===gl&&Gr(c,O),No(c,N,R);return c},Yq=function($,E){var U=E.auto,_=E.mat2,K=$.gv;if(U){var O,C=om(),q=[0,0,0,0];O="string"==typeof U?[U.indexOf("x")<0?K._eye[0]:K._center[0],U.indexOf("y")<0?K._eye[1]:K._center[1],U.indexOf("z")<0?K._eye[2]:K._center[2]]:K._eye,Xn(q,Cm(om(),O,K._center,K._up)),ab(C,Mr(q,q),E.pos),_&&Vg(C,C,_),Ae(K,C)}else Ae(K,E)},xb=function(z,q,i,E,j){var $=z.s,H=z.gv,a=H.getGL(),k=H._prg,h=H._buffer,v=H._1O;Xb(a,Vr,v),Yq(z,i),Zn(a,k,$(q+".blend"),$(q+".light"),$(q+".opacity"),$(q+".reverse.flip"),$(q+".reverse.color"),$(q+".reverse.cull")),$k(a,k,v,j,h.uv,Rm),kl(a,h.vs,E,k.aPosition),kl(a,h.ns,Dk,k.aNormal),oe(a,h.is,Bq),fh(a,0,Bq.length),Kb(a,k,v),Ti(a,k),gs(H)},xc=function(k,Q,r){var L=k.gv,V=k.data,e=k[Q]={blend:L.getBodyColor(V)||L.getFaceBlend(V,Q),light:L.getFaceLight(V,Q),color:L.getFaceColor(V,Q),opacity:L.getFaceOpacity(V,Q),transparent:L.getFaceTransparent(V,Q),reverseFlip:L.getFaceReverseFlip(V,Q),reverseColor:L.getFaceReverseColor(V,Q),reverseCull:L.getFaceReverseCull(V,Q),texture:L.getFaceImage(V,Q),blendTexture:L.getFaceBlendImage(V,Q),discardSelectable:L.getFaceDiscardSelectable(V,Q)};if("csg"!==Q){e.uv=L.getFaceUv(V,Q)||r&&r[Q+"Uv"],e.uvScale=L.getFaceUvScale(V,Q)||r&&r[Q+"UvScale"],e.uvOffset=L.getFaceUvOffset(V,Q)||r&&r[Q+"UvOffset"];var b=L.getFaceMat(V,Q);if(b){var j=ro(V,b);V.appendAnchorMatrix3d(j),e.mat=j}}return e},rr=function(C,R,u,j,M){var E=C[j];if(E){if(!M(E.transparent))return;var x=C.data,A=C.gv,v=A._buffer,q=A.getTexture(E.texture,x,j),V=A.getTexture(E.blendTexture,x);$k(R,u,q,E.discardSelectable,v.uv,E.tuv,E.uvOffset,E.uvScale,V),Zn(R,u,E.blend,E.light,E.opacity,E.reverseFlip,E.reverseColor,E.reverseCull),E.cs&&!A._batchColorDisabled?(_m(R,u.uBatchColor,!0),Kh(R,u.aBatchColor),kl(R,v.batchColor,E.cs,u.aBatchColor,4)):_m(R,u.uDiffuse,E.color||n["color.empty"]),kl(R,v.vs,E.vs,u.aPosition),kl(R,v.ns,E.ns,u.aNormal),Ui(R,0,E.vs.length/3),E.cs&&!A._batchColorDisabled&&(_m(R,u.uBatchColor,!1),ar(R,u.aBatchColor)),Ti(R,u),Kb(R,u,q)}},Jj=function(t,p,n,b,g,d){var K,k,c,w,S,o,U,Q,R,i,C,G=[b-p,g-n],m=t?t.length:0;for(c=0;m>c;c++){for(w=2,K=t[c],S=K[0],o=K[1];w+1<K.length;){if(U=K[w],Q=K[w+1],k=Fc(p,n,b,g,S,o,U,Q,!0)){R=[U-S,Q-o],i=np(R),R[0]/=i,R[1]/=i,i=Hi(G,R),i=i>0?d:-d,C=[R[0]*i,R[1]*i];break}S=U,o=Q,w+=2}if(C)break}if(C)for(b=p+C[0],g=n+C[1],c=0;m>c;c++)for(w=2,K=t[c],S=K[0],o=K[1];w+1<K.length;){if(U=K[w],Q=K[w+1],k=Fc(p,n,b,g,S,o,U,Q,!0))return[0,0];S=U,o=Q,w+=2}return C?C:[b-p,g-n]},Kk=P.graph3d={},Lm=function(n,G,L){$g(h+".graph3d."+n,G,L)},aq="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",tl="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Ec(b,{setBatchInfo:function(e,W){fs[e]=W},getBatchInfo:function(z){return fs[z]},getBatchInfoMap:function(){return fs},setBatchInfoMap:function(y){fs=y}},!0);var tn=[1,1,1],Im=[1,0,0,0,0,1,0,1,1,1,1,0],Pd=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Gd=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Nh=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],ss=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],ys=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Ce=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Zc=function(W,Y){_b(W,Y,"_batchModelMap","_batchIndexMap"),xg(W,Y,"_wireframeModelMap","_wireframeIndexMap"),xg(W,Y,"_polylineModelMap","_polylineIndexMap"),xg(W,Y,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),xg(W,Y,"_polylineModelMapSwap","_polylineIndexMapSwap")},_b=function(d,c,B,O){if(!c)return d[B]={},d[O]={},void 0;var K=c._id,S=d[O],M=S[K];if(M){var $=d[B],r=M.batch,C=$[r],v=C.ds,T=M.index;if(C.invalidate=!0,delete S[K],v.splice(T,1),ye(v))return delete $[r],void 0;for(var j=M.begin,G=M.size,l=3*j,F=3*G,q=4*j,U=4*G,N=C.vs,E=C.ps,Q=C.uv,e=C.cs,w=C.bs,o=C.rs,k=C.ns,a=C.ls;T<v.length;T++)M=S[v[T]._id],M.index--,M.begin-=G;N.splice(l,F),E.splice(q,U),Q&&Q.splice(2*j,2*G),e&&e.splice(q,U),w&&w.splice(l,F),o&&o.splice(j,G),k&&k.splice(l,F),a&&a.splice(j,G)}},xg=_b,Kd=function(F,N,l,e){if(!e)return A;var x=N[e];if(!x){var b=fs[e]||pk,U=b.image?[]:A;x=N[e]={vs:[],ns:[],uv:U,cs:U?A:b.color?A:[],bs:b.blend?[]:A,ps:[],rs:b.brightness?[]:A,ds:[]}}return x.invalidate=!0,F[l._id]={index:x.ds.length,begin:x.vs.length/3,batch:e},x.ds.push(l),x},mc=function(t,I){return I!=A&&1!==I?[t[0]*I,t[1]*I,t[2]*I,t[3]]:t},um=function(){var A;return function(M,K,x){var S=M.getData3dUI(K),g=S.shapeModel;if(g||(g=Ri(S)),g||!S.shapeName){var h,D=K.s("wf.combineTriangle");if(x.geometry){if(!g&&(K instanceof P.Node&&!(K instanceof P.Shape)?(A||(A={vs:dl,is:Wd,uv:_i}),g=A):g=[S.left,S.front,S.right,S.back,S.top,S.bottom],!g))return e;if(D?(D=0|Math.min(3,Math.max(1,isNaN(D)?1:D)),h=Pp[D-1](g)):h=Wj(g),!h||0===h.length)return}else h=x.short?vc:so;var T=M.getBrightness(K),k=Lc(x.color||"white"),i=k[3]<1,C=Math.ceil(x.width)||1,L=(i?"T":"O")+C,n=M._wireframeIndexMap,t=M._wireframeModelMap,F=t[L];F||(F=t[L]={vs:[],cs:[],ps:[],ds:[],T:i,W:C}),F.invalidate=!0;var c=F.vs,R=F.cs,H=F.ds,m=n[K._id]={index:H.length,begin:c.length/3,batch:L};H.push(K);var J=S.mat;K instanceof P.Edge||!(!J||!x.geometry&&K instanceof P.Shape)||(J=ro(K,x.mat),K.appendAnchorMatrix3d(J)),Jg(c,J,h);var Z=m.size=c.length/3-m.begin;Yr(R,mc(k,T),Z)}}}(),bc=function(c,Z,E,O,x,_,N,T,Q){var D=c.getBrightness(Z);D==A&&(D=1);var H=mc(Lc(O),D),w=H[3]<1;_=Math.ceil(_)||1;var y=(w?"T":"O")+_;if(N){var h=N[0],V=(N[1]||h)+h;y+="-"+h+"-"+V,Q&&(y+="-"+qo(Q)+"-"+D,Q=mc(Lc(Q),D))}var k=c._polylineIndexMap,C=c._polylineModelMap,$=C[y];$||($=C[y]={vs:[],cs:[],ps:[],ds:[],ls:N?[]:A,T:w,W:_},N&&($.D=h,$.G=V,$.A=Q)),$.invalidate=!0;var G,F=$.vs,L=$.cs,m=$.ds,u=$.ls,P=k[Z._id]={index:m.length,begin:F.length/3,batch:y};m.push(Z),oj(F,E);var t,W=P.size=F.length/3-P.begin,U=E.length,e=0,n=[];if(N||x)for(G=0;U>G;G+=6)t=np([E[G],E[G+1],E[G+2]],[E[G+3],E[G+4],E[G+5]]),n.push(t),e+=t;if(e&&x){var z,o=mc(Lc(x),D),p=[o[0]-H[0],o[1]-H[1],o[2]-H[2],o[3]-H[3]],b=0;for(G=0;U>G;G+=6)z=b/e,Yr(L,[H[0]+p[0]*z,H[1]+p[1]*z,H[2]+p[2]*z,H[3]+p[3]*z],1),b+=n[G/6],z=b/e,Yr(L,[H[0]+p[0]*z,H[1]+p[1]*z,H[2]+p[2]*z,H[3]+p[3]*z],1)}else Yr(L,H,W);if(N)for(b=T||0,G=0;U>G;G+=6)u.push(b),b+=n[G/6],u.push(b)},ri=function(k,O,z){if(O)for(var x=4*O.begin,t=z[O.batch].ps,X=0;X<O.size;X++)t[x++]=k[0],t[x++]=k[1],t[x++]=k[2],t[x++]=k[3]},wl=function(z,D){var R=D+["32"],X=z[D],h=z[R];X?h&&h.length===X.length?(h.set(X),h._bufId=null):z[R]=new On(X):delete z[R]},kr=function(t,u,S,f,j,v,G,o,x){if(Fl(S))S.forEach(function(w){kr(t,u,w,f,j,v,G,o,x)});else if(nf(S))kr(t,u,Ri(f,S),f,j,v,G,o,x);else if(Tp(S)){var D,p=_d(S.mat,u,t),U=_d(S.s3,u,t),i=_d(S.t3,u,t),W=_d(S.r3,u,t);if((U||W||i||p)&&(D=mq(p,U,W,_d(S.rotationMode,u,t),i),v.push(D)),S.shape3d)kr(t,u,S.shape3d,f,j,v,G,o,S);else{var X=f.s;x=x||pk;var y=v[0],s=v.length,B=X("shape3d.color",S.color,x.color);if(j||(j=X("shape3d.blend",S.blend,x.blend)),s>1){y=Md(y);for(var $=1;s>$;$++)Vg(y,y,v[$])}S.vs&&X(zc,S.visible,x.visible)&&rn(y,G,o,S.vs,S.uv,S.is,j,B),S.top_vs&&X(Yl,S.topVisible,x.topVisible)&&rn(y,G,o,S.top_vs,S.top_uv,S.top_is,j,X("shape3d.top.color",S.topColor,x.topColor)||B),S.bottom_vs&&X(En,S.bottomVisible,x.bottomVisible)&&rn(y,G,o,S.bottom_vs,S.bottom_uv,S.bottom_is,j,X("shape3d.bottom.color",S.bottomColor,x.bottomColor)||B),S.from_vs&&X(Em,S.fromVisible,x.fromVisible)&&rn(y,G,o,S.from_vs,S.from_uv,S.from_is,j,X("shape3d.from.color",S.fromColor,x.fromColor)||B),S.to_vs&&X(Vb,S.toVisible,x.toVisible)&&rn(y,G,o,S.to_vs,S.to_uv,S.to_is,j,X("shape3d.to.color",S.toColor,x.toColor)||B)}D&&v.pop()}},rn=function(G,$,h,l,t,d,M,C){var z,H=$.cs,q=$.uv,p=$.bs;if(d){z=d.length;for(var e=0;z>e;e++){var o=d[e];Jg(h,G,[l[3*o],l[3*o+1],l[3*o+2]]),q&&oj(q,[t[2*o],t[2*o+1]])}}else z=l.length/3,Jg(h,G,l),q&&oj(q,t);H&&Yr(H,C,z),p&&(M?So(p,M,z):oj(p,tn,z))},Bn=function(z,a,M,d){var q=[];d?kr(z.gv,z.data,d,z,z.getBodyColor(),[a],M,q):(gf(z,Rc,a,M,q),gf(z,Pc,a,M,q),gf(z,Kg,a,M,q),gf(z,gl,a,M,q),gf(z,Oe,a,M,q),gf(z,fl,a,M,q),gf(z,"csg",a,M,q)),q.length&&(oj(M.vs,q),oj(M.ns,Dn(q)))},gf=function(i,k,G,z,S){var r=i[k];if(r){var m=r.tuv;if(m){var v,I,J,c,l=r.uvScale,x=r.uvOffset;if(l)for(v=m.length,I=l[0],J=l[1],c=0;v>c;c+=2)m[c]*=I,m[c+1]*=J;if(x)for(v=m.length,I=x[0],J=x[1],c=0;v>c;c+=2)m[c]+=I,m[c+1]+=J}rn(G,z,S,r.vs,m,A,r.blend,r.color)}},Gj=function(p,a,k,h,x,J,s,T){var Q,Y=k.cs,G=k.uv,X=k.bs;if(p.getFaceVisible(a,J)){var r=p.getFaceMat(a,J);if(r&&(x=ro(a,r)),Jg(s,x,T),Y&&Yr(Y,p.getFaceColor(a,J),6),G){var l=p.getFaceUv(a,J)||h[J+"Uv"],o=p.getFaceUvScale(a,J)||h[J+"UvScale"],m=p.getFaceUvOffset(a,J)||h[J+"UvOffset"];
l=l?[l[6],l[7],l[0],l[1],l[2],l[3],l[2],l[3],l[4],l[5],l[6],l[7]]:Im;var i=l[0],A=l[1],z=l[2],H=l[3],P=l[4],B=l[5],d=l[6],t=l[7],b=l[8],D=l[9],u=l[10],C=l[11];if(o){var f=o[0],F=o[1];i*=f,A*=F,z*=f,H*=F,P*=f,B*=F,d*=f,t*=F,b*=f,D*=F,u*=f,C*=F}if(m){var j=m[0],g=m[1];i+=j,A+=g,z+=j,H+=g,P+=j,B+=g,d+=j,t+=g,b+=j,D+=g,u+=j,C+=g}G.push(i,A,z,H,P,B,d,t,b,D,u,C)}X&&(Q=p.getBodyColor(a)||p.getFaceBlend(a,J),Q?So(X,Q,6):oj(X,tn,6))}},wd=function(b,a,p,B){var O=b.getGL(),U=b._prg,L=b._buffer;if(!b.drawFilter&&!Ah(a)){Ae(b),ee(O,U);for(var $ in a){var E=a[$];if(!(B&&!E.T||!B&&E.T)){E.invalidate?(E.invalidate=!1,wl(E,"vs"),wl(E,"cs"),wl(E,"ls"),wl(E,"ps")):p&&wl(E,"ps");var X=E.vs32,K=p?E.ps32:E.cs32;bp(O,U,E.W,A,L.vs,X);var N=E.D,H=!b._dashDisabled&&N;_m(O,U.uAlphaTest,n.alphaTest),H&&(_m(O,U.uDash,!0),_m(O,U.uDashDistance,N),_m(O,U.uDashGapDistance,E.G),Kh(O,U.aLineDistance),kl(O,L.lineDistance,E.ls32,U.aLineDistance,1),_m(O,U.uDiffuse,E.A||n["color.empty"]));var i=!b._batchColorDisabled;i&&(_m(O,U.uBatchColor,!0),Kh(O,U.aBatchColor),kl(O,L.batchColor,K,U.aBatchColor,4)),$k(O),Ui(O,0,X.length/3,O.LINES),Kb(O),i&&(_m(O,U.uBatchColor,!1),ar(O,U.aBatchColor)),H&&(_m(O,U.uDash,!1),ar(O,U.aLineDistance))}}pe(O,U)}},$i=function(t,s,N){var C,r,M,S,G,v,V,d,U,u,T,L=t.getGL(),F=t._prg,q=t._buffer,k=t._batchModelMap;if(!Ah(k)&&!t.drawFilter){Ae(t);for(C in k)if(r=fs[C]||pk,!(N&&!r.transparent||!N&&r.transparent)&&(M=k[C],s||!r.transparentMask)){var O=N&&r.autoSort!==!1&&(t._33Q||M.invalidate);if(M.invalidate?(M.invalidate=!1,wl(M,"vs"),wl(M,"ns"),wl(M,"cs"),wl(M,"rs"),wl(M,"ps"),wl(M,"bs"),wl(M,"uv")):s&&wl(M,"ps"),G=M.vs32,v=s?M.ps32:M.cs32,U=M.uv32,V=M.bs32,d=M.rs32,T=G.length/3,O&&(M.is=ic(G,t.getEye())),T){S=r.light,u=t.getTexture(r.image),Zn(L,F,A,r.light,r.opacity,r.reverseFlip,r.reverseColor,r.reverseCull),v?t._batchColorDisabled||(_m(L,F.uBatchColor,!0),Kh(L,F.aBatchColor),kl(L,q.batchColor,v,F.aBatchColor,4)):_m(L,F.uDiffuse,r.color||n["color.empty"]);var J=r.alphaTest;_m(L,F.uAlphaTest,J===e?n.alphaTest:J),r.envmap!==e?(_m(L,F.uUseEnvMap,!0),_m(L,F.uReflectivity,r.envmap)):(_m(L,F.uUseEnvMap,!1),_m(L,F.uReflectivity,0));var h=V&&!t._batchBlendDisabled;h&&(_m(L,F.uBatchBlend,!0),Kh(L,F.aBatchBlend),kl(L,q.batchBlend,V,F.aBatchBlend));var g=d&&!t._batchBrightnessDisabled;g&&(_m(L,F.uBatchBrightness,!0),Kh(L,F.aBatchBrightness),kl(L,q.batchBrightness,d,F.aBatchBrightness,1)),U?$k(L,F,u,r.discardSelectable,q.uv,U,r.uvOffset,r.uvScale):$k(L),kl(L,q.vs,G,F.aPosition),kl(L,q.ns,M.ns32,F.aNormal),M.is?(Rd(L,q.is,M.is),fh(L,0,T)):Ui(L,0,T),U?Kb(L,F,u):Kb(L),v&&!t._batchColorDisabled&&(_m(L,F.uBatchColor,!1),ar(L,F.aBatchColor)),h&&(_m(L,F.uBatchBlend,!1),ar(L,F.aBatchBlend)),g&&(_m(L,F.uBatchBrightness,!1),ar(L,F.aBatchBrightness)),Ti(L,F)}}}},ic=function(C,j){for(var y=C.length/3,$=new Array(y),J=y/3,w=new Array(J),u=0;J>u;u++)w[u]=u;w.sort(function(t,y){var A=9*t,h=[(C[A]+C[A+3]+2*C[A+6])/4,(C[A+1]+C[A+4]+2*C[A+7])/4,(C[A+2]+C[A+5]+2*C[A+8])/4];A=9*y;var v=[(C[A]+C[A+3]+2*C[A+6])/4,(C[A+1]+C[A+4]+2*C[A+7])/4,(C[A+2]+C[A+5]+2*C[A+8])/4],P=np(j,h)-np(j,v);return P>0?-1:0>P?1:0});for(var u=0;J>u;u++){var m=3*u,K=3*w[u];$[m]=K,$[m+1]=K+1,$[m+2]=K+2}return new Bk($)},wn={obj:function(U,J){var M={mat:U.mat,s3:U.s3,r3:U.r3,rotationMode:U.rotationMode,t3:U.t3,cube:U.cube==A?!0:U.cube,center:U.center==A?!0:U.center,ignoreMtls:U.ignoreMtls,ignoreTransparent:U.ignoreTransparent,ignoreColor:U.ignoreColor,ignoreImage:U.ignoreImage,ignoreNormal:U.ignoreNormal,prefix:U.prefix,flipY:U.flipY,flipFace:U.flipFace,reverseFlipMtls:U.reverseFlipMtls,finishFunc:function(X,w){if(X){var w=[];for(var t in X){var L=X[t];w.rawS3=L.rawS3,L.center&&(w.center=L.center),w.push(L),U.eachModel&&U.eachModel(t,L)}w.json=U,J(w)}else J()}};b.loadObj(U.obj,U.mtl,M)}};b.getModelTypeHandlers=function(){return wn},b.setModelTypeHandler=function(F,t){wn[F]=t},b.getModelTypeHandler=function(c){return wn[c]},b.handleModelLoaded=function(){},b.handleUnfoundModel=function(){};var vo=A,Kp=A,ih=function(d){vo&&!d._loadingModelView_&&(Kp||(Kp={}),Kp[d._loadingModelView_=lo()]=d)},ij=function(P,G){vo||(vo={});var y=vo[P];if(y){if(y.url===G)return;y.request.onload=ym,y.request.onerror=ym}var W=new en;if(vo[P]={request:W,url:G},G=b.beforeLoadURL(G),G.data){var h=b.parse(G.data);Rg(P,h,G)}else{W.onload=function(){if(200===this.status||0===this.status){delete vo[P];var $=b.parse(W.getResponseText());Rg(P,$,G)}else Kj(P,b.handleUnfoundModel(P,G)||A)},W.onerror=function(){Kj(P,b.handleUnfoundModel(P,G)||A)};var t={};t.url=encodeURI(G),t.sync=!1,W.send(t)}},Rg=function(a,M,e){var n=M.modelType;if(!n)return Kj(a,M),b.handleModelLoaded(a,M),void 0;var l=b.getModelTypeHandler(n);if(l){if(vo||(vo={}),vo[a])return;vo[a]=!0;var H=function(i){i?(Kj(a,i),b.handleModelLoaded(a,i)):Kj(a,b.handleUnfoundModel(a,e,M)||A)};l(M,H)}else Kj(a,b.handleUnfoundModel(a,e,M)||A)},Kj=function(Z,o){if(delete vo[Z],nf(o)&&Po.test(o))return ij(Z,o),void 0;if(Id[Z]=o,Ah(vo)&&(vo=A,Kp)){for(var I in Kp){var v=Kp[I];v.invalidateAll&&v.invalidateAll(e,"modelLoaded",Z),v.redraw&&v.redraw(),v.iv(),delete v._loadingModelView_}Kp=A}if(o&&Kp)for(var I in Kp){var v=Kp[I];v.invalidateAll&&v.invalidateAll(e,"modelLoading",Z),v.redraw&&v.redraw(),v.iv()}},Rm=new On([0,0,0,1,1,1,1,0]),Dk=new On([0,0,1,0,0,1,0,0,1,0,0,1]),Bq=new Bk([0,1,2,2,3,0]),dl=new On([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Wd=new Bk([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),_i=new On([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Uk=Dn(dl,Wd),Gf=(new On([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Bk([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Rc,Kg,Pc,gl,Oe,fl]),so=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],vc=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Ug=function(H,T,k,S,t,n,G){n=n||16,H=H||16,T=T||0,k=k||H;var _,q,v,N,M,m,z,s,W,K=.5,A=[],o=[],h=U/H,J=O/n;for(_=0;n>_;_++)for(m=_+1,N=_*J,W=m*J,q=T;k>q;q++)z=q+1,v=q*h,s=z*h,A.push(K*j(N)*E(v),K*E(N),-K*j(N)*j(v),K*j(W)*E(s),K*E(W),-K*j(W)*j(s),K*j(N)*E(s),K*E(N),-K*j(N)*j(s),K*j(N)*E(v),K*E(N),-K*j(N)*j(v),K*j(W)*E(v),K*E(W),-K*j(W)*j(v),K*j(W)*E(s),K*E(W),-K*j(W)*j(s)),o.push(q/H,_/n,z/H,m/n,z/H,_/n,q/H,_/n,q/H,m/n,z/H,m/n);if(G){var y=[];for(_=0,M=A.length;M>_;_+=3)y.push(2*A[_],2*A[_+1],2*A[_+2])}if(S){var a=[],w=[];for(v=T*h,_=0;n>_;_++)m=_+1,N=_*J,W=m*J,a.push(0,0,0,K*j(W)*E(v),K*E(W),-K*j(W)*j(v),K*j(N)*E(v),K*E(N),-K*j(N)*j(v)),w.push(0,.5,T/H,m/n,T/H,_/n)}if(t){var d=[],D=[];for(v=k*h,_=0;n>_;_++)m=_+1,N=_*J,W=m*J,d.push(0,0,0,K*j(N)*E(v),K*E(N),-K*j(N)*j(v),K*j(W)*E(v),K*E(W),-K*j(W)*j(v)),D.push(1,.5,k/H,_/n,k/H,m/n)}var b={vs:A,uv:o,from_vs:a,from_uv:w,to_vs:d,to_uv:D};return G&&(b.ns=y),b},kk=function(g,s,k){g=g||.17,s=s||12,k=k||18,0>g?g=0:g>.25&&(g=.25);var e,c,Y,L,t,q,N,R=.5,X=[],i=[],I=[],l=U/k,$=U/s,P=R-g;for(c=0;s>=c;c++)for(L=-O+c*$,q=E(L),t=j(L),e=0;k>=e;e++)Y=e*l,N=P+g*q,X.push(E(Y)*N,t*g,-j(Y)*N),i.push(e/k,1-c/s);for(c=0;s>c;c++){var S=c*(k+1),x=(c+1)*(k+1);for(e=0;k>e;e++)I.push(S+e,x+e+1,x+e,S+e,S+e+1,x+e+1)}return{vs:X,uv:i,is:I}},vl=function(a,Q,D,P,w,s,N,R){N=N||12,a=a||18,Q=Q||0,D=D||a,s=s||.17,0>s?s=0:s>.25&&(s=.25);var K,i,l,Y,q,V,T,h,H,r,g=.5,t=[],M=[],X=U/a,G=U/N,I=g-s,n=R?[]:e;for(l=0;N>l;l++)for(Y=l+1,T=-O+l*G,h=-O+Y*G,K=Q;D>K;K++)i=K+1,q=K*X,V=i*X,H=I+s*E(T),r=I+s*E(h),t.push(E(q)*H,j(T)*s,-j(q)*H,E(V)*H,j(T)*s,-j(V)*H,E(V)*r,j(h)*s,-j(V)*r,E(q)*H,j(T)*s,-j(q)*H,E(V)*r,j(h)*s,-j(V)*r,E(q)*r,j(h)*s,-j(q)*r),M.push(K/a,1-l/N,i/a,1-l/N,i/a,1-Y/N,K/a,1-l/N,i/a,1-Y/N,K/a,1-Y/N),R&&n.push(E(q)*E(T),j(T),-j(q)*E(T),E(V)*E(T),j(T),-j(V)*E(T),E(V)*E(h),j(h),-j(V)*E(h),E(q)*E(T),j(T),-j(q)*E(T),E(V)*E(h),j(h),-j(V)*E(h),E(q)*E(h),j(h),-j(q)*E(h));if(P){var u=[],v=[];for(l=0;N>l;l++)Y=l+1,T=-O+l*G,h=-O+Y*G,q=Q*X,H=I+s*E(T),r=I+s*E(h),u.push(E(q)*H,j(T)*s,-j(q)*H,E(q)*r,j(h)*s,-j(q)*r,E(q)*I,0,-j(q)*I),v.push(.5+.5*E(T),.5-.5*j(T),.5+.5*E(h),.5-.5*j(h),.5,.5)}if(w){var W=[],L=[];for(l=0;N>l;l++)Y=l+1,T=-O+l*G,h=-O+Y*G,q=D*X,H=I+s*E(T),r=I+s*E(h),W.push(E(q)*H,j(T)*s,-j(q)*H,E(q)*I,0,-j(q)*I,E(q)*r,j(h)*s,-j(q)*r),L.push(.5-.5*E(T),.5-.5*j(T),.5,.5,.5-.5*E(h),.5-.5*j(h))}var d={vs:t,uv:M,from_vs:u,from_uv:v,to_vs:W,to_uv:L};return R&&(d.ns=n),d},Hh=function(m,L){for(var A,f,Q,k=.5,P=16,y=[],v=[],F=[],W=U/P,V=0;P>=V;V++)A=V*W,f=E(A)*k,Q=j(A)*k,y.push(f,-k,Q,f,k,Q),v.push(1-V/P,1,1-V/P,0);for(V=0;P>V;V++)F.push(2*V,2*V+1,2*V+3,2*V,2*V+3,2*V+2);if(L){var B=[],Z=[],l=[];for(B.push(0,-k,0),Z.push(.5,.5),V=0;P>=V;V++)A=V*W,f=E(A),Q=j(A),B.push(f*k,-k,-Q*k),Z.push(.5+.5*f,.5+.5*Q);for(V=0;P>V;V++)l.push(0,V+2,V+1)}if(m){var p=[],M=[],H=[];for(p.push(0,k,0),M.push(.5,.5),V=0;P>=V;V++)A=V*W,f=E(A),Q=j(A),p.push(f*k,k,-Q*k),M.push(.5+.5*f,.5-.5*Q);for(V=0;P>V;V++)H.push(0,V+1,V+2)}return{vs:y,uv:v,is:F,bottom_vs:B,bottom_uv:Z,bottom_is:l,top_vs:p,top_uv:M,top_is:H}},Vo=function(M,I,c,T,Y,y,K,S){M=M||12,I=I||0,c=c||M;for(var V,d,_,Q,t,m,B,X,P,h=.5,D=[],w=[],J=U/M,b=I;c>b;b++)V=b+1,d=b*J,_=V*J,Q=E(d)*h,t=j(d)*h,m=E(_)*h,B=j(_)*h,D.push(Q,-h,-t,m,-h,-B,Q,h,-t,m,-h,-B,m,h,-B,Q,h,-t),w.push(b/M,1,V/M,1,b/M,0,V/M,1,V/M,0,b/M,0);if(S){var z=[];for(b=0,P=D.length;P>b;b+=3)z.push(2*D[b],0,2*D[b+2])}if(K){var O=[],k=[];for(b=I;c>b;b++)d=J*b,_=J*(b+1),Q=E(d),t=j(d),m=E(_),B=j(_),O.push(Q*h,-h,-t*h,0,-h,0,m*h,-h,-B*h),k.push(.5+.5*Q,.5+.5*t,.5,.5,.5+.5*m,.5+.5*B)}if(y){var e=[],p=[];for(b=I;c>b;b++)d=J*b,_=J*(b+1),Q=E(d),t=j(d),m=E(_),B=j(_),e.push(Q*h,h,-t*h,m*h,h,-B*h,0,h,0),p.push(.5+.5*Q,.5-.5*t,.5+.5*m,.5-.5*B,.5,.5)}if(T){var Z=[],u=[];d=J*I,Q=E(d)*h,t=j(d)*h,X=I/M,Z.push(0,h,0,0,-h,0,Q,-h,-t,Q,-h,-t,Q,h,-t,0,h,0),u.push(0,0,0,1,X,1,X,1,X,0,0,0)}if(Y){var s=[],G=[];d=J*c,Q=E(d)*h,t=j(d)*h,X=c/M,s.push(0,-h,0,0,h,0,Q,h,-t,Q,h,-t,Q,-h,-t,0,-h,0),G.push(1,1,1,0,X,0,X,0,X,1,1,1)}var x={vs:D,uv:w,bottom_vs:O,bottom_uv:k,top_vs:e,top_uv:p,from_vs:Z,from_uv:u,to_vs:s,to_uv:G};return S&&(x.ns=z),x},Xq=function(N,M,a,Z,u){M=M||18,a=a||0,Z=Z==A?U:Z,u=u==A?.5:u;for(var w,J,o,t,f,G,m=[0,.5,.75,.875,.9375],c=[],B=[],C=[],O=Z/M,$=0;$<m.length;$++){var P=0===$%2?0:.5;for(w=0;M>=w;w++)J=(w+P)*O+a,o=1-m[$],c.push(E(J)*u*o,-u+2*m[$]*u,-j(J)*u*o),B.push((w+P)/M,o)}for($=0;$<m.length-1;$++){var H=$*(M+1),F=($+1)*(M+1);for(w=0;M>w;w++)C.push(H+w,F+w+1,F+w,H+w,H+w+1,F+w+1)}for(G=c.length/3-(M+1),w=0;M>w;w++)c.push(0,u,0),B.push((w+.5)/M,0);for(w=0;M>w;w++)C.push(G+w,G+w+1,G+(M+1)+w);if(N){var v=[],p=[],d=[];for(v.push(0,-u,0),p.push(.5,.5),w=0;M>=w;w++)J=w*O+a,t=E(J),f=j(J),v.push(t*u,-u,-f*u),p.push(.5+.5*t,.5+.5*f);for(w=0;M>w;w++)d.push(0,w+2,w+1)}return{vs:c,uv:B,is:C,bottom_vs:v,bottom_uv:p,bottom_is:d}},xk=function(x,X,f,b,R,G){x=x||16,X=X||0,f=f||x;for(var S=.5,o=[],M=[],c=U/x,F=X;f>F;F++){var V=F+1,e=c*F,d=c*V;o.push(E(e)*S,-S,-j(e)*S,E(d)*S,-S,-j(d)*S,0,S,0),M.push(F/x,1,V/x,1,(F+V)/2/x,0)}if(G){var a=[],h=[];for(F=X;f>F;F++){e=c*F,d=c*(F+1);var J=E(e),m=j(e),H=E(d),k=j(d);a.push(J*S,-S,-m*S,0,-S,0,H*S,-S,-k*S),h.push(.5+.5*J,.5+.5*m,.5,.5,.5+.5*H,.5+.5*k)}}if(b){var $=[],l=[];e=c*X,$.push(0,S,0,0,-S,0,E(e)*S,-S,-j(e)*S),l.push(0,0,0,1,X/x,1)}if(R){var s=[],B=[];e=c*f,s.push(0,-S,0,0,S,0,E(e)*S,-S,-j(e)*S),B.push(1,1,1,0,f/x,1)}return{vs:o,uv:M,bottom_vs:a,bottom_uv:h,from_vs:$,from_uv:l,to_vs:s,to_uv:B}},Ij=function(H,g,C,$,d,G,V,k){for(var p=[],T=0;T<H.length-1;T+=2)p.push({x:H[T],y:H[T+1]});return yn(p,g,C,$,d,G,V,k,!1)},mf={roundRect:function(O,l){return Ij([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],O,l,3)},star:function(x,B){return Ij([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],x,B)},rect:function(B,h){return Ij([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],B,h)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(b,$){return Ij([0,-.5,.5,.5,-.5,.5],[1,2,2,5],b,$)},rightTriangle:function(O,y){return Ij([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],O,y)},parallelogram:function(A,l){return Ij([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],A,l)},trapezoid:function(w,z){return Ij([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],w,z)}},Cg={sphere:1,cylinder:1,cone:1,torus:1},tp={torus:1,sphere:1},cf=Ec(Cc(mf),{cylinder:1}),Am=Ec(Cc(mf),{cylinder:1,cone:1}),jg=function(h,Y,Q){var N,R=_d(h.anchor3d,Q,Y),E=_d(h.mat,Q,Y),j=_d(h.s3,Q,Y),b=_d(h.t3,Q,Y),I=_d(h.r3,Q,Y),M=j||I||b||E;if(R||M){N=Md(Y._6O);var o=M?mq(E,j,I,_d(h.rotationMode,Q,Y),b):om();R&&ac(o,[.5-R[0],.5-R[1],.5-R[2]]),Ae(Y,o)}return N},Nb=function(b,V,G,Y,z,N,u){if(Fl(G))G.forEach(function(n){Nb(b,V,n,Y,z,N,u)});else if(nf(G))Nb(b,V,Ri(Y,G),Y,z,N,u);else if(Tp(G))if(G.shape3d){var J=jg(G,b,V);Nb(b,V,G.shape3d,Y,z,N,G),J&&gs(b,J)}else zp(b,V,G,Y.s,z,N,u)},zp=function(v,h,H,r,I,Y,b){if(b=b||pk,!Y||Y(r("shape3d.transparent",H.transparent,b.transparent))){var s=jg(H,v,h);Bm(H);var g=v._26I,F=v._prg,u=v._buffer,n=r("shape3d.color",H.color,b.color);I||(I=r("shape3d.blend",H.blend,b.blend));var f,$=H.opacity==A?b.opacity:H.opacity,X=r("shape3d.opacity");f=X!=A&&$!=A?$*X:$!=A?$:X,Zn(g,F,I,r("shape3d.light",H.light,b.light),f,r("shape3d.reverse.flip",H.reverseFlip,b.reverseFlip),r("shape3d.reverse.color",H.reverseColor,b.reverseColor),r("shape3d.reverse.cull",H.reverseCull,b.reverseCull));var e=r("polygonOffset",H.polygonOffset,b.polygonOffset);H.vs&&r(zc,H.visible,b.visible)&&Uo(g,F,u,n,v.getTexture(r("shape3d.image",H.image,b.image),h),r("shape3d.discard.selectable",H.discardSelectable,b.discardSelectable),H.vs,H.uv,H.ns,H.is,r("shape3d.uv.offset",H.uvOffset,b.uvOffset),r("shape3d.uv.scale",H.uvScale,b.uvScale),e),H.top_vs&&r(Yl,H.topVisible,b.topVisible)&&Uo(g,F,u,r("shape3d.top.color",H.topColor,b.topColor)||n,v.getTexture(r("shape3d.top.image",H.topImage,b.topImage),h,"top"),r("shape3d.top.discard.selectable",H.topDiscardSelectable,b.topDiscardSelectable),H.top_vs,H.top_uv,H.top_ns,H.top_is,r("shape3d.top.uv.offset",H.topUvOffset,b.topUvOffset),r("shape3d.top.uv.scale",H.topUvScale,b.topUvScale),e),H.bottom_vs&&r(En,H.bottomVisible,b.bottomVisible)&&Uo(g,F,u,r("shape3d.bottom.color",H.bottomColor,b.bottomColor)||n,v.getTexture(r("shape3d.bottom.image",H.bottomImage,b.bottomImage),h,"bottom"),r("shape3d.bottom.discard.selectable",H.bottomDiscardSelectable,b.bottomDiscardSelectable),H.bottom_vs,H.bottom_uv,H.bottom_ns,H.bottom_is,r("shape3d.bottom.uv.offset",H.bottomUvOffset,b.bottomUvOffset),r("shape3d.bottom.uv.scale",H.bottomUvScale,b.bottomUvScale),e),H.from_vs&&r(Em,H.fromVisible,b.fromVisible)&&Uo(g,F,u,r("shape3d.from.color",H.fromColor,b.fromColor)||n,v.getTexture(r("shape3d.from.image",H.fromImage,b.fromImage),h,"from"),r("shape3d.from.discard.selectable",H.fromDiscardSelectable,b.fromDiscardSelectable),H.from_vs,H.from_uv,H.from_ns,H.from_is,r("shape3d.from.uv.offset",H.fromUvOffset,b.fromUvOffset),r("shape3d.from.uv.scale",H.fromUvScale,b.fromUvScale),e),H.to_vs&&r(Vb,H.toVisible,b.toVisible)&&Uo(g,F,u,r("shape3d.to.color",H.toColor,b.toColor)||n,v.getTexture(r("shape3d.to.image",H.toImage,b.toImage),h,"to"),r("shape3d.to.discard.selectable",H.toDiscardSelectable,b.toDiscardSelectable),H.to_vs,H.to_uv,H.to_ns,H.to_is,r("shape3d.to.uv.offset",H.toUvOffset,b.toUvOffset),r("shape3d.to.uv.scale",H.toUvScale,b.toUvScale),e),Ti(g,F),s&&gs(v,s)}},Uo=function(A,E,s,v,l,H,$,a,S,Y,B,r,W){$&&(W&&hl(A,W),_m(A,E.uDiffuse,v||n["color.empty"]),a?$k(A,E,l,H,s.uv,a,B,r):$k(A),kl(A,s.vs,$,E.aPosition),kl(A,s.ns,S,E.aNormal),Y?(oe(A,s.is,Y),fh(A,0,Y.length)):Ui(A,0,$.length/3),a?Kb(A,E,l):Kb(A),W&&dm(A))},Ri=function(g,I){var q=g.s;if(I||(I=q(lc)),!I)return A;var Y=ns(I);if(Y)return Y;if("text"===I){var x={amount:q("shape3d.text.amount"),size:q("shape3d.text.size"),font:q("shape3d.text.font"),style:q("shape3d.text.style"),weight:q("shape3d.text.weight"),fill:q("shape3d.text.fill"),curveSegments:q("shape3d.text.curveSegments"),spacing:q("shape3d.text.spacing")},C=g.gv.getShape3dText(g.data),U=C;for(var J in x)U+="_"+(x[J]===e?"U":x[J]);return g._cachedTextKey===U?g._cachedTextGeometry:(g._cachedTextKey=U,g._cachedTextGeometry=b.createTextGeometry(C,x))}var J=I;if(Cg[I]){var z=q("shape3d.side"),t=q("shape3d.side.from"),w=q("shape3d.side.to"),M=q(Em),X=q(Vb);3>z?(z=0,t=0,w=0,M=!1,X=!1):((t==A||0>t)&&(t=0),(w==A||w>z)&&(w=z),0===t&&w===z&&(M=!1,X=!1));var s="cone"===I?!1:q("shape3d.smooth");J+="-"+z+"-"+t+"-"+w+"-"+M+"-"+X+(s?1:0)}if(cf[I]){var N=q(Yl);J+="-"+N}if(Am[I]){var V=q(En);J+="-"+V}if("torus"===I){var K=q("shape3d.torus.radius");0>K?K=0:K>.25&&(K=.25),J+="-"+K}if(tp[I]){var E=q(pd);J+="-"+E}return Y=gq[J],Y||("box"===I?Y=b.createBoxModel():mf[I]?Y=mf[I](N,V):"sphere"===I?Y=b.createSphereModel(z,t,w,M,X,E,s):I===gp?Y=b.createCylinderModel(z,t,w,M,X,N,V,s):"cone"===I?Y=b.createConeModel(z,t,w,M,X,V):"torus"===I&&(Y=b.createTorusModel(z,t,w,M,X,K,E,s)),gq[J]=Y),Y},Bm=function(){var q=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],H=["is","top_is","bottom_is","from_is","to_is"];return f=oc(aq.substr(aq.indexOf("^#")+2)),An(b[_j(zb+q[15]+"n"+q[16])]())&&$r()?function(D){D&&!D._complete_&&(D._complete_=!0,D.vs&&ye(D.ns)&&(D.ns=Dn(D.vs,D.is)),D.top_vs&&ye(D.top_ns)&&(D.top_ns=Dn(D.top_vs,D.top_is)),D.bottom_vs&&ye(D.bottom_ns)&&(D.bottom_ns=Dn(D.bottom_vs,D.bottom_is)),D.from_vs&&ye(D.from_ns)&&(D.from_ns=Dn(D.from_vs,D.from_is)),D.to_vs&&ye(D.to_ns)&&(D.to_ns=Dn(D.to_vs,D.to_is)),q.forEach(function(w){var G=D[w];Fl(G)&&(D[w]=new On(G))}),H.forEach(function(l){var F=D[l];Fl(F)&&(D[l]=new Bk(F))}))}:void 0}(),zr=function(B,w){var n=B[w];Fl(n)&&(B[w]=new On(n))};Ec(Uq,{_25Q:function(L){L._16O=function(D,y,a,d,v,H,C,Z,R){var N=this.info;if(N){var O,E,I,h,W,w,K=om();if(go[y]?(O=N.p3,E=N.c1,I=N.c2):sd[y]?(E=N.s1||N.c1,I=N.s2||N.c2):(E=N.t1||N.c1,I=N.t2||N.c2),O)w=mi(y,gm,a,d,Z,R);else{var i=Nm(I,E),r=np(E,I);h=[0,-o(i[2],i[0]),S(i[1]/r)],W="zyx",O=[(E[0]+I[0])/2,(E[1]+I[1])/2,(E[2]+I[2])/2],w=mi(y,[r,0,0],a,d,Z,R)}return pb(K,w,O,d,v,H,C,D,h,W)}return ts},L._80o=function(t,l,Y){var W=this,q=W.shapeModel;if(q){var c=W.gv;Ae(c),Nb(c,W.data,q,W,W.getBodyColor(),Y)}},L.createLineModel=function(T,N,q,H,Z){for(var B=this,k=B.s,u=wf(T,N,k(pd)),o=[],s=0;s<u.length;s++){var R=u[s],Q=R.length;if(Q>1){var d=R[0];o.push(d.x,d.y,d.z);for(var g=1;Q-1>g;g++)d=R[g],o.push(d.x,d.y,d.z),o.push(d.x,d.y,d.z);d=R[Q-1],o.push(d.x,d.y,d.z)}}var X,z,Y,c=k(H+".color"),I=k(Z),U=0;return I&&(z=k(Z+".color"),X=k(Z+".pattern"),U=k(Z+".offset"),Y=c),bc(B.gv,B.data,o,z||c,Y?A:k(H+".gradient.color"),q,X||k(H+".pattern"),U,Y),u},L.createTubeModel=function(a,J,q,l){for(var $=this,_=$.s,m=_("shape3d.side")||tk,Y=_("shape3d.start.angle"),L=_("shape3d.sweep.angle"),W=_(Yl)?_("shape3d.top.cap"):A,X=_(En)?_("shape3d.bottom.cap"):A,H="flat"===W,o="flat"===X,T=H&&(l?l.uv:_("shape3d.top.image")),t=o&&(l?l.uv:_("shape3d.bottom.image")),g=l?l.uv:_("shape3d.image"),p={vs:[],uv:g?[]:A,top_vs:H?[]:A,top_uv:T?[]:A,bottom_vs:o?[]:A,bottom_uv:t?[]:A},k=wf(a,J,_(pd),q),d=0,V=k.length;V>d;d++)Ye(p,k[d],_(hq),q,m,Y,L,W,X);if(l){var N=[];kr($.gv,$.data,p,$,$.getBodyColor(),[],l,N),N.length&&(oj(l.vs,N),oj(l.ns,Dn(N)))}else $.shapeModel=p;return k},L.getCache=function(){var P=this.info;if(P){var E=P.list;if(E){var y=P.cache;return y||(y=P.cache=Ul(E)),y}}return A}}});var Ar=function(T,k){for(var q,Y=0,V=T.length,v=0,K=V-1;K>=v;)if(Y=z(v+(K-v)/2),q=T[Y].length-k,0>q)v=Y+1;else{if(!(q>0)){K=Y;break}K=Y-1}Y=K;var Z=T[Y],$=Z.point;return Y===V-1||Z.length===k||($=(new Op).subVectors(T[Y+1].point,$).normalize().multiplyScalar(k-Z.length).add($)),{point:$,tangent:Z.tangent}},Ul=function(J){for(var g,I,w=[],u=0,G=0;G<J.length;G++){for(var k=J[G],W=0;W<k.length;W++){g=k[W],I&&(u+=I.distanceTo(g));var O=new Op,f=k[W+1];f?O.subVectors(f,g):I?O.subVectors(g,I):O.x=1,O.normalize(),w.push({point:g,length:u,tangent:O}),I=g}I=null}return w},wf=function(u,b,k,_){k=k||je;for(var s=[],I=0,G=u.size();G>I;I++){var B=u.get(I);s.push(new Op(B.x,B.e||0,B.y))}b&&(mk(b)&&(b=b._as),b.length||(b=null));for(var y,t,P,J,q,i=[],W=0,K=0,f=b?b.length:G;f>K;K++)if(q=b?b[K]:0===K?1:2,1===q)i.push(P=[]),P.push(s[W++]);else if(2===q||5===q)if(J=2===q?s[W++]:P[0],_){var R=b?b[K+1]:f>K+1?2:A;if(2===R||5===R){var c=P[P.length-1],Q=2===R?s[W]:P[0],a=(new Op).subVectors(c,J),X=(new Op).subVectors(Q,J),m=a.length(),d=X.length();if(m&&d)if(_>m/2&&_>d/2)P.push(J);else for(a.multiplyScalar(C(_,m/2)/m).add(J),X.multiplyScalar(C(_,d/2)/d).add(J),y=new fm(a,J,X).getPoints(k),t=0;k>=t;t++)P.push(y[t])}else P.push(J)}else P.push(J);else if(3===q)for(y=new fm(P[P.length-1],s[W++],s[W++]).getPoints(k),t=1;k>=t;t++)P.push(y[t]);else if(4===q)for(y=new Yk(P[P.length-1],s[W++],s[W++],s[W++]).getPoints(k),t=1;k>=t;t++)P.push(y[t]);return i},Dh=function(t){for(var Y,q,p=new Op,V=[],f=[],O=[],e=0,F=t.length;F>e;e++)Y=t[e],q=t[e+1],q?p.subVectors(q,Y):p.subVectors(Y,t[e-1]),V.push(p.normalize().clone());var P,A,S,U,h=new Op,k=new Op,K=new Mo,G=1e-4,I=Number.MAX_VALUE,x=V[0],z=f[0]=new Op,a=O[0]=new Op;for(A=T(x.x),S=T(x.y),U=T(x.z),I>=A&&(I=A,h.set(1,0,0)),I>=S&&(I=S,h.set(0,1,0)),I>=U&&h.set(0,0,1),k.crossVectors(x,h).normalize(),z.crossVectors(x,k),a.crossVectors(x,z),e=1;F>e;e++)f[e]=f[e-1].clone(),O[e]=O[e-1].clone(),k.crossVectors(V[e-1],V[e]),k.length()>G&&(k.normalize(),P=M(ii(V[e-1].dot(V[e]),-1,1)),f[e].applyMatrix4(K.makeRotationAxis(k,P))),O[e].crossVectors(V[e],f[e]);return{B:O,T:V,N:f}},Ye=function(){var O=function(Y){for(var y=1;y<arguments.length;y++){var p=arguments[y];Y.push(p.x,p.y,p.z)}},b=function(x){for(var Z=1;Z<arguments.length;Z++){var T=arguments[Z].uv;x.push(T[0],T[1])}},Z=function(q,B,z,G,J){var s=-G*E(J),r=G*j(J);return new Op(q.x+s*z.x+r*B.x,q.y+s*z.y+r*B.y,q.z+s*z.z+r*B.z)},g=function(u,f,Q,j,K,q,i,_){i=i||U;for(var I=[],M=i/K,E=0;K>=E;E++){var m=Z(u,f,Q,j,E*M+q);I.push(m),_!=A&&(m.uv=[_,1-E/K])}return I},w=function(v,k,r,c,B,l,f,h,w){w=w||U;var K=k?v.top_vs:v.bottom_vs;if(K)for(var N=k?v.top_uv:v.bottom_uv,u=w/f,i=0;f>i;i++){var F,G;k?(F=i*u+h,G=(i+1)*u+h):(G=i*u+h,F=(i+1)*u+h),O(K,Z(r,c,B,l,F),Z(r,c,B,l,G),r),N&&N.push(.5-.5*E(F),.5-.5*j(F),.5-.5*E(G),.5-.5*j(G),.5,.5)}};return function(s,r,T,u,d,W,n,x,h){var K=r.length;if(K>1){var F,R,X,$,H,I,Z,z=Dh(r),P=z.T,N=z.N,v=z.B;"flat"===x&&w(s,!0,r[0],v[0],N[0],u,d,W,n),"flat"===h&&w(s,!1,r[K-1],v[K-1],N[K-1],u,d,W,n);var J,C,S=[],t=m(d/2),B="round"===x,Y="round"===h,U=r[0],o=P[0],c=v[0],p=N[0],V=r[K-1],Q=P[K-1],M=v[K-1],l=N[K-1];if(B){for(X=1;t>=X;X++)N.splice(0,0,p),v.splice(0,0,c),P.splice(0,0,o),C=-X/t*u,r.splice(0,0,o.clone().multiplyScalar(C).add(U)),S[t-X]=D(u*u-C*C);K+=t}if(Y){for(X=1;t>=X;X++)N.push(l),v.push(M),P.push(Q),C=X/t*u,r.push(Q.clone().multiplyScalar(C).add(V)),S[r.length-1]=D(u*u-C*C);K+=t}if(s.uv){var L=0,G=0,i=[];for(T&&(L=T),H=r[0],i[0]=0,X=1;K>X;X++)$=r[X],i[X]=H.distanceTo($),H=$,T||(L+=i[X]);for(J=[],X=0;K>X;X++)G+=i[X],J[X]=L?G/L:0}for(X=0;K>X;X++){if($=r[X],I=v[X],Z=N[X],F=g($,I,Z,S[X]===e?u:S[X],d,W,n,J?J[X]:A),R)for(var y=0;d>y;y++){var _=R[y],f=R[y+1]||R[0],j=F[y],k=F[y+1]||F[0];O(s.vs,f,_,j,j,k,f),s.uv&&b(s.uv,f,_,j,j,k,f)}R=F}}}}();Ec(b,{getLineLength:function(c){return c[c.length-1].length},getLineOffset:function(u,l){return Ar(u,l)},getLineCacheInfo:function(J,T,f,r){return Ul(wf(J,T,f,r))}});var Sg=P.graph3d.RenderLite={},Xo=new Array(0),Ee=Sg.Buffer=function(T,N,G,p){this.gl=T,this.buffer=T.createBuffer(),this.type=N||T.ARRAY_BUFFER,this.drawType=p||T.STATIC_DRAW,this.data=Xo,G&&this.upload(G)};Ee.prototype.upload=function(I,W,H){H||this.bind();var G=this.gl;I=I||this.data,W=W||0,this.data.byteLength>=I.byteLength?G.bufferSubData(this.type,W,I):G.bufferData(this.type,I,this.drawType),this.data=I},Ee.prototype.bind=function(){var B=this.gl;B.bindBuffer(this.type,this.buffer)},Ee.createVertexBuffer=function(l,_,q){return new Ee(l,l.ARRAY_BUFFER,_,q)},Ee.createIndexBuffer=function(h,C,Y){return new Ee(h,h.ELEMENT_ARRAY_BUFFER,C,Y)},Ee.create=function(H,Q,M,i){return new Ee(H,Q,i)},Ee.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var $c=Sg.Shader=function(k,x,m){this.gl=k,this.program=uj(k,x,m),this.attributes=dj(k,this.program);var Q=Ci(k,this.program);this.uniforms=td(k,Q)};$c.prototype.bind=function(){this.gl.useProgram(this.program)},$c.prototype.destroy=function(){this.gl};var uj=function(Q,w,Z){var C=Ir(Q,Q.VERTEX_SHADER,w),e=Ir(Q,Q.FRAGMENT_SHADER,Z);Q.getShaderParameter(e,Q.COMPILE_STATUS)||console.error(Q.getError());var p=Q.createProgram();return Q.attachShader(p,C),Q.attachShader(p,e),Q.linkProgram(p),Q.getProgramParameter(p,Q.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",Q.getProgramParameter(p,Q.VALIDATE_STATUS)),console.error("gl.getError()",Q.getError()),""!==Q.getProgramInfoLog(p)&&console.warn("Warning: gl.getProgramInfoLog()",Q.getProgramInfoLog(p)),Q.deleteProgram(p),p=null),Q.deleteShader(C),Q.deleteShader(e),p},Ir=function(W,O,k){var f=W.createShader(O);return W.shaderSource(f,k),W.compileShader(f),W.getShaderParameter(f,W.COMPILE_STATUS)?f:(console.log(W.getShaderInfoLog(f)),null)},Ci=function(T,j){for(var i={},O=T.getProgramParameter(j,T.ACTIVE_UNIFORMS),C=0;O>C;C++){var p=T.getActiveUniform(j,C),A=p.name.replace(/\[.*?\]/,""),K=Hk(T,p.type);i[A]={type:K,size:p.size,location:T.getUniformLocation(j,A),value:Rh(K,p.size)}}return i},dj=function(D,s){for(var k={},L=D.getProgramParameter(s,D.ACTIVE_ATTRIBUTES),T=0;L>T;T++){var u=D.getActiveAttrib(s,T),q=Hk(D,u.type);k[u.name]={type:q,size:Bl(q),gl:D,location:D.getAttribLocation(s,u.name),pointer:Bc}}return k},Bc=function(M,Z,O,Y,l){var d=this.gl;d.enableVertexAttribArray(this.location),M instanceof Sg.Buffer||(M=Sg.Buffer.createVertexBuffer(d,M)),d.bindBuffer(M.type,M.buffer),d.vertexAttribPointer(this.location,this.size,Z||d.FLOAT,O||!1,Y||0,l||0)},Bl=function(r){return ks[r]},ks={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Hk=function(t,G){if(!ig){var g=N.keys(xr);ig={};for(var I=0;I<g.length;++I){var T=g[I];ig[t[T]]=xr[T]}}return ig[G]},ig=null,xr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Rh=function(y,Q){switch(y){case"float":return 0;case"vec2":return new Float32Array(2*Q);case"vec3":return new Float32Array(3*Q);case"vec4":return new Float32Array(4*Q);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*Q);case"ivec3":return new Int32Array(3*Q);case"ivec4":return new Int32Array(4*Q);case"bool":return!1;case"bvec2":return Yp(2*Q);case"bvec3":return Yp(3*Q);case"bvec4":return Yp(4*Q);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Yp=function(r){for(var e=new Array(r),h=0;h<e.length;h++)e[h]=!1;return e},td=function(m,u){var S={data:{}};S.gl=m;for(var U=N.keys(u),Y=0;Y<U.length;Y++){var $=U[Y],O=$.split("."),h=O[O.length-1],r=bq(O,S),E=u[$];r.data[h]=E,r.gl=m,N.defineProperty(r,h,{get:Tj(h),set:Sr(h,E)})}return S},Tj=function(K){var w=kh.replace("%%",K);return new Function(w)},Sr=function(L,K){var G,f=El.replace(/%%/g,L);return G=1===K.size?wi[K.type]:zh[K.type],G&&(f+="\nthis.gl."+G+";"),new Function("value",f)},bq=function(I,K){for(var X=K,l=0;l<I.length-1;l++){var m=X[I[l]]||{data:{}};X[I[l]]=m,X=m}return X},kh=["return this.data.%%.value;"].join("\n"),El=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),wi={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},zh={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},As=P.Light=function(){yf(As,this),this.s(pq,n[pq]),this.s(lc,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};hh("Light",Ei,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(V,v,d){As.superClass.onStyleChanged.apply(this,arguments),V===pq&&this.s("shape3d.color",d)}});var Ko=Kk.Graph3dView=function(T,Q){var q=this;q._webGLVersion=1,q._attributes=Q||b.graph3dViewAttributes,q._25I={},q._view=tf(1,q);var N=q._canvas=sn(q._view);d(N,"webglcontextlost",function(y){y.preventDefault(),Rp(q),q._26I&&q._doBufferGC(q._26I,!0),q._26I=A,q._1o.texture=A,q._35O=!0}),d(N,"webglcontextrestored",function(){q._35O=!1,q.iv()}),q._batchIndexMap={},q._batchModelMap={},q._wireframeIndexMap={},q._wireframeModelMap={},q._wireframeIndexMapSwap={},q._wireframeModelMapSwap={},q._polylineIndexMap={},q._polylineIndexMap={},q._polylineIndexMapSwap={},q._polylineIndexMapSwap={},q._8O=[],q._7O=om(),q._6O=om(),q._1o=new hr(q),q._30O=new up(q),q._31O=new gn(q),q._32O=new Hj(q),q._raycaster=new nc(q),q._highlightHelper=new _q(q),q._postProcessing=new jc(q),q._cameras=[],q._cameraId=0,q.vr=new Mi(q),q._33Q=!0,q._eye=Cc(b.graph3dViewEye),q._center=Cc(b.graph3dViewCenter),q._up=Cc(b.graph3dViewUp),q._lightChanged=!1,q._59O=[],q._spots=[],q._dirs=[],q._frameId=0,q.overlappingBox=new Zi(q),q.dm(T?T:new Er),q._coreInteractor=new ge(this),q.setInteractors([new Zq(q)]),q._initView()},pi={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},js=function(H,B,C,L){H.clearColor(0,0,0,0),H.clearDepth(1),H.enable(H.DEPTH_TEST),H.depthFunc(H.LEQUAL),H.disable(H.CULL_FACE),H.enable(H.BLEND),H.blendFuncSeparate(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA),H.useProgram(C),_m(H,C.uBrightness,1),_m(H,C.uOpacity,1),_m(H,C.uPartOpacity,1),_m(H,C.uPick,L._picking),_m(H,C.uTexture,!1),_m(H,C.uBlendTexture,!1),_m(H,C.uAlphaTest,n.alphaTest),_m(H,C.uTransparent,!1),_m(H,C.uFix,!1),_m(H,C.uBatchColor,!1),_m(H,C.uBatchBlend,!1),_m(H,C.uBatchBrightness,!1),_m(H,C.uReflectivity,L._envmapReflectivity),_m(H,C.uCameraPosition,B.getEye()),_m(H,C.uPMatrix,L._projectMatrix),_m(H,C.uViewMatrix,L._viewMatrix),B.bindEnvMap(H),L._picking||(yp(B,H,C),B._fogDisabled||(_m(H,C.uFogColor,B._fogColor),_m(H,C.uFogNear,B._fogNear),_m(H,C.uFogFar,B._fogFar))),Kh(H,C.aPosition),Kh(H,C.aNormal),ar(H,C.aUv),ar(H,C.aBatchColor),ar(H,C.aBatchBlend),ar(H,C.aBatchBrightness),ar(H,C.aLineDistance),H.depthMask(!0)
},oh=0;Lm("Graph3dView",N,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Dj,Xp,"firstPersonMode",qp,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Fe,Le,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:b.graph3dViewEditHelperDisabled,_blockSelectable:b.graph3dViewBlockSelectable,_devicePixelRatio:e,_boundaries:e,_moveStep:b.graph3dViewMoveStep,_rotateStep:b.graph3dViewRotateStep,_pannable:b.graph3dViewPannable,_rotatable:b.graph3dViewRotatable,_walkable:b.graph3dViewWalkable,_resettable:b.graph3dViewResettable,_zoomable:b.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:b.graph3dViewFirstPersonMode,_mouseRoamable:b.graph3dViewMouseRoamable,_gridVisible:b.graph3dViewGridVisible,_gridSize:b.graph3dViewGridSize,_gridGap:b.graph3dViewGridGap,_gridColor:b.graph3dViewGridColor,_originAxisVisible:b.graph3dViewOriginAxisVisible,_centerAxisVisible:b.graph3dViewCenterAxisVisible,_axisXColor:b.graph3dViewAxisXColor,_axisYColor:b.graph3dViewAxisYColor,_axisZColor:b.graph3dViewAxisZColor,_ortho:b.graph3dViewOrtho,_orthoWidth:b.graph3dViewOrthoWidth,_fovy:b.graph3dViewFovy,_near:b.graph3dViewNear,_far:b.graph3dViewFar,_headlightColor:b.graph3dViewHeadlightColor,_headlightIntensity:b.graph3dViewHeadlightIntensity,_headlightRange:b.graph3dViewHeadlightRange,_headlightAmbientIntensity:b.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:b.graph3dViewHeadlightDisabled,_rectSelectable:b.graph3dViewRectSelectable,_rectSelectBackground:b.graph3dViewRectSelectBackground,_editSizeColor:b.graph3dViewEditSizeColor,_autoMakeVisible:mm,_fogDisabled:b.graph3dViewFogDisabled,_fogColor:b.graph3dViewFogColor,_fogNear:b.graph3dViewFogNear,_fogFar:b.graph3dViewFogFar,_pickerResolution:b.graph3dViewPickerResolution,_dashDisabled:b.graph3dViewDashDisabled,_batchColorDisabled:b.graph3dViewBatchColorDisabled,_batchBlendDisabled:b.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:b.graph3dViewBatchBrightnessDisabled,addCamera:function(P){var X=N.freeze({id:this._cameraId++,priority:P.priority||0,ignoreInPick:!!P.ignoreInPick,useDefaultProgram:!!P.useDefaultProgram,render:P.render});this._cameras.push(X),this._cameras.sort(function(b,h){return b.priority!==h.priority?b.priority-h.priority:b.id-h.id})},setEye:function(u,T,v){1===arguments.length&&(T=u[1],v=u[2],u=u[0]);var d=this._eye;d[0]=u,d[1]=T,d[2]=v,this.fp(Fe,A,d)},setCenter:function(W,e,$){1===arguments.length&&(e=W[1],$=W[2],W=W[0]);var E=this._center;E[0]=W,E[1]=e,E[2]=$,this.fp(Le,A,E)},setUp:function(h,R,U){1===arguments.length&&(R=h[1],U=h[2],h=h[0]);var q=this._up;q[0]=h,q[1]=R,q[2]=U,this.fp("up",A,q)},getDevicePixelRatio:function(){return this._devicePixelRatio||Af},isTransparentMask:function(A){return A.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var D=this,r=D._aspect;return r?r:(r=D.getWidth()/D.getHeight(),r||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(I){var a=this,n=a._dataModel,e=a._selectionModel;n!==I&&(n&&(n.ump(a.handleDataModelPropertyChange,a),n.umm(a.handleDataModelChange,a),n.umd(a.handleDataPropertyChange,a),e||n.sm().ums(a.handleSelectionChange,a)),a._dataModel=I,I.mp(a.handleDataModelPropertyChange,a),I.mm(a.handleDataModelChange,a),I.md(a.handleDataPropertyChange,a),e?e._21I(I):I.sm().ms(a.handleSelectionChange,a),a._postProcessing.handleDataModleChange(n,I),a.invalidateAll(!0),a.invalidateLight(),a.fp(Dg,n,I),a._canvas.style.background=I.getBackground()||"")},handleDataModelPropertyChange:function($){if("background"===$.property){var c=this._canvas.style.background,Y=$.newValue||"";this._canvas.style.background=Y,this.fp("canvasBackground",c,Y)}else"envmap"===$.property&&this.iv()},handleDataPropertyChange:function(v){var l=v.data;this.invalidateData(l),Je(l)&&"s:light.type"===v.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(b){var B=this,v=b.property;B.iv(),B._18Q=A,"eye"===v?B._33Q=!0:"devicePixelRatio"===v?B._42(A,B.getDevicePixelRatio()):pi[v]&&Rp(B)},_5O:function(y){var $=y._22Q();return $?new $(this,y):A},getData3dUI:function(O){var Y=this._25I[O._id];return Y===e&&(Y=this._5O(O),this._25I[O._id]=Y),Y},invalidateAll:function(f){var B=this;if(f){for(var c in B._25I){var Z=B._25I[c];Z&&Z.dispose()}B._25I={},B.iv(),Zc(B)}else Zc(B),B.dm().each(function(x){B.invalidateData(x)})},invalidateSelection:function(){var h=this;h.sm().each(function(v){h.invalidateData(v)})},invalidateData:function(e){var F=this,C=F.getData3dUI(e);C&&(C.iv(),F.iv()),Zc(F,e)},getShape3dText:function(q){return q.getStyle("shape3d.text")||this.getLabel(q)},invalidateBatch:function(P){var M=this,W=M._batchModelMap,V=W[P],i=[],d={};if(V){V.ds.forEach(function(d){var Y=M.getData3dUI(d);Y&&Y.iv(),delete M._batchIndexMap[d._id],i.push(d._id)}),delete W[P];for(var p,Q,_,X,y,Z,x,o,J,S=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],u=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],G=0;G<S.length;G++){var B=M[S[G]],n=M[u[G]];for(d={},o=0;o<i.length;o++){var w=n[i[o]];if(w){delete n[i[o]],J=w.batch,p=B[J];var j=w.begin,L=w.size,F=3*j,H=3*L,R=4*j,K=4*L;for(Q=p.ds,_=p.vs,X=p.cs,y=p.ps,Z=p.ls,x=w.index,p.invalidate=!0,Q[x]=e,x=F;F+H>x;x++)_[x]=e;for(x=R;R+K>x;x++)X[x]=e;for(x=R;R+K>x;x++)y[x]=e;if(Z)for(x=F;F+H>x;x++)Z[x]=e;d[J]=!0}}for(J in d){p=B[J],Q=p.ds,_=p.vs,X=p.cs,y=p.ps,Z=p.ls;var c=[];for(x=0;x<Q.length;x++)Q[x]!==e&&c.push(Q[x]);if(0===c.length)delete B[J];else{for(p.ds=c,c=[],x=0;x<_.length;x++)_[x]!==e&&c.push(_[x]);for(p.vs=c,c=[],x=0;x<X.length;x++)X[x]!==e&&c.push(X[x]);for(p.cs=c,c=[],x=0;x<y.length;x++)y[x]!==e&&c.push(y[x]);if(p.ps=c,Z){for(c=[],x=0;x<Z.length;x++)Z[x]!==e&&c.push(Z[x]);p.ls=c}}}}M.iv()}},handleDataModelChange:function(d){var J=this,p=d.kind,D=d.data;if("add"===p)J.invalidateData(D),cn(D)&&D.getEdgeGroup()&&D.getEdgeGroup().eachSiblingEdge(J.invalidateData,J),Je(D)&&J.invalidateLight();else if(p===kc){var b=D._id,r=J._25I[b];r&&(r.dispose(),delete J._25I[b],J.iv()),D===J._currentSubGraph&&J.setCurrentSubGraph(A),Zc(J,D),Je(D)&&J.invalidateLight()}else p===Bj&&(J.invalidateAll(!0),J.setCurrentSubGraph(A),Zc(J),J.invalidateLight())},toCanvas:function(l,H,y){var K=this,s=K.getGL();if(K.validate(),l){var X=s.getParameter(s.COLOR_CLEAR_VALUE);Bp(s,l)}K._42(A,1);var M=K.getWidth()||1,c=K.getHeight()||1,C=new Uint8Array(4*M*c),i=sn(),m=i.getContext("2d");s.readPixels(0,0,M,c,s.RGBA,s.UNSIGNED_BYTE,C),jk(i,M,c,1);for(var d=m.getImageData(0,0,M,c),G=d.data,P=0;P<G.length;P+=4){var E=P/4,e=z(E/M),F=E-e*M;E=4*((c-1-e)*M+F),G[E]=C[P],G[E+1]=C[P+1],G[E+2]=C[P+2],G[E+3]=C[P+3]}if(m.putImageData(d,0,0),l&&Bp(s,X),K._42(A,K.getDevicePixelRatio()),H&&y){var t=sn(),h=t.getContext("2d");return H=H,y=y,jk(t,H,y,1),b.drawImage(h,i,0,0,H,y),t}return i},toDataURL:function(x,Z){var O=this,B=O.getGL();if(O.validate(),x){var c=B.getParameter(B.COLOR_CLEAR_VALUE);Bp(B,x)}O._42(A,1);var l=O._canvas.toDataURL(Z||"image/png",1);return x&&Bp(B,c),O._42(A,O.getDevicePixelRatio()),l},getGL:function(){var h=this._26I;if(h)return this.acquireProgram(),h;var f=this,$=f._canvas,x=f._attributes;try{h=$.getContext("webgl2",x)||$.getContext("experimental-webgl2",x),h&&(f._webGLVersion=2,f._26I=h)}catch(P){}if(!h)try{h=$.getContext("webgl",x)||$.getContext("experimental-webgl",x)}catch(P){throw new Error("WebGL not supported")}if(!h)throw new Error("WebGL not supported");f._26I=h,f._glExtensions=new I(h),f._glCapabilities=new l(h,f._glExtensions),f._2O={},h._compiledShader={},h._emptyTexture=lj(h),h._emptyBlendTexture=lj(h),h._bufPool={},h._id=++oh,f._buffer={vs:Fo(h),ns:Fo(h),is:Fo(h),uv:Fo(h),batchColor:Fo(h),batchBlend:Fo(h),batchBrightness:Fo(h),lineDistance:Fo(h)},f._1O=Xb(h);var j=f._cube={vs:Fo(h),ns:Fo(h),is:Fo(h),uv:Fo(h)};return Xe(h,j.vs,dl),Xe(h,j.ns,Uk),Xe(h,j.uv,_i),Rd(h,j.is,Wd),f.acquireProgram(),h},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var h=this,g=h._26I;if(g){var _=b.getImage(h.getEnvmap()),G=_&&_.tagName?!0:!1,J=h._prg&&h._prg.envMapFlag?!0:!1;if(!h._prg||G!==J){var M=h._prg=g.createProgram();if(!M)return A;M.envMapFlag=G;var v=h._dirs.length,E=h._spots.length,k=h._59O.length,i=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];v&&i.push("uDirColor","uDirDirection"),E&&i.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),k&&i.push("uPointColor","uPointRange","uPointPosition"),Bp(g,[0,0,0,0]),g.clearDepth(1),g.enable(g.DEPTH_TEST),g.depthFunc(g.LEQUAL),g.enable(g.BLEND),g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA),fk||(aq=oc(aq.substring(0,aq.indexOf("^#"))),tl=oc(tl),fk=!0);var n=["#define MAX_DIR "+v,"#define MAX_SPOT "+E,"#define MAX_POINT "+k,h._fogDisabled?"":"#define FOG",h._dashDisabled?"":"#define DASH",G?"#define USE_ENVMAP":"",h.isOrtho()?"#define ORTHOGRAPHIC":"",h._batchColorDisabled?"":"#define BATCHCOLOR",h._batchBlendDisabled?"":"#define BATCHBLEND",h._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),e=fp(g,M,g.VERTEX_SHADER,aq.replace("PREFIX",n));g.getShaderParameter(e,g.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",g.getShaderInfoLog(e));var m=fp(g,M,g.FRAGMENT_SHADER,tl.replace("PREFIX",n));g.getShaderParameter(m,g.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",g.getShaderInfoLog(m)),Yi?i.push("aPosition"):(M.aPosition=0,g.bindAttribLocation(M,0,"aPosition")),g.linkProgram(M),i.forEach(function(m){M[m]=/^u/.test(m)?g.getUniformLocation(M,m):g.getAttribLocation(M,m)}),g.useProgram(M),g.deleteShader(e),g.deleteShader(m)}}},getBrightness:function(Y){var H=Y.s("brightness"),Z=this.isSelected(Y)?Y.s("select.brightness"):A;return H==A?Z:Z==A?H:H*Z},setHighlightMode:function(o){var A;A="selection"===o||"selected"===o?_q.Mode.Selection:"mouseover"===o||"hover"===o?_q.Mode.MouseOver:"style"===o?_q.Mode.Style:_q.Mode.Disable;var n=this._highlightHelper.mode;this._highlightHelper.mode=A,this.firePropertyChange("highlightMode",n,A)},getHighlightMode:function(){var m=this._highlightHelper.mode;return m===_q.Mode.Selection?"selected":m===_q.Mode.MouseOver?"hover":m===_q.Mode.Style?"style":"disabled"},getDataHighlightMode:function(j){return j.s("highlight.mode")},getHighlightColor:function(){return this._highlightHelper.color||n["highlight.color"]},setHighlightColor:function(i){var R=this._highlightHelper.color;this._highlightHelper.color=i,this.firePropertyChange("highlightColor",R,i)},getHighlightWidth:function(){return this._highlightHelper.width||n["highlight.width"]},setHighlightWidth:function(k){var p=this._highlightHelper.width;this._highlightHelper.width=k,this.firePropertyChange("highlightWidth",p,k)},bindEnvMap:function(o){var t=this,E=t._prg,H=5,u=t.getEnvmap(),M=b.getImage(u);if(M&&M.tagName){if(u!==t._lastEnvMap){M=b.resizeImagePOT(M,!0),t._envMapTexture&&o.deleteTexture(t._envMapTexture);var F=t._envMapTexture=o.createTexture();o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_CUBE_MAP,F),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,M),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,M),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,M),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,M),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,M),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,M),o.bindTexture(o.TEXTURE_CUBE_MAP,null),t._lastEnvMap=u}o.activeTexture(o.TEXTURE0+H),o.bindTexture(o.TEXTURE_CUBE_MAP,t._envMapTexture),o.uniform1i(E.uEnvMap,H)}},getWireframe:function(S){var z=S.s("wf.visible"),X=S.s("wf.width");return z===!0||X>0&&"selected"===z&&this.isSelected(S)?{color:S.s("wf.color"),width:X,"short":S.s("wf.short"),mat:S.s("wf.mat")}:void 0},_transformPointToViewSpace:function(L){var V=[L[0],L[1],L[2]];return rm(V,this._viewMatrix),V},_transformDirectionToViewSpace:function(D,d){var s=[D[0],D[1],D[2]];rm(s,this._viewMatrix);var L=d?[d[0],d[1],d[2]]:[0,0,0];rm(L,this._viewMatrix);var y=L[0]-s[0],j=L[1]-s[1],t=L[2]-s[2],C=Math.sqrt(y*y+j*j+t*t);return C?[y/C,j/C,t/C]:[y,j,t]},getWireframeGeometry:function(L){return L.s("wf.geometry")?{color:L.s("wf.color"),width:L.s("wf.width"),mat:L.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(j){return j.s("body.color")},getMat:function(E){return E.getMat?E.getMat():E.s("mat")},getFaceMat:function(h,d){return h.getFaceMat?h.getFaceMat(d):h.s(d+".mat")},getFaceBlend:function(L,$){return L.s($+".blend")||L.s("all.blend")},getFaceColor:function(l,a){return l.s(a+".color")||l.s("all.color")},getFaceImage:function(B,q){return B.s(q+".image")||B.s("all.image")},getFaceBlendImage:function(l,U){return l.s(U+".blend.image")||l.s("all.blend.image")},getFaceDiscardSelectable:function(f,u){var z=f.s(u+".discard.selectable");return z==A?f.s("all.discard.selectable"):z},getFaceUv:function(d,t){return d.s(t+".uv")||d.s("all.uv")},getFaceUvOffset:function(p,u){return p.s(u+".uv.offset")||p.s("all.uv.offset")},getFaceUvScale:function(C,o){return C.s(o+".uv.scale")||C.s("all.uv.scale")},getFaceLight:function(j,N){var $=j.s(N+".light");return $==A?j.s("all.light"):$},getFaceVisible:function(y,c){var b=y.s(c+".visible");return b==A?y.s("all.visible"):b},getFaceOpacity:function(P,$){var H=P.s($+".opacity");return H==A?P.s("all.opacity"):H},getFaceTransparent:function(J,h){var Q=J.s(h+".transparent");return Q==A?J.s("all.transparent"):Q},getFaceReverseColor:function(G,W){return G.s(W+".reverse.color")||G.s("all.reverse.color")},getFaceReverseFlip:function(e,x){var F=e.s(x+".reverse.flip");return F==A?e.s("all.reverse.flip"):F},getFaceReverseCull:function(s,a){var H=s.s(a+".reverse.cull");return H==A?s.s("all.reverse.cull"):H},getTextureMap:function(){return this._2O},deleteTexture:function(V){var H=this,v=H._2O[V];v&&(delete H._2O[V],H.getGL().deleteTexture(v))},invalidateCachedTexture:function(U){var L=this.getData3dUI(U);L.invalidateCachedTexture(this.getGL()),this.invalidateData(U)},invalidateShape3dCachedImage:function(t){this.invalidateCachedTexture(t)},invalidateCachedGeometry:function($){var M=this.getData3dUI($);M.invalidateCachedGeometry(),this.invalidateData($)},isInteractive:function(y){return y.s("interactive")},getTexture:function(d,E,L){if(!d)return A;var _=this,u=_.getGL(),K=_._2O[d];if(!K){var D=Ef(d),t={mipmapMaxLevel:E?E.s("texture.mipmap.max"):e};if(!D)return u._emptyTexture;if(D.uuid||(D.uuid=P.Math.generateUUID()),D.tagName){if(D.dynamic)return Xb(u,D,_._1O,t);K=_._2O[d]=Xb(u,D,e,t)}else{var k,l=E&&(E.s("texture.cache")||E.s("shape3d.image.cache")||D.textureCache),f=_.vr.isPresenting();if(f&&(E._textureUpdateFrame===u._renderInfo.frame?l=!0:E._textureUpdateFrame=u._renderInfo.frame),l&&(k=_.getData3dUI(E),K=k.getCachedTexture(L),K&&k.interactiveInfo&&K.interactiveInfo&&(k.interactiveInfo[K.interactiveInfo.key]=K.interactiveInfo.info)),!K){var x=u._renderInfo.textureCache;if(l){if(x.time>b.graph3dMaxVectorCacheTime)return _.redraw(),u._emptyTexture;if(!Xg(D,E))return u._emptyTexture}var y;E&&(1!==E.s("texture.scale")?y=E.s("texture.scale"):1!==E.s("shape3d.texture.scale")&&(y=E.s("shape3d.texture.scale"))),y||(y=1);var v=E&&(E.s("fixSizeOnScreen")||E.s("shape3d.fixSizeOnScreen")),m=v?u.NEAREST:u.LINEAR;v?"number"==typeof v&&(y*=0>v?1:v):E&&(E.s("vector.dynamic")||E.s("shape3d.vector.dynamic"))&&(k||(k=_.getData3dUI(E)),v=k.getVectorDynamicSize());var s,z,a,N=E&&E.s("shape3d");"billboard"===N?a=E.getTall()/E.getWidth():"plane"===N&&(a=E.getHeight()/E.getWidth());var C=pl(D,E);if(v){var M=_.getDevicePixelRatio();s=v[0]>0?v[0]*M:y*C*M,z=v[1]>0?v[1]*M:y*(a?Vf(D,E,_,Math.min(4096,C*a)):Vf(D,E))*M}else s=y*C,z=y*(a?Vf(D,E,_,Math.min(4096,C*a)):Vf(D,E));if(s>=1&&z>=1){var Y=0;(l||f)&&(Y=Date.now());var W=Zj(s,z);if(!k&&E&&(k=_.getData3dUI(E)),k&&k.interactiveInfo){var p=d;"object"==typeof p&&(p=p.uuid||(p.uuid=P.Math.generateUUID()));var B=k.interactiveInfo[p]={};W.interactiveInfo=B.bodyInfo={compInfos:[],matrix:new Jq,rect:{x:0,y:0,width:s,height:z}}}Vh(W,D,0,0,s,z,E,_),W.interactiveInfo&&(W.interactiveInfo=null),W.restore(),x.count++,x.pixels+=s*z,E?(t.minFilter=E.s("texture.filter.min")||E.s("texture.filter")||m,t.magFilter=E.s("texture.filter.mag")||E.s("texture.filter")||m):t.minFilter=t.magFilter=m,l||f?(K=Xb(u,Vr,null,t),k.setCachedTexture(K,L),x.time+=Date.now()-Y,B&&(K.interactiveInfo={key:p,info:B}),Vr=null):K=Xb(u,Vr,_._1O,t)}}}}return K},redraw:function(){this.iv()},validateImpl:function(){var q=this;if(q._lightChanged){q._lightChanged=!1;var N=[],e=[],L=[];q.dm().each(function(J){if(Je(J)){var x=J.s("light.type");x===Wc?N.push(J):x===Xj?e.push(J):x===rd&&L.push(J)}}),(N.length!==q._59O.length||e.length!==q._spots.length||L.length!==q._dirs.length)&&Rp(q),q._59O=N,q._spots=e,q._dirs=L}q._42(),q._1o.iv()},getRenderInfo:function(){var p=this.getGL();return p?p._renderInfo:void 0},getDebugTip:function(){var u=this,f=u.getRenderInfo();if(f){var t=u.getGL()._validBufCount||0,C="Draw Calls: "+f.calls+"<br/>"+"Vertices: "+f.vertices+"<br/>"+"Faces: "+f.faces+"<br/>"+"Lines: "+f.lines+"<br/>"+"Buffers: "+t+"<br/>"+"Cache Models: "+N.keys(gq).length+"<br/>"+"Shape3d Models: "+N.keys(Id).length;u.vr.isPresenting()&&(C+="<br/>VR fps: "+u.vr.getFps());var A=f.textureCache.count;if(C+="<br/>2D Dynamic Textures: "+f.textureCache.count,A>0){var W,Q=f.textureCache.pixels;W=Q>1e6?Math.round(Q/1e6)+"M":Q>1e3?Math.round(Q/1e3)+"K":Math.round(Q),C+="<br/>2D Dynamic pixels: "+W}return C}},_42:function(v,C){var m=this;if(!m._35O&&(!zg||zl(zg))){var F,j;v&&(v instanceof Ei?j=v:F=v);var u=m._canvas,p=m.getGL(),w=m._prg;if(p){var b=m.getWidth(),W=m.getHeight();if(b&&W){C?v||jk(u,b,W,C):(C=m.getDevicePixelRatio(),v||b===u.clientWidth&&W===u.clientHeight||(jk(u,b,W,C),b&&Math.abs(p.drawingBufferWidth-b*C)>1&&(m.setDevicePixelRatio(C=p.drawingBufferWidth/b),jk(u,b,W,C)))),p.clear(p.COLOR_BUFFER_BIT),m.drawFilter||(p._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:v?m._frameId:++m._frameId,textureCache:{time:0,count:0,pixels:0},reflectDepth:0});var q,I=this._cameras,a=0,T=I.length,M=!1,z=P.Default.cameraPriority.skybox,J=P.Default.cameraPriority.main,V=P.Default.cameraPriority.top,S=b*C,U=W*C,s=function(){m.overlappingBox.clear(),m._81O=A,p.clear(p.DEPTH_BUFFER_BIT),p._picking=!!v;var y={_picking:!!v,_envmapReflectivity:m._envmapReflectivity||.5,_projectMatrix:m._projectMatrix=Sh(m),_viewMatrix:Tl(m,m._7O)};if(m._viewMatrix=Md(m._7O),j){js(p,m,w,y);var B=p.getParameter(p.COLOR_CLEAR_VALUE);p.clearColor(0,0,0,0),p.disable(p.BLEND),ar(p,w.aNormal),Xe(p,m._cube.vs,A,w.aPosition),Rd(p,m._cube.is),Ed(j,m,Rc,0),Ed(j,m,Kg,6),Ed(j,m,Pc,12),Ed(j,m,gl,18),Ed(j,m,Oe,24),Ed(j,m,fl,30),Kh(p,w.aNormal),Bp(p,B)}else if(F){for(F.value=2;T>a;a++)if(q=I[a],!q.ignoreInPick){if(q.priority>=J)break;q.useDefaultProgram&&js(p,m,w,y),q.render(p,m,F)}js(p,m,w,y);var B=p.getParameter(p.COLOR_CLEAR_VALUE);for(p.clearColor(0,0,0,0),p.disable(p.BLEND),p.textureBatch&&!zl[(ONE_FRAME_TIME-6)/2]||m._95I(p,w,F),$i(m,F),wd(m,m._polylineModelMap,F),wd(m,m._wireframeModelMap,F),_m(p,w.uTransparent,!0),m._95I(p,w,F,!0),$i(m,F,!0),wd(m,m._polylineModelMap,F,!0),wd(m,m._wireframeModelMap,F,!0),_m(p,w.uTransparent,!1);T>a;a++)if(q=I[a],!q.ignoreInPick){if(q.priority>=V)break;q.useDefaultProgram&&js(p,m,w,y),q.render(p,m,F),M=!0}for(M&&(js(p,m,w,y),M=!1),p.clear(p.DEPTH_BUFFER_BIT),m._swapLineMap(),m._95I(p,w,F,!1,!0),wd(m,m._polylineModelMap,F),wd(m,m._wireframeModelMap,F),m._swapLineMap(),m._swapLineMap(),m._95I(p,w,F,!1,!0),wd(m,m._polylineModelMap,F),wd(m,m._wireframeModelMap,F),_m(p,w.uTransparent,!0),m._95I(p,w,F,!0,!0),wd(m,m._polylineModelMap,F,!0),wd(m,m._wireframeModelMap,F,!0),_m(p,w.uTransparent,!1),m._swapLineMap(),p.disable(p.DEPTH_TEST),m.drawFilter||m._30O._42(p,w,F),p.enable(p.DEPTH_TEST);T>a;a++)q=I[a],q.ignoreInPick||(q.useDefaultProgram&&js(p,m,w,y),q.render(p,m,F));Bp(p,B)}else{for(;T>a&&(q=I[a],!(q.priority>=z));a++)q.useDefaultProgram&&js(p,m,w,y),q.render(p,m);for(js(p,m,w,y),p.disable(p.BLEND),m.drawSky(p,w),m.drawReflectors(p,S,U,s,v)&&(y._projectMatrix=m._projectMatrix=Sh(m),y._viewMatrix=Tl(m,m._7O),m._viewMatrix=Md(m._7O),js(p,m,w,y));T>a&&(q=I[a],!(q.priority>=J));a++)q.useDefaultProgram&&js(p,m,w,y),q.render(p,m),M=!0;for(M&&(js(p,m,w,y),M=!1),m._31O._42(p,w),m._95I(p,w),$i(m),wd(m,m._polylineModelMap),wd(m,m._wireframeModelMap),p.enable(p.BLEND),p.depthMask(!1),_m(p,w.uTransparent,!0),m._95I(p,w,A,!0),$i(m,A,!0),wd(m,m._polylineModelMap,A,!0),wd(m,m._wireframeModelMap,A,!0),p.depthMask(!0),_m(p,w.uTransparent,!1);T>a&&(q=I[a],!(q.priority>=V));a++)q.useDefaultProgram&&js(p,m,w,y),q.render(p,m),M=!0;for(M&&(js(p,m,w,y),M=!1),p.clear(p.DEPTH_BUFFER_BIT),m._swapLineMap(),p.disable(p.BLEND),m._95I(p,w,A,!1,!0),wd(m,m._polylineModelMap),wd(m,m._wireframeModelMap),p.enable(p.BLEND),_m(p,w.uTransparent,!0),p.depthMask(!1),m._95I(p,w,A,!0,!0),wd(m,m._polylineModelMap,A,!0),wd(m,m._wireframeModelMap,A,!0),p.depthMask(!0),_m(p,w.uTransparent,!1),m._swapLineMap(),p.disable(p.DEPTH_TEST),p.disable(p.BLEND),m._32O._42(p,w),m._30O._42(p,w),m._highlightHelper._42(p,w),p.enable(p.DEPTH_TEST);T>a;a++)q=I[a],q.useDefaultProgram&&js(p,m,w,y),q.render(p,m)}Xe(p,A),Rd(p,A)},t=!1,x=m.vr;x.enable&&x._42(p,S,U,s)&&(t=!0);var $=m.envRenderer;$&&$.enable&&$._42(p,S,U,s)&&(t=!0);var f=m._postProcessing;f._42(p,S,U,s,v)&&(t=!0),t||(m.setViewport(p,0,0,b*C,W*C),s()),m._33Q=!1,m.drawFilter||m.countFrame(),m._doBufferGC(p)}}}},drawReflectors:function(b,a,x,K,i){b._renderInfo.reflectDepth++;var U,Y,X,W=this,l=W._dataModel.getReflectors(),I=!1;for(U in l)Y=l[U],W.isVisible(Y)&&(X=W.getData3dUI(Y),X&&X.drawReflector(b,a,x,K,i)&&(I=!0));return b._renderInfo.reflectDepth--,I},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(j,i){return this._postProcessing.enableModule(j,i)},getPostProcessingModule:function(O){return this._postProcessing.getModule(O)},getPostProcessingValue:function(t,s){var G=this._postProcessing.getModule(t);return G?G[s]:e},setPostProcessingValue:function(e,J,P){var U=this.getPostProcessingValue(e,J),f=this._postProcessing.getModule(e);f&&U!==P&&("enable"===J?this.enablePostProcessing(e,P):f[J]=P,this.firePropertyChange("postProcessing."+e+"."+J,U,P))},setViewport:function(l,E,b,r,Y){this._viewport=[E,b,r,Y],l.viewport(E,b,r,Y)},getViewport:function(){return this._viewport},setBufferGCInterval:function(I){this._bufferGCInterval=I},_doBufferGC:function(o,p){var i,f,$=o._bufPool,A=0,u=0,Q=o._renderInfo.frame,G=this._bufferGCInterval||10;for(i in $)A++,f=$[i],f&&(p||Q-f._fid>G?(o.deleteBuffer(f._buf),f._buf=null,$[i]=null):u++);if(A/2>u&&A>128){var v={};for(i in $)$[i]&&(v[i]=$[i]);o._bufPool=v}o._validBufCount=u},_swapLineMap:function(){var K=this;nj=K._polylineModelMap,K._polylineModelMap=K._polylineModelMapSwap,K._polylineModelMapSwap=nj,nj=K._wireframeModelMap,K._wireframeModelMap=K._wireframeModelMapSwap,K._wireframeModelMapSwap=nj,nj=K._polylineIndexMap,K._polylineIndexMap=K._polylineIndexMapSwap,K._polylineIndexMapSwap=nj,nj=K._wireframeIndexMap,K._wireframeIndexMap=K._wireframeIndexMapSwap,K._wireframeIndexMapSwap=nj},_updateSkyBox:function(W){if(this._skyBox&&W){var t=W.property,o=!1,$=this._skyBox;if("eye"===t||"forceUpdate"===t){var m=this._eye;$.p3(m[0],m[1],m[2]),o=!0}if("near"===t||"far"===t||"forceUpdate"===t){var d=this._near,Z=this._far,H=$.getFinalScale3d();if(H[0]/=2,H[1]/=2,H[2]/=2,H[0]<=d||H[0]>=Z||H[1]<=d||H[1]>=Z||H[2]<=d||H[2]>=Z){var f=2*d*Z/(d+Z),J=Math.min(H[0],H[1],H[2]),R=f/J,D=$.getScale3d();$.setScale3d(D[0]*R,D[1]*R,D[2]*R),o=!0}}o&&this.invalidateData($)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(I){var Z=this._skyBox;Z&&(this._skyBoxStyleMap&&Z.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&Z.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&Z.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=I,this.ump(this._updateSkyBox,this),I&&(I.dm()&&I.dm().remove(I),this._skyBoxStyleMap=P.Default.clone(I.getStyleMap()),this._skyBoxAnchor3d=I.getAnchor3d(),I.setAnchor3d(.5,.5,.5),this._skyBoxP3=I.p3().slice(0),I.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",Z,I)},drawSky:function(a,C,g){var h=this,c=h._skyBox;if(c){var U=h._headlightIntensity,V=Lc(h._headlightColor),C=h._prg;1!==U&&(V=[V[0]*U,V[1]*U,V[2]*U]),_m(a,C.uHeadlightColor,[V[0],V[1],V[2],1]);var X=h.getData3dUI(c);if(X){var F,q=h.isOrtho(),G=q||this._computedProjectMatrix;G&&(F=h._projectMatrix,q&&(h._ortho=!1),_m(a,C.uPMatrix,h._projectMatrix=Sh(h,!0)));var N=c.p3(),_=this._eye;(N[0]!==_[0]||N[1]!==_[1]||N[2]!==_[2])&&(c._position.x=_[0],c._54O=_[1],c._position.y=_[2]),X._42(a,C,g,function(){return!0}),G&&(q&&(h._ortho=!0),_m(a,C.uPMatrix,h._projectMatrix=F))}a.clear(a.DEPTH_BUFFER_BIT),_m(a,C.uHeadlightColor,[V[0],V[1],V[2],h._headlightDisabled?1:0])}},_95I:function(m,a,$,G,e){function D(_){if(!(!_.s("alwaysOnTop")&&!_.s("shape3d.alwaysOnTop"))==!!e&&w.isVisible(_)&&(!H||s)){if(!$&&w.isTransparentMask(_))return;var D=w.getData3dUI(_);D&&D._42(m,a,$,S)}}var w=this,S=function(E){return G?E:!E};w.sky&&m.clear(m.DEPTH_BUFFER_BIT);var X=w.drawFilter;X?w.dm().each(function(d){X(d)||D(d)}):w.dm().each(function(B){D(B)})},getLogicalPoint:function(a){return Uc(a,this._canvas)},isRectOverlapping:function($){var X=this.getData3dUI($);return X._rectOverlapping},getHitFaceInfo:function(k){k.target&&(k=this.lp(k));var R=this.getDataInfoAt(k);if(R){var L=this._1o.face(R.data,fd(k.x,k.y));if(L)return{data:R.data,face:L}}return A},unproject:function(H,d){var g=this,D=g.getWidth(),V=g.getHeight(),F=H.target?g.lp(H):H,U=F.x-D/2,h=F.y-V/2,b=2*(U/D),u=2*(-1*h/V);d=d||0;var M=om(),p=Sh(g),R=Tl(g);Vg(M,p,R),nr(M);var I=Nr([b,u,d,1],M);return[I[0]/I[3],I[1]/I[3],I[2]/I[3]]},getDataAt:function(I){var U=this.getDataInfoAt(I);return U?U.data:A},getDataInfoAt:function(E,s){return E.target&&(E=this.lp(E)),this._1o.get(fd(E.x,E.y,s),!0)},getDatasInRect:function(u){return this._1o.get(u)},setEditable:function(z){var i=this,e=i._editable;i._editable=z,this.fp(tr,e,z)},isEditable:function(g){var e=this;return g?e._editable?$o(g)?g.s("3d.editable")?e._editableFunc?e._editableFunc(g):!0:!1:!1:!1:e._editable},isSelectable:function(X){return X.s("3d.selectable")&&this.sm().isSelectable(X)},isMovable:function(I){var x=this;return cn(I)&&I.getStyle(km)!==od?!1:I.s("3d.movable")?x._movableFunc?x._movableFunc(I):!0:!1},isSizeEditable:function($){return $o($)?this._sizeEditableFunc?this._sizeEditableFunc($):!0:!1},isRotationEditable:function(Z){return $o(Z)&&Z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Z):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(z){this.setZoom(bh,z)},zoomOut:function(K){this.setZoom(1/bh,K)},setZoom:function(){var T=new ps,S=new ps,l=new ps,r=new ps;return function(K,s){if(1!==K){var m=this;m._14o&&m._14o.stop(!0);var A,w=1/K;T.copy(m.getCenter()),S.copy(m.getEye());var t=m._ortho;if(t){if(A=m._orthoWidth,A<m._moveStep&&K>1)return}else if(T.distanceTo(S)<m._moveStep&&1>w)return;var E=!1;return m._zoomToCenter===!1&&m._lastZoomLP&&(l.copy(S).sub(T).normalize(),m._81O=null,r.copy(m.getHitPosition(m._lastZoomLP,T.toArray(),l.toArray())),E=!0,m._lastZoomHit=r),(s=Rf(s))?(s.action=function(h){m.fi({kind:m._zooming?"betweenZoom":"beginZoom"}),m._zooming=1;var $=(w-1)*h+1;t&&m.setOrthoWidth(A*$),E?(m.setEye(l.lerpVectors(r,S,$).toArray()),m.setCenter(l.lerpVectors(r,T,$).toArray())):t||m.setEye(l.lerpVectors(T,S,$).toArray())},s._37o=function(){delete m._14o,delete m._zooming,m.fi({kind:"endZoom"}),m.onZoomEnded()},m._14o=_c(s)):(t&&m.setOrthoWidth(A*w),E?(m.setEye(l.lerpVectors(r,S,w).toArray()),m.setCenter(l.lerpVectors(r,T,w).toArray())):t||m.setEye(l.lerpVectors(T,S,w).toArray()),void 0)}}}(),setOrthoZoom:function(k,N){return this.setZoom(k,N)},getPositionInfo:function(t){var j=this,h=j._eye,i=j._center,e=j.getAspect(),p=t?Hi(Nm(i,h,!0),Nm(t,h)):np(h,i);if(j._ortho){var k=j._orthoWidth;return{length:p,height:k/e,width:k}}var n=2*r(j._fovy/2)*p;return{length:p,height:n,width:n*e}},getCenterInfo:function(){var x=this;return x._81O||(x._81O=x.getPositionInfo()),Cc(x._81O)},rotate:function(K,s,e,f){var H=this;if(K||s){f==A&&(f=H._firstPersonMode),H._88O&&H._88O.stop(!0);var y=H._center,$=H._eye,J=H.getCenterInfo().length,g=f?y:$,X=f?$:y,z=Nm(g,X),d=o(z[0],z[2]),C=o(D(z[0]*z[0]+z[2]*z[2]),z[1]),G=f?Le:Fe;return f&&(s=-s),(e=Rf(e))?(e.action=function(I){H.fi({kind:H._rotating?"betweenRotate":"beginRotate"}),H._rotating=1;var c=d+K*I,e=C+s*I;e=f?O-Wl(O-e):Wl(e),z[0]=J*j(e)*j(c),z[1]=J*E(e),z[2]=J*j(e)*E(c),g[0]=X[0]+z[0],g[1]=X[1]+z[1],g[2]=X[2]+z[2],H.fp(G,A,g)},e._37o=function(){delete H._88O,delete H._rotating,H.fi({kind:"endRotate"}),H.onRotateEnded()},H._88O=_c(e)):(d+=K,C+=s,C=f?O-Wl(O-C):Wl(C),z[0]=J*j(C)*j(d),z[1]=J*E(C),z[2]=J*j(C)*E(d),g[0]=X[0]+z[0],g[1]=X[1]+z[1],g[2]=X[2]+z[2],H.fp(G,A,g),void 0)}},pan:function(U,y,X,n){if(U||y){var L=this;n==A&&(n=L._firstPersonMode),L._89O&&L._89O.stop(!0);var j=Tl(L),Z=[j[0]*U,j[4]*U,j[8]*U],N=[j[1]*y,j[5]*y,j[9]*y],I=Z[0]+N[0],w=Z[1]+N[1],V=Z[2]+N[2],C=L._center,R=L._eye;if(n){var g=Jj(L.getBoundaries(),R[0],R[2],R[0]+I,R[2]+V,D(I*I+V*V));I=g[0],V=g[1]}if(X=Rf(X)){var G=Cc(R),B=Cc(C);return X.action=function(K){L.fi({kind:L._panning?"betweenPan":"beginPan"}),L._panning=1,C[0]=B[0]+I*K,C[1]=B[1]+w*K,C[2]=B[2]+V*K,R[0]=G[0]+I*K,R[1]=G[1]+w*K,R[2]=G[2]+V*K,L.fp(Fe,A,R),L.fp(Le,A,C)},X._37o=function(){delete L._89O,delete L._panning,L.fi({kind:"endPan"}),L.onPanEnded()},L._89O=_c(X)}C[0]+=I,C[1]+=w,C[2]+=V,R[0]+=I,R[1]+=w,R[2]+=V,L.fp(Fe,A,R),L.fp(Le,A,C)}},walk:function(M,g,y){if(M){var P=this;y==A&&(y=P._firstPersonMode),P._90O&&P._90O.stop(!0);var h=P._center,j=P._eye,Y=Nm(h,j,!0);
if(y){var S=Jj(P.getBoundaries(),j[0],j[2],j[0]+Y[0]*M,j[2]+Y[2]*M,T(M));if(M=np(S),!M)return;Y=[S[0]/M,0,S[1]/M]}if(g=Rf(g)){var Z=Cc(j),f=Cc(h);return g.action=function(T){P.fi({kind:P._walking?"betweenWalk":"beginWalk"}),P._walking=1;var d=M*T;j[0]=Z[0]+Y[0]*d,j[1]=Z[1]+Y[1]*d,j[2]=Z[2]+Y[2]*d,h[0]=f[0]+Y[0]*d,h[1]=f[1]+Y[1]*d,h[2]=f[2]+Y[2]*d,P.fp(Fe,A,j),P.fp(Le,A,h)},g._37o=function(){delete P._90O,delete P._walking,P.fi({kind:"endWalk"}),P.onWalkEnded()},P._90O=_c(g)}j[0]+=Y[0]*M,j[1]+=Y[1]*M,j[2]+=Y[2]*M,h[0]+=Y[0]*M,h[1]+=Y[1]*M,h[2]+=Y[2]*M,P.fp(Fe,A,j),P.fp(Le,A,h)}},handleScroll:function(c,m){c.preventDefault();var n=this,f=n._moveStep,R=n.getDataInfoAt(c);if(R){var t=R.data;if(t&&n.isInteractive(t)){var x=n.intersectObject(c,t);if(x){var b=x.part,Q=Ef(t.s(b+".image")||t.s("shape3d."+b+".image")||t.s("all.image")||t.s("shape3d.image"));if(Q&&_d(Q.scrollable,t,n))return}}}return n.isFirstPersonMode()?(n.isPannable()&&n.pan(0,m>0?f:-f),void 0):(n.isZoomable()&&(n._lastZoomLP=n.lp(c),n.setZoom(0>m?1/Ic:Ic),n._lastZoomLP=n._lastZoomHit=null),void 0)},handlePinch:function(_,t){if(this.isZoomable()){if(Math.abs(_-t)<b.pinchZoomThreshold)return;this.setZoom(t>_?1/zi:zi)}},reset:function(){this.setCenter(b.graph3dViewCenter),this.setEye(b.graph3dViewEye),this.setUp(b.graph3dViewUp)},moveSelection:function(T,N,f){var y=this;y.dm().beginTransaction(),un(this.sm().toSelection(this.isMovable,this),T,N,f),y.dm().endTransaction()},getMoveMode:function(b,c){var r=c.s("3d.move.mode");if(r)return r;var k="88",D="89",B="90";return kj(b)||de[k]&&de[D]&&de[B]?"xyz":de[k]&&de[D]?"xy":de[k]&&de[B]?"xz":de[D]&&de[B]?"yz":de[k]?"x":de[D]?"y":de[B]?"z":"xz"},handleTick:function(){var e=this,y=!1,W=e._moveStep,T=W,c=!1,$=!0,K=e._rotateStep*($?-1:1);if(e.isWalkable()||(T=0),e.isPannable()||(W=0),e.isRotatable()||(K=0),e._32Q){var x=(mr()-e._32Q)/50;T*=x,W*=x,K*=x}e._31Q&&($p(e._31Q),delete e._31Q,delete e._32Q),Tk()&&(y=!0,e.pan(-W,0,c,$)),Jh()&&(y=!0,e.pan(W,0,c,$)),Km()&&(y=!0,kj()?e.pan(0,W,c,$):e.walk(T,c,$)),Pe()&&(y=!0,kj()?e.pan(0,-W,c,$):e.walk(-T,c,$)),el()&&(y=!0,e.rotate(-K,0,c,$)),cg()&&(y=!0,e.rotate(K,0,c,$)),Pk()&&(y=!0,e.rotate(0,-K/2,c,$)),Dd()&&(y=!0,e.rotate(0,K/2,c,$)),y&&(e._32Q=mr(),e._31Q=Wg(e.handleTick,e))},handleKeyDown:function(h){var Z=this;!Kc(h)&&im[h.keyCode]?Z.handleTick():wg(h)?Z.selectAll():hp(h)?Z.handleDelete(h):Kn(h)&&this.isResettable()&&Z.reset()},checkDoubleClickOnNote:function(L,d,Q){var v=this;if(Q===Up){if(d.s("note.toggleable"))return d.s(dp,!d.s(dp)),v.fi({kind:"toggleNote",event:L,data:d,part:Q}),!0}else if(Q===Ql&&d.s("note2.toggleable"))return d.s(Fh,!d.s(Fh)),v.fi({kind:"toggleNote2",event:L,data:d,part:Q}),!0;return!1},checkDoubleClickOnRotation:function(I,P,m){return m===cb?(P.setRotationX(0),!0):m===Mp?(P.setRotationY(0),!0):m===ip?(P.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(X){var g=this;if(g.isOrtho())return g.getWidth()/g.getOrthoWidth();var i=g.getCenter(),e=g.getHeight(),E=g.getEye(),L=[i[0]-E[0],i[1]-E[1],i[2]-E[2]],t=[X[0]-E[0],X[1]-E[1],X[2]-E[2]],y=Math.sqrt(L[0]*L[0]+L[1]*L[1]+L[2]*L[2]),j=1/Math.tan(g.getFovy()/2);return e*y*j/(t[0]*L[0]+t[1]*L[1]+t[2]*L[2])},inViewSpace:function(W){var q,r=this,G=r._transformPointToViewSpace(W),X=r.getAspect(),x=r.getNear(),f=r.getFar();return-G[2]<x||-G[2]>f?!1:r.isOrtho()?(q=r.getOrthoWidth()/2,Math.abs(G[0])<=q&&Math.abs(G[1]*X)<=q):(q=Math.sqrt(G[0]*G[0]+G[1]*G[1]+G[2]*G[2])*Math.tan(r.getFovy()/2),Math.abs(G[1]<=q)&&Math.abs(G[0])<=q*X)},getPVMatrix:function(){var t=this,n=t.getWidth()/2,z=t.getHeight()/2,w=t._18Q;return w&&w._wh===n/z||(w=Sh(t),t._18Q=Vg(w,w,Tl(t)),t._18Q._wh=n/z),w},getFrustum:function(){var G=new Xd,q=new mp,f=new Array(16);return function(){for(var R=this.getPVMatrix(),_=!1,V=0;16>V;V++)R[V]!==f[V]&&(_=!0,f[V]=R[V]);return _&&q.setFromMatrix(G.fromArray(R)),q}}(),toViewPosition:function(s){var j=this,U=j.getWidth()/2,d=j.getHeight()/2,Q=j.getPVMatrix();return s=Nr([s[0],s[1],s[2],1],Q),{x:U+U*s[0]/s[3],y:d-d*s[1]/s[3],z:s[2]/s[3]}},getHitPosition:function(f,e,S){var b=this,J=b.getWidth(),W=b.getHeight(),Z=f.target?b.lp(f):f,n=Z.x-J/2,p=Z.y-W/2,d=b.getCenterInfo(),A=Tl(b);e=e?e:[0,0,0],S=S?S:[0,1,0],n=n/J*d.width,p=-1*p/W*d.height;var I=[A[0]*n,A[4]*n,A[8]*n],x=[A[1]*p,A[5]*p,A[9]*p],P=[I[0]+x[0],I[1]+x[1],I[2]+x[2]],G=b.getCenter(),r=li(b,e,S,[P[0]+G[0],P[1]+G[1],P[2]+G[2]]);return r?r:[0,0,0]},intersectObject:function(x,s){return this._raycaster.intersectObject(x,s)},intersectObjects:function(n,v,s){return this._raycaster.intersectObjects(n,v,s)},getLineLength:function(v){this.validate();var I=this.getData3dUI(v);if(I&&I.getCache){var E=I.getCache();if(E)return E[E.length-1].length}return 0},getLineOffset:function(U,V){var u=this.getData3dUI(U);if(u&&u.getCache){var I=u.getCache();if(I){var H=Ar(I,V);if(!U.r3)return H;var R=U.r3();if(0===R[0]&&0===R[1]&&0===R[2])return H;var Q=new ps(U.p3()),S=new ps(H.point).sub(Q),W=new ps(H.tangent).add(S),Y=(new Ep).setFromEuler(new ai(R,U.getRotationMode(),!0));return S.applyQuaternion(Y),W.applyQuaternion(Y),{point:S.add(Q),tangent:W.sub(S).normalize()}}}return A},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(q,F,d){var w=this,O=w.getEye();O=[O[0],O[1],O[2]];var E=w.getCenter();if(E=[E[0],E[1],E[2]],q||(q=O),F||(F=E),w._flyAnim&&w._flyAnim.stop(!0),d=Rf(d),!d)return w.setEye(q[0],q[1],q[2]),w.setCenter(F[0],F[1],F[2]),delete w._flyAnim,!0;var v=[q[0]-O[0],q[1]-O[1],q[2]-O[2]],M=[F[0]-E[0],F[1]-E[1],F[2]-E[2]];return d.action=function(T){w.setCenter(E[0]+M[0]*T,E[1]+M[1]*T,E[2]+M[2]*T),w.setEye(O[0]+v[0]*T,O[1]+v[1]*T,O[2]+v[2]*T)},d._37o=function(){delete w._flyAnim},w._flyAnim=_c(d)},flyTo:function(){function H(O,F,h){if(h instanceof P.Node){x.fromArray(ro(h,F.getMat(h)));var N=h.getAnchor3d();O.push((new ps).set(0-N.x,0-N.y,0-N.z).applyMatrix4(x)),O.push((new ps).set(0-N.x,0-N.y,1-N.z).applyMatrix4(x)),O.push((new ps).set(0-N.x,1-N.y,0-N.z).applyMatrix4(x)),O.push((new ps).set(0-N.x,1-N.y,1-N.z).applyMatrix4(x)),O.push((new ps).set(1-N.x,0-N.y,0-N.z).applyMatrix4(x)),O.push((new ps).set(1-N.x,0-N.y,1-N.z).applyMatrix4(x)),O.push((new ps).set(1-N.x,1-N.y,0-N.z).applyMatrix4(x)),O.push((new ps).set(1-N.x,1-N.y,1-N.z).applyMatrix4(x))}}var E=new ps,W=new ps,k=new ps,R=new ps,x=new Xd,f=new P.Math.Quaternion,r=new ai;return function(c,Q,b){var q=this;if(b!==e)Q={animation:Q,ratio:b};else{var v=typeof Q;("boolean"===v||"object"===v&&Q.duration)&&(Q={animation:Q})}Q=Q||{},E.fromArray(q.getEye()),W.fromArray(q.getCenter());var X,g,A=[],n=Q.center,Y=Q.distance===e;if(n&&k.fromArray(n),c instanceof P.Node)n||k.fromArray(c.p3()),Y&&(H(A,q,c),X=A.length);else{if(c||(c=q.dm().getDatas()),!c.length)return;if((Y||!n)&&(A=[],c.forEach(function(o){H(A,q,o)}),X=A.length,!X))return;if(!n){for(k.set(0,0,0),g=0;X>g;g++)k.add(A[g]);k.multiplyScalar(1/X)}}if(q.setCenter(k.x,k.y,k.z),R.subVectors(E,W),Q.direction||Q.worldDirection){!Q.worldDirection&&c instanceof P.Node?f.setFromEuler(r.set(c.r3(),c.getRotationMode(),!0)):f.set(0,0,0,1);var p=R.length();R.fromArray(Q.worldDirection||Q.direction).applyQuaternion(f).setLength(p)}var B=0;if(Y){var N,Z,F,b=Q.ratio||.8,i=Q.xRatio||b,C=Q.yRatio||b;if(q.isOrtho()){var J=-1/0;for(q._eye[0]=R.x+k.x,q._eye[1]=R.y+k.y,q._eye[2]=R.z+k.z,N=Sh(q),Vg(N,N,Tl(q)),g=0;X>g;g++)F=A[g],Z=Nr([F.x,F.y,F.z,1],N),J=Math.max(J,Math.max(Math.abs(Z[0])/i,Math.abs(Z[1])/C));B=q.getOrthoWidth()*J,R.add(k)}else{for(var d,m,j=q.getNear(),T=10;T--;){for(q._eye[0]=R.x+k.x,q._eye[1]=R.y+k.y,q._eye[2]=R.z+k.z,N=Sh(q),Vg(N,N,Tl(q)),d=!0,m=-1/0,g=0;X>g;g++){if(F=A[g],Z=Nr([F.x,F.y,F.z,1],N),Z[3]<j&&T){R.multiplyScalar(2),d=!1;break}m=Math.max(m,Math.max(Math.abs(Z[0])/i,Math.abs(Z[1])/C)-Z[3])}if(d)break}R.setLength(m+R.length()).add(k)}}else R.setLength(Q.distance).add(k);q._flyAnim&&q._flyAnim.stop(!0);var M=Rf(Q.animation);if(M){q.setEye(E.x,E.y,E.z),q.setCenter(W.x,W.y,W.z);var I=(new ps).subVectors(R,E),o=(new ps).subVectors(k,W);if(B)var x=q.getOrthoWidth();var z=new ps,V=new ps,u=M.action,K=M._37o,L=E.clone(),U=W.clone();return M.action=function(g,Q){z.copy(L).addScaledVector(I,g),V.copy(U).addScaledVector(o,g),q.setCenter(V.x,V.y,V.z),q.setEye(z.x,z.y,z.z),B&&q.setOrthoWidth((B-x)*g+x),u&&u(g,Q)},M._37o=function(){delete q._flyAnim,K&&K()},{lastEye:E,lastCenter:W,eye:R,center:k,orthoWidth:B,animation:q._flyAnim=_c(M)}}return q.setEye(R.x,R.y,R.z),B&&q.setOrthoWidth(B),delete q._flyAnim,{lastEye:E,lastCenter:W,eye:R,center:k,orthoWidth:B}}}(),getBoundingBox:function(){function K(M,Z,T){f.fromArray(ro(T,Z.getMat(T)));var y=T.getAnchor3d();M.push((new ps).set(0-y.x,0-y.y,0-y.z).applyMatrix4(f)),M.push((new ps).set(0-y.x,0-y.y,1-y.z).applyMatrix4(f)),M.push((new ps).set(0-y.x,1-y.y,0-y.z).applyMatrix4(f)),M.push((new ps).set(0-y.x,1-y.y,1-y.z).applyMatrix4(f)),M.push((new ps).set(1-y.x,0-y.y,0-y.z).applyMatrix4(f)),M.push((new ps).set(1-y.x,0-y.y,1-y.z).applyMatrix4(f)),M.push((new ps).set(1-y.x,1-y.y,0-y.z).applyMatrix4(f)),M.push((new ps).set(1-y.x,1-y.y,1-y.z).applyMatrix4(f))}var f=new Xd;return function(O){if(O=O||this.sm().getSelection(),O instanceof P.Node&&(O=[O]),0===O.length)return A;var Y=[];O.forEach(function(V){K(Y,this,V)},this);var B=[1/0,1/0,1/0],S=[-1/0,-1/0,-1/0];return Y.forEach(function(Z){B[0]=Math.min(Z.x,B[0]),B[1]=Math.min(Z.y,B[1]),B[2]=Math.min(Z.z,B[2]),S[0]=Math.max(Z.x,S[0]),S[1]=Math.max(Z.y,S[1]),S[2]=Math.max(Z.z,S[2])}),{min:B,max:S}}}()}),Kk.RenderEnv=function(H){this.gv=H,this.enable=!1},N.defineProperties(Kk.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(t){this._debugOn=t,this.capture&&this.capture()}}}),N.assign(Kk.RenderEnv.prototype,{renderEnvToCube:function(N,q,m,u){var i=this,l=i.gv;if(!N||!q||!m)return i.enable=!1,i._42=null,void 0;i.enable=!0;var a=Math.floor(u/N*q),x=l.getGL(),v=i._renderTargets;v?v.length<m&&(v=i._renderTargets=v.concat(new Array(m-v.length))):v=i._renderTargets=new Array(m);for(var R=0;m>R;R++)v[R]?v[R].setSize(x,u,a):v[R]=new Kk.RenderTarget(l,x,u,a);var L=!1;i.capture=function(){L=!0,l._42(),L=!1};var p=new ps,A=new ps,M=new ps,f=new ps,y=(new ps).setY(0),B=2*Math.PI/m,Q=N/2/Math.tan(Math.PI/m),I=2*Math.atan2(q/2,Q),V=N/q;i._42=function(X,H,N,u){var $=i._debugOn;if(!L&&!$)return!1;p.copy(l.getEye()),f.copy(l.getCenter()).sub(p);var q=Math.atan2(f.z,f.x),O=l.getNear(),z=l.getFovy(),h=l.getAspect();A.copy(l.getCenter());for(var c,C=0;m>C;C++)if(c=v[C],y.setZ(Math.cos(q)).setX(Math.sin(q)).multiplyScalar(Q),q-=B,M.addVectors(p,y),l.setNear(Q),l.setCenter([M.x,M.y,M.z]),l.setFovy(I),l.setAspect(V),$){var t=Math.round(H/m);X.viewport(t*C,0,t,N),u()}else Wi(X,c.frame),X.viewport(0,0,c.width,c.height),X.clear(X.COLOR_BUFFER_BIT),u(),vs(X),c.assureTexture();return l.setNear(O),l.setCenter([A.x,A.y,A.z]),l.setFovy(z),l.setAspect(h),!0},i.capture()},getTextureInfo:function(T){var E=this._renderTargets;if(!E)return null;var t=this._renderTargets[T];return t?{index:T,texture:t.texture,textureName:t.uuid}:null}}),N.assign(Kk.Graph3dView.prototype,{renderEnvToCube:function(S,k,M,H){var y=this;y.envRenderer||(y.envRenderer=new Kk.RenderEnv(y)),y.envRenderer.renderEnvToCube(S,k,M,H)}}),Kk.RenderTarget=function(R,F,x,e,M){var i=this;M=M||{},M.samples=Math.min(R._glCapabilities.maxSamples,M.samples&&M.samples>1&&2===R._webGLVersion?M.samples:0),i.options=M,i.uuid=P.Math.generateUUID(),i.gv=R,i.init(R,F,M),M.samples&&!R._glCapabilities._maxSamplesChecked?i.setSize(F,x||1,e||1):i.setSize(F,x,e)},N.assign(Kk.RenderTarget.prototype,{bind:function(D){Wi(D,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(s){vs(s),this.options.samples&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,this._MSAAFbo),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.frame),s.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,s.COLOR_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null))},init:function(s,u,G){var k=this,Z=k.texture=u.createTexture();u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,Z);var Y=G.samples,q=Y?u.NEAREST:u.LINEAR;u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,G.minFilter||q),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,G.magFilter||q),u.bindTexture(u.TEXTURE_2D,null),k.render=u.createRenderbuffer(),k.frame=u.createFramebuffer(),s._2O[k.uuid]=Z},assureTexture:function(){var e=this,N=e.uuid,F=e.gv._2O;F[N]||(F[N]=e.texture)},setSize:function(n,r,l){var u=this;if(r&&l&&(u.width!==r||u.height!==l)){var G=n.RGBA,X=n.TEXTURE_2D,j=n.RENDERBUFFER,U=n.FRAMEBUFFER,a=u.options.samples;if(Th(n,u.texture),n.texImage2D(X,0,G,r,l,0,G,n.UNSIGNED_BYTE,A),Lh.isPOT(r)&&Lh.isPOT(l)&&!u.options.clampToEdge?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),n.bindRenderbuffer(j,u.render),a){var J=u.gv._glCapabilities;if(J._maxSamplesChecked)n.renderbufferStorageMultisample(j,a,n.DEPTH_COMPONENT16,r,l);else{for(n.getError();a>1&&(n.renderbufferStorageMultisample(j,a,n.DEPTH_COMPONENT16,r,l),n.getError());)a=Math.floor(a>>1);1>=a&&(a=0,n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,u.options.minFilter||n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,u.options.magFilter||n.LINEAR),n.renderbufferStorage(j,n.DEPTH_COMPONENT16,r,l)),J._maxSamplesChecked=!0,J.maxSamples=u.options.samples=a}}else n.renderbufferStorage(j,n.DEPTH_COMPONENT16,r,l);a&&!u._MSAAFbo&&(u._MSAAFbo=n.createFramebuffer(),u._MSAARbO=n.createRenderbuffer()),Wi(n,u.frame),n.framebufferTexture2D(U,n.COLOR_ATTACHMENT0,X,u.texture,0),a||n.framebufferRenderbuffer(U,n.DEPTH_ATTACHMENT,j,u.render),vs(n),a&&(n.bindRenderbuffer(n.RENDERBUFFER,u._MSAARbO),n.renderbufferStorageMultisample(n.RENDERBUFFER,a,n.RGBA8,r,l),Wi(n,u._MSAAFbo),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,u._MSAARbO),n.framebufferRenderbuffer(U,n.DEPTH_ATTACHMENT,j,u.render),vs(n)),Th(n,A),n.bindRenderbuffer(j,A),u.width=r,u.height=l}},toCanvas:function(){var h=this,k=h.gv.getGL();Wi(k,h.frame);var J=h.width,f=h.height,C=new Uint8Array(4*J*f);k.readPixels(0,0,J,f,k.RGBA,k.UNSIGNED_BYTE,C),vs(k);var F=x.createElement("canvas");F.width=J,F.height=f;var W=F.getContext("2d"),o=W.createImageData(J,f);return o.data.set(C),W.putImageData(o,0,0),F}});var ak=Kk.Interactor=function(I){this.gv=this.g3d=I};Lm("Interactor",N,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Zq=Kk.DefaultInteractor=function(L){yf(Zq,this,[L])};Lm("DefaultInteractor",ak,{getDataInfoAt:function(z,N){var l=this.gv,R=l.getDataInfoAt(z);if(!l.isBlockSelectable()||!R||!R.data)return R;if(!N&&l.isSelected(R.data))return R;for(var U=R.data;(U=U.getParent())&&U instanceof P.Block&&l.isSelectable(U);){var S=l.isSelected(U);if(S&&N)break;if(R={data:U,part:R},S&&!N)break}return R},handle_contextmenu:function(e){Rj(e)},handle_mousewheel:function(V){this.gv.handleScroll(V,V.wheelDelta/40)},handle_DOMMouseScroll:function(H){2===H.axis&&this.gv.handleScroll(H,-H.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(U){Rj(U);var j=this,z=j.gv,r=Qf(U),X=j.getDataInfoAt(U),L=X?X.data:A,O=X?X.part:A,_=z.sm(),W=nl(U),o=xs(U);z.setFocus(U)&&(j._62O=A,j._57I=A,j.pendingClickThrough=A,j.__lastClientPoint__=nq(U),L?Kc(U)?_.co(L)?_.rs(L):_.as(L):_.co(L)?L instanceof zm&&L.isClickThroughEnabled()&&Qf(U)&&(j.pendingClickThrough=nq(U)):_.ss(L):r&&(Kc(U)?z.isRectSelectable()&&(j._62O=tm):j._57I=nq(U)),j._31Q&&($p(j._31Q),delete j._31Q,delete j._32Q),j._62O||(z.isFirstPersonMode()&&(kj(U)||vk(U)||o>2?j._62O="pan":z.isMouseRoamable()||Sp(U)?(j._62O="roaming",j.foward=W&&Qf(U),j._32Q=mr(),j._31Q=Wg(j.tick,j)):r||(j._62O="roaming")),j._62O||(r&&W&&Ao[O]?(j._62O=O,j.p3=L.p3()):r&&W&&$o(L)&&z.isSelected(L)?z.isMovable(L)?(j._62O="move",j.p3=L.p3(),j.movedata=L):z._39Q(L)&&(j._62O="none"):Sp(U)&&(o>2?j._62O="pan":2===o&&(j.dist=Xl(U),j._62O="pinch")))),j.point=z.lp(U),qf(j,U),or(U)?z.handleDoubleClick(U,L,O):z.handleClick(U,L,O))},tick:function(){var E=this,n=E.gv,W=n._moveStep;E.point&&n.isWalkable()&&(E._32Q&&(W*=(mr()-E._32Q)/50),n.walk(E.foward?W:-W),E._32Q=mr(),E._31Q=Wg(E.tick,E))},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(P){var K=this._57I;if(K&&(np(K,nq(P))<=1&&this.gv.sm().cs(),this._57I=A),K=this.pendingClickThrough){if(np(K,nq(P))<=1){var F=this.getDataInfoAt(P);F&&F.data instanceof zm&&F.data.isClickThroughEnabled()&&(F=this.getDataInfoAt(P,!0),F&&(P.clickThrough=!0,this.gv.sm().ss(F.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(J){var x,$,e=this,B=e.gv,Z=e._62O,Q=e.point,t=B.dm(),Y=B.lp(J),X=Y.x-Q.x,q=Y.y-Q.y,G=B.getWidth(),H=B.getHeight();if(G&&H){var p=nq(J),k=tg(B,p,e.__lastClientPoint__),l=np({x:0,y:0},k),u=-U*X/G,R=-U*q/H;if("roaming"===Z)e.rotate(J,u/2,R/2);else if(Z===cb||Z===Mp||Z===ip)B._86O||t.beginTransaction(),B.fi({kind:B._86O?"betweenEditRotation":"beginEditRotation",event:J}),B._86O=1,B.sm().each(function(Q){if($o(Q)&&B.isRotationEditable(Q)){var L=T(u)>T(R)?u:R;Z===cb?Q.setRotationX(Q.getRotationX()+L):Z===Mp?Q.setRotationY(Q.getRotationY()+L):Z===ip&&Q.setRotationZ(Q.getRotationZ()+L)}});else if("move"===Z||Ao[Z]){if(Z===Sd||Z===sm||Z===Lo)B._87O||t.beginTransaction(),B.fi({kind:B._87O?"betweenEditScale":"beginEditScale",event:J}),B._87O=1;else{if(!B._moving){if(l<b.touchMoveThreshold)return;t.beginTransaction()}B.fi({kind:B._moving?"betweenMove":"beginMove",event:J}),B._moving=1}var r,I=e.p3,h=B.getPositionInfo(I),j=Tl(B);r=Z===Tq?"x":Z===Br?"y":Z===_n?"z":Z===Sd?"sx":Z===sm?"sy":Z===Lo?"sz":B.getMoveMode(J,e.movedata),X=X/G*h.width,q=-1*q/H*h.height;var M,A,c=[j[0]*X,j[4]*X,j[8]*X],P=[j[1]*q,j[5]*q,j[9]*q],g=c[0]+P[0],i=c[1]+P[1],N=c[2]+P[2],_=[I[0]+g,I[1]+i,I[2]+N],L=Nm(B.getEye(),_,!0);if("xyz"===r?(M=_,B.moveSelection(g,i,N)):"xz"===r?(M=li(B,I,[0,1,0],_),M&&B.moveSelection(M[0]-I[0],0,M[2]-I[2])):"xy"===r?(M=li(B,I,[0,0,1],_),M&&B.moveSelection(M[0]-I[0],M[1]-I[1],0)):"yz"===r?(M=li(B,I,[1,0,0],_),M&&B.moveSelection(0,M[1]-I[1],M[2]-I[2])):"x"===r||"sx"===r?(L[0]=0,M=li(B,I,L,_),M&&(A=M[0]-I[0],"x"===r?B.moveSelection(A,0,0):B.sm().each(function(U){$o(U)&&B.isSizeEditable(U)&&(x=U.getScaleX()+A/100,$=x/U.getScaleX(),U.setScaleX(x),kj(J)&&(U.setScaleY(U.getScaleY()*$),U.setScaleTall(U.getScaleTall()*$)))}))):"y"===r||"sy"===r?(L[1]=0,M=li(B,I,L,_),M&&(A=M[1]-I[1],"y"===r?B.moveSelection(0,A,0):B.sm().each(function(m){$o(m)&&B.isSizeEditable(m)&&(x=m.getScaleTall()+A/100,$=x/m.getScaleTall(),m.setScaleTall(x),kj(J)&&(m.setScaleY(m.getScaleY()*$),m.setScaleX(m.getScaleX()*$)))}))):("z"===r||"sz"===r)&&(L[2]=0,M=li(B,I,L,_),M&&(A=M[2]-I[2],"z"===r?B.moveSelection(0,0,A):B.sm().each(function(t){$o(t)&&B.isSizeEditable(t)&&(x=t.getScaleY()+A/100,$=x/t.getScaleY(),t.setScaleY(x),kj(J)&&(t.setScaleX(t.getScaleX()*$),t.setScaleTall(t.getScaleTall()*$)))}))),!M)return;e.p3=M}else if(Z===tm){var o=e.div;o||(o=e.div=ob(),Ho(e.getView(),o),o.op=Q,o.style.background=B.getRectSelectBackground()),B.fi({kind:B._rectSelecting?"betweenRectSelect":"beginRectSelect",event:J}),B._rectSelecting=1,o.rect=mo(o.op,Y),di(o,o.rect)}else if("pinch"===Z&&2===xs(J)){B.fi({kind:B._pinching?"betweenPinch":"beginPinch",event:J}),B._pinching=1;var A=Xl(J);B._lastZoomLP||(B._lastZoomLP=nn(J)),B.handlePinch(A,e.dist),e.dist=A}else"pan"===Z||kj(J)||vk(J)?e.pan(J,X,q):"none"===Z||B.isFirstPersonMode()||e.rotate(J,u,R);e.point=Y}},pan:function(z,o,m){var U=this.gv;if(U.isPannable()){var M=U.getWidth(),i=U.getHeight();if(!M||!i)return;var b=U.getCenterInfo(),H=o/M*b.width,u=-1*m/i*b.height;U.fi({kind:U._panning?"betweenPan":"beginPan",event:z}),U._panning=1,U.pan(-H,-u)}},rotate:function(m,e,U){var u=this.gv;u.isRotatable()&&(u.fi({kind:u._rotating?"betweenRotate":"beginRotate",event:m}),u._rotating=1,u.rotate(e,U))},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(f){var e=this,Y=e.gv,V=Y.dm(),s=e.div;if(s){var y=Y.getDatasInRect(s.rect);if(!y.isEmpty()){var z=Y.sm(),U=z.toSelection();y.each(function(A){z.co(A)?U.remove(A):U.add(A)}),z.ss(U)}Sc(s)}Y._moving&&(delete Y._moving,Y.fi({kind:"endMove",event:f}),Y.onMoveEnded(),V.endTransaction()),Y._panning&&(delete Y._panning,Y.fi({kind:"endPan",event:f}),Y.onPanEnded()),Y._rotating&&(delete Y._rotating,Y.fi({kind:"endRotate",event:f}),Y.onRotateEnded()),Y._86O&&(delete Y._86O,Y.fi({kind:"endEditRotation",event:f}),V.endTransaction()),Y._87O&&(delete Y._87O,Y.fi({kind:"endEditScale",event:f}),V.endTransaction()),Y._pinching&&(delete Y._pinching,Y.fi({kind:"endPinch",event:f}),Y.onPinchEnded()),Y._rectSelecting&&(delete Y._rectSelecting,Y.fi({kind:"endRectSelect",event:f}),Y.onRectSelectEnded()),Y._walking&&(delete Y._walking,Y.fi({kind:"endWalk",event:f}),Y.onWalkEnded()),Y._lastZoomLP=Y._lastZoomHit=null,e.dist=e.point=e._62O=e.p3=e.movedata=e.div=e._57I=e.pendingClickThrough=e._32Q=e._31Q=e.foward=A,e.__lastClientPoint__=A}});var eo=Kk.MapInteractor=function(m){yf(eo,this,[m]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Lm("MapInteractor",ak,{handle_contextmenu:function(a){Rj(a)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(i){2===i.axis&&this.gv.handleScroll(i,-i.detail)},handle_keydown:function(D){this.gv.handleKeyDown(D)},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(k){Rj(k);var e=this,Y=e.gv;if(Y.setFocus(k)){var B=Y.getDataInfoAt(k),h=B?B.data:A,E=B?B.part:A,i=e.editing={point:Y.lp(k)};Sp(k)?i.touch=!0:(i.touch=!1,i.clickLeft=Qf(k),i.pan=vk(k)?!0:"left"===this.panButton===i.clickLeft),h&&Y._39Q(h)&&(i.preventDefault=!0),qf(e,k),or(k)?Y.handleDoubleClick(k,h,E):Y.handleClick(k,h,E)}},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(){},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(Y){var x=this,s=x.gv,S=x.editing;if(S){var F=s.lp(Y),W=S.point,p=F.x-W.x,e=F.y-W.y;if(!S.moved){if(Math.abs(p)<x.threshold&&Math.abs(e)<x.threshold&&!(Y.touches&&Y.touches.length>1))return;S.moved=!0}if(!S.preventDefault)if(S.point=F,S.touch){var C=Y.touches.length;if(2!==C)x.pan(Y,p,e);else{if(1>=C)return;var t=Y.touches,u={x:t[0].clientX,y:t[0].clientY},c={x:t[1].clientX,y:t[1].clientY},E={x:c.x-u.x,y:c.y-u.y},K=S.lastCenter,h=Math.atan2(E.y,E.x),n=S.theta,Z=0;n==A?n=S.theta=h:(Z=h-n,S.thetaStarted||Math.abs(Z)>x.touchRotateThreshold?(S.thetaStarted=!0,S.theta=h):Z=0);var k=O*(u.y+c.y)/2/s.getHeight(),r=S.phi,v=0;r==A?r=S.phi=k:(v=k-r,S.phiStarted||Math.abs(v)>x.touchRotateThreshold?(S.phiStarted=!0,S.phi=k):v=0);var f,I=Math.sqrt(E.x*E.x+E.y*E.y),V=S.vlen;if(V){var g=u.x-K.x,M=u.y-K.y,L=c.x-K.x,T=c.y-K.y,o=Math.sqrt(g*g+M*M),b=Math.sqrt(L*L+T*T),G=V/2,D=x._sign2(o-G),R=x._sign2(b-G);0>D*R||0===D&&0===R?(f=1,S.vlen=I):(f||(f=I/V),S.scaleStarted||Math.abs(f-1)>x.touchScaleThreshold?(S.vlen=I,S.scaleStarted=!0):f=1)}else V=S.vlen=I,f=1;1!==f&&s.setZoom(f),(v||Z)&&x.rotate(Y,Z,-v),S.lastCenter={x:(c.x+u.x)/2,y:(c.y+u.y)/2}}}else if(S.pan)x.pan(Y,p,e);else{var X=s.getWidth(),w=s.getHeight();if(!X||!w)return;var d=-U*p/X,B=-U*e/w;x.rotate(Y,d,B)}}},_sign2:function(w){return Math.abs(w)<this._touchScaleCheckAccuracy?0:w>0?1:-1},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(E){var K=this,k=K.editing;if(K.editing=null,k){var u=K.gv;if(k.moved||!k.clickLeft&&!k.touch)u._panning=null,u._rotating=null,u.fi({kind:k.pan?"endPan":"endRotate",event:E});else{var I=u.getDataAt(E);I?u.sm().setSelection([I]):u.sm().clearSelection()}}},pan:function(E,B,D){var v=this,y=v.gv;if(y.isPannable()){var R=y.getWidth(),K=y.getHeight();if(R&&K){var M=y.getCenterInfo(),p=-B/R*M.width,m=1*D/K*M.height;y.fi({kind:y._panning?"betweenPan":"beginPan",event:E}),y._panning=1;var N=v.keepHorizon,e=v.editing.touch;if((e&&E.touches&&E.touches.length>1||!e&&kj(E))&&(N=!N),!N)return y.pan(p,m);if(p||m){var U=Tl(y),Z=[U[0]*p,U[4]*p,U[8]*p],q=[U[1],0,U[9]],x=Math.sqrt(q[0]*q[0]+q[2]*q[2]);x&&(q=[q[0]/x*m,0,q[2]/x*m]);var G=Z[0]+q[0],f=Z[1]+q[1],$=Z[2]+q[2],V=y._center,l=y._eye;V[0]+=G,V[1]+=f,V[2]+=$,l[0]+=G,l[1]+=f,l[2]+=$,y.fp(Fe,A,l),y.fp(Le,A,V)}}}},rotate:function(u,e,K){var Y=this,E=Y.gv;if(E.isRotatable()){var O=E._center,h=E._eye,B=Nm(h,O),I=o(D(B[0]*B[0]+B[2]*B[2]),B[1]),H=Wl(I+K);K=H-I,E.fi({kind:E._rotating?"betweenRotate":"beginRotate",event:u}),E._rotating=1,E.rotate(e,K)}}}),N.defineProperties(eo.prototype,{panButton:{get:function(){return this._panButton},set:function(f){this._panButton=f}},minPhi:{get:function(){return b.graph3dViewMinPhi},set:function(u){b.graph3dViewMinPhi=u}},maxPhi:{get:function(){return b.graph3dViewMaxPhi},set:function(L){b.graph3dViewMaxPhi=L}},keepHorizon:{get:function(){return this._keepHorizon},set:function(b){this._keepHorizon=b}},threshold:{get:function(){return this._threshold},set:function(n){this._threshold=n}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(v){this._touchScaleThreshold=v}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(M){this._touchRotateThreshold=M}}});var Yb,ko="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Ie=32,iq=Kk.GlobeInteractor=function(x,D){yf(iq,this,[x]);var U,b=D.radius||6378137,k=this,p=null;Yb||(Yb=ob(),Yb.style.border="",Yb.style.backgroundImage="url("+ko+")");var c=new Ep,m=new ps,r=new ps,z=new ps,Z=new fr,Y="number"==typeof b?{x:b,y:b,z:b}:b,H={center:new ps(0,0,0),radius:Y},L=function(i){x._81O=null;var U=x.getHitPosition(i,x.getCenter(),m.copy(x.getEye()).sub(r.copy(x.getCenter())).toArray());return Z.origin.copy(x.getEye()),Z.direction.copy(U).sub(Z.origin).normalize(),Z.intersectEllipsoid(H)},X=function(y,l){x._81O=null,Z.origin.copy(x.getEye());for(var O,b,d=x.getCenter(),V=m.copy(x.getEye()).sub(r.copy(x.getCenter())).toArray(),g=1,T=16,f=0,a=1,o={x:0,y:0};T--;){if(o.x=l.x+(y.x-l.x)*g,o.y=l.y+(y.y-l.y)*g,O=x.getHitPosition(o,d,V),Z.direction.copy(O).sub(Z.origin).normalize(),b=Z.intersectEllipsoid(H),b&&1===g)return{hit:b};b?f=g:a=g,g=(f+a)/2}return{hit:b,out:1>g}},K=function(f,q){if(p){var k=Date.now();p.deltaTime=p.lastTime?k-p.lastTime:1e3,p.lastTime=k,p.lastAxis=f,p.lastAngle=q}q&&(c.setFromAxisAngle(f,q),x.setEye(m.copy(x.getEye()).applyQuaternion(c).toArray()),x.setCenter(m.copy(x.getCenter()).applyQuaternion(c).toArray()),x.setUp(m.copy(x.getUp()).applyQuaternion(c).toArray()))};k._showCrossIcon=function($){Ho(k.getView(),Yb),di(Yb,{x:$.clientX-Ie/2,y:$.clientY-Ie/2,width:Ie,height:Ie})},k._hideCrossIcon=function(){Sc(Yb)},k._scrollImpl=function(H,o){p={point:x.lp(H),screen:nq(H),hit:L(H),type:"right"},p.hitNormalize=p.hit?p.hit.clone().normalize():new ps;var Q={clientX:p.screen.x,clientY:p.screen.y+10*o};k._handleMoveImpl(Q),k._endMoveImpl(Q)},k._startMoveImpl=function(O){U&&(U.stop(!0),U=null),p={point:x.lp(O),screen:nq(O),hit:L(O)},p.hitNormalize=p.hit?p.hit.clone().normalize():new ps,Sp(O)?1===O.touches.length?p.hit&&(p.type="left"):2===O.touches.length&&(p.type="touch2"):(Qf(O)?p.hit&&(p.type="left"):ws(O)?p.type="right":vk(O)&&p.hit&&(p.type="middle"),!p.hit||"right"!==p.type&&"middle"!==p.type||k._showCrossIcon(O)),p.type&&qf(k,O)},k._handleMoveImpl=function(e){if(p)switch(p.type){case"left":return k._handleLeft(e);case"right":return k._handleRight(e);case"middle":return k._handleMiddle(e);case"touch2":return k._handleTouch2(e)}},k._endMoveImpl=function(){if(p){if(this._hideCrossIcon(),"left"===p.type||"middle"===p.type){var n=1e3*(p.lastAngle/(p.deltaTime||30)),a=p.lastAxis,q=p.lastTime,w=function(){var w=Date.now(),P=(w-q)/1e3;return q=w,n*=Math.pow(Math.abs(k.decelerationRate),3*P),Math.abs(n)<.01?(n=0,U&&U.stop(),void 0):(K(a,n*P),void 0)};U=_c({action:function(){w(arguments)},duration:5e3})}p=null}},k._handleLeft=function(x){if(!p.finished){var d=nq(x),i=X(d,p.lastScreen||p.screen);if(p.lastScreen=d,!i.hit)return p.finished=!0,k._endMoveImpl(x),void 0;var L=i.hit;L.normalize();var t=p.hitNormalize,b=Math.acos(L.dot(t)),F=L.cross(t).normalize();K(F,b),i.out&&(p.finished=!0,k._endMoveImpl(x))}},k._handleRight=function(e){var j=p.lastScreen||p.screen,q=j.y;j=p.lastScreen=nq(e);var X=j.y,M=X-q;if(M){var T=Math.min(.5,M*k.scaleSpeed);m.copy(x.getEye());var l=p.hit;l||(l=m.clone().divide(Y).normalize().multiply(Y)),r.copy(m).lerp(l,T),x.setEye(r.toArray()),m.copy(x.getUp()),r.normalize();var E=m.clone().cross(r).normalize();if(z.copy(x.getCenter()),z.sub(E.multiplyScalar(z.dot(E))),x.setCenter(z.toArray()),p.hit){var D=L(p.screen),f=p.hitNormalize;if(D){D.normalize();var t=Math.acos(D.dot(f)),_=D.cross(f).normalize();t&&K(_,t)}}}};var u=function($){return Math.abs($)<.01?0:$>0?1:-1};k._handleTouch2=function(Q){var t=Q.touches.length;if(2===t){var v=Q.touches,s={x:v[0].clientX,y:v[0].clientY},c={x:v[1].clientX,y:v[1].clientY},_={x:c.x-s.x,y:c.y-s.y},D=p.lastCenter,e=Math.atan2(_.y,_.x),w=p.theta,X=0;w==A?w=p.theta=e:(X=e-w,p.thetaStarted||Math.abs(X)>.03?(p.thetaStarted=!0,p.theta=e):X=0);var d,f=Math.sqrt(_.x*_.x+_.y*_.y),n=p.vlen;if(n){var z=s.x-D.x,m=s.y-D.y,S=c.x-D.x,k=c.y-D.y,E=Math.sqrt(z*z+m*m),V=Math.sqrt(S*S+k*k),C=n/2,I=u(E-C),O=u(V-C);0>I*O||0===I&&0===O?(d=1,p.vlen=f):(d||(d=f/n),p.scaleStarted||Math.abs(d-1)>.05?(p.vlen=f,p.scaleStarted=!0):d=1)}else n=p.vlen=f,d=1;var _=r.copy(x.getEye()).clone();1!==d&&x.setEye(_.setLength((_.length()-b)/d+b).toArray()),X&&K(_.normalize(),X),p.lastCenter={x:(c.x+s.x)/2,y:(c.y+s.y)/2}}},k._handleMiddle=function($){var f=nq($),b=p.screen;p.screen=f;var S=(f.y-b.y)/180*Math.PI*k.rollSpeed;r.copy(x.getCenter()).sub(m.copy(x.getEye())).normalize(),m.copy(x.getUp()).cross(r).normalize(),r.copy(x.getEye()).sub(p.hit).applyAxisAngle(m,S).add(p.hit);var s=r.clone();r.copy(x.getCenter()).sub(p.hit).applyAxisAngle(m,S).add(p.hit);var E=r.clone(),j=r.copy(x.getUp()).applyAxisAngle(m,S).clone(),w=!1;
S>0&&(z.copy(j),r.copy(E).sub(s).normalize(),m.copy(s).multiplyScalar(-1).normalize(),m.dot(z)-r.dot(z)>0&&(w=!0)),w||z.copy(p.hit).sub(s).dot(p.hitNormalize)>=0&&(w=!0),w||(x.setEye(s.toArray()),x.setCenter(E.toArray()),x.setUp(j.toArray()));var t=-(f.x-b.x)/180*Math.PI*k.rotateSpeed;K(p.hitNormalize,t)}};Lm("GlobeInteractor",ak,{handle_contextmenu:function(P){Rj(P)},handle_mousewheel:function(i){this._scrollImpl(i,i.wheelDelta/40)},handle_DOMMouseScroll:function(_){2===_.axis&&this._scrollImpl(_,-_.detail)},handle_keydown:function(z){this.gv.handleKeyDown(z)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(J){Rj(J);var D=this.gv;if(D.setFocus(J)){var _=D.getDataInfoAt(J),d=_?_.data:A;d&&D.isInteractive(d)||this._startMoveImpl(J);var q=_?_.part:A;or(J)?D.handleDoubleClick(J,d,q):D.handleClick(J,d,q)}},handle_mouseup:function(I){this.handle_touchend(I)},handle_touchend:function(){},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(N){this._handleMoveImpl(N)},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(X){this._endMoveImpl(X)}}),N.defineProperties(iq.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(S){this._rotateSpeed=S}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(L){this._rollSpeed=L}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(P){this._scaleSpeed=P}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function($){this._decelerationRate=$}}});var hr=function(T){this.gv=T};$g(hr,N,{_iv:!0,iv:function(){this._iv=!0},face:function(n,X){var L=this,U=L.gv.getGL();if(!U||!$o(n))return A;var D=L._resolution,V=Math.round(X.x*D),r=Math.ceil(X.width*D),S=Math.ceil(X.height*D),w=L.height-Math.round(X.y*D)-S,e=z(r/2),C=new Uint8Array(4*r*S),a=0;for(L.iv(),L.validate(n),Wi(U,L.frame),U.readPixels(V,w,r,S,U.RGBA,U.UNSIGNED_BYTE,C),vs(U),L.iv();e>=a;a++)for(var j=e-a,K=e+a,P=j;K>=P;P++)for(var Y=j;K>=Y;Y++)if(P===j||P===K||Y===j||Y===K){var u=qn.m[C[4*(P*r+Y)]];if(u)return u}},get:function(S,u){this.validate();var E=this,P=E.gv.getGL();if(!P)return A;var j,h,C=E._resolution,K=Math.round(S.x*C),O=Math.ceil(S.width*C),$=Math.ceil(S.height*C),L=E.height-Math.round(S.y*C)-$,Z=z(O/2),r=new Uint8Array(4*O*$),_=0,G=r.length,n=u?A:new Tr,v=u?A:{};if(Wi(P,E.frame),P.readPixels(K,L,O,$,P.RGBA,P.UNSIGNED_BYTE,r),vs(P),u){for(;Z>=_;_++)for(var T=Z-_,B=Z+_,f=T;B>=f;f++)for(var I=T;B>=I;I++)if((f===T||f===B||I===T||I===B)&&(j=E.info(r,4*(f*O+I))))return j}else for(;G>_;_+=4)j=E.info(r,_),j&&(h=j.data,v[h._id]||(n.add(h),v[h._id]=h));return n},info:function($,r){return this.colorMap[($[r]<<16)+($[r+1]<<8)+$[r+2]+((127&$[r+3])<<24)]},validate:function(x){var n=this,J=n.gv,r=J.getGL();if(r){var P=n._resolution=J._pickerResolution*J.getDevicePixelRatio(),v=Math.round(P*J.getWidth()),V=Math.round(P*J.getHeight()),C=r.RGBA,i=r.TEXTURE_2D,K=r.RENDERBUFFER,O=r.FRAMEBUFFER;n.texture||(n.texture=Xb(r),n.render=r.createRenderbuffer(),n.frame=r.createFramebuffer()),(n.width!==v||n.height!==V)&&(Th(r,n.texture),r.texImage2D(i,0,C,v,V,0,C,r.UNSIGNED_BYTE,A),Om(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.bindRenderbuffer(K,n.render),r.renderbufferStorage(K,r.DEPTH_COMPONENT16,v,V),Wi(r,n.frame),r.framebufferTexture2D(O,r.COLOR_ATTACHMENT0,i,n.texture,0),r.framebufferRenderbuffer(O,r.DEPTH_ATTACHMENT,K,n.render),Th(r,A),r.bindRenderbuffer(K,A),vs(r),n.width=v,n.height=V),n._iv&&(n._iv=!1,Wi(r,n.frame),J._42(x||(n.colorMap={}),P),vs(r))}}});var gn=function(g){this.gv=g};$g(gn,N,{gap:0,size:0,_42:function(t,x){var X=this,j=X.gv,b=j._gridGap,w=j._gridSize;if(j._gridVisible){if(X.gap!==b||X.size!==w){for(var F=[],I=j._gridSize/2,q=b*I,S=0;2*I+1>S;S++){var o=6*S,e=6*(2*I+1)+o;F[o]=-q,F[o+1]=0,F[o+2]=-q+S*b,F[o+3]=q,F[o+4]=0,F[o+5]=-q+S*b,F[e]=-q+S*b,F[e+1]=0,F[e+2]=-q,F[e+3]=-q+S*b,F[e+4]=0,F[e+5]=q}X.vs=new On(F),X.gap=b,X.size=w}Ae(j),ee(t,x),$k(t),bp(t,x,1,j._gridColor,j._buffer.vs,X.vs),Ui(t,0,X.vs.length/3,t.LINES),Kb(t),pe(t,x)}else X.vs=X.gap=X.size=A}});var Hj=function(A){this.gv=A};$g(Hj,N,{_42:function(L,Q){var K=this.gv,z=K._buffer.vs,g=K._axisXColor,G=K._axisYColor,B=K._axisZColor,y=K._originAxisVisible,D=K._centerAxisVisible;if(y||D){var Y=Yi?L.TRIANGLES:L.TRIANGLE_FAN,S=L.LINES;if(Ae(K),ee(L,Q),$k(L),y){var X=K.getCenterInfo(),E=C(X.width,X.height)/5,i=.8*E,l=.05*E;bp(L,Q,1.5,g,z,new On([0,0,0,E,0,0,i,l,0,i,0,l,i,-l,0,i,0,-l,i,l,0,0,0,0,0,E,0,l,i,0,0,i,l,-l,i,0,0,i,-l,l,i,0,0,0,0,0,0,E,l,0,i,0,l,i,-l,0,i,0,-l,i,l,0,i])),Ui(L,0,2,S),Ui(L,1,6,Y),bp(L,Q,A,G),Ui(L,7,2,S),Ui(L,8,6,Y),bp(L,Q,A,B),Ui(L,14,2,S),Ui(L,15,6,Y)}if(D){var O=K._center,P=O[0],x=O[1],e=O[2],X=K.getPositionInfo(O);E=C(X.width,X.height)/20,bp(L,Q,1.5,g,z,new On([P,x,e,P+E,x,e,P,x,e,P,x+E,e,P,x,e,P,x,e+E])),Ui(L,0,2,S),bp(L,Q,A,G),Ui(L,2,2,S),bp(L,Q,A,B),Ui(L,4,2,S)}Kb(L),pe(L,Q)}}});var _q=function(k){this.gv=k,this.onMouseOver=this.onMouseOver.bind(this),this.mode=_q.Mode.Style,this.color=e,this.width=e};_q.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},$g(_q,N,{onMouseOver:function(B){b.preventDefault(B);var d=this.gv.getDataAt(B);d!==this.mouseOverData&&(this.mouseOverData=d,this.gv.iv())},setFetchTargetFunc:function(Z){this.fetchTargetFunc=Z},_42:function(A,t){var D,F,N=this,n=N._mode,T=N.gv;if(!A._renderInfo.reflectDepth&&n!==_q.Mode.Disable){if(n===_q.Mode.Selection?D=T.sm().getSelection().toArray(function(O){return O.s("highlight.visible")}):n===_q.Mode.MouseOver&&N.mouseOverData&&N.mouseOverData.s("highlight.visible")&&(D=[N.mouseOverData]),N.fetchTargetFunc&&(D=N.fetchTargetFunc(D)),n===_q.Mode.Style)D=D||[],F=function(S){if(D.indexOf(S)>=0)return!1;var U=T.getDataHighlightMode(S);return U===!1?!0:U===!0?!1:"selected"===U?T.isSelected(S)?!1:!0:"hover"===U?S===N.mouseOverData?!1:!0:!0};else{if(!D||!D.length)return;F=function(x){return D.indexOf(x)<0?!0:void 0}}var J=T.vr.isPresenting(),p=T.getWidth();if(J){var $=T.getWidth;p/=2,T.getWidth=function(){return p};var Y=T.getViewport()}var O,R=T.getDevicePixelRatio(),s=p*R,l=T.getHeight()*R;(O=N._renderTarget)?O.setSize(A,s,l):N._renderTarget=O=new Kk.RenderTarget(T,A,s,l),Wi(A,O.frame),T.drawFilter=F,T._42({}),T.drawFilter=null,vs(A),Yi&&ar(A,t.aPosition),ar(A,t.aNormal),J&&(T.getWidth=$,T.setViewport(A,Y[0],Y[1],Y[2],Y[3]));var y=A._compiledShader.highlight;y||(y=A._compiledShader.highlight=new Sg.Shader(A,Lg.vs,Lg.fs)),y.bind(),A.enable(A.BLEND),A.activeTexture(A.TEXTURE0+0),A.bindTexture(A.TEXTURE_2D,O.texture),y.uniforms.image=0,y.uniforms.textureSize=[s,l],y.uniforms.edgeWidth=T.getHighlightWidth();var Q=T.getHighlightColor();if(N._lastHighlightColor!==Q){var m=qo(N._lastHighlightColor=Q);N._highlightColorData=[m[0]/255,m[1]/255,m[2]/255,m[3]/255]}y.uniforms.edgeColor=N._highlightColorData,N.ibuffer?(N.ibuffer.upload(),N.vbuffer.upload()):(N.ibuffer=Sg.Buffer.createIndexBuffer(A,new Uint16Array([0,2,1,1,2,3])),N.vbuffer=Sg.Buffer.createVertexBuffer(A,new Float32Array([0,0,1,0,0,1,1,1]))),y.attributes.pos.pointer(N.vbuffer),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0),A.disable(A.BLEND),A.bindTexture(A.TEXTURE_2D,null),A.useProgram(t),Yi&&Kh(A,t.aPosition)}}}),N.defineProperties(_q.prototype,{mode:{get:function(){return this._mode},set:function(W){var L=this._mode;W!==L&&(this._mode=W,W===_q.Mode.MouseOver||W===_q.Mode.Style?d(this.gv.getView(),"mousemove",this.onMouseOver):(L===_q.Mode.MouseOver||L===_q.Mode.Style)&&B(this.gv.getView(),"mousemove",this.onMouseOver))}}});var Lg={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},up=function(X){this.gv=X},Tq="edit_tx",Br="edit_ty",_n="edit_tz",cb="edit_rx",Mp="edit_ry",ip="edit_rz",Sd="edit_sx",sm="edit_sy",Lo="edit_sz",Ao={};Ao[Tq]=1,Ao[Br]=1,Ao[_n]=1,Ao[cb]=1,Ao[Mp]=1,Ao[ip]=1,Ao[Sd]=1,Ao[sm]=1,Ao[Lo]=1,$g(up,N,{_42:function(h,I,Q){var p=this,d=p.gv,X=d.sm().ld();if(X&&d.isEditable(X)&&!d.isEditHelperDisabled()&&$o(X)&&(!d.isFirstPersonMode()||!d.isMouseRoamable()&&!tc)){Ae(d);var y,C,b=d.isMovable(X),t=d.isRotationEditable(X),f=d.isSizeEditable(X),g=d._axisXColor,K=d._axisYColor,A=d._axisZColor,c=d._editSizeColor,v=X.p3(),O=np(d.getEye(),v)/10,l=O/(Q?5:10),k=.7*O,o=.4*k,z=v[0],R=v[1],W=v[2];y=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&p._17O(h,I,X,Q,Tq,g,y,[z,R-l,W,z+k,R-l,W,z+k,R,W,z+k,R,W,z,R,W,z,R-l,W,z,R-l,W+l,z+k,R-l,W+l,z+k,R-l,W,z+k,R-l,W,z,R-l,W,z,R-l,W+l]),C=z+k,f&&p._17O(h,I,X,Q,Sd,c,y,[C,R-l,W,C+o,R-l,W,C+o,R,W,C+o,R,W,C,R,W,C,R-l,W,C,R-l,W+l,C+o,R-l,W+l,C+o,R-l,W,C+o,R-l,W,C,R-l,W,C,R-l,W+l]),C+=o,t&&p._17O(h,I,X,Q,cb,g,y,[C,R-l,W,C+o,R-l,W,C+o,R,W,C+o,R,W,C,R,W,C,R-l,W,C,R-l,W+l,C+o,R-l,W+l,C+o,R-l,W,C+o,R-l,W,C,R-l,W,C,R-l,W+l]),y=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],b&&p._17O(h,I,X,Q,Br,K,y,[z,R,W,z,R+k,W,z-l,R+k,W,z-l,R+k,W,z-l,R,W,z,R,W,z,R,W,z,R,W-l,z,R+k,W-l,z,R+k,W-l,z,R+k,W,z,R,W]),C=R+k,f&&p._17O(h,I,X,Q,sm,c,y,[z,C,W,z,C+o,W,z-l,C+o,W,z-l,C+o,W,z-l,C,W,z,C,W,z,C,W,z,C,W-l,z,C+o,W-l,z,C+o,W-l,z,C+o,W,z,C,W]),C+=o,t&&p._17O(h,I,X,Q,Mp,K,y,[z,C,W,z,C+o,W,z-l,C+o,W,z-l,C+o,W,z-l,C,W,z,C,W,z,C,W,z,C,W-l,z,C+o,W-l,z,C+o,W-l,z,C+o,W,z,C,W]),y=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&p._17O(h,I,X,Q,_n,A,y,[z,R,W,z,R,W+k,z,R-l,W+k,z,R-l,W+k,z,R-l,W,z,R,W,z,R-l,W,z-l,R-l,W,z-l,R-l,W+k,z-l,R-l,W+k,z,R-l,W+k,z,R-l,W]),C=W+k,f&&p._17O(h,I,X,Q,Lo,c,y,[z,R,C,z,R,C+o,z,R-l,C+o,z,R-l,C+o,z,R-l,C,z,R,C,z,R-l,C,z-l,R-l,C,z-l,R-l,C+o,z-l,R-l,C+o,z,R-l,C+o,z,R-l,C]),C+=o,t&&p._17O(h,I,X,Q,ip,A,y,[z,R,C,z,R,C+o,z,R-l,C+o,z,R-l,C+o,z,R-l,C,z,R,C,z,R-l,C,z-l,R-l,C,z-l,R-l,C+o,z-l,R-l,C+o,z,R-l,C+o,z,R-l,C])}},_17O:function(r,y,N,W,J,p,i,n){var o=this.gv._buffer;lf(r,y,W,!0,N,J),Zn(r,y,A,!0,A,!0,A,!1),_m(r,y.uDiffuse,p),Xe(r,o.vs,new On(n),y.aPosition),Xe(r,o.ns,new On(i),y.aNormal),$k(r),Ui(r,0,12),Kb(r),Ti(r,y)}});var nc=P.Raycaster=function(d){this.gv=d,this.maxTriangleTest=1/0,this.backfaceCulling=!0};hh("Raycaster",N,{intersect:function(l){var D=this,X=D.gv,M=X.getDataAt(l);return M?D.intersectObject(l,M):null},intersectObjects:function(o,u,l){var L,q,Z,R,Q=this,K=1/0,H=o.origin||(new ps).fromArray(Q.gv.getEye()),N=Q.maxTriangleTest,S=[];return u.forEach(function(n){l&&l(n)===!1||n.s("intersect")!==!1&&S.push(n)}),S.sort(function(U,l){return H.distanceToSquared2(U.p3())-H.distanceToSquared2(l.p3())}),Q.countTriangles=0,S.forEach(function(O){Q.countTriangles>N||(L=Q.intersectObject(o,O),L&&(q=H.distanceToSquared(L.world),K>q&&(Z=O,R=L,K=q)))}),Q.countTriangles=0,{data:Z,intersect:R}},intersectObject:function(o,m){if(o instanceof fr)return this._intersectObjectImpl(o,m);var X=this,b=X.gv,h=b.unproject(o),T=new ps,N=b.getEye(),a=new ps;if(b.isOrtho()){var H=new ps(N);a.copy(b.getCenter()).sub(H).normalize();var y=T.copy(h).sub(H).dot(a);T.copy(a).setLength(-y).add(H.copy(h))}else T.copy(N),a.copy(h).sub(T).normalize();var S=new P.Math.Ray(T,a);return X._intersectObjectImpl(S,m)},_intersectObjectImpl:function(){function u(){var U=new ps;return U.subVectors(V,h),w.subVectors(Y,h),U.cross(w).normalize(),U}function W(S,H,I,y,M,T,w){return ms.barycoordFromPoint(S,H,I,y,i),M.multiplyScalar(i.x),T.multiplyScalar(i.y),w.multiplyScalar(i.z),M.add(T).add(w),M.clone()}function H(O,v,P){Fl(O)?O.forEach(function(y){H(y,v,P)}):nf(O)?H(Ri(v,O),v,P):Tp(O)?O.shape3d?H(O.shape3d,v,P):P.push(O):P.push(O)}var _=new Xd,b=new Xd,G=new fr,s=new ps,L=new ps,k=new ps,M=new ps,n=new ps,Y=new ps,h=new ps,V=new ps,v=new $j,y=new $j,c=new $j,w=new ps,S={vs:dl,is:Wd,uv:_i},i=new ps,Q=Gf.slice(0);return Q.push("csg"),function(o,K){var T=this.gv.getData3dUI(K),I=K.mat||T.mat;I?_.fromArray(I):_.identity(),b.getInverse(_),G.copy(o).applyMatrix4(b);var i,r,f,d="body",l=T.shapeModel;if(l||(l=Ri(T)),l||(P.CSGNode&&K instanceof P.CSGNode||P.CSGShape&&K instanceof P.CSGShape?(f=!0,l=[T.left,T.front,T.right,T.back,T.top,T.bottom,T.csg]):K instanceof P.Node&&!(K instanceof P.Shape)?(i=!0,l=S):(r=!0,l=[T.left,T.front,T.right,T.back,T.top,T.bottom])),!l)return console.log("Can not find shape model."),null;Fl(l)||(l=[l]);var x,Z,F,z,j,q,e,m,O,A,w,a,U,N,E,X,$=1/0,J=["","top_","bottom_"],p=!1,C=this.backfaceCulling,R=[];for(H(l,T,R),x=0,Z=R.length;Z>x;x++)if(U=R[x])for(F=0,z=J.length;z>F;F++)if(N=J[F],e=U[N+"vs"],m=U[N+"is"],O=U[N+"uv"]||U[N+"tuv"],e){if(E=U[N+"boundingBox"]){var w=G.intersectBox(E);if(!w)continue;if(G.origin.distanceTo(w)>$)continue;X=!1}else U[N+"boundingBox"]=E=new P.Math.Box3,X=!0;for(j=0,q=m?m.length:e.length/3;q>j;j+=3)this.countTriangles++,m?(L.fromArray(e,3*m[j]),k.fromArray(e,3*m[j+1]),M.fromArray(e,3*m[j+2])):(L.fromArray(e,3*j),k.fromArray(e,3*(j+1)),M.fromArray(e,3*(j+2))),X&&(E.expandByPoint(L),E.expandByPoint(k),E.expandByPoint(M)),A=G.intersectTriangle(L,k,M,C,s),A&&(a=G.origin.distanceTo(A),$>a&&($=a,n.copy(A),Y.copy(L),h.copy(k),V.copy(M),""!==N?d=N.slice(0,-1):i?d=Gf[Math.floor(j/6)]:r?d=Gf[x]:f&&(d=Q[x]),O&&(p=!0,m?(v.fromArray(O,2*m[j]),y.fromArray(O,2*m[j+1]),c.fromArray(O,2*m[j+2])):(v.fromArray(O,2*j),y.fromArray(O,2*(j+1)),c.fromArray(O,2*(j+2))))))}if(!isFinite($))return null;var t,D=n.clone().applyMatrix4(_);p&&(t=W(n,Y,h,V,v,y,c));var B=u(Y,h,V),g=u(Y.applyMatrix4(_),h.applyMatrix4(_),V.applyMatrix4(_)),ho=G.direction.dot(B);return ho>0&&(B.multiplyScalar(-1),g.multiplyScalar(-1)),{world:D,local:n.clone(),worldNormal:g,normal:B,uv:t,part:d}}}()});var wj=function(U,S){this.gv=U,this.s=function(N,B,k){return B==A&&(B=k),B==A?S.getStyle(N):_d(B,S,U)},this.data=S};$g(wj,N,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(N,V,B,z){var x,Z,J,R,U,o,W,s=this,r=s.data,v=s.gv,f=r._id,w=s.s("alwaysOnTop")||s.s("shape3d.alwaysOnTop")?null:s.s("batch"),c=v._batchIndexMap,i=v._batchModelMap,_=v.isSelectable(r),X=v.getBrightness(r),j=X!=A&&1!==X;if(wj.getTitle===e){wj.getTitle=0;for(var q in b)if(q.length===kd.length+1&&q[kd.length]===xo[4].toUpperCase()&&q[kd.length-1]===xo[kd.length+1].toUpperCase()){wj.getTitle=Li;break}}if(!wj.getTitle||zl[kd.length+2]){if(wj.getHead===e){wj.getHead=0;for(var q in Y){var g="box-sizing";if(6===q.length&&q[0]===xo[4]&&q[3]===g[0]&&q[4]===g[1]&&q[5]===g[2]){wj.getHead=Li;break}}}if(!wj.getHead||zl[kd.length]){if(s.needValidate(N)){J=Kd(c,i,r,w);var M=s.validate(J,w?fs[w]||pk:A);if(J&&(R=c[f],U=R.size=J.vs.length/3-R.begin,W=J.rs))for(X=j?X:1,o=0;U>o;o++)W.push(X);var h=v.getWireframeGeometry(r);if(h)um(v,r,h);else if($o(r)){var S=v.getWireframe(r);S&&um(v,r,S)}s.labelInfo=s.label2Info=s.noteInfo=s.note2Info=s._38o=A,s._24O(ls,"getLabel"),s._24O(kd,"getLabel2"),s._26O(Up,"getNote"),s._26O(Ql,"getNote2"),s._15O(),s.interactiveInfo=v.isInteractive(r)?{}:A,M!==!1&&(s._iv=!1)}j&&_m(N,V.uBrightness,X),_m(N,V.uAlphaTest,s.s("alphaTest")),_m(N,V.uUseEnvMap,r.s("envmap")?!0:!1),_m(N,V.uReflectivity,r.s("envmap")||.01);var K=s.s("3d.clip.direction"),t=!0;if(K){var G=s.s("3d.clip.percentage");switch(0===G&&(t=!1),K){case"left":K=2;break;case"top":K=3;break;case"bottom":K=4;break;case"front":K=5;break;case"back":K=6;break;case"right":default:K=1}if(0===K%2&&(G=1-G),r instanceof P.Shape){var y=r.s3(),n=r.p3(),O=r.getAnchor3d();G=3>K?(G-O.x)*y[0]+n[0]:5>K?(G-O.y)*y[1]+n[1]:(G-O.z)*y[2]+n[2]}else G-=.5;_m(N,V.uClipPercent,G)}N.uniform1i(V.uClipDirection,K||0),Z=lf(N,V,B,_,r,_o),Z&&(ri(Z,c[f],i),ri(Z,v._polylineIndexMap[f],v._polylineModelMap),ri(Z,v._wireframeIndexMap[f],v._wireframeModelMap)),!c[f]&&t&&s._80o(N,V,z),v.isLabelVisible(r)&&((x=s.labelInfo)&&(lf(N,V,B,_,r,ls),s._28O(x,ls,z)),(x=s.label2Info)&&(lf(N,V,B,_,r,kd),s._28O(x,kd,z))),v.isNoteVisible(r)&&((x=s.noteInfo)&&(lf(N,V,B,_,r,Up),s._29O(x,Up,z)),(x=s.note2Info)&&(lf(N,V,B,_,r,Ql),s._29O(x,Ql,z))),(x=s._38o)&&s._99O(N,V,x,B,_,z),j&&_m(N,V.uBrightness,1),K&&N.uniform1i(V.uClipDirection,0)}}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ts},_80o:function(){},dispose:function(){},getBodyColor:function(F){var M=this.data,o=this.gv.getBodyColor(M);return o?o:F?M.getStyle(F):A},getCachedTexture:function(A){var N=this._cachedTextures;return N?N[A||"main"]:null},setCachedTexture:function(A,r){var U=this._cachedTextures;return U||(U=this._cachedTextures={}),U[r||"main"]=A,A},invalidateCachedTexture:function(y){var a=this._cachedTextures;for(var J in a)y.deleteTexture(a[J]);this._cachedTextures={}},invalidateCachedGeometry:function(){},_24O:function(M,i){var z=this,w=z.data,D=z.gv,J=z.s,o=D[i](w);if(o!=A){var I=J(M+".scale"),N=J(M+".max"),v=z[M+"Info"]={label:o,textureScale:J(M+".texture.scale"),color:D[i+"Color"](w),font:J(M+".font"),align:J(M+".align"),background:D[i+"Background"](w)},T=v.rect=an(v,o);N>0&&N<T.width&&(v.labelWidth=T.width,T.width=N),T.x=T.y=0,T.width*=I,T.height*=I,v.mat=z._16O(J(M+".autorotate"),J(M+".position"),T,J(M+".face"),J(M+".t3"),J(M+".r3"),J(M+".rotationMode"));var q=T.width/2,E=T.height/2;v.vs=new On([-q,E,0,-q,-E,0,q,-E,0,q,E,0]),T.width/=I,T.height/=I}},_26O:function(e,I){var C=this,Y=C.data,V=C.gv,r=C.s,s=V[I](Y);if(s!=A){var f=r(e+".scale"),W=this[e+"Info"]={note:s,textureScale:r(e+".texture.scale"),expanded:r(e+".expanded"),font:r(e+".font"),color:r(e+".color"),align:r(e+".align"),borderWidth:r(e+".border.width"),borderColor:r(e+".border.color"),background:V[I+"Background"](Y)};if(W.expanded){var E=r(e+".max"),z=an(W,s);z.width+=6,z.height+=2,E>0&&E<z.width&&(W.labelWidth=z.width,z.width=E);var P={x:-z.width/2,y:-8-z.height,width:z.width,height:z.height+8}}else P={x:-6,y:-18,width:12,height:18};W.mat=C._16O(r(e+".autorotate"),r(e+".position"),A,r(e+".face"),r(e+".t3"),r(e+".r3"),r(e+".rotationMode")),W.rect=P,1!==f&&(P=Cc(P),P.x*=f,P.height*=f,P.y=-P.height,P.width*=f);var H=P.x,h=P.y,T=P.width,M=P.height;W.vs=new On([H,-h,0,H,-h-M,0,H+T,-h-M,0,H+T,-h,0])}},_28O:function(v,b,w){if(w(this.s(b+".transparent"))){var m=v.rect,l=v.textureScale,R=m.width*l,x=m.height*l;if(R>=1&&x>=1){var B=Zj(R,x);1!==l&&(B.translate(B,m.x,m.y),B.scale(l,l),B.translate(B,-m.x,-m.y)),Hb(B,v),B.restore(),xb(this,b,v.mat,v.vs,!0)}}},_29O:function($,d,n){if(n(this.s(d+".transparent"))){var c=$.rect,X=$.textureScale,K=c.x,Z=c.y,u=c.width*X,U=c.height*X;if(u>=1&&U>=1){c.x=c.y=0;var V=Zj(u,U);1!==X&&V.scale(X,X),Wm(V,$),V.restore(),c.x=K,c.y=Z,xb(this,d,$.mat,$.vs,!1)}}},_99O:function(z,j,i,Q,E,O){if(i){var T=this,b=T.gv,H=T.data,W=b._buffer,y=b._1O,q=i.icons;for(var n in q){var X=q[n],I=i.rects[n];if(I&&O(_d(X.transparent,H,b))){lf(z,j,Q,E,H,n);var t=_d(X.shape3d,H,b),N=t?[t]:_d(X.names,H,b),w=N?N.length:0,p=_d(X.textureScale,H,b)||1,Y=_d(X.light,H,b);Y==A&&(Y=t?!0:!1),Zn(z,j,_d(X.blend,H,b),Y,_d(X.opacity,H,b),_d(X.reverseFlip,H,b),_d(X.reverseColor,H,b),_d(X.reverseCull,H,b));for(var e=0;w>e;e++){var U=N[e],f=I[e];if(Yq(T,f.mat),t)Nb(b,H,Ri(T,t),T);else{var x=Ef(U);if(x){var m=f.width*p,S=f.height*p;if(m>=1&&S>=1){var v=Zj(m,S);Pf(v,x,_d(X.stretch,H,b),0,0,m,S,H,b),v.restore(),Xb(z,Vr,y),$k(z,j,y,_d(X.discardSelectable,H,b),W.uv,Rm),Xe(z,W.vs,f.vs,j.aPosition),kl(z,W.ns,Dk,j.aNormal),oe(z,W.is,Bq),fh(z,0,Bq.length),Kb(z,j,y)}}}gs(b)}Ti(z,j)}}}}});var Fr=function(j,M){yf(Fr,this,[j,M])};$g(Fr,wj,{_16O:function(y,B,V,i,n,d,U,T,Z){var $=this.data,Q=$.getFinalScale3d(),M=mi(B,Q,V,i,T,Z);if($.hasOwnProperty("_anchor")||$.hasOwnProperty("_anchorElevation")){var e=$.getAnchor3d();M[0]-=(e.x-.5)*Q[0],M[1]-=(e.y-.5)*Q[1],M[2]-=(e.z-.5)*Q[2]}return pb(om(),M,$.p3(),i,n,d,U,y,$.getFinalRotation3d(),$.getRotationMode())},clear:function(){var k=this;k.faceMat=k.mat=k.shapeModel=k.left=k.right=k.front=k.back=k.top=k.bottom=k.csg=A},needValidate:function(k){if(this._iv)return this._validateFrameId=k._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var Z=k._renderInfo.frame;if(this._validateFrameId!==Z)return this._validateFrameId=Z,!0}return!1},validate:function(W,Q){var a=this,r=a.gv,L=a.data,N=a.shapeName=a.s(lc),M=Ri(a,N);a._updateAutoRotation(),a._updateFixSize2d(),a._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(xg(r,L,"_wireframeModelMap","_wireframeIndexMap"),xg(r,L,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var x=ro(L,r.getMat(L),M?a.s("shape3d.scaleable"):!0);if(L.appendAnchorMatrix3d(x),L.mat=x,a.clear(),M||!N)if(W){var K=[];M?kr(r,L,M,a,a.getBodyColor(),[x],W,K):(Gj(r,L,W,Q,x,Rc,K,Pd),Gj(r,L,W,Q,x,Pc,K,Gd),Gj(r,L,W,Q,x,Oe,K,Nh),Gj(r,L,W,Q,x,fl,K,ss),Gj(r,L,W,Q,x,Kg,K,ys),Gj(r,L,W,Q,x,gl,K,Ce)),K.length&&(oj(W.vs,K),oj(W.ns,Dn(K)))}else a.mat=x,(a.shapeModel=M)||(a._cubeUvs=null,a.vf(Rc,0),a.vf(Pc,16),a.vf(Kg,8),a.vf(gl,24),a.vf(Oe,32),a.vf(fl,40))},_updateAutoRotation:function(){var e=new ai,F=new Xd,g=new ps,h=new ps,z=new ps;return function(){var I=this,Y=I.data,L=I.s("autorotate")||I.s("shape3d.autorotate");if(!L)return Y._dynamicRotation&&delete Y._dynamicRotation,void 0;var Z=I.gv;z.copy(I.s("shape3d.autorotate.up")||Z._up);var n;n="string"==typeof L?[L.indexOf("x")<0?Z._eye[0]:Z._center[0],L.indexOf("y")<0?Z._eye[1]:Z._center[1],L.indexOf("z")<0?Z._eye[2]:Z._center[2]]:Z._eye;var q=Z._center,S=Y.p3();g.copy(S),h.set(n[0]-q[0],n[1]-q[1],n[2]-q[2]).add(g),F.lookAt(h,g,z),e.set(0,0,0,Y.getRotationMode(),!0).setFromRotationMatrix(F);var M=Y._dynamicRotation;M&&Math.abs(M[0]-e.x)<1e-5&&Math.abs(M[1]-e.y)<1e-5&&Math.abs(M[2]-e.z)<1e-5||(Y._dynamicRotation=[e.x,e.y,e.z])}}(),_updateFixSize2d:function(){var P=this,a=P.data,t=P.s("fixSizeOnScreen")||P.s("shape3d.fixSizeOnScreen");if(!t)return a._dynamicScale3d&&delete a._dynamicScale3d,void 0;var I=P.gv,H=ro(a,I.getMat(a)),m=rm([0,0,0],H),s=I.toViewPosition(m);if(!isNaN(s.x)&&!isNaN(s.y)){var e=rm([1,0,0],H),o=I.toViewPosition(e),X=rm([0,1,0],H),$=I.toViewPosition(X),Q=o.x-s.x,x=$.y-s.y;if(Q&&x){var z,y,C=a._dynamicScale3d||[1,1,1],K=Ef(a.s("shape3d.image"));if(t[0]>0&&(z=t[0]),t[1]>0&&(y=t[1]),!z||!y){var J=t>0?t:1;z||(z=(pl(K,a)||a.getWidth())*J),y||(y=(Vf(K,a)||a.getTall())*J)}var q=Math.abs(Q/z),w=Math.abs(x/y);Math.abs(q-1)<.001&&Math.abs(w-1)<.001||(a._dynamicScale3d=[C[0]/q,C[1]/w,C[2]])}}},_updateOverlapping:function(){var x=this,m=x.s("hide.overlapping.group");if(!m)return x._rectOverlapping&&(x._rectOverlapping=e),void 0;var H,Z,Y,o=x.gv,M=x.data,O=ro(M,o.getMat(M)),B=1/0,K=1/0,l=-1/0,D=-1/0,z=M.getAnchor3d(),f=z.x,s=z.y,$=z.z;for(H=0;8>H;H++){if(Z=rm([(H>>2)-f,(1&H>>1)-s,(1&H)-$],O),Y=o.toViewPosition(Z),isNaN(Y.x)||isNaN(Y.y))return;B=Math.min(B,Y.x),l=Math.max(l,Y.x),K=Math.min(K,Y.y),D=Math.max(D,Y.y)}var I={x:B,y:K,w:l-B,h:D-K};x._rectOverlapping=o.overlappingBox.isOverlapping(m,I)},getVectorDynamicSize:function(){var x,E=this,q=E.s("shape3d"),$=E.data;if("billboard"===q||"plane"===q||(x=$._currentCubeElementId)!=A){var X,f,H=E.gv,B=ro($,H.getMat($)),p=$.getAnchor3d(),L=.5-p.x,F=.5-p.y,a=.5-p.z,y=E.s("vector.dynamic.maxsize"),t=function(G,K){G[0]+=L,G[1]+=F,G[2]+=a,K[0]+=L,K[1]+=F,K[2]+=a;var v=H.toViewPosition(rm(G,B)),f=H.toViewPosition(rm(K,B)),p=v.x-f.x,o=v.y-f.y;return Math.min(y,Math.sqrt(p*p+o*o))};if("billboard"===q)X=t([-.5,0,0],[.5,0,0]),f=t([0,-.5,0],[0,.5,0]);else if("plane"===q)X=t([-.5,0,0],[.5,0,0]),f=t([0,0,-.5],[0,0,.5]);else if($._currentCubeElementId!=A){var m=3*Wd[x+1],l=3*Wd[x],V=3*Wd[x+2];X=t([dl[m],dl[m+1],dl[m+2]],[dl[V],dl[V+1],dl[V+2]]),f=t([dl[m],dl[m+1],dl[m+2]],[dl[l],dl[l+1],dl[l+2]])}return[X,f]}},vf:function(i,X){var z=this;if(z.gv.getFaceVisible(z.data,i)){var I=xc(z,i);I.mat&&(z.faceMat=!0);var y=I.uv;if(y){var E=z._cubeUvs;E||(E=z._cubeUvs=new On([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var c=0;8>c;c++)E[X+c]=y[c]}return I}},_billboardInView:function(){var z=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],S=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],V=new Jo,k=new ps,F=new Xd;return function(X){var Y=this;if(!Y.mat)return!0;var a=Y.gv.getFrustum(),N="billboard"===X?z:S;V.makeEmpty(),F.fromArray(Y.mat);for(var y=0,R=N.length;R>y;y+=3)V.expandByPoint(k.fromArray(N,y).applyMatrix4(F));return a.intersectsBox(V)}}(),_80o:function(q,O,v){var K=this;if(K._rectOverlapping)return!0;var W=K.shapeModel;if(W||!K.shapeName){var i=K.s("shape3d");if(("billboard"===i||"plane"===i)&&!K._billboardInView(i))return!0;var C=K.gv,Q=K.data,Z=C._cube;Ae(C,K.mat),K.s("shape3d.reflector")&&!q._picking||(W?Nb(C,Q,W,K,K.getBodyColor(),v):(Xe(q,Z.vs,A,O.aPosition),Xe(q,Z.ns,A,O.aNormal),Rd(q,Z.is),K._18O(q,O,"left",0,v),K._18O(q,O,"front",6,v),K._18O(q,O,"right",12,v),K._18O(q,O,"back",18,v),K._18O(q,O,"top",24,v),K._18O(q,O,"bottom",30,v))),gs(C),K.faceMat&&(K._18O(q,O,"left",0,v,!0),K._18O(q,O,"front",6,v,!0),K._18O(q,O,"right",12,v,!0),K._18O(q,O,"back",18,v,!0),K._18O(q,O,"top",24,v,!0),K._18O(q,O,"bottom",30,v,!0))}},_18O:function(z,J,g,I,N,Y){var p=this[g];if(p){if(!N(p.transparent))return;if(Y&&!p.mat||!Y&&p.mat)return;var k=this.data.s("polygonOffset");k&&hl(z,k),Y&&Ae(this.gv,p.mat);var b=this,E=b.data;E._currentCubeElementId=I;var o=b.gv,W=o.getTexture(p.texture,E,g),F=p.uv,l=p.uvScale,w=p.uvOffset,d=p.discardSelectable;W?F?$k(z,J,W,d,o._buffer.uv,b._cubeUvs,w,l):$k(z,J,W,d,o._cube.uv,A,w,l):$k(z),Zn(z,J,p.blend,p.light,p.opacity,p.reverseFlip,p.reverseColor,p.reverseCull),_m(z,J.uDiffuse,p.color||n["color.empty"]),fh(z,I,6),Ti(z,J),Kb(z,J,W),Y&&gs(o),k&&dm(z),E._currentCubeElementId=null}},drawReflector:function(){var o=new ps,h=new ps,H=new ai,m=new Xd,T=new ps,p=new ps,s=new ps,M=new ps,J=new Xd,Y=new Xd,I=new ji,c=new cq,u=new cq,t=function(p,w,S){p[S]=w[0],p[S+1]=w[1],p[S+2]=w[2]},r=function(d,m){t(d,m.getEye(),0),t(d,m.getCenter(),3),t(d,m.getUp(),6)},V=function(w,U){U._eye=[w[0],w[1],w[2]],U._center=[w[3],w[4],w[5]],U._up=[w[6],w[7],w[8]],U._18Q=A;var N=U._skyBox;N&&(N.p3([w[0],w[1],w[2]]),U.getData3dUI(N).iv())};return function(d,B,W,w,$){var Z=this;Z._reflectorInfo=null;var f=Z.data;if(f._reflecting)return!1;var U=Z.gv;if($)return!1;var x=Z._reflectorRenderTarget;x?x.setSize(d,B,W):x=Z._reflectorRenderTarget=new Kk.RenderTarget(U,d,B,W),o.copy(f.p3()),h.copy(U.getEye()),m.makeRotationFromEuler(H.set(f.r3(),f.getRotationMode(),!0));var X;if(!Z._reflectNormal){var X=Ri(Z,Z.s("shape3d"));if(!X)return!1;if(!X.ns&&X.length&&(X=X[0]),!X.ns||!X.vs)return!1;Z._reflectNormal=[X.ns[0],X.ns[1],X.ns[2]],Z._reflectorVbuffer=Sg.Buffer.createVertexBuffer(d,new Float32Array(X.vs))}if(T.copy(Z._reflectNormal),T.applyMatrix4(m),p.subVectors(o,h),p.dot(T)>0)return!1;p.reflect(T).negate(),p.add(o),s.copy(U.getCenter()).negate().add(o),s.reflect(T).negate(),s.add(o),M.copy(U.getUp()),M.reflect(T);var N=[0,0,0,0,0,0,0,0,0];r(N,U),U._eye=p.toArray(),U._center=s.toArray(),U._up=M.toArray(),U._18Q=A;var D=U._skyBox;D&&(D.p3(U._eye),U.getData3dUI(D).iv()),Wi(d,x.frame),d.viewport(0,0,x.width,x.height);var K=f.s("shape3d.reflector.background");if(K){var z=d.getParameter(d.COLOR_CLEAR_VALUE);Bp(d,K)}else d.clearColor(0,0,0,1);d.clear(d.COLOR_BUFFER_BIT);var l=Sh(U),q=Tl(U);I.setFromNormalAndCoplanarPoint(T,o),I.applyMatrix4(Y.fromArray(q)),c.set(I.normal.x,I.normal.y,I.normal.z,I.constant),u.x=(Math.sign(c.x)+l[8])/l[0],u.y=(Math.sign(c.y)+l[9])/l[5],u.z=-1,u.w=(1+l[10])/l[14],c.multiplyScalar(2/c.dot(u));var n=f.s("shape3d.reflector.clip"),i=n===e?.003:n;l[2]=c.x,l[6]=c.y,l[10]=c.z+1-i,l[14]=c.w;var P=U._computedProjectMatrix;U._computedProjectMatrix=l,f._reflecting=!0,w(),U._computedProjectMatrix=P,J.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),J.multiply(Y.fromArray(U._projectMatrix)),J.multiply(Y.fromArray(U._viewMatrix)),K&&Bp(d,z),vs(d),V(N,U);var k=d._compiledShader.reflector;return k||(k=d._compiledShader.reflector=new Sg.Shader(d,qi.Reflector.vs,qi.Reflector.fs)),k.bind(),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,x.texture),k.uniforms.tDiffuse=0,k.uniforms.color=Lc(f.s("shape3d.reflector.color")||"rgb(128,128,128)"),k.uniforms.textureMatrix=J.toArray(),k.uniforms.modelMatrix=ro(f),k.uniforms.viewMatrix=Tl(U),k.uniforms.projectionMatrix=Sh(U),Z._reflectorVbuffer.upload(),k.attributes.pos.pointer(Z._reflectorVbuffer),d.drawArrays(d.TRIANGLES,0,6),f._reflecting=!1,d.useProgram(U._prg),!0}}()}),qi.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Eo=function(o,V){yf(Eo,this,[o,V])};$g(Eo,Fr,{_80o:function(){}});var bk=function(a,Q){yf(bk,this,[a,Q])};$g(bk,wj,{_25Q:1,validate:function(W){var X=this;if(!X.s("geometry.cache")||!X.info){var Z=X.gv,Q=X.data,Y=X.s,$=Y("edge.width"),m=Q._40I,x=Q._41I;if(X.shapeModel=X.info=A,m&&x){var j,B,N,h,D,p,t,d,M,e,G=Q.isLooped(),F=Y(km),E=b.getEdgeType(F);if(E){var o=E(Q,nm(X,Z,Q,G,F),Z,X._19Q);if(!o.points||o.points.isEmpty())return;p=X.info={},t=o.segments,D=o.points,d=D.size();for(var R=m.getElevation(),L=x.getElevation(),U=0;d>U;U++){var n=D.get(U);n.e==A&&(n.e=R+(L-R)*U/(d-1))}M=xi(D.get(0)),e=xi(D.get(d-1));var s=d%2;0===s?(p.c1=xi(D.get(d/2-1)),p.c2=xi(D.get(d/2))):p.p3=xi(D.get((d-s)/2)),p.s1=M,p.s2=xi(D.get(1)),p.t1=xi(D.get(d-2)),p.t2=e}else{D=new Tr,p=X.info={};var z=Y("edge.offset"),c=Y("edge.center"),S=Y("edge.source.t3"),T=Y("edge.target.t3"),v=as(Z,Q,"source"),y=as(Z,Q,"target");if(!v||!y)return Z.invalidateData(Q),delete X.info,!1;if(S&&(v[0]+=S[0],v[1]+=S[1],v[2]+=S[2]),T&&(y[0]+=T[0],y[1]+=T[1],y[2]+=T[2]),F===od){t=Y("edge.segments");var l=p.points=Y(Ai)||$n;if(d=l.size()){M=xi(l.get(0)),e=xi(l.get(d-1)),!c&&z&&(N=Nm(M,v,!0),z=C(z,np(v,M)),v=[v[0]+N[0]*z,v[1]+N[1]*z,v[2]+N[2]*z],N=Nm(y,e,!0),z=C(z,np(e,y)),y=[y[0]-N[0]*z,y[1]-N[1]*z,y[2]-N[2]*z]);var s=d%2;0===s?(j=xi(l.get(d/2-1)),B=xi(l.get(d/2))):p.p3=xi(l.get((d-s)/2)),p.s1=v,p.s2=M,p.t1=e,p.t2=y}else!c&&z&&(N=Nm(y,v,!0),h=np(v,y),z=Qh(z,h),v=[v[0]+N[0]*z,v[1]+N[1]*z,v[2]+N[2]*z],y=[y[0]-N[0]*z,y[1]-N[1]*z,y[2]-N[2]*z]),j=v,B=y;D.add({x:v[0],y:v[2],e:v[1]}),D.addAll(l),D.add({x:y[0],y:y[2],e:y[1]})}else{var k=nm(X,Z,Q,G,F);if(X._19Q||(k=-k),G){var O=v[0],w=v[1],H=v[2],r=m.getTall()/2+k;j=[O-k,w+r,H],B=[O+k,w+r,H],D.add({x:O-k,y:H,e:w}),D.add({x:O-k,y:H,e:w+r}),D.add({x:O+k,y:H,e:w+r}),D.add({x:O+k,y:H,e:w})
}else{N=Nm(y,v,!0),h=np(v,y);var J={x:v[0],y:v[2]},i={x:y[0],y:y[2]},f=Or(A,J,i,k),u=f.x-J.x,q=f.y-J.y;z=Qh(z,h),N[0]*=z,N[1]*=z,N[2]*=z,j=[v[0]+N[0]+u,v[1]+N[1],v[2]+N[2]+q],B=[y[0]-N[0]+u,y[1]-N[1],y[2]-N[2]+q],c?(D.add({x:v[0],y:v[2],e:v[1]}),D.add({x:j[0],y:j[2],e:j[1]}),D.add({x:B[0],y:B[2],e:B[1]}),D.add({x:y[0],y:y[2],e:y[1]})):(D.add({x:j[0],y:j[2],e:j[1]}),D.add({x:B[0],y:B[2],e:B[1]}))}}p.c1=j,p.c2=B}p._lastPointsSegments={points:D,segments:t},p.list=Y(lc)===gp?X.createTubeModel(D,t,$/2,W):X.createLineModel(D,t,$,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=A}});var qj=function(c,u){yf(qj,this,[c,u])};$g(qj,Fr,{_80o:function(o,x,n){var Y=this,G=Y.gv,m=Y.shapeModel;Ae(G,Y.mat),m?Nb(G,Y.data,m,Y,Y.getBodyColor(),n):(rr(Y,o,x,"left",n),rr(Y,o,x,"front",n),rr(Y,o,x,"right",n),rr(Y,o,x,"back",n),rr(Y,o,x,"top",n),rr(Y,o,x,"bottom",n)),gs(G)},validate:function(N,c){var e,p,Y=this,g=Y.s,Q=Y.data,f=(Q.p3(),Q._thickness/2),s=Q.isClosePath(),n=Q.getPoints(),T=Q.getSegments(),I=g(pd),h=N&&N.uv;if(Y.clear(),0>f){try{p=Y.shapeModel=yn(n,T,g(Yl),g(En),I,g(hq),Q.getTall(),Q.getShapeElevation(),s)}catch(k){p=Y.shapeModel={}}g(zc)?g("shape3d.image")||delete p.uv:(delete p.vs,delete p.ns,delete p.uv),g("shape3d.top.image")||delete p.top_uv,g("shape3d.bottom.image")||delete p.bottom_uv}else if(g(lc)===gp)e=vm(n,T,I,s),p=Y.shapeModel={vs:[]},g("shape3d.image")&&(p.uv=[],p.sum=g(hq)||jp(e)||1,p.len=0),g(Yl)&&!s&&(p.top_vs=[],g("shape3d.top.image")&&(p.top_uv=[])),g(En)&&!s&&(p.bottom_vs=[],g("shape3d.bottom.image")&&(p.bottom_uv=[])),Y._12O(e,f);else{var o,O,L,M,w,V,D,W,v,j;if(e=vm(n,T,I,s),w=Y.vf(Kg,h,!1,c),f&&(V=Y.vf(gl,h,!1,c),D=s?A:Y.vf(Rc,h,!1,c),W=s?A:Y.vf(Pc,h,!1,c),v=Y.vf(Oe,h,!1,c),j=Y.vf(fl,h,!1,c)),f){for(var H=0,U=e.length;U>H;H++)e[H]=Y._tryRemoveBezierPoints(e[H],f);Y._12O(e,f)}else w&&e.forEach(function(V){if(M=V.length,M>0)for(o=V[0],L=1;M>L;L++)O=V[L],Y.addV(w.vs,o,O),o=O});Y._20Q(e),N||(w&&(w.ns=Dn(w.vs),zr(w,"vs"),zr(w,ok)),f&&(V&&(V.ns=Dn(V.vs),zr(V,"vs"),zr(V,ok)),D&&(D.ns=Dn(D.vs),zr(D,"vs"),zr(D,ok)),W&&(W.ns=Dn(W.vs),zr(W,"vs"),zr(W,ok)),v&&(v.ns=Dn(v.vs),zr(v,"vs"),zr(v,ok)),j&&(j.ns=Dn(j.vs),zr(j,"vs"),zr(j,ok))))}var P=Y.mat=Q.getPointsMatrix3d().getElements();N&&(Bn(Y,P,N,p),Y.clear())},_20Q:function(G){var O,B,o,w,P,x,H,C=this,z=C.front,u=C.back,i=C.top,S=C.bottom,t=z?z.tuv:A,D=u?u.tuv:A,J=i?i.tuv:A,k=S?S.tuv:A,r=0;(t||D||J||k)&&(O=C.s(hq)||jp(G)||1,G.forEach(function(U){if(B=U.length,B>0)for(x=U[0],o=1;B>o;o++)H=U[o],w=r/O,r+=np(x,H),P=r/O,C._14O(z,w,P),C._14O(u,1-P,1-w),C._14O(i,w,P),C._14O(S,w,P),x=H}))},_14O:function(U,m,h){if(U){var j=U.uv,Z=U.tuv;if(Z){if(j)var k=j[0]+(j[6]-j[0])*m,C=j[1]+(j[7]-j[1])*m,b=j[2]+(j[4]-j[2])*m,G=j[3]+(j[5]-j[3])*m,A=j[2]+(j[4]-j[2])*h,f=j[3]+(j[5]-j[3])*h,q=j[0]+(j[6]-j[0])*h,e=j[1]+(j[7]-j[1])*h;else k=m,C=0,b=m,G=1,A=h,f=1,q=h,e=0;Z.push(b,G,A,f,q,e,q,e,k,C,b,G)}}},_13O:function(r){var n=r.uv,i=r.tuv;i&&(n?i.push(n[2],n[3],n[4],n[5],n[6],n[7],n[6],n[7],n[0],n[1],n[2],n[3]):i.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(m,k){var w=m.length;if(4>w)return m;var J,S,p,s,C,t,L=!1,h=function(F){return m[F]},x=function(I){return m[w-1-I]};for(C=0;1>=C;C++)for(t=C?x:h,S=t(0),p=t(1),J=2;w-1>J;J++)if(s=t(J),!s.remove)if(s.b){var G=Or(S,p,s,k);G.adjust?(s.remove=!0,L=!0):(S=p,p=s)}else S=p,p=s;if(!L)return m;var T=[];for(J=0;w>J;J++)m[J].remove||T.push(m[J]);return T},_12O:function(k,p){var O,u,b,E,n,D=this.s("shape3d.point.epsilon"),w=this;k.forEach(function(H){if(n=H.length,n>0)for(O={p:H[0],n:!0},E=1;n>E;E++)u=H[E],b=n-1>E?H[E+1]:A,b&&Math.abs(u.x-b.x)<D&&Math.abs(u.y-b.y)<D||w.addPoint(O,u,b,p,H)})},addPoint:function(s,e,D,l,k){var X,Z,O,M,T,_,u,W,i,N=this,o=s.p,E=s.f,P=s.b,L=N.s("shape3d.side")||tk,J=N.s("shape3d.start.angle"),b=N.s("shape3d.sweep.angle"),V=N.shapeModel,S=N.data.isClosePath();if(s.n&&(s.n=!1,E=S&&k.length>2?Or(k[k.length-2],o,e,l):Or(A,o,e,l),P=hb(o,E),V?V.top_vs&&N._10O(P,E,L,J,b,V.top_vs,V.top_uv):(X=N.left)&&(N.addV(X.vs,P,E),N._13O(X))),Z=D?Or(o,e,D,l):S&&k.length>2?Or(o,e,k[1],l):Or(o,e,A,l),O=hb(e,Z),V){var H,R,n=V.vs,h=V.uv,m=V.sum;for(h&&(H=V.len/m,V.len+=np(o,e),R=V.len/m),_=N._9O(P,E,L,J,b),u=N._9O(O,Z,L,J,b),W=0;L>W;W++)i=W+1,oj(n,_[i]),oj(n,u[W]),oj(n,_[W]),oj(n,u[W]),oj(n,_[i]),oj(n,u[i]),h&&(M=W/L,T=i/L,h.push(H,T,R,M,H,M,R,M,H,T,R,T));!D&&V.bottom_vs&&N._10O(O,Z,L,J,b,V.bottom_vs,V.bottom_uv,!0)}else!D&&(X=N.right)&&(N.addV(X.vs,Z,O),N._13O(X)),(X=N.front)&&N.addV(X.vs,E,Z),(X=N.back)&&N.addV(X.vs,O,P),(X=N.top)&&N.addH(X.vs,E,Z,O,P,!0),(X=N.bottom)&&N.addH(X.vs,P,O,Z,E);s.p=e,s.f=Z,s.b=O},_10O:function(g,T,b,h,k,i,H,D){var y,I,N=this,c=N.data,x=N._9O(g,T,b,h,k),Q=(g.x+T.x)/2,e=(g.y+T.y)/2,X=c.getShapeElevation(),m=0;for(m=0;b>m;m++)D?(oj(i,x[m]),oj(i,x[m+1])):(oj(i,x[m+1]),oj(i,x[m])),oj(i,[Q,X,e]),H&&(D?(y=U*(m+1)/b+h,I=U*m/b+h):(y=U*m/b+h,I=U*(m+1)/b+h),H.push(.5-.5*E(I),.5-.5*j(I),.5-.5*E(y),.5-.5*j(y),.5,.5))},_9O:function(T,w,a,n,L){var u,S,X=this,t=X.data,l=[],i=(T.x+w.x)/2,P=(T.y+w.y)/2,o=t.getTall()/2,Z=t.getShapeElevation(),_=0;for(L==A&&(L=U);a>=_;_++)u=L*_/a+n,S=E(u),l.push([i+(T.x-i)*S,Z+o*j(u),P+(T.y-P)*S]);return l},addV:function(k,R,x){var a=R.x,_=R.y,t=x.x,K=x.y,e=this.data,J=e.getShapeElevation(),N=e.getTall()/2;k.push(a,J-N,_,t,J-N,K,t,J+N,K,t,J+N,K,a,J+N,_,a,J-N,_)},addH:function(A,s,Q,R,i,O){var f=this.data,X=f.getTall()/2,$=f.getShapeElevation()+(O?X:-X);A.push(s.x,$,s.y,Q.x,$,Q.y,R.x,$,R.y,R.x,$,R.y,i.x,$,i.y,s.x,$,s.y)},vf:function(U,s,c,C){var Y,Z=this,y=Z.gv.getFaceVisible(Z.data,U);return(c||y)&&(Y=xc(Z,U,C),Y.vs=[],Y.tuv=y&&(Y.texture||s)?[]:A,Y.visible=y),Y}});var Ip=function(a,x){yf(Ip,this,[a,x])};$g(Ip,wj,{_25Q:1,validate:function(l){var L=this,U=L.data,e=L.s,d=U.getPoints(),Y=d.size();if((!L.s("geometry.cache")||!L.shapeModel)&&(L.shapeModel=L.info=A,Y>1)){var $=L.info={},T=U.getSegments(),w=U.getThickness(),t=xi(d.get(0)),C=xi(d.get(Y-1)),p=Y%2;0===p?($.c1=xi(d.get(Y/2-1)),$.c2=xi(d.get(Y/2))):$.p3=xi(d.get((Y-p)/2)),$.s1=t,$.s2=xi(d.get(1)),$.t1=xi(d.get(Y-2)),$.t2=C,$.list=e(lc)===gp?L.createTubeModel(d,T,w/2,l):L.createLineModel(d,T,w,"shape.border","shape.dash")}var K=U.p3(),B=L.mat=om();ac(B,K),No(B,U.getFinalRotation3d(),U.getRotationMode());var v=U.getScale3d(),V=U._dynamicScale3d;V&&(v[0]*=V[0],v[1]*=V[1],v[2]*=V[2]),Zg(B,v),ac(B,Lq(K))},invalidateCachedGeometry:function(){this.shapeModel=this.info=A},_80o:function(k,r,F){var p=this,f=p.shapeModel;if(f){var Y=p.gv;Ae(Y,p.mat),Nb(Y,p.data,f,p,p.getBodyColor(),F),gs(Y)}}});var Mi=P.graph3d.VR=function(u){var E=this;E.gv=u,E._controllers=[],E.switch=new we(E),E._enable=!1,E._defaultCallLater=P.Default.callLater,E._defaultCancelLater=$p,"undefined"!=typeof _&&"VRFrameData"in _&&(E._frameData=new _.VRFrameData),E.measureOflength=1,E.eyesOffset=[0,0,0],E._orientation=new Lh.Quaternion,E._lastHeadPose=[0,0,0],E._offsetToBeAdd=[0,0,0],E._originalOrientation=null,E._fpsInfo={time:0,fps:0,frames:0}};$g(Mi,N,{ms_fire:!0,setOriginalYRotation:function(Q){var r=this;if(null==Q)return r._originalOrientation=null,void 0;var l=new Lh.Vector3(0,1,0),E=(new Lh.Quaternion).setFromAxisAngle(l,-Q),X=(new Lh.Matrix4).makeRotationFromQuaternion(E);return E.setFromAxisAngle(l,Q),r._originalOrientation={quaternion:E,matrixInverse:X},!0},_42:function(X,D,o,x){var r=this,s=r.gv;if(!s.drawFilter&&r._deviceInAction){var F=r._device;if(F){var n=r._measureOflength;F.depthNear=s.getNear()*n,F.depthFar=s.getFar()*n;var H=r._offsetToBeAdd;if(r.eyesOffset[0]+=H[0],r.eyesOffset[1]+=H[1],r.eyesOffset[2]+=H[2],H[0]=0,H[1]=0,H[2]=0,F.isPresenting===!1)return r._controllers.forEach(function(v){v&&v.update()}),s.iv(),!1;var Q=r._frameData;F.getFrameData(Q);var T=Q.pose.position;if(T){var U=r.toViewPosition(T);s.setEye(U),r._orientation.fromArray(Q.pose.orientation),r._originalOrientation&&r._orientation.premultiply(r._originalOrientation.quaternion);var w=new Lh.Vector3(0,0,-10*r._scaleFactor);w.applyQuaternion(r._orientation),s.setCenter([U[0]+w.x,U[1]+w.y,U[2]+w.z])}r._controllers.forEach(function(A){A&&A.update()}),s.setViewport(X,0,0,D/2,o),r._viewMatrix=r._copyViewMatrix(Q.leftViewMatrix),r._projectMatrix=r._copyProjectMatrix(Q.leftProjectionMatrix),x(),s.setViewport(X,D/2,0,D/2,o),r._viewMatrix=r._copyViewMatrix(Q.rightViewMatrix),r._projectMatrix=r._copyProjectMatrix(Q.rightProjectionMatrix),x(),r._lastViewMatrix=r._viewMatrix,r._lastProjectMatrix=r._projectMatrix,r._viewMatrix=null,r._projectMatrix=null,r.submitFrame();var m=Date.now(),k=r._fpsInfo;return m-k.time>1e3?(k.fps=Math.round(1e3*(k.frames+1)/(m-k.time)),k.time=m,k.frames=0):k.frames++,!0}}},onVRDisplayPresentChange:function(){var c=this.isPresenting();this._injectGraphView(c),this.fp("present",!c,c)},getOrientation:function(){return this._orientation},addController:function(T){T=T||0;var F=this,r=F.getController(T);return r?r:(r=new Ok(F,T),F._controllers.push(r),r)},getController:function(Q){Q=Q||0;for(var b=this._controllers,Z=0,t=b.length;t>Z;Z++)if(b[Z]&&b[Z].id===Q)return b[Z];return null},removeController:function(j){j=j||0;for(var d=this._controllers,z=0,O=d.length;O>z;z++)if(d[z]&&d[z].id===j)return d.splice(z,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(H,b){var m=this,_=m._scaleFactor,O=m._eyesOffset,V=m._lastHeadPose;if(m._originalOrientation){var S=m._originalOrientation.quaternion,G=new Lh.Vector3(H);G.applyQuaternion(S).multiplyScalar(_).toArray(V)}else V[0]=H[0]*_,V[1]=H[1]*_,V[2]=H[2]*_;return b?(b[0]=V[0]+O[0],b[1]=V[1]+O[1],b[2]=V[2]+O[2],b):[V[0]+O[0],V[1]+O[1],V[2]+O[2]]},addEyesOffset:function(L,v,q){var c=this._offsetToBeAdd;c[0]+=L,c[1]+=v,c[2]+=q},_copyViewMatrix:function(r){var p=this,m=p.dup(r);if(p._originalOrientation){var x=(new Lh.Matrix4).fromArray(m);x.multiply(p._originalOrientation.matrixInverse).toArray(m)}var k=p._scaleFactor;m[12]*=k,m[13]*=k,m[14]*=k;var f=p._eyesOffset;if(f&&(f[0]||f[1]||f[2])){var c=f[0],W=f[1],Z=f[2];m[12]-=m[0]*c+m[4]*W+m[8]*Z,m[13]-=m[1]*c+m[5]*W+m[9]*Z,m[14]-=m[2]*c+m[6]*W+m[10]*Z}return m},shutdown:function(){var v=this._device;v&&v.isPresenting&&v.exitPresent()},isPresenting:function(){var u=this._device;return u&&u.isPresenting},_copyProjectMatrix:function(H){var L=this.dup(H),u=this._scaleFactor;return L[14]*=u,L},dup:function(A,i){for(var c=A.length,F=i||new Array(c);c--;)F[c]=A[c];return F},getViewMatrix:function(F){var X=this._viewMatrix;return X?this.dup(X,F):void 0},getProjectMatrix:function(){var I=this._projectMatrix;return I?this.dup(I):void 0},submitFrame:function(){var L=this;if(L._enable&&L._deviceInAction){var N=L._device;N&&N.isPresenting&&(N.submitFrame(),L.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(s){var Z=this.gv;return Z.intersectObjects(s,Z.dm().getDatas())},setDevice:function(i){var o=this;o._device=i},_injectGraphView:function(){var S,U,T;return function(g){var V=this.gv;if(!g)return S&&(V.getWidth=S,V.getHeight=U,V.getDevicePixelRatio=T),void 0;var t=this._device,R=t.getEyeParameters("left"),L=R.renderWidth,m=R.renderHeight;S=V.getWidth,U=V.getHeight,T=V.getDevicePixelRatio,V.getWidth=function(){return 2*L},V.getHeight=function(){return m},V.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(A){var v=this;if(!A)return Wg=P.Default.callLater=v._defaultCallLater,$p=P.Default.cancelLater=v._defaultCancelLater,void 0;var v=this;Wg=P.Default.callLater=function(a,q,D,G){var l=v._device;return l&&l.isPresenting?G?$(function(){Wg(a,q,D)},G):l.requestAnimationFrame(function(){v._deviceInAction=!0,a.apply(q,D),v._deviceInAction=!1}):v._defaultCallLater(a,q,D,G)},$p=P.Default.cancelLater=function(W,L){var o=v._device;return o&&o.isPresenting?L?X(W):o.cancelAnimationFrame(W):v._defaultCancelLater(W,L)}}}),N.defineProperties(Mi.prototype,{enable:{get:function(){return this._enable},set:function(Q){var L=this;L._enable!==Q&&(L._enable=Q,Q?(L.switch.showButton(),L._injectCallLaterFunc(!0)):(L.shutdown(),L.switch.hideButton(),L._injectCallLaterFunc(!1)),L.fp("enable",!Q,Q))}},measureOflength:{get:function(){return this._measureOflength},set:function(e){this._measureOflength=e;var I=this._scaleFactor=1/e;this._controllers.forEach(function(t){t&&t._setScaleFactor(I)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(f){this._eyesOffset=f}},controllerModel:{get:function(){return this._controllerModel},set:function(D){var C;"object"==typeof D?(C=D.mtl,D=D.obj):(C=D+".mtl",D+=".obj");var K=this,X=K._controllerModel;X&&X.obj===D&&X.mtl===C||(X=K._controllerModel={obj:D,mtl:C},b.loadObj(D,C,{finishFunc:function(w,d){K._controllerModel===X&&b.setShape3dModel("vrControllerModel",d)}}))}},interactive:{get:function(){return!!this._interactive},set:function(v){!!v!=!!this._interactive&&(this._interactive=v,v&&this.addController(0),this.gv.getCoreInteractor().enableVR(v))}}});var Ok=function(M,k){function F(g){var E=navigator.getGamepads&&navigator.getGamepads();if(E)for(var z=0,y=0,t=E.length;t>z;z++){var d=E[z];if(d){var f=d.id;if("OpenVR Gamepad"===f||0===f.indexOf("Oculus Touch")||f.indexOf("Controller")>=0){if(y===g)return d;y++}}}}function i(k,I,_){return Math.abs(k[0]-I[0])<_&&Math.abs(k[1]-I[1])<_&&Math.abs(k[2]-I[2])<_?!0:!1}var q=this;q.vr=M,q.id=k;var L,h,s=[0,0],x=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],X=new Ei;X.s("shape3d","vrControllerModel"),X.isController=!0,X.s("intersect",!1),q.getGamepad=function(){return h},q.isButtonPressed=function(k){for(var A,v=0,c=x.length;c>v;v++)if(A=x[v],A.id===k)return A.pressed;return!1},q.getNode=function(){return X};var Q=.003;q.setRotationEpsilon=function(m){Q=m};var D=5e-4,B=D;q.setPositionEpsilon=function(b){D=b,B=b*q.vr._scaleFactor},q._setScaleFactor=function(N){X.s3(N,N,N),B=D*N},q._setScaleFactor(q.vr._scaleFactor);var V,A=new Ep,v=new Xd,H=[0,0,0],K=[0,0,0],z=new ai,G=new ps,c=new fr;q.getRay=function(){return V?(c.origin.fromArray(H),c.direction.copy(G),V=!1,c):c},q.update=function(){if(L=h,h=F(k),!h||h.pose===e)return h=null,X.s("3d.visible",!1),void 0;if(b.getShape3dModel("vrControllerModel")){X.dm()||M.gv.dm().add(X),X.s("3d.visible",!0);var Y=h.pose;if(null!==Y){if(Y.position&&(q.vr.toViewPosition(Y.position,H),i(X.p3(),H,B)||(V=!0,X.p3(H))),Y.orientation){A.fromArray(Y.orientation);var l=q.vr._originalOrientation;l&&A.premultiply(l.quaternion),G.set(0,0,-1).applyQuaternion(A).normalize(),v.makeRotationFromQuaternion(A),z.set(0,0,0,X.getRotationMode(),!0).setFromRotationMatrix(v),K[0]=z.x,K[1]=z.y,K[2]=z.z,i(X.r3(),K,Q)||(V=!0,X.r3(K))}V&&M.fp("gamepad.pose",null,{position:H,rotation:K,id:k});var j=h.axes;(s[0]!==j[0]||s[1]!==j[1])&&(s=[j[0],j[1]],M.fp("gamepad.axes",null,{id:k,axes:s}));var J,t,n,p,Z=h.buttons;for(J=0,t=Z.length;t>J;J++)if(n=Z[J],n&&(p=n.pressed,x[J]||(x[J]={id:"button"+J,pressed:!1}),p!==x[J].pressed)){x[J].pressed=p;var c={id:k},r="state";c[r]=c._62O=p?"down":"up",M.fp("gamepad.button."+x[J].id,null,c)}}}}},we=function(H){this.vr=H,this._button=null};$g(we,N,{showButton:function(){var w=this.assureButton();if(!w.parentNode){var v=this.vr.gv,U=v.getView();v._79O?U.insertBefore(w,v._79O):U.appendChild(w)}},hideButton:function(){var f=this._button;f&&f.parentNode&&f.parentNode.removeChild(f)},assureButton:function(){var T=this._button;return T?T:this._button=this.createButton(this.vr.gv)},createButton:function(g){function H(y,h){y.textContent=h&&h.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function N(N){c.style.display="",c.style.cursor="pointer",c.style.left="calc(50% - 50px)",c.style.width="100px",H(c,N),c.onmouseenter=function(){c.style.opacity="1.0"},c.onmouseleave=function(){c.style.opacity="0.5"},c.onclick=function(){N.isPresenting?N.exitPresent():N.requestPresent([{source:g.getCanvas()}])},g.vr.setDevice(N)}function u(){c.style.display="",c.style.cursor="auto",c.style.left="calc(50% - 75px)",c.style.width="150px",H(c,null),c.onmouseenter=null,c.onmouseleave=null,c.onclick=null,g.vr.setDevice(null)}function q(s){s.style.position="absolute",s.style.bottom="20px",s.style.padding="12px 6px",s.style.border="1px solid #fff",s.style.borderRadius="4px",s.style.color="#000",s.style.font="normal 13px sans-serif",s.style.textAlign="center",s.style.opacity="0.5",s.style.outline="none",s.style.zIndex="999"}if("getVRDisplays"in navigator){var c=this._button=x.createElement("button");return c.style.display="none",q(c),d(_,"vrdisplayconnect",function(f){N(f.display)}),d(_,"vrdisplaydisconnect",function(){u()}),d(_,"vrdisplaypresentchange",function(C){H(c,C.display),g.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(V){V.length>0?N(V[0]):u()}),c}var h=x.createElement("a");return h.href="https://webvr.info",h.innerHTML="当前不支持 webvr",h.style.left="calc(50% - 90px)",h.style.width="180px",h.style.textDecoration="none",q(h),h}}),N.defineProperties(we.prototype,{});var jc=P.graph3d.PostProcessing=function(Y){function O(){if(!A){var W=Y.getGL();A=new Kk.RenderTarget(Y,W,null,null,{samples:n.renderTextureSamples||1}),g=new Sg.Shader(W,J.vs,J.fs),j=Sg.Buffer.createIndexBuffer(W,new Uint16Array([0,2,1,1,2,3])),b=Sg.Buffer.createVertexBuffer(W,new Float32Array([0,0,1,0,0,1,1,1]))}}var A,g,j,b,c=this,t={},U=!1;!function(){N.keys(jc).forEach(function(C){t[C]=new jc[C](Y)})}(),c.getModule=function(m){return m?t[m]:c},c.getModuleList=function(){return N.keys(t)},c._serializable=!0,c.handleDataModleChange=function(U,D){U&&(c._serializable&&U.setPostProcessingData(c.serialize()),U.removeSerializeListener(c.onDataModelSerialize,c)),D&&(D.addSerializeListener(c.onDataModelSerialize,c),c.deserialize(D))},c.onDataModelSerialize=function(L){"serialize"===L.type?c._serializable&&(Y.dm()._postProcessingData=c.serialize()):"deserialize"===L.type&&c.deserialize(Y.dm())},c.isDeserializeDisabled=function(F){return!c._serializable||F.a("sceneBloom")!==e},c.isSerializable=function(){return c._serializable},c.setSerializable=function(u){c._serializable=u,u||Y.dm().setPostProcessingData(e)},c.serialize=function(){var h,i,b,F,A={};for(i in t)if(b=t[i],F=b.serializeProperties){h={},b.enable&&(h.enable=!0);for(var B in F){var d=b[B];d!=F[B]&&(h[B]=d)}N.keys(h).length&&(A[i.toLowerCase()]=h)}return A},c.deserialize=function(n){var K,w,A,g,i,C={},$={};for(K in t){A=t[K],g=A.serializeProperties;var G={},q="scene"+K,X=n.a(q);X!==e&&(G.enable=X);for(var i in g)X=n.a(q+i[0].toUpperCase()+i.slice(1)),X!==e&&X!==g[i]&&(G[i]=X);Ah(G)||($[K.toLowerCase()]=G)}if(Ah($)&&($=n.getPostProcessingData()),$)for(w in $)if(w&&(K=w[0].toUpperCase()+w.slice(1),A=t[K])){C[K]=!0,g=$[w];var F=!!g.enable;c.enableModule(K,F),K="scene"+K,n.a(K,F),A.resetProperties&&A.resetProperties();for(i in g)if("enable"!==i){var X=g[i];A[i]=X,n.a(K+i[0].toUpperCase()+i.slice(1),X)}}for(K in t)C[K]||(A=t[K],A.enable=!1,A.resetProperties&&A.resetProperties())},c.decodeShader=function(c){var j,$,x,s="",w="";for(x=0;x<c.length;x++)j=c[x],"%"===j?j="'":"a"===j?j='"':"]"===j&&(j="\\"),$=String.fromCharCode(j.charCodeAt(0)-1),x%2?w+=$:s=$+s;return w+s},c.createShader=function(T,h,H){var A=h.indexOf("^#"),j=c.decodeShader(h.substr(0,A)),B=c.decodeShader(h.substr(A+2));if(H){var o=H(j,B);o&&o.vs&&(j=o.vs),o&&o.fs&&(B=o.fs)}return new Sg.Shader(T,j,B)},c.enableModule=function(z,I){var C,l,B,s=z.split(",");for(C=0,l=s.length;l>C;C++)B=s[C].trim(),t[B]&&(t[B].enable=I);U=!1;for(B in t)if(t[B].enable){U=!0;break}U&&O()};var J={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};c._42=function(l,Q,R,V,H){if(U&&!H){A.setSize(l,Q,R),A.bind(l);var q=l.getParameter(l.COLOR_CLEAR_VALUE);q&&0===q[0]&&0===q[1]&&0===q[2]&&0===q[3]?q=null:Bp(l,[0,0,0,0]),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),Y.setViewport(l,0,0,Q,R),V(),A.unbind(l);for(var O=0,v=Y._glCapabilities.maxAttributes;v>O;O++)l.disableVertexAttribArray(O);var T,$=A;for(T in t)$=t[T]._42(l,$)||$;return Y.setViewport(l,0,0,Q,R),q&&Bp(l,q),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),g.bind(),l.activeTexture(l.TEXTURE0+0),l.bindTexture(l.TEXTURE_2D,$.texture),g.uniforms.image=0,j.upload(),b.upload(),g.attributes.pos.pointer(b),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0),l.bindTexture(l.TEXTURE_2D,null),l.useProgram(Y._prg),!0}}},zd=P.graph3d.PostProcessing.Bloom=function(B){function y(){var _=B.getGL();if(_)for(var V=B._postProcessing,v=0;t>v;v++)C[v]=V.createShader(_,zd._35Q,function(Y,_){return{fs:_.replace(/DEFINE_VALUE/g,i[v]).replace("%OVERRIDE_ALPHA_DEFINE%",T?"#define OVERRIDE_ALPHA":"")}})}function _(){var G=B.getWidth(),x=B.getHeight();if(G&&x){P=[G,x],v=!0;var $,q=B.getGL(),N=Math.round(P[0]/2),u=Math.round(P[1]/2);for(A=new Kk.RenderTarget(B,q,N,u),$=0;t>$;$++)R.push(new Kk.RenderTarget(B,q,N,u)),X.push(new Kk.RenderTarget(B,q,N,u)),N=Math.round(N/2),u=Math.round(u/2);var g=B._postProcessing;o=g.createShader(q,zd._34Q),y(),z=g.createShader(q,zd._36Q,function(n,R){return{fs:R.replace(/NUM_MIPS/g,t)}}),h=g.createShader(q,zd.finalShader),a=Sg.Buffer.createIndexBuffer(q,new Uint16Array([0,2,1,1,2,3])),S=Sg.Buffer.createVertexBuffer(q,new Float32Array([0,0,1,0,0,1,1,1]))}}var m,I,u,T,a,S,p=this,E=!1,v=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var Q=this.serializeProperties;for(var $ in Q)this[$]=Q[$]},N.defineProperties(p,{enable:{get:function(){return E},set:function(h){!!E!=!!h&&(E=h,h&&!v&&_(),B.iv())}},strength:{get:function(){return m},set:function(e){m!==e&&(m=e,B.iv())}},threshold:{get:function(){return I},set:function(W){I!==W&&(I=W,B.iv())}},radius:{get:function(){return u},set:function(s){u!==s&&(u=s,B.iv())}},overrideAlpha:{get:function(){return T},set:function(Z){!!T!=!!Z&&(T=Z,v&&y(),B.iv())}}}),this.resetProperties();var A,o,z,h,P=[256,256],R=[],X=[],t=5,i=[3,5,7,9,11],C=[];p._42=function(j,Q){function k(f,D,N,Z){Wi(j,D.frame),B.setViewport(j,0,0,D.width,D.height),Z?Z(j):j.clear(j.COLOR_BUFFER_BIT|j.DEPTH_BUFFER_BIT),g!==f&&f.bind();var I=0;for(var m in N){var E=N[m];E instanceof WebGLTexture&&(j.activeTexture(j.TEXTURE0+I),j.bindTexture(j.TEXTURE_2D,E),E=I,I++),f.uniforms[m]=E}for(g!==f&&(a.upload(),S.upload(),f.attributes.pos.pointer(S),g=f),j.drawElements(j.TRIANGLES,6,j.UNSIGNED_SHORT,0);I--;)j.activeTexture(j.TEXTURE0+I),j.bindTexture(j.TEXTURE_2D,null);vs(j)}if(E&&(v||(_(),v))){var g;k(o,A,{smoothWidth:.01,luminosityThreshold:I,tDiffuse:Q.texture});var V,G=A,b=Math.round(P[0]/2),i=Math.round(P[1]/2);for(V=0;t>V;V++)k(C[V],R[V],{colorTexture:G.texture,direction:[1,0],texSize:[b,i]}),k(C[V],X[V],{colorTexture:R[V].texture,direction:[0,1],texSize:[b,i]}),b=Math.round(b/2),i=Math.round(i/2),G=X[V];return k(z,R[0],{blurTexture1:X[0].texture,blurTexture2:X[1].texture,blurTexture3:X[2].texture,blurTexture4:X[3].texture,blurTexture5:X[4].texture,bloomStrength:m,bloomRadius:u,bloomTintColor:[1,1,1]}),k(h,Q,{image:R[0].texture},function(T){T.enable(T.BLEND),T.blendEquation(T.FUNC_ADD),T.blendFunc(T.SRC_ALPHA,T.ONE)}),j.blendEquationSeparate(j.FUNC_ADD,j.FUNC_ADD),j.blendFuncSeparate(j.SRC_ALPHA,j.ONE_MINUS_SRC_ALPHA,j.ONE,j.ONE_MINUS_SRC_ALPHA),Q}}};zd._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",zd._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",zd._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",zd.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var oi=P.graph3d.PostProcessing.Dof=function(A){function w(){p=!0;var T=A.getGL();$=new Kk.RenderTarget(A,T),v=A._postProcessing.createShader(T,oi._38Q),C=Sg.Buffer.createIndexBuffer(T,new Uint16Array([0,2,1,1,2,3])),D=Sg.Buffer.createVertexBuffer(T,new Float32Array([0,0,1,0,0,1,1,1]))}var $,v,C,D,G,x,Q,T,t=this,a=!1,p=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var x=this.serializeProperties;for(var r in x)this[r]=x[r]},N.defineProperties(t,{enable:{get:function(){return a},set:function(T){!!a!=!!T&&(a=T,T&&!p&&w(),A.iv())}},image:{get:function(){return x},set:function(W){x!==W&&(x=W,G&&(A.getGL().deleteTexture(G),G=null),A.iv())}},maxblur:{get:function(){return Q},set:function(c){Q!==c&&(Q=c,A.iv())}},aperture:{get:function(){return T},set:function(o){T!==o&&(T=o,A.iv())}}}),this.resetProperties(),t._42=function(R,K){function x(L,Q,y,V){Wi(R,Q.frame),A.setViewport(R,0,0,Q.width,Q.height),V?V(R):R.clear(R.COLOR_BUFFER_BIT|R.DEPTH_BUFFER_BIT),t!==L&&L.bind();var F=0;for(var S in y){var d=y[S];d instanceof WebGLTexture&&(R.activeTexture(R.TEXTURE0+F),R.bindTexture(R.TEXTURE_2D,d),d=F,F++),L.uniforms[S]=d}for(t!==L&&(C.upload(),D.upload(),L.attributes.pos.pointer(D),t=L),R.drawElements(R.TRIANGLES,6,R.UNSIGNED_SHORT,0);F--;)R.activeTexture(R.TEXTURE0+F),R.bindTexture(R.TEXTURE_2D,null);vs(R)}if(a){p||w();var t;if(!G){var e=Ef(this.image);if(!e||!e.tagName)return K;G=Xb(R,e)}var X=K.width,b=K.height;if(X&&b)return $.setSize(R,X,b),x(v,$,{tColor:K.texture,tDepth:G,aspect:X/b,aperture:this.aperture,maxblur:this.maxblur}),$}}};oi._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Ec(b,{accordionViewExpandIcon:Ym(br),accordionViewCollapseIcon:Ym(br,!0),accordionViewLabelColor:uk,accordionViewLabelFont:Ek,accordionViewTitleBackground:He,accordionViewSelectBackground:Zr,accordionViewSelectWidth:3,accordionViewSeparatorColor:e,splitViewDividerSize:1,splitViewDividerBackground:He,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:jl,rect:[2,2,12,12],background:br}]},propertyViewLabelColor:Rl,propertyViewLabelSelectColor:uk,propertyViewLabelFont:Ek,propertyViewExpandIcon:Ym(Aq),propertyViewCollapseIcon:Ym(Aq,!0),propertyViewBackground:In,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Cn,propertyViewColumnLineColor:Cn,propertyViewSelectBackground:Zr,listViewLabelColor:Rl,listViewLabelSelectColor:uk,listViewLabelFont:Ek,listViewRowLineVisible:!1,listViewRowLineColor:Cn,listViewSelectBackground:Zr,treeViewLabelColor:Rl,treeViewLabelSelectColor:uk,treeViewLabelFont:Ek,treeViewExpandIcon:Ym(ne),treeViewCollapseIcon:Ym(ne,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Cn,treeViewSelectBackground:Zr,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Rl,tableViewLabelSelectColor:uk,tableViewLabelFont:Ek,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Cn,tableViewColumnLineColor:Cn,tableViewSelectBackground:Zr,treeTableViewLabelColor:Rl,treeTableViewLabelSelectColor:uk,treeTableViewLabelFont:Ek,treeTableViewExpandIcon:Ym(ne),treeTableViewCollapseIcon:Ym(ne,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Cn,treeTableViewColumnLineColor:Cn,treeTableViewSelectBackground:Zr,tableHeaderLabelColor:Rl,tableHeaderLabelFont:Ek,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Sn,tableHeaderBackground:In,tableHeaderMoveBackground:ze,tableHeaderInsertColor:Zr,tableHeaderSortDescIcon:Td(Aq,!0),tableHeaderSortAscIcon:Td(Aq),tabViewTabGap:1,tabViewLabelColor:uk,tabViewLabelFont:Ek,tabViewTabBackground:He,tabViewSelectWidth:3,tabViewSelectBackground:Zr,tabViewMoveBackground:ze,tabViewInsertColor:Zr,toolbarLabelColor:Rl,toolbarLabelSelectColor:uk,toolbarLabelFont:Ek,toolbarBackground:In,toolbarSelectBackground:Zr,toolbarItemGap:8,toolbarSeparatorColor:Jr},!0);
var ad={translateX:1,sortColumn:1},Pb={sortable:1,sortOrder:1,sortFunc:1},yi={focusData:1},Qc={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Oc={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},ep=function(w,v){v.add(w),w.hasChildren()&&w.eachChild(function(X){ep(X,v)})},dr=function(I,k,v,E,Q,Z,C,u,S,y,V){var j,x=v.getValueType(y),U=v.getAlign(y);if(v.getEnumValues(y)){var H=v.toEnumLabel(k,y),z=cj||0,F=0,L=Z,w=b.getTextSize(E,H).width;return j=Ef(v.toEnumIcon(k,y)),j&&(F=Z+cj/2,"center"===U?F+=(u-(z+w))/2:"right"===U&&(F=F+u-(z+w)),te(I,j,F,C+S/2,y,V),L=F+cj/2),H!=A&&(j?wo(I,H,E,Q,L,C,u-(L-Z),S):wo(I,H,E,Q,Z,C,u,S,U)),void 0}return k=v.formatValue(k),k!=A?x===jq?(ld(I,Z,C,u,S,k),void 0):x===rc||!x&&ql(k)?(j=Ef(k?Qb:ao),te(I,j,Z+u/2,C+S/2,y,V),void 0):(wo(I,k,E,Q,Z,C,u,S,U),void 0):void 0},rb=function(w,E){var s=E.view,O=If(w),c=E.column||E.property;s.getDataModel().beginTransaction(),E.editor=w,w.info=E,s.setCurrentEditor(w),s.getView().insertBefore(O,s._79O),di(w,E.editorRect),w.setFocus?w.setFocus():Pg(w),w.commitValue=function(y,g){w._17Q&&(w=w._17Q),g||s.setValue(E.data,c,w.getValue?w.getValue():w.value),w.close&&w.close(),Sc(O)},c.onEditorCreated&&c.onEditorCreated(E)},sp=function(o,S,N,E,q){var t=oo(o,N),h=S.value,J=S.view,Z=q.getValueType(S.data);return t.onblur=t.onchange=function(){J.endEditing()},"input"===o?(h=q.formatValue(h),h!=A&&(t.value=h),t.onkeydown=function(K){rp(K)?J.endEditing():dk(K)&&J.endEditing(!0)},(Z===zb||Z===sc)&&d(t,cr,b.numberListener)):o===tm&&E.forEach(function(O){var _=x.createElement("option");_.innerHTML=q.toEnumLabel(O),_.value=O,q.isEnumEqual(h,O)&&(_.selected=!0),Ho(t,_)}),rb(t,S),t},qm=P.widget={},Ap=function(J,V,T){$g(h+".widget."+J,V,T)};Ec(Uq,{ms_value:function($){$.getValue=function(P){var x=this.getItemById(P),j=x.element;return nf(j)?j:j?j.getValue?j.getValue():j.value:x.selected},$.setValue=function(s,S){var l=this.getItemById(s);if(l){var p=l.element;p&&!nf(p)?p.setValue?p.setValue(S):p.value=S:ql(S)?(l.selected=S,this.iv()):(l.element=S,this.iv())}},$.v=function(Q,k){var l=this;if(2===arguments.length)l.setValue(Q,k);else{if(!Tp(Q))return l.getValue(Q);for(var F in Q)l.setValue(F,Q[F])}return l}},_46o:function(L){L._icon=A,L._accessType=A,L._valueType=A,L._editable=!1,L._batchEditable=!0,L._align=Rc,L._nullable=!0,L._emptiable=!1,L.setParent=Od,L.formatValue=function(x){var v=this,q=v._valueType;return v.getEnumValues()?v.toEnumLabel(x):q===rc?!!x:x!=A&&q===zb?W(x):x},L.setEnum=function(p,b,Y,N,Z,i,t){var u=this;p&&!Fl(p)&&p.values&&(N=p.editable,Y=p.icons,b=p.labels,Z=p.strict,i=p.maxHeight,t=p.dropDownWidth,p=p.values),mk(p)&&(p=p._as),mk(b)&&(b=b._as),mk(Y)&&(Y=Y._as),u._enumValues=p,u._enumLabels=b,u._enumIcons=Y,u._enumEditable=N,u._enumStrict=Z==A?!0:Z,u._enumMaxHeight=i,u._enumDropDownWidth=t,p&&p.length&&vp(p[0])&&(u._valueType=sc),u.fp("enum",!1,!0)},L.getEnumDropDownWidth=function(){return this._enumDropDownWidth},L.getEnumMaxHeight=function(){return this._enumMaxHeight},L.isEnumEditable=function(){return this._enumEditable},L.getEnumValues=function(){return this._enumValues},L.getEnumLabels=function(){return this._enumLabels},L.getEnumIcons=function(){return this._enumIcons},L.isEnumStrict=function(){return this._enumStrict},L.isEnumEqual=function(G,g){return this._enumStrict?G===g:G==g},L.toEnumLabel=function(G,e){var s=this,L=s.getEnumValues(e),m=s.getEnumLabels(e);if(L&&m)for(var T=0;T<L.length;T++)if(s.isEnumEqual(G,L[T]))return m[T];return G},L.toEnumIcon=function(h,R){var y=this,L=y.getEnumValues(R),u=y.getEnumIcons(R);if(L&&u)for(var $=0;$<L.length;$++)if(y.isEnumEqual(h,L[$]))return u[$];return e}},_45o:function(S){S._87o=function(Y,X,k,s,h,u){if(Y){var H=this,f=H._90I,M=ob(1);H._columnLineVisible&&(h-=1),H._rowLineVisible&&(u-=1),0>=h||0>=u||(H._90I||(f=H._90I={}),f[X]||(f[X]=new Tr),di(M,H.tx()+k,H.ty()+s,h,u),Ho(M,Y),H._view.insertBefore(M,H._79O),Y.onParentAdded&&Y.onParentAdded(M),f[X].add(M))}},S._76o=function(){var v=this,G=v._90I;if(G){for(var p in G)G[p].each(function(e){Sc(e)});delete v._90I}},S._77o=function(W){var H=this;if(H._90I){var M=H._90I[W];M&&(M.each(function(M){Sc(M)}),delete H._90I[W])}}},_47o:function(T){T.getValue=function(J,U){return U.getValue?U.getValue(J,U,this):Li(J,U.getAccessType(),U.getName())},T.setValue=function(p,_,z){if(_.isEmptiable(p)||""!==z||(z=e),_.isNullable(p)||z!=A){var O=this,X=_.getName(p),K=_.getAccessType(p),R=_.getValueType(p);R===zb&&nf(z)?z=y(z):R===sc&&nf(z)?z=parseFloat(z):R===rc&&nf(z)&&(z="true"===z),O._batchEditable&&_._batchEditable&&O.isSelected(p)?O.sm().each(function(k){_.setValue?_.setValue(k,_,z,O):Qq(k,K,X,z)}):_.setValue?_.setValue(p,_,z,O):Qq(p,K,X,z)}},T.setCurrentEditor=function(n){this.endEditing(),this._currentEditor=n,this.redraw()},T.isEditing=function(X,F){var j=this,G=j._currentEditor;if(!G)return!1;if(F){var K=G.info;return K?(K.column||K.property)===F&&K.data===X:!1}return!0},T.endEditing=function(M){var i=this,g=i._currentEditor;g&&(delete i._currentEditor,g.commitValue&&g.commitValue(g.info,M),i.redraw(),i.getDataModel().endTransaction())},T.beginEditing=function(M){this.endEditing();var S=this,X=M.column||M.property;if(X.beginEditing)X.beginEditing(M);else{var O=M.data,G=M.value,B=S.getSelectBackground(O),v=X.getEnumValues(O),V=X.getSlider(O),J=X.getColorPicker(O);if(V){var x=Ld(qm.Slider,V);return x.setValue(G),x.getView().onblur=function(){S.endEditing()},x.isInstant()&&(x.onValueChanged=function(){S.setValue(O,X,x.getValue())}),rb(x,M),void 0}if(J||X.getValueType(O)===jq){var u=Ld(qm.ColorPicker,J);return u.setValue(G),u.onClosed=function(){S.endEditing()},u.isInstant()&&(u.onValueChanged=function(C,W){S.setValue(O,X,W)}),rb(u,M),u.open(),void 0}if(v){if(qm.ComboBox){var c=new qm.ComboBox;c.setValue(G),c.setValues(v),c.setLabels(X.getEnumLabels(O)),c.setIcons(X.getEnumIcons(O)),c.setEditable(X.isEnumEditable(O)),c.setStrict(X.isEnumStrict(O)),c.setMaxHeight(X.getEnumMaxHeight(O)),c.setDropDownWidth(X.getEnumDropDownWidth(O)),c.onClosed=function(){S.endEditing()},rb(c,M),c.open()}else sp(tm,M,B,v,X);return}var Q=X.getValueType(O);if(Q===rc||ql(G))return S.setValue(O,X,!G),void 0;if(X.getItemEditor(O)){var _=us(X.getItemEditor(O)),R=new _(O,X,S,M),w=R.getView();return w._17Q=R,R.setValue(G),Dm(w),rb(w,M),R.editBeginning&&R.editBeginning(),void 0}sp("input",M,B,A,X)}}},_44o:function(C){C.init=function(U){var J=this,q=J.th=new Oo(U),g=J._view=tf(1,J);J.tv=J._tableView=U,Ho(g,q.getView()),Ho(g,U.getView()),q.mp(function(m){m.property===ll&&J.iv()}),J.iv()},C.getTableView=function(){return this.tv},C.getTableHeader=function(){return this.th},C.getDataModel=function(){return this.tv.dm()},C.getColumnModel=function(){return this.tv.getColumnModel()},C.setColumns=function(F){this.tv.setColumns(F)},C.addColumns=function(P){this.tv.addColumns(P)},C.endEditing=function(){this.tv.endEditing()},C.validateImpl=function(){var C=this,Q=C.th,P=Ge(Q),u={x:0,y:0,width:C.getWidth(),height:P};di(Q,u),u.y=P,u.height=a(0,C.getHeight()-P),di(C.tv,u)}},ms_vs:function(D){D._41o=function(){return this._29I.height<this._59I},D._43o=function(){var a=this;a._41o()&&(a._58I||($(function(){a._94O()},ke),a.iv()),a._58I=new Date)},D._94O=function(){var L=this;if(L._58I){var k=new Date;k.getTime()-L._58I.getTime()>=ke?(delete L._58I,L.iv()):$(function(){L._94O()},ke)}},D._93I=function(){var B=this,j=B._27I;if(B._58I||!B._autoHideScrollBar){j||Ho(B._79O,j=B._27I=ob());var r=B._29I,O=r.height,s=B._59I,c=B.getScrollBarSize(),k=r.width-c-2,q=O*(-B.ty()/s),M=O*(O/s),i=j.style;s>O?(ng>M&&(q=q+M/2-ng/2,0>q&&(q=0),q+ng>O&&(q=O-ng),M=ng),i.visibility=ap,i.background=B.getScrollBarColor(),i.borderRadius=c/2+bl,di(j,k,q,c,M)):i.visibility=am}else j&&(j.style.visibility=am)}},ms_hs:function(d){d._40o=function(){return this._29I.width<this._91I},d._42o=function(){var l=this;l._40o()&&(l._95O||($(function(){l._94I()},ke),l.iv()),l._95O=new Date)},d._94I=function(){var Q=this;if(Q._95O){var H=new Date;H.getTime()-Q._95O.getTime()>=ke?(delete Q._95O,Q.iv()):$(function(){Q._94I()},ke)}},d._92I=function(){var F=this,B=F._28I;if(F._95O||!F._autoHideScrollBar){B||Ho(F._79O,B=F._28I=ob());var h=F._29I,e=h.width,C=F._91I,J=F.getScrollBarSize(),o=h.height-J-2,g=e*(-F.tx()/C),y=e*(e/C),m=B.style;C>e?(ng>y&&(g=g+y/2-ng/2,0>g&&(g=0),g+ng>e&&(g=e-ng),y=ng),m.visibility=ap,m.background=F.getScrollBarColor(),m.borderRadius=J/2+bl,di(B,g,o,y,J)):m.visibility=am}else B&&(B.style.visibility=am)}}}),nk(Qb,pn(16,16,[{type:Dl,rect:[1,1,14,14],background:Zr},{type:cd,rect:[1,1,14,14],width:1,color:uc},{type:Mh,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),nk(ao,pn(16,16,{type:cd,rect:[1,1,14,14],width:1,color:uc})),nk(gi,pn(16,16,[{type:Kf,rect:[2,2,12,12],borderWidth:1,borderColor:uc,background:"#FFF"},{type:Kf,rect:[4,4,8,8],background:Zr}])),nk(uf,pn(16,16,{type:Kf,rect:[2,2,12,12],borderWidth:1,borderColor:uc})),Uq._15Q=function(B){B._29I=on,B._59I=0,B._91I=0,B._5o=function(N){var q=this;q._30I=new Tr,q._rows=new Tr,q._rowMap={},q._31I=0,q._14I=0,q._view=tf(1,q),q._canvas=sn(q._view),Ho(q._view,q._79O=ob()),q.dm(N?N:new Er)},B.getCheckIcon=function(G){var J=this.sm(),d=J.co(G);return J.sg()?Ef(d?gi:uf):Ef(d?Qb:ao)},B.checkData=function(A){var s=this.sm(),Y=s.co(A);s.sg()&&Y||(this._32o=1,Y?s.rs(A):s.as(A),delete this._32o)},B.getDataAt=function(T){T.target&&(T=this.lp(T));var W=z(T.y/this._rowHeight),M=this._rows;return 0>W||W>=M.size()?A:M.get(W)},B.onDataDoubleClicked=function(){},B.onDataClicked=function(){},B.adjustTranslateX=function(){return 0},B.adjustTranslateY=function(J){var s=this.getHeight()-this._59I;return s>J&&(J=s),J>0?0:W(J)},B.onPropertyChanged=function(r){var H=this,Z=r.property;Qc[Z]?H.ivm():yi[Z]||H.redraw(),Z===mn?H._42o():Z===Kr&&H._43o()},B.getLabel=function(C){return C.toLabel()},B.getLabelFont=function(){return this._labelFont},B.getLabelColor=function(D){var l=this;if(l.isCheckMode()){if(l._focusData===D)return l._labelSelectColor}else if(l.isSelected(D))return l._labelSelectColor;return l._labelColor},B.getStartRowIndex=function(){return this._31I},B.getEndRowIndex=function(){return this._14I},B.getRowDatas=function(){return this._rows},B.getRowIndex=function(P){return this._rowMap[P._id]},B.getRowSize=function(){return this._rows.size()},B.getViewRect=function(){return Cc(this._29I)},B.isVisible=function(g){return this._visibleFunc?this._visibleFunc(g):!0},B.getCurrentSortFunc=function(){return this._sortFunc},B.setDataModel=function(U){var p=this,E=p._dataModel,u=p._selectionModel;E!==U&&(E&&(E.umm(p.handleDataModelChange,p),E.umd(p.handleDataPropertyChange,p),E.umh(p.handleHierarchyChange,p),u||E.sm().ums(p.handleSelectionChange,p)),p._dataModel=U,U.mm(p.handleDataModelChange,p),U.md(p.handleDataPropertyChange,p),U.mh(p.handleHierarchyChange,p),u?u._21I(U):U.sm().ms(p.handleSelectionChange,p),p.fp("dataModel",E,U))},B.validateModel=function(){var U=this;U._rows.clear(),U._rowMap={},U.buildChildren(U._dataModel._roots);var M=U._rows=U._rows.toList(U.isVisible,U),h=0,L=U.getCurrentSortFunc(),k=M.size();for(L&&M.sort(L);k>h;h++)U._rowMap[M.get(h)._id]=h},B.buildChildren=function(g){var k=this;g.each(function(X){k._rows.add(X),k.buildChildren(X._children)})},B.handleDataModelChange=function(){this.ivm()},B.handleDataPropertyChange=function(c){"parent"===c.property?this.ivm():this.invalidateData(c.data)},B.handleHierarchyChange=function(){this.ivm()},B.handleSelectionChange=function(F){F.datas.each(this.invalidateData,this),this.onSelectionChanged(F)},B.onSelectionChanged=function(r){var C=this,j=C.sm();!C.isAutoMakeVisible()||1!==j.size()||"set"!==r.kind&&"append"!==r.kind||C._32o||C.makeVisible(j.ld())},B.handleBackgroundClick=function(T){Qf(T)&&!this.isCheckMode()&&this.sm().cs()},B.makeVisible=function(O){O&&(this._23I=O,this.iv())},B.scrollToIndex=function($){var b=this,V=b._29I,e=V.height,w=b._rowHeight,S=w*$;$>=0&&$<b._rows.size()&&e>0&&(S+w>V.y+e?b.ty(-S+e-w):S<V.y&&b.ty(-S))},B.autoScroll=function(x,Z){var T=this,I=T._rowHeight,e=I,u=I/4,C=T._29I,P=T.lp(x),k={x:T.tx(),y:T.ty()};return I>0&&C&&(P.x-C.x<e?T.translate(u,0):C.x+C.width-P.x<e&&T.translate(-u,0),P.y-C.y<e?T.translate(0,u):C.y+C.height-P.y<e&&T.translate(0,-u)),k.x=T.tx()-k.x,k.y=T.ty()-k.y,Z&&(Z.x+=k.x,Z.y+=k.y),k},B.getTopRowOrderSelection=function(){var X=this.sm().getTopSelection(),S={},l=new Tr;return X.each(function(e){S[e._id]=e}),this._rows.each(function(P){S[P._id]&&l.add(P)}),l},B.getRowOrderSelection=function(){var x=new Tr;return this._rows.each(function(d){this.isSelected(d)&&x.add(d)},this),x},B.ivm=function(){this.invalidateModel()},B.invalidateModel=function(){var q=this;q._96I||(q._96I=1,q._32I=1,delete q._24I),q.iv()},B.redraw=function(){var r=this;r._32I||(r._32I=1,delete r._24I,r.iv())},B.invalidateData=function(O){var t=this;Uf?t.redraw():t._32I||(t._24I||(t._24I={}),t._24I[O._id]=O,t.iv())},B.getFocusData=function(){return this._focusData},B.setFocusDataById=function(L){this.setFocusData(this.dm().getDataById(L))},B.setFocusData=function(K){var D=this,C=D._focusData;C!==K&&(D._focusData=K,D.fp("focusData",C,K),C&&D.invalidateData(C),K&&(D.invalidateData(K),D.isAutoMakeVisible()&&D.makeVisible(K)))},B.drawRowBackground=function(e,m,l,x,N,t,U){var n=this,T=n.isCheckMode();(m===n._focusData&&T||l&&!T)&&ld(e,x,N,t,U,n.getSelectBackground(m))},B.drawData=function(I,M,t){var S=this,X=S._rowHeight,R=X*t,x=S._29I,k=x.x,Q=x.width;I.save(),I.beginPath(),I.rect(k,R,Q,X),I.clip(),S._87o(S.drawRow(I,M,S.isSelected(M),k,R,Q,X),t,k,R,Q,X),I.restore(),S._rowLineVisible&&ld(I,k,R+X-1,Q,1,S._rowLineColor)},B._12I=function(Y){var c=this,q=c._31I,l=c._29I,p=l.x,T=l.y,N=l.width,_=l.height;for(Y.beginPath(),Y.rect(p,T,N,_),Y.clip(),Y.clearRect(p,T,N,_),c._76o(),c._93db(Y);q<c._14I;q++)c.drawData(Y,c._rows.get(q),q);c._92db(Y)},B._13I=function(x){for(var N,C=this,J=C._rowHeight,o=C._29I,_=o.x,D=o.width,F=C._31I,y=C._30I;F<C._14I;F++)N=C._rows.get(F),C._24I[N._id]&&y.add({data:N,index:F});y.isEmpty()||(x.beginPath(),y.each(function(h){x.rect(_,h.index*J,D,J)}),x.clip(),y.each(function(X){x.clearRect(_,X.index*J,D,J)}),y.each(function(q){C._77o(q.index)}),C._93db(x),y.each(function(s){C.drawData(x,s.data,s.index)}),C._92db(x),y.clear())},B.preValidateModel=function(){this.endEditing&&this.endEditing()},B.validateImpl=function(){var Q=this,o=Q._canvas,X=Q.getWidth(),U=Q.getHeight(),M=Q._rowHeight,W=Q._32I;(X!==o.clientWidth||U!==o.clientHeight)&&(jk(o,X,U),W=1);var u=H&&!s;Q._96I&&!u&&(Q.preValidateModel(),Q.validateModel());var G=Q._29I,q={x:-Q.tx(),y:-Q.ty(),width:X,height:U},V=Q._rows.size(),d=Sl(o),Y=Q._23I;W||Bh(q,G)||(W=1),Q._29I=q,Q._59I=V*M+Q.getScrollBarSize(),Q._31I=z(q.y/M),Q._14I=m((q.y+q.height)/M),Q._31I<0&&(Q._31I=0),Q._14I>V&&(Q._14I=V),Q._99I&&W&&Q._99I(),cm(d,Q.tx(),Q.ty(),1),W?Q._12I(d):Q._24I&&Q._13I(d),Q._93I(),Q._92I(),d.restore(),Q._32I=Q._24I=Q._96I=A,Y&&(Q.scrollToIndex(Q.getRowIndex(Y)),delete Q._23I),Q.tx(Q.tx()),Q.ty(Q.ty())}},Uq._48o=function(d){d._rootVisible=!0,d._rootData=A,d._35o=function(){this._expandMap={},this._levelMap={}},d.validateModel=function(){var z=this,s=z._rootData;z._rows.clear(),z._levelMap={},z._rowMap={},z._currentLevel=0,s?z._rootVisible?z.isVisible(s)&&z.buildData(s):z.buildChildren(s):z.buildChildren(),delete z._currentLevel},d.buildData=function(p){var q=this,F=p._id,x=q._rows;q._rowMap[F]=x.size(),x.add(p),q._levelMap[F]=q._currentLevel,q.isExpanded(p)&&(q._currentLevel++,q.buildChildren(p),q._currentLevel--)},d.buildChildren=function(S){var Y=this,q=S?S._children:Y._dataModel._roots,I=Y.getCurrentSortFunc();I&&Y.isChildrenSortable(S)?q.toList(Y.isVisible,Y).sort(I).each(Y.buildData,Y):q.each(function(Z){Y.isVisible(Z)&&Y.buildData(Z)})},d.getLevel=function(M){return this._levelMap[M._id]},d.getToggleIcon=function(k){var S=this,n=S._loader,Y=S._collapseIcon;return n&&!n.isLoaded(k)?Y:k.hasChildren()?S.isExpanded(k)?S._expandIcon:Y:A},d.isCheckMode=function(){return this._checkMode!=A},d.isChildrenSortable=function(){return!0},d.handleDataModelChange=function(x){var m=this;x.kind===kc?delete m._expandMap[x.data._id]:x.kind===Bj&&(m._expandMap={}),m.ivm()},d.toggle=function(P){var s=this;s.isExpanded(P)?s.collapse(P):s.expand(P)},d.isExpanded=function(I){return 1===this._expandMap[I._id]},d.expand=function(d){var a=this,y=a._loader;a.isExpanded(d)||(y&&!y.isLoaded(d)&&y.load(d),a._expandMap[d._id]=1,a.ivm(),a.onExpanded(d))},d.onExpanded=function(){},d.collapse=function(v){var Y=this;Y.isExpanded(v)&&(delete Y._expandMap[v._id],Y.ivm(),Y.onCollapsed(v))},d.onCollapsed=function(){},d.expandAll=function(T){if(T)this.expand(T),T.eachChild(function(y){this.expandAll(y)},this);else{var d=this;d._dataModel.each(function(S){S.hasChildren()&&(d._expandMap[S._id]=1)}),d.ivm()}},d.collapseAll=function(){this._expandMap={},this.ivm()},d.makeVisible=function(V){if(V){var S=this;if(!S._rootData||V.isDescendantOf(S._rootData)){for(var D=V._parent;D;)S.expand(D),D=D._parent;S._23I=V,S.iv()}}},d.checkData=function(C){var P,G=this,_=G._checkMode,S=G.sm(),c=S.co(C);if(!S.sg()||!c){if(G._32o=1,_===Qi)c?S.rs(C):S.as(C);else if(_===Sm)P=new Tr(C),P.addAll(C._children);else if("descendant"===_)P=new Tr,ep(C,P);else if("all"===_&&(P=new Tr,ep(C,P),!c))for(var v=C._parent;v;)P.add(v),v=v._parent;P&&(c?S.rs(P):S.as(P)),delete G._32o}},d.drawTree=function(o,C,u,m,Z,T,x){var q=this,Y=q._indent,z=q._levelMap[C._id],p=q.getIconWidth(C),O=Ef(q.getToggleIcon(C));O?(m+=Y*z,te(o,O,m+Y/2,Z+x/2,C,q),m+=Y):m+=Y*(z+1),q._checkMode&&(te(o,q.getCheckIcon(C),m+Y/2,Z+x/2,C,q),m+=Y),q.drawIcon(o,C,m,Z,p,x),q.drawLabel(o,C,m+p,Z,x)}},Uq._14Q=function(N){N.getIcon=function(E){return E.getIcon()},N.getIconWidth=function(v){return this.getIcon(v)?this._indent:0},N.drawIcon=function(I,l,h,c,A,x){if(A){var X=this,y=X.getBodyColor(l),g=Ef(X.getIcon(l),y);g&&(x-=X.isRowLineVisible()?1:0,Pf(I,g,lm,h,c,A,x,l,X,y),Yf(I,X.getBorderColor(l),h,c,A,x))}},N.drawLabel=function(x,Z,K,G,B){var c=this;wo(x,c.getLabel(Z),c.getLabelFont(Z),c.getLabelColor(Z),K,G,0,B)}},Uq._50o=function(v){v._98I=function(){var Q=this,l=Q._39o=new Er;Q._60I=new Tr,l.mm(Q._17o,Q),l.md(Q._18o,Q),l.mh(Q._19o,Q)},v.setColumns=function(d){this._39o.clear(),this.addColumns(d)},v.addColumns=function(L){var e=this._39o;L.forEach(function(v){if(!(v instanceof Wq)){var g=us(v.className);v=Ld(g?g:Wq,v)}e.add(v)})},v.onColumnClicked=function(){},v.onCheckColumnClicked=function(){},v._3Q=function(r){for(var N,n=0,U=this._60I,d=U.size();d>n;n++)if(N=U.get(n),N.column===r)return N;return A},v.getColumnAt=function(E){var w=this._4Q(E);return w?w.column:A},v._4Q=function(J){for(var s=this,c=J.target?s.lp(J).x:J.x,e=s._60I,t=0;t<e.size();t++){var d=e.get(t),f=d.startX;if(c>=f&&c<f+d.column.getWidth())return d}return A},v.getToolTip=function(s){var z=this,j=z.getDataAt(s),v=z.getColumnAt(s);return j&&v?v.getToolTip(j,z):A},v.adjustTranslateX=function(O){var H=this.getWidth()-this._91I;return H>O&&(O=H),O>0?0:W(O)},v._99I=function(){var S=this,i=S._29I,H=S._60I;H.clear(),S._91I=0,S._39o._roots.each(function(X){if(X.isVisible()){var B=S._91I+X.getWidth();S._91I<=i.x+i.width&&B>=i.x&&H.add({column:X,startX:S._91I}),S._91I=B}}),S._91I+=S.getScrollBarSize()},v.drawData=function(m,l,F){var V=this,x=V._rowHeight,t=x*F,O=V.isSelected(l),C=V._29I,J=C.x,U=C.width;V.drawRowBackground(m,l,O,J,t,U,x),V._60I.each(function(M){var q=M.column,D=M.startX,Q=q.getWidth();Q>0&&!V.isEditing(l,q)&&(m.save(),m.beginPath(),m.rect(D,t,Q,x),m.clip(),V._87o(V.drawCell(m,l,O,q,D,t,Q,x),F,D,t,Q,x),V._columnLineVisible&&ld(m,D+Q-1,t,1,x,V._columnLineColor),m.restore())}),V._rowLineVisible&&ld(m,J,t+x-1,U,1,V._rowLineColor)},v.drawCell=function(E,j,H,u,x,d,D,g){var n=this;if(u.drawCell)return u.drawCell(E,j,H,u,x,d,D,g,n);var m=n.getValue(j,u);dr(E,m,u,n.getLabelFont(j,u,m),n.getLabelColor(j,u,m),x,d,D,g,j,n)},v.getColumnModel=function(){return this._39o},v._17o=function(){this.redraw()},v._18o=function(u){var L=this;u.data===L._sortColumn&&Pb[u.property]?L.ivm():(L._42o(),L.redraw())},v._19o=function(){this.redraw()},v.getCurrentSortFunc=function(){var Q=this,Y=Q._sortColumn;if(Y&&Y.isSortable()){var C=Y.getSortFunc(),o=Wr===Y.getSortOrder()?1:-1;return C||(C=wb),function(s,I){return C.call(Q,Q.getValue(s,Y),Q.getValue(I,Y),s,I)*o}}return Q._sortFunc},v.isCellEditable=function(i,z,I){return z.isEditable()&&this.isEditable()?z.isCellEditable?z.isCellEditable(i,z,I,this):!0:!1},v._37O=function(J,j){if(Qf(j))for(var R=this,m=R.lp(j),u=R._60I,T=R._rowHeight,k=R._29I,G=k.x,y=k.y,P=k.width,D=k.height,f=0;f<u.size();f++){var I=u.get(f),N=I.startX,H=I.column,l=H.getWidth();if(H!==R._31o&&H!==R._4o&&m.x>=N&&m.x<N+l&&R.isCellEditable(J,H,j)){var r={x:N,y:R.getRowIndex(J)*T,width:l,height:T},C={x:r.x+R.tx(),y:r.y+R.ty(),width:r.width,height:r.height},e=0,g=0;return r.x<G?e=r.x-G:r.x+r.width>G+P&&(e=r.x+r.width-G-P),e&&(R.tx(R.tx()-e),C.x-=e),r.y<y?g=r.y-y:r.y+T>y+D&&(g=r.y+T-y-D),g&&(R.ty(R.ty()-g),C.y-=g),R.beginEditing({data:J,column:H,value:R.getValue(J,H),event:j,rect:r,editorRect:C,view:R}),void 0}}}},qm.BaseItemEditor=function(i,V,g,t){this._data=i,this._column=V,this._master=g,this._editInfo=t},Ap("BaseItemEditor",N,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Uj=P.Tab=function(){yf(Uj,this)};hh("Tab",ej,{ms_ac:["view","closable","disabled","visible"],_icon:A,_closable:!1,_disabled:!1,_visible:!0,setParent:Od});var Wq=P.Column=function(){yf(Wq,this)};hh("Column",ej,{_46o:1,ms_ac:["accessType","valueType",ap,tr,pg,Cq,"align",jq,"sortOrder",tj,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Wr,_sortFunc:A,_sortable:!0,_clickable:!0,setWidth:function(i){16>i&&(i=16);var e=this._width;this._width=i,this.fp(Cq,e,i)},getToolTip:function(l,a){return this.formatValue(a.getValue(l,this))}});var sj=P.Property=function(){yf(sj,this)};hh("Property",ej,{_46o:1,ms_ac:["accessType","valueType",tr,pg,"categoryName",jq,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:A,getToolTip:function(M,Q,i){var L=this;return Q?L.formatValue(i.getValue(M,L)):i.getPropertyName(L)}}),qm.AccordionView=function(){var l=this;l._20o={},l._21o=new Tr,l._10o=A,l._9o=A,l._11o=A,l._view=tf(0,l),l.iv()},Ap("AccordionView",N,{ms_v:1,ms_fire:1,ms_ac:[Ib,wh,"titleHeight",df,Dr,"titleBackground","selectWidth",Rn,"orientation","separatorColor"],_expandIcon:b.accordionViewExpandIcon,_collapseIcon:b.accordionViewCollapseIcon,_titleHeight:qk,_labelColor:b.accordionViewLabelColor,_labelFont:b.accordionViewLabelFont,_titleBackground:b.accordionViewTitleBackground,_selectBackground:b.accordionViewSelectBackground,_selectWidth:b.accordionViewSelectWidth,_orientation:"v",_separatorColor:b.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(C,k,F,q){var L=this,v=ob(),a={content:k,div:v,canvas:sn(v),icon:q};if(L._20o[C])throw C+" already exists";var $=a.downEventFunc=function(m){Rj(m)},y=a.upEventFunc=function(U){Rj(U),Qf(U)&&(L._10o===C?L.collapse():L.expand(C))};[Cb,bo].forEach(function(Y){d(v,Y,$)}),[is,Sq].forEach(function(n){d(v,n,y)}),v.style.cursor=ug,Ho(L._view,v),L._20o[C]=a,L._21o.add(C),F&&L.expand(C),L.iv()},remove:function(Y){var L=this,O=L._20o[Y];if(O){var j=O.div;Sc(j),[Cb,bo].forEach(function(r){B(j,r,O.downEventFunc)}),[is,Sq].forEach(function($){B(j,$,O.upEventFunc)}),delete L._20o[Y],L._21o.remove(Y),L.iv()}},clear:function(){var p=this;p._21o.toArray().forEach(p.remove,p),p._20o={},p._21o.clear(),p.iv()},isExpanded:function(p){return this._10o===p},expand:function(k){var d=this;d._20o[k]&&d._10o!==k&&(d._10o=k,d.onExpanded(k),d.iv())},onExpanded:function(){},collapse:function(){var Q=this;Q._10o&&(Q.onCollapsed(Q._10o),delete Q._10o,Q.iv())},onCollapsed:function(){},initCanvas:function(a,k,E){jk(a,k,E);var v=Sl(a);return cm(v,0,0,1),v.clearRect(0,0,k,E),v},drawTitle:function(y,W,E,i,u){var g=this,d=Ef(u.icon),X=g.isExpanded(W),N=g._titleHeight,S=g._titleBackground,r=g._selectWidth,F=g._separatorColor,k=Ef(X?g._expandIcon:g._collapseIcon),B=r+4;ld(y,0,0,E,i,S),X&&r&&ld(y,0,0,r,i,g._selectBackground),(X||g._21o.get(g._21o.size()-1)!==W)&&ld(y,0,i-1,E,1,F?F:Co(S)),d&&(te(y,d,B+pl(d)/2,N/2),B+=pl(d)+2),wo(y,W,g.getLabelFont(W),g.getLabelColor(W),B,0,0,N),k&&te(y,k,E-pl(k)/2-4,N/2)},validateImpl:function(){var H=this,c=H._view,p=0,N=0,P=H.getWidth(),W=H.getHeight(),x=H._titleHeight,j=H._21o.size()*x,F=H._11o,m=H._9o;delete H._11o,delete H._9o,H._21o.each(function(I){var U,E,m=H._20o[I],h=m.content,$=H._10o===I;Nc(H)?(di(m.div,p,0,x,W),U=H.initCanvas(m.canvas,x,W),Xf(U,0,W),jb(U,-Z),H.drawTitle(U,I,W,x,m),U.restore(),$?(E=a(0,P-j),h&&(H._11o=h,H._9o=If(h),di(h,p+x,0,E,W)),p+=x+E):p+=x):(di(m.div,0,N,P,x),U=H.initCanvas(m.canvas,P,x),H.drawTitle(U,I,P,x,m),U.restore(),$?(E=a(0,W-j),h&&(H._11o=h,H._9o=If(h),di(h,0,N+x,P,E)),N+=x+E):N+=x)});var z=H._9o;F&&F!==H._11o&&F.endEditing&&F.endEditing(),z&&z!==m&&Ho(c,z),m&&m!==z&&Sc(m)}}),qm.SplitView=function(H,l,r,L){var $=this,P=$._dividerDiv=ob(),R=$._60O=sn(),Y=$._61O=sn(),h=R.style,u=Y.style;$._view=tf(1,$),Ho($._view,P),h.msTouchAction=qq,h.pointerEvents=qq,h.cursor=ug,u.msTouchAction=qq,u.pointerEvents=qq,u.cursor=ug,H&&$.setLeftView(H),l&&$.setRightView(l),r&&$.setOrientation(r),L!=A&&$.setPosition(L),$.setStatus(Jn),new Zb($)},Ap("SplitView",N,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:b.splitViewDividerSize,_dividerBackground:b.splitViewDividerBackground,_dragOpacity:b.splitViewDragOpacity,_toggleIcon:b.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(t,L){var E=this,T=E._position;isNaN(t)||(L||(E._82O=0>t?-1:t>1?1:0),E._position=t,E.fp(yk,T,t))},getLeftView:function(){return this._leftView},setLeftView:function(T){var u=this,p=u._leftView,K=u._view;if(u._leftView!==T){if(p&&p!==u._rightView){var V=If(p);V.parentNode===K&&Sc(V)}if(u._leftView=T,T){var d=If(T);d.parentNode!==K&&K.insertBefore(d,u._dividerDiv)}u.fp("leftView",p,T)}},getRightView:function(){return this._rightView},setRightView:function(N){var i=this,p=i._rightView,l=i._view;if(i._rightView!==N){if(p&&p!==i._leftView){var m=If(p);m.parentNode===l&&Sc(m)}if(i._rightView=N,N){var u=If(N);u.parentNode!==l&&l.insertBefore(u,i._dividerDiv)}i.fp("rightView",p,N)}},validateImpl:function(){var G=this,m=G._draggable,K=G._position,u=G.getWidth(),y=G.getHeight(),d=G._dividerSize,S=G._dividerBackground,A=tc?18:8,l=G._dividerDiv,R=G._82O,o=G._60O,V=G._61O,j=G._toggleIcon,r=G._status,s=l.style,U=null,H=tc?20:4,F=j.comps[0];d>=A||0===d?G._coverDiv&&(Sc(G._coverDiv),delete G._coverDiv):G._coverDiv||(G._coverDiv=ob(),Yi&&(G._coverDiv.style.background=Ph),Ho(l,G._coverDiv)),G._togglable?o.parentNode||(Ho(l,o),Ho(l,V)):(Sc(o),Sc(V));var J=G._coverDiv,t=G._leftView,g=G._rightView;if(Nc(G)){if(d>u&&(d=u),r===Jn)if(1===R)var _=C(K,u),e=a(0,u-d-_);else-1===R?(e=C(-K,u),_=a(0,u-d-e)):(_=W((u-d)*K),e=a(0,u-d-_));else"cl"===r?(_=0,e=a(0,u-d)):"cr"===r&&(e=0,_=a(0,u-d));t&&di(t,0,0,_,y),g&&di(g,_+d,0,e,y),di(l,_,0,d,y),G._22o=_,J&&(di(J,d/2-A/2,0,A,y),J.style.cursor=m?bm:""),l.style.cursor=m?bm:"";var h=l.clientHeight/2,X=l.clientWidth;jk(o,X,X),di(o,0,h-X-H,X,X),U=Sl(o),cm(U,0,0,1),F.rotation=-Z,Vh(U,j,0,0,X,X),U.restore(),jk(V,X,X),di(V,0,h+H,X,X),U=Sl(V),cm(U,0,0,1),F.rotation=Z,Vh(U,j,0,0,X,X),U.restore()}else{if(d>y&&(d=y),r===Jn)if(1===R)var z=C(K,y),w=a(0,y-d-z);else-1===R?(w=C(-K,y),z=a(0,y-d-w)):(z=W((y-d)*K),w=a(0,y-d-z));else"cl"===r?(z=0,w=a(0,y-d)):"cr"===r&&(w=0,z=a(0,y-d));t&&di(t,0,0,u,z),g&&di(g,0,z+d,u,w),di(l,0,z,u,d),G._22o=z,J&&(di(J,0,d/2-A/2,u,A),J.style.cursor=m?rk:""),s.cursor=m?rk:"";var i=l.clientWidth/2,X=l.clientHeight;jk(o,X,X),di(o,i-X-H,0,X,X),U=Sl(o),cm(U,0,0,1),F.rotation=0,Vh(U,j,0,0,X,X),U.restore(),jk(V,X,X),di(V,i+H,0,X,X),U=Sl(V),cm(U,0,0,1),F.rotation=O,Vh(U,j,0,0,X,X),U.restore()}s.background=S}});var Zb=function(P){this.sv=P,this.addListeners()};$g(Zb,N,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(v){var e=this,k=e.sv,Y=k._dividerDiv,i=k._60O,q=k._61O,u=k._status,M=v.target;if(M===i)u===Jn?k.setStatus("cl"):"cr"===u&&k.setStatus(Jn);else if(M===q)u===Jn?k.setStatus("cr"):"cl"===u&&k.setStatus(Jn);else if(nl(v)&&(M===Y||M===k._coverDiv)&&(Rj(v),k.isDraggable())){k.getLeftView(),k.getRightView();var U=e.maskDiv=ob();if(U.style.left=0,U.style.top=0,U.style.width=k.getWidth()+"px",U.style.height=k.getHeight()+"px",k.getView().appendChild(U),!k.isContinuousLayout()){var d=e.resizeDiv=ob();d.style.left=Y.style.left,d.style.top=Y.style.top,d.style.width=Y.style.width,d.style.height=Y.style.height,d.style.opacity=k.getDragOpacity(),d.style.background=k.getDividerBackground(),Ho(e.getView(),d)}e._lastAbsPosition=k._22o,e._86o=Nc(k)?nq(v).x:nq(v).y,qf(e,v)}},handleWindowTouchMove:function(v){nl(v)&&this.update(v,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(g){var H=this;H.update(g,!0),H.sv.setStatus(Jn),H.maskDiv&&Sc(H.maskDiv),H.resizeDiv&&Sc(H.resizeDiv),H.maskDiv=H.resizeDiv=A},handle_mousedown:function(C){Qf(C)&&this.handle_touchstart(C)},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},update:function(I,v){var g=this,K=g.sv,h=Nc(K)?K.getWidth():K.getHeight(),V=K._dividerSize,C=g._lastAbsPosition-g._86o;Nc(K)?(C+=nq(I).x,C>h-V&&(C=h-V),0>C&&(C=0),g.resizeDiv&&(g.resizeDiv.style.left=C+bl)):(C+=nq(I).y,C>h-V&&(C=h-V),0>C&&(C=0),g.resizeDiv&&(g.resizeDiv.style.top=C+bl)),v&&h!==V&&(1===K._82O?K.setPosition(C,1):-1===K._82O?K.setPosition(C-h+V,1):K.setPosition(C/(h-V),1))}}),qm.TabView=function(){var m=this,x=m._view=tf(1,m),C=m._91O=ob(1),h=m._tabModel=new Er,S=h.sm(),Q=m.invalidate;m._7o=new Tr,m._canvas=sn(C),Ho(x,C),Ho(x,m._92O=ob(1)),S.setSelectionMode(Oq),S.ms(m.handleSelectionChange,m),h.mm(Q,m),h.mh(Q,m),h.md(Q,m),m._interactor=new Hm(m),m.iv()},Ap("TabView",N,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",df,Dr,"tabHPadding","tabBackground","selectWidth",Rn,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Oe,_tabHeight:qk,_tabGap:b.tabViewTabGap,_labelColor:b.tabViewLabelColor,_labelFont:b.tabViewLabelFont,_tabBackground:b.tabViewTabBackground,_selectWidth:b.tabViewSelectWidth,_selectBackground:b.tabViewSelectBackground,_moveBackground:b.tabViewMoveBackground,_insertColor:b.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(H,W,Y){var g,m=this._tabModel;return H instanceof Uj?(g=H,W&&g.setView(W)):(g=new Uj,g.setName(H),g.setView(W)),m.add(g),Y&&m.sm().ss(g),g},getLabel:function(N){return N.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(r){this._23o=r,this.iv()},get:function(i){var S=this,U=S._tabModel;if(vp(i))return U._roots.get(i);if(nf(i)){var R;return U.each(function(d){i===S.getLabel(d)&&(R=d)}),R}return i instanceof Uj?i:A},select:function($){this._tabModel.sm().ss(this.get($))},remove:function(a){var Y=this;if(a=Y.get(a)){var S=Y._tabModel,Q=S._roots.indexOf(a);Y._tabModel.remove(a),Y.selectByIndex(--Q)}},getCurrentTab:function(){return this._8o},hideTabView:function(h,y){y.parentNode===this._92O&&(hg(y)?(y.style.display=ei,y._tab_=h):Sc(y),lr())},showTabView:function(r,K){hg(K)&&(K.style.display="block",K._tab_=r),K.parentNode!==this._92O&&(Ho(this._92O,K),lr())},_24o:function(){var Y,x=this,b=x._8o,F=x._9o,$=x._tabModel.sm().ld();
$&&(Y=If($.getView())),Y!==F&&(F&&(b.getView()&&b.getView().endEditing&&b.getView().endEditing(),x.hideTabView(b,F)),Y&&x.showTabView($,Y)),x._8o=$,x._9o=Y,b!==$&&x.onTabChanged(b,$)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(c,n){this.selectByIndex(--n)},selectByIndex:function(Y){var E=this,j=E._tabModel,W=j.size();if(W&&!j.sm().ld()){Y==A&&(Y=0),Y>=W&&(Y=W-1),0>Y&&(Y=0);for(var Z=Y;Z>=0;Z--){var H=E.get(Z);if(!H.isDisabled())return E.select(H),H}for(Z=Y+1;W>Z;Z++)if(H=E.get(Z),!H.isDisabled())return E.select(H),H}},getTabWidth:function(E){var X=this.getTabHPadding(),a=4+2*X,x=Ef(E.getIcon());x&&(a+=pl(x,E)+4);var M=this.getLabel(E);return M&&(a+=Io(this.getLabelFont(E),M).width+4),E.isClosable()&&(a+=10),a},drawTab:function(t,M,Y,p,l,Q,K){var A,X=this,f=X._tabPosition,W=this.getTabHPadding(),T=Y+4+W,R=X._selectWidth,k=Ef(M.getIcon()),g=M.isDisabled(),i=X.getLabelColor(M),V=X.getLabelFont(M),D=X.getLabel(M),N=X._selectBackground,G=f===Rc+"-vertical",d=f===Pc+"-vertical";(G||d)&&(T=p+4+W),g&&(t.globalAlpha=Sb),ld(t,Y,p,l,Q,K),M===X._8o&&R&&(f===Oe?ld(t,Y,p+Q-R,l,R,N):f===Rc?ld(t,Y+l-R,p,R,Q,N):f===Pc?ld(t,Y,p,R,Q,N):G?ld(t,Y+l-R,p,R,Q,N):d?ld(t,Y,p,R,Q,N):ld(t,Y,p,l,R,N));var c=l/2;if(G&&(Xf(t,c,p+Q/2),jb(t,O),Xf(t,-c,-p-Q/2)),k){var m=Vf(k,M),z=pl(k,M);if(G||d){var w=Y+l/2,$=T+m/2;Xf(t,w,$),jb(t,Z),Xf(t,-w,-$),te(t,k,Y+l/2,T+m/2,M,X),Xf(t,w,$),jb(t,-Z),Xf(t,-w,-$),T+=m+4}else te(t,k,T+z/2,p+Q/2,M,X),T+=z+4}return G||d?(Xf(t,l/2,T+l/2),jb(t,Z),Xf(t,-l/2,-T-l/2),wo(t,D,V,i,Y,T,Q,l),Xf(t,l/2,T+l/2),jb(t,-Z),Xf(t,-l/2,-T-l/2)):wo(t,D,V,i,T,p,l,Q),G&&(Xf(t,c,p+Q/2),jb(t,-O),Xf(t,-c,-p-Q/2)),M.isClosable()&&(A=d?{x:Y+l-12,y:p+Q-12,width:12,height:12}:{x:Y+l-12,y:p+2,width:12,height:12},this.drawCloseIcon(M,t,i,A)),g&&(t.globalAlpha=1),A},drawCloseIcon:function(k,I,g,N){var v=N.x,P=N.y;I.strokeStyle=g,I.lineWidth=1,I.beginPath(),I.moveTo(v+2,P+8),I.lineTo(v+8,P+2),I.moveTo(v+8,P+8),I.lineTo(v+2,P+2),I.stroke()},getTabAt:function(J){var y=this._interactor._8Q(J);return y?y.tab:null},validateImpl:function(){var I=this;I._24o();var b,y=I._canvas,Y=I._tabPosition,f=I._91O,A=I._92O,j=I._tabModel,Z=I.getWidth(),h=I.getHeight(),d=I._tabHeight,g=I._7o,S=I._tabGap,M=Y===Oe,J=Y===Rc,t=Y===Pc,C=Y===Rc+"-vertical",Q=Y===Pc+"-vertical",s=I._23o,T=0;if((J||t)&&j._roots.each(function(w){T=a(I.getTabWidth(w),T)}),M?(di(f,0,0,Z,d),b={x:0,y:d,width:Z,height:a(0,h-d)}):J?(di(f,0,0,T,h),b={x:T,y:0,width:a(0,Z-T),height:h}):t?(di(f,Z-T,0,T,h),b={x:0,y:0,width:a(0,Z-T),height:h}):C?(di(f,0,0,d,h),b={x:d,y:0,width:a(0,Z-d),height:h}):Q?(di(f,Z-d,0,d,h),b={x:0,y:0,width:a(0,Z-d),height:h}):(di(f,0,h-d,Z,d),b={x:0,y:0,width:Z,height:a(0,h-d)}),di(A,b),C||Q){I._9o&&(b.x=0,di(I._8o.getView(),b)),jk(y,d,h);var c=Sl(y),n=0;if(cm(c,0,I.ty(),1),c.clearRect(0,0,d,h),g.clear(),j._roots.each(function(B){if(B.isVisible()){var J,Q=I.getTabWidth(B);s&&s.tab===B||(J=I.drawTab(c,B,0,n,d,Q,I._tabBackground)),g.add({_75o:J,tab:B,startY:n,endY:n+Q,height:Q}),n+=Q+S}}),I._23Q=a(0,n-S),s){var N=s.position;I.drawTab(c,s.tab,0,s.startY,d,s.height,I._moveBackground),ld(c,0,N,d,1,I._insertColor)}if(c.restore(),I._selectionChanged){I._selectionChanged=!1;for(var v=I.ty(),U=0;U<g.size();U++){var D=g.get(U);if(D.tab===I._8o){if(D.endY+v<0){I.ty(-D.startY);break}if(D.startY+v>h){I.ty(h-D.endY);break}}}}I.ty(I.ty())}else if(J||t){I._9o&&(b.x=0,di(I._8o.getView(),b)),jk(y,T,h);var c=Sl(y),n=0;if(cm(c,0,I.ty(),1),c.clearRect(0,0,T,h),g.clear(),j._roots.each(function(D){if(D.isVisible()){var J;s&&s.tab===D||(J=I.drawTab(c,D,0,n,T,d,I._tabBackground)),g.add({_75o:J,tab:D,startY:n,endY:n+d,height:d}),n+=d+S}}),I._23Q=a(0,n-S),s){var N=s.position;I.drawTab(c,s.tab,0,s.startY,T,s.height,I._moveBackground),ld(c,0,N,T,1,I._insertColor)}if(c.restore(),I._selectionChanged){I._selectionChanged=!1;for(var v=I.ty(),U=0;U<g.size();U++){var D=g.get(U);if(D.tab===I._8o){if(D.endY+v<0){I.ty(-D.startY);break}if(D.startY+v>h){I.ty(h-D.endY);break}}}}I.ty(I.ty())}else{I._9o&&(b.y=0,di(I._8o.getView(),b)),jk(y,Z,d);var c=Sl(y),P=0;if(cm(c,I.tx(),0,1),c.clearRect(0,0,Z,d),g.clear(),j._roots.each(function(n){if(n.isVisible()){var J,H=I.getTabWidth(n);s&&s.tab===n||(J=I.drawTab(c,n,P,0,H,d,I._tabBackground)),g.add({_75o:J,tab:n,startX:P,endX:P+H,width:H}),P+=H+S}}),I._64I=a(0,P-S),s){var N=s.position;I.drawTab(c,s.tab,s.startX,0,s.width,d,I._moveBackground),me(c,I._insertColor,N,0,d)}if(c.restore(),I._selectionChanged){I._selectionChanged=!1;for(var m=I.tx(),U=0;U<g.size();U++){var D=g.get(U);if(D.tab===I._8o){if(D.endX+m<0){I.tx(-D.startX);break}if(D.startX+m>Z){I.tx(Z-D.endX);break}}}}I.tx(I.tx())}for(var r=[],K=A.children,U=0;U<K.length;U++){var $=K[U],i=$._tab_;i&&!j.contains(i)&&r.push($)}r.forEach(function(a){A.removeChild(a)})}});var Hm=function(R){this.tv=R,this.addListeners()};$g(Hm,N,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(S){this.handleScroll(S,10*(S.wheelDelta/40))},handle_DOMMouseScroll:function(R){this.handleScroll(R,10*-R.detail)},handleScroll:function(H,I){Rj(H);var i=this.tv,_=i._tabPosition;!i._40o()||_!==Oe&&_!==fl||i.tx(this.tv.tx()+I),!i._41o()||_!==Rc&&_!==Pc&&_!==Rc+"-vertical"&&_!==Pc+"-vertical"||i.ty(this.tv.ty()+I)},_8Q:function(y){var E,V,D=this.tv,r=D._tabPosition,K=D._7o;if(r===Oe||r===fl){var T=D.lp(y).x;for(E=0;E<K.size();E++)if(V=K.get(E),V.startX<=T&&T<=V.endX)return V}else if(r===Rc||r===Pc||r===Rc+"-vertical"||r===Pc+"-vertical"){var S=D.lp(y).y;for(E=0;E<K.size();E++)if(V=K.get(E),V.startY<=S&&S<=V.endY)return V}return A},isClickable:function(t){var T=this.tv,S=T._tabPosition,k=this._73o=this._8Q(t);return!T._40o()||S!==Oe&&S!==fl?!T._41o()||S!==Rc&&S!==Pc&&S!==Rc+"-vertical"&&S!==Pc+"-vertical"?k&&(!k.tab.isDisabled()||T.isMovable()):!0:!0},handle_mousemove:function(R){var Y=this;si?Y._74o=Y._8Q(R):Y.getView().style.cursor=Y.isClickable(R)?ug:""},handle_mousedown:function(v){this.handle_mousemove(v),this.handle_touchstart(v)},handle_touchstart:function(B){var r=this,$=r.tv,E=$._tabPosition;Rj(B),Qf(B)&&r.isClickable(B)&&(E===Oe||E===fl?(r.x=nq(B).x,r.lp=$.lp(B),r.tx=$.tx()):(r.y=nq(B).y,r.lp=$.lp(B),r.ty=$.ty()),qf(r,B))},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(U){var G,d=this,y=d.tv,n=y._tabPosition,h=d._73o;if(n===Oe||n===fl){if(G=nq(U).x-d.x,!d._25o&&!d.moving&&T(G)>2&&(y._40o()&&!Kc(U)?d._25o=1:h&&y.isMovable()&&(d.moving=1)),d._25o)y.tx(d.tx+G);else if(d.moving){var w=d.lp.x+G,F=y._tabGap/2;y._7o.each(function(i){var K=i.endX,B=w-i.startX<K-w;w>=i.startX&&K>=w&&y._7Q({tab:h.tab,startX:h.startX+G,width:h.width,front:B,insertTab:i.tab,position:B?a(0,i.startX-F):C(y._64I,K+F)})})}}else if(G=nq(U).y-d.y,!d._25o&&!d.moving&&T(G)>2&&(y._41o()&&!Kc(U)?d._25o=1:h&&y.isMovable()&&(d.moving=1)),d._25o)y.ty(d.ty+G);else if(d.moving){var V=d.lp.y+G,F=y._tabGap/2;y._7o.each(function(k){var U=k.endY,E=V-k.startY<U-V;V>=k.startY&&U>=V&&y._7Q({tab:h.tab,startY:h.startY+G,height:h.height,front:E,insertTab:k.tab,position:E?a(0,k.startY-F):C(y._23Q,U+F)})})}},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(){var p=this,x=p.tv,s=x._tabPosition,E=x.getTabModel(),a=E._roots,J=p._73o;if(p.moving){var r=x._23o;if(r&&r.insertTab!==r.tab){var W=r.tab,G=a.remove(W),S=a.indexOf(r.insertTab);S>=0&&(r.front||S++,S<=a.size()&&(a.add(W,S),E._38I(W,G,S)))}x._7Q(A),delete p.moving}else if(!p._25o&&J){W=J.tab;var X=p._74o;if(!X||X.tab===W)if(!W.isDisabled()&&dg(J._75o,p.lp)){var L=function(){var H=a.indexOf(W);E.remove(W),x.onTabClosed(W,H)};x.onTabClosing(W,L)&&L()}else W.isDisabled()||x._8o===W||E.sm().ss(W)}p._25o=p._73o=p._74o=s===Oe||s===fl?p.x=p.lp=p.tx=A:p.y=p.lp=p.ty=A}}),qm.PropertyView=function(O){var I=this;I._view=tf(1,I),I._canvas=sn(I._view),Ho(I._view,I._79O=ob()),I._rows=new Tr,I._28o=new Tr,I._26o={},I._26Q={};var U=I._propertyModel=new Er,B=I.ivm;U.mm(B,I),U.md(B,I),U.mh(B,I),I.dm(O?O:new Er),new qg(I)},Ap("PropertyView",N,{ms_ac:[df,Dp,Dr,tr,pg,"categorizable",Fj,tj,qp,Ib,wh,Lj,ho,ph,"selectRowIndex",Rn,"background",Zo,fn,es,Db,xo],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:on,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:cj,_background:b.propertyViewBackground,_expandIcon:b.propertyViewExpandIcon,_collapseIcon:b.propertyViewCollapseIcon,_scrollBarColor:xm,_scrollBarSize:gg,_autoHideScrollBar:hd,_selectBackground:b.propertyViewSelectBackground,_rowHeight:$l,_rowLineVisible:b.propertyViewRowLineVisible,_rowLineColor:b.propertyViewRowLineColor,_10I:.5,_columnLineVisible:b.propertyViewColumnLineVisible,_columnLineColor:b.propertyViewColumnLineColor,_labelColor:b.propertyViewLabelColor,_labelSelectColor:b.propertyViewLabelSelectColor,_labelFont:b.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(v){0>v&&(v=0),v>1&&(v=1);var u=this,f=u._10I;u._10I=v,u.fp("columnPosition",f,v)},getPropertyName:function(w){return w.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(m,y,R){return R===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(P,D){return D===this._selectRowIndex?this._labelSelectColor:P.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(s){var Q=this.getHeight()-this._59I;return Q>s&&(s=Q),s>0?0:W(s)},isExpanded:function(y){if(!y)return!0;var r=this._26o[y];return r?r.isExpanded:!(this._26Q[y]===!1)},toggle:function(Q){var D=this;D.isExpanded(Q)?D.collapse(Q):D.expand(Q)},expandAll:function(){this.validate();for(var G in this._26o)this.expand(G)},expand:function(i){if(i&&i!==ei){var f=this,g=f._26o[i];g&&!g.isExpanded&&(g.isExpanded=!0,f.onExpanded(i),f.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var T in this._26o)this.collapse(T)},collapse:function(D){if(D&&D!==ei){var b=this,r=b._26o[D];r&&r.isExpanded&&(r.isExpanded=!1,b.onCollapsed(D),b.ivm())}},onCollapsed:function(){},getCategoryName:function(d){if(!this.isCategorizable())return ei;var i=d.getCategoryName();return i?i:ei},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(f){var t=this,T=t._dataModel;T!==f&&(T&&(T.umd(t.handlePropertyChange,t),t._selectionModel||T.sm().ums(t.handleSelectionChange,t)),t._dataModel=f,f.md(t.handlePropertyChange,t),t._selectionModel?t._selectionModel._21I(f):f.sm().ms(t.handleSelectionChange,t),t.fp(Dg,T,f))},isVisible:function(r){return this._visibleFunc?this._visibleFunc(r):!0},onPropertyChanged:function(q){var s=this,M=q.property;Oc[M]?s.ivm():s.iv(),M===Kr&&s._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:$n},handlePropertyChange:function(t){this._27o===t.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var C=this;C._96I||(C.setSelectRowIndex(-1),C._96I=1,C.iv())},redraw:function(){this.iv()},validateModel:function(){var t=this,P=t._rows,c=t._28o,y={},w=new Tr,E=t._27o;t.updateCurrentData(),E!==t._27o&&t.endEditing(),P.clear(),c.clear(),t.getRawProperties().each(function(h){if(t.isVisible(h)){w.add(h);var W=t.getCategoryName(h);y[W]||(c.add(W,W===ei?0:e),y[W]={isExpanded:t.isExpanded(W),properties:new Tr})}}),t._sortFunc&&w.sort(t._sortFunc);for(var u in t._26o)t._26Q[u]=t.isExpanded(u);t._26o=y,c.each(function(W){W!==ei&&P.add(W);var D=y[W];D.isExpanded&&w.each(function(Z){t.getCategoryName(Z)===W&&(D.properties.add(Z),P.add({property:Z,data:t._27o}))},t)})},validateImpl:function(){var u=this;u._76o(),u._96I&&(u.validateModel(),delete u._96I);var U=u._canvas,q=u.getWidth(),s=u.getHeight(),v=-u.ty(),n=u._rowHeight,T=u._indent,r=q-T,V=u._rows,_=V.size(),X=u._9I=T+r*u._10I,L=u._59I=_*n;jk(U,q,s),u._29I={x:0,y:v,width:q,height:s},u._31I=z(v/n),u._14I=m((v+s)/n),u._31I<0&&(u._31I=0),u._14I>_&&(u._14I=_);var M,C=Sl(U),W=u._background;cm(C,0,-v,1),C.beginPath(),C.rect(0,v,q,s),C.clip(),C.clearRect(0,v,q,s),u._93db(C),W&&ld(C,0,0,T,L,W);for(var Q=u._31I;Q<u._14I;Q++){var t=V.get(Q),v=n*Q;if(nf(t))W&&ld(C,T,v,r,n,W),M=Ef(u.isExpanded(t)?u._expandIcon:u._collapseIcon),M&&Pf(C,M,lm,0,v,T,n),C.save(),C.beginPath(),C.rect(T,v,r,n),C.clip(),u.drawCategoryName(C,t,Q,T,v,r,n),C.restore();else{var i=t.property,F=t.data,M=Ef(i.getIcon()),j=u._selectRowIndex===Q?u.getSelectBackground():A;if(M&&Pf(C,M,lm,0,v,T,n),j&&ld(C,T,v,r,n,j),C.save(),C.beginPath(),C.rect(T,v,X-T,n),C.clip(),u.drawPropertyName(C,i,Q,T,v,X-T,n),C.restore(),!u.isEditing(F,i)){var G=X+1,R=q-X-1;C.save(),C.beginPath(),C.rect(G,v,R,n),C.clip(),u._87o(u.drawPropertyValue(C,i,u.getValue(F,i),Q,G,v,R,n,F),Q,G,v,R,n),C.restore()}}u._rowLineVisible&&ld(C,T,v+n-1,r,1,u._rowLineColor)}u._columnLineVisible&&(ld(C,X,0,1,L,u._columnLineColor),ld(C,q-1,0,1,L)),u._92db(C),u._93I(),C.restore(),u.ty(u.ty())},drawCategoryName:function($,I,p,U,d,s,V){wo($,I,this.getCategoryFont(I),this.getCategoryColor(I),U,d,s,V)},drawPropertyName:function(s,g,e,m,T,z,t){return g.drawPropertyName?(g.drawPropertyName(s,g,e,m,T,z,t,this),void 0):(wo(s,this.getPropertyName(g),this.getPropertyFont(g,e),this.getPropertyColor(g,e),m,T,z,t),void 0)},drawPropertyValue:function(r,i,I,J,t,y,j,v,G){return i.drawPropertyValue?i.drawPropertyValue(r,i,I,J,t,y,j,v,G,this):(dr(r,I,i,this.getLabelFont(i,I,J),this.getLabelColor(i,I,J),t,y,j,v,G,this),void 0)},isPropertyEditable:function(V){return V.isEditable()&&this.isEditable()},setProperties:function(S){this._propertyModel.clear(),this.addProperties(S)},addProperties:function(Y){if(Y){var N=this._propertyModel;Y.forEach(function(U){if(!(U instanceof sj)){var i=us(U.className);U=Ld(i?i:sj,U)}N.add(U)})}},getRowIndexAt:function(B){var j=this,g=z(j.lp(B).y/j._rowHeight);return g>=0&&g<j._rows.size()?g:-1},getPropertyAt:function(_){var l=this,S=l.getRowIndexAt(_);return S>=0?l._rows.get(S).property:A},getToolTip:function(R){var e=this,m=e.getPropertyAt(R),L=e._27o;return m&&L?m.getToolTip(L,e._9I<e.lp(R).x,e):A}});var qg=function(j){this.pv=j,this.addListeners()};$g(qg,N,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(x){this.getView().style.cursor=x},clear:function(){var K=this;K._62O=K.cp=K.ty=K.p=A,K.setCursor(Qi)},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(l){var h=this,M=h.pv;Rj(l),M.setFocus(l)&&(Qf(l)?(h.cp=nq(l),h.ty=M.ty(),h.p=M.getColumnPosition(),h.handle_touchmove(l)):M.setSelectRowIndex(M.getRowIndexAt(l)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(i){this.handle_touchend(i)},handle_touchend:function(o){var I=this;if(I.cp&&!I._62O){var t=I.pv,T=t.lp(o),G=T.x,D=T.y,Z=t._indent,a=t.getRowIndexAt(o),r=t._9I;if(a>=0){var K=t._rowHeight,c=K*a,k=t._rows.get(a),z=k.property;if(nf(k))Ef(t.isExpanded(k)?t._expandIcon:t._collapseIcon)&&G>=0&&Z>=G&&D>=c&&c+K>=D?t.toggle(k):or(o)&&t.toggle(k);else if(G>r&&t.isPropertyEditable(z,o)){var j={x:r+1,y:c,width:t.getWidth()-r-1,height:K},C={x:j.x+t.tx(),y:j.y+t.ty(),width:j.width,height:j.height},h=0,v=t._29I;j.y<v.y?h=j.y-v.y:j.y+K>v.y+v.height&&(h=j.y+K-v.y-v.height),h&&(t.ty(t.ty()-h),C.y-=h),t.beginEditing({data:k.data,property:z,value:t.getValue(k.data,z),event:o,rect:j,editorRect:C,view:t})}}t.setSelectRowIndex(a)}I.clear()},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(o){var m=this,Q=m.pv,N=m.ty,p=m.cp,A=nq(o),W=m._62O;if("p"===W)Q.setTranslateY(N+A.y-p.y);else if("c"===W){var J=Q.getWidth()-Q._indent;if(J>16){var h=m.p-(p.x-A.x)/J,e=16/J;e>h&&(h=e),h>1-e&&(h=1-e),Q.setColumnPosition(h)}}else"s"===W&&Q.setTranslateY(N+(p.y-A.y)*Q._59I/Q._29I.height)},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(J){if(!si&&Qf(J)){var V=this,h=V.pv,$=T(h.lp(J).x-h._9I)<=(tc?8:3);V.cp?V._62O||($?(V._62O="c",qf(V,J)):T(nq(J).y-V.cp.y)>=2&&(V._62O=V.isV(J)?"s":"p",qf(V,J))):($?V.setCursor(bm):V.setCursor(Qi),V.isV(J)&&h._43o())}},isV:function(d){var u=this.pv,S=u._29I;return u._41o()&&S.x+S.width-u.lp(d).x<Pj},handle_mousewheel:function(F){this.handleScroll(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.handleScroll(O,-O.detail)},handleScroll:function(z,y){var F=this.pv;Rj(z),F.endEditing(),F.translate(0,y*F.getRowHeight())},handle_keydown:function(H){var P=this.pv,O=P._rows.size(),e=P._selectRowIndex+(Pk(H)?-1:1);(Pk(H)||Dd(H))&&(0>e&&(e=0),e>=O&&(e=O-1),P.setSelectRowIndex(e))}}),qm.ListView=function(z){this._5o(z),new Hg(this)},Ap("ListView",N,{ms_ac:[df,Dp,Dr,Zo,Fj,fn,es,tj,qp,Lj,ho,ph,Xp,Rn],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:cj,_rowHeight:$l,_rowLineVisible:b.listViewRowLineVisible,_rowLineColor:b.listViewRowLineColor,_scrollBarColor:xm,_scrollBarSize:gg,_autoMakeVisible:mm,_autoHideScrollBar:hd,_selectBackground:b.listViewSelectBackground,_labelColor:b.listViewLabelColor,_labelSelectColor:b.listViewLabelSelectColor,_labelFont:b.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(U){var l=this,W=l._checkMode;l._checkMode=U,l.fp(Rq,W,U)},drawRow:function(u,S,d,H,n,g,i){var v=this,z=0,r=v._indent,t=v.getIconWidth(S);v.drawRowBackground(u,S,d,H,n,g,i),v._checkMode&&(te(u,Ef(v.getCheckIcon(S)),z+r/2,n+i/2,S,v),z+=r),v.drawIcon(u,S,z,n,t,i),v.drawLabel(u,S,z+t,n,i)}});var Hg=function(Y){this.list=Y,this._lastSelectDataTime=mr(),this.addListeners()};$g(Hg,N,{ms_listener:1,getView:function(){return this.list._view},clear:function(U){var f=this,j=f.list;U&&"d"===f._62O&&!f.dragCancel&&j.handleDragAndDrop(U,"end"),j.draggingData&&(j.draggingData=null,j.redraw()),f.dragCancel=f._62O=f._isV=f._isH=f.cp=f.tx=f.ty=A},handle_mousedown:function(Q){this.handle_touchstart(Q)},handle_touchstart:function(z){var s=this,I=s.list;if(Rj(z),I.setFocus(z)){var N=I.getDataAt(z);s.cp=nq(z),s.tx=I.tx(),s.ty=I.ty(),Qf(z)?N&&I.handleDragAndDrop&&!s.isV(z)&&!s.isH(z)&&(I.draggingData=N,I.redraw(),I.handleDragAndDrop(z,"prepare")):(N&&s._33o(z,N),s.clear(z))}},handleWindowMouseUp:function(A){this.clear(A)},handleWindowTouchEnd:function(U){this.clear(U)},handle_mouseup:function(j){this.handle_touchend(j)},handle_touchend:function(A){var n=this,x=n.list;if(!n._isV&&!n._isH&&n.cp&&!n._62O){var c=x.getDataAt(A);c?(x.isCheckMode()?n._34o(A,c):n._33o(A,c),or(A)?x.onDataDoubleClicked(c,A):x.onDataClicked(c,A)):x.handleBackgroundClick(A)}n.clear(A)},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(q){var G=this,j=G.list,i=G._62O,J=G.tx,U=G.ty,V=G.cp,z=nq(q),E=j._29I;"p"===i?j.setTranslate(J+z.x-V.x,U+z.y-V.y):"v"===i?j.ty(U+(V.y-z.y)*j._59I/E.height):"h"===i?j.tx(J+(V.x-z.x)*j._91I/E.width):"d"===i&&(G.dragCancel||j.handleDragAndDrop(q,"between"))},handle_mousemove:function($){this.handle_touchmove($)},handle_touchmove:function(_){if(!si&&Qf(_)){var M=this,c=M.list;if(M._isV=M.isV(_),M._isH=M.isH(_),M.cp){if(!M._62O){if(np(nq(_),M.cp)<2)return;M._isV?M._62O="v":M._isH?M._62O="h":c.draggingData&&!this.dragCancel?(M._62O="d",c.handleDragAndDrop(_,"begin")):M._62O="p",M._62O&&"d"!==M._62O&&c.draggingData&&(c.draggingData=null,c.redraw()),qf(M,_)}}else M._isV&&c._43o(),M._isH&&c._42o()}},isV:function(H){var d=this.list,N=d._29I;return d._41o()&&N.x+N.width-d.lp(H).x<Pj},isH:function(c){var U=this.list,n=U._29I;return U._40o()&&n.y+n.height-U.lp(c).y<Pj},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40,p.wheelDelta!==p.wheelDeltaX)},handle_DOMMouseScroll:function(R){this.handleScroll(R,-R.detail,1)},handleScroll:function(q,l,G){var b=this.list;Rj(q),b.endEditing&&b.endEditing(),G&&b._41o()?b.translate(0,l*b.getRowHeight()):b._40o()&&b.translate(10*l,0)},handle_keydown:function(c){if(!b.isInput(c.target)){var k,D=this.list,d=D.sm(),n=D._rows,I=n.size();if(wg(c))D.selectAll();else if(hp(c))D.handleDelete&&D.handleDelete(c);else if(dk(c))"d"!==this._62O||this.dragCancel||(D.handleDragAndDrop(c,"cancel"),this.dragCancel=!0);else if(Kn(c))D.isCheckMode()&&(k=D.getFocusData(),k&&D.checkData(k));else if(Pk(c)||Dd(c)){var e=D.isCheckMode();if(k=e?D.getFocusData():d.ld()){var l=D.getRowIndex(k);l>=0&&(Pk(c)?0!==l&&(k=n.get(l-1),e?D.setFocusData(k):d.ss(k)):l!==I-1&&(k=n.get(l+1),e?D.setFocusData(k):d.ss(k)))}else I>0&&(k=n.get(0),e?D.setFocusData(k):d.ss(k))}}},_34o:function(h,S){var H=this.list,e=H.lp(h).x;return e>=0&&e<=H._indent?(H.checkData(S),void 0):(H.setFocusData(S),void 0)},_33o:function(T,X){var g=this.list,h=g.sm(),n=h.ld();if(Kc(T))g.isSelected(X)?h.rs(X):h.as(X);else if(kj(T))if(n)for(var i=g.getRowIndex(n),L=g.getRowIndex(X);i!==L;)i+=L>i?1:-1,h.as(g._rows.get(i));else h.ss(X);else if(Qf(T)){var x=mr();if(h.contains(X)){var v=x-this._lastSelectDataTime;g.handleDataDoubleSelect&&v>500&&1500>v&&g.handleDataDoubleSelect(T,X)}h.ss(X),this._lastSelectDataTime=x}else h.contains(X)||h.ss(X)}}),qm.TreeView=function(n){var E=this;E._35o(),E._5o(n),new ve(E)},Ap("TreeView",N,{ms_ac:[df,Dp,Dr,"rootVisible",Rq,"rootData",tj,qp,Lj,ho,ph,Fj,Zo,fn,es,Ib,wh,Xp,Rn,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:A,_indent:cj,_rowHeight:$l,_rowLineVisible:b.treeViewRowLineVisible,_rowLineColor:b.treeViewRowLineColor,_scrollBarColor:xm,_scrollBarSize:gg,_autoHideScrollBar:hd,_expandIcon:b.treeViewExpandIcon,_collapseIcon:b.treeViewCollapseIcon,_autoMakeVisible:mm,_selectBackground:b.treeViewSelectBackground,_labelColor:b.treeViewLabelColor,_labelSelectColor:b.treeViewLabelSelectColor,_labelFont:b.treeViewLabelFont,_doubleClickToToggle:b.treeViewDoubleClickToToggle,drawRow:function(e,s,G,O,N,B,I){var q=this;q.drawRowBackground(e,s,G,O,N,B,I),q.drawTree(e,s,G,0,N,B,I)},isOnToggleIcon:function(y){var A=this.getDataAt(y);if(A){var b=this.getIndent(),G=this.lp(y).x;if(Ef(this.getToggleIcon(A))){var w=b*this.getLevel(A);if(G>=w&&w+b>=G)return!0}}return!1}});var ve=function(Z){yf(ve,this,[Z])};$g(ve,Hg,{toggle:function(F,N,T,f){var $=this.list,O=$.lp(F).x;if(Ef($.getToggleIcon(N))){var J=T*f;if(O>=J&&J+T>=O)return $.toggle(N),!0}return $.isDoubleClickToToggle()&&or(F)?($.toggle(N),!0):!1},_34o:function(y,d){var N=this.list,n=N.lp(y).x,H=N._levelMap[d._id],O=N._indent,i=O*(H+1);return n>=i&&i+O>=n?(N.checkData(d),void 0):(this.toggle(y,d,O,H)||N.setFocusData(d),void 0)},_33o:function(i,I){var Z=this,L=Z.list;if(!Z.toggle(i,I,L._indent,L.getLevel(I)))if(kj(i)){var c=L.sm();if(c.size()>0){for(var $=L._rows,T=null,u=0,V=$.size();V>u;u++)if(L.isSelected($.get(u))){T=u;break}for(var W=null,u=$.size()-1;u>=0;u--)if(L.isSelected($.get(u))){W=u;break}var r,z,H=L.getRowIndex(I);for(T>H?(r=H-1,z=T):H>W?(r=W,z=H):(r=T,z=W);r!==z;)r++,c.as(L._rows.get(r))}else c.ss(I)}else ve.superClass._33o.call(Z,i,I)},handle_keydown:function(K){if(el(K)||cg(K)){var q=this.list,h=q._rows,D=q.isCheckMode(),p=q.sm(),U=D?q.getFocusData():p.ld();U?U.hasChildren()&&(el(K)?q.collapse(U):q.expand(U)):h.size()>0&&(U=h.get(0),D?q.setFocusData(U):p.ss(U))}else ve.superClass.handle_keydown.call(this,K)}});var Gk=qm.TableView=function(Q){this._98I(),this._5o(Q),new Zh(this)};Ap("TableView",N,{ms_ac:[df,Dp,Dr,"sortMode",tr,pg,Zo,fn,es,Db,xo,"sortColumn",tj,qp,Lj,ho,ph,Xp,Rn],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:qe,_editable:!0,_batchEditable:!1,_rowHeight:$l,_rowLineVisible:b.tableViewRowLineVisible,_rowLineColor:b.tableViewRowLineColor,_columnLineVisible:b.tableViewColumnLineVisible,_columnLineColor:b.tableViewColumnLineColor,_scrollBarColor:xm,_scrollBarSize:gg,_autoHideScrollBar:hd,_autoMakeVisible:mm,_selectBackground:b.tableViewSelectBackground,_labelColor:b.tableViewLabelColor,_labelSelectColor:b.tableViewLabelSelectColor,_labelFont:b.tableViewLabelFont,getCheckColumn:function(){var H=this;if(!H._31o){var g=H._31o=new Wq;g.setEditable(!0),g.setWidth(40),g.getValue=H.getCheckColumValue,g.drawCell=H.drawCheckColumnCell}return H._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(P){var l=this,q=l._39o,$=l.getCheckColumn();P!==l.isCheckMode()&&(P?q.add($,0):q.remove($),l.fp(Rq,!P,P))},getCheckColumValue:function(Q,n,E){return E.isSelected(Q)},drawCheckColumnCell:function(E,S,o,M,G,Y,$,p,t){te(E,t.getCheckIcon(S),G+$/2,Y+p/2,S,t)}});var Zh=function(W){yf(Zh,this,[W])};$g(Zh,Hg,{_34o:function(c,w){var Z=this.list,Q=Z._31o;if(Z.isCellEditable(w,Q,c)){var k=Z._3Q(Q),y=Z.lp(c).x;if(k&&y>=k.startX&&y<k.startX+Q.getWidth())return Z.checkData(w),void 0}Z._37O(w,c),Z.setFocusData(w)},_33o:function(V,Y){this.list._37O(Y,V),Zh.superClass._33o.apply(this,arguments)}});var bf=qm.TreeTableView=function(G){var o=this,U=o._4o=new Wq;o._35o(),o._98I(),o._5o(G),U.setDisplayName("Name"),U.setEditable(!0),U.setWidth(180),U.drawCell=Df,U.getValue=Gb,o._39o.add(U),new bb(o)},Df=function(H,V,h,o,U,S,K,c,Q){Q.drawTree(H,V,h,U,S,K,c)},Gb=function(y,h,_){return _.getLabel(y)};Ap("TreeTableView",N,{ms_ac:[df,Dp,Dr,"sortMode",tr,pg,Fj,Rq,"rootData","rootVisible",tj,qp,"sortColumn",Ib,wh,Lj,ho,ph,Xp,es,Zo,fn,Db,xo,Rn,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:qe,_checkMode:A,_editable:!0,_batchEditable:!1,_indent:cj,_rowHeight:$l,_rowLineVisible:b.treeTableViewRowLineVisible,_rowLineColor:b.treeTableViewRowLineColor,_columnLineVisible:b.treeTableViewColumnLineVisible,_columnLineColor:b.treeTableViewColumnLineColor,_expandIcon:b.treeTableViewExpandIcon,_collapseIcon:b.treeTableViewCollapseIcon,_scrollBarColor:xm,_scrollBarSize:gg,_autoHideScrollBar:hd,_autoMakeVisible:mm,_selectBackground:b.treeTableViewSelectBackground,_labelColor:b.treeTableViewLabelColor,_labelSelectColor:b.treeTableViewLabelSelectColor,_labelFont:b.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var bb=function(X){yf(bb,this,[X])};$g(bb,Hg,{_34o:function(b,m){var X=this.list,o=X._4o,y=X._3Q(o),H=X.lp(b).x;if(y){var Q=X._indent,g=y.startX+Q*X.getLevel(m);if(Ef(X.getToggleIcon(m))&&H>=g&&g+Q>=H)return X.toggle(m),void 0;if(X.isCellEditable(m,o)&&(g+=Q,H>=g&&g+Q>=H))return X.checkData(m),void 0}X._37O(m,b),X.setFocusData(m)},_33o:function(D,r){var j=this.list,u=j.lp(D).x;if(Ef(j.getToggleIcon(r))){var d=j._3Q(j._4o);if(d){var H=j._indent,S=d.startX+H*j.getLevel(r);if(u>=S&&S+H>=u)return j.toggle(r),void 0}}j._37O(r,D),bb.superClass._33o.apply(this,arguments)}});var Oo=qm.TableHeader=function(B){var o=this,Q=o._view=tf(1,o),r=o._39o=B.getColumnModel(),j=o.iv;o.tv=o._tableView=B,o._60I=new Tr,o._canvas=sn(Q),Q.style.background=b.tableHeaderBackground||"",Q.style.height=ag+bl,r.mm(j,o),r.md(j,o),r.mh(j,o),B.mp(function(l){ad[l.property]&&o.iv()},o),new vg(o),o.iv()};Ap("TableHeader",N,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",df,Dr,Fj,"moveBackground","insertColor",Db,xo,"resizable","movable"],_checkIcon:ao,_movable:!0,_resizable:!0,_labelColor:b.tableHeaderLabelColor,_labelFont:b.tableHeaderLabelFont,_columnLineColor:b.tableHeaderColumnLineColor,_columnLineVisible:b.tableHeaderColumnLineVisible,_sortDescIcon:b.tableHeaderSortDescIcon,_sortAscIcon:b.tableHeaderSortAscIcon,_moveBackground:b.tableHeaderMoveBackground,_insertColor:b.tableHeaderInsertColor,_indent:cj,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(B){return B.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(G){return G.getColor()||this._labelColor},getLabelAlign:function(F){return F._align},onPropertyChanged:function(){this.iv()},_5Q:function(L){this._61I=L,this.iv()},getLogicalPoint:function(z){return Uc(z,this._canvas,this.tv.tx())},validateImpl:function(){var w=this,A=w._canvas,d=w.getWidth(),B=w.getHeight(),O=w.tv,D=w._60I,e=w._61I,j=-O.tx(),Q=0;(d!==A.clientWidth||B!==A.clientHeight)&&jk(A,d,B),D.clear(),w._39o._roots.each(function(K){if(K.isVisible()){var L=Q+K.getWidth();j+d>=Q&&L>=j&&D.add({column:K,startX:Q}),Q=L}});var t=Sl(A);if(cm(t,-j,0,1),t.beginPath(),t.rect(j,0,d,B),t.clip(),t.clearRect(j,0,d,B),D.each(function(E){var K=E.column,S=E.startX,z=K.getWidth();z>0&&(t.save(),t.beginPath(),t.rect(S,0,z,B),t.clip(),e&&e.column===K||w.drawColumn(t,K,S,0,z,B),w._columnLineVisible&&ld(t,S+z-1,0,1,B,w._columnLineColor),t.restore())}),e){var W=e.column,Q=e.startX,V=e.position,c=W.getWidth();t.save(),t.beginPath(),t.rect(Q,0,c,B),t.clip(),t.fillStyle=w._moveBackground,t.fill(),w.drawColumn(t,W,Q,0,c,B),t.restore(),me(t,w._insertColor,V,0,B)}t.restore()},_6Q:function(v){var h=this.tv;return h._31o===v&&h.sm().getSelectionMode()===Vc},drawColumn:function(v,R,K,Q,c,u){var A=this,f=A.tv,N=Ef(R.getIcon()),I=A.getLabelAlign(R);if(A._6Q(R)){var o=Ef(A._checkIcon);te(v,o,K+c/2,Q+u/2,R,A)}else{var j=A.getLabel(R),y=A.getLabelFont(R),g=A.getLabelColor(R),t=Io(y,j).width,n=N?A._indent:0;I===Rc?(N&&Pf(v,N,lm,K,Q,n,u),wo(v,j,y,g,K+n,Q,c,u,Rc)):I===Pc?(N&&Pf(v,N,lm,K+c-t-n,Q,n,u),wo(v,j,y,g,K,Q,c,u,Pc)):(N&&Pf(v,N,lm,K+(c-t-n)/2,Q,n,u),wo(v,j,y,g,K+(c-t+n)/2,Q,0,u,Rc))}if(R.isSortable()&&f.getSortColumn()===R&&(N=Ef(R.getSortOrder()===Wr?A._sortAscIcon:A._sortDescIcon))){var D=pl(N,R)/2+2;te(v,N,I===Pc?K+D:K+c-D,Q+u/2,R,f)}}});var vg=function(s){var B=this;B.th=s,B.tv=s._tableView,B.addListeners()};$g(vg,N,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(A){this.getView().style.cursor=A},handle_mousemove:function(f){if(!si){var n=this;delete n._29o,n.setCursor(Qi);for(var l=n.th,B=l._60I,$=l.lp(f).x,I=B.size()-1;I>=0;I--){var d=B.get(I),M=d.column,z=d.startX+M.getWidth();if(l.isResizable()&&T(z-$)<=(tc?10:3))return n._29o=d,n.setCursor(bm),void 0;$>d.startX&&z>$&&(n._29o=d),(M.isClickable()||M.isSortable()||l.isMovable()||n.tv.getCheckColumn&&M===n.tv.getCheckColumn())&&$>d.startX&&z>$&&n.setCursor(ug)}}},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(v){var N=this;Rj(v),N.tv.endEditing(),N.handle_mousemove(v),N._29o&&(N.x=nq(v).x,N.lx=N.th.lp(v).x,N.w=N._29o.column.getWidth(),qf(N,v))},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(o){var U=this,Q=U.th,h=U.getView().style.cursor,b=U._29o,L=nq(o).x-U.x;if(U.resizing||U.moving||(h===bm?U.resizing=1:Q.isMovable()&&h===ug&&T(L)>2&&(U.moving=1)),U.resizing)b.column.setWidth(U.w+L);else if(U.moving){var P=U.lx+L;Q._60I.each(function(A){var F=A.startX,s=F+A.column.getWidth();if(P>=F&&s>=P){var d={column:b.column,startX:b.startX+L,front:s-P>P-F,insertColumn:A.column};d.position=d.front?F:s,Q._5Q(d)}})}},_16Q:function(p,h){var C=this,w=C.tv,D=C.th,V=D._checkIcon;if(D._6Q(p)){var X=Ef(V),U=C.lx,d=p.getWidth(),S=pl(X,p);if(U>=h+d/2-S&&h+d/2+S>=U){D.setCheckIcon(V===Qb?ao:Qb);var J=w.sm(),P=w._rows;return V===Qb?J.rs(P):J.ss(P),w.onCheckColumnClicked(p),!0}}return!1},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},handleWindowTouchEnd:function(j){var N=this,S=N.tv,h=N.th,p=N._29o;if(N.moving){var Y=h._61I;if(Y&&Y.insertColumn!==Y.column){var L=Y.column,Q=S.getColumnModel()._roots,I=Q.remove(L),g=Q.indexOf(Y.insertColumn);g>=0&&(Y.front||g++,g<=Q.size()&&(Q.add(L,g),S.getColumnModel()._38I(L,I,g)))}h._5Q(A),delete N.moving}else if(!N.resizing&&p){L=p.column;var U=h.lp(j).x,b=p.startX,m=!0;if(h.onColumnClicked){var i=h.onColumnClicked(L,j,b);i===!1&&(m=!1)}if(m&&U>=b&&U<=b+L.getWidth()&&!N._16Q(L,b)){if(L.isSortable()){var D=S.getSortMode(),z=L.getSortOrder();D===qe?S.getSortColumn()===L?(z===zq&&S.setSortColumn(A),L.setSortOrder(z===Wr?zq:Wr)):S.setSortColumn(L):"bistate"===D&&(S.getSortColumn()===L?L.setSortOrder(z===Wr?zq:Wr):S.setSortColumn(L))
}S.onColumnClicked(L,j,b)}}N._29o=N.resizing=N.x=N.lx=N.w=A}}),qm.TablePane=function(W){this.init(new Gk(W))},Ap("TablePane",N,{ms_v:1,_44o:1}),qm.TreeTablePane=function(x){this.init(new bf(x))},Ap("TreeTablePane",N,{ms_v:1,_44o:1}),qm.Toolbar=function(v){var d=this,H=d._view=tf(1,d),c=H.style;c.background=b.toolbarBackground||"",c.height=qk+bl,d._canvas=sn(H),d._30o=new Tr,d._90I=new Tr,d.setItems(v||[]),H.handleGroupSelectedChanged=function(k){if(k.isSelected()){var S=k.getGroupId();null!=S&&d._items.forEach(function(h){var c=h.element;c&&c!==k&&c.setSelected&&c.getGroupId&&c.getGroupId()===S&&c.setSelected(!1)})}},new Np(d)},Ap("Toolbar",N,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Jl,df,Dr,Dp,Rn,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:b.toolbarLabelColor,_labelSelectColor:b.toolbarLabelSelectColor,_labelFont:b.toolbarLabelFont,_selectBackground:b.toolbarSelectBackground,_itemGap:b.toolbarItemGap,_separatorColor:b.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(i){var G=this.getItemInfoAt(i);return G?G.item.toolTip:A},getLabelColor:function(e){return e&&e.selected&&e.type!==Qb&&e.type!==Vj?this._labelSelectColor:this._labelColor},onPropertyChanged:function(e){this.iv(),e.property===Jl&&this._items.forEach(function(K){Vm(K)})},redraw:function(){this.iv()},addItem:function(P,j){var b=this._items;j==A?b.push(P):b.splice(j,0,P),this.fp(Jl,A,b)},removeItem:function(O){if(O)for(var G=this._items,L=0;L<G.length;L++)O===G[L]&&(G.splice(L,1),this.fp(Jl,A,G))},removeItemById:function(v){if(v!=A)for(var B=this._items,D=0;D<B.length;D++)if(v===B[D].id){var M=B.splice(D,1)[0];return this.fp(Jl,A,B),M}},getItemById:function(z){if(z!=A)for(var T=this._items,q=0;q<T.length;q++){var Z=T[q];if(z===Z.id)return Z}},setItemVisible:function(d,M){var J=this.getItemById(d);J&&(J.visible=M)},getItemInfos:function(){return this._30o},getItemInfoAt:function(w){var q=this,I=0,r=q._30o,h=q.lp(w),S=h.x,b=h.y;if(b>=0&&b<=q.getHeight())for(;I<r.size();I++){var x=r.get(I);if(x.startX<=S&&S<=x.endX)return x}return A},drawItem:function(O,k,d,b,f){if(k.visible===!1)return 0;if(Fd(k.visible)&&!k.visible())return 0;var K=this,v=k.disabled;v&&(O.globalAlpha=Sb);var A=K.drawItemImpl(O,k,d,b,f),W=K._itemGap;return v&&(O.globalAlpha=1),this._currentItem!==k||"separator"===k||k.separator===!0||k.unfocusable||Yf(O,K._separatorColor,d-W/2,0,A+W,b),A},drawItemImpl:function(j,Q,c,i,d){var p=this,H=p._view,h=p._itemGap,n=i/2,u=Q.type,P=Q.element,k=Q.label;nf(P)&&(k=P,P=A);var E,L=p.getLabelFont(Q),g=p.getLabelColor(Q),l=Q.selected,D=Ef(Q.icon),M=pl(D,Q),I=0,X=M+(k?Io(L,k).width:0);if("separator"===Q||Q.separator===!0)return me(j,p._separatorColor,c,i/4,n),1;if(P){D&&te(j,D,c+M/2,n,Q,p),wo(j,k,L,g,c+M,0,0,i);var v=If(P);d||p._90I.add(v),v.parentNode!==H&&Ho(H,v),P.iv&&P.iv(),P.validate&&P.validate();var Y=v.getBoundingClientRect(),U=Y.width,w=v.style;return Dm(v),w.left=p.tx()+c+X+bl,w.top=(i-Y.height)/2+bl,X+U}return u===Vj?E=Ef(l?gi:uf):u===Qb&&(E=Ef(l?Qb:ao)),E?(I=pl(E,Q),te(j,E,c+I/2,n,Q,p),c+=I,X+=I):l&&ld(j,c-h/2,0,X+h,i,p.getSelectBackground(Q)),D&&te(j,D,c+M/2,n,Q,p),wo(j,k,L,g,c+M,0,0,i),X},validateImpl:function(){var K=this,S=K._canvas,v=K.getWidth(),_=K.getHeight(),r=K._30o,h=K._items;jk(S,v,_);var O=Sl(S),b=K._itemGap,I=b/2;cm(O,K.tx(),0,1),O.clearRect(0,0,v,_);var Z=K._90I;K._90I=new Tr,r.clear(),h.forEach(function(c){var a=K.drawItem(O,c,I,_);r.add({item:c,startX:I,endX:I+a,width:a}),a&&(I+=a+b)}),Z.each(function(H){K._90I.contains(H)||Sc(H)});var Q=K._64I;K._64I=a(0,I),O.restore(),K._stickToRight?(K._65O=0,O=Sl(S),I=v-K._64I+b,cm(O,0,0,1),O.clearRect(0,0,v,_),r.clear(),h.forEach(function(U){var s=K.drawItem(O,U,I,_,!0);r.add({item:U,startX:I,endX:I+s,width:s}),s&&(I+=s+b)}),O.restore()):K.tx(K.tx()),Q!==K._64I&&K.onSumWidthChanged(Q,K._64I)},onSumWidthChanged:function(){},handleClick:function(I,M){var Q=this,K=I.type,j=I.action,f=I.groupId,z=I.selected;I.disabled||(f!=A?z||(I.selected=!0,this._items.forEach(function(m){m.groupId===f&&I!==m&&(m.selected=!1)}),j&&I.action(I,Q,M)):K===Qb||"toggle"===K?(I.selected=!z,j&&I.action(I,Q,M)):j&&I.action(I,Q,M)),lr(),Q.iv()}});var Np=function(Y){this.tb=Y,this.addListeners()};$g(Np,N,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(H){this.handleScroll(H,10*(H.wheelDelta/40))},handle_DOMMouseScroll:function(X){this.handleScroll(X,10*-X.detail)},handleScroll:function(E,y){Rj(E);var I=this.tb;I.isScrollable()&&!I._stickToRight&&(I.tx(I.tx()+y),Jb())},handle_mousemove:function(C){var D=this;si||D.setItem(C)},handle_mouseout:function(b){var D=this;b.target===D.getView()?D.tb.setCurrentItem(A):D.handle_mousemove(b)},handle_mousedown:function(i){this.handle_mousemove(i),this.handle_touchstart(i)},handle_touchstart:function(L){var v=this,y=v.tb,g=L.target;Qf(L)&&(g===v.getView()||g===y._canvas)&&(Rj(L),y.setFocus(L)&&(this.setItem(L,!0),(y.isScrollable()||v.info&&!v.info.item.disabled)&&(v.x=nq(L).x,v.tx=y.tx(),qf(v,L))))},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(O){var G=this,W=G.tb;if(!W._stickToRight){var J=nq(O).x-G.x;!G._25o&&T(J)>2&&W.isScrollable()&&(G._25o=1),G._25o&&W.tx(G.tx+J)}},handleWindowMouseUp:function(f){this.handleWindowTouchEnd(f)},handleWindowTouchEnd:function(s){var o=this,r=o.tb,B=o.info,d=o.tb.getItemInfoAt(s);if(!o._25o&&B){var c=B.item;d&&d.item===c&&r.handleClick(c,s)}o._25o=o.x=o.tx=A,o.setItem()},setItem:function(u,t){var v=this,i=v.tb,n=v.info=u?i.getItemInfoAt(u):A,Z=n?n.item:A;i.setCurrentItem(Z),t&&Z&&Fd(Z.onDown)&&Z.onDown(u)}}),qm.BorderPane=function(){this._view=tf(1,this),this.iv()},Ap("BorderPane",N,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(T,P){this._12o("leftView",T),P!=A&&this.setLeftWidth(P)},getRightView:function(){return this._rightView},setRightView:function(e,h){this._12o("rightView",e),h!=A&&this.setRightWidth(h)},getTopView:function(){return this._topView},setTopView:function(Q,P){this._12o("topView",Q),P!=A&&this.setTopHeight(P)},getBottomView:function(){return this._bottomView},setBottomView:function(h,K){this._12o("bottomView",h),K!=A&&this.setBottomHeight(K)},getCenterView:function(){return this._centerView},setCenterView:function(x){this._12o("centerView",x)},_12o:function(l,J){var n=this,Q="_"+l,A=n._view,R=n[Q];R!==J&&(R&&(R.getView?Sc(R.getView()):Sc(R)),n[Q]=J,J&&(J.getView?Ho(A,J.getView(),1):Ho(A,J,1)),n.fp(l,R,J))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var N=this,S=N._topView,h=N._bottomView,s=N._leftView,v=N._rightView,E=N._centerView,P=N.getWidth(),w=N.getHeight(),m=0,d=0,H=P,q=w,n=0,p=0,b=0,_=0;S&&(n=N._topHeight==A?Ge(S):N._topHeight,d=n),h&&(p=N._bottomHeight==A?Ge(h):N._bottomHeight,q=w-p),s&&(b=N._leftWidth==A?Ni(s):N._leftWidth,m=b),v&&(_=N._rightWidth==A?Ni(v):N._rightWidth,H=P-_);var T=a(0,H-m),i=a(0,q-d);S&&di(S,0,0,P,n),h&&di(h,0,q,P,p),s&&di(s,0,d,b,i),v&&di(v,H,d,_,i),E&&di(E,m,d,T,i)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);